<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Key concepts | HyperFormula (v0.4.0)</title>
    <meta name="generator" content="VuePress 1.7.1">
    <script>
      (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-N59TZXR');
    </script>
    <meta name="description" content="HyperFormula is an open-source, high-performance calculation engine for spreadsheets and web applications.">
    <meta name="google-site-verification" content="MZpSOa8SNvFLRRGwUQpYVZ78kIHQoPVdVbafHhJ_d4Q">
    <link rel="preload" href="/hyperformula/assets/css/0.styles.e1537429.css" as="style"><link rel="preload" href="/hyperformula/assets/js/app.95f3c16f.js" as="script"><link rel="preload" href="/hyperformula/assets/js/3.2b0977bc.js" as="script"><link rel="preload" href="/hyperformula/assets/js/183.293c07cc.js" as="script"><link rel="prefetch" href="/hyperformula/assets/js/10.f5209ea4.js"><link rel="prefetch" href="/hyperformula/assets/js/100.b52d6ea3.js"><link rel="prefetch" href="/hyperformula/assets/js/101.699733ff.js"><link rel="prefetch" href="/hyperformula/assets/js/102.e6e39684.js"><link rel="prefetch" href="/hyperformula/assets/js/103.dee664b6.js"><link rel="prefetch" href="/hyperformula/assets/js/104.075feb36.js"><link rel="prefetch" href="/hyperformula/assets/js/105.09518c2e.js"><link rel="prefetch" href="/hyperformula/assets/js/106.6f7ca7b3.js"><link rel="prefetch" href="/hyperformula/assets/js/107.11994673.js"><link rel="prefetch" href="/hyperformula/assets/js/108.0a394352.js"><link rel="prefetch" href="/hyperformula/assets/js/109.658905ad.js"><link rel="prefetch" href="/hyperformula/assets/js/11.339bae22.js"><link rel="prefetch" href="/hyperformula/assets/js/110.cf787104.js"><link rel="prefetch" href="/hyperformula/assets/js/111.27775f41.js"><link rel="prefetch" href="/hyperformula/assets/js/112.1a21138d.js"><link rel="prefetch" href="/hyperformula/assets/js/113.30cca419.js"><link rel="prefetch" href="/hyperformula/assets/js/114.142c9e5b.js"><link rel="prefetch" href="/hyperformula/assets/js/115.91d762e3.js"><link rel="prefetch" href="/hyperformula/assets/js/116.54b6fe22.js"><link rel="prefetch" href="/hyperformula/assets/js/117.aca8e92c.js"><link rel="prefetch" href="/hyperformula/assets/js/118.2031b70f.js"><link rel="prefetch" href="/hyperformula/assets/js/119.c1a2e25a.js"><link rel="prefetch" href="/hyperformula/assets/js/12.e4a5aaeb.js"><link rel="prefetch" href="/hyperformula/assets/js/120.e6d0d28c.js"><link rel="prefetch" href="/hyperformula/assets/js/121.bf00a12a.js"><link rel="prefetch" href="/hyperformula/assets/js/122.0a762097.js"><link rel="prefetch" href="/hyperformula/assets/js/123.4c610248.js"><link rel="prefetch" href="/hyperformula/assets/js/124.57310f0c.js"><link rel="prefetch" href="/hyperformula/assets/js/125.324405d6.js"><link rel="prefetch" href="/hyperformula/assets/js/126.c0951102.js"><link rel="prefetch" href="/hyperformula/assets/js/127.68a8de50.js"><link rel="prefetch" href="/hyperformula/assets/js/128.baf81000.js"><link rel="prefetch" href="/hyperformula/assets/js/129.bd9c8f17.js"><link rel="prefetch" href="/hyperformula/assets/js/13.23f91652.js"><link rel="prefetch" href="/hyperformula/assets/js/130.18d0c7a1.js"><link rel="prefetch" href="/hyperformula/assets/js/131.2b7ead68.js"><link rel="prefetch" href="/hyperformula/assets/js/132.b35a5787.js"><link rel="prefetch" href="/hyperformula/assets/js/133.72aae1d7.js"><link rel="prefetch" href="/hyperformula/assets/js/134.69428b81.js"><link rel="prefetch" href="/hyperformula/assets/js/135.c7211e44.js"><link rel="prefetch" href="/hyperformula/assets/js/136.f15787cd.js"><link rel="prefetch" href="/hyperformula/assets/js/137.e2dbfd65.js"><link rel="prefetch" href="/hyperformula/assets/js/138.ff0ef6f4.js"><link rel="prefetch" href="/hyperformula/assets/js/139.4c455779.js"><link rel="prefetch" href="/hyperformula/assets/js/14.1bfcc296.js"><link rel="prefetch" href="/hyperformula/assets/js/140.1c1b7529.js"><link rel="prefetch" href="/hyperformula/assets/js/141.6ab9c261.js"><link rel="prefetch" href="/hyperformula/assets/js/142.3d146a46.js"><link rel="prefetch" href="/hyperformula/assets/js/143.7c917dfa.js"><link rel="prefetch" href="/hyperformula/assets/js/144.f944ba5e.js"><link rel="prefetch" href="/hyperformula/assets/js/145.9750d059.js"><link rel="prefetch" href="/hyperformula/assets/js/146.cdf70622.js"><link rel="prefetch" href="/hyperformula/assets/js/147.4c4d7525.js"><link rel="prefetch" href="/hyperformula/assets/js/148.4dcf0720.js"><link rel="prefetch" href="/hyperformula/assets/js/149.69098b91.js"><link rel="prefetch" href="/hyperformula/assets/js/15.d6f5366f.js"><link rel="prefetch" href="/hyperformula/assets/js/150.870ac8f2.js"><link rel="prefetch" href="/hyperformula/assets/js/151.1c1e1a91.js"><link rel="prefetch" href="/hyperformula/assets/js/152.35d269c1.js"><link rel="prefetch" href="/hyperformula/assets/js/153.41652d63.js"><link rel="prefetch" href="/hyperformula/assets/js/154.cb870324.js"><link rel="prefetch" href="/hyperformula/assets/js/155.bfd179a2.js"><link rel="prefetch" href="/hyperformula/assets/js/156.2dae8efa.js"><link rel="prefetch" href="/hyperformula/assets/js/157.4b3ad405.js"><link rel="prefetch" href="/hyperformula/assets/js/158.d3e1b351.js"><link rel="prefetch" href="/hyperformula/assets/js/159.a794e1f4.js"><link rel="prefetch" href="/hyperformula/assets/js/16.66b5c785.js"><link rel="prefetch" href="/hyperformula/assets/js/160.cdd741f7.js"><link rel="prefetch" href="/hyperformula/assets/js/161.cf93df88.js"><link rel="prefetch" href="/hyperformula/assets/js/162.66fc4197.js"><link rel="prefetch" href="/hyperformula/assets/js/163.2cb349cb.js"><link rel="prefetch" href="/hyperformula/assets/js/164.352761a8.js"><link rel="prefetch" href="/hyperformula/assets/js/165.039bd201.js"><link rel="prefetch" href="/hyperformula/assets/js/166.145fee4b.js"><link rel="prefetch" href="/hyperformula/assets/js/167.650f135c.js"><link rel="prefetch" href="/hyperformula/assets/js/168.06186d19.js"><link rel="prefetch" href="/hyperformula/assets/js/169.866e819a.js"><link rel="prefetch" href="/hyperformula/assets/js/17.05f6cdb8.js"><link rel="prefetch" href="/hyperformula/assets/js/170.d49beb7f.js"><link rel="prefetch" href="/hyperformula/assets/js/171.68c68ea4.js"><link rel="prefetch" href="/hyperformula/assets/js/172.d3523d51.js"><link rel="prefetch" href="/hyperformula/assets/js/173.9747dde8.js"><link rel="prefetch" href="/hyperformula/assets/js/174.dbffb081.js"><link rel="prefetch" href="/hyperformula/assets/js/175.16c3ee75.js"><link rel="prefetch" href="/hyperformula/assets/js/176.80952847.js"><link rel="prefetch" href="/hyperformula/assets/js/177.26b996f6.js"><link rel="prefetch" href="/hyperformula/assets/js/178.524b8381.js"><link rel="prefetch" href="/hyperformula/assets/js/179.50bf2cd6.js"><link rel="prefetch" href="/hyperformula/assets/js/18.97560120.js"><link rel="prefetch" href="/hyperformula/assets/js/180.4d0f2860.js"><link rel="prefetch" href="/hyperformula/assets/js/181.849cf7e9.js"><link rel="prefetch" href="/hyperformula/assets/js/182.b9895322.js"><link rel="prefetch" href="/hyperformula/assets/js/184.d9f4967d.js"><link rel="prefetch" href="/hyperformula/assets/js/185.f26feeab.js"><link rel="prefetch" href="/hyperformula/assets/js/186.a9ae5e88.js"><link rel="prefetch" href="/hyperformula/assets/js/187.36857751.js"><link rel="prefetch" href="/hyperformula/assets/js/188.4fe61a08.js"><link rel="prefetch" href="/hyperformula/assets/js/189.499a992b.js"><link rel="prefetch" href="/hyperformula/assets/js/19.1f30a97f.js"><link rel="prefetch" href="/hyperformula/assets/js/190.59399a5f.js"><link rel="prefetch" href="/hyperformula/assets/js/191.1ffa8b34.js"><link rel="prefetch" href="/hyperformula/assets/js/192.2bbc681f.js"><link rel="prefetch" href="/hyperformula/assets/js/193.c72ac719.js"><link rel="prefetch" href="/hyperformula/assets/js/194.91a0d26e.js"><link rel="prefetch" href="/hyperformula/assets/js/195.9a981427.js"><link rel="prefetch" href="/hyperformula/assets/js/196.4afe6748.js"><link rel="prefetch" href="/hyperformula/assets/js/197.5bcf5428.js"><link rel="prefetch" href="/hyperformula/assets/js/198.6d244ba3.js"><link rel="prefetch" href="/hyperformula/assets/js/199.39a68a62.js"><link rel="prefetch" href="/hyperformula/assets/js/2.6d9d1aa4.js"><link rel="prefetch" href="/hyperformula/assets/js/20.3b25a133.js"><link rel="prefetch" href="/hyperformula/assets/js/200.9850b37c.js"><link rel="prefetch" href="/hyperformula/assets/js/201.5235f392.js"><link rel="prefetch" href="/hyperformula/assets/js/202.e5dde0b1.js"><link rel="prefetch" href="/hyperformula/assets/js/21.d74e58be.js"><link rel="prefetch" href="/hyperformula/assets/js/22.f0b36327.js"><link rel="prefetch" href="/hyperformula/assets/js/23.dfb09f9a.js"><link rel="prefetch" href="/hyperformula/assets/js/24.d222ba37.js"><link rel="prefetch" href="/hyperformula/assets/js/25.f3df5a69.js"><link rel="prefetch" href="/hyperformula/assets/js/26.79884259.js"><link rel="prefetch" href="/hyperformula/assets/js/27.6b49d773.js"><link rel="prefetch" href="/hyperformula/assets/js/28.93c863ab.js"><link rel="prefetch" href="/hyperformula/assets/js/29.ac0769e4.js"><link rel="prefetch" href="/hyperformula/assets/js/30.673bbfd9.js"><link rel="prefetch" href="/hyperformula/assets/js/31.0abfa7b2.js"><link rel="prefetch" href="/hyperformula/assets/js/32.59a9d722.js"><link rel="prefetch" href="/hyperformula/assets/js/33.c2e8af17.js"><link rel="prefetch" href="/hyperformula/assets/js/34.60c1a7e7.js"><link rel="prefetch" href="/hyperformula/assets/js/35.d697c218.js"><link rel="prefetch" href="/hyperformula/assets/js/36.e2627734.js"><link rel="prefetch" href="/hyperformula/assets/js/37.bacb61d3.js"><link rel="prefetch" href="/hyperformula/assets/js/38.5394d1df.js"><link rel="prefetch" href="/hyperformula/assets/js/39.da0a03c2.js"><link rel="prefetch" href="/hyperformula/assets/js/4.78e9b782.js"><link rel="prefetch" href="/hyperformula/assets/js/40.0de586be.js"><link rel="prefetch" href="/hyperformula/assets/js/41.64e079ba.js"><link rel="prefetch" href="/hyperformula/assets/js/42.c0f6b8ea.js"><link rel="prefetch" href="/hyperformula/assets/js/43.e4c5d0c6.js"><link rel="prefetch" href="/hyperformula/assets/js/44.dc6b5d23.js"><link rel="prefetch" href="/hyperformula/assets/js/45.be396dfb.js"><link rel="prefetch" href="/hyperformula/assets/js/46.6ef23060.js"><link rel="prefetch" href="/hyperformula/assets/js/47.da229dd7.js"><link rel="prefetch" href="/hyperformula/assets/js/48.e604830e.js"><link rel="prefetch" href="/hyperformula/assets/js/49.2c25294f.js"><link rel="prefetch" href="/hyperformula/assets/js/5.f73ffbac.js"><link rel="prefetch" href="/hyperformula/assets/js/50.aa9fe0a0.js"><link rel="prefetch" href="/hyperformula/assets/js/51.910fbdc7.js"><link rel="prefetch" href="/hyperformula/assets/js/52.b7a645d5.js"><link rel="prefetch" href="/hyperformula/assets/js/53.5c86806a.js"><link rel="prefetch" href="/hyperformula/assets/js/54.9aad3f93.js"><link rel="prefetch" href="/hyperformula/assets/js/55.638e96e7.js"><link rel="prefetch" href="/hyperformula/assets/js/56.1ed155f4.js"><link rel="prefetch" href="/hyperformula/assets/js/57.fec4c8cf.js"><link rel="prefetch" href="/hyperformula/assets/js/58.f789224b.js"><link rel="prefetch" href="/hyperformula/assets/js/59.356199c0.js"><link rel="prefetch" href="/hyperformula/assets/js/6.d047aefd.js"><link rel="prefetch" href="/hyperformula/assets/js/60.e52747e4.js"><link rel="prefetch" href="/hyperformula/assets/js/61.62eaf56d.js"><link rel="prefetch" href="/hyperformula/assets/js/62.a92c3537.js"><link rel="prefetch" href="/hyperformula/assets/js/63.a25ef084.js"><link rel="prefetch" href="/hyperformula/assets/js/64.650acfa3.js"><link rel="prefetch" href="/hyperformula/assets/js/65.29a9d114.js"><link rel="prefetch" href="/hyperformula/assets/js/66.04c59157.js"><link rel="prefetch" href="/hyperformula/assets/js/67.d58246ba.js"><link rel="prefetch" href="/hyperformula/assets/js/68.4477c70e.js"><link rel="prefetch" href="/hyperformula/assets/js/69.a6a5647a.js"><link rel="prefetch" href="/hyperformula/assets/js/7.7f6e1c61.js"><link rel="prefetch" href="/hyperformula/assets/js/70.dccdcc01.js"><link rel="prefetch" href="/hyperformula/assets/js/71.f82d976a.js"><link rel="prefetch" href="/hyperformula/assets/js/72.45855245.js"><link rel="prefetch" href="/hyperformula/assets/js/73.a0fa0612.js"><link rel="prefetch" href="/hyperformula/assets/js/74.68c960ec.js"><link rel="prefetch" href="/hyperformula/assets/js/75.92b91f7f.js"><link rel="prefetch" href="/hyperformula/assets/js/76.25842dde.js"><link rel="prefetch" href="/hyperformula/assets/js/77.3e1da26a.js"><link rel="prefetch" href="/hyperformula/assets/js/78.cf9aebc3.js"><link rel="prefetch" href="/hyperformula/assets/js/79.02889a9d.js"><link rel="prefetch" href="/hyperformula/assets/js/8.854f1290.js"><link rel="prefetch" href="/hyperformula/assets/js/80.ecb661a0.js"><link rel="prefetch" href="/hyperformula/assets/js/81.5391b7b7.js"><link rel="prefetch" href="/hyperformula/assets/js/82.01223317.js"><link rel="prefetch" href="/hyperformula/assets/js/83.0343cf65.js"><link rel="prefetch" href="/hyperformula/assets/js/84.5dfe07cd.js"><link rel="prefetch" href="/hyperformula/assets/js/85.c6b2244d.js"><link rel="prefetch" href="/hyperformula/assets/js/86.a0aa0807.js"><link rel="prefetch" href="/hyperformula/assets/js/87.5e8a325a.js"><link rel="prefetch" href="/hyperformula/assets/js/88.e4865d1e.js"><link rel="prefetch" href="/hyperformula/assets/js/89.9a29f028.js"><link rel="prefetch" href="/hyperformula/assets/js/9.b7f87417.js"><link rel="prefetch" href="/hyperformula/assets/js/90.f71c4182.js"><link rel="prefetch" href="/hyperformula/assets/js/91.0acbc812.js"><link rel="prefetch" href="/hyperformula/assets/js/92.9d198599.js"><link rel="prefetch" href="/hyperformula/assets/js/93.bdd38b40.js"><link rel="prefetch" href="/hyperformula/assets/js/94.7a1e0828.js"><link rel="prefetch" href="/hyperformula/assets/js/95.76e6fde3.js"><link rel="prefetch" href="/hyperformula/assets/js/96.8da5f167.js"><link rel="prefetch" href="/hyperformula/assets/js/97.61519c68.js"><link rel="prefetch" href="/hyperformula/assets/js/98.b76cf4fc.js"><link rel="prefetch" href="/hyperformula/assets/js/99.094d78e9.js">
    <link rel="stylesheet" href="/hyperformula/assets/css/0.styles.e1537429.css">
</head>
<body>
<!-- Google Tag Manager element -->
<iframe src='https://www.googletagmanager.com/ns.html?id=GTM-N59TZXR' height="0" width="0" style="display:none;visibility:hidden">
</iframe>
<div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/hyperformula/" class="home-link router-link-active"><img src="/hyperformula/logo.png" alt="HyperFormula (v0.4.0)" class="logo"> <span class="site-name can-hide">HyperFormula (v0.4.0)</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/hyperformula/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/hyperformula/api/" class="nav-link">
  API Reference
</a></div> <a href="https://github.com/handsontable/hyperformula" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/hyperformula/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/hyperformula/api/" class="nav-link">
  API Reference
</a></div> <a href="https://github.com/handsontable/hyperformula" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Introduction</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hyperformula/" aria-current="page" class="sidebar-link">Welcome</a></li><li><a href="/hyperformula/guide/demo.html" class="sidebar-link">Demo</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Overview</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hyperformula/guide/supported-browsers.html" class="sidebar-link">Supported browsers</a></li><li><a href="/hyperformula/guide/dependencies.html" class="sidebar-link">Dependencies</a></li><li><a href="/hyperformula/guide/licensing.html" class="sidebar-link">Licensing</a></li><li><a href="/hyperformula/guide/changelog.html" class="sidebar-link">Changelog</a></li><li><a href="/hyperformula/guide/support.html" class="sidebar-link">Support</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Getting started</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hyperformula/guide/client-side-installation.html" class="sidebar-link">Client-side installation</a></li><li><a href="/hyperformula/guide/server-side-installation.html" class="sidebar-link">Server-side installation</a></li><li><a href="/hyperformula/guide/basic-usage.html" class="sidebar-link">Basic usage</a></li><li><a href="/hyperformula/guide/advanced-usage.html" class="sidebar-link">Advanced usage</a></li><li><a href="/hyperformula/guide/configuration-options.html" class="sidebar-link">Configuration options</a></li><li><a href="/hyperformula/guide/license-key.html" class="sidebar-link">License key</a></li><li><a href="/hyperformula/guide/known-limitations.html" class="sidebar-link">Known limitations</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Framework integration</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hyperformula/guide/integration-with-react.html" class="sidebar-link">Integration with React</a></li><li><a href="/hyperformula/guide/integration-with-vue.html" class="sidebar-link">Integration with Vue</a></li><li><a href="/hyperformula/guide/integration-with-angular.html" class="sidebar-link">Integration with Angular</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Data Operations</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hyperformula/guide/basic-operations.html" class="sidebar-link">Basic operations</a></li><li><a href="/hyperformula/guide/batch-operations.html" class="sidebar-link">Batch operations</a></li><li><a href="/hyperformula/guide/clipboard-operations.html" class="sidebar-link">Clipboard operations</a></li><li><a href="/hyperformula/guide/undo-redo.html" class="sidebar-link">Undo-redo</a></li><li><a href="/hyperformula/guide/sorting-data.html" class="sidebar-link">Sorting data</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Formula Reference</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hyperformula/guide/specifications-and-limits.html" class="sidebar-link">Specifications and limits</a></li><li><a href="/hyperformula/guide/cell-references.html" class="sidebar-link">Cell references</a></li><li><a href="/hyperformula/guide/types-of-values.html" class="sidebar-link">Types of values</a></li><li><a href="/hyperformula/guide/types-of-errors.html" class="sidebar-link">Types of errors</a></li><li><a href="/hyperformula/guide/types-of-operators.html" class="sidebar-link">Types of operators</a></li><li><a href="/hyperformula/guide/order-of-precendece.html" class="sidebar-link">Order of precedence</a></li><li><a href="/hyperformula/guide/built-in-functions.html" class="sidebar-link">Built-in functions</a></li><li><a href="/hyperformula/guide/volatile-functions.html" class="sidebar-link">Volatile functions</a></li><li><a href="/hyperformula/guide/named-ranges.html" class="sidebar-link">Named ranges</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Internationalization</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hyperformula/guide/localizing-functions.html" class="sidebar-link">Localizing functions</a></li><li><a href="/hyperformula/guide/date-and-time-handling.html" class="sidebar-link">Date and time handling</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Advanced topics</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hyperformula/guide/key-concepts.html" aria-current="page" class="active sidebar-link">Key concepts</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hyperformula/guide/key-concepts.html#high-level-design-diagram" class="sidebar-link">High-level design diagram</a></li><li class="sidebar-sub-header"><a href="/hyperformula/guide/key-concepts.html#phase-1-parsing-and-construction-of-asts" class="sidebar-link">Phase 1. Parsing and construction of ASTs</a></li><li class="sidebar-sub-header"><a href="/hyperformula/guide/key-concepts.html#phase-2-construction-of-the-dependency-graph" class="sidebar-link">Phase 2. Construction of the dependency graph</a></li><li class="sidebar-sub-header"><a href="/hyperformula/guide/key-concepts.html#phase-3-evaluation" class="sidebar-link">Phase 3. Evaluation</a></li><li class="sidebar-sub-header"><a href="/hyperformula/guide/key-concepts.html#grammar" class="sidebar-link">Grammar</a></li><li class="sidebar-sub-header"><a href="/hyperformula/guide/key-concepts.html#repetitive-asts" class="sidebar-link">Repetitive ASTs</a></li><li class="sidebar-sub-header"><a href="/hyperformula/guide/key-concepts.html#relative-addressing" class="sidebar-link">Relative addressing</a></li><li class="sidebar-sub-header"><a href="/hyperformula/guide/key-concepts.html#laziness-of-crud-operations" class="sidebar-link">Laziness of CRUD operations</a></li><li class="sidebar-sub-header"><a href="/hyperformula/guide/key-concepts.html#handling-ranges" class="sidebar-link">Handling ranges</a></li></ul></li><li><a href="/hyperformula/guide/building.html" class="sidebar-link">Building</a></li><li><a href="/hyperformula/guide/testing.html" class="sidebar-link">Testing</a></li><li><a href="/hyperformula/guide/custom-functions.html" class="sidebar-link">Custom functions</a></li><li><a href="/hyperformula/guide/performance.html" class="sidebar-link">Performance</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Miscellaneous</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hyperformula/guide/contributing.html" class="sidebar-link">Contributing</a></li><li><a href="/hyperformula/guide/code-of-conduct.html" class="sidebar-link">Code of conduct</a></li><li><a href="/hyperformula/guide/branding.html" class="sidebar-link">Branding</a></li><li><a href="/hyperformula/guide/acknowledgements.html" class="sidebar-link">Acknowledgments</a></li><li><a href="/hyperformula/guide/contact.html" class="sidebar-link">Contact</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="key-concepts"><a href="#key-concepts" class="header-anchor">#</a> Key concepts</h1> <h2 id="high-level-design-diagram"><a href="#high-level-design-diagram" class="header-anchor">#</a> High-level design diagram</h2> <img src="/hyperformula/hf-high-lvl-diagram.svg"> <p>Data processing consists of three phases.</p> <h2 id="phase-1-parsing-and-construction-of-asts"><a href="#phase-1-parsing-and-construction-of-asts" class="header-anchor">#</a> Phase 1. Parsing and construction of ASTs</h2> <p>Formulas need to be parsed and represented as a
so-called
<a href="https://en.wikipedia.org/wiki/Abstract_syntax_tree" target="_blank" rel="noopener noreferrer">Abstract Syntax Tree<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
(AST). For example, the AST for <code>7*3-SIN(A5)</code> will look
similar to this graph:</p> <img src="/hyperformula/ast.png"> <h2 id="phase-2-construction-of-the-dependency-graph"><a href="#phase-2-construction-of-the-dependency-graph" class="header-anchor">#</a> Phase 2. Construction of the dependency graph</h2> <p>HyperFormula needs to understand the relationship between cells and
find the right order of processing them. For example, for a sample
formula <code>C1=A1+B1</code>, it needs to process first <code>A1</code> and <code>B1</code> and
then <code>C1</code>. Such an order of processing cells - also known as
<a href="https://en.wikipedia.org/wiki/Topological_sorting" target="_blank" rel="noopener noreferrer">topological order<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
exists if and only if there is no cycle in the dependency graph.</p> <p>There can be many such orders, like so:</p> <img src="/hyperformula/topsort.png"> <h2 id="phase-3-evaluation"><a href="#phase-3-evaluation" class="header-anchor">#</a> Phase 3. Evaluation</h2> <p>It is crucial to evaluate cells efficiently. For simple expressions,
there is not much room for maneuver, but spreadsheet-like data sets
definitely need more attention.</p> <img src="/hyperformula/sample-sheet.png"> <h2 id="grammar"><a href="#grammar" class="header-anchor">#</a> Grammar</h2> <p>For parsing purposes, the library uses the
<a href="http://sap.github.io/chevrotain/docs/" target="_blank" rel="noopener noreferrer">Chevrotain<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> parser, which turns
out to be more efficient than popular <a href="https://zaa.ch/jison/" target="_blank" rel="noopener noreferrer">Jison<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.
The language of acceptable formulas is described with an LL(k) grammar
using Chevrotain Domain Specific Language. See details of the grammar
in the
<a href="https://github.com/handsontable/hyperformula/blob/master/src/parser/FormulaParser.ts" target="_blank" rel="noopener noreferrer">FormulaParser<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
file.</p> <h2 id="repetitive-asts"><a href="#repetitive-asts" class="header-anchor">#</a> Repetitive ASTs</h2> <p>A first natural optimization could concern cells in a spreadsheet which
store exactly the same formulas. For such cells, there is no point in
constructing and storing two ASTs which would be the same in the end.
Instead, HyperFormula can look up the particular formula that has
already been parsed and reuse the constructed AST.</p> <p>A scenario with repeating formulas is somewhat idealized; in practice,
most formulas will be distinct. Fortunately, formulas in spreadsheets
usually have a defined structure and share some patterns. Neighboring
cells often contain similar formulas, especially after filling cells
using a fill handle (that little square in the bottom right corner of
a visual cell representation). For example:</p> <ul><li><code>B2=A2-C2+B1</code></li> <li><code>B3=A3-C3+B2</code></li> <li><code>B4=A4-C4+B3</code></li> <li><code>B5=A5-C5+B4</code></li> <li>and so on...</li></ul> <p>Although the exact ASTs for these formulas are different, they share a
common pattern. A very useful approach here is to rewrite a formula using
relative addressing of cells.</p> <h2 id="relative-addressing"><a href="#relative-addressing" class="header-anchor">#</a> Relative addressing</h2> <p>HyperFormula stores the offset to the referenced formula. For example
<code>B2=B5 + C1</code> can be rewritten as <code>B2=[B+0][2+3] + [B+1][2-1]</code> or in short
<code>B2=[0][+3] + [+1][-1]</code>. Then, the above example with <code>B2,B3</code>,  and <code>B4</code>
can be rewritten as <code>B2=B3=B4=[-1][0] - [1][0] + [0][-1]</code>. Now the three
cells have exactly the same formulas.</p> <p>By using relative addressing HyperFormula unifies formulas from many
cells. Thanks to that, there is no need to parse them all
over again. Also, with this approach, the engine doesn't lose any
information because by knowing the absolute address of a cell and its
formula with relative addresses, it can easily retrieve the absolute
addresses and compute the result.</p> <h2 id="laziness-of-crud-operations"><a href="#laziness-of-crud-operations" class="header-anchor">#</a> Laziness of CRUD operations</h2> <p>After each CRUD operation, like adding a row or column or moving
cells, references inside formulas may need to be changed. For example,
after adding a row, we need to shift all references in the formulas
below like so:</p> <img src="/hyperformula/crud-operations.png"> <p>In more complex sheets this can lead to similar transformations in
many formulas at once. On the other hand, such operations do not
require an immediate transformation of all the affected formulas.</p> <p>Instead of transforming all of them at once, HyperFormula remembers
the history of the operations and postpones the transformations
until the formula needs to be displayed or recalculated.</p> <h2 id="handling-ranges"><a href="#handling-ranges" class="header-anchor">#</a> Handling ranges</h2> <p>In many applications, you may want to use formulas that depend on a
large range of cells. For example, the formula <code>SUM(A1:A100)+B5</code>
depends on 101 cells and it needs to be represented in the graph of
cell dependencies accordingly.</p> <p>An interesting optimization challenge arises when the are multiple
cells that depend on large ranges. For example, consider the following
use-case:</p> <ul><li><code>B1=SUM(A1:A1)</code></li> <li><code>B2=SUM(A1:A2)</code></li> <li><code>B3=SUM(A1:A3)</code></li> <li>...</li> <li><code>B100=SUM(A1:A100)</code></li></ul> <p>The problem is that there are <code>1+2+3+...+100 = 5050</code> dependencies
for such a simple situation. In general, for <code>n</code> such rows, the
engine would need to add <code>n*(n+1)/2 ≈ n²</code> arcs in the graph. This
value grows much faster than the size of data, meaning the engine
would not be able to handle large data sets efficiently.</p> <p>A solution to this problem comes from the observation that there is
a way to rewrite the above formulas to equivalent ones, which will
be more compact to represent. Specifically, the following formulas
would compute the same values as the ones provided previously:</p> <ul><li><code>B1=A1</code></li> <li><code>B2=B1+A2</code></li> <li><code>B3=B2+A3</code></li> <li>...</li> <li><code>B100=B99+A100</code></li></ul> <p>Whereas this example is too specialized to provide a useful rule
for optimization, it shows the main idea behind efficient handling
of multiple ranges: <strong>to represent a range as a composition of
smaller ranges.</strong></p> <p>In the adopted implementation, every time the engine encounters a
range, say <code>B5:D20</code>, it checks if it has already considered the
range which is one row shorter. In this example, it would be <code>B5:D19</code>.
If so, then it represents <code>B5:D20</code> as the composition of a range
<code>B5:D19</code> and three cells in the last row: <code>B20</code>,<code>C20</code> and <code>D20</code>.</p> <img src="/hyperformula/ranges.png"> <p>More generally, the result of any associative operation is obtained
as the result of operations for these small rows. There are many
examples of such associative functions: <code>SUM</code>, <code>MAX</code>, <code>COUNT</code>, etc.
As one range can be used in different formulas, we can reuse its
node and avoid duplicating the work during computation.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/handsontable/hyperformula/edit/develop/docs/guide/key-concepts.md" target="_blank" rel="noopener noreferrer">Help us improve this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/hyperformula/guide/date-and-time-handling.html" class="prev">
        Date and time handling
      </a></span> <span class="next"><a href="/hyperformula/guide/building.html">
        Building
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
<script src="/hyperformula/assets/js/app.95f3c16f.js" defer></script><script src="/hyperformula/assets/js/3.2b0977bc.js" defer></script><script src="/hyperformula/assets/js/183.293c07cc.js" defer></script>
</body>
</html>