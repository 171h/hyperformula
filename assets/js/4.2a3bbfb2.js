(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{339:function(e,t,r){},373:function(e,t,r){(function(e){var n,i,a;r(47),r(48),r(374),r(69),r(375),r(182),r(376),r(377),r(378),r(25),r(330),r(379),r(99),r(114),r(180),r(174),r(98),r(177),r(380),r(65),r(185),r(381),r(50),r(165),r(382),r(383),r(384),r(386),r(387),r(388),r(389),r(390),r(103),r(391),r(72),r(392),r(393),r(394),r(395),r(396),r(397),r(398),r(399),r(400),r(401),r(402),r(403),r(404),r(405),r(406),r(407),r(408),r(410),r(412),r(112),r(414),r(415),r(178),r(416),r(186),r(350),r(187),r(417),r(109),r(418),r(100),r(419),r(104),r(9),r(420),r(422),r(316),r(105),r(351),r(312),r(44),r(424),r(96),r(425),r(426),r(319),r(427),r(181),r(26),r(309),r(428),r(431),r(67),r(310),r(188),r(311),r(432),r(436),r(437),r(438),r(439),r(440),r(441),r(442),r(443),r(444),r(445),r(446),r(447),r(448),r(449),r(450),r(451),r(452),r(453),r(454),r(455),r(456),r(457),r(458),r(459),r(460),r(461),r(462),r(463),r(464),r(465),r(466),r(467),r(101),r(31),r(469),r(470);var o=r(471),s=r(472),u=r(337),c=r(474),l=r(475),h=r(476),p=r(478),f=r(482),d=r(353),m;"undefined"!=typeof self&&self,
/*!
 * Copyright (c) HANDSONCODE sp. z o. o.
 * 
 * HYPERFORMULA is software distributed by HANDSONCODE sp. z o. o.,
 * a Polish corporation, based in Gdynia, Poland, at 96/98 Aleja Zwycięstwa,
 * registered with the National Court Register under number 538651,
 * EU tax ID number: PL5862294002, share capital: PLN 62,800.00.
 * 
 * This software is protected by applicable copyright laws, including
 * international treaties, and triple-licensed.
 * 
 * First, if your use involves only such purposes as education, research, study,
 * and personal use, testing and demonstration, you agree to be bound by
 * the terms included in the “non-commercial-license.pdf” file, available
 * in the main directory of this software repository.
 * 
 * Second, commercial purposes dictate more individual approach
 * and the terms of such use are subject to negotiations.
 * 
 * Third, at your option, your use of this Software – either commercial, non-commercial, or both –
 * may be subject to the GNU Affero General Public License
 * in such version as included in the “agpl-3.0.txt” file,
 * available in the main directory of this software repository.
 * 
 * HANDSONCODE PROVIDES THIS SOFTWARE ON AN “AS IS” BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND. IN NO EVENT
 * AND UNDER NO LEGAL THEORY, SHALL HANDSONCODE BE LIABLE
 * TO YOU FOR DAMAGES, INCLUDING ANY DIRECT, INDIRECT, SPECIAL,
 * INCIDENTAL, OR CONSEQUENTIAL DAMAGES OF ANY CHARACTER ARISING
 * FROM USE OR INABILITY TO USE THIS SOFTWARE.
 * 
 * Version: 0.3.0
 * Release date: 22/10/2020 (built at 22/10/2020 08:51:46)
 */
m=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===d(e)&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r(1),r(63),r(64),r(65),r(75),r(84),r(89),r(90),r(91),r(92),r(94),r(96),r(98),r(100),r(104),t.__esModule=!0,t.default=void 0;var n=r(106);t.CellType=n.CellType,t.CellValueType=n.CellValueType,t.ErrorType=n.ErrorType;var i=r(252);t.DetailedCellError=i.DetailedCellError;var a=r(253);t.ExportedCellChange=a.ExportedCellChange,t.ExportedNamedExpressionChange=a.ExportedNamedExpressionChange;var o=r(256);t.HyperFormula=o.HyperFormula;var s,u=r(289),c=(s=r(318))&&s.__esModule?s:{default:s},l=r(226);t.ConfigValueTooBigError=l.ConfigValueTooBigError,t.ConfigValueTooSmallError=l.ConfigValueTooSmallError,t.EvaluationSuspendedError=l.EvaluationSuspendedError,t.ExpectedOneOfValuesError=l.ExpectedOneOfValuesError,t.ExpectedValueOfTypeError=l.ExpectedValueOfTypeError,t.FunctionPluginValidationError=l.FunctionPluginValidationError,t.InvalidAddressError=l.InvalidAddressError,t.InvalidArgumentsError=l.InvalidArgumentsError,t.LanguageAlreadyRegisteredError=l.LanguageAlreadyRegisteredError,t.LanguageNotRegisteredError=l.LanguageNotRegisteredError,t.MatrixFormulasNotSupportedError=l.MatrixFormulasNotSupportedError,t.MissingTranslationError=l.MissingTranslationError,t.NamedExpressionDoesNotExistError=l.NamedExpressionDoesNotExistError,t.NamedExpressionNameIsAlreadyTakenError=l.NamedExpressionNameIsAlreadyTakenError,t.NamedExpressionNameIsInvalidError=l.NamedExpressionNameIsInvalidError,t.NoOperationToRedoError=l.NoOperationToRedoError,t.NoOperationToUndoError=l.NoOperationToUndoError,t.NoRelativeAddressesAllowedError=l.NoRelativeAddressesAllowedError,t.NoSheetWithIdError=l.NoSheetWithIdError,t.NoSheetWithNameError=l.NoSheetWithNameError,t.NotAFormulaError=l.NotAFormulaError,t.NothingToPasteError=l.NothingToPasteError,t.ProtectedFunctionTranslationError=l.ProtectedFunctionTranslationError,t.SheetNameAlreadyTakenError=l.SheetNameAlreadyTakenError,t.SheetSizeLimitExceededError=l.SheetSizeLimitExceededError,t.SourceLocationHasMatrixError=l.SourceLocationHasMatrixError,t.TargetLocationHasMatrixError=l.TargetLocationHasMatrixError,t.UnableToParseError=l.UnableToParseError;var h=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==m(e)&&"function"!=typeof e)return{default:e};var t=f();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=n?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(r,i,a):r[i]=e[i]}return r.default=e,t&&t.set(e,r),r}(r(319)),p=r(338);function f(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return f=function(){return e},e}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=T(e);if(t){var i=T(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return E(this,r)}}function E(e,t){return!t||"object"!==m(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}t.FunctionPlugin=p.FunctionPlugin;var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(r,e);var t=v(r);function r(){return y(this,r),t.apply(this,arguments)}return r}(o.HyperFormula);b.HyperFormula=o.HyperFormula,b.ErrorType=n.ErrorType,b.CellType=n.CellType,b.CellValueType=n.CellValueType,b.DetailedCellError=i.DetailedCellError,b.ExportedCellChange=a.ExportedCellChange,b.ExportedNamedExpressionChange=a.ExportedNamedExpressionChange,b.ConfigValueTooBigError=l.ConfigValueTooBigError,b.ConfigValueTooSmallError=l.ConfigValueTooSmallError,b.EvaluationSuspendedError=l.EvaluationSuspendedError,b.ExpectedOneOfValuesError=l.ExpectedOneOfValuesError,b.ExpectedValueOfTypeError=l.ExpectedValueOfTypeError,b.FunctionPlugin=p.FunctionPlugin,b.FunctionPluginValidationError=l.FunctionPluginValidationError,b.InvalidAddressError=l.InvalidAddressError,b.InvalidArgumentsError=l.InvalidArgumentsError,b.LanguageNotRegisteredError=l.LanguageNotRegisteredError,b.LanguageAlreadyRegisteredError=l.LanguageAlreadyRegisteredError,b.MatrixFormulasNotSupportedError=l.MatrixFormulasNotSupportedError,b.MissingTranslationError=l.MissingTranslationError,b.NamedExpressionDoesNotExistError=l.NamedExpressionDoesNotExistError,b.NamedExpressionNameIsAlreadyTakenError=l.NamedExpressionNameIsAlreadyTakenError,b.NamedExpressionNameIsInvalidError=l.NamedExpressionNameIsInvalidError,b.NoOperationToRedoError=l.NoOperationToRedoError,b.NoOperationToUndoError=l.NoOperationToUndoError,b.NoRelativeAddressesAllowedError=l.NoRelativeAddressesAllowedError,b.NoSheetWithIdError=l.NoSheetWithIdError,b.NoSheetWithNameError=l.NoSheetWithNameError,b.NotAFormulaError=l.NotAFormulaError,b.NothingToPasteError=l.NothingToPasteError,b.ProtectedFunctionTranslationError=l.ProtectedFunctionTranslationError,b.SheetNameAlreadyTakenError=l.SheetNameAlreadyTakenError,b.SheetSizeLimitExceededError=l.SheetSizeLimitExceededError,b.SourceLocationHasMatrixError=l.SourceLocationHasMatrixError,b.TargetLocationHasMatrixError=l.TargetLocationHasMatrixError,b.UnableToParseError=l.UnableToParseError;var x=u.Config.defaultConfig.language;o.HyperFormula.registerLanguage(x,c.default),o.HyperFormula.languages[c.default.langCode]=c.default;var A,S=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}(Object.getOwnPropertyNames(h));try{for(S.s();!(A=S.n()).done;){var R=A.value;R.startsWith("_")||o.HyperFormula.registerFunctionPlugin(h[R])}}catch(e){S.e(e)}finally{S.f()}var w=b;t.default=w},function(e,t,r){"use strict";var n=r(2),i=r(3),a=r(35),o=r(30),s=r(6),u=r(46),c=r(47),l=r(7),h=r(16),p=r(48),f=r(15),m=r(21),y=r(49),g=r(10),v=r(14),E=r(9),T=r(50),b=r(52),x=r(37),A=r(54),S=r(44),R=r(5),w=r(20),C=r(8),O=r(19),k=r(22),N=r(29),_=r(28),I=r(32),M=r(31),P=r(55),L=r(56),F=r(57),D=r(58),U=r(26),V=r(59).forEach,j=_("hidden"),G=P("toPrimitive"),B=U.set,z=U.getterFor("Symbol"),W=Object.prototype,K=i.Symbol,H=a("JSON","stringify"),X=R.f,Y=w.f,q=A.f,$=C.f,Q=N("symbols"),Z=N("op-symbols"),J=N("string-to-symbol-registry"),ee=N("symbol-to-string-registry"),te=N("wks"),re=i.QObject,ne=!re||!re.prototype||!re.prototype.findChild,ie=s&&l((function(){return 7!=T(Y({},"a",{get:function(){return Y(this,"a",{value:7}).a}})).a}))?function(e,t,r){var n=X(W,t);n&&delete W[t],Y(e,t,r),n&&e!==W&&Y(W,t,n)}:Y,ae=function(e,t){var r=Q[e]=T(K.prototype);return B(r,{type:"Symbol",tag:e,description:t}),s||(r.description=t),r},oe=c?function(e){return"symbol"==d(e)}:function(e){return Object(e)instanceof K},se=function(e,t,r){e===W&&se(Z,t,r),m(e);var n=v(t,!0);return m(r),h(Q,n)?(r.enumerable?(h(e,j)&&e[j][n]&&(e[j][n]=!1),r=T(r,{enumerable:E(0,!1)})):(h(e,j)||Y(e,j,E(1,{})),e[j][n]=!0),ie(e,n,r)):Y(e,n,r)},ue=function(e,t){m(e);var r=g(t),n=b(r).concat(pe(r));return V(n,(function(t){s&&!ce.call(r,t)||se(e,t,r[t])})),e},ce=function(e){var t=v(e,!0),r=$.call(this,t);return!(this===W&&h(Q,t)&&!h(Z,t))&&(!(r||!h(this,t)||!h(Q,t)||h(this,j)&&this[j][t])||r)},le=function(e,t){var r=g(e),n=v(t,!0);if(r!==W||!h(Q,n)||h(Z,n)){var i=X(r,n);return!i||!h(Q,n)||h(r,j)&&r[j][n]||(i.enumerable=!0),i}},he=function(e){var t=q(g(e)),r=[];return V(t,(function(e){h(Q,e)||h(I,e)||r.push(e)})),r},pe=function(e){var t=e===W,r=q(t?Z:g(e)),n=[];return V(r,(function(e){!h(Q,e)||t&&!h(W,e)||n.push(Q[e])})),n};u||(k((K=function(){if(this instanceof K)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=M(e),r=function e(r){this===W&&e.call(Z,r),h(this,j)&&h(this[j],t)&&(this[j][t]=!1),ie(this,t,E(1,r))};return s&&ne&&ie(W,t,{configurable:!0,set:r}),ae(t,e)}).prototype,"toString",(function(){return z(this).tag})),k(K,"withoutSetter",(function(e){return ae(M(e),e)})),C.f=ce,w.f=se,R.f=le,x.f=A.f=he,S.f=pe,L.f=function(e){return ae(P(e),e)},s&&(Y(K.prototype,"description",{configurable:!0,get:function(){return z(this).description}}),o||k(W,"propertyIsEnumerable",ce,{unsafe:!0}))),n({global:!0,wrap:!0,forced:!u,sham:!u},{Symbol:K}),V(b(te),(function(e){F(e)})),n({target:"Symbol",stat:!0,forced:!u},{for:function(e){var t=String(e);if(h(J,t))return J[t];var r=K(t);return J[t]=r,ee[r]=t,r},keyFor:function(e){if(!oe(e))throw TypeError(e+" is not a symbol");if(h(ee,e))return ee[e]},useSetter:function(){ne=!0},useSimple:function(){ne=!1}}),n({target:"Object",stat:!0,forced:!u,sham:!s},{create:function(e,t){return void 0===t?T(e):ue(T(e),t)},defineProperty:se,defineProperties:ue,getOwnPropertyDescriptor:le}),n({target:"Object",stat:!0,forced:!u},{getOwnPropertyNames:he,getOwnPropertySymbols:pe}),n({target:"Object",stat:!0,forced:l((function(){S.f(1)}))},{getOwnPropertySymbols:function(e){return S.f(y(e))}}),H&&n({target:"JSON",stat:!0,forced:!u||l((function(){var e=K();return"[null]"!=H([e])||"{}"!=H({a:e})||"{}"!=H(Object(e))}))},{stringify:function(e,t,r){for(var n,i=[e],a=1;arguments.length>a;)i.push(arguments[a++]);if(n=t,(f(t)||void 0!==e)&&!oe(e))return p(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!oe(t))return t}),i[1]=t,H.apply(null,i)}}),K.prototype[G]||O(K.prototype,G,K.prototype.valueOf),D(K,"Symbol"),I[j]=!0},function(e,t,r){var n=r(3),i=r(5).f,a=r(19),o=r(22),s=r(23),u=r(33),c=r(45);e.exports=function(e,t){var r,l,h,p,f,m=e.target,y=e.global,g=e.stat;if(r=y?n:g?n[m]||s(m,{}):(n[m]||{}).prototype)for(l in t){if(p=t[l],h=e.noTargetGet?(f=i(r,l))&&f.value:r[l],!c(y?l:m+(g?".":"#")+l,e.forced)&&void 0!==h){if(d(p)===d(h))continue;u(p,h)}(e.sham||h&&h.sham)&&a(p,"sham",!0),o(r,l,p,e)}}},function(e,t,r){(function(t){var r=function(e){return e&&e.Math==Math&&e};e.exports=r("object"==("undefined"==typeof globalThis?"undefined":d(globalThis))&&globalThis)||r("object"==("undefined"==typeof window?"undefined":d(window))&&window)||r("object"==("undefined"==typeof self?"undefined":d(self))&&self)||r("object"==d(t)&&t)||Function("return this")()}).call(this,r(4))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"===("undefined"==typeof window?"undefined":d(window))&&(r=window)}e.exports=r},function(e,t,r){var n=r(6),i=r(8),a=r(9),o=r(10),s=r(14),u=r(16),c=r(17),l=Object.getOwnPropertyDescriptor;t.f=n?l:function(e,t){if(e=o(e),t=s(t,!0),c)try{return l(e,t)}catch(e){}if(u(e,t))return a(!i.f.call(e,t),e[t])}},function(e,t,r){var n=r(7);e.exports=!n((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,r){"use strict";var n={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,a=i&&!n.call({1:2},1);t.f=a?function(e){var t=i(this,e);return!!t&&t.enumerable}:n},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,r){var n=r(11),i=r(13);e.exports=function(e){return n(i(e))}},function(e,t,r){var n=r(7),i=r(12),a="".split;e.exports=n((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==i(e)?a.call(e,""):Object(e)}:Object},function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e}},function(e,t,r){var n=r(15);e.exports=function(e,t){if(!n(e))return e;var r,i;if(t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;if("function"==typeof(r=e.valueOf)&&!n(i=r.call(e)))return i;if(!t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e){return"object"===d(e)?null!==e:"function"==typeof e}},function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},function(e,t,r){var n=r(6),i=r(7),a=r(18);e.exports=!n&&!i((function(){return 7!=Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a}))},function(e,t,r){var n=r(3),i=r(15),a=n.document,o=i(a)&&i(a.createElement);e.exports=function(e){return o?a.createElement(e):{}}},function(e,t,r){var n=r(6),i=r(20),a=r(9);e.exports=n?function(e,t,r){return i.f(e,t,a(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t,r){var n=r(6),i=r(17),a=r(21),o=r(14),s=Object.defineProperty;t.f=n?s:function(e,t,r){if(a(e),t=o(t,!0),a(r),i)try{return s(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(e[t]=r.value),e}},function(e,t,r){var n=r(15);e.exports=function(e){if(!n(e))throw TypeError(String(e)+" is not an object");return e}},function(e,t,r){var n=r(3),i=r(19),a=r(16),o=r(23),s=r(24),u=r(26),c=u.get,l=u.enforce,h=String(String).split("String");(e.exports=function(e,t,r,s){var u=!!s&&!!s.unsafe,c=!!s&&!!s.enumerable,p=!!s&&!!s.noTargetGet;"function"==typeof r&&("string"!=typeof t||a(r,"name")||i(r,"name",t),l(r).source=h.join("string"==typeof t?t:"")),e!==n?(u?!p&&e[t]&&(c=!0):delete e[t],c?e[t]=r:i(e,t,r)):c?e[t]=r:o(t,r)})(Function.prototype,"toString",(function(){return"function"==typeof this&&c(this).source||s(this)}))},function(e,t,r){var n=r(3),i=r(19);e.exports=function(e,t){try{i(n,e,t)}catch(r){n[e]=t}return t}},function(e,t,r){var n=r(25),i=Function.toString;"function"!=typeof n.inspectSource&&(n.inspectSource=function(e){return i.call(e)}),e.exports=n.inspectSource},function(e,t,r){var n=r(3),i=r(23),a=n["__core-js_shared__"]||i("__core-js_shared__",{});e.exports=a},function(e,t,r){var n,i,a,o=r(27),s=r(3),u=r(15),c=r(19),l=r(16),h=r(28),p=r(32),f=s.WeakMap;if(o){var d=new f,m=d.get,y=d.has,g=d.set;n=function(e,t){return g.call(d,e,t),t},i=function(e){return m.call(d,e)||{}},a=function(e){return y.call(d,e)}}else{var v=h("state");p[v]=!0,n=function(e,t){return c(e,v,t),t},i=function(e){return l(e,v)?e[v]:{}},a=function(e){return l(e,v)}}e.exports={set:n,get:i,has:a,enforce:function(e){return a(e)?i(e):n(e,{})},getterFor:function(e){return function(t){var r;if(!u(t)||(r=i(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return r}}}},function(e,t,r){var n=r(3),i=r(24),a=n.WeakMap;e.exports="function"==typeof a&&/native code/.test(i(a))},function(e,t,r){var n=r(29),i=r(31),a=n("keys");e.exports=function(e){return a[e]||(a[e]=i(e))}},function(e,t,r){var n=r(30),i=r(25);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.6.5",mode:n?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t){e.exports=!1},function(e,t){var r=0,n=Math.random();e.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++r+n).toString(36)}},function(e,t){e.exports={}},function(e,t,r){var n=r(16),i=r(34),a=r(5),o=r(20);e.exports=function(e,t){for(var r=i(t),s=o.f,u=a.f,c=0;c<r.length;c++){var l=r[c];n(e,l)||s(e,l,u(t,l))}}},function(e,t,r){var n=r(35),i=r(37),a=r(44),o=r(21);e.exports=n("Reflect","ownKeys")||function(e){var t=i.f(o(e)),r=a.f;return r?t.concat(r(e)):t}},function(e,t,r){var n=r(36),i=r(3),a=function(e){return"function"==typeof e?e:void 0};e.exports=function(e,t){return arguments.length<2?a(n[e])||a(i[e]):n[e]&&n[e][t]||i[e]&&i[e][t]}},function(e,t,r){var n=r(3);e.exports=n},function(e,t,r){var n=r(38),i=r(43).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,i)}},function(e,t,r){var n=r(16),i=r(10),a=r(39).indexOf,o=r(32);e.exports=function(e,t){var r,s=i(e),u=0,c=[];for(r in s)!n(o,r)&&n(s,r)&&c.push(r);for(;t.length>u;)n(s,r=t[u++])&&(~a(c,r)||c.push(r));return c}},function(e,t,r){var n=r(10),i=r(40),a=r(42),o=function(e){return function(t,r,o){var s,u=n(t),c=i(u.length),l=a(o,c);if(e&&r!=r){for(;c>l;)if((s=u[l++])!=s)return!0}else for(;c>l;l++)if((e||l in u)&&u[l]===r)return e||l||0;return!e&&-1}};e.exports={includes:o(!0),indexOf:o(!1)}},function(e,t,r){var n=r(41),i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}},function(e,t){var r=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:r)(e)}},function(e,t,r){var n=r(41),i=Math.max,a=Math.min;e.exports=function(e,t){var r=n(e);return r<0?i(r+t,0):a(r,t)}},function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,r){var n=r(7),i=/#|\.prototype\./,a=function(e,t){var r=s[o(e)];return r==c||r!=u&&("function"==typeof t?n(t):!!t)},o=a.normalize=function(e){return String(e).replace(i,".").toLowerCase()},s=a.data={},u=a.NATIVE="N",c=a.POLYFILL="P";e.exports=a},function(e,t,r){var n=r(7);e.exports=!!Object.getOwnPropertySymbols&&!n((function(){return!String(Symbol())}))},function(e,t,r){var n=r(46);e.exports=n&&!Symbol.sham&&"symbol"==d(Symbol.iterator)},function(e,t,r){var n=r(12);e.exports=Array.isArray||function(e){return"Array"==n(e)}},function(e,t,r){var n=r(13);e.exports=function(e){return Object(n(e))}},function(e,t,r){var n,i=r(21),a=r(51),o=r(43),s=r(32),u=r(53),c=r(18),l=r(28),h=l("IE_PROTO"),p=function(){},f=function(e){return"<script>"+e+"<\/script>"},d=function(){try{n=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e,t;d=n?function(e){e.write(f("")),e.close();var t=e.parentWindow.Object;return e=null,t}(n):((t=c("iframe")).style.display="none",u.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(f("document.F=Object")),e.close(),e.F);for(var r=o.length;r--;)delete d.prototype[o[r]];return d()};s[h]=!0,e.exports=Object.create||function(e,t){var r;return null!==e?(p.prototype=i(e),r=new p,p.prototype=null,r[h]=e):r=d(),void 0===t?r:a(r,t)}},function(e,t,r){var n=r(6),i=r(20),a=r(21),o=r(52);e.exports=n?Object.defineProperties:function(e,t){a(e);for(var r,n=o(t),s=n.length,u=0;s>u;)i.f(e,r=n[u++],t[r]);return e}},function(e,t,r){var n=r(38),i=r(43);e.exports=Object.keys||function(e){return n(e,i)}},function(e,t,r){var n=r(35);e.exports=n("document","documentElement")},function(e,t,r){var n=r(10),i=r(37).f,a={}.toString,o="object"==("undefined"==typeof window?"undefined":d(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return o&&"[object Window]"==a.call(e)?function(e){try{return i(e)}catch(e){return o.slice()}}(e):i(n(e))}},function(e,t,r){var n=r(3),i=r(29),a=r(16),o=r(31),s=r(46),u=r(47),c=i("wks"),l=n.Symbol,h=u?l:l&&l.withoutSetter||o;e.exports=function(e){return a(c,e)||(s&&a(l,e)?c[e]=l[e]:c[e]=h("Symbol."+e)),c[e]}},function(e,t,r){var n=r(55);t.f=n},function(e,t,r){var n=r(36),i=r(16),a=r(56),o=r(20).f;e.exports=function(e){var t=n.Symbol||(n.Symbol={});i(t,e)||o(t,e,{value:a.f(e)})}},function(e,t,r){var n=r(20).f,i=r(16),a=r(55)("toStringTag");e.exports=function(e,t,r){e&&!i(e=r?e:e.prototype,a)&&n(e,a,{configurable:!0,value:t})}},function(e,t,r){var n=r(60),i=r(11),a=r(49),o=r(40),s=r(62),u=[].push,c=function(e){var t=1==e,r=2==e,c=3==e,l=4==e,h=6==e,p=5==e||h;return function(f,d,m,y){for(var g,v,E=a(f),T=i(E),b=n(d,m,3),x=o(T.length),A=0,S=y||s,R=t?S(f,x):r?S(f,0):void 0;x>A;A++)if((p||A in T)&&(v=b(g=T[A],A,E),e))if(t)R[A]=v;else if(v)switch(e){case 3:return!0;case 5:return g;case 6:return A;case 2:u.call(R,g)}else if(l)return!1;return h?-1:c||l?l:R}};e.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6)}},function(e,t,r){var n=r(61);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 0:return function(){return e.call(t)};case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}},function(e,t,r){var n=r(15),i=r(48),a=r(55)("species");e.exports=function(e,t){var r;return i(e)&&("function"!=typeof(r=e.constructor)||r!==Array&&!i(r.prototype)?n(r)&&null===(r=r[a])&&(r=void 0):r=void 0),new(void 0===r?Array:r)(0===t?0:t)}},function(e,t,r){"use strict";var n=r(2),i=r(6),a=r(3),o=r(16),s=r(15),u=r(20).f,c=r(33),l=a.Symbol;if(i&&"function"==typeof l&&(!("description"in l.prototype)||void 0!==l().description)){var h={},p=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof p?new l(e):void 0===e?l():l(e);return""===e&&(h[t]=!0),t};c(p,l);var f=p.prototype=l.prototype;f.constructor=p;var d=f.toString,m="Symbol(test)"==String(l("test")),y=/^Symbol\((.*)\)[^)]+$/;u(f,"description",{configurable:!0,get:function(){var e=s(this)?this.valueOf():this,t=d.call(e);if(o(h,e))return"";var r=m?t.slice(7,-1):t.replace(y,"$1");return""===r?void 0:r}}),n({global:!0,forced:!0},{Symbol:p})}},function(e,t,r){r(57)("iterator")},function(e,t,r){var n=r(2),i=r(66);n({target:"Array",stat:!0,forced:!r(74)((function(e){Array.from(e)}))},{from:i})},function(e,t,r){"use strict";var n=r(60),i=r(49),a=r(67),o=r(68),s=r(40),u=r(70),c=r(71);e.exports=function(e){var t,r,l,h,p,f,d=i(e),m="function"==typeof this?this:Array,y=arguments.length,g=y>1?arguments[1]:void 0,v=void 0!==g,E=c(d),T=0;if(v&&(g=n(g,y>2?arguments[2]:void 0,2)),null==E||m==Array&&o(E))for(r=new m(t=s(d.length));t>T;T++)f=v?g(d[T],T):d[T],u(r,T,f);else for(p=(h=E.call(d)).next,r=new m;!(l=p.call(h)).done;T++)f=v?a(h,g,[l.value,T],!0):l.value,u(r,T,f);return r.length=T,r}},function(e,t,r){var n=r(21);e.exports=function(e,t,r,i){try{return i?t(n(r)[0],r[1]):t(r)}catch(t){var a=e.return;throw void 0!==a&&n(a.call(e)),t}}},function(e,t,r){var n=r(55),i=r(69),a=n("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||o[a]===e)}},function(e,t){e.exports={}},function(e,t,r){"use strict";var n=r(14),i=r(20),a=r(9);e.exports=function(e,t,r){var o=n(t);o in e?i.f(e,o,a(0,r)):e[o]=r}},function(e,t,r){var n=r(72),i=r(69),a=r(55)("iterator");e.exports=function(e){if(null!=e)return e[a]||e["@@iterator"]||i[n(e)]}},function(e,t,r){var n=r(73),i=r(12),a=r(55)("toStringTag"),o="Arguments"==i(function(){return arguments}());e.exports=n?i:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),a))?r:o?i(t):"Object"==(n=i(t))&&"function"==typeof t.callee?"Arguments":n}},function(e,t,r){var n={};n[r(55)("toStringTag")]="z",e.exports="[object z]"===String(n)},function(e,t,r){var n=r(55)("iterator"),i=!1;try{var a=0,o={next:function(){return{done:!!a++}},return:function(){i=!0}};o[n]=function(){return this},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var r=!1;try{var a={};a[n]=function(){return{next:function(){return{done:r=!0}}}},e(a)}catch(e){}return r}},function(e,t,r){"use strict";var n=r(10),i=r(76),a=r(69),o=r(26),s=r(77),u=o.set,c=o.getterFor("Array Iterator");e.exports=s(Array,"Array",(function(e,t){u(this,{type:"Array Iterator",target:n(e),index:0,kind:t})}),(function(){var e=c(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:t[n],done:!1}:{value:[n,t[n]],done:!1}}),"values"),a.Arguments=a.Array,i("keys"),i("values"),i("entries")},function(e,t,r){var n=r(55),i=r(50),a=r(20),o=n("unscopables"),s=Array.prototype;null==s[o]&&a.f(s,o,{configurable:!0,value:i(null)}),e.exports=function(e){s[o][e]=!0}},function(e,t,r){"use strict";var n=r(2),i=r(78),a=r(80),o=r(82),s=r(58),u=r(19),c=r(22),l=r(55),h=r(30),p=r(69),f=r(79),d=f.IteratorPrototype,m=f.BUGGY_SAFARI_ITERATORS,y=l("iterator"),g=function(){return this};e.exports=function(e,t,r,l,f,v,E){i(r,t,l);var T,b,x,A=function(e){if(e===f&&O)return O;if(!m&&e in w)return w[e];switch(e){case"keys":case"values":case"entries":return function(){return new r(this,e)}}return function(){return new r(this)}},S=t+" Iterator",R=!1,w=e.prototype,C=w[y]||w["@@iterator"]||f&&w[f],O=!m&&C||A(f),k="Array"==t&&w.entries||C;if(k&&(T=a(k.call(new e)),d!==Object.prototype&&T.next&&(h||a(T)===d||(o?o(T,d):"function"!=typeof T[y]&&u(T,y,g)),s(T,S,!0,!0),h&&(p[S]=g))),"values"==f&&C&&"values"!==C.name&&(R=!0,O=function(){return C.call(this)}),h&&!E||w[y]===O||u(w,y,O),p[t]=O,f)if(b={values:A("values"),keys:v?O:A("keys"),entries:A("entries")},E)for(x in b)(m||R||!(x in w))&&c(w,x,b[x]);else n({target:t,proto:!0,forced:m||R},b);return b}},function(e,t,r){"use strict";var n=r(79).IteratorPrototype,i=r(50),a=r(9),o=r(58),s=r(69),u=function(){return this};e.exports=function(e,t,r){var c=t+" Iterator";return e.prototype=i(n,{next:a(1,r)}),o(e,c,!1,!0),s[c]=u,e}},function(e,t,r){"use strict";var n,i,a,o=r(80),s=r(19),u=r(16),c=r(55),l=r(30),h=c("iterator"),p=!1;[].keys&&("next"in(a=[].keys())?(i=o(o(a)))!==Object.prototype&&(n=i):p=!0),null==n&&(n={}),l||u(n,h)||s(n,h,(function(){return this})),e.exports={IteratorPrototype:n,BUGGY_SAFARI_ITERATORS:p}},function(e,t,r){var n=r(16),i=r(49),a=r(28),o=r(81),s=a("IE_PROTO"),u=Object.prototype;e.exports=o?Object.getPrototypeOf:function(e){return e=i(e),n(e,s)?e[s]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?u:null}},function(e,t,r){var n=r(7);e.exports=!n((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},function(e,t,r){var n=r(21),i=r(83);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(r,[]),t=r instanceof Array}catch(e){}return function(r,a){return n(r),i(a),t?e.call(r,a):r.__proto__=a,r}}():void 0)},function(e,t,r){var n=r(15);e.exports=function(e){if(!n(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype");return e}},function(e,t,r){"use strict";var n=r(2),i=r(15),a=r(48),o=r(42),s=r(40),u=r(10),c=r(70),l=r(55),h=r(85),p=r(88),f=h("slice"),d=p("slice",{ACCESSORS:!0,0:0,1:2}),m=l("species"),y=[].slice,g=Math.max;n({target:"Array",proto:!0,forced:!f||!d},{slice:function(e,t){var r,n,l,h=u(this),p=s(h.length),f=o(e,p),d=o(void 0===t?p:t,p);if(a(h)&&("function"!=typeof(r=h.constructor)||r!==Array&&!a(r.prototype)?i(r)&&null===(r=r[m])&&(r=void 0):r=void 0,r===Array||void 0===r))return y.call(h,f,d);for(n=new(void 0===r?Array:r)(g(d-f,0)),l=0;f<d;f++,l++)f in h&&c(n,l,h[f]);return n.length=l,n}})},function(e,t,r){var n=r(7),i=r(55),a=r(86),o=i("species");e.exports=function(e){return a>=51||!n((function(){var t=[];return(t.constructor={})[o]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},function(e,t,r){var n,i,a=r(3),o=r(87),s=a.process,u=s&&s.versions,c=u&&u.v8;c?i=(n=c.split("."))[0]+n[1]:o&&(!(n=o.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=o.match(/Chrome\/(\d+)/))&&(i=n[1]),e.exports=i&&+i},function(e,t,r){var n=r(35);e.exports=n("navigator","userAgent")||""},function(e,t,r){var n=r(6),i=r(7),a=r(16),o=Object.defineProperty,s={},u=function(e){throw e};e.exports=function(e,t){if(a(s,e))return s[e];t||(t={});var r=[][e],c=!!a(t,"ACCESSORS")&&t.ACCESSORS,l=a(t,0)?t[0]:u,h=a(t,1)?t[1]:void 0;return s[e]=!!r&&!i((function(){if(c&&!n)return!0;var e={length:-1};c?o(e,1,{enumerable:!0,get:u}):e[1]=1,r.call(e,l,h)}))}},function(e,t,r){var n=r(6),i=r(20).f,a=Function.prototype,o=a.toString,s=/^\s*function ([^ (]*)/;n&&!("name"in a)&&i(a,"name",{configurable:!0,get:function(){try{return o.call(this).match(s)[1]}catch(e){return""}}})},function(e,t,r){var n=r(2),i=r(7),a=r(54).f;n({target:"Object",stat:!0,forced:i((function(){return!Object.getOwnPropertyNames(1)}))},{getOwnPropertyNames:a})},function(e,t,r){var n=r(2),i=r(7),a=r(49),o=r(80),s=r(81);n({target:"Object",stat:!0,forced:i((function(){o(1)})),sham:!s},{getPrototypeOf:function(e){return o(a(e))}})},function(e,t,r){var n=r(73),i=r(22),a=r(93);n||i(Object.prototype,"toString",a,{unsafe:!0})},function(e,t,r){"use strict";var n=r(73),i=r(72);e.exports=n?{}.toString:function(){return"[object "+i(this)+"]"}},function(e,t,r){var n=r(2),i=r(35),a=r(61),o=r(21),s=r(15),u=r(50),c=r(95),l=r(7),h=i("Reflect","construct"),p=l((function(){function e(){}return!(h((function(){}),[],e)instanceof e)})),f=!l((function(){h((function(){}))})),d=p||f;n({target:"Reflect",stat:!0,forced:d,sham:d},{construct:function(e,t){a(e),o(t);var r=arguments.length<3?e:a(arguments[2]);if(f&&!p)return h(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return n.push.apply(n,t),new(c.apply(e,n))}var i=r.prototype,l=u(s(i)?i:Object.prototype),d=Function.apply.call(e,l,t);return s(d)?d:l}})},function(e,t,r){"use strict";var n=r(61),i=r(15),a=[].slice,o={},s=function(e,t,r){if(!(t in o)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";o[t]=Function("C,a","return new C("+n.join(",")+")")}return o[t](e,r)};e.exports=Function.bind||function(e){var t=n(this),r=a.call(arguments,1),o=function(){var n=r.concat(a.call(arguments));return this instanceof o?s(t,n.length,n):t.apply(e,n)};return i(t.prototype)&&(o.prototype=t.prototype),o}},function(e,t,r){"use strict";var n=r(22),i=r(21),a=r(7),o=r(97),s=RegExp.prototype,u=s.toString,c=a((function(){return"/a/b"!=u.call({source:"a",flags:"b"})})),l="toString"!=u.name;(c||l)&&n(RegExp.prototype,"toString",(function(){var e=i(this),t=String(e.source),r=e.flags;return"/"+t+"/"+String(void 0===r&&e instanceof RegExp&&!("flags"in s)?o.call(e):r)}),{unsafe:!0})},function(e,t,r){"use strict";var n=r(21);e.exports=function(){var e=n(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,r){"use strict";var n=r(99).charAt,i=r(26),a=r(77),o=i.set,s=i.getterFor("String Iterator");a(String,"String",(function(e){o(this,{type:"String Iterator",string:String(e),index:0})}),(function(){var e,t=s(this),r=t.string,i=t.index;return i>=r.length?{value:void 0,done:!0}:(e=n(r,i),t.index+=e.length,{value:e,done:!1})}))},function(e,t,r){var n=r(41),i=r(13),a=function(e){return function(t,r){var a,o,s=String(i(t)),u=n(r),c=s.length;return u<0||u>=c?e?"":void 0:(a=s.charCodeAt(u))<55296||a>56319||u+1===c||(o=s.charCodeAt(u+1))<56320||o>57343?e?s.charAt(u):a:e?s.slice(u,u+2):o-56320+(a-55296<<10)+65536}};e.exports={codeAt:a(!1),charAt:a(!0)}},function(e,t,r){"use strict";var n,i=r(2),a=r(5).f,o=r(40),s=r(101),u=r(13),c=r(103),l=r(30),h="".startsWith,p=Math.min,f=c("startsWith");i({target:"String",proto:!0,forced:!(!l&&!f&&(n=a(String.prototype,"startsWith"),n&&!n.writable)||f)},{startsWith:function(e){var t=String(u(this));s(e);var r=o(p(arguments.length>1?arguments[1]:void 0,t.length)),n=String(e);return h?h.call(t,n,r):t.slice(r,r+n.length)===n}})},function(e,t,r){var n=r(102);e.exports=function(e){if(n(e))throw TypeError("The method doesn't accept regular expressions");return e}},function(e,t,r){var n=r(15),i=r(12),a=r(55)("match");e.exports=function(e){var t;return n(e)&&(void 0!==(t=e[a])?!!t:"RegExp"==i(e))}},function(e,t,r){var n=r(55)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[n]=!1,"/./"[e](t)}catch(e){}}return!1}},function(e,t,r){var n=r(3),i=r(105),a=r(75),o=r(19),s=r(55),u=s("iterator"),c=s("toStringTag"),l=a.values;for(var h in i){var p=n[h],f=p&&p.prototype;if(f){if(f[u]!==l)try{o(f,u,l)}catch(e){f[u]=l}if(f[c]||o(f,c,h),i[h])for(var d in a)if(f[d]!==a[d])try{o(f,d,a[d])}catch(e){f[d]=a[d]}}}},function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(92),r(98),r(104),t.__esModule=!0,t.absoluteSheetReference=t.movedSimpleCellAddress=t.invalidSimpleCellAddress=t.simpleCellAddress=t.simpleColumnAddress=t.simpleRowAddress=t.CellError=t.getCellValueType=t.CellValueTypeOrd=t.CellValueType=t.getCellType=t.CellType=t.EmptyValue=t.ErrorType=void 0;var n,i=r(107),a=r(213),o=r(246);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}t.ErrorType=n,function(e){e.DIV_BY_ZERO="DIV_BY_ZERO",e.NAME="NAME",e.VALUE="VALUE",e.NUM="NUM",e.NA="NA",e.CYCLE="CYCLE",e.REF="REF",e.LIC="LIC",e.ERROR="ERROR"}(n||(t.ErrorType=n={}));var c,l,h=Symbol("Empty value");t.EmptyValue=h,t.CellType=c,function(e){e.FORMULA="FORMULA",e.VALUE="VALUE",e.MATRIX="MATRIX",e.EMPTY="EMPTY"}(c||(t.CellType=c={})),t.getCellType=function(e){return e instanceof i.FormulaCellVertex||e instanceof i.ParsingErrorVertex?c.FORMULA:e instanceof i.ValueCellVertex||e instanceof i.MatrixVertex&&e.isNumeric()?c.VALUE:e instanceof i.MatrixVertex&&e.isFormula()?c.MATRIX:c.EMPTY},t.CellValueType=l,function(e){e.EMPTY="EMPTY",e.NUMBER="NUMBER",e.STRING="STRING",e.BOOLEAN="BOOLEAN",e.ERROR="ERROR"}(l||(t.CellValueType=l={})),t.CellValueTypeOrd=function(e){switch(e){case l.EMPTY:return 0;case l.NUMBER:return 1;case l.STRING:return 2;case l.BOOLEAN:return 3;case l.ERROR:return 4}},t.getCellValueType=function(e){if(e===h)return l.EMPTY;if(e instanceof p||e instanceof o.SimpleRangeValue)return l.ERROR;switch(u(e)){case"string":return l.STRING;case"number":return l.NUMBER;case"boolean":return l.BOOLEAN}throw new Error("Cell value not computed")};var p=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=t,this.message=r,this.address=n}var t,r,i;return t=e,i=[{key:"parsingError",value:function(){return new e(n.ERROR,a.ErrorMessage.ParseError)}}],(r=[{key:"attachAddress",value:function(t){return void 0===this.address?new e(this.type,this.message,t):this}}])&&s(t.prototype,r),i&&s(t,i),e}();t.CellError=p,t.simpleRowAddress=function(e,t){return{sheet:e,row:t}},t.simpleColumnAddress=function(e,t){return{sheet:e,col:t}};var f=function(e,t,r){return{sheet:e,col:t,row:r}};t.simpleCellAddress=f,t.invalidSimpleCellAddress=function(e){return e.col<0||e.row<0},t.movedSimpleCellAddress=function(e,t,r,n){return f(t,e.col+r,e.row+n)},t.absoluteSheetReference=function(e,t){return null===e.sheet?t.sheet:e.sheet}},function(e,t,r){"use strict";t.__esModule=!0,t.DenseStrategy=t.SparseStrategy=t.RangeVertex=t.ParsingErrorVertex=t.ValueCellVertex=t.EmptyCellVertex=t.FormulaCellVertex=t.MatrixVertex=t.MatrixMapping=t.SheetMapping=t.RangeMapping=t.Graph=t.AddressMapping=t.DependencyGraph=void 0;var n=r(108);t.DependencyGraph=n.DependencyGraph;var i=r(223);t.AddressMapping=i.AddressMapping;var a=r(235);t.Graph=a.Graph;var o=r(238);t.RangeMapping=o.RangeMapping;var s=r(240);t.SheetMapping=s.SheetMapping;var u=r(237);t.MatrixMapping=u.MatrixMapping;var c=r(231);t.MatrixVertex=c.MatrixVertex;var l=r(230);t.FormulaCellVertex=l.FormulaCellVertex;var h=r(247);t.EmptyCellVertex=h.EmptyCellVertex;var p=r(248);t.ValueCellVertex=p.ValueCellVertex;var f=r(249);t.ParsingErrorVertex=f.ParsingErrorVertex;var d=r(234);t.RangeVertex=d.RangeVertex;var m=r(250);t.SparseStrategy=m.SparseStrategy;var y=r(251);t.DenseStrategy=y.DenseStrategy},function(e,t,r){"use strict";r(1),r(63),r(64),r(109),r(110),r(65),r(75),r(113),r(84),r(89),r(92),r(96),r(114),r(98),r(124),r(104),t.__esModule=!0,t.DependencyGraph=void 0,r(125);var n,i=(n=r(126))&&n.__esModule?n:{default:n},a=r(132),o=r(218),s=r(106),u=r(213),c=r(138),l=r(217),h=r(219),p=r(107),f=r(223),d=r(228),m=r(235),y=r(237),g=r(238),v=r(240),E=r(246);function T(e){return function(e){if(Array.isArray(e))return S(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||A(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=A(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||A(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){if(e){if("string"==typeof e)return S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?S(e,t):void 0}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function R(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var w=function(){function e(t,r,n,i,s,u,l,h){var f=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.addressMapping=t,this.rangeMapping=r,this.sheetMapping=n,this.matrixMapping=i,this.stats=s,this.lazilyTransformingAstService=u,this.functionRegistry=l,this.namedExpressions=h,this.dependencyQueryAddresses=function(e){if(e instanceof p.RangeVertex)return f.rangeDependencyQuery(e).map((function(e){var t=x(e,2),r=t[0];return t[1],r}));var t=f.formulaDependencyQuery(e);if(void 0!==t){var r=x(t,2),n=r[0];return r[1].map((function(e){return e instanceof c.NamedExpressionDependency?f.namedExpressions.namedExpressionOrPlaceholder(e.name,n.sheet).address:e}))}},this.dependencyQueryVertices=function(e){if(e instanceof p.RangeVertex)return f.rangeDependencyQuery(e).map((function(e){var t=x(e,2);return t[0],t[1]}));var t=f.formulaDependencyQuery(e);if(void 0!==t){var r=x(t,2),n=r[0];return r[1].map((function(e){if(e instanceof a.AbsoluteCellRange)return f.rangeMapping.fetchRange(e.start,e.end);if(e instanceof c.NamedExpressionDependency){var t=f.namedExpressions.namedExpressionOrPlaceholder(e.name,n.sheet);return f.addressMapping.fetchCell(t.address)}return f.addressMapping.fetchCell(e)}))}},this.rangeDependencyQuery=function(e){var t,r=[],n=f.rangeMapping.findSmallerRange(e.range),i=n.smallerRangeVertex,o=n.restRange;null!==i&&f.graph.adjacentNodes(i).has(e)?(t=o,r.push([new a.AbsoluteCellRange(i.start,i.end),i])):t=e.range;var s,u=b(t.addresses(f));try{for(u.s();!(s=u.n()).done;){var c=s.value,l=f.addressMapping.getCell(c);l instanceof p.EmptyCellVertex&&(l.address=c),null!==l&&r.push([c,l])}}catch(e){u.e(e)}finally{u.f()}return r},this.formulaDependencyQuery=function(e){var t,r;if(e instanceof p.FormulaCellVertex)r=e.getAddress(f.lazilyTransformingAstService),t=e.getFormula(f.lazilyTransformingAstService);else{if(!(e instanceof p.MatrixVertex&&e.isFormula()))return;r=e.getAddress(),t=e.getFormula()}var n=(0,c.collectDependencies)(t,f.functionRegistry);return[r,(0,o.absolutizeDependencies)(n,r)]},this.graph=new m.Graph(this.dependencyQueryVertices)}var t,r,n;return t=e,n=[{key:"buildEmpty",value:function(t,r,n,i,a){return new e(new f.AddressMapping(r.chooseAddressMappingPolicy),new g.RangeMapping,new v.SheetMapping(r.translationPackage),new y.MatrixMapping,a,t,n,i)}}],(r=[{key:"setFormulaToCell",value:function(e,t,r,n,i){var a=this.addressMapping.getCell(e);this.ensureThatVertexIsNonMatrixCellVertex(a);var o=new p.FormulaCellVertex(t,e,this.lazilyTransformingAstService.version());this.exchangeOrAddGraphNode(a,o),this.addressMapping.setCell(e,o),this.processCellDependencies(r,o),this.graph.markNodeAsSpecialRecentlyChanged(o),n&&this.markAsVolatile(o),i&&this.markAsDependentOnStructureChange(o),this.correctInfiniteRangesDependency(e)}},{key:"setParsingErrorToCell",value:function(e,t){var r=this.addressMapping.getCell(e);this.ensureThatVertexIsNonMatrixCellVertex(r),this.exchangeOrAddGraphNode(r,t),this.addressMapping.setCell(e,t),this.graph.markNodeAsSpecialRecentlyChanged(t),this.correctInfiniteRangesDependency(e)}},{key:"setValueToCell",value:function(e,t){var r=this.addressMapping.getCell(e);if(this.ensureThatVertexIsNonMatrixCellVertex(r),r instanceof p.ValueCellVertex)r.getCellValue()!==t&&(r.setCellValue(t),this.graph.markNodeAsSpecialRecentlyChanged(r));else{var n=new p.ValueCellVertex(t);this.exchangeOrAddGraphNode(r,n),this.addressMapping.setCell(e,n),this.graph.markNodeAsSpecialRecentlyChanged(n)}this.correctInfiniteRangesDependency(e)}},{key:"setCellEmpty",value:function(e){var t=this.addressMapping.getCell(e);if(null!==t)if(this.ensureThatVertexIsNonMatrixCellVertex(t),this.graph.adjacentNodes(t).size>0){var r=new p.EmptyCellVertex(e);this.exchangeGraphNode(t,r),0===this.graph.adjacentNodesCount(r)?(this.removeVertex(r),this.addressMapping.removeCell(e)):(this.graph.markNodeAsSpecialRecentlyChanged(r),this.addressMapping.setCell(e,r))}else this.removeVertex(t),this.addressMapping.removeCell(e)}},{key:"ensureThatVertexIsNonMatrixCellVertex",value:function(e){i.default.ok(!(e instanceof p.MatrixVertex),"Illegal operation")}},{key:"clearRecentlyChangedVertices",value:function(){this.graph.clearSpecialNodesRecentlyChanged()}},{key:"verticesToRecompute",value:function(){return new Set([].concat(T(this.graph.specialNodesRecentlyChanged),T(this.volatileVertices())))}},{key:"processCellDependencies",value:function(e,t){var r=this;e.forEach((function(e){if(e instanceof a.AbsoluteCellRange){var n=e,i=r.getRange(n.start,n.end);void 0===i&&(i=new p.RangeVertex(n),r.rangeMapping.setRange(i)),r.graph.addNode(i),n.isFinite()||r.graph.markNodeAsInfiniteRange(i);var o=r.rangeMapping.findSmallerRange(n),s=o.smallerRangeVertex,u=o.restRange;if(s){if(r.graph.addEdge(s,i),i.bruteForce){i.bruteForce=!1;var l,h=b(n.addresses(r));try{for(h.s();!(l=h.n()).done;){var f=l.value;r.graph.removeEdge(r.fetchCell(f),i)}}catch(e){h.e(e)}finally{h.f()}}}else i.bruteForce=!0;var d=r.matrixMapping.getMatrix(u);if(void 0!==d)r.graph.addEdge(d,i);else{var m,y=b(u.addresses(r));try{for(y.s();!(m=y.n()).done;){var g=m.value;r.graph.addEdge(r.fetchCellOrCreateEmpty(g),i)}}catch(e){y.e(e)}finally{y.f()}}r.graph.addEdge(i,t),n.isFinite()&&r.correctInfiniteRangesDependenciesByRangeVertex(i)}else if(e instanceof c.NamedExpressionDependency){var v=t.getAddress(r.lazilyTransformingAstService).sheet,E=r.fetchNamedExpressionVertex(e.name,v);r.graph.addEdge(E,t)}else r.graph.addEdge(r.fetchCellOrCreateEmpty(e),t)}))}},{key:"fetchNamedExpressionVertex",value:function(e,t){var r=this.namedExpressions.namedExpressionOrPlaceholder(e,t);return this.fetchCellOrCreateEmpty(r.address)}},{key:"exchangeNode",value:function(e,t){var r=this.fetchCellOrCreateEmpty(e),n=this.fetchCellOrCreateEmpty(t);this.addressMapping.removeCell(e),this.exchangeGraphNode(r,n)}},{key:"correctInfiniteRangesDependenciesByRangeVertex",value:function(e){var t,r=b(this.graph.infiniteRanges);try{for(r.s();!(t=r.n()).done;){var n=t.value,i=n,a=e.range.intersectionWith(i.range);if(null!==a){var o,s=b(a.addresses(this));try{for(s.s();!(o=s.n()).done;){var u=o.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(u),n)}}catch(e){s.e(e)}finally{s.f()}}}}catch(e){r.e(e)}finally{r.f()}}},{key:"correctInfiniteRangesDependency",value:function(e){var t,r=null,n=b(this.graph.infiniteRanges);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.range.addressInRange(e)&&(r=r||this.fetchCellOrCreateEmpty(e),this.graph.addEdge(r,i))}}catch(e){n.e(e)}finally{n.f()}}},{key:"fetchCellOrCreateEmpty",value:function(e){var t=this.addressMapping.getCell(e);return t||(t=new p.EmptyCellVertex(e),this.graph.addNode(t),this.addressMapping.setCell(e,t)),t}},{key:"removeRows",value:function(e){var t=this;if(this.matrixMapping.isFormulaMatrixInRows(e))throw Error("It is not possible to remove row with matrix");this.stats.measure(h.StatType.ADJUSTING_GRAPH,(function(){var r,n=b(t.addressMapping.verticesFromRowsSpan(e));try{for(n.s();!(r=n.n()).done;){var i,a=r.value,o=b(t.graph.adjacentNodes(a));try{for(o.s();!(i=o.n()).done;){var s=i.value;t.graph.markNodeAsSpecialRecentlyChanged(s)}}catch(e){o.e(e)}finally{o.f()}a instanceof p.MatrixVertex||t.removeVertex(a)}}catch(e){n.e(e)}finally{n.f()}})),this.stats.measure(h.StatType.ADJUSTING_MATRIX_MAPPING,(function(){t.truncateMatricesAfterRemovingRows(e)})),this.stats.measure(h.StatType.ADJUSTING_ADDRESS_MAPPING,(function(){t.addressMapping.removeRows(e)})),this.stats.measure(h.StatType.ADJUSTING_RANGES,(function(){t.truncateRanges(e,(function(e){return e.row}))})),this.addStructuralNodesToChangeSet()}},{key:"removeSheet",value:function(e){var t,r=this,n=new Set,i=b(this.addressMapping.sheetEntries(e));try{for(i.s();!(t=i.n()).done;){var a=x(t.value,2),o=a[0],s=a[1];if(s instanceof p.MatrixVertex){if(n.has(s))continue;n.add(s)}var u,c=b(this.graph.adjacentNodes(s));try{for(c.s();!(u=c.n()).done;){var l=u.value;this.graph.markNodeAsSpecialRecentlyChanged(l)}}catch(e){c.e(e)}finally{c.f()}this.removeVertex(s),this.addressMapping.removeCell(o)}}catch(e){i.e(e)}finally{i.f()}this.stats.measure(h.StatType.ADJUSTING_MATRIX_MAPPING,(function(){var e,t=b(n.values());try{for(t.s();!(e=t.n()).done;){var i=e.value;r.matrixMapping.removeMatrix(i.getRange())}}catch(e){t.e(e)}finally{t.f()}})),this.stats.measure(h.StatType.ADJUSTING_RANGES,(function(){var t,n=b(r.rangeMapping.removeRangesInSheet(e));try{for(n.s();!(t=n.n()).done;){var i=t.value;r.removeVertex(i)}}catch(e){n.e(e)}finally{n.f()}r.stats.measure(h.StatType.ADJUSTING_ADDRESS_MAPPING,(function(){r.addressMapping.removeSheet(e)}))})),this.addStructuralNodesToChangeSet()}},{key:"clearSheet",value:function(e){var t,r=new Set,n=b(this.addressMapping.sheetEntries(e));try{for(n.s();!(t=n.n()).done;){var i=x(t.value,2),a=i[0],o=i[1];o instanceof p.MatrixVertex?r.add(o):this.setCellEmpty(a)}}catch(e){n.e(e)}finally{n.f()}var s,u=b(r.values());try{for(u.s();!(s=u.n()).done;){var c=s.value;this.setMatrixEmpty(c)}}catch(e){u.e(e)}finally{u.f()}this.addStructuralNodesToChangeSet()}},{key:"removeColumns",value:function(e){var t=this;if(this.matrixMapping.isFormulaMatrixInColumns(e))throw Error("It is not possible to remove column within matrix");this.stats.measure(h.StatType.ADJUSTING_GRAPH,(function(){var r,n=b(t.addressMapping.verticesFromColumnsSpan(e));try{for(n.s();!(r=n.n()).done;){var i,a=r.value,o=b(t.graph.adjacentNodes(a));try{for(o.s();!(i=o.n()).done;){var s=i.value;t.graph.markNodeAsSpecialRecentlyChanged(s)}}catch(e){o.e(e)}finally{o.f()}a instanceof p.MatrixVertex||t.removeVertex(a)}}catch(e){n.e(e)}finally{n.f()}})),this.stats.measure(h.StatType.ADJUSTING_MATRIX_MAPPING,(function(){t.truncateMatricesAfterRemovingColumns(e)})),this.stats.measure(h.StatType.ADJUSTING_ADDRESS_MAPPING,(function(){t.addressMapping.removeColumns(e)})),this.stats.measure(h.StatType.ADJUSTING_RANGES,(function(){t.truncateRanges(e,(function(e){return e.col}))})),this.addStructuralNodesToChangeSet()}},{key:"addRows",value:function(e){var t=this;this.stats.measure(h.StatType.ADJUSTING_ADDRESS_MAPPING,(function(){t.addressMapping.addRows(e.sheet,e.rowStart,e.numberOfRows)})),this.stats.measure(h.StatType.ADJUSTING_MATRIX_MAPPING,(function(){t.expandMatricesAfterAddingRows(e.sheet,e.rowStart,e.numberOfRows)})),this.stats.measure(h.StatType.ADJUSTING_RANGES,(function(){t.rangeMapping.moveAllRangesInSheetAfterRowByRows(e.sheet,e.rowStart,e.numberOfRows),t.fixRangesWhenAddingRows(e.sheet,e.rowStart,e.numberOfRows)}));var r,n=b(this.addressMapping.verticesFromRowsSpan(e));try{for(n.s();!(r=n.n()).done;){var i=r.value;this.graph.markNodeAsSpecialRecentlyChanged(i)}}catch(e){n.e(e)}finally{n.f()}this.addStructuralNodesToChangeSet()}},{key:"addColumns",value:function(e){var t=this;this.stats.measure(h.StatType.ADJUSTING_ADDRESS_MAPPING,(function(){t.addressMapping.addColumns(e.sheet,e.columnStart,e.numberOfColumns)})),this.stats.measure(h.StatType.ADJUSTING_MATRIX_MAPPING,(function(){t.expandMatricesAfterAddingColumns(e.sheet,e.columnStart,e.numberOfColumns)})),this.stats.measure(h.StatType.ADJUSTING_RANGES,(function(){t.rangeMapping.moveAllRangesInSheetAfterColumnByColumns(e.sheet,e.columnStart,e.numberOfColumns),t.fixRangesWhenAddingColumns(e.sheet,e.columnStart,e.numberOfColumns)}));var r,n=b(this.addressMapping.verticesFromColumnsSpan(e));try{for(n.s();!(r=n.n()).done;){var i=r.value;this.graph.markNodeAsSpecialRecentlyChanged(i)}}catch(e){n.e(e)}finally{n.f()}this.addStructuralNodesToChangeSet()}},{key:"ensureNoMatrixInRange",value:function(e){if(this.matrixMapping.isFormulaMatrixInRange(e))throw Error("It is not possible to move / replace cells with matrix")}},{key:"moveCells",value:function(e,t,r,n){var i,a=b(e.addressesWithDirection(t,r,this));try{for(a.s();!(i=a.n()).done;){var o=i.value,u=(0,s.simpleCellAddress)(n,o.col+t,o.row+r),c=this.addressMapping.getCell(o),l=this.addressMapping.getCell(u);if(this.addressMapping.removeCell(o),null!==c){this.graph.markNodeAsSpecialRecentlyChanged(c),this.addressMapping.setCell(u,c);var h,f=null,d=b(this.graph.adjacentNodes(c));try{for(d.s();!(h=d.n()).done;){var m=h.value;m instanceof p.RangeVertex&&!e.containsRange(m.range)&&(f=f||this.fetchCellOrCreateEmpty(o),this.graph.addEdge(f,m),this.graph.removeEdge(c,m))}}catch(e){d.e(e)}finally{d.f()}f&&(this.graph.markNodeAsSpecialRecentlyChanged(f),this.addressMapping.setCell(o,f))}if(null!==l){null===c&&this.addressMapping.removeCell(u);var y,g=b(this.graph.adjacentNodes(l));try{for(g.s();!(y=g.n()).done;){var v=y.value;c=null!=c?c:this.fetchCellOrCreateEmpty(u),this.graph.addEdge(c,v),this.graph.markNodeAsSpecialRecentlyChanged(c)}}catch(e){g.e(e)}finally{g.f()}this.removeVertex(l)}}}catch(e){a.e(e)}finally{a.f()}var E,T=b(this.rangeMapping.rangeVerticesContainedInRange(e));try{for(T.s();!(E=T.n()).done;){var x,A=E.value,S=b(this.graph.adjacentNodes(A));try{for(S.s();!(x=S.n()).done;){var R=x.value;if(R instanceof p.RangeVertex&&!e.containsRange(R.range)){this.graph.removeEdge(A,R);var w,C=b(A.range.addresses(this));try{for(C.s();!(w=C.n()).done;){var O=w.value,k=this.fetchCellOrCreateEmpty(O);this.graph.addEdge(k,R),this.addressMapping.setCell(O,k),this.graph.markNodeAsSpecialRecentlyChanged(k)}}catch(e){C.e(e)}finally{C.f()}}}}catch(e){S.e(e)}finally{S.f()}}}catch(e){T.e(e)}finally{T.f()}this.rangeMapping.moveRangesInsideSourceRange(e,t,r,n)}},{key:"disableNumericMatrices",value:function(){var e,t=b(this.matrixMapping.numericMatrices());try{for(t.s();!(e=t.n()).done;){var r=x(e.value,2),n=(r[0],r[1]);this.breakNumericMatrix(n)}}catch(e){t.e(e)}finally{t.f()}}},{key:"breakNumericMatricesInRange",value:function(e){var t,r=b(this.matrixMapping.numericMatricesInRange(e));try{for(r.s();!(t=r.n()).done;){var n=x(t.value,2),i=(n[0],n[1]);this.breakNumericMatrix(i)}}catch(e){r.e(e)}finally{r.f()}}},{key:"breakNumericMatrix",value:function(e){var t,r=a.AbsoluteCellRange.spanFrom(e.getAddress(),e.width,e.height),n=this.graph.adjacentNodes(e),i=b(r.addresses(this));try{for(i.s();!(t=i.n()).done;){var o=t.value,s=this.getCellValue(o),u=new p.ValueCellVertex(s);this.addVertex(o,u)}}catch(e){i.e(e)}finally{i.f()}var c,l=b(n.values());try{for(l.s();!(c=l.n()).done;){var h,f=c.value,m=b((0,d.collectAddressesDependentToMatrix)(this.functionRegistry,f,e,this.lazilyTransformingAstService,this));try{for(m.s();!(h=m.n()).done;){var y=h.value,g=this.fetchCell(y);this.graph.addEdge(g,f)}}catch(e){m.e(e)}finally{m.f()}}}catch(e){l.e(e)}finally{l.f()}this.removeVertex(e),this.matrixMapping.removeMatrix(e.getRange())}},{key:"setMatrixEmpty",value:function(e){var t,r=a.AbsoluteCellRange.spanFrom(e.getAddress(),e.width,e.height),n=this.graph.adjacentNodes(e),i=b(r.addresses(this));try{for(i.s();!(t=i.n()).done;){var o=t.value;this.addressMapping.removeCell(o)}}catch(e){i.e(e)}finally{i.f()}var s,u=b(n.values());try{for(u.s();!(s=u.n()).done;){var c,l=s.value,h=(0,d.collectAddressesDependentToMatrix)(this.functionRegistry,l,e,this.lazilyTransformingAstService,this),p=b(h);try{for(p.s();!(c=p.n()).done;){var f=c.value,m=this.fetchCellOrCreateEmpty(f);this.graph.addEdge(m,l)}}catch(e){p.e(e)}finally{p.f()}h.length>0&&this.graph.markNodeAsSpecialRecentlyChanged(l)}}catch(e){u.e(e)}finally{u.f()}this.removeVertex(e),this.matrixMapping.removeMatrix(e.getRange())}},{key:"addVertex",value:function(e,t){this.graph.addNode(t),this.setVertexAddress(e,t)}},{key:"addMatrixVertex",value:function(e,t){this.graph.addNode(t),this.setAddressMappingForMatrixVertex(t,e)}},{key:"addNewMatrixVertex",value:function(e){var t,r=a.AbsoluteCellRange.spanFrom(e.getAddress(),e.width,e.height),n=b(this.verticesFromRange(r));try{for(n.s();!(t=n.n()).done;)if(t.value instanceof p.MatrixVertex)throw Error("You cannot modify only part of an array")}catch(e){n.e(e)}finally{n.f()}this.setMatrix(r,e);var i,o=b(this.entriesFromRange(r));try{for(o.s();!(i=o.n()).done;){var s=x(i.value,2),u=s[0],c=s[1];c&&this.exchangeGraphNode(c,e),this.setVertexAddress(u,e)}}catch(e){o.e(e)}finally{o.f()}}},{key:"matrixFormulaNodes",value:regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=b(this.graph.nodes),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=10;break}if(!((n=r.value)instanceof p.MatrixVertex&&n.isFormula())){e.next=8;break}return e.next=8,n;case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.addressMapping.entriesFromRowsSpan(t),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.addressMapping.entriesFromColumnsSpan(t),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"existsVertex",value:function(e){return this.addressMapping.has(e)}},{key:"fetchCell",value:function(e){return this.addressMapping.fetchCell(e)}},{key:"getCell",value:function(e){return this.addressMapping.getCell(e)}},{key:"getCellValue",value:function(e){return this.addressMapping.getCellValue(e)}},{key:"getScalarValue",value:function(e){var t=this.addressMapping.getCellValue(e);return t instanceof E.SimpleRangeValue?new s.CellError(s.ErrorType.VALUE,u.ErrorMessage.ScalarExpected):t}},{key:"setVertexAddress",value:function(e,t){this.addressMapping.setCell(e,t)}},{key:"existsEdge",value:function(e,t){return this.graph.existsEdge(e,t)}},{key:"getSheetId",value:function(e){return this.sheetMapping.fetch(e)}},{key:"getSheetName",value:function(e){return this.sheetMapping.fetchDisplayName(e)}},{key:"getSheetHeight",value:function(e){return this.addressMapping.getHeight(e)}},{key:"getSheetWidth",value:function(e){return this.addressMapping.getWidth(e)}},{key:"getMatrix",value:function(e){return this.matrixMapping.getMatrix(e)}},{key:"setMatrix",value:function(e,t){this.matrixMapping.setMatrix(e,t)}},{key:"getRange",value:function(e,t){return this.rangeMapping.getRange(e,t)}},{key:"topSortWithScc",value:function(){return this.graph.topSortWithScc()}},{key:"markAsVolatile",value:function(e){this.graph.markNodeAsSpecial(e)}},{key:"markAsDependentOnStructureChange",value:function(e){this.graph.markNodeAsChangingWithStructure(e)}},{key:"forceApplyPostponedTransformations",value:function(){var e,t=b(this.graph.nodes.values());try{for(t.s();!(e=t.n()).done;){var r=e.value;r instanceof p.FormulaCellVertex&&r.ensureRecentData(this.lazilyTransformingAstService)}}catch(e){t.e(e)}finally{t.f()}}},{key:"volatileVertices",value:function(){return this.graph.specialNodes}},{key:"destroy",value:function(){this.graph.destroy(),this.addressMapping.destroy(),this.rangeMapping.destroy(),this.sheetMapping.destroy(),this.matrixMapping.destroy()}},{key:"verticesFromRange",value:regeneratorRuntime.mark((function e(t){var r,n,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=b(t.addresses(this)),e.prev=1,r.s();case 3:if((n=r.n()).done){e.next=11;break}if(i=n.value,!(a=this.getCell(i))){e.next=9;break}return e.next=9,a;case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),r.e(e.t0);case 16:return e.prev=16,r.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[1,13,16,19]])}))},{key:"valuesFromRange",value:regeneratorRuntime.mark((function e(t){var r,n,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=b(t.addresses(this)),e.prev=1,r.s();case 3:if((n=r.n()).done){e.next=11;break}if(i=n.value,(a=this.getScalarValue(i))===s.EmptyValue){e.next=9;break}return e.next=9,[a,i];case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),r.e(e.t0);case 16:return e.prev=16,r.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[1,13,16,19]])}))},{key:"entriesFromRange",value:regeneratorRuntime.mark((function e(t){var r,n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=b(t.addresses(this)),e.prev=1,r.s();case 3:if((n=r.n()).done){e.next=9;break}return i=n.value,e.next=7,[i,this.getCell(i)];case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),r.e(e.t0);case 14:return e.prev=14,r.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:"exchangeGraphNode",value:function(e,t){var r=this;this.graph.addNode(t);var n=this.graph.adjacentNodes(e);this.removeVertex(e),n.forEach((function(e){r.graph.hasNode(e)&&r.graph.addEdge(t,e)}))}},{key:"exchangeOrAddGraphNode",value:function(e,t){e?this.exchangeGraphNode(e,t):this.graph.addNode(t)}},{key:"computeListOfValuesInRange",value:function(e){var t,r=[],n=b(e.addresses(this));try{for(n.s();!(t=n.n()).done;){var i=t.value,a=this.getScalarValue(i);r.push(a)}}catch(e){n.e(e)}finally{n.f()}return r}},{key:"addStructuralNodesToChangeSet",value:function(){var e,t=b(this.graph.specialNodesStructuralChanges);try{for(t.s();!(e=t.n()).done;){var r=e.value;this.graph.markNodeAsSpecialRecentlyChanged(r)}}catch(e){t.e(e)}finally{t.f()}}},{key:"fixRangesWhenAddingRows",value:function(e,t,r){for(var n=0,i=Array.from(this.rangeMapping.rangesInSheet(e));n<i.length;n++){var o=i[n];if(o.range.includesRow(t+r))if(o.bruteForce){var u,c=b(o.range.rangeWithSameWidth(t,r).addresses(this));try{for(c.s();!(u=c.n()).done;){var l=u.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(l),o)}}catch(e){c.e(e)}finally{c.f()}}else{var h=o,f=this.rangeMapping.findSmallerRange(h.range);if(null!==f.smallerRangeVertex)continue;for(;null===f.smallerRangeVertex;){var d=new p.RangeVertex(a.AbsoluteCellRange.spanFrom(h.range.start,h.range.width(),h.range.height()-1));this.rangeMapping.setRange(d),this.graph.addNode(d);var m=new a.AbsoluteCellRange((0,s.simpleCellAddress)(h.range.start.sheet,h.range.start.col,h.range.end.row),h.range.end);this.addAllFromRange(m,h),this.graph.addEdge(d,h),h=d,f=this.rangeMapping.findSmallerRange(h.range)}this.graph.addEdge(f.smallerRangeVertex,h),this.addAllFromRange(f.restRange,h),this.graph.removeEdge(f.smallerRangeVertex,o)}}}},{key:"addAllFromRange",value:function(e,t){var r,n=b(e.addresses(this));try{for(n.s();!(r=n.n()).done;){var i=r.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(i),t)}}catch(e){n.e(e)}finally{n.f()}}},{key:"fixRangesWhenAddingColumns",value:function(e,t,r){var n,i=b(this.rangeMapping.rangesInSheet(e));try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o.range.includesColumn(t+r)){var u,c=b((o.bruteForce?o.range.rangeWithSameHeight(t,r):a.AbsoluteCellRange.spanFrom((0,s.simpleCellAddress)(e,t,o.range.end.row),r,1)).addresses(this));try{for(c.s();!(u=c.n()).done;){var l=u.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(l),o)}}catch(e){c.e(e)}finally{c.f()}}}}catch(e){i.e(e)}finally{i.f()}}},{key:"setAddressMappingForMatrixVertex",value:function(e,t){if(this.setVertexAddress(t,e),e instanceof p.MatrixVertex){var r=a.AbsoluteCellRange.spanFrom(t,e.width,e.height);this.setMatrix(r,e);var n,i=b(r.addresses(this));try{for(i.s();!(n=i.n()).done;){var o=n.value;this.setVertexAddress(o,e)}}catch(e){i.e(e)}finally{i.f()}}}},{key:"truncateMatricesAfterRemovingRows",value:function(e){var t=this;this.matrixMapping.truncateMatricesByRows(e).forEach((function(e){t.removeVertex(e)}))}},{key:"truncateRanges",value:function(e,t){var r,n=this.rangeMapping.truncateRanges(e,t),i=n.verticesToRemove,a=b(n.verticesToMerge);try{for(a.s();!(r=a.n()).done;){var o=x(r.value,2),s=o[0],u=o[1];this.mergeRangeVertices(s,u)}}catch(e){a.e(e)}finally{a.f()}var c,l=b(i);try{for(l.s();!(c=l.n()).done;){var h=c.value;this.removeVertexAndCleanupDependencies(h)}}catch(e){l.e(e)}finally{l.f()}}},{key:"truncateMatricesAfterRemovingColumns",value:function(e){var t=this;this.matrixMapping.truncateMatricesByColumns(e).forEach((function(e){t.removeVertex(e)}))}},{key:"expandMatricesAfterAddingRows",value:function(e,t,r){var n,i=b(this.matrixMapping.numericMatricesInRows(l.RowsSpan.fromRowStartAndEnd(e,t,t)));try{for(i.s();!(n=i.n()).done;){var o=x(n.value,2)[1];o.addRows(e,t,r);var u,c=b(a.AbsoluteCellRange.spanFrom((0,s.simpleCellAddress)(e,o.getAddress().col,t),o.width,r).addresses(this));try{for(c.s();!(u=c.n()).done;){var h=u.value;this.addressMapping.setCell(h,o)}}catch(e){c.e(e)}finally{c.f()}}}catch(e){i.e(e)}finally{i.f()}}},{key:"expandMatricesAfterAddingColumns",value:function(e,t,r){var n,i=b(this.matrixMapping.numericMatricesInColumns(l.ColumnsSpan.fromColumnStartAndEnd(e,t,t)));try{for(i.s();!(n=i.n()).done;){var o=x(n.value,2)[1];o.addColumns(e,t,r);var u,c=b(a.AbsoluteCellRange.spanFrom((0,s.simpleCellAddress)(e,t,o.getAddress().row),r,o.height).addresses(this));try{for(c.s();!(u=c.n()).done;){var h=u.value;this.addressMapping.setCell(h,o)}}catch(e){c.e(e)}finally{c.f()}}}catch(e){i.e(e)}finally{i.f()}}},{key:"removeVertex",value:function(e){this.removeVertexAndCleanupDependencies(e),e instanceof p.RangeVertex&&this.rangeMapping.removeRange(e)}},{key:"mergeRangeVertices",value:function(e,t){var r=this,n=this.graph.adjacentNodes(t);this.removeVertexAndCleanupDependencies(t),this.graph.softRemoveEdge(e,t),n.forEach((function(t){r.graph.hasNode(t)&&r.graph.addEdge(e,t)}))}},{key:"removeVertexAndCleanupDependencies",value:function(e){for(var t=new Set(this.graph.removeNode(e));t.size>0;){var r=t.values().next().value;t.delete(r),this.graph.hasNode(r)&&0===this.graph.adjacentNodesCount(r)&&((r instanceof p.RangeVertex||r instanceof p.EmptyCellVertex)&&this.graph.removeNode(r).forEach((function(e){return t.add(e)})),r instanceof p.RangeVertex?this.rangeMapping.removeRange(r):r instanceof p.EmptyCellVertex&&this.addressMapping.removeCell(r.address))}}},{key:"getAdjacentNodesAddresses",value:function(e){var t=this,r=this.graph.adjacentNodes(e),n=[];return r.forEach((function(e){var r=e;r instanceof p.RangeVertex?n.push(new a.AbsoluteCellRange(r.start,r.end)):r instanceof p.FormulaCellVertex?n.push(r.getAddress(t.lazilyTransformingAstService)):n.push(r.getAddress())})),n}}])&&R(t.prototype,r),n&&R(t,n),e}();t.DependencyGraph=w},function(e,t,r){"use strict";var n=r(2),i=r(7),a=r(48),o=r(15),s=r(49),u=r(40),c=r(70),l=r(62),h=r(85),p=r(55),f=r(86),d=p("isConcatSpreadable"),m=f>=51||!i((function(){var e=[];return e[d]=!1,e.concat()[0]!==e})),y=h("concat"),g=function(e){if(!o(e))return!1;var t=e[d];return void 0!==t?!!t:a(e)};n({target:"Array",proto:!0,forced:!m||!y},{concat:function(e){var t,r,n,i,a,o=s(this),h=l(o,0),p=0;for(t=-1,n=arguments.length;t<n;t++)if(g(a=-1===t?o:arguments[t])){if(p+(i=u(a.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(r=0;r<i;r++,p++)r in a&&c(h,p,a[r])}else{if(p>=9007199254740991)throw TypeError("Maximum allowed index exceeded");c(h,p++,a)}return h.length=p,h}})},function(e,t,r){"use strict";var n=r(2),i=r(111);n({target:"Array",proto:!0,forced:[].forEach!=i},{forEach:i})},function(e,t,r){"use strict";var n=r(59).forEach,i=r(112),a=r(88),o=i("forEach"),s=a("forEach");e.exports=o&&s?[].forEach:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}},function(e,t,r){"use strict";var n=r(7);e.exports=function(e,t){var r=[][e];return!!r&&n((function(){r.call(null,t||function(){throw 1},1)}))}},function(e,t,r){"use strict";var n=r(2),i=r(59).map,a=r(85),o=r(88),s=a("map"),u=o("map");n({target:"Array",proto:!0,forced:!s||!u},{map:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,r){"use strict";var n=r(115),i=r(121);e.exports=n("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),i)},function(e,t,r){"use strict";var n=r(2),i=r(3),a=r(45),o=r(22),s=r(116),u=r(118),c=r(119),l=r(15),h=r(7),p=r(74),f=r(58),d=r(120);e.exports=function(e,t,r){var m=-1!==e.indexOf("Map"),y=-1!==e.indexOf("Weak"),g=m?"set":"add",v=i[e],E=v&&v.prototype,T=v,b={},x=function(e){var t=E[e];o(E,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(y&&!l(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return y&&!l(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(y&&!l(e))&&t.call(this,0===e?0:e)}:function(e,r){return t.call(this,0===e?0:e,r),this})};if(a(e,"function"!=typeof v||!(y||E.forEach&&!h((function(){(new v).entries().next()})))))T=r.getConstructor(t,e,m,g),s.REQUIRED=!0;else if(a(e,!0)){var A=new T,S=A[g](y?{}:-0,1)!=A,R=h((function(){A.has(1)})),w=p((function(e){new v(e)})),C=!y&&h((function(){for(var e=new v,t=5;t--;)e[g](t,t);return!e.has(-0)}));w||((T=t((function(t,r){c(t,T,e);var n=d(new v,t,T);return null!=r&&u(r,n[g],n,m),n}))).prototype=E,E.constructor=T),(R||C)&&(x("delete"),x("has"),m&&x("get")),(C||S)&&x(g),y&&E.clear&&delete E.clear}return b[e]=T,n({global:!0,forced:T!=v},b),f(T,e),y||r.setStrong(T,e,m),T}},function(e,t,r){var n=r(32),i=r(15),a=r(16),o=r(20).f,s=r(31),u=r(117),c=s("meta"),l=0,h=Object.isExtensible||function(){return!0},p=function(e){o(e,c,{value:{objectID:"O"+ ++l,weakData:{}}})},f=e.exports={REQUIRED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==d(e)?e:("string"==typeof e?"S":"P")+e;if(!a(e,c)){if(!h(e))return"F";if(!t)return"E";p(e)}return e[c].objectID},getWeakData:function(e,t){if(!a(e,c)){if(!h(e))return!0;if(!t)return!1;p(e)}return e[c].weakData},onFreeze:function(e){return u&&f.REQUIRED&&h(e)&&!a(e,c)&&p(e),e}};n[c]=!0},function(e,t,r){var n=r(7);e.exports=!n((function(){return Object.isExtensible(Object.preventExtensions({}))}))},function(e,t,r){var n=r(21),i=r(68),a=r(40),o=r(60),s=r(71),u=r(67),c=function(e,t){this.stopped=e,this.result=t};(e.exports=function(e,t,r,l,h){var p,f,m,y,g,v,E,T=o(t,r,l?2:1);if(h)p=e;else{if("function"!=typeof(f=s(e)))throw TypeError("Target is not iterable");if(i(f)){for(m=0,y=a(e.length);y>m;m++)if((g=l?T(n(E=e[m])[0],E[1]):T(e[m]))&&g instanceof c)return g;return new c(!1)}p=f.call(e)}for(v=p.next;!(E=v.call(p)).done;)if(g=u(p,T,E.value,l),"object"==d(g)&&g&&g instanceof c)return g;return new c(!1)}).stop=function(e){return new c(!0,e)}},function(e,t){e.exports=function(e,t,r){if(!(e instanceof t))throw TypeError("Incorrect "+(r?r+" ":"")+"invocation");return e}},function(e,t,r){var n=r(15),i=r(82);e.exports=function(e,t,r){var a,o;return i&&"function"==typeof(a=t.constructor)&&a!==r&&n(o=a.prototype)&&o!==r.prototype&&i(e,o),e}},function(e,t,r){"use strict";var n=r(20).f,i=r(50),a=r(122),o=r(60),s=r(119),u=r(118),c=r(77),l=r(123),h=r(6),p=r(116).fastKey,f=r(26),d=f.set,m=f.getterFor;e.exports={getConstructor:function(e,t,r,c){var l=e((function(e,n){s(e,l,t),d(e,{type:t,index:i(null),first:void 0,last:void 0,size:0}),h||(e.size=0),null!=n&&u(n,e[c],e,r)})),f=m(t),y=function(e,t,r){var n,i,a=f(e),o=g(e,t);return o?o.value=r:(a.last=o={index:i=p(t,!0),key:t,value:r,previous:n=a.last,next:void 0,removed:!1},a.first||(a.first=o),n&&(n.next=o),h?a.size++:e.size++,"F"!==i&&(a.index[i]=o)),e},g=function(e,t){var r,n=f(e),i=p(t);if("F"!==i)return n.index[i];for(r=n.first;r;r=r.next)if(r.key==t)return r};return a(l.prototype,{clear:function(){for(var e=f(this),t=e.index,r=e.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete t[r.index],r=r.next;e.first=e.last=void 0,h?e.size=0:this.size=0},delete:function(e){var t=f(this),r=g(this,e);if(r){var n=r.next,i=r.previous;delete t.index[r.index],r.removed=!0,i&&(i.next=n),n&&(n.previous=i),t.first==r&&(t.first=n),t.last==r&&(t.last=i),h?t.size--:this.size--}return!!r},forEach:function(e){for(var t,r=f(this),n=o(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.next:r.first;)for(n(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!g(this,e)}}),a(l.prototype,r?{get:function(e){var t=g(this,e);return t&&t.value},set:function(e,t){return y(this,0===e?0:e,t)}}:{add:function(e){return y(this,e=0===e?0:e,e)}}),h&&n(l.prototype,"size",{get:function(){return f(this).size}}),l},setStrong:function(e,t,r){var n=t+" Iterator",i=m(t),a=m(n);c(e,t,(function(e,t){d(this,{type:n,target:e,state:i(e),kind:t,last:void 0})}),(function(){for(var e=a(this),t=e.kind,r=e.last;r&&r.removed;)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?"keys"==t?{value:r.key,done:!1}:"values"==t?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),r?"entries":"values",!r,!0),l(t)}}},function(e,t,r){var n=r(22);e.exports=function(e,t,r){for(var i in t)n(e,i,t[i],r);return e}},function(e,t,r){"use strict";var n=r(35),i=r(20),a=r(55),o=r(6),s=a("species");e.exports=function(e){var t=n(e),r=i.f;o&&t&&!t[s]&&r(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,r){var n=r(3),i=r(105),a=r(111),o=r(19);for(var s in i){var u=n[s],c=u&&u.prototype;if(c&&c.forEach!==a)try{o(c,"forEach",a)}catch(e){c.forEach=a}}},function(e,t,r){var n=function(e){"use strict";var t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",o=n.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var i=t&&t.prototype instanceof h?t:h,a=Object.create(i.prototype),o=new S(n||[]);return a._invoke=function(e,t,r){var n="suspendedStart";return function(i,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw a;return{value:void 0,done:!0}}for(r.method=i,r.arg=a;;){var o=r.delegate;if(o){var s=b(o,r);if(s){if(s===l)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=c(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}(e,r,o),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var l={};function h(){}function p(){}function f(){}var m={};m[i]=function(){return this};var y=Object.getPrototypeOf,g=y&&y(y(R([])));g&&g!==t&&r.call(g,i)&&(m=g);var v=f.prototype=h.prototype=Object.create(m);function E(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,t){var n;this._invoke=function(i,a){function o(){return new t((function(n,o){!function n(i,a,o,s){var u=c(e[i],e,a);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"===d(h)&&r.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(h).then((function(e){l.value=e,o(l)}),(function(e){return n("throw",e,o,s)}))}s(u.arg)}(i,a,n,o)}))}return n=n?n.then(o,o):o()}}function b(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var n=c(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,l;var i=n.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function R(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:w}}function w(){return{value:void 0,done:!0}}return p.prototype=v.constructor=f,f.constructor=p,p.displayName=s(f,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,s(e,o,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},E(T.prototype),T.prototype[a]=function(){return this},e.AsyncIterator=T,e.async=function(t,r,n,i,a){void 0===a&&(a=Promise);var o=new T(u(t,r,n,i),a);return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},E(v),s(v,o,"Generator"),v[i]=function(){return this},v.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=R,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return o.type="throw",o.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,l):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),A(r),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;A(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:R(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),l}},e}(e.exports);try{regeneratorRuntime=n}catch(e){Function("r","regeneratorRuntime = r")(n)}},function(e,t,r){"use strict";(function(t){var n=r(127);
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function i(e,t){if(e===t)return 0;for(var r=e.length,n=t.length,i=0,a=Math.min(r,n);i<a;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0}function a(e){return t.Buffer&&"function"==typeof t.Buffer.isBuffer?t.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}var o=r(128),s=Object.prototype.hasOwnProperty,u=Array.prototype.slice,c="foo"===function(){}.name;function l(e){return Object.prototype.toString.call(e)}function h(e){return!a(e)&&"function"==typeof t.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer)))}var p=e.exports=E,f=/\s*function\s+([^\(\s]*)\s*/;function m(e){if(o.isFunction(e)){if(c)return e.name;var t=e.toString().match(f);return t&&t[1]}}function y(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function g(e){if(c||!o.isFunction(e))return o.inspect(e);var t=m(e);return"[Function"+(t?": "+t:"")+"]"}function v(e,t,r,n,i){throw new p.AssertionError({message:r,actual:e,expected:t,operator:n,stackStartFunction:i})}function E(e,t){e||v(e,!0,t,"==",p.ok)}function T(e,t,r,n){if(e===t)return!0;if(a(e)&&a(t))return 0===i(e,t);if(o.isDate(e)&&o.isDate(t))return e.getTime()===t.getTime();if(o.isRegExp(e)&&o.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"===d(e)||null!==t&&"object"===d(t)){if(h(e)&&h(t)&&l(e)===l(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===i(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(a(e)!==a(t))return!1;var s=(n=n||{actual:[],expected:[]}).actual.indexOf(e);return-1!==s&&s===n.expected.indexOf(t)||(n.actual.push(e),n.expected.push(t),function(e,t,r,n){if(null==e||null==t)return!1;if(o.isPrimitive(e)||o.isPrimitive(t))return e===t;if(r&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var i=b(e),a=b(t);if(i&&!a||!i&&a)return!1;if(i)return e=u.call(e),t=u.call(t),T(e,t,r);var s,c,l=S(e),h=S(t);if(l.length!==h.length)return!1;for(l.sort(),h.sort(),c=l.length-1;c>=0;c--)if(l[c]!==h[c])return!1;for(c=l.length-1;c>=0;c--)if(s=l[c],!T(e[s],t[s],r,n))return!1;return!0}(e,t,r,n))}return r?e===t:e==t}function b(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function x(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(e){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function A(e,t,r,n){var i;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof r&&(n=r,r=null),i=function(e){var t;try{e()}catch(e){t=e}return t}(t),n=(r&&r.name?" ("+r.name+").":".")+(n?" "+n:"."),e&&!i&&v(i,r,"Missing expected exception"+n);var a="string"==typeof n,s=!e&&i&&!r;if((!e&&o.isError(i)&&a&&x(i,r)||s)&&v(i,r,"Got unwanted exception"+n),e&&i&&r&&!x(i,r)||!e&&i)throw i}p.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=function(e){return y(g(e.actual),128)+" "+e.operator+" "+y(g(e.expected),128)}(this),this.generatedMessage=!0);var t=e.stackStartFunction||v;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var r=new Error;if(r.stack){var n=r.stack,i=m(t),a=n.indexOf("\n"+i);if(a>=0){var o=n.indexOf("\n",a+1);n=n.substring(o+1)}this.stack=n}}},o.inherits(p.AssertionError,Error),p.fail=v,p.ok=E,p.equal=function(e,t,r){e!=t&&v(e,t,r,"==",p.equal)},p.notEqual=function(e,t,r){e==t&&v(e,t,r,"!=",p.notEqual)},p.deepEqual=function(e,t,r){T(e,t,!1)||v(e,t,r,"deepEqual",p.deepEqual)},p.deepStrictEqual=function(e,t,r){T(e,t,!0)||v(e,t,r,"deepStrictEqual",p.deepStrictEqual)},p.notDeepEqual=function(e,t,r){T(e,t,!1)&&v(e,t,r,"notDeepEqual",p.notDeepEqual)},p.notDeepStrictEqual=function e(t,r,n){T(t,r,!0)&&v(t,r,n,"notDeepStrictEqual",e)},p.strictEqual=function(e,t,r){e!==t&&v(e,t,r,"===",p.strictEqual)},p.notStrictEqual=function(e,t,r){e===t&&v(e,t,r,"!==",p.notStrictEqual)},p.throws=function(e,t,r){A(!0,e,t,r)},p.doesNotThrow=function(e,t,r){A(!1,e,t,r)},p.ifError=function(e){if(e)throw e},p.strict=n((function e(t,r){t||v(t,!0,r,"==",e)}),p,{equal:p.strictEqual,deepEqual:p.deepStrictEqual,notEqual:p.notStrictEqual,notDeepEqual:p.notDeepStrictEqual}),p.strict.strict=p.strict;var S=Object.keys||function(e){var t=[];for(var r in e)s.call(e,r)&&t.push(r);return t}}).call(this,r(4))},function(e,t,r){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var n=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function o(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var r,s,u=o(e),c=1;c<arguments.length;c++){for(var l in r=Object(arguments[c]))i.call(r,l)&&(u[l]=r[l]);if(n){s=n(r);for(var h=0;h<s.length;h++)a.call(r,s[h])&&(u[s[h]]=r[s[h]])}}return u}},function(e,t,r){(function(e){var n=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},i=/%[sdj%]/g;t.format=function(e){if(!v(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(s(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,a=n.length,o=String(e).replace(i,(function(e){if("%%"===e)return"%";if(r>=a)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}})),u=n[r];r<a;u=n[++r])y(u)||!b(u)?o+=" "+u:o+=" "+s(u);return o},t.deprecate=function(r,n){if(void 0!==e&&!0===e.noDeprecation)return r;if(void 0===e)return function(){return t.deprecate(r,n).apply(this,arguments)};var i=!1;return function(){if(!i){if(e.throwDeprecation)throw new Error(n);e.traceDeprecation?console.trace(n):console.error(n),i=!0}return r.apply(this,arguments)}};var a,o={};function s(e,r){var n={seen:[],stylize:c};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),m(r)?n.showHidden=r:r&&t._extend(n,r),E(n.showHidden)&&(n.showHidden=!1),E(n.depth)&&(n.depth=2),E(n.colors)&&(n.colors=!1),E(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=u),l(n,e,n.depth)}function u(e,t){var r=s.styles[t];return r?"["+s.colors[r][0]+"m"+e+"["+s.colors[r][1]+"m":e}function c(e,t){return e}function l(e,r,n){if(e.customInspect&&r&&S(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var i=r.inspect(n,e);return v(i)||(i=l(e,i,n)),i}var a=function(e,t){if(E(t))return e.stylize("undefined","undefined");if(v(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return g(t)?e.stylize(""+t,"number"):m(t)?e.stylize(""+t,"boolean"):y(t)?e.stylize("null","null"):void 0}(e,r);if(a)return a;var o=Object.keys(r),s=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(r)),A(r)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return h(r);if(0===o.length){if(S(r)){var u=r.name?": "+r.name:"";return e.stylize("[Function"+u+"]","special")}if(T(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(x(r))return e.stylize(Date.prototype.toString.call(r),"date");if(A(r))return h(r)}var c,d="",b=!1,R=["{","}"];return f(r)&&(b=!0,R=["[","]"]),S(r)&&(d=" [Function"+(r.name?": "+r.name:"")+"]"),T(r)&&(d=" "+RegExp.prototype.toString.call(r)),x(r)&&(d=" "+Date.prototype.toUTCString.call(r)),A(r)&&(d=" "+h(r)),0!==o.length||b&&0!=r.length?n<0?T(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),c=b?function(e,t,r,n,i){for(var a=[],o=0,s=t.length;o<s;++o)k(t,String(o))?a.push(p(e,t,r,n,String(o),!0)):a.push("");return i.forEach((function(i){i.match(/^\d+$/)||a.push(p(e,t,r,n,i,!0))})),a}(e,r,n,s,o):o.map((function(t){return p(e,r,n,s,t,b)})),e.seen.pop(),function(e,t,r){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]:r[0]+t+" "+e.join(", ")+" "+r[1]}(c,d,R)):R[0]+d+R[1]}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,r,n,i,a){var o,s,u;if((u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(s=e.stylize("[Setter]","special")),k(n,i)||(o="["+i+"]"),s||(e.seen.indexOf(u.value)<0?(s=y(r)?l(e,u.value,null):l(e,u.value,r-1)).indexOf("\n")>-1&&(s=a?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),E(o)){if(a&&i.match(/^\d+$/))return s;(o=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=e.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=e.stylize(o,"string"))}return o+": "+s}function f(e){return Array.isArray(e)}function m(e){return"boolean"==typeof e}function y(e){return null===e}function g(e){return"number"==typeof e}function v(e){return"string"==typeof e}function E(e){return void 0===e}function T(e){return b(e)&&"[object RegExp]"===R(e)}function b(e){return"object"===d(e)&&null!==e}function x(e){return b(e)&&"[object Date]"===R(e)}function A(e){return b(e)&&("[object Error]"===R(e)||e instanceof Error)}function S(e){return"function"==typeof e}function R(e){return Object.prototype.toString.call(e)}function w(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(r){if(E(a)&&(a=e.env.NODE_DEBUG||""),r=r.toUpperCase(),!o[r])if(new RegExp("\\b"+r+"\\b","i").test(a)){var n=e.pid;o[r]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",r,n,e)}}else o[r]=function(){};return o[r]},t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=f,t.isBoolean=m,t.isNull=y,t.isNullOrUndefined=function(e){return null==e},t.isNumber=g,t.isString=v,t.isSymbol=function(e){return"symbol"===d(e)},t.isUndefined=E,t.isRegExp=T,t.isObject=b,t.isDate=x,t.isError=A,t.isFunction=S,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"===d(e)||void 0===e},t.isBuffer=r(130);var C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function O(){var e=new Date,t=[w(e.getHours()),w(e.getMinutes()),w(e.getSeconds())].join(":");return[e.getDate(),C[e.getMonth()],t].join(" ")}function k(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",O(),t.format.apply(t,arguments))},t.inherits=r(131),t._extend=function(e,t){if(!t||!b(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};var N="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function _(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(N&&e[N]){var t;if("function"!=typeof(t=e[N]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,N,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,r,n=new Promise((function(e,n){t=e,r=n})),i=[],a=0;a<arguments.length;a++)i.push(arguments[a]);i.push((function(e,n){e?r(e):t(n)}));try{e.apply(this,i)}catch(e){r(e)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),N&&Object.defineProperty(t,N,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,n(e))},t.promisify.custom=N,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function r(){for(var r=[],n=0;n<arguments.length;n++)r.push(arguments[n]);var i=r.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var a=this,o=function(){return i.apply(a,arguments)};t.apply(this,r).then((function(t){e.nextTick(o,null,t)}),(function(t){e.nextTick(_,t,o)}))}return Object.setPrototypeOf(r,Object.getPrototypeOf(t)),Object.defineProperties(r,n(t)),r}}).call(this,r(129))},function(e,t){var r,n,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var u,c=[],l=!1,h=-1;function p(){l&&u&&(l=!1,u.length?c=u.concat(c):h=-1,c.length&&f())}function f(){if(!l){var e=s(p);l=!0;for(var t=c.length;t;){for(u=c,c=[];++h<t;)u&&u[h].run();h=-1,t=c.length}u=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new d(e,t)),1!==c.length||l||s(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){e.exports=function(e){return e&&"object"===d(e)&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},function(e,t,r){"use strict";r(1),r(63),r(64),r(109),r(75),r(133),r(136),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.AbsoluteRowRange=t.AbsoluteColumnRange=t.AbsoluteCellRange=t.WRONG_RANGE_SIZE=t.DIFFERENT_SHEETS_ERROR=void 0,r(125);var n=r(106),i=r(138),a=r(217);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h(e);if(t){var i=h(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return l(this,r)}}function l(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t,r){return t&&f(e.prototype,t),r&&f(e,r),e}var m="AbsoluteCellRange: Start and end are in different sheets";t.DIFFERENT_SHEETS_ERROR=m,t.WRONG_RANGE_SIZE="AbsoluteCellRange: Wrong range size";var y=function(){function e(t,r){if(p(this,e),t.sheet!==r.sheet)throw new Error(m);this.start=(0,n.simpleCellAddress)(t.sheet,t.col,t.row),this.end=(0,n.simpleCellAddress)(r.sheet,r.col,r.row)}return d(e,[{key:"isFinite",value:function(){return Number.isFinite(this.size())}},{key:"doesOverlap",value:function(e){return!(this.start.sheet!=e.start.sheet||this.end.row<e.start.row||this.start.row>e.end.row||this.end.col<e.start.col||this.start.col>e.end.col)}},{key:"addressInRange",value:function(e){return this.sheet===e.sheet&&this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col}},{key:"columnInRange",value:function(e){return this.sheet===e.sheet&&this.start.col<=e.col&&this.end.col>=e.col}},{key:"rowInRange",value:function(e){return this.sheet===e.sheet&&this.start.row<=e.row&&this.end.row>=e.row}},{key:"containsRange",value:function(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}},{key:"intersectionWith",value:function(t){if(this.sheet!==t.start.sheet)return null;var r=Math.max(this.start.row,t.start.row),i=Math.min(this.end.row,t.end.row),a=Math.max(this.start.col,t.start.col),o=Math.min(this.end.col,t.end.col);return r>i||a>o?null:new e((0,n.simpleCellAddress)(this.sheet,a,r),(0,n.simpleCellAddress)(this.sheet,o,i))}},{key:"includesRow",value:function(e){return this.start.row<e&&this.end.row>=e}},{key:"includesColumn",value:function(e){return this.start.col<e&&this.end.col>=e}},{key:"shiftByRows",value:function(e){this.start.row+=e,this.end.row+=e}},{key:"expandByRows",value:function(e){this.end.row+=e}},{key:"shiftByColumns",value:function(e){this.start.col+=e,this.end.col+=e}},{key:"shifted",value:function(t,r){return e.spanFrom((0,n.simpleCellAddress)(this.sheet,this.start.col+t,this.start.row+r),this.width(),this.height())}},{key:"expandByColumns",value:function(e){this.end.col+=e}},{key:"moveToSheet",value:function(e){this.start.sheet=e,this.end.sheet=e}},{key:"removeSpan",value:function(e){e instanceof a.RowsSpan?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}},{key:"removeRows",value:function(e,t){if(!(e>this.end.row)){if(t<this.start.row){var r=t-e+1;return this.shiftByRows(-r)}e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(t,this.end.row)-e+1}}},{key:"removeColumns",value:function(e,t){if(!(e>this.end.col)){if(t<this.start.col){var r=t-e+1;return this.shiftByColumns(-r)}e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(t,this.end.col)-e+1}}},{key:"shouldBeRemoved",value:function(){return this.width()<=0||this.height()<=0}},{key:"rangeWithSameWidth",value:function(t,r){return e.spanFrom((0,n.simpleCellAddress)(this.sheet,this.start.col,t),this.width(),r)}},{key:"rangeWithSameHeight",value:function(t,r){return e.spanFrom((0,n.simpleCellAddress)(this.sheet,t,this.start.row),r,this.height())}},{key:"toString",value:function(){return"".concat(this.start.sheet,",").concat(this.start.col,",").concat(this.start.row,",").concat(this.end.col,",").concat(this.end.row)}},{key:"width",value:function(){return this.end.col-this.start.col+1}},{key:"height",value:function(){return this.end.row-this.start.row+1}},{key:"size",value:function(){return this.height()*this.width()}},{key:"arrayOfAddressesInRange",value:function(){for(var e=[],t=0;t<this.height();++t){e[t]=[];for(var r=0;r<this.width();++r){var i=(0,n.simpleCellAddress)(this.sheet,this.start.col+r,this.start.row+t);e[t].push(i)}}return e}},{key:"withStart",value:function(t){return new e(t,this.end)}},{key:"sameDimensionsAs",value:function(e){return this.width()===e.width()&&this.height()===e.height()}},{key:"addresses",value:regeneratorRuntime.mark((function e(t){var r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.start.row;case 1:if(!(r<=this.effectiveEndRow(t))){e.next=12;break}i=this.start.col;case 3:if(!(i<=this.effectiveEndColumn(t))){e.next=9;break}return e.next=6,(0,n.simpleCellAddress)(this.start.sheet,i,r);case 6:i++,e.next=3;break;case 9:r++,e.next=1;break;case 12:case"end":return e.stop()}}),e,this)}))},{key:"addressesWithDirection",value:regeneratorRuntime.mark((function e(t,r,i){var a,o,s,u,c,l,h,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t>0)){e.next=30;break}if(!(r>0)){e.next=16;break}a=this.effectiveEndRow(i);case 3:if(!(a>=this.start.row)){e.next=14;break}o=this.effectiveEndColumn(i);case 5:if(!(o>=this.start.col)){e.next=11;break}return e.next=8,(0,n.simpleCellAddress)(this.start.sheet,o,a);case 8:o-=1,e.next=5;break;case 11:a-=1,e.next=3;break;case 14:e.next=28;break;case 16:s=this.start.row;case 17:if(!(s<=this.effectiveEndRow(i))){e.next=28;break}u=this.effectiveEndColumn(i);case 19:if(!(u>=this.start.col)){e.next=25;break}return e.next=22,(0,n.simpleCellAddress)(this.start.sheet,u,s);case 22:u-=1,e.next=19;break;case 25:s+=1,e.next=17;break;case 28:e.next=57;break;case 30:if(!(r>0)){e.next=45;break}c=this.effectiveEndRow(i);case 32:if(!(c>=this.start.row)){e.next=43;break}l=this.start.col;case 34:if(!(l<=this.effectiveEndColumn(i))){e.next=40;break}return e.next=37,(0,n.simpleCellAddress)(this.start.sheet,l,c);case 37:l+=1,e.next=34;break;case 40:c-=1,e.next=32;break;case 43:e.next=57;break;case 45:h=this.start.row;case 46:if(!(h<=this.effectiveEndRow(i))){e.next=57;break}p=this.start.col;case 48:if(!(p<=this.effectiveEndColumn(i))){e.next=54;break}return e.next=51,(0,n.simpleCellAddress)(this.start.sheet,p,h);case 51:p+=1,e.next=48;break;case 54:h+=1,e.next=46;break;case 57:case"end":return e.stop()}}),e,this)}))},{key:"getAddress",value:function(e,t){if(e<0||t<0||t>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return(0,n.simpleCellAddress)(this.start.sheet,this.start.col+e,this.start.row+t)}},{key:"exceedsSheetSizeLimits",value:function(e,t){return this.end.col>=e||this.end.row>=t}},{key:"effectiveEndColumn",value:function(e){return this.end.col}},{key:"effectiveEndRow",value:function(e){return this.end.row}},{key:"sheet",get:function(){return this.start.sheet}}],[{key:"fromAst",value:function(t,r){return t.type===i.AstNodeType.CELL_RANGE?e.fromCellRange(t,r):t.type===i.AstNodeType.COLUMN_RANGE?g.fromColumnRange(t,r):v.fromRowRange(t,r)}},{key:"fromCellRange",value:function(t,r){return new e(new i.CellAddress(t.start.sheet,t.start.col,t.start.row,t.start.type).toSimpleCellAddress(r),new i.CellAddress(t.end.sheet,t.end.col,t.end.row,t.end.type).toSimpleCellAddress(r))}},{key:"spanFrom",value:function(t,r,i){if(!Number.isFinite(r)&&Number.isFinite(i))return new v(t.sheet,t.row,t.row+i-1);if(!Number.isFinite(i)&&Number.isFinite(r))return new g(t.sheet,t.col,t.col+r-1);if(Number.isFinite(i)&&Number.isFinite(r))return new e(t,(0,n.simpleCellAddress)(t.sheet,t.col+r-1,t.row+i-1));throw new Error("AbsoluteCellRange: Wrong range size")}},{key:"fromCoordinates",value:function(t,r,i,a,o){return new e((0,n.simpleCellAddress)(t,r,i),(0,n.simpleCellAddress)(t,a,o))}},{key:"singleRangeFromCellAddress",value:function(t,r){var n=t.toSimpleCellAddress(r);return new e(n,n)}}]),e}();t.AbsoluteCellRange=y;var g=function(e){s(r,e);var t=c(r);function r(e,i,a){return p(this,r),t.call(this,(0,n.simpleCellAddress)(e,i,0),(0,n.simpleCellAddress)(e,a,Number.POSITIVE_INFINITY))}return d(r,null,[{key:"fromColumnRange",value:function(e,t){var n=e.start.toSimpleColumnAddress(t),i=e.end.toSimpleColumnAddress(t);if(n.sheet!==i.sheet)throw new Error(m);return new r(n.sheet,n.col,i.col)}}]),d(r,[{key:"shouldBeRemoved",value:function(){return this.width()<=0}},{key:"shiftByRows",value:function(e){}},{key:"expandByRows",value:function(e){}},{key:"shifted",value:function(e,t){return new r(this.sheet,this.start.col+e,this.end.col+e)}},{key:"removeRows",value:function(e,t){}},{key:"rangeWithSameHeight",value:function(e,t){return new r(this.sheet,e,e+t-1)}},{key:"exceedsSheetSizeLimits",value:function(e,t){return this.end.col>=e}},{key:"effectiveEndRow",value:function(e){return e.getSheetHeight(this.sheet)-1}}]),r}(y);t.AbsoluteColumnRange=g;var v=function(e){s(r,e);var t=c(r);function r(e,i,a){return p(this,r),t.call(this,(0,n.simpleCellAddress)(e,0,i),(0,n.simpleCellAddress)(e,Number.POSITIVE_INFINITY,a))}return d(r,null,[{key:"fromRowRange",value:function(e,t){var n=e.start.toSimpleRowAddress(t),i=e.end.toSimpleRowAddress(t);if(n.sheet!==i.sheet)throw new Error(m);return new r(n.sheet,n.row,i.row)}}]),d(r,[{key:"shouldBeRemoved",value:function(){return this.height()<=0}},{key:"shiftByColumns",value:function(e){}},{key:"expandByColumns",value:function(e){}},{key:"shifted",value:function(e,t){return new r(this.sheet,this.start.row+t,this.end.row+t)}},{key:"removeColumns",value:function(e,t){}},{key:"rangeWithSameWidth",value:function(e,t){return new r(this.sheet,e,e+t-1)}},{key:"exceedsSheetSizeLimits",value:function(e,t){return this.end.row>=t}},{key:"effectiveEndColumn",value:function(e){return e.getSheetWidth(this.sheet)-1}}]),r}(y);t.AbsoluteRowRange=v},function(e,t,r){"use strict";var n=r(6),i=r(3),a=r(45),o=r(22),s=r(16),u=r(12),c=r(120),l=r(14),h=r(7),p=r(50),f=r(37).f,d=r(5).f,m=r(20).f,y=r(134).trim,g=i.Number,v=g.prototype,E="Number"==u(p(v)),T=function(e){var t,r,n,i,a,o,s,u,c=l(e,!1);if("string"==typeof c&&c.length>2)if(43===(t=(c=y(c)).charCodeAt(0))||45===t){if(88===(r=c.charCodeAt(2))||120===r)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+c}for(o=(a=c.slice(2)).length,s=0;s<o;s++)if((u=a.charCodeAt(s))<48||u>i)return NaN;return parseInt(a,n)}return+c};if(a("Number",!g(" 0o1")||!g("0b1")||g("+0x1"))){for(var b,x=function(e){var t=arguments.length<1?0:e,r=this;return r instanceof x&&(E?h((function(){v.valueOf.call(r)})):"Number"!=u(r))?c(new g(T(t)),r,x):T(t)},A=n?f(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),S=0;A.length>S;S++)s(g,b=A[S])&&!s(x,b)&&m(x,b,d(g,b));x.prototype=v,v.constructor=x,o(i,"Number",x)}},function(e,t,r){var n=r(13),i="["+r(135)+"]",a=RegExp("^"+i+i+"*"),o=RegExp(i+i+"*$"),s=function(e){return function(t){var r=String(n(t));return 1&e&&(r=r.replace(a,"")),2&e&&(r=r.replace(o,"")),r}};e.exports={start:s(1),end:s(2),trim:s(3)}},function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},function(e,t,r){r(2)({target:"Number",stat:!0},{isFinite:r(137)})},function(e,t,r){var n=r(3).isFinite;e.exports=Number.isFinite||function(e){return"number"==typeof e&&n(e)}},function(e,t,r){"use strict";t.__esModule=!0,t.NamedExpressionDependency=t.RowRangeDependency=t.ColumnRangeDependency=t.CellRangeDependency=t.AddressDependency=t.Unparser=t.buildCellErrorAst=t.buildParsingErrorAst=t.buildCellRangeAst=t.buildProcedureAst=t.ParsingErrorType=t.AstNodeType=t.FormulaLexer=t.buildLexerConfig=t.collectDependencies=t.ParserWithCaching=t.CellAddress=t.simpleCellAddressToString=t.simpleCellAddressFromString=t.cellAddressFromString=void 0;var n=r(139);t.cellAddressFromString=n.cellAddressFromString,t.simpleCellAddressFromString=n.simpleCellAddressFromString,t.simpleCellAddressToString=n.simpleCellAddressToString;var i=r(152);t.CellAddress=i.CellAddress;var a=r(199);t.ParserWithCaching=a.ParserWithCaching;var o=r(215);t.collectDependencies=o.collectDependencies;var s=r(154);t.buildLexerConfig=s.buildLexerConfig;var u=r(208);t.FormulaLexer=u.FormulaLexer;var c=r(203);t.AstNodeType=c.AstNodeType,t.ParsingErrorType=c.ParsingErrorType,t.buildProcedureAst=c.buildProcedureAst,t.buildCellRangeAst=c.buildCellRangeAst,t.buildParsingErrorAst=c.buildParsingErrorAst,t.buildCellErrorAst=c.buildCellErrorAst;var l=r(214);t.Unparser=l.Unparser;var h=r(216);t.AddressDependency=h.AddressDependency,t.CellRangeDependency=h.CellRangeDependency,t.ColumnRangeDependency=h.ColumnRangeDependency,t.RowRangeDependency=h.RowRangeDependency,t.NamedExpressionDependency=h.NamedExpressionDependency},function(e,t,r){"use strict";r(109),r(140),r(133),r(142),r(144),r(96),r(146),r(150),t.__esModule=!0,t.columnIndexToLabel=f,t.sheetIndexToString=d,t.simpleCellAddressToString=t.simpleCellAddressFromString=t.rowAddressFromString=t.columnAddressFromString=t.cellAddressFromString=void 0;var n=r(106),i=r(152),a=r(153),o=r(154),s=r(198),u=new RegExp("^(".concat(o.sheetNameRegexp,")?(\\$?)([A-Za-z]+)(\\$?)([0-9]+)$")),c=new RegExp("^(".concat(o.sheetNameRegexp,")?(\\$?)([A-Za-z]+)$")),l=new RegExp("^(".concat(o.sheetNameRegexp,")?(\\$?)([0-9]+)$")),h=new RegExp("^".concat(o.simpleSheetName,"$"));function p(e){return 1===e.length?e.toUpperCase().charCodeAt(0)-65:e.split("").reduce((function(e,t){return 26*e+(t.toUpperCase().charCodeAt(0)-64)}),0)-1}function f(e){for(var t="";e>=0;)t=String.fromCharCode(e%26+97)+t,e=Math.floor(e/26)-1;return t.toUpperCase()}function d(e,t){var r=t(e);if(void 0!==r)return h.test(r)?r:(r=r.replace(/'/g,"''"),"'".concat(r,"'"))}function m(e,t){var r,n=null!==(r=e[3])&&void 0!==r?r:e[2],i=null;if(!n||void 0!==(i=t(n=n.replace(/''/g,"'"))))return i}t.cellAddressFromString=function(e,t,r){var n=u.exec(t),a=p(n[6]),o=m(n,e);if(void 0!==o){var s=Number(n[8])-1;return"$"===n[5]&&"$"===n[7]?i.CellAddress.absolute(o,a,s):"$"===n[5]?i.CellAddress.absoluteCol(o,a,s-r.row):"$"===n[7]?i.CellAddress.absoluteRow(o,a-r.col,s):i.CellAddress.relative(o,a-r.col,s-r.row)}},t.columnAddressFromString=function(e,t,r){var n=c.exec(t),i=m(n,e);if(void 0!==i){var o=p(n[6]);return"$"===n[5]?a.ColumnAddress.absolute(i,o):a.ColumnAddress.relative(i,o-r.col)}},t.rowAddressFromString=function(e,t,r){var n=l.exec(t),i=m(n,e);if(void 0!==i){var a=Number(n[6])-1;return"$"===n[5]?s.RowAddress.absolute(i,a):s.RowAddress.relative(i,a-r.row)}},t.simpleCellAddressFromString=function(e,t,r){var i=u.exec(t),a=p(i[6]),o=m(i,e);if(void 0!==o){null===o&&(o=r);var s=Number(i[8])-1;return(0,n.simpleCellAddress)(o,a,s)}},t.simpleCellAddressToString=function(e,t,r){var n=f(t.col),i=d(t.sheet,e);if(void 0!==i)return r!==t.sheet?"".concat(i,"!").concat(n).concat(t.row+1):"".concat(n).concat(t.row+1)}},function(e,t,r){"use strict";var n=r(2),i=r(141).left,a=r(112),o=r(88),s=a("reduce"),u=o("reduce",{1:0});n({target:"Array",proto:!0,forced:!s||!u},{reduce:function(e){return i(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},function(e,t,r){var n=r(61),i=r(49),a=r(11),o=r(40),s=function(e){return function(t,r,s,u){n(r);var c=i(t),l=a(c),h=o(c.length),p=e?h-1:0,f=e?-1:1;if(s<2)for(;;){if(p in l){u=l[p],p+=f;break}if(p+=f,e?p<0:h<=p)throw TypeError("Reduce of empty array with no initial value")}for(;e?p>=0:h>p;p+=f)p in l&&(u=r(u,l[p],p,c));return u}};e.exports={left:s(!1),right:s(!0)}},function(e,t,r){var n=r(6),i=r(3),a=r(45),o=r(120),s=r(20).f,u=r(37).f,c=r(102),l=r(97),h=r(143),p=r(22),f=r(7),d=r(26).set,m=r(123),y=r(55)("match"),g=i.RegExp,v=g.prototype,E=/a/g,T=/a/g,b=new g(E)!==E,x=h.UNSUPPORTED_Y;if(n&&a("RegExp",!b||x||f((function(){return T[y]=!1,g(E)!=E||g(T)==T||"/a/i"!=g(E,"i")})))){for(var A=function(e,t){var r,n=this instanceof A,i=c(e),a=void 0===t;if(!n&&i&&e.constructor===A&&a)return e;b?i&&!a&&(e=e.source):e instanceof A&&(a&&(t=l.call(e)),e=e.source),x&&(r=!!t&&t.indexOf("y")>-1)&&(t=t.replace(/y/g,""));var s=o(b?new g(e,t):g(e,t),n?this:v,A);return x&&r&&d(s,{sticky:r}),s},S=function(e){e in A||s(A,e,{configurable:!0,get:function(){return g[e]},set:function(t){g[e]=t}})},R=u(g),w=0;R.length>w;)S(R[w++]);v.constructor=A,A.prototype=v,p(i,"RegExp",A)}m("RegExp")},function(e,t,r){"use strict";var n=r(7);function i(e,t){return RegExp(e,t)}t.UNSUPPORTED_Y=n((function(){var e=i("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),t.BROKEN_CARET=n((function(){var e=i("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},function(e,t,r){"use strict";var n=r(2),i=r(145);n({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},function(e,t,r){"use strict";var n,i,a=r(97),o=r(143),s=RegExp.prototype.exec,u=String.prototype.replace,c=s,l=(n=/a/,i=/b*/g,s.call(n,"a"),s.call(i,"a"),0!==n.lastIndex||0!==i.lastIndex),h=o.UNSUPPORTED_Y||o.BROKEN_CARET,p=void 0!==/()??/.exec("")[1];(l||p||h)&&(c=function(e){var t,r,n,i,o=this,c=h&&o.sticky,f=a.call(o),d=o.source,m=0,y=e;return c&&(-1===(f=f.replace("y","")).indexOf("g")&&(f+="g"),y=String(e).slice(o.lastIndex),o.lastIndex>0&&(!o.multiline||o.multiline&&"\n"!==e[o.lastIndex-1])&&(d="(?: "+d+")",y=" "+y,m++),r=new RegExp("^(?:"+d+")",f)),p&&(r=new RegExp("^"+d+"$(?!\\s)",f)),l&&(t=o.lastIndex),n=s.call(c?r:o,y),c?n?(n.input=n.input.slice(m),n[0]=n[0].slice(m),n.index=o.lastIndex,o.lastIndex+=n[0].length):o.lastIndex=0:l&&n&&(o.lastIndex=o.global?n.index+n[0].length:t),p&&n&&n.length>1&&u.call(n[0],r,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(n[i]=void 0)})),n}),e.exports=c},function(e,t,r){"use strict";var n=r(147),i=r(21),a=r(49),o=r(40),s=r(41),u=r(13),c=r(148),l=r(149),h=Math.max,p=Math.min,f=Math.floor,d=/\$([$&'`]|\d\d?|<[^>]*>)/g,m=/\$([$&'`]|\d\d?)/g;n("replace",2,(function(e,t,r,n){var y=n.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,g=n.REPLACE_KEEPS_$0,v=y?"$":"$0";return[function(r,n){var i=u(this),a=null==r?void 0:r[e];return void 0!==a?a.call(r,i,n):t.call(String(i),r,n)},function(e,n){if(!y&&g||"string"==typeof n&&-1===n.indexOf(v)){var a=r(t,e,this,n);if(a.done)return a.value}var u=i(e),f=String(this),d="function"==typeof n;d||(n=String(n));var m=u.global;if(m){var T=u.unicode;u.lastIndex=0}for(var b=[];;){var x=l(u,f);if(null===x)break;if(b.push(x),!m)break;""===String(x[0])&&(u.lastIndex=c(f,o(u.lastIndex),T))}for(var A,S="",R=0,w=0;w<b.length;w++){x=b[w];for(var C=String(x[0]),O=h(p(s(x.index),f.length),0),k=[],N=1;N<x.length;N++)k.push(void 0===(A=x[N])?A:String(A));var _=x.groups;if(d){var I=[C].concat(k,O,f);void 0!==_&&I.push(_);var M=String(n.apply(void 0,I))}else M=E(C,f,O,k,_,n);O>=R&&(S+=f.slice(R,O)+M,R=O+C.length)}return S+f.slice(R)}];function E(e,r,n,i,o,s){var u=n+e.length,c=i.length,l=m;return void 0!==o&&(o=a(o),l=d),t.call(s,l,(function(t,a){var s;switch(a.charAt(0)){case"$":return"$";case"&":return e;case"`":return r.slice(0,n);case"'":return r.slice(u);case"<":s=o[a.slice(1,-1)];break;default:var l=+a;if(0===l)return t;if(l>c){var h=f(l/10);return 0===h?t:h<=c?void 0===i[h-1]?a.charAt(1):i[h-1]+a.charAt(1):t}s=i[l-1]}return void 0===s?"":s}))}}))},function(e,t,r){"use strict";r(144);var n=r(22),i=r(7),a=r(55),o=r(145),s=r(19),u=a("species"),c=!i((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),l="$0"==="a".replace(/./,"$0"),h=a("replace"),p=!!/./[h]&&""===/./[h]("a","$0"),f=!i((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return 2!==r.length||"a"!==r[0]||"b"!==r[1]}));e.exports=function(e,t,r,h){var d=a(e),m=!i((function(){var t={};return t[d]=function(){return 7},7!=""[e](t)})),y=m&&!i((function(){var t=!1,r=/a/;return"split"===e&&((r={}).constructor={},r.constructor[u]=function(){return r},r.flags="",r[d]=/./[d]),r.exec=function(){return t=!0,null},r[d](""),!t}));if(!m||!y||"replace"===e&&(!c||!l||p)||"split"===e&&!f){var g=/./[d],v=r(d,""[e],(function(e,t,r,n,i){return t.exec===o?m&&!i?{done:!0,value:g.call(t,r,n)}:{done:!0,value:e.call(r,t,n)}:{done:!1}}),{REPLACE_KEEPS_$0:l,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:p}),E=v[0],T=v[1];n(String.prototype,e,E),n(RegExp.prototype,d,2==t?function(e,t){return T.call(e,this,t)}:function(e){return T.call(e,this)})}h&&s(RegExp.prototype[d],"sham",!0)}},function(e,t,r){"use strict";var n=r(99).charAt;e.exports=function(e,t,r){return t+(r?n(e,t).length:1)}},function(e,t,r){var n=r(12),i=r(145);e.exports=function(e,t){var r=e.exec;if("function"==typeof r){var a=r.call(e,t);if("object"!==d(a))throw TypeError("RegExp exec method returned something other than an Object or null");return a}if("RegExp"!==n(e))throw TypeError("RegExp#exec called on incompatible receiver");return i.call(e,t)}},function(e,t,r){"use strict";var n=r(147),i=r(102),a=r(21),o=r(13),s=r(151),u=r(148),c=r(40),l=r(149),h=r(145),p=r(7),f=[].push,d=Math.min,m=!p((function(){return!RegExp(4294967295,"y")}));n("split",2,(function(e,t,r){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,r){var n=String(o(this)),a=void 0===r?4294967295:r>>>0;if(0===a)return[];if(void 0===e)return[n];if(!i(e))return t.call(n,e,a);for(var s,u,c,l=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),d=0,m=new RegExp(e.source,p+"g");(s=h.call(m,n))&&!((u=m.lastIndex)>d&&(l.push(n.slice(d,s.index)),s.length>1&&s.index<n.length&&f.apply(l,s.slice(1)),c=s[0].length,d=u,l.length>=a));)m.lastIndex===s.index&&m.lastIndex++;return d===n.length?!c&&m.test("")||l.push(""):l.push(n.slice(d)),l.length>a?l.slice(0,a):l}:"0".split(void 0,0).length?function(e,r){return void 0===e&&0===r?[]:t.call(this,e,r)}:t,[function(t,r){var i=o(this),a=null==t?void 0:t[e];return void 0!==a?a.call(t,i,r):n.call(String(i),t,r)},function(e,i){var o=r(n,e,this,i,n!==t);if(o.done)return o.value;var h=a(e),p=String(this),f=s(h,RegExp),y=h.unicode,g=(h.ignoreCase?"i":"")+(h.multiline?"m":"")+(h.unicode?"u":"")+(m?"y":"g"),v=new f(m?h:"^(?:"+h.source+")",g),E=void 0===i?4294967295:i>>>0;if(0===E)return[];if(0===p.length)return null===l(v,p)?[p]:[];for(var T=0,b=0,x=[];b<p.length;){v.lastIndex=m?b:0;var A,S=l(v,m?p:p.slice(b));if(null===S||(A=d(c(v.lastIndex+(m?0:b)),p.length))===T)b=u(p,b,y);else{if(x.push(p.slice(T,b)),x.length===E)return x;for(var R=1;R<=S.length-1;R++)if(x.push(S[R]),x.length===E)return x;b=T=A}}return x.push(p.slice(T)),x}]}),!m)},function(e,t,r){var n=r(21),i=r(61),a=r(55)("species");e.exports=function(e,t){var r,o=n(e).constructor;return void 0===o||null==(r=n(o)[a])?t:i(r)}},function(e,t,r){"use strict";r(109),t.__esModule=!0,t.CellAddress=t.CellReferenceType=void 0;var n,i=r(106),a=r(139);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}t.CellReferenceType=n,function(e){e.CELL_REFERENCE_RELATIVE="CELL_REFERENCE",e.CELL_REFERENCE_ABSOLUTE="CELL_REFERENCE_ABSOLUTE",e.CELL_REFERENCE_ABSOLUTE_COL="CELL_REFERENCE_ABSOLUTE_COL",e.CELL_REFERENCE_ABSOLUTE_ROW="CELL_REFERENCE_ABSOLUTE_ROW"}(n||(t.CellReferenceType=n={}));var s=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sheet=t,this.col=r,this.row=n,this.type=i}var t,r,s;return t=e,s=[{key:"relative",value:function(t,r,i){return new e(t,r,i,n.CELL_REFERENCE_RELATIVE)}},{key:"absolute",value:function(t,r,i){return new e(t,r,i,n.CELL_REFERENCE_ABSOLUTE)}},{key:"absoluteCol",value:function(t,r,i){return new e(t,r,i,n.CELL_REFERENCE_ABSOLUTE_COL)}},{key:"absoluteRow",value:function(t,r,i){return new e(t,r,i,n.CELL_REFERENCE_ABSOLUTE_ROW)}}],(r=[{key:"toSimpleCellAddress",value:function(e){var t=(0,i.absoluteSheetReference)(this,e);return this.type===n.CELL_REFERENCE_ABSOLUTE?(0,i.simpleCellAddress)(t,this.col,this.row):this.type===n.CELL_REFERENCE_ABSOLUTE_ROW?(0,i.simpleCellAddress)(t,e.col+this.col,this.row):this.type===n.CELL_REFERENCE_ABSOLUTE_COL?(0,i.simpleCellAddress)(t,this.col,e.row+this.row):(0,i.simpleCellAddress)(t,e.col+this.col,e.row+this.row)}},{key:"toSimpleColumnAddress",value:function(e){var t=(0,i.absoluteSheetReference)(this,e),r=this.col;return this.isColumnRelative()&&(r+=e.col),(0,i.simpleColumnAddress)(t,r)}},{key:"toSimpleRowAddress",value:function(e){var t=(0,i.absoluteSheetReference)(this,e),r=this.row;return this.isRowRelative()&&(r+=e.row),(0,i.simpleRowAddress)(t,r)}},{key:"isRowAbsolute",value:function(){return this.type===n.CELL_REFERENCE_ABSOLUTE||this.type===n.CELL_REFERENCE_ABSOLUTE_ROW}},{key:"isColumnAbsolute",value:function(){return this.type===n.CELL_REFERENCE_ABSOLUTE||this.type===n.CELL_REFERENCE_ABSOLUTE_COL}},{key:"isColumnRelative",value:function(){return this.type===n.CELL_REFERENCE_RELATIVE||this.type===n.CELL_REFERENCE_ABSOLUTE_ROW}},{key:"isRowRelative",value:function(){return this.type===n.CELL_REFERENCE_RELATIVE||this.type===n.CELL_REFERENCE_ABSOLUTE_COL}},{key:"isAbsolute",value:function(){return this.type===n.CELL_REFERENCE_ABSOLUTE&&null!==this.sheet}},{key:"shiftedByRows",value:function(t){return new e(this.sheet,this.col,this.row+t,this.type)}},{key:"shiftedByColumns",value:function(t){return new e(this.sheet,this.col+t,this.row,this.type)}},{key:"moved",value:function(t,r,n){return new e(null===this.sheet?null:t,this.col+r,this.row+n,this.type)}},{key:"withAbsoluteSheet",value:function(t){return new e(t,this.col,this.row,this.type)}},{key:"shiftRelativeDimensions",value:function(t,r){var n=this.isColumnAbsolute()?this.col:this.col+t,i=this.isRowAbsolute()?this.row:this.row+r;return new e(this.sheet,n,i,this.type)}},{key:"shiftAbsoluteDimensions",value:function(t,r){var n=this.isColumnRelative()?this.col:this.col+t,i=this.isRowRelative()?this.row:this.row+r;return new e(this.sheet,n,i,this.type)}},{key:"hash",value:function(e){var t=e&&null!==this.sheet?"#".concat(this.sheet):"";switch(this.type){case n.CELL_REFERENCE_RELATIVE:return"".concat(t,"#").concat(this.row,"R").concat(this.col);case n.CELL_REFERENCE_ABSOLUTE:return"".concat(t,"#").concat(this.row,"A").concat(this.col);case n.CELL_REFERENCE_ABSOLUTE_COL:return"".concat(t,"#").concat(this.row,"AC").concat(this.col);case n.CELL_REFERENCE_ABSOLUTE_ROW:return"".concat(t,"#").concat(this.row,"AR").concat(this.col)}}},{key:"unparse",value:function(e){var t=this.toSimpleCellAddress(e),r=(0,a.columnIndexToLabel)(t.col),i=this.type===n.CELL_REFERENCE_ABSOLUTE||this.type===n.CELL_REFERENCE_ABSOLUTE_ROW?"$":"",o=this.type===n.CELL_REFERENCE_ABSOLUTE||this.type===n.CELL_REFERENCE_ABSOLUTE_COL?"$":"";return"".concat(o).concat(r).concat(i).concat(t.row+1)}},{key:"exceedsSheetSizeLimits",value:function(e,t){return this.row>=t||this.col>=e}}])&&o(t.prototype,r),s&&o(t,s),e}();t.CellAddress=s},function(e,t,r){"use strict";r(109),t.__esModule=!0,t.ColumnAddress=t.ReferenceType=void 0;var n,i=r(106),a=r(139);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}t.ReferenceType=n,function(e){e.RELATIVE="RELATIVE",e.ABSOLUTE="ABSOLUTE"}(n||(t.ReferenceType=n={}));var s=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sheet=t,this.col=r,this.type=n}var t,r,s;return t=e,s=[{key:"absolute",value:function(t,r){return new e(t,r,n.ABSOLUTE)}},{key:"relative",value:function(t,r){return new e(t,r,n.RELATIVE)}}],(r=[{key:"isColumnAbsolute",value:function(){return this.type===n.ABSOLUTE}},{key:"isColumnRelative",value:function(){return this.type===n.RELATIVE}},{key:"isAbsolute",value:function(){return this.type===n.ABSOLUTE&&null!==this.sheet}},{key:"moved",value:function(t,r,n){return new e(null===this.sheet?null:t,this.col+r,this.type)}},{key:"shiftedByColumns",value:function(t){return new e(this.sheet,this.col+t,this.type)}},{key:"toSimpleColumnAddress",value:function(e){var t=(0,i.absoluteSheetReference)(this,e),r=this.col;return this.isColumnRelative()&&(r=e.col+this.col),(0,i.simpleColumnAddress)(t,r)}},{key:"shiftRelativeDimensions",value:function(t,r){var n=this.isColumnRelative()?this.col+t:this.col;return new e(this.sheet,n,this.type)}},{key:"shiftAbsoluteDimensions",value:function(t,r){var n=this.isColumnAbsolute()?this.col+t:this.col;return new e(this.sheet,n,this.type)}},{key:"withAbsoluteSheet",value:function(t){return new e(t,this.col,this.type)}},{key:"hash",value:function(e){var t=e&&null!==this.sheet?"#".concat(this.sheet):"";switch(this.type){case n.RELATIVE:return"".concat(t,"#COLR").concat(this.col);case n.ABSOLUTE:return"".concat(t,"#COLA").concat(this.col)}}},{key:"unparse",value:function(e){var t=this.toSimpleColumnAddress(e),r=(0,a.columnIndexToLabel)(t.col),i=this.type===n.ABSOLUTE?"$":"";return"".concat(i).concat(r)}},{key:"exceedsSheetSizeLimits",value:function(e){return this.col>=e}}])&&o(t.prototype,r),s&&o(t,s),e}();t.ColumnAddress=s},function(e,t,r){"use strict";r(109),r(142),r(144),r(96),t.__esModule=!0,t.buildLexerConfig=t.WhiteSpace=t.ErrorLiteral=t.StringLiteral=t.NamedExpression=t.ProcedureName=t.RParen=t.LParen=t.RangeSeparator=t.RowRange=t.ColumnRange=t.CellReference=t.sheetNameRegexp=t.quotedSheetName=t.simpleSheetName=t.ConcatenateOp=t.LessThanOrEqualOp=t.GreaterThanOrEqualOp=t.LessThanOp=t.GreaterThanOp=t.NotEqualOp=t.EqualsOp=t.BooleanOp=t.PercentOp=t.PowerOp=t.DivOp=t.TimesOp=t.MultiplicationOp=t.MinusOp=t.PlusOp=t.AdditionOp=void 0;var n=r(155),i=(0,n.createToken)({name:"AdditionOp",pattern:n.Lexer.NA});
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */t.AdditionOp=i;var a=(0,n.createToken)({name:"PlusOp",pattern:/\+/,categories:i});t.PlusOp=a;var o=(0,n.createToken)({name:"MinusOp",pattern:/-/,categories:i});t.MinusOp=o;var s=(0,n.createToken)({name:"MultiplicationOp",pattern:n.Lexer.NA});t.MultiplicationOp=s;var u=(0,n.createToken)({name:"TimesOp",pattern:/\*/,categories:s});t.TimesOp=u;var c=(0,n.createToken)({name:"DivOp",pattern:/\//,categories:s});t.DivOp=c;var l=(0,n.createToken)({name:"PowerOp",pattern:/\^/});t.PowerOp=l;var h=(0,n.createToken)({name:"PercentOp",pattern:/%/});t.PercentOp=h;var p=(0,n.createToken)({name:"BooleanOp",pattern:n.Lexer.NA});t.BooleanOp=p;var f=(0,n.createToken)({name:"EqualsOp",pattern:/=/,categories:p});t.EqualsOp=f;var d=(0,n.createToken)({name:"NotEqualOp",pattern:/<>/,categories:p});t.NotEqualOp=d;var m=(0,n.createToken)({name:"GreaterThanOp",pattern:/>/,categories:p});t.GreaterThanOp=m;var y=(0,n.createToken)({name:"LessThanOp",pattern:/</,categories:p});t.LessThanOp=y;var g=(0,n.createToken)({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:p});t.GreaterThanOrEqualOp=g;var v=(0,n.createToken)({name:"LessThanOrEqualOp",pattern:/<=/,categories:p});t.LessThanOrEqualOp=v;var E=(0,n.createToken)({name:"ConcatenateOp",pattern:/&/});t.ConcatenateOp=E,t.simpleSheetName="[A-Za-z0-9_À-ʯ]+",t.quotedSheetName="'(((?!').|'')*)'";var T="(".concat("[A-Za-z0-9_À-ʯ]+","|").concat("'(((?!').|'')*)'",")!");t.sheetNameRegexp=T;var b=(0,n.createToken)({name:"CellReference",pattern:new RegExp("(".concat(T,")?\\$?[A-Za-z]+\\$?[0-9]+"))});t.CellReference=b;var x=(0,n.createToken)({name:"ColumnRange",pattern:new RegExp("(".concat(T,")?\\$?[A-Za-z]+:(").concat(T,")?\\$?[A-Za-z]+"))});t.ColumnRange=x;var A=(0,n.createToken)({name:"RowRange",pattern:new RegExp("(".concat(T,")?\\$?[0-9]+:(").concat(T,")?\\$?[0-9]+"))});t.RowRange=A;var S=(0,n.createToken)({name:"RangeSeparator",pattern:/:/});t.RangeSeparator=S;var R=(0,n.createToken)({name:"LParen",pattern:/\(/});t.LParen=R;var w=(0,n.createToken)({name:"RParen",pattern:/\)/});t.RParen=w;var C=(0,n.createToken)({name:"ProcedureName",pattern:/([A-Za-z\u00C0-\u02AF][A-Za-z0-9\u00C0-\u02AF._]*)\(/});t.ProcedureName=C;var O=(0,n.createToken)({name:"NamedExpression",pattern:/[A-Za-z\u00C0-\u02AF_][A-Za-z0-9\u00C0-\u02AF._]*/});t.NamedExpression=O;var k=(0,n.createToken)({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/});t.StringLiteral=k;var N=(0,n.createToken)({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/});t.ErrorLiteral=N;var _=(0,n.createToken)({name:"WhiteSpace",pattern:/[ \t\n\r]+/});t.WhiteSpace=_,t.buildLexerConfig=function(e){var t=e.translationPackage.getFunctionTranslation("OFFSET"),r=e.errorMapping,T=e.translationPackage.buildFunctionMapping(),I=(0,n.createToken)({name:"ArgSeparator",pattern:e.functionArgSeparator}),M=(0,n.createToken)({name:"NumberLiteral",pattern:new RegExp("[\\d]*[".concat(e.decimalSeparator,"]?[\\d]+"))}),P=(0,n.createToken)({name:"OffsetProcedureName",pattern:new RegExp(t,"i")});return{ArgSeparator:I,NumberLiteral:M,OffsetProcedureName:P,allTokens:[_,a,o,u,c,l,f,d,h,g,v,m,y,R,w,P,C,S,I,x,A,M,k,N,E,p,i,s,b,O],errorMapping:r,functionMapping:T,decimalSeparator:e.decimalSeparator,maxColumns:e.maxColumns,maxRows:e.maxRows}}},function(e,t,r){"use strict";r.r(t),r.d(t,"clearCache",(function(){return m}));var n=r(156);r.d(t,"VERSION",(function(){return n.VERSION}));var i=r(157);r.d(t,"Parser",(function(){return i.Parser})),r.d(t,"CstParser",(function(){return i.CstParser})),r.d(t,"EmbeddedActionsParser",(function(){return i.EmbeddedActionsParser})),r.d(t,"ParserDefinitionErrorType",(function(){return i.ParserDefinitionErrorType})),r.d(t,"EMPTY_ALT",(function(){return i.EMPTY_ALT}));var a=r(163);r.d(t,"Lexer",(function(){return a.Lexer})),r.d(t,"LexerDefinitionErrorType",(function(){return a.LexerDefinitionErrorType}));var o=r(162);r.d(t,"createToken",(function(){return o.createToken})),r.d(t,"createTokenInstance",(function(){return o.createTokenInstance})),r.d(t,"EOF",(function(){return o.EOF})),r.d(t,"tokenLabel",(function(){return o.tokenLabel})),r.d(t,"tokenMatcher",(function(){return o.tokenMatcher})),r.d(t,"tokenName",(function(){return o.tokenName}));var s=r(176);r.d(t,"defaultGrammarResolverErrorProvider",(function(){return s.defaultGrammarResolverErrorProvider})),r.d(t,"defaultGrammarValidatorErrorProvider",(function(){return s.defaultGrammarValidatorErrorProvider})),r.d(t,"defaultParserErrorProvider",(function(){return s.defaultParserErrorProvider}));var u=r(183);r.d(t,"EarlyExitException",(function(){return u.EarlyExitException})),r.d(t,"isRecognitionException",(function(){return u.isRecognitionException})),r.d(t,"MismatchedTokenException",(function(){return u.MismatchedTokenException})),r.d(t,"NotAllInputParsedException",(function(){return u.NotAllInputParsedException})),r.d(t,"NoViableAltException",(function(){return u.NoViableAltException}));var c=r(169);r.d(t,"defaultLexerErrorProvider",(function(){return c.defaultLexerErrorProvider}));var l=r(161);r.d(t,"Alternation",(function(){return l.Alternation})),r.d(t,"Flat",(function(){return l.Flat})),r.d(t,"NonTerminal",(function(){return l.NonTerminal})),r.d(t,"Option",(function(){return l.Option})),r.d(t,"Repetition",(function(){return l.Repetition})),r.d(t,"RepetitionMandatory",(function(){return l.RepetitionMandatory})),r.d(t,"RepetitionMandatoryWithSeparator",(function(){return l.RepetitionMandatoryWithSeparator})),r.d(t,"RepetitionWithSeparator",(function(){return l.RepetitionWithSeparator})),r.d(t,"Rule",(function(){return l.Rule})),r.d(t,"Terminal",(function(){return l.Terminal})),r.d(t,"serializeGrammar",(function(){return l.serializeGrammar})),r.d(t,"serializeProduction",(function(){return l.serializeProduction}));var h=r(172);r.d(t,"GAstVisitor",(function(){return h.GAstVisitor}));var p=r(180);r.d(t,"assignOccurrenceIndices",(function(){return p.assignOccurrenceIndices})),r.d(t,"resolveGrammar",(function(){return p.resolveGrammar})),r.d(t,"validateGrammar",(function(){return p.validateGrammar}));var f=r(195);r.d(t,"createSyntaxDiagramsCode",(function(){return f.createSyntaxDiagramsCode}));var d=r(196);function m(){console.warn("The clearCache function was 'soft' removed from the Chevrotain API.\n\t It performs no action other than printing this message.\n\t Please avoid using it as it will be completely removed in the future")}r.d(t,"generateParserFactory",(function(){return d.generateParserFactory})),r.d(t,"generateParserModule",(function(){return d.generateParserModule}))},function(e,t,r){"use strict";r.r(t),r.d(t,"VERSION",(function(){return n}));var n="6.5.0"},function(e,t,r){"use strict";r.r(t),r.d(t,"END_OF_FILE",(function(){return b})),r.d(t,"DEFAULT_PARSER_CONFIG",(function(){return A})),r.d(t,"DEFAULT_RULE_CONFIG",(function(){return S})),r.d(t,"ParserDefinitionErrorType",(function(){return x})),r.d(t,"EMPTY_ALT",(function(){return R})),r.d(t,"Parser",(function(){return w})),r.d(t,"CstParser",(function(){return C})),r.d(t,"EmbeddedActionsParser",(function(){return O}));var n,i=r(158),a=r(159),o=r(162),s=r(174),u=r(176),c=r(180),l=r(182),h=r(184),p=r(185),f=r(188),d=r(189),m=r(190),y=r(191),g=r(192),v=r(193),E=r(194),T=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),b=Object(o.createTokenInstance)(o.EOF,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(b);var x,A=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:u.defaultParserErrorProvider,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),S=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0});function R(e){return void 0===e&&(e=void 0),function(){return e}}!function(e){e[e.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",e[e.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",e[e.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",e[e.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",e[e.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",e[e.LEFT_RECURSION=5]="LEFT_RECURSION",e[e.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",e[e.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",e[e.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",e[e.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",e[e.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",e[e.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",e[e.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",e[e.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",e[e.TOO_MANY_ALTS=14]="TOO_MANY_ALTS"}(x||(x={}));var w=function(){function e(e,t){void 0===t&&(t=A),this.ignoredIssues=A.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1,this.initErrorHandler(t),this.initLexerAdapter(),this.initLooksAhead(t),this.initRecognizerEngine(e,t),this.initRecoverable(t),this.initTreeBuilder(t),this.initContentAssist(),this.initGastRecorder(t),this.initPerformanceTracer(t),Object(i.has)(t,"ignoredIssues")&&t.ignoredIssues!==A.ignoredIssues&&Object(i.PRINT_WARNING)("The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.\n\tPlease use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead."),this.ignoredIssues=Object(i.has)(t,"ignoredIssues")?t.ignoredIssues:A.ignoredIssues,this.skipValidations=Object(i.has)(t,"skipValidations")?t.skipValidations:A.skipValidations}return e.performSelfAnalysis=function(e){e.performSelfAnalysis()},e.prototype.performSelfAnalysis=function(){var t=this;this.TRACE_INIT("performSelfAnalysis",(function(){var r;t.selfAnalysisDone=!0;var n=t.className;t.TRACE_INIT("toFastProps",(function(){Object(i.toFastProperties)(t)})),t.TRACE_INIT("Grammar Recording",(function(){try{t.enableRecording(),Object(i.forEach)(t.definedRulesNames,(function(e){var r=t[e].originalGrammarAction,n=void 0;t.TRACE_INIT(e+" Rule",(function(){n=t.topLevelRuleRecord(e,r)})),t.gastProductionsCache[e]=n}))}finally{t.disableRecording()}}));var o=[];if(t.TRACE_INIT("Grammar Resolving",(function(){o=Object(c.resolveGrammar)({rules:Object(i.values)(t.gastProductionsCache)}),t.definitionErrors.push.apply(t.definitionErrors,o)})),t.TRACE_INIT("Grammar Validations",(function(){if(Object(i.isEmpty)(o)&&!1===t.skipValidations){var e=Object(c.validateGrammar)({rules:Object(i.values)(t.gastProductionsCache),maxLookahead:t.maxLookahead,tokenTypes:Object(i.values)(t.tokensMap),ignoredIssues:t.ignoredIssues,errMsgProvider:u.defaultGrammarValidatorErrorProvider,grammarName:n});t.definitionErrors.push.apply(t.definitionErrors,e)}})),Object(i.isEmpty)(t.definitionErrors)&&(t.recoveryEnabled&&t.TRACE_INIT("computeAllProdsFollows",(function(){var e=Object(a.computeAllProdsFollows)(Object(i.values)(t.gastProductionsCache));t.resyncFollows=e})),t.TRACE_INIT("ComputeLookaheadFunctions",(function(){t.preComputeLookaheadFunctions(Object(i.values)(t.gastProductionsCache))}))),t.TRACE_INIT("expandAllNestedRuleNames",(function(){var e=Object(s.expandAllNestedRuleNames)(Object(i.values)(t.gastProductionsCache),t.fullRuleNameToShort);t.allRuleNames=e.allRuleNames})),!e.DEFER_DEFINITION_ERRORS_HANDLING&&!Object(i.isEmpty)(t.definitionErrors))throw r=Object(i.map)(t.definitionErrors,(function(e){return e.message})),new Error("Parser Definition Errors detected:\n "+r.join("\n-------------------------------\n"))}))},e.DEFER_DEFINITION_ERRORS_HANDLING=!1,e}();Object(i.applyMixins)(w,[l.Recoverable,h.LooksAhead,p.TreeBuilder,f.LexerAdapter,m.RecognizerEngine,d.RecognizerApi,y.ErrorHandler,g.ContentAssist,v.GastRecorder,E.PerformanceTracer]);var C=function(e){function t(t,r){void 0===r&&(r=A);var n=Object(i.cloneObj)(r);return n.outputCst=!0,e.call(this,t,n)||this}return T(t,e),t}(w),O=function(e){function t(t,r){void 0===r&&(r=A);var n=Object(i.cloneObj)(r);return n.outputCst=!1,e.call(this,t,n)||this}return T(t,e),t}(w)},function(e,t,r){"use strict";function n(e){return e&&0===e.length}function i(e){return null==e?[]:Object.keys(e)}function a(e){for(var t=[],r=Object.keys(e),n=0;n<r.length;n++)t.push(e[r[n]]);return t}function o(e,t){for(var r=[],n=i(e),a=0;a<n.length;a++){var o=n[a];r.push(t.call(null,e[o],o))}return r}function s(e,t){for(var r=[],n=0;n<e.length;n++)r.push(t.call(null,e[n],n));return r}function u(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];Array.isArray(n)?t=t.concat(u(n)):t.push(n)}return t}function c(e){return n(e)?void 0:e[0]}function l(e){var t=e&&e.length;return t?e[t-1]:void 0}function h(e,t){if(Array.isArray(e))for(var r=0;r<e.length;r++)t.call(null,e[r],r);else{if(!M(e))throw Error("non exhaustive match");var n=i(e);for(r=0;r<n.length;r++){var a=n[r],o=e[a];t.call(null,o,a)}}}function p(e){return"string"==typeof e}function f(e){return void 0===e}function m(e){return e instanceof Function}function y(e,t){return void 0===t&&(t=1),e.slice(t,e.length)}function g(e,t){return void 0===t&&(t=1),e.slice(0,e.length-t)}function v(e,t){var r=[];if(Array.isArray(e))for(var n=0;n<e.length;n++){var i=e[n];t.call(null,i)&&r.push(i)}return r}function E(e,t){return v(e,(function(e){return!t(e)}))}function T(e,t){for(var r=Object.keys(e),n={},i=0;i<r.length;i++){var a=r[i],o=e[a];t(o)&&(n[a]=o)}return n}function b(e,t){return!!M(e)&&e.hasOwnProperty(t)}function x(e,t){return void 0!==R(e,(function(e){return e===t}))}function A(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r]);return t}function S(e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}function R(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(t.call(null,n))return n}}function w(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n];t.call(null,i)&&r.push(i)}return r}function C(e,t,r){for(var n=Array.isArray(e),o=n?e:a(e),s=n?[]:i(e),u=r,c=0;c<o.length;c++)u=t.call(null,u,o[c],n?c:s[c]);return u}function O(e){return E(e,(function(e){return null==e}))}function k(e,t){void 0===t&&(t=function(e){return e});var r=[];return C(e,(function(e,n){var i=t(n);return x(r,i)?e:(r.push(i),e.concat(n))}),[])}function N(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=[null],i=n.concat(t);return Function.bind.apply(e,i)}function _(e){return Array.isArray(e)}function I(e){return e instanceof RegExp}function M(e){return e instanceof Object}function P(e,t){for(var r=0;r<e.length;r++)if(!t(e[r],r))return!1;return!0}function L(e,t){return E(e,(function(e){return x(t,e)}))}function F(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return!0;return!1}function D(e,t){for(var r=0;r<e.length;r++)if(e[r]===t)return r;return-1}function U(e,t){var r=A(e);return r.sort((function(e,r){return t(e)-t(r)})),r}function V(e,t){if(e.length!==t.length)throw Error("can't zipObject with different number of keys and values!");for(var r={},n=0;n<e.length;n++)r[e[n]]=t[n];return r}function j(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0;n<t.length;n++)for(var a=t[n],o=i(a),s=0;s<o.length;s++){var u=o[s];e[u]=a[u]}return e}function G(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0;n<t.length;n++){var a=t[n];if(!f(a))for(var o=i(a),s=0;s<o.length;s++){var u=o[s];b(e,u)||(e[u]=a[u])}}return e}function B(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return G.apply(null,[{}].concat(e))}function z(e,t){var r={};return h(e,(function(e){var n=t(e),i=r[n];i?i.push(e):r[n]=[e]})),r}function W(e,t){for(var r=S(e),n=i(t),a=0;a<n.length;a++){var o=n[a],s=t[o];r[o]=s}return r}function K(){}function H(e){return e}function X(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];t.push(void 0!==n?n:void 0)}return t}function Y(e){console&&console.error&&console.error("Error: "+e)}function q(e){console&&console.warn&&console.warn("Warning: "+e)}function $(){return"function"==typeof Map}function Q(e,t){t.forEach((function(t){var r=t.prototype;Object.getOwnPropertyNames(r).forEach((function(n){if("constructor"!==n){var i=Object.getOwnPropertyDescriptor(r,n);i&&(i.get||i.set)?Object.defineProperty(e.prototype,n,i):e.prototype[n]=t.prototype[n]}}))}))}function Z(e){function t(){}t.prototype=e;var r=new t;function n(){return d(r.bar)}return n(),n(),e}function J(e){return e[e.length-1]}function ee(e){var t=(new Date).getTime(),r=e();return{time:(new Date).getTime()-t,value:r}}r.r(t),r.d(t,"isEmpty",(function(){return n})),r.d(t,"keys",(function(){return i})),r.d(t,"values",(function(){return a})),r.d(t,"mapValues",(function(){return o})),r.d(t,"map",(function(){return s})),r.d(t,"flatten",(function(){return u})),r.d(t,"first",(function(){return c})),r.d(t,"last",(function(){return l})),r.d(t,"forEach",(function(){return h})),r.d(t,"isString",(function(){return p})),r.d(t,"isUndefined",(function(){return f})),r.d(t,"isFunction",(function(){return m})),r.d(t,"drop",(function(){return y})),r.d(t,"dropRight",(function(){return g})),r.d(t,"filter",(function(){return v})),r.d(t,"reject",(function(){return E})),r.d(t,"pick",(function(){return T})),r.d(t,"has",(function(){return b})),r.d(t,"contains",(function(){return x})),r.d(t,"cloneArr",(function(){return A})),r.d(t,"cloneObj",(function(){return S})),r.d(t,"find",(function(){return R})),r.d(t,"findAll",(function(){return w})),r.d(t,"reduce",(function(){return C})),r.d(t,"compact",(function(){return O})),r.d(t,"uniq",(function(){return k})),r.d(t,"partial",(function(){return N})),r.d(t,"isArray",(function(){return _})),r.d(t,"isRegExp",(function(){return I})),r.d(t,"isObject",(function(){return M})),r.d(t,"every",(function(){return P})),r.d(t,"difference",(function(){return L})),r.d(t,"some",(function(){return F})),r.d(t,"indexOf",(function(){return D})),r.d(t,"sortBy",(function(){return U})),r.d(t,"zipObject",(function(){return V})),r.d(t,"assign",(function(){return j})),r.d(t,"assignNoOverwrite",(function(){return G})),r.d(t,"defaults",(function(){return B})),r.d(t,"groupBy",(function(){return z})),r.d(t,"merge",(function(){return W})),r.d(t,"NOOP",(function(){return K})),r.d(t,"IDENTITY",(function(){return H})),r.d(t,"packArray",(function(){return X})),r.d(t,"PRINT_ERROR",(function(){return Y})),r.d(t,"PRINT_WARNING",(function(){return q})),r.d(t,"isES2015MapSupported",(function(){return $})),r.d(t,"applyMixins",(function(){return Q})),r.d(t,"toFastProperties",(function(){return Z})),r.d(t,"peek",(function(){return J})),r.d(t,"timer",(function(){return ee}))},function(e,t,r){"use strict";r.r(t),r.d(t,"ResyncFollowsWalker",(function(){return l})),r.d(t,"computeAllProdsFollows",(function(){return h})),r.d(t,"buildBetweenProdsFollowPrefix",(function(){return p})),r.d(t,"buildInProdFollowPrefix",(function(){return f}));var n,i=r(160),a=r(170),o=r(158),s=r(173),u=r(161),c=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),l=function(e){function t(t){var r=e.call(this)||this;return r.topProd=t,r.follows={},r}return c(t,e),t.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},t.prototype.walkTerminal=function(e,t,r){},t.prototype.walkProdRef=function(e,t,r){var n=p(e.referencedRule,e.idx)+this.topProd.name,i=t.concat(r),o=new u.Flat({definition:i}),s=Object(a.first)(o);this.follows[n]=s},t}(i.RestWalker);function h(e){var t={};return Object(o.forEach)(e,(function(e){var r=new l(e).startWalking();Object(o.assign)(t,r)})),t}function p(e,t){return e.name+t+s.IN}function f(e){return e.terminalType.name+e.idx+s.IN}},function(e,t,r){"use strict";r.r(t),r.d(t,"RestWalker",(function(){return a}));var n=r(158),i=r(161),a=function(){function e(){}return e.prototype.walk=function(e,t){var r=this;void 0===t&&(t=[]),Object(n.forEach)(e.definition,(function(a,o){var s=Object(n.drop)(e.definition,o+1);if(a instanceof i.NonTerminal)r.walkProdRef(a,s,t);else if(a instanceof i.Terminal)r.walkTerminal(a,s,t);else if(a instanceof i.Flat)r.walkFlat(a,s,t);else if(a instanceof i.Option)r.walkOption(a,s,t);else if(a instanceof i.RepetitionMandatory)r.walkAtLeastOne(a,s,t);else if(a instanceof i.RepetitionMandatoryWithSeparator)r.walkAtLeastOneSep(a,s,t);else if(a instanceof i.RepetitionWithSeparator)r.walkManySep(a,s,t);else if(a instanceof i.Repetition)r.walkMany(a,s,t);else{if(!(a instanceof i.Alternation))throw Error("non exhaustive match");r.walkOr(a,s,t)}}))},e.prototype.walkTerminal=function(e,t,r){},e.prototype.walkProdRef=function(e,t,r){},e.prototype.walkFlat=function(e,t,r){var n=t.concat(r);this.walk(e,n)},e.prototype.walkOption=function(e,t,r){var n=t.concat(r);this.walk(e,n)},e.prototype.walkAtLeastOne=function(e,t,r){var n=[new i.Option({definition:e.definition})].concat(t,r);this.walk(e,n)},e.prototype.walkAtLeastOneSep=function(e,t,r){var n=o(e,t,r);this.walk(e,n)},e.prototype.walkMany=function(e,t,r){var n=[new i.Option({definition:e.definition})].concat(t,r);this.walk(e,n)},e.prototype.walkManySep=function(e,t,r){var n=o(e,t,r);this.walk(e,n)},e.prototype.walkOr=function(e,t,r){var a=this,o=t.concat(r);Object(n.forEach)(e.definition,(function(e){var t=new i.Flat({definition:[e]});a.walk(t,o)}))},e}();function o(e,t,r){return[new i.Option({definition:[new i.Terminal({terminalType:e.separator})].concat(e.definition)})].concat(t,r)}},function(e,t,r){"use strict";r.r(t),r.d(t,"AbstractProduction",(function(){return s})),r.d(t,"NonTerminal",(function(){return u})),r.d(t,"Rule",(function(){return c})),r.d(t,"Flat",(function(){return l})),r.d(t,"Option",(function(){return h})),r.d(t,"RepetitionMandatory",(function(){return p})),r.d(t,"RepetitionMandatoryWithSeparator",(function(){return f})),r.d(t,"Repetition",(function(){return d})),r.d(t,"RepetitionWithSeparator",(function(){return m})),r.d(t,"Alternation",(function(){return y})),r.d(t,"Terminal",(function(){return g})),r.d(t,"serializeGrammar",(function(){return v})),r.d(t,"serializeProduction",(function(){return E}));var n,i=r(158),a=r(162),o=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),s=function(){function e(e){this.definition=e}return e.prototype.accept=function(e){e.visit(this),Object(i.forEach)(this.definition,(function(t){t.accept(e)}))},e}(),u=function(e){function t(t){var r=e.call(this,[])||this;return r.idx=1,Object(i.assign)(r,Object(i.pick)(t,(function(e){return void 0!==e}))),r}return o(t,e),Object.defineProperty(t.prototype,"definition",{get:function(){return void 0!==this.referencedRule?this.referencedRule.definition:[]},set:function(e){},enumerable:!0,configurable:!0}),t.prototype.accept=function(e){e.visit(this)},t}(s),c=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.orgText="",Object(i.assign)(r,Object(i.pick)(t,(function(e){return void 0!==e}))),r}return o(t,e),t}(s),l=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.ignoreAmbiguities=!1,Object(i.assign)(r,Object(i.pick)(t,(function(e){return void 0!==e}))),r}return o(t,e),t}(s),h=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,Object(i.assign)(r,Object(i.pick)(t,(function(e){return void 0!==e}))),r}return o(t,e),t}(s),p=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,Object(i.assign)(r,Object(i.pick)(t,(function(e){return void 0!==e}))),r}return o(t,e),t}(s),f=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,Object(i.assign)(r,Object(i.pick)(t,(function(e){return void 0!==e}))),r}return o(t,e),t}(s),d=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,Object(i.assign)(r,Object(i.pick)(t,(function(e){return void 0!==e}))),r}return o(t,e),t}(s),m=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,Object(i.assign)(r,Object(i.pick)(t,(function(e){return void 0!==e}))),r}return o(t,e),t}(s),y=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,r.ignoreAmbiguities=!1,r.hasPredicates=!1,Object(i.assign)(r,Object(i.pick)(t,(function(e){return void 0!==e}))),r}return o(t,e),t}(s),g=function(){function e(e){this.idx=1,Object(i.assign)(this,Object(i.pick)(e,(function(e){return void 0!==e})))}return e.prototype.accept=function(e){e.visit(this)},e}();function v(e){return Object(i.map)(e,E)}function E(e){function t(e){return Object(i.map)(e,E)}if(e instanceof u)return{type:"NonTerminal",name:e.nonTerminalName,idx:e.idx};if(e instanceof l)return{type:"Flat",definition:t(e.definition)};if(e instanceof h)return{type:"Option",idx:e.idx,definition:t(e.definition)};if(e instanceof p)return{type:"RepetitionMandatory",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof f)return{type:"RepetitionMandatoryWithSeparator",name:e.name,idx:e.idx,separator:E(new g({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof m)return{type:"RepetitionWithSeparator",name:e.name,idx:e.idx,separator:E(new g({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof d)return{type:"Repetition",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof y)return{type:"Alternation",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof g){var r={type:"Terminal",name:e.terminalType.name,label:Object(a.tokenLabel)(e.terminalType),idx:e.idx},n=e.terminalType.PATTERN;return e.terminalType.PATTERN&&(r.pattern=Object(i.isRegExp)(n)?n.source:n),r}if(e instanceof c)return{type:"Rule",name:e.name,orgText:e.orgText,definition:t(e.definition)};throw Error("non exhaustive match")}},function(e,t,r){"use strict";r.r(t),r.d(t,"tokenLabel",(function(){return o})),r.d(t,"tokenName",(function(){return s})),r.d(t,"hasTokenLabel",(function(){return u})),r.d(t,"createToken",(function(){return c})),r.d(t,"EOF",(function(){return l})),r.d(t,"createTokenInstance",(function(){return h})),r.d(t,"tokenMatcher",(function(){return p}));var n=r(158),i=r(163),a=r(168);function o(e){return u(e)?e.LABEL:e.name}function s(e){return e.name}function u(e){return Object(n.isString)(e.LABEL)&&""!==e.LABEL}function c(e){return function(e){var t=e.pattern,r={};if(r.name=e.name,Object(n.isUndefined)(t)||(r.PATTERN=t),Object(n.has)(e,"parent"))throw"The parent property is no longer supported.\nSee: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.";return Object(n.has)(e,"categories")&&(r.CATEGORIES=e.categories),Object(a.augmentTokenTypes)([r]),Object(n.has)(e,"label")&&(r.LABEL=e.label),Object(n.has)(e,"group")&&(r.GROUP=e.group),Object(n.has)(e,"pop_mode")&&(r.POP_MODE=e.pop_mode),Object(n.has)(e,"push_mode")&&(r.PUSH_MODE=e.push_mode),Object(n.has)(e,"longer_alt")&&(r.LONGER_ALT=e.longer_alt),Object(n.has)(e,"line_breaks")&&(r.LINE_BREAKS=e.line_breaks),Object(n.has)(e,"start_chars_hint")&&(r.START_CHARS_HINT=e.start_chars_hint),r}(e)}var l=c({name:"EOF",pattern:i.Lexer.NA});function h(e,t,r,n,i,a,o,s){return{image:t,startOffset:r,endOffset:n,startLine:i,endLine:a,startColumn:o,endColumn:s,tokenTypeIdx:e.tokenTypeIdx,tokenType:e}}function p(e,t){return Object(a.tokenStructuredMatcher)(e,t)}Object(a.augmentTokenTypes)([l])},function(e,t,r){"use strict";r.r(t),r.d(t,"LexerDefinitionErrorType",(function(){return n})),r.d(t,"Lexer",(function(){return l}));var n,i=r(164),a=r(158),o=r(168),s=r(169),u=r(167);!function(e){e[e.MISSING_PATTERN=0]="MISSING_PATTERN",e[e.INVALID_PATTERN=1]="INVALID_PATTERN",e[e.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",e[e.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",e[e.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",e[e.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",e[e.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",e[e.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",e[e.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",e[e.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",e[e.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",e[e.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",e[e.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",e[e.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",e[e.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",e[e.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",e[e.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"}(n||(n={}));var c={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:["\n","\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:s.defaultLexerErrorProvider,traceInitPerf:!1,skipValidations:!1};Object.freeze(c);var l=function(){function e(e,t){var r=this;if(void 0===t&&(t=c),this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},"boolean"==typeof t)throw Error("The second argument to the Lexer constructor is now an ILexerConfig Object.\na boolean 2nd argument is no longer supported");this.config=Object(a.merge)(c,t);var n=this.config.traceInitPerf;!0===n?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):"number"==typeof n&&(this.traceInitMaxIdent=n,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",(function(){var n,s=!0;r.TRACE_INIT("Lexer Config handling",(function(){if(r.config.lineTerminatorsPattern===c.lineTerminatorsPattern)r.config.lineTerminatorsPattern=i.LineTerminatorOptimizedTester;else if(r.config.lineTerminatorCharacters===c.lineTerminatorCharacters)throw Error("Error: Missing <lineTerminatorCharacters> property on the Lexer config.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS");if(t.safeMode&&t.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');r.trackStartLines=/full|onlyStart/i.test(r.config.positionTracking),r.trackEndLines=/full/i.test(r.config.positionTracking),Object(a.isArray)(e)?((n={modes:{}}).modes[i.DEFAULT_MODE]=Object(a.cloneArr)(e),n[i.DEFAULT_MODE]=i.DEFAULT_MODE):(s=!1,n=Object(a.cloneObj)(e))})),!1===r.config.skipValidations&&(r.TRACE_INIT("performRuntimeChecks",(function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(Object(i.performRuntimeChecks)(n,r.trackStartLines,r.config.lineTerminatorCharacters))})),r.TRACE_INIT("performWarningRuntimeChecks",(function(){r.lexerDefinitionWarning=r.lexerDefinitionWarning.concat(Object(i.performWarningRuntimeChecks)(n,r.trackStartLines,r.config.lineTerminatorCharacters))}))),n.modes=n.modes?n.modes:{},Object(a.forEach)(n.modes,(function(e,t){n.modes[t]=Object(a.reject)(e,(function(e){return Object(a.isUndefined)(e)}))}));var l=Object(a.keys)(n.modes);if(Object(a.forEach)(n.modes,(function(e,n){r.TRACE_INIT("Mode: <"+n+"> processing",(function(){var s;r.modes.push(n),!1===r.config.skipValidations&&r.TRACE_INIT("validatePatterns",(function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(Object(i.validatePatterns)(e,l))})),Object(a.isEmpty)(r.lexerDefinitionErrors)&&(Object(o.augmentTokenTypes)(e),r.TRACE_INIT("analyzeTokenTypes",(function(){s=Object(i.analyzeTokenTypes)(e,{lineTerminatorCharacters:r.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode,tracer:r.TRACE_INIT.bind(r)})})),r.patternIdxToConfig[n]=s.patternIdxToConfig,r.charCodeToPatternIdxToConfig[n]=s.charCodeToPatternIdxToConfig,r.emptyGroups=Object(a.merge)(r.emptyGroups,s.emptyGroups),r.hasCustom=s.hasCustom||r.hasCustom,r.canModeBeOptimized[n]=s.canBeOptimized)}))})),r.defaultMode=n.defaultMode,!Object(a.isEmpty)(r.lexerDefinitionErrors)&&!r.config.deferDefinitionErrorsHandling){var h=Object(a.map)(r.lexerDefinitionErrors,(function(e){return e.message})).join("-----------------------\n");throw new Error("Errors detected in definition of Lexer:\n"+h)}Object(a.forEach)(r.lexerDefinitionWarning,(function(e){Object(a.PRINT_WARNING)(e.message)})),r.TRACE_INIT("Choosing sub-methods implementations",(function(){if(i.SUPPORT_STICKY?(r.chopInput=a.IDENTITY,r.match=r.matchWithTest):(r.updateLastIndex=a.NOOP,r.match=r.matchWithExec),s&&(r.handleModes=a.NOOP),!1===r.trackStartLines&&(r.computeNewColumn=a.IDENTITY),!1===r.trackEndLines&&(r.updateTokenEndLineColumnLocation=a.NOOP),/full/i.test(r.config.positionTracking))r.createTokenInstance=r.createFullToken;else if(/onlyStart/i.test(r.config.positionTracking))r.createTokenInstance=r.createStartOnlyToken;else{if(!/onlyOffset/i.test(r.config.positionTracking))throw Error('Invalid <positionTracking> config option: "'+r.config.positionTracking+'"');r.createTokenInstance=r.createOffsetOnlyToken}r.hasCustom?(r.addToken=r.addTokenUsingPush,r.handlePayload=r.handlePayloadWithCustom):(r.addToken=r.addTokenUsingMemberAccess,r.handlePayload=r.handlePayloadNoCustom)})),r.TRACE_INIT("Failed Optimization Warnings",(function(){var e=Object(a.reduce)(r.canModeBeOptimized,(function(e,t,r){return!1===t&&e.push(r),e}),[]);if(t.ensureOptimizations&&!Object(a.isEmpty)(e))throw Error("Lexer Modes: < "+e.join(", ")+' > cannot be optimized.\n\t Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.\n\t Or inspect the console log for details on how to resolve these issues.')})),r.TRACE_INIT("clearRegExpParserCache",(function(){Object(u.clearRegExpParserCache)()})),r.TRACE_INIT("toFastProperties",(function(){Object(a.toFastProperties)(r)}))}))}return e.prototype.tokenize=function(e,t){if(void 0===t&&(t=this.defaultMode),!Object(a.isEmpty)(this.lexerDefinitionErrors)){var r=Object(a.map)(this.lexerDefinitionErrors,(function(e){return e.message})).join("-----------------------\n");throw new Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+r)}return this.tokenizeInternal(e,t)},e.prototype.tokenizeInternal=function(e,t){var r,n,o,s,u,c,l,h,p,f,d,m,y,g,v=this,E=e,T=E.length,b=0,x=0,A=this.hasCustom?0:Math.floor(e.length/10),S=new Array(A),R=[],w=this.trackStartLines?1:void 0,C=this.trackStartLines?1:void 0,O=Object(i.cloneEmptyGroups)(this.emptyGroups),k=this.trackStartLines,N=this.config.lineTerminatorsPattern,_=0,I=[],M=[],P=[],L=[];Object.freeze(L);var F=void 0;function D(){return I}function U(e){var t=Object(i.charCodeToOptimizedIndex)(e),r=M[t];return void 0===r?L:r}var V,j=function(e){if(1===P.length&&void 0===e.tokenType.PUSH_MODE){var t=v.config.errorMessageProvider.buildUnableToPopLexerModeMessage(e);R.push({offset:e.startOffset,line:void 0!==e.startLine?e.startLine:void 0,column:void 0!==e.startColumn?e.startColumn:void 0,length:e.image.length,message:t})}else{P.pop();var r=Object(a.last)(P);I=v.patternIdxToConfig[r],M=v.charCodeToPatternIdxToConfig[r],_=I.length;var n=v.canModeBeOptimized[r]&&!1===v.config.safeMode;F=M&&n?U:D}};function G(e){P.push(e),M=this.charCodeToPatternIdxToConfig[e],I=this.patternIdxToConfig[e],_=I.length,_=I.length;var t=this.canModeBeOptimized[e]&&!1===this.config.safeMode;F=M&&t?U:D}for(G.call(this,t);b<T;){u=null;var B=E.charCodeAt(b),z=F(B),W=z.length;for(r=0;r<W;r++){var K=(V=z[r]).pattern;if(c=null,!1!==(te=V.short)?B===te&&(u=K):!0===V.isCustom?null!==(g=K.exec(E,b,S,O))?(u=g[0],void 0!==g.payload&&(c=g.payload)):u=null:(this.updateLastIndex(K,b),u=this.match(K,e,b)),null!==u){if(void 0!==(s=V.longerAlt)){var H=I[s],X=H.pattern;l=null,!0===H.isCustom?null!==(g=X.exec(E,b,S,O))?(o=g[0],void 0!==g.payload&&(l=g.payload)):o=null:(this.updateLastIndex(X,b),o=this.match(X,e,b)),o&&o.length>u.length&&(u=o,c=l,V=H)}break}}if(null!==u){if(h=u.length,void 0!==(p=V.group)&&(f=V.tokenTypeIdx,d=this.createTokenInstance(u,b,f,V.tokenType,w,C,h),this.handlePayload(d,c),!1===p?x=this.addToken(S,x,d):O[p].push(d)),e=this.chopInput(e,h),b+=h,C=this.computeNewColumn(C,h),!0===k&&!0===V.canLineTerminator){var Y=0,q=void 0,$=void 0;N.lastIndex=0;do{!0===(q=N.test(u))&&($=N.lastIndex-1,Y++)}while(!0===q);0!==Y&&(w+=Y,C=h-$,this.updateTokenEndLineColumnLocation(d,p,$,Y,w,C,h))}this.handleModes(V,j,G,d)}else{for(var Q=b,Z=w,J=C,ee=!1;!ee&&b<T;)for(E.charCodeAt(b),e=this.chopInput(e,1),b++,n=0;n<_;n++){var te,re=I[n];if(K=re.pattern,!1!==(te=re.short)?E.charCodeAt(b)===te&&(ee=!0):!0===re.isCustom?ee=null!==K.exec(E,b,S,O):(this.updateLastIndex(K,b),ee=null!==K.exec(e)),!0===ee)break}m=b-Q,y=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(E,Q,m,Z,J),R.push({offset:Q,line:Z,column:J,length:m,message:y})}}return this.hasCustom||(S.length=x),{tokens:S,groups:O,errors:R}},e.prototype.handleModes=function(e,t,r,n){if(!0===e.pop){var i=e.push;t(n),void 0!==i&&r.call(this,i)}else void 0!==e.push&&r.call(this,e.push)},e.prototype.chopInput=function(e,t){return e.substring(t)},e.prototype.updateLastIndex=function(e,t){e.lastIndex=t},e.prototype.updateTokenEndLineColumnLocation=function(e,t,r,n,i,a,o){var s,u;void 0!==t&&(u=(s=r===o-1)?-1:0,1===n&&!0===s||(e.endLine=i+u,e.endColumn=a-1-u))},e.prototype.computeNewColumn=function(e,t){return e+t},e.prototype.createTokenInstance=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return null},e.prototype.createOffsetOnlyToken=function(e,t,r,n){return{image:e,startOffset:t,tokenTypeIdx:r,tokenType:n}},e.prototype.createStartOnlyToken=function(e,t,r,n,i,a){return{image:e,startOffset:t,startLine:i,startColumn:a,tokenTypeIdx:r,tokenType:n}},e.prototype.createFullToken=function(e,t,r,n,i,a,o){return{image:e,startOffset:t,endOffset:t+o-1,startLine:i,endLine:i,startColumn:a,endColumn:a+o-1,tokenTypeIdx:r,tokenType:n}},e.prototype.addToken=function(e,t,r){return 666},e.prototype.addTokenUsingPush=function(e,t,r){return e.push(r),t},e.prototype.addTokenUsingMemberAccess=function(e,t,r){return e[t]=r,++t},e.prototype.handlePayload=function(e,t){},e.prototype.handlePayloadNoCustom=function(e,t){},e.prototype.handlePayloadWithCustom=function(e,t){null!==t&&(e.payload=t)},e.prototype.match=function(e,t,r){return null},e.prototype.matchWithTest=function(e,t,r){return!0===e.test(t)?t.substring(r,e.lastIndex):null},e.prototype.matchWithExec=function(e,t){var r=e.exec(t);return null!==r?r[0]:r},e.prototype.TRACE_INIT=function(e,t){if(!0===this.traceInitPerf){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--\x3e <"+e+">");var n=Object(a.timer)(t),i=n.time,o=n.value,s=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&s(r+"<-- <"+e+"> time: "+i+"ms"),this.traceInitIndent--,o}return t()},e.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",e.NA=/NOT_APPLICABLE/,e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"DEFAULT_MODE",(function(){return h})),r.d(t,"MODES",(function(){return p})),r.d(t,"SUPPORT_STICKY",(function(){return f})),r.d(t,"disableSticky",(function(){return d})),r.d(t,"enableSticky",(function(){return m})),r.d(t,"analyzeTokenTypes",(function(){return y})),r.d(t,"validatePatterns",(function(){return g})),r.d(t,"findMissingPatterns",(function(){return v})),r.d(t,"findInvalidPatterns",(function(){return E})),r.d(t,"findEndOfInputAnchor",(function(){return b})),r.d(t,"findEmptyMatchRegExps",(function(){return x})),r.d(t,"findStartOfInputAnchor",(function(){return S})),r.d(t,"findUnsupportedFlags",(function(){return R})),r.d(t,"findDuplicatePatterns",(function(){return w})),r.d(t,"findInvalidGroupType",(function(){return C})),r.d(t,"findModesThatDoNotExist",(function(){return O})),r.d(t,"findUnreachablePatterns",(function(){return k})),r.d(t,"addStartOfInput",(function(){return N})),r.d(t,"addStickyFlag",(function(){return _})),r.d(t,"performRuntimeChecks",(function(){return I})),r.d(t,"performWarningRuntimeChecks",(function(){return M})),r.d(t,"cloneEmptyGroups",(function(){return P})),r.d(t,"isCustomPattern",(function(){return L})),r.d(t,"isShortPattern",(function(){return F})),r.d(t,"LineTerminatorOptimizedTester",(function(){return D})),r.d(t,"buildLineBreakIssueMessage",(function(){return V})),r.d(t,"minOptimizationVal",(function(){return B})),r.d(t,"charCodeToOptimizedIndex",(function(){return z}));var n,i=r(165),a=r(163),o=r(158),s=r(166),u=r(167),c=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),l="PATTERN",h="defaultMode",p="modes",f="boolean"==typeof new RegExp("(?:)").sticky;function d(){f=!1}function m(){f=!0}function y(e,t){var r,n=(t=Object(o.defaults)(t,{useSticky:f,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r","\n"],tracer:function(e,t){return t()}})).tracer;n("initCharCodeToOptimizedIndexMap",(function(){!function(){if(Object(o.isEmpty)(W)){W=new Array(65536);for(var e=0;e<65536;e++)W[e]=e>255?255+~~(e/255):e}}()})),n("Reject Lexer.NA",(function(){r=Object(o.reject)(e,(function(e){return e[l]===a.Lexer.NA}))}));var i,u,c,h,p,d,m,y,g,v,E,T=!1;n("Transform Patterns",(function(){T=!1,i=Object(o.map)(r,(function(e){var r=e[l];if(Object(o.isRegExp)(r)){var n=r.source;return 1===n.length&&"^"!==n&&"$"!==n&&"."!==n?n:2!==n.length||"\\"!==n[0]||Object(o.contains)(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],n[1])?t.useSticky?_(r):N(r):n[1]}if(Object(o.isFunction)(r))return T=!0,{exec:r};if(Object(o.has)(r,"exec"))return T=!0,r;if("string"==typeof r){if(1===r.length)return r;var i=r.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),a=new RegExp(i);return t.useSticky?_(a):N(a)}throw Error("non exhaustive match")}))})),n("misc mapping",(function(){u=Object(o.map)(r,(function(e){return e.tokenTypeIdx})),c=Object(o.map)(r,(function(e){var t=e.GROUP;if(t!==a.Lexer.SKIPPED){if(Object(o.isString)(t))return t;if(Object(o.isUndefined)(t))return!1;throw Error("non exhaustive match")}})),h=Object(o.map)(r,(function(e){var t=e.LONGER_ALT;if(t)return Object(o.indexOf)(r,t)})),p=Object(o.map)(r,(function(e){return e.PUSH_MODE})),d=Object(o.map)(r,(function(e){return Object(o.has)(e,"POP_MODE")}))})),n("Line Terminator Handling",(function(){var e=j(t.lineTerminatorCharacters);m=Object(o.map)(r,(function(e){return!1})),"onlyOffset"!==t.positionTracking&&(m=Object(o.map)(r,(function(t){return Object(o.has)(t,"LINE_BREAKS")?t.LINE_BREAKS:!1===U(t,e)?Object(s.canMatchCharCode)(e,t.PATTERN):void 0})))})),n("Misc Mapping #2",(function(){y=Object(o.map)(r,L),g=Object(o.map)(i,F),v=Object(o.reduce)(r,(function(e,t){var r=t.GROUP;return Object(o.isString)(r)&&r!==a.Lexer.SKIPPED&&(e[r]=[]),e}),{}),E=Object(o.map)(i,(function(e,t){return{pattern:i[t],longerAlt:h[t],canLineTerminator:m[t],isCustom:y[t],short:g[t],group:c[t],push:p[t],pop:d[t],tokenTypeIdx:u[t],tokenType:r[t]}}))}));var b=!0,x=[];return t.safeMode||n("First Char Optimization",(function(){x=Object(o.reduce)(r,(function(e,r,n){if("string"==typeof r.PATTERN){var i=z(r.PATTERN.charCodeAt(0));G(e,i,E[n])}else if(Object(o.isArray)(r.START_CHARS_HINT)){var a;Object(o.forEach)(r.START_CHARS_HINT,(function(t){var r=z("string"==typeof t?t.charCodeAt(0):t);a!==r&&(a=r,G(e,r,E[n]))}))}else if(Object(o.isRegExp)(r.PATTERN))if(r.PATTERN.unicode)b=!1,t.ensureOptimizations&&Object(o.PRINT_ERROR)(s.failedOptimizationPrefixMsg+"\tUnable to analyze < "+r.PATTERN.toString()+" > pattern.\n\tThe regexp unicode flag is not currently supported by the regexp-to-ast library.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE");else{var u=Object(s.getOptimizedStartCodesIndices)(r.PATTERN,t.ensureOptimizations);Object(o.isEmpty)(u)&&(b=!1),Object(o.forEach)(u,(function(t){G(e,t,E[n])}))}else t.ensureOptimizations&&Object(o.PRINT_ERROR)(s.failedOptimizationPrefixMsg+"\tTokenType: <"+r.name+"> is using a custom token pattern without providing <start_chars_hint> parameter.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE"),b=!1;return e}),[])})),n("ArrayPacking",(function(){x=Object(o.packArray)(x)})),{emptyGroups:v,patternIdxToConfig:E,charCodeToPatternIdxToConfig:x,hasCustom:T,canBeOptimized:b}}function g(e,t){var r=[],n=v(e);r=r.concat(n.errors);var i=E(n.valid),a=i.valid;return r=(r=(r=(r=(r=r.concat(i.errors)).concat(function(e){var t=[],r=Object(o.filter)(e,(function(e){return Object(o.isRegExp)(e[l])}));return t=(t=(t=(t=(t=t.concat(b(r))).concat(S(r))).concat(R(r))).concat(w(r))).concat(x(r))}(a))).concat(C(a))).concat(O(a,t))).concat(k(a))}function v(e){var t=Object(o.filter)(e,(function(e){return!Object(o.has)(e,l)}));return{errors:Object(o.map)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- missing static 'PATTERN' property",type:a.LexerDefinitionErrorType.MISSING_PATTERN,tokenTypes:[e]}})),valid:Object(o.difference)(e,t)}}function E(e){var t=Object(o.filter)(e,(function(e){var t=e[l];return!(Object(o.isRegExp)(t)||Object(o.isFunction)(t)||Object(o.has)(t,"exec")||Object(o.isString)(t))}));return{errors:Object(o.map)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:a.LexerDefinitionErrorType.INVALID_PATTERN,tokenTypes:[e]}})),valid:Object(o.difference)(e,t)}}var T=/[^\\][\$]/;function b(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.found=!1,t}return c(t,e),t.prototype.visitEndAnchor=function(e){this.found=!0},t}(i.BaseRegExpVisitor),r=Object(o.filter)(e,(function(e){var r=e[l];try{var n=Object(u.getRegExpAst)(r),i=new t;return i.visit(n),i.found}catch(e){return T.test(r.source)}}));return Object(o.map)(r,(function(e){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain end of input anchor '$'\n\tSee sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:a.LexerDefinitionErrorType.EOI_ANCHOR_FOUND,tokenTypes:[e]}}))}function x(e){var t=Object(o.filter)(e,(function(e){return e[l].test("")}));return Object(o.map)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' must not match an empty string",type:a.LexerDefinitionErrorType.EMPTY_MATCH_PATTERN,tokenTypes:[e]}}))}var A=/[^\\[][\^]|^\^/;function S(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.found=!1,t}return c(t,e),t.prototype.visitStartAnchor=function(e){this.found=!0},t}(i.BaseRegExpVisitor),r=Object(o.filter)(e,(function(e){var r=e[l];try{var n=Object(u.getRegExpAst)(r),i=new t;return i.visit(n),i.found}catch(e){return A.test(r.source)}}));return Object(o.map)(r,(function(e){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain start of input anchor '^'\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:a.LexerDefinitionErrorType.SOI_ANCHOR_FOUND,tokenTypes:[e]}}))}function R(e){var t=Object(o.filter)(e,(function(e){var t=e[l];return t instanceof RegExp&&(t.multiline||t.global)}));return Object(o.map)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:a.LexerDefinitionErrorType.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[e]}}))}function w(e){var t=[],r=Object(o.map)(e,(function(r){return Object(o.reduce)(e,(function(e,n){return r.PATTERN.source!==n.PATTERN.source||Object(o.contains)(t,n)||n.PATTERN===a.Lexer.NA||(t.push(n),e.push(n)),e}),[])}));r=Object(o.compact)(r);var n=Object(o.filter)(r,(function(e){return e.length>1}));return Object(o.map)(n,(function(e){var t=Object(o.map)(e,(function(e){return e.name}));return{message:"The same RegExp pattern ->"+Object(o.first)(e).PATTERN+"<-has been used in all of the following Token Types: "+t.join(", ")+" <-",type:a.LexerDefinitionErrorType.DUPLICATE_PATTERNS_FOUND,tokenTypes:e}}))}function C(e){var t=Object(o.filter)(e,(function(e){if(!Object(o.has)(e,"GROUP"))return!1;var t=e.GROUP;return t!==a.Lexer.SKIPPED&&t!==a.Lexer.NA&&!Object(o.isString)(t)}));return Object(o.map)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:a.LexerDefinitionErrorType.INVALID_GROUP_TYPE_FOUND,tokenTypes:[e]}}))}function O(e,t){var r=Object(o.filter)(e,(function(e){return void 0!==e.PUSH_MODE&&!Object(o.contains)(t,e.PUSH_MODE)}));return Object(o.map)(r,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+e.PUSH_MODE+"<-which does not exist",type:a.LexerDefinitionErrorType.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[e]}}))}function k(e){var t=[],r=Object(o.reduce)(e,(function(e,t,r){var n,i=t.PATTERN;return i===a.Lexer.NA||(Object(o.isString)(i)?e.push({str:i,idx:r,tokenType:t}):Object(o.isRegExp)(i)&&(n=i,void 0===Object(o.find)([".","\\","[","]","|","^","$","(",")","?","*","+","{"],(function(e){return-1!==n.source.indexOf(e)})))&&e.push({str:i.source,idx:r,tokenType:t})),e}),[]);return Object(o.forEach)(e,(function(e,n){Object(o.forEach)(r,(function(r){var i=r.str,s=r.idx,u=r.tokenType;if(n<s&&function(e,t){if(Object(o.isRegExp)(t)){var r=t.exec(e);return null!==r&&0===r.index}if(Object(o.isFunction)(t))return t(e,0,[],{});if(Object(o.has)(t,"exec"))return t.exec(e,0,[],{});if("string"==typeof t)return t===e;throw Error("non exhaustive match")}(i,e.PATTERN)){var c="Token: ->"+u.name+"<- can never be matched.\nBecause it appears AFTER the Token Type ->"+e.name+"<-in the lexer's definition.\nSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE";t.push({message:c,type:a.LexerDefinitionErrorType.UNREACHABLE_PATTERN,tokenTypes:[e,u]})}}))})),t}function N(e){var t=e.ignoreCase?"i":"";return new RegExp("^(?:"+e.source+")",t)}function _(e){var t=e.ignoreCase?"iy":"y";return new RegExp(""+e.source,t)}function I(e,t,r){var n=[];return Object(o.has)(e,h)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+h+"> property in its definition\n",type:a.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),Object(o.has)(e,p)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+p+"> property in its definition\n",type:a.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),Object(o.has)(e,p)&&Object(o.has)(e,h)&&!Object(o.has)(e.modes,e.defaultMode)&&n.push({message:"A MultiMode Lexer cannot be initialized with a "+h+": <"+e.defaultMode+">which does not exist\n",type:a.LexerDefinitionErrorType.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),Object(o.has)(e,p)&&Object(o.forEach)(e.modes,(function(e,t){Object(o.forEach)(e,(function(e,r){Object(o.isUndefined)(e)&&n.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:<"+t+"> at index: <"+r+">\n",type:a.LexerDefinitionErrorType.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})}))})),n}function M(e,t,r){var n=[],i=!1,u=Object(o.compact)(Object(o.flatten)(Object(o.mapValues)(e.modes,(function(e){return e})))),c=Object(o.reject)(u,(function(e){return e[l]===a.Lexer.NA})),h=j(r);return t&&Object(o.forEach)(c,(function(e){var t=U(e,h);if(!1!==t){var r={message:V(e,t),type:t.issue,tokenType:e};n.push(r)}else Object(o.has)(e,"LINE_BREAKS")?!0===e.LINE_BREAKS&&(i=!0):Object(s.canMatchCharCode)(h,e.PATTERN)&&(i=!0)})),t&&!i&&n.push({message:"Warning: No LINE_BREAKS Found.\n\tThis Lexer has been defined to track line and column information,\n\tBut none of the Token Types can be identified as matching a line terminator.\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS \n\tfor details.",type:a.LexerDefinitionErrorType.NO_LINE_BREAKS_FLAGS}),n}function P(e){var t={},r=Object(o.keys)(e);return Object(o.forEach)(r,(function(r){var n=e[r];if(!Object(o.isArray)(n))throw Error("non exhaustive match");t[r]=[]})),t}function L(e){var t=e.PATTERN;if(Object(o.isRegExp)(t))return!1;if(Object(o.isFunction)(t))return!0;if(Object(o.has)(t,"exec"))return!0;if(Object(o.isString)(t))return!1;throw Error("non exhaustive match")}function F(e){return!(!Object(o.isString)(e)||1!==e.length)&&e.charCodeAt(0)}var D={test:function(e){for(var t=e.length,r=this.lastIndex;r<t;r++){var n=e.charCodeAt(r);if(10===n)return this.lastIndex=r+1,!0;if(13===n)return 10===e.charCodeAt(r+1)?this.lastIndex=r+2:this.lastIndex=r+1,!0}return!1},lastIndex:0};function U(e,t){if(Object(o.has)(e,"LINE_BREAKS"))return!1;if(Object(o.isRegExp)(e.PATTERN)){try{Object(s.canMatchCharCode)(t,e.PATTERN)}catch(e){return{issue:a.LexerDefinitionErrorType.IDENTIFY_TERMINATOR,errMsg:e.message}}return!1}if(Object(o.isString)(e.PATTERN))return!1;if(L(e))return{issue:a.LexerDefinitionErrorType.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}function V(e,t){if(t.issue===a.LexerDefinitionErrorType.IDENTIFY_TERMINATOR)return"Warning: unable to identify line terminator usage in pattern.\n\tThe problem is in the <"+e.name+"> Token Type\n\t Root cause: "+t.errMsg+".\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(t.issue===a.LexerDefinitionErrorType.CUSTOM_LINE_BREAK)return"Warning: A Custom Token Pattern should specify the <line_breaks> option.\n\tThe problem is in the <"+e.name+"> Token Type\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}function j(e){return Object(o.map)(e,(function(e){return Object(o.isString)(e)&&e.length>0?e.charCodeAt(0):e}))}function G(e,t,r){void 0===e[t]?e[t]=[r]:e[t].push(r)}var B=256;function z(e){return e<B?e:W[e]}var W=[]},function(e,t,r){var n,i,a;"undefined"!=typeof self&&self,i=[],void 0===(a="function"==typeof(n=function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(e){this.idx=e.idx,this.input=e.input,this.groupIdx=e.groupIdx},e.prototype.pattern=function(e){this.idx=0,this.input=e,this.groupIdx=0,this.consumeChar("/");var t=this.disjunction();this.consumeChar("/");for(var r={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":s(r,"global");break;case"i":s(r,"ignoreCase");break;case"m":s(r,"multiLine");break;case"u":s(r,"unicode");break;case"y":s(r,"sticky")}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:r,value:t}},e.prototype.disjunction=function(){var e=[];for(e.push(this.alternative());"|"===this.peekChar();)this.consumeChar("|"),e.push(this.alternative());return{type:"Disjunction",value:e}},e.prototype.alternative=function(){for(var e=[];this.isTerm();)e.push(this.term());return{type:"Alternative",value:e}},e.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},e.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":var e;switch(this.consumeChar("?"),this.popChar()){case"=":e="Lookahead";break;case"!":e="NegativeLookahead"}u(e);var t=this.disjunction();return this.consumeChar(")"),{type:e,value:t}}!function(){throw Error("Internal Error - Should never get here!")}()},e.prototype.quantifier=function(e){var t;switch(this.popChar()){case"*":t={atLeast:0,atMost:1/0};break;case"+":t={atLeast:1,atMost:1/0};break;case"?":t={atLeast:0,atMost:1};break;case"{":var r=this.integerIncludingZero();switch(this.popChar()){case"}":t={atLeast:r,atMost:r};break;case",":t=this.isDigit()?{atLeast:r,atMost:this.integerIncludingZero()}:{atLeast:r,atMost:1/0},this.consumeChar("}")}if(!0===e&&void 0===t)return;u(t)}if(!0!==e||void 0!==t)return u(t),"?"===this.peekChar(0)?(this.consumeChar("?"),t.greedy=!1):t.greedy=!0,t.type="Quantifier",t},e.prototype.atom=function(){var e;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group()}return void 0===e&&this.isPatternCharacter()&&(e=this.patternCharacter()),u(e),this.isQuantifier()&&(e.quantifier=this.quantifier()),e},e.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[a("\n"),a("\r"),a("\u2028"),a("\u2029")]}},e.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){return{type:"GroupBackReference",value:this.positiveInteger()}},e.prototype.characterClassEscape=function(){var e,t=!1;switch(this.popChar()){case"d":e=c;break;case"D":e=c,t=!0;break;case"s":e=h;break;case"S":e=h,t=!0;break;case"w":e=l;break;case"W":e=l,t=!0}return u(e),{type:"Set",value:e,complement:t}},e.prototype.controlEscapeAtom=function(){var e;switch(this.popChar()){case"f":e=a("\f");break;case"n":e=a("\n");break;case"r":e=a("\r");break;case"t":e=a("\t");break;case"v":e=a("\v")}return u(e),{type:"Character",value:e}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var e=this.popChar();if(!1===/[a-zA-Z]/.test(e))throw Error("Invalid ");return{type:"Character",value:e.toUpperCase().charCodeAt(0)-64}},e.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:a("\0")}},e.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){return{type:"Character",value:a(this.popChar())}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case"\n":case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:return{type:"Character",value:a(this.popChar())}}},e.prototype.characterClass=function(){var e=[],t=!1;for(this.consumeChar("["),"^"===this.peekChar(0)&&(this.consumeChar("^"),t=!0);this.isClassAtom();){var r=this.classAtom();if("Character"===r.type&&this.isRangeDash()){this.consumeChar("-");var n=this.classAtom();if("Character"===n.type){if(n.value<r.value)throw Error("Range out of order in character class");e.push({from:r.value,to:n.value})}else o(r.value,e),e.push(a("-")),o(n.value,e)}else o(r.value,e)}return this.consumeChar("]"),{type:"Set",complement:t,value:e}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case"\n":case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:a("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var e=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),e=!1;break;default:this.groupIdx++}var t=this.disjunction();this.consumeChar(")");var r={type:"Group",capturing:e,value:t};return e&&(r.idx=this.groupIdx),r},e.prototype.positiveInteger=function(){var e=this.popChar();if(!1===i.test(e))throw Error("Expecting a positive integer");for(;n.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)},e.prototype.integerIncludingZero=function(){var e=this.popChar();if(!1===n.test(e))throw Error("Expecting an integer");for(;n.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)},e.prototype.patternCharacter=function(){var e=this.popChar();switch(e){case"\n":case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:a(e)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},e.prototype.isRangeDash=function(){return"-"===this.peekChar()&&this.isClassAtom(1)},e.prototype.isDigit=function(){return n.test(this.peekChar(0))},e.prototype.isClassAtom=function(e){switch(void 0===e&&(e=0),this.peekChar(e)){case"]":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return"?"===this.peekChar(1)&&("="===this.peekChar(2)||"!"===this.peekChar(2));default:return!1}},e.prototype.isQuantifier=function(){var e=this.saveState();try{return void 0!==this.quantifier(!0)}catch(e){return!1}finally{this.restoreState(e)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.parseHexDigits=function(e){for(var t="",n=0;n<e;n++){var i=this.popChar();if(!1===r.test(i))throw Error("Expecting a HexDecimal digits");t+=i}return{type:"Character",value:parseInt(t,16)}},e.prototype.peekChar=function(e){return void 0===e&&(e=0),this.input[this.idx+e]},e.prototype.popChar=function(){var e=this.peekChar(0);return this.consumeChar(),e},e.prototype.consumeChar=function(e){if(void 0!==e&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var t,r=/[0-9a-fA-F]/,n=/[0-9]/,i=/[1-9]/;function a(e){return e.charCodeAt(0)}function o(e,t){void 0!==e.length?e.forEach((function(e){t.push(e)})):t.push(e)}function s(e,t){if(!0===e[t])throw"duplicate flag "+t;e[t]=!0}function u(e){if(void 0===e)throw Error("Internal Error - Should never get here!")}var c=[];for(t=a("0");t<=a("9");t++)c.push(t);var l=[a("_")].concat(c);for(t=a("a");t<=a("z");t++)l.push(t);for(t=a("A");t<=a("Z");t++)l.push(t);var h=[a(" "),a("\f"),a("\n"),a("\r"),a("\t"),a("\v"),a("\t"),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a("\u2028"),a("\u2029"),a(" "),a(" "),a("　"),a("\ufeff")];function p(){}return p.prototype.visitChildren=function(e){for(var t in e){var r=e[t];e.hasOwnProperty(t)&&(void 0!==r.type?this.visit(r):Array.isArray(r)&&r.forEach((function(e){this.visit(e)}),this))}},p.prototype.visit=function(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"StartAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.visitQuantifier(e)}this.visitChildren(e)},p.prototype.visitPattern=function(e){},p.prototype.visitFlags=function(e){},p.prototype.visitDisjunction=function(e){},p.prototype.visitAlternative=function(e){},p.prototype.visitStartAnchor=function(e){},p.prototype.visitEndAnchor=function(e){},p.prototype.visitWordBoundary=function(e){},p.prototype.visitNonWordBoundary=function(e){},p.prototype.visitLookahead=function(e){},p.prototype.visitNegativeLookahead=function(e){},p.prototype.visitCharacter=function(e){},p.prototype.visitSet=function(e){},p.prototype.visitGroup=function(e){},p.prototype.visitGroupBackReference=function(e){},p.prototype.visitQuantifier=function(e){},{RegExpParser:e,BaseRegExpVisitor:p,VERSION:"0.4.0"}})?n.apply(t,i):n)||(e.exports=a)},function(e,t,r){"use strict";r.r(t),r.d(t,"failedOptimizationPrefixMsg",(function(){return c})),r.d(t,"getOptimizedStartCodesIndices",(function(){return l})),r.d(t,"firstCharOptimizedIndices",(function(){return h})),r.d(t,"canMatchCharCode",(function(){return y}));var n,i=r(165),a=r(158),o=r(167),s=r(164),u=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),c='Unable to use "first char" lexer optimizations:\n';function l(e,t){void 0===t&&(t=!1);try{var r=Object(o.getRegExpAst)(e);return h(r.value,{},r.flags.ignoreCase)}catch(r){if("Complement Sets are not supported for first char optimization"===r.message)t&&Object(a.PRINT_WARNING)(c+"\tUnable to optimize: < "+e.toString()+" >\n\tComplement Sets cannot be automatically optimized.\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.");else{var n="";t&&(n="\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details."),Object(a.PRINT_ERROR)(c+"\n\tFailed parsing: < "+e.toString()+" >\n\tUsing the regexp-to-ast library version: "+i.VERSION+"\n\tPlease open an issue at: https://github.com/bd82/regexp-to-ast/issues"+n)}}return[]}function h(e,t,r){switch(e.type){case"Disjunction":for(var n=0;n<e.value.length;n++)h(e.value[n],t,r);break;case"Alternative":var i=e.value;for(n=0;n<i.length;n++){var o=i[n];switch(o.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var u=o;switch(u.type){case"Character":p(u.value,t,r);break;case"Set":if(!0===u.complement)throw Error("Complement Sets are not supported for first char optimization");Object(a.forEach)(u.value,(function(e){if("number"==typeof e)p(e,t,r);else{var n=e;if(!0===r)for(var i=n.from;i<=n.to;i++)p(i,t,r);else{for(i=n.from;i<=n.to&&i<s.minOptimizationVal;i++)p(i,t,r);if(n.to>=s.minOptimizationVal)for(var a=n.from>=s.minOptimizationVal?n.from:s.minOptimizationVal,o=n.to,u=Object(s.charCodeToOptimizedIndex)(a),c=Object(s.charCodeToOptimizedIndex)(o),l=u;l<=c;l++)t[l]=l}}}));break;case"Group":h(u.value,t,r);break;default:throw Error("Non Exhaustive Match")}var c=void 0!==u.quantifier&&0===u.quantifier.atLeast;if("Group"===u.type&&!1===d(u)||"Group"!==u.type&&!1===c)break}break;default:throw Error("non exhaustive match!")}return Object(a.values)(t)}function p(e,t,r){var n=Object(s.charCodeToOptimizedIndex)(e);t[n]=n,!0===r&&function(e,t){var r=String.fromCharCode(e),n=r.toUpperCase();if(n!==r){var i=Object(s.charCodeToOptimizedIndex)(n.charCodeAt(0));t[i]=i}else{var a=r.toLowerCase();a!==r&&(i=Object(s.charCodeToOptimizedIndex)(a.charCodeAt(0)),t[i]=i)}}(e,t)}function f(e,t){return Object(a.find)(e.value,(function(e){if("number"==typeof e)return Object(a.contains)(t,e);var r=e;return void 0!==Object(a.find)(t,(function(e){return r.from<=e&&e<=r.to}))}))}function d(e){return!(!e.quantifier||0!==e.quantifier.atLeast)||!!e.value&&(Object(a.isArray)(e.value)?Object(a.every)(e.value,d):d(e.value))}var m=function(e){function t(t){var r=e.call(this)||this;return r.targetCharCodes=t,r.found=!1,r}return u(t,e),t.prototype.visitChildren=function(t){if(!0!==this.found){switch(t.type){case"Lookahead":return void this.visitLookahead(t);case"NegativeLookahead":return void this.visitNegativeLookahead(t)}e.prototype.visitChildren.call(this,t)}},t.prototype.visitCharacter=function(e){Object(a.contains)(this.targetCharCodes,e.value)&&(this.found=!0)},t.prototype.visitSet=function(e){e.complement?void 0===f(e,this.targetCharCodes)&&(this.found=!0):void 0!==f(e,this.targetCharCodes)&&(this.found=!0)},t}(i.BaseRegExpVisitor);function y(e,t){if(t instanceof RegExp){var r=Object(o.getRegExpAst)(t),n=new m(e);return n.visit(r),n.found}return void 0!==Object(a.find)(t,(function(t){return Object(a.contains)(e,t.charCodeAt(0))}))}},function(e,t,r){"use strict";r.r(t),r.d(t,"getRegExpAst",(function(){return o})),r.d(t,"clearRegExpParserCache",(function(){return s}));var n=r(165),i={},a=new n.RegExpParser;function o(e){var t=e.toString();if(i.hasOwnProperty(t))return i[t];var r=a.pattern(t);return i[t]=r,r}function s(){i={}}},function(e,t,r){"use strict";r.r(t),r.d(t,"tokenStructuredMatcher",(function(){return i})),r.d(t,"tokenStructuredMatcherNoCategories",(function(){return a})),r.d(t,"tokenShortNameIdx",(function(){return o})),r.d(t,"tokenIdxToClass",(function(){return s})),r.d(t,"augmentTokenTypes",(function(){return u})),r.d(t,"expandCategories",(function(){return c})),r.d(t,"assignTokenDefaultProps",(function(){return l})),r.d(t,"assignCategoriesTokensProp",(function(){return h})),r.d(t,"assignCategoriesMapProp",(function(){return p})),r.d(t,"singleAssignCategoriesToksMap",(function(){return f})),r.d(t,"hasShortKeyProperty",(function(){return d})),r.d(t,"hasCategoriesProperty",(function(){return m})),r.d(t,"hasExtendingTokensTypesProperty",(function(){return y})),r.d(t,"hasExtendingTokensTypesMapProperty",(function(){return g})),r.d(t,"isTokenType",(function(){return v}));var n=r(158);function i(e,t){var r=e.tokenTypeIdx;return r===t.tokenTypeIdx||!0===t.isParent&&!0===t.categoryMatchesMap[r]}function a(e,t){return e.tokenTypeIdx===t.tokenTypeIdx}var o=1,s={};function u(e){var t=c(e);l(t),p(t),h(t),Object(n.forEach)(t,(function(e){e.isParent=e.categoryMatches.length>0}))}function c(e){for(var t=Object(n.cloneArr)(e),r=e,i=!0;i;){r=Object(n.compact)(Object(n.flatten)(Object(n.map)(r,(function(e){return e.CATEGORIES}))));var a=Object(n.difference)(r,t);t=t.concat(a),Object(n.isEmpty)(a)?i=!1:r=a}return t}function l(e){Object(n.forEach)(e,(function(e){d(e)||(s[o]=e,e.tokenTypeIdx=o++),m(e)&&!Object(n.isArray)(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),m(e)||(e.CATEGORIES=[]),y(e)||(e.categoryMatches=[]),g(e)||(e.categoryMatchesMap={})}))}function h(e){Object(n.forEach)(e,(function(e){e.categoryMatches=[],Object(n.forEach)(e.categoryMatchesMap,(function(t,r){e.categoryMatches.push(s[r].tokenTypeIdx)}))}))}function p(e){Object(n.forEach)(e,(function(e){f([],e)}))}function f(e,t){Object(n.forEach)(e,(function(e){t.categoryMatchesMap[e.tokenTypeIdx]=!0})),Object(n.forEach)(t.CATEGORIES,(function(r){var i=e.concat(t);Object(n.contains)(i,r)||f(i,r)}))}function d(e){return Object(n.has)(e,"tokenTypeIdx")}function m(e){return Object(n.has)(e,"CATEGORIES")}function y(e){return Object(n.has)(e,"categoryMatches")}function g(e){return Object(n.has)(e,"categoryMatchesMap")}function v(e){return Object(n.has)(e,"tokenTypeIdx")}},function(e,t,r){"use strict";r.r(t),r.d(t,"defaultLexerErrorProvider",(function(){return n}));var n={buildUnableToPopLexerModeMessage:function(e){return"Unable to pop Lexer Mode after encountering Token ->"+e.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(e,t,r,n,i){return"unexpected character: ->"+e.charAt(t)+"<- at offset: "+t+", skipped "+r+" characters."}}},function(e,t,r){"use strict";r.r(t),r.d(t,"first",(function(){return o})),r.d(t,"firstForSequence",(function(){return s})),r.d(t,"firstForBranching",(function(){return u})),r.d(t,"firstForTerminal",(function(){return c}));var n=r(158),i=r(161),a=r(171);function o(e){if(e instanceof i.NonTerminal)return o(e.referencedRule);if(e instanceof i.Terminal)return c(e);if(Object(a.isSequenceProd)(e))return s(e);if(Object(a.isBranchingProd)(e))return u(e);throw Error("non exhaustive match")}function s(e){for(var t,r=[],i=e.definition,s=0,u=i.length>s,c=!0;u&&c;)t=i[s],c=Object(a.isOptionalProd)(t),r=r.concat(o(t)),s+=1,u=i.length>s;return Object(n.uniq)(r)}function u(e){var t=Object(n.map)(e.definition,(function(e){return o(e)}));return Object(n.uniq)(Object(n.flatten)(t))}function c(e){return[e.terminalType]}},function(e,t,r){"use strict";r.r(t),r.d(t,"isSequenceProd",(function(){return u})),r.d(t,"isOptionalProd",(function(){return c})),r.d(t,"isBranchingProd",(function(){return l})),r.d(t,"getProductionDslName",(function(){return h})),r.d(t,"DslMethodsCollectorVisitor",(function(){return p})),r.d(t,"collectMethods",(function(){return d}));var n,i=r(158),a=r(161),o=r(172),s=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function u(e){return e instanceof a.Flat||e instanceof a.Option||e instanceof a.Repetition||e instanceof a.RepetitionMandatory||e instanceof a.RepetitionMandatoryWithSeparator||e instanceof a.RepetitionWithSeparator||e instanceof a.Terminal||e instanceof a.Rule}function c(e,t){return void 0===t&&(t=[]),!!(e instanceof a.Option||e instanceof a.Repetition||e instanceof a.RepetitionWithSeparator)||(e instanceof a.Alternation?Object(i.some)(e.definition,(function(e){return c(e,t)})):!(e instanceof a.NonTerminal&&Object(i.contains)(t,e))&&e instanceof a.AbstractProduction&&(e instanceof a.NonTerminal&&t.push(e),Object(i.every)(e.definition,(function(e){return c(e,t)}))))}function l(e){return e instanceof a.Alternation}function h(e){if(e instanceof a.NonTerminal)return"SUBRULE";if(e instanceof a.Option)return"OPTION";if(e instanceof a.Alternation)return"OR";if(e instanceof a.RepetitionMandatory)return"AT_LEAST_ONE";if(e instanceof a.RepetitionMandatoryWithSeparator)return"AT_LEAST_ONE_SEP";if(e instanceof a.RepetitionWithSeparator)return"MANY_SEP";if(e instanceof a.Repetition)return"MANY";if(e instanceof a.Terminal)return"CONSUME";throw Error("non exhaustive match")}var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.separator="-",t.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},t}return s(t,e),t.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},t.prototype.visitTerminal=function(e){var t=e.terminalType.name+this.separator+"Terminal";Object(i.has)(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},t.prototype.visitNonTerminal=function(e){var t=e.nonTerminalName+this.separator+"Terminal";Object(i.has)(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},t.prototype.visitOption=function(e){this.dslMethods.option.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.dslMethods.repetitionWithSeparator.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.dslMethods.repetitionMandatory.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)},t.prototype.visitRepetition=function(e){this.dslMethods.repetition.push(e)},t.prototype.visitAlternation=function(e){this.dslMethods.alternation.push(e)},t}(o.GAstVisitor),f=new p;function d(e){f.reset(),e.accept(f);var t=f.dslMethods;return f.reset(),t}},function(e,t,r){"use strict";r.r(t),r.d(t,"GAstVisitor",(function(){return i}));var n=r(161),i=function(){function e(){}return e.prototype.visit=function(e){var t=e;switch(t.constructor){case n.NonTerminal:return this.visitNonTerminal(t);case n.Flat:return this.visitFlat(t);case n.Option:return this.visitOption(t);case n.RepetitionMandatory:return this.visitRepetitionMandatory(t);case n.RepetitionMandatoryWithSeparator:return this.visitRepetitionMandatoryWithSeparator(t);case n.RepetitionWithSeparator:return this.visitRepetitionWithSeparator(t);case n.Repetition:return this.visitRepetition(t);case n.Alternation:return this.visitAlternation(t);case n.Terminal:return this.visitTerminal(t);case n.Rule:return this.visitRule(t);default:throw Error("non exhaustive match")}},e.prototype.visitNonTerminal=function(e){},e.prototype.visitFlat=function(e){},e.prototype.visitOption=function(e){},e.prototype.visitRepetition=function(e){},e.prototype.visitRepetitionMandatory=function(e){},e.prototype.visitRepetitionMandatoryWithSeparator=function(e){},e.prototype.visitRepetitionWithSeparator=function(e){},e.prototype.visitAlternation=function(e){},e.prototype.visitTerminal=function(e){},e.prototype.visitRule=function(e){},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"IN",(function(){return n}));var n="_~IN~_"},function(e,t,r){"use strict";r.r(t),r.d(t,"setNodeLocationOnlyOffset",(function(){return c})),r.d(t,"setNodeLocationFull",(function(){return l})),r.d(t,"addTerminalToCst",(function(){return h})),r.d(t,"addNoneTerminalToCst",(function(){return p})),r.d(t,"NamedDSLMethodsCollectorVisitor",(function(){return f})),r.d(t,"expandAllNestedRuleNames",(function(){return d}));var n,i=r(158),a=r(175),o=r(161),s=r(172),u=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function c(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.endOffset=t.endOffset):e.endOffset<t.endOffset==1&&(e.endOffset=t.endOffset)}function l(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.startColumn=t.startColumn,e.startLine=t.startLine,e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine):e.endOffset<t.endOffset==1&&(e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine)}function h(e,t,r){void 0===e.children[r]?e.children[r]=[t]:e.children[r].push(t)}function p(e,t,r){void 0===e.children[t]?e.children[t]=[r]:e.children[t].push(r)}var f=function(e){function t(t){var r=e.call(this)||this;return r.result=[],r.ruleIdx=t,r}return u(t,e),t.prototype.collectNamedDSLMethod=function(e,t,r){if(!Object(i.isUndefined)(e.name)){var n=void 0;if(e instanceof o.Option||e instanceof o.Repetition||e instanceof o.RepetitionMandatory||e instanceof o.Alternation)n=new t({definition:e.definition,idx:e.idx});else{if(!(e instanceof o.RepetitionMandatoryWithSeparator||e instanceof o.RepetitionWithSeparator))throw Error("non exhaustive match");n=new t({definition:e.definition,idx:e.idx,separator:e.separator})}var s=[n],u=Object(a.getKeyForAutomaticLookahead)(this.ruleIdx,r,e.idx);this.result.push({def:s,key:u,name:e.name,orgProd:e})}},t.prototype.visitOption=function(e){this.collectNamedDSLMethod(e,o.Option,a.OPTION_IDX)},t.prototype.visitRepetition=function(e){this.collectNamedDSLMethod(e,o.Repetition,a.MANY_IDX)},t.prototype.visitRepetitionMandatory=function(e){this.collectNamedDSLMethod(e,o.RepetitionMandatory,a.AT_LEAST_ONE_IDX)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.collectNamedDSLMethod(e,o.RepetitionMandatoryWithSeparator,a.AT_LEAST_ONE_SEP_IDX)},t.prototype.visitRepetitionWithSeparator=function(e){this.collectNamedDSLMethod(e,o.RepetitionWithSeparator,a.MANY_SEP_IDX)},t.prototype.visitAlternation=function(e){var t=this;this.collectNamedDSLMethod(e,o.Alternation,a.OR_IDX);var r=e.definition.length>1;Object(i.forEach)(e.definition,(function(n,s){if(!Object(i.isUndefined)(n.name)){var u=n.definition;u=r?[new o.Option({definition:n.definition})]:n.definition;var c=Object(a.getKeyForAltIndex)(t.ruleIdx,a.OR_IDX,e.idx,s);t.result.push({def:u,key:c,name:n.name,orgProd:n})}}))},t}(s.GAstVisitor);function d(e,t){var r={allRuleNames:[]};return Object(i.forEach)(e,(function(e){var n=t[e.name];r.allRuleNames.push(e.name);var a=new f(n);e.accept(a),Object(i.forEach)(a.result,(function(t){t.def,t.key;var n=t.name;r.allRuleNames.push(e.name+n)}))})),r}},function(e,t,r){"use strict";r.r(t),r.d(t,"BITS_FOR_METHOD_TYPE",(function(){return n})),r.d(t,"BITS_FOR_OCCURRENCE_IDX",(function(){return i})),r.d(t,"BITS_FOR_RULE_IDX",(function(){return a})),r.d(t,"BITS_FOR_ALT_IDX",(function(){return o})),r.d(t,"OR_IDX",(function(){return s})),r.d(t,"OPTION_IDX",(function(){return u})),r.d(t,"MANY_IDX",(function(){return c})),r.d(t,"AT_LEAST_ONE_IDX",(function(){return l})),r.d(t,"MANY_SEP_IDX",(function(){return h})),r.d(t,"AT_LEAST_ONE_SEP_IDX",(function(){return p})),r.d(t,"getKeyForAutomaticLookahead",(function(){return f})),r.d(t,"getKeyForAltIndex",(function(){return m}));var n=4,i=8,a=12,o=8,s=1<<i,u=2<<i,c=3<<i,l=4<<i,h=5<<i,p=6<<i;function f(e,t,r){return r|t|e}var d=32-o;function m(e,t,r,n){var i=n+1<<d;return f(e,t,r)|i}},function(e,t,r){"use strict";r.r(t),r.d(t,"defaultParserErrorProvider",(function(){return u})),r.d(t,"defaultGrammarResolverErrorProvider",(function(){return c})),r.d(t,"defaultGrammarValidatorErrorProvider",(function(){return l}));var n=r(162),i=r(158),a=r(161),o=r(171),s=r(177),u={buildMismatchTokenMessage:function(e){var t=e.expected,r=e.actual;return e.previous,e.ruleName,"Expecting "+(Object(n.hasTokenLabel)(t)?"--\x3e "+Object(n.tokenLabel)(t)+" <--":"token of type --\x3e "+t.name+" <--")+" but found --\x3e '"+r.image+"' <--"},buildNotAllInputParsedMessage:function(e){var t=e.firstRedundant;return e.ruleName,"Redundant input, expecting EOF but found: "+t.image},buildNoViableAltMessage:function(e){var t=e.expectedPathsPerAlt,r=e.actual,a=(e.previous,e.customUserDescription),o=(e.ruleName,"\nbut found: '"+Object(i.first)(r).image+"'");if(a)return"Expecting: "+a+o;var s=Object(i.reduce)(t,(function(e,t){return e.concat(t)}),[]),u=Object(i.map)(s,(function(e){return"["+Object(i.map)(e,(function(e){return Object(n.tokenLabel)(e)})).join(", ")+"]"}));return"Expecting: one of these possible Token sequences:\n"+Object(i.map)(u,(function(e,t){return"  "+(t+1)+". "+e})).join("\n")+o},buildEarlyExitMessage:function(e){var t=e.expectedIterationPaths,r=e.actual,a=e.customUserDescription,o=(e.ruleName,"\nbut found: '"+Object(i.first)(r).image+"'");return a?"Expecting: "+a+o:"Expecting: expecting at least one iteration which starts with one of these possible Token sequences::\n  <"+Object(i.map)(t,(function(e){return"["+Object(i.map)(e,(function(e){return Object(n.tokenLabel)(e)})).join(",")+"]"})).join(" ,")+">"+o}};Object.freeze(u);var c={buildRuleNotFoundError:function(e,t){return"Invalid grammar, reference to a rule which is not defined: ->"+t.nonTerminalName+"<-\ninside top level rule: ->"+e.name+"<-"}},l={buildDuplicateFoundError:function(e,t){var r,n=e.name,s=Object(i.first)(t),u=s.idx,c=Object(o.getProductionDslName)(s),l=(r=s)instanceof a.Terminal?r.terminalType.name:r instanceof a.NonTerminal?r.nonTerminalName:"",h="->"+c+(u>0?u:"")+"<- "+(l?"with argument: ->"+l+"<-":"")+"\n                  appears more than once ("+t.length+" times) in the top level rule: ->"+n+"<-.                  \n                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES \n                  ";return h=(h=h.replace(/[ \t]+/g," ")).replace(/\s\s+/g,"\n")},buildInvalidNestedRuleNameError:function(e,t){return"Invalid nested rule name: ->"+t.name+"<- inside rule: ->"+e.name+"<-\nit must match the pattern: ->"+s.validNestedRuleName.toString()+"<-.\nNote that this means a nested rule name must start with the '$'(dollar) sign."},buildDuplicateNestedRuleNameError:function(e,t){return"Duplicate nested rule name: ->"+Object(i.first)(t).name+"<- inside rule: ->"+e.name+"<-\nA nested name must be unique in the scope of a top level grammar rule."},buildNamespaceConflictError:function(e){return"Namespace conflict found in grammar.\nThe grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+e.name+">.\nTo resolve this make sure each Terminal and Non-Terminal names are unique\nThis is easy to accomplish by using the convention that Terminal names start with an uppercase letter\nand Non-Terminal names start with a lower case letter."},buildAlternationPrefixAmbiguityError:function(e){var t=Object(i.map)(e.prefixPath,(function(e){return Object(n.tokenLabel)(e)})).join(", "),r=0===e.alternation.idx?"":e.alternation.idx;return"Ambiguous alternatives: <"+e.ambiguityIndices.join(" ,")+"> due to common lookahead prefix\nin <OR"+r+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\nSee: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX\nFor Further details."},buildAlternationAmbiguityError:function(e){var t=Object(i.map)(e.prefixPath,(function(e){return Object(n.tokenLabel)(e)})).join(", "),r=0===e.alternation.idx?"":e.alternation.idx,a="Ambiguous Alternatives Detected: <"+e.ambiguityIndices.join(" ,")+"> in <OR"+r+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\n";return a+="See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES\nFor Further details."},buildEmptyRepetitionError:function(e){var t=Object(o.getProductionDslName)(e.repetition);return 0!==e.repetition.idx&&(t+=e.repetition.idx),"The repetition <"+t+"> within Rule <"+e.topLevelRule.name+"> can never consume any tokens.\nThis could lead to an infinite loop."},buildTokenNameError:function(e){return"Invalid Grammar Token name: ->"+e.tokenType.name+"<- it must match the pattern: ->"+e.expectedPattern.toString()+"<-"},buildEmptyAlternationError:function(e){return"Ambiguous empty alternative: <"+(e.emptyChoiceIdx+1)+"> in <OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\nOnly the last alternative may be an empty alternative."},buildTooManyAlternativesError:function(e){return"An Alternation cannot have more than 256 alternatives:\n<OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\n has "+(e.alternation.definition.length+1)+" alternatives."},buildLeftRecursionError:function(e){var t=e.topLevelRule.name;return"Left Recursion found in grammar.\nrule: <"+t+"> can be invoked from itself (directly or indirectly)\nwithout consuming any Tokens. The grammar path that causes this is: \n "+t+" --\x3e "+i.map(e.leftRecursionPath,(function(e){return e.name})).concat([t]).join(" --\x3e ")+"\n To fix this refactor your grammar to remove the left recursion.\nsee: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring."},buildInvalidRuleNameError:function(e){return"Invalid grammar rule name: ->"+e.topLevelRule.name+"<- it must match the pattern: ->"+e.expectedPattern.toString()+"<-"},buildDuplicateRuleNameError:function(e){return"Duplicate definition, rule: ->"+(e.topLevelRule instanceof a.Rule?e.topLevelRule.name:e.topLevelRule)+"<- is already defined in the grammar: ->"+e.grammarName+"<-"}}},function(e,t,r){"use strict";r.r(t),r.d(t,"validateGrammar",(function(){return f})),r.d(t,"identifyProductionForDuplicates",(function(){return d})),r.d(t,"OccurrenceValidationCollector",(function(){return y})),r.d(t,"validTermsPattern",(function(){return g})),r.d(t,"validNestedRuleName",(function(){return v})),r.d(t,"validateRuleName",(function(){return E})),r.d(t,"validateNestedRuleName",(function(){return T})),r.d(t,"validateTokenName",(function(){return b})),r.d(t,"validateRuleDoesNotAlreadyExist",(function(){return x})),r.d(t,"validateRuleIsOverridden",(function(){return A})),r.d(t,"validateNoLeftRecursion",(function(){return S})),r.d(t,"getFirstNoneTerminal",(function(){return R})),r.d(t,"validateEmptyOrAlternative",(function(){return C})),r.d(t,"validateAmbiguousAlternationAlternatives",(function(){return O})),r.d(t,"RepetionCollector",(function(){return k})),r.d(t,"validateTooManyAlts",(function(){return N})),r.d(t,"validateSomeNonEmptyLookaheadPath",(function(){return _})),r.d(t,"checkPrefixAlternativesAmbiguities",(function(){return I}));var n,i=r(158),a=r(157),o=r(171),s=r(178),u=r(174),c=r(179),l=r(161),h=r(172),p=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function f(e,t,r,n,s,c){var l=i.map(e,(function(e){return function(e,t){var r=new y;e.accept(r);var n=r.allProductions,s=i.groupBy(n,d),u=i.pick(s,(function(e){return e.length>1}));return i.map(i.values(u),(function(r){var n=i.first(r),s=t.buildDuplicateFoundError(e,r),u=Object(o.getProductionDslName)(n),c={message:s,type:a.ParserDefinitionErrorType.DUPLICATE_PRODUCTIONS,ruleName:e.name,dslName:u,occurrence:n.idx},l=m(n);return l&&(c.parameter=l),c}))}(e,s)})),h=i.map(e,(function(e){return S(e,e,s)})),p=[],f=[],g=[];Object(i.every)(h,i.isEmpty)&&(p=Object(i.map)(e,(function(e){return C(e,s)})),f=Object(i.map)(e,(function(e){return O(e,t,n,s)})),g=_(e,t,s));var v=function(e,t,r){var n=[],o=Object(i.map)(t,(function(e){return e.name}));return Object(i.forEach)(e,(function(e){var t=e.name;if(Object(i.contains)(o,t)){var s=r.buildNamespaceConflictError(e);n.push({message:s,type:a.ParserDefinitionErrorType.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:t})}})),n}(e,r,s),A=i.map(r,(function(e){return b(e,s)})),R=function(e,t){var r=[];return Object(i.forEach)(e,(function(e){var n=new u.NamedDSLMethodsCollectorVisitor("");e.accept(n);var a=Object(i.map)(n.result,(function(e){return e.orgProd}));r.push(Object(i.map)(a,(function(r){return T(e,r,t)})))})),Object(i.flatten)(r)}(e,s),w=function(e,t){var r=[];return Object(i.forEach)(e,(function(e){var n=new u.NamedDSLMethodsCollectorVisitor("");e.accept(n);var o=Object(i.groupBy)(n.result,(function(e){return e.name})),s=Object(i.pick)(o,(function(e){return e.length>1}));Object(i.forEach)(Object(i.values)(s),(function(n){var o=Object(i.map)(n,(function(e){return e.orgProd})),s=t.buildDuplicateNestedRuleNameError(e,o);r.push({message:s,type:a.ParserDefinitionErrorType.DUPLICATE_NESTED_NAME,ruleName:e.name})}))})),r}(e,s),k=Object(i.map)(e,(function(e){return N(e,s)})),I=Object(i.map)(e,(function(e){return E(e,s)})),M=Object(i.map)(e,(function(t){return x(t,e,c,s)}));return i.flatten(l.concat(A,R,w,g,h,p,f,v,k,I,M))}function d(e){return Object(o.getProductionDslName)(e)+"_#_"+e.idx+"_#_"+m(e)}function m(e){return e instanceof l.Terminal?e.terminalType.name:e instanceof l.NonTerminal?e.nonTerminalName:""}var y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allProductions=[],t}return p(t,e),t.prototype.visitNonTerminal=function(e){this.allProductions.push(e)},t.prototype.visitOption=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t.prototype.visitAlternation=function(e){this.allProductions.push(e)},t.prototype.visitTerminal=function(e){this.allProductions.push(e)},t}(h.GAstVisitor),g=/^[a-zA-Z_]\w*$/,v=new RegExp(g.source.replace("^","^\\$"));function E(e,t){var r=[],n=e.name;return n.match(g)||r.push({message:t.buildInvalidRuleNameError({topLevelRule:e,expectedPattern:g}),type:a.ParserDefinitionErrorType.INVALID_RULE_NAME,ruleName:n}),r}function T(e,t,r){var n,i=[];return t.name.match(v)||(n=r.buildInvalidNestedRuleNameError(e,t),i.push({message:n,type:a.ParserDefinitionErrorType.INVALID_NESTED_RULE_NAME,ruleName:e.name})),i}function b(e,t){var r=[];return e.name.match(g)||r.push({message:t.buildTokenNameError({tokenType:e,expectedPattern:g}),type:a.ParserDefinitionErrorType.INVALID_TOKEN_NAME}),r}function x(e,t,r,n){var o=[];if(Object(i.reduce)(t,(function(t,r){return r.name===e.name?t+1:t}),0)>1){var s=n.buildDuplicateRuleNameError({topLevelRule:e,grammarName:r});o.push({message:s,type:a.ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:e.name})}return o}function A(e,t,r){var n,o=[];return i.contains(t,e)||(n="Invalid rule override, rule: ->"+e+"<- cannot be overridden in the grammar: ->"+r+"<-as it is not defined in any of the super grammars ",o.push({message:n,type:a.ParserDefinitionErrorType.INVALID_RULE_OVERRIDE,ruleName:e})),o}function S(e,t,r,n){void 0===n&&(n=[]);var o=[],s=R(t.definition);if(i.isEmpty(s))return[];var u=e.name;i.contains(s,e)&&o.push({message:r.buildLeftRecursionError({topLevelRule:e,leftRecursionPath:n}),type:a.ParserDefinitionErrorType.LEFT_RECURSION,ruleName:u});var c=i.difference(s,n.concat([e])),l=i.map(c,(function(t){var a=i.cloneArr(n);return a.push(t),S(e,t,r,a)}));return o.concat(i.flatten(l))}function R(e){var t=[];if(i.isEmpty(e))return t;var r=i.first(e);if(r instanceof l.NonTerminal)t.push(r.referencedRule);else if(r instanceof l.Flat||r instanceof l.Option||r instanceof l.RepetitionMandatory||r instanceof l.RepetitionMandatoryWithSeparator||r instanceof l.RepetitionWithSeparator||r instanceof l.Repetition)t=t.concat(R(r.definition));else if(r instanceof l.Alternation)t=i.flatten(i.map(r.definition,(function(e){return R(e.definition)})));else if(!(r instanceof l.Terminal))throw Error("non exhaustive match");var n=Object(o.isOptionalProd)(r),a=e.length>1;if(n&&a){var s=i.drop(e);return t.concat(R(s))}return t}var w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.alternations=[],t}return p(t,e),t.prototype.visitAlternation=function(e){this.alternations.push(e)},t}(h.GAstVisitor);function C(e,t){var r=new w;e.accept(r);var n=r.alternations;return i.reduce(n,(function(r,n){var o=i.dropRight(n.definition),s=i.map(o,(function(r,o){var s=Object(c.nextPossibleTokensAfter)([r],[],null,1);return i.isEmpty(s)?{message:t.buildEmptyAlternationError({topLevelRule:e,alternation:n,emptyChoiceIdx:o}),type:a.ParserDefinitionErrorType.NONE_LAST_EMPTY_ALT,ruleName:e.name,occurrence:n.idx,alternative:o+1}:null}));return r.concat(i.compact(s))}),[])}function O(e,t,r,n){var u=new w;e.accept(u);var c=u.alternations,l=r[e.name];return l&&(c=Object(i.reject)(c,(function(e){return l[Object(o.getProductionDslName)(e)+(0===e.idx?"":e.idx)]}))),c=Object(i.reject)(c,(function(e){return!0===e.ignoreAmbiguities})),i.reduce(c,(function(r,o){var u=o.idx,c=o.maxLookahead||t,l=Object(s.getLookaheadPathsForOr)(u,e,c,o),h=function(e,t,r,n){var o=[],u=Object(i.reduce)(e,(function(r,n,a){return!0===t.definition[a].ignoreAmbiguities||Object(i.forEach)(n,(function(n){var u=[a];Object(i.forEach)(e,(function(e,r){a!==r&&Object(s.containsPath)(e,n)&&!0!==t.definition[r].ignoreAmbiguities&&u.push(r)})),u.length>1&&!Object(s.containsPath)(o,n)&&(o.push(n),r.push({alts:u,path:n}))})),r}),[]);return i.map(u,(function(e){var o=Object(i.map)(e.alts,(function(e){return e+1}));return{message:n.buildAlternationAmbiguityError({topLevelRule:r,alternation:t,ambiguityIndices:o,prefixPath:e.path}),type:a.ParserDefinitionErrorType.AMBIGUOUS_ALTS,ruleName:r.name,occurrence:t.idx,alternatives:[e.alts]}}))}(l,o,e,n),p=I(l,o,e,n);return r.concat(h,p)}),[])}var k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allProductions=[],t}return p(t,e),t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t}(h.GAstVisitor);function N(e,t){var r=new w;e.accept(r);var n=r.alternations;return i.reduce(n,(function(r,n){return n.definition.length>255&&r.push({message:t.buildTooManyAlternativesError({topLevelRule:e,alternation:n}),type:a.ParserDefinitionErrorType.TOO_MANY_ALTS,ruleName:e.name,occurrence:n.idx}),r}),[])}function _(e,t,r){var n=[];return Object(i.forEach)(e,(function(e){var o=new k;e.accept(o);var u=o.allProductions;Object(i.forEach)(u,(function(o){var u=Object(s.getProdType)(o),c=o.maxLookahead||t,l=o.idx,h=Object(s.getLookaheadPathsForOptionalProd)(l,e,u,c)[0];if(Object(i.isEmpty)(Object(i.flatten)(h))){var p=r.buildEmptyRepetitionError({topLevelRule:e,repetition:o});n.push({message:p,type:a.ParserDefinitionErrorType.NO_NON_EMPTY_LOOKAHEAD,ruleName:e.name})}}))})),n}function I(e,t,r,n){var o=[],u=Object(i.reduce)(e,(function(e,t,r){var n=Object(i.map)(t,(function(e){return{idx:r,path:e}}));return e.concat(n)}),[]);return Object(i.forEach)(u,(function(e){if(!0!==t.definition[e.idx].ignoreAmbiguities){var c=e.idx,l=e.path,h=Object(i.findAll)(u,(function(e){return!0!==t.definition[e.idx].ignoreAmbiguities&&e.idx<c&&Object(s.isStrictPrefixOfPath)(e.path,l)})),p=Object(i.map)(h,(function(e){var i=[e.idx+1,c+1],o=0===t.idx?"":t.idx;return{message:n.buildAlternationPrefixAmbiguityError({topLevelRule:r,alternation:t,ambiguityIndices:i,prefixPath:e.path}),type:a.ParserDefinitionErrorType.AMBIGUOUS_PREFIX_ALTS,ruleName:r.name,occurrence:o,alternatives:i}}));o=o.concat(p)}})),o}},function(e,t,r){"use strict";r.r(t),r.d(t,"PROD_TYPE",(function(){return i})),r.d(t,"getProdType",(function(){return p})),r.d(t,"buildLookaheadFuncForOr",(function(){return f})),r.d(t,"buildLookaheadFuncForOptionalProd",(function(){return d})),r.d(t,"buildAlternativesLookAheadFunc",(function(){return m})),r.d(t,"buildSingleAlternativeLookaheadFunction",(function(){return y})),r.d(t,"lookAheadSequenceFromAlternatives",(function(){return x})),r.d(t,"getLookaheadPathsForOr",(function(){return A})),r.d(t,"getLookaheadPathsForOptionalProd",(function(){return S})),r.d(t,"containsPath",(function(){return R})),r.d(t,"isStrictPrefixOfPath",(function(){return w})),r.d(t,"areTokenCategoriesNotUsed",(function(){return C}));var n,i,a=r(158),o=r(179),s=r(160),u=r(168),c=r(161),l=r(172),h=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function p(e){if(e instanceof c.Option)return i.OPTION;if(e instanceof c.Repetition)return i.REPETITION;if(e instanceof c.RepetitionMandatory)return i.REPETITION_MANDATORY;if(e instanceof c.RepetitionMandatoryWithSeparator)return i.REPETITION_MANDATORY_WITH_SEPARATOR;if(e instanceof c.RepetitionWithSeparator)return i.REPETITION_WITH_SEPARATOR;if(e instanceof c.Alternation)return i.ALTERNATION;throw Error("non exhaustive match")}function f(e,t,r,n,i,a){var o=A(e,t,r);return a(o,n,C(o)?u.tokenStructuredMatcherNoCategories:u.tokenStructuredMatcher,i)}function d(e,t,r,n,i,a){var o=S(e,t,i,r),s=C(o)?u.tokenStructuredMatcherNoCategories:u.tokenStructuredMatcher;return a(o[0],s,n)}function m(e,t,r,n){var i=e.length,o=Object(a.every)(e,(function(e){return Object(a.every)(e,(function(e){return 1===e.length}))}));if(t)return function(t){for(var n=Object(a.map)(t,(function(e){return e.GATE})),o=0;o<i;o++){var s=e[o],u=s.length,c=n[o];if(void 0===c||!1!==c.call(this))e:for(var l=0;l<u;l++){for(var h=s[l],p=h.length,f=0;f<p;f++){var d=this.LA(f+1);if(!1===r(d,h[f]))continue e}return o}}};if(o&&!n){var s=Object(a.map)(e,(function(e){return Object(a.flatten)(e)})),u=Object(a.reduce)(s,(function(e,t,r){return Object(a.forEach)(t,(function(t){Object(a.has)(e,t.tokenTypeIdx)||(e[t.tokenTypeIdx]=r),Object(a.forEach)(t.categoryMatches,(function(t){Object(a.has)(e,t)||(e[t]=r)}))})),e}),[]);return function(){var e=this.LA(1);return u[e.tokenTypeIdx]}}return function(){for(var t=0;t<i;t++){var n=e[t],a=n.length;e:for(var o=0;o<a;o++){for(var s=n[o],u=s.length,c=0;c<u;c++){var l=this.LA(c+1);if(!1===r(l,s[c]))continue e}return t}}}}function y(e,t,r){var n=Object(a.every)(e,(function(e){return 1===e.length})),i=e.length;if(n&&!r){var o=Object(a.flatten)(e);if(1===o.length&&Object(a.isEmpty)(o[0].categoryMatches)){var s=o[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===s}}var u=Object(a.reduce)(o,(function(e,t,r){return e[t.tokenTypeIdx]=!0,Object(a.forEach)(t.categoryMatches,(function(t){e[t]=!0})),e}),[]);return function(){var e=this.LA(1);return!0===u[e.tokenTypeIdx]}}return function(){e:for(var r=0;r<i;r++){for(var n=e[r],a=n.length,o=0;o<a;o++){var s=this.LA(o+1);if(!1===t(s,n[o]))continue e}return!0}return!1}}!function(e){e[e.OPTION=0]="OPTION",e[e.REPETITION=1]="REPETITION",e[e.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",e[e.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",e[e.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",e[e.ALTERNATION=5]="ALTERNATION"}(i||(i={}));var g=function(e){function t(t,r,n){var i=e.call(this)||this;return i.topProd=t,i.targetOccurrence=r,i.targetProdType=n,i}return h(t,e),t.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},t.prototype.checkIsTarget=function(e,t,r,n){return e.idx===this.targetOccurrence&&this.targetProdType===t&&(this.restDef=r.concat(n),!0)},t.prototype.walkOption=function(t,r,n){this.checkIsTarget(t,i.OPTION,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkAtLeastOne=function(t,r,n){this.checkIsTarget(t,i.REPETITION_MANDATORY,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkAtLeastOneSep=function(t,r,n){this.checkIsTarget(t,i.REPETITION_MANDATORY_WITH_SEPARATOR,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkMany=function(t,r,n){this.checkIsTarget(t,i.REPETITION,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkManySep=function(t,r,n){this.checkIsTarget(t,i.REPETITION_WITH_SEPARATOR,r,n)||e.prototype.walkOption.call(this,t,r,n)},t}(s.RestWalker),v=function(e){function t(t,r,n){var i=e.call(this)||this;return i.targetOccurrence=t,i.targetProdType=r,i.targetRef=n,i.result=[],i}return h(t,e),t.prototype.checkIsTarget=function(e,t){e.idx!==this.targetOccurrence||this.targetProdType!==t||void 0!==this.targetRef&&e!==this.targetRef||(this.result=e.definition)},t.prototype.visitOption=function(e){this.checkIsTarget(e,i.OPTION)},t.prototype.visitRepetition=function(e){this.checkIsTarget(e,i.REPETITION)},t.prototype.visitRepetitionMandatory=function(e){this.checkIsTarget(e,i.REPETITION_MANDATORY)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.checkIsTarget(e,i.REPETITION_MANDATORY_WITH_SEPARATOR)},t.prototype.visitRepetitionWithSeparator=function(e){this.checkIsTarget(e,i.REPETITION_WITH_SEPARATOR)},t.prototype.visitAlternation=function(e){this.checkIsTarget(e,i.ALTERNATION)},t}(l.GAstVisitor);function E(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=[];return t}function T(e){for(var t=[""],r=0;r<e.length;r++){for(var n=e[r],i=[],a=0;a<t.length;a++){var o=t[a];i.push(o+"_"+n.tokenTypeIdx);for(var s=0;s<n.categoryMatches.length;s++){var u="_"+n.categoryMatches[s];i.push(o+u)}}t=i}return t}function b(e,t,r){for(var n=0;n<e.length;n++)if(n!==r)for(var i=e[n],a=0;a<t.length;a++)if(!0===i[t[a]])return!1;return!0}function x(e,t){for(var r=Object(a.map)(e,(function(e){return Object(o.possiblePathsFrom)([e],1)})),n=E(r.length),i=Object(a.map)(r,(function(e){var t={};return Object(a.forEach)(e,(function(e){var r=T(e.partialPath);Object(a.forEach)(r,(function(e){t[e]=!0}))})),t})),s=r,u=1;u<=t;u++){var c=s;s=E(c.length);for(var l=function(e){for(var r=c[e],l=0;l<r.length;l++){var h=r[l].partialPath,p=r[l].suffixDef,f=T(h);if(b(i,f,e)||Object(a.isEmpty)(p)||h.length===t){var d=n[e];if(!1===R(d,h)){d.push(h);for(var m=0;m<f.length;m++){var y=f[m];i[e][y]=!0}}}else{var g=Object(o.possiblePathsFrom)(p,u+1,h);s[e]=s[e].concat(g),Object(a.forEach)(g,(function(t){var r=T(t.partialPath);Object(a.forEach)(r,(function(t){i[e][t]=!0}))}))}}},h=0;h<c.length;h++)l(h)}return n}function A(e,t,r,n){var a=new v(e,i.ALTERNATION,n);return t.accept(a),x(a.result,r)}function S(e,t,r,n){var i=new v(e,r);t.accept(i);var a=i.result,o=new g(t,e,r).startWalking();return x([new c.Flat({definition:a}),new c.Flat({definition:o})],n)}function R(e,t){e:for(var r=0;r<e.length;r++){var n=e[r];if(n.length===t.length){for(var i=0;i<n.length;i++){var a=t[i],o=n[i];if(!1==(a===o||void 0!==o.categoryMatchesMap[a.tokenTypeIdx]))continue e}return!0}}return!1}function w(e,t){return e.length<t.length&&Object(a.every)(e,(function(e,r){var n=t[r];return e===n||n.categoryMatchesMap[e.tokenTypeIdx]}))}function C(e){return Object(a.every)(e,(function(e){return Object(a.every)(e,(function(e){return Object(a.every)(e,(function(e){return Object(a.isEmpty)(e.categoryMatches)}))}))}))}},function(e,t,r){"use strict";r.r(t),r.d(t,"AbstractNextPossibleTokensWalker",(function(){return c})),r.d(t,"NextAfterTokenWalker",(function(){return l})),r.d(t,"AbstractNextTerminalAfterProductionWalker",(function(){return h})),r.d(t,"NextTerminalAfterManyWalker",(function(){return p})),r.d(t,"NextTerminalAfterManySepWalker",(function(){return f})),r.d(t,"NextTerminalAfterAtLeastOneWalker",(function(){return d})),r.d(t,"NextTerminalAfterAtLeastOneSepWalker",(function(){return m})),r.d(t,"possiblePathsFrom",(function(){return y})),r.d(t,"nextPossibleTokensAfter",(function(){return g}));var n,i=r(160),a=r(158),o=r(170),s=r(161),u=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),c=function(e){function t(t,r){var n=e.call(this)||this;return n.topProd=t,n.path=r,n.possibleTokTypes=[],n.nextProductionName="",n.nextProductionOccurrence=0,n.found=!1,n.isAtEndOfPath=!1,n}return u(t,e),t.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=Object(a.cloneArr)(this.path.ruleStack).reverse(),this.occurrenceStack=Object(a.cloneArr)(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},t.prototype.walk=function(t,r){void 0===r&&(r=[]),this.found||e.prototype.walk.call(this,t,r)},t.prototype.walkProdRef=function(e,t,r){if(e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence){var n=t.concat(r);this.updateExpectedNext(),this.walk(e.referencedRule,n)}},t.prototype.updateExpectedNext=function(){Object(a.isEmpty)(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},t}(i.RestWalker),l=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.path=r,n.nextTerminalName="",n.nextTerminalOccurrence=0,n.nextTerminalName=n.path.lastTok.name,n.nextTerminalOccurrence=n.path.lastTokOccurrence,n}return u(t,e),t.prototype.walkTerminal=function(e,t,r){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){var n=t.concat(r),i=new s.Flat({definition:n});this.possibleTokTypes=Object(o.first)(i),this.found=!0}},t}(c),h=function(e){function t(t,r){var n=e.call(this)||this;return n.topRule=t,n.occurrence=r,n.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},n}return u(t,e),t.prototype.startWalking=function(){return this.walk(this.topRule),this.result},t}(i.RestWalker),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.walkMany=function(t,r,n){if(t.idx===this.occurrence){var i=Object(a.first)(r.concat(n));this.result.isEndOfRule=void 0===i,i instanceof s.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkMany.call(this,t,r,n)},t}(h),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.walkManySep=function(t,r,n){if(t.idx===this.occurrence){var i=Object(a.first)(r.concat(n));this.result.isEndOfRule=void 0===i,i instanceof s.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkManySep.call(this,t,r,n)},t}(h),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.walkAtLeastOne=function(t,r,n){if(t.idx===this.occurrence){var i=Object(a.first)(r.concat(n));this.result.isEndOfRule=void 0===i,i instanceof s.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkAtLeastOne.call(this,t,r,n)},t}(h),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.walkAtLeastOneSep=function(t,r,n){if(t.idx===this.occurrence){var i=Object(a.first)(r.concat(n));this.result.isEndOfRule=void 0===i,i instanceof s.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkAtLeastOneSep.call(this,t,r,n)},t}(h);function y(e,t,r){void 0===r&&(r=[]),r=Object(a.cloneArr)(r);var n=[],i=0;function o(o){var s=y(o.concat(Object(a.drop)(e,i+1)),t,r);return n.concat(s)}for(;r.length<t&&i<e.length;){var u=e[i];if(u instanceof s.Flat)return o(u.definition);if(u instanceof s.NonTerminal)return o(u.definition);if(u instanceof s.Option)n=o(u.definition);else{if(u instanceof s.RepetitionMandatory)return o(c=u.definition.concat([new s.Repetition({definition:u.definition})]));if(u instanceof s.RepetitionMandatoryWithSeparator)return o(c=[new s.Flat({definition:u.definition}),new s.Repetition({definition:[new s.Terminal({terminalType:u.separator})].concat(u.definition)})]);if(u instanceof s.RepetitionWithSeparator){var c=u.definition.concat([new s.Repetition({definition:[new s.Terminal({terminalType:u.separator})].concat(u.definition)})]);n=o(c)}else if(u instanceof s.Repetition)c=u.definition.concat([new s.Repetition({definition:u.definition})]),n=o(c);else{if(u instanceof s.Alternation)return Object(a.forEach)(u.definition,(function(e){n=o(e.definition)})),n;if(!(u instanceof s.Terminal))throw Error("non exhaustive match");r.push(u.terminalType)}}i++}return n.push({partialPath:r,suffixDef:Object(a.drop)(e,i)}),n}function g(e,t,r,n){var i=["EXIT_NONE_TERMINAL"],o=!1,u=t.length,c=u-n-1,l=[],h=[];for(h.push({idx:-1,def:e,ruleStack:[],occurrenceStack:[]});!Object(a.isEmpty)(h);){var p=h.pop();if("EXIT_ALTERNATIVE"!==p){var f=p.def,d=p.idx,m=p.ruleStack,y=p.occurrenceStack;if(!Object(a.isEmpty)(f)){var g=f[0];if("EXIT_NONE_TERMINAL"===g){var E={idx:d,def:Object(a.drop)(f),ruleStack:Object(a.dropRight)(m),occurrenceStack:Object(a.dropRight)(y)};h.push(E)}else if(g instanceof s.Terminal)if(d<u-1){var T=d+1;r(t[T],g.terminalType)&&(E={idx:T,def:Object(a.drop)(f),ruleStack:m,occurrenceStack:y},h.push(E))}else{if(d!==u-1)throw Error("non exhaustive match");l.push({nextTokenType:g.terminalType,nextTokenOccurrence:g.idx,ruleStack:m,occurrenceStack:y}),o=!0}else if(g instanceof s.NonTerminal){var b=Object(a.cloneArr)(m);b.push(g.nonTerminalName);var x=Object(a.cloneArr)(y);x.push(g.idx),E={idx:d,def:g.definition.concat(i,Object(a.drop)(f)),ruleStack:b,occurrenceStack:x},h.push(E)}else if(g instanceof s.Option){var A={idx:d,def:Object(a.drop)(f),ruleStack:m,occurrenceStack:y};h.push(A),h.push("EXIT_ALTERNATIVE");var S={idx:d,def:g.definition.concat(Object(a.drop)(f)),ruleStack:m,occurrenceStack:y};h.push(S)}else if(g instanceof s.RepetitionMandatory){var R=new s.Repetition({definition:g.definition,idx:g.idx});E={idx:d,def:g.definition.concat([R],Object(a.drop)(f)),ruleStack:m,occurrenceStack:y},h.push(E)}else if(g instanceof s.RepetitionMandatoryWithSeparator){var w=new s.Terminal({terminalType:g.separator});R=new s.Repetition({definition:[w].concat(g.definition),idx:g.idx}),E={idx:d,def:g.definition.concat([R],Object(a.drop)(f)),ruleStack:m,occurrenceStack:y},h.push(E)}else if(g instanceof s.RepetitionWithSeparator){A={idx:d,def:Object(a.drop)(f),ruleStack:m,occurrenceStack:y},h.push(A),h.push("EXIT_ALTERNATIVE"),w=new s.Terminal({terminalType:g.separator});var C=new s.Repetition({definition:[w].concat(g.definition),idx:g.idx});S={idx:d,def:g.definition.concat([C],Object(a.drop)(f)),ruleStack:m,occurrenceStack:y},h.push(S)}else if(g instanceof s.Repetition)A={idx:d,def:Object(a.drop)(f),ruleStack:m,occurrenceStack:y},h.push(A),h.push("EXIT_ALTERNATIVE"),C=new s.Repetition({definition:g.definition,idx:g.idx}),S={idx:d,def:g.definition.concat([C],Object(a.drop)(f)),ruleStack:m,occurrenceStack:y},h.push(S);else if(g instanceof s.Alternation)for(var O=g.definition.length-1;O>=0;O--){var k={idx:d,def:g.definition[O].definition.concat(Object(a.drop)(f)),ruleStack:m,occurrenceStack:y};h.push(k),h.push("EXIT_ALTERNATIVE")}else if(g instanceof s.Flat)h.push({idx:d,def:g.definition.concat(Object(a.drop)(f)),ruleStack:m,occurrenceStack:y});else{if(!(g instanceof s.Rule))throw Error("non exhaustive match");h.push(v(g,d,m,y))}}}else o&&Object(a.last)(h).idx<=c&&h.pop()}return l}function v(e,t,r,n){var i=Object(a.cloneArr)(r);i.push(e.name);var o=Object(a.cloneArr)(n);return o.push(1),{idx:t,def:e.definition,ruleStack:i,occurrenceStack:o}}},function(e,t,r){"use strict";r.r(t),r.d(t,"resolveGrammar",(function(){return u})),r.d(t,"validateGrammar",(function(){return c})),r.d(t,"assignOccurrenceIndices",(function(){return l}));var n=r(158),i=r(181),a=r(177),o=r(176),s=r(171);function u(e){e=Object(n.defaults)(e,{errMsgProvider:o.defaultGrammarResolverErrorProvider});var t={};return Object(n.forEach)(e.rules,(function(e){t[e.name]=e})),Object(i.resolveGrammar)(t,e.errMsgProvider)}function c(e){return e=Object(n.defaults)(e,{errMsgProvider:o.defaultGrammarValidatorErrorProvider,ignoredIssues:{}}),Object(a.validateGrammar)(e.rules,e.maxLookahead,e.tokenTypes,e.ignoredIssues,e.errMsgProvider,e.grammarName)}function l(e){Object(n.forEach)(e.rules,(function(e){var t=new s.DslMethodsCollectorVisitor;e.accept(t),Object(n.forEach)(t.dslMethods,(function(e){Object(n.forEach)(e,(function(e,t){e.idx=t+1}))}))}))}},function(e,t,r){"use strict";r.r(t),r.d(t,"resolveGrammar",(function(){return u})),r.d(t,"GastRefResolverVisitor",(function(){return c}));var n,i=r(157),a=r(158),o=r(172),s=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function u(e,t){var r=new c(e,t);return r.resolveRefs(),r.errors}var c=function(e){function t(t,r){var n=e.call(this)||this;return n.nameToTopRule=t,n.errMsgProvider=r,n.errors=[],n}return s(t,e),t.prototype.resolveRefs=function(){var e=this;Object(a.forEach)(Object(a.values)(this.nameToTopRule),(function(t){e.currTopLevel=t,t.accept(e)}))},t.prototype.visitNonTerminal=function(e){var t=this.nameToTopRule[e.nonTerminalName];if(t)e.referencedRule=t;else{var r=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:r,type:i.ParserDefinitionErrorType.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}},t}(o.GAstVisitor)},function(e,t,r){"use strict";r.r(t),r.d(t,"EOF_FOLLOW_KEY",(function(){return u})),r.d(t,"IN_RULE_RECOVERY_EXCEPTION",(function(){return c})),r.d(t,"InRuleRecoveryException",(function(){return l})),r.d(t,"Recoverable",(function(){return h})),r.d(t,"attemptInRepetitionRecovery",(function(){return p}));var n=r(162),i=r(158),a=r(183),o=r(173),s=r(157),u={},c="InRuleRecoveryException";function l(e){this.name=c,this.message=e}l.prototype=Error.prototype;var h=function(){function e(){}return e.prototype.initRecoverable=function(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=Object(i.has)(e,"recoveryEnabled")?e.recoveryEnabled:s.DEFAULT_PARSER_CONFIG.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=p)},e.prototype.getTokenToInsert=function(e){var t=Object(n.createTokenInstance)(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return t.isInsertedInRecovery=!0,t},e.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},e.prototype.tryInRepetitionRecovery=function(e,t,r,n){for(var o=this,s=this.findReSyncTokenType(),u=this.exportLexerState(),c=[],l=!1,h=this.LA(1),p=this.LA(1),f=function(){var e=o.LA(0),t=o.errorMessageProvider.buildMismatchTokenMessage({expected:n,actual:h,previous:e,ruleName:o.getCurrRuleFullName()}),r=new a.MismatchedTokenException(t,h,o.LA(0));r.resyncedTokens=Object(i.dropRight)(c),o.SAVE_ERROR(r)};!l;){if(this.tokenMatcher(p,n))return void f();if(r.call(this))return f(),void e.apply(this,t);this.tokenMatcher(p,s)?l=!0:(p=this.SKIP_TOKEN(),this.addToResyncTokens(p,c))}this.importLexerState(u)},e.prototype.shouldInRepetitionRecoveryBeTried=function(e,t,r){return!1!==r&&void 0!==e&&void 0!==t&&!this.tokenMatcher(this.LA(1),e)&&!this.isBackTracking()&&!this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t))},e.prototype.getFollowsForInRuleRecovery=function(e,t){var r=this.getCurrentGrammarPath(e,t);return this.getNextPossibleTokenTypes(r)},e.prototype.tryInRuleRecovery=function(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t))return this.getTokenToInsert(e);if(this.canRecoverWithSingleTokenDeletion(e)){var r=this.SKIP_TOKEN();return this.consumeToken(),r}throw new l("sad sad panda")},e.prototype.canPerformInRuleRecovery=function(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)},e.prototype.canRecoverWithSingleTokenInsertion=function(e,t){var r=this;if(!this.canTokenTypeBeInsertedInRecovery(e))return!1;if(Object(i.isEmpty)(t))return!1;var n=this.LA(1);return void 0!==Object(i.find)(t,(function(e){return r.tokenMatcher(n,e)}))},e.prototype.canRecoverWithSingleTokenDeletion=function(e){return this.tokenMatcher(this.LA(2),e)},e.prototype.isInCurrentRuleReSyncSet=function(e){var t=this.getCurrFollowKey(),r=this.getFollowSetFromFollowKey(t);return Object(i.contains)(r,e)},e.prototype.findReSyncTokenType=function(){for(var e=this.flattenFollowSet(),t=this.LA(1),r=2;;){var n=t.tokenType;if(Object(i.contains)(e,n))return n;t=this.LA(r),r++}},e.prototype.getCurrFollowKey=function(){if(1===this.RULE_STACK.length)return u;var e=this.getLastExplicitRuleShortName(),t=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(r)}},e.prototype.buildFullFollowKeyStack=function(){var e=this,t=this.RULE_STACK,r=this.RULE_OCCURRENCE_STACK;return Object(i.isEmpty)(this.LAST_EXPLICIT_RULE_STACK)||(t=Object(i.map)(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.RULE_STACK[t]})),r=Object(i.map)(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.RULE_OCCURRENCE_STACK[t]}))),Object(i.map)(t,(function(n,i){return 0===i?u:{ruleName:e.shortRuleNameToFullName(n),idxInCallingRule:r[i],inRule:e.shortRuleNameToFullName(t[i-1])}}))},e.prototype.flattenFollowSet=function(){var e=this,t=Object(i.map)(this.buildFullFollowKeyStack(),(function(t){return e.getFollowSetFromFollowKey(t)}));return Object(i.flatten)(t)},e.prototype.getFollowSetFromFollowKey=function(e){if(e===u)return[n.EOF];var t=e.ruleName+e.idxInCallingRule+o.IN+e.inRule;return this.resyncFollows[t]},e.prototype.addToResyncTokens=function(e,t){return this.tokenMatcher(e,n.EOF)||t.push(e),t},e.prototype.reSyncTo=function(e){for(var t=[],r=this.LA(1);!1===this.tokenMatcher(r,e);)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,t);return Object(i.dropRight)(t)},e.prototype.attemptInRepetitionRecovery=function(e,t,r,n,i,a,o){},e.prototype.getCurrentGrammarPath=function(e,t){return{ruleStack:this.getHumanReadableRuleStack(),occurrenceStack:Object(i.cloneArr)(this.RULE_OCCURRENCE_STACK),lastTok:e,lastTokOccurrence:t}},e.prototype.getHumanReadableRuleStack=function(){var e=this;return Object(i.isEmpty)(this.LAST_EXPLICIT_RULE_STACK)?Object(i.map)(this.RULE_STACK,(function(t){return e.shortRuleNameToFullName(t)})):Object(i.map)(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.shortRuleNameToFullName(e.RULE_STACK[t])}))},e}();function p(e,t,r,i,a,o,s){var u=this.getKeyForAutomaticLookahead(i,a),c=this.firstAfterRepMap[u];if(void 0===c){var l=this.getCurrRuleFullName();c=new o(this.getGAstProductions()[l],a).startWalking(),this.firstAfterRepMap[u]=c}var h=c.token,p=c.occurrence,f=c.isEndOfRule;1===this.RULE_STACK.length&&f&&void 0===h&&(h=n.EOF,p=1),this.shouldInRepetitionRecoveryBeTried(h,p,s)&&this.tryInRepetitionRecovery(e,t,r,h)}},function(e,t,r){"use strict";r.r(t),r.d(t,"isRecognitionException",(function(){return a})),r.d(t,"MismatchedTokenException",(function(){return o})),r.d(t,"NoViableAltException",(function(){return s})),r.d(t,"NotAllInputParsedException",(function(){return u})),r.d(t,"EarlyExitException",(function(){return c}));var n=r(158),i=["MismatchedTokenException","NoViableAltException","EarlyExitException","NotAllInputParsedException"];function a(e){return Object(n.contains)(i,e.name)}function o(e,t,r){this.name="MismatchedTokenException",this.message=e,this.token=t,this.previousToken=r,this.resyncedTokens=[]}function s(e,t,r){this.name="NoViableAltException",this.message=e,this.token=t,this.previousToken=r,this.resyncedTokens=[]}function u(e,t){this.name="NotAllInputParsedException",this.message=e,this.token=t,this.resyncedTokens=[]}function c(e,t,r){this.name="EarlyExitException",this.message=e,this.token=t,this.previousToken=r,this.resyncedTokens=[]}Object.freeze(i),o.prototype=Error.prototype,s.prototype=Error.prototype,u.prototype=Error.prototype,c.prototype=Error.prototype},function(e,t,r){"use strict";r.r(t),r.d(t,"LooksAhead",(function(){return u}));var n=r(178),i=r(158),a=r(157),o=r(175),s=r(171),u=function(){function e(){}return e.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=Object(i.has)(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:a.DEFAULT_PARSER_CONFIG.dynamicTokensEnabled,this.maxLookahead=Object(i.has)(e,"maxLookahead")?e.maxLookahead:a.DEFAULT_PARSER_CONFIG.maxLookahead,this.lookAheadFuncsCache=Object(i.isES2015MapSupported)()?new Map:[],Object(i.isES2015MapSupported)()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},e.prototype.preComputeLookaheadFunctions=function(e){var t=this;Object(i.forEach)(e,(function(e){t.TRACE_INIT(e.name+" Rule Lookahead",(function(){var r=Object(s.collectMethods)(e),a=r.alternation,u=r.repetition,c=r.option,l=r.repetitionMandatory,h=r.repetitionMandatoryWithSeparator,p=r.repetitionWithSeparator;Object(i.forEach)(a,(function(r){var i=0===r.idx?"":r.idx;t.TRACE_INIT(""+Object(s.getProductionDslName)(r)+i,(function(){var i=Object(n.buildLookaheadFuncForOr)(r.idx,e,r.maxLookahead||t.maxLookahead,r.hasPredicates,t.dynamicTokensEnabled,t.lookAheadBuilderForAlternatives),a=Object(o.getKeyForAutomaticLookahead)(t.fullRuleNameToShort[e.name],o.OR_IDX,r.idx);t.setLaFuncCache(a,i)}))})),Object(i.forEach)(u,(function(r){t.computeLookaheadFunc(e,r.idx,o.MANY_IDX,n.PROD_TYPE.REPETITION,r.maxLookahead,Object(s.getProductionDslName)(r))})),Object(i.forEach)(c,(function(r){t.computeLookaheadFunc(e,r.idx,o.OPTION_IDX,n.PROD_TYPE.OPTION,r.maxLookahead,Object(s.getProductionDslName)(r))})),Object(i.forEach)(l,(function(r){t.computeLookaheadFunc(e,r.idx,o.AT_LEAST_ONE_IDX,n.PROD_TYPE.REPETITION_MANDATORY,r.maxLookahead,Object(s.getProductionDslName)(r))})),Object(i.forEach)(h,(function(r){t.computeLookaheadFunc(e,r.idx,o.AT_LEAST_ONE_SEP_IDX,n.PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,r.maxLookahead,Object(s.getProductionDslName)(r))})),Object(i.forEach)(p,(function(r){t.computeLookaheadFunc(e,r.idx,o.MANY_SEP_IDX,n.PROD_TYPE.REPETITION_WITH_SEPARATOR,r.maxLookahead,Object(s.getProductionDslName)(r))}))}))}))},e.prototype.computeLookaheadFunc=function(e,t,r,i,a,s){var u=this;this.TRACE_INIT(""+s+(0===t?"":t),(function(){var s=Object(n.buildLookaheadFuncForOptionalProd)(t,e,a||u.maxLookahead,u.dynamicTokensEnabled,i,u.lookAheadBuilderForOptional),c=Object(o.getKeyForAutomaticLookahead)(u.fullRuleNameToShort[e.name],r,t);u.setLaFuncCache(c,s)}))},e.prototype.lookAheadBuilderForOptional=function(e,t,r){return Object(n.buildSingleAlternativeLookaheadFunction)(e,t,r)},e.prototype.lookAheadBuilderForAlternatives=function(e,t,r,i){return Object(n.buildAlternativesLookAheadFunc)(e,t,r,i)},e.prototype.getKeyForAutomaticLookahead=function(e,t){var r=this.getLastExplicitRuleShortName();return Object(o.getKeyForAutomaticLookahead)(r,e,t)},e.prototype.getLaFuncFromCache=function(e){},e.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},e.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},e.prototype.setLaFuncCache=function(e,t){},e.prototype.setLaFuncCacheUsingMap=function(e,t){this.lookAheadFuncsCache.set(e,t)},e.prototype.setLaFuncUsingObj=function(e,t){this.lookAheadFuncsCache[e]=t},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"TreeBuilder",(function(){return u}));var n=r(174),i=r(158),a=r(186),o=r(175),s=r(157),u=function(){function e(){}return e.prototype.initTreeBuilder=function(e){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=Object(i.has)(e,"outputCst")?e.outputCst:s.DEFAULT_PARSER_CONFIG.outputCst,this.nodeLocationTracking=Object(i.has)(e,"nodeLocationTracking")?e.nodeLocationTracking:s.DEFAULT_PARSER_CONFIG.nodeLocationTracking,this.outputCst)if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=n.setNodeLocationFull,this.setNodeLocationFromNode=n.setNodeLocationFull,this.cstPostRule=i.NOOP,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=i.NOOP,this.setNodeLocationFromNode=i.NOOP,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=n.setNodeLocationOnlyOffset,this.setNodeLocationFromNode=n.setNodeLocationOnlyOffset,this.cstPostRule=i.NOOP,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=i.NOOP,this.setNodeLocationFromNode=i.NOOP,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else{if(!/none/i.test(this.nodeLocationTracking))throw Error('Invalid <nodeLocationTracking> config option: "'+e.nodeLocationTracking+'"');this.setNodeLocationFromToken=i.NOOP,this.setNodeLocationFromNode=i.NOOP,this.cstPostRule=i.NOOP,this.setInitialNodeLocation=i.NOOP}else this.cstInvocationStateUpdate=i.NOOP,this.cstFinallyStateUpdate=i.NOOP,this.cstPostTerminal=i.NOOP,this.cstPostNonTerminal=i.NOOP,this.cstPostRule=i.NOOP,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst},e.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},e.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},e.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.setInitialNodeLocationFullRegular=function(e){var t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.cstNestedInvocationStateUpdate=function(e,t){var r={name:e,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+e,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},e.prototype.cstInvocationStateUpdate=function(e,t){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);var r={name:e,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},e.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},e.prototype.cstNestedFinallyStateUpdate=function(){var e=this.CST_STACK.pop();this.cstPostRule(e)},e.prototype.cstPostRuleFull=function(e){var t=this.LA(0),r=e.location;r.startOffset<=t.startOffset==1?(r.endOffset=t.endOffset,r.endLine=t.endLine,r.endColumn=t.endColumn):(r.startOffset=NaN,r.startLine=NaN,r.startColumn=NaN)},e.prototype.cstPostRuleOnlyOffset=function(e){var t=this.LA(0),r=e.location;r.startOffset<=t.startOffset==1?r.endOffset=t.endOffset:r.startOffset=NaN},e.prototype.cstPostTerminal=function(e,t){var r=this.CST_STACK[this.CST_STACK.length-1];Object(n.addTerminalToCst)(r,t,e),this.setNodeLocationFromToken(r.location,t)},e.prototype.cstPostNonTerminal=function(e,t){if(!0!==this.isBackTracking()){var r=this.CST_STACK[this.CST_STACK.length-1];Object(n.addNoneTerminalToCst)(r,t,e),this.setNodeLocationFromNode(r.location,e.location)}},e.prototype.getBaseCstVisitorConstructor=function(){if(Object(i.isUndefined)(this.baseCstVisitorConstructor)){var e=Object(a.createBaseSemanticVisitorConstructor)(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor},e.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(Object(i.isUndefined)(this.baseCstVisitorWithDefaultsConstructor)){var e=Object(a.createBaseVisitorConstructorWithDefaults)(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor},e.prototype.nestedRuleBeforeClause=function(e,t){var r;return void 0!==e.NAME?(r=e.NAME,this.nestedRuleInvocationStateUpdate(r,t),r):void 0},e.prototype.nestedAltBeforeClause=function(e,t,r,n){var i,a=this.getLastExplicitRuleShortName(),s=Object(o.getKeyForAltIndex)(a,r,t,n);return void 0!==e.NAME?(i=e.NAME,this.nestedRuleInvocationStateUpdate(i,s),{shortName:s,nestedName:i}):void 0},e.prototype.nestedRuleFinallyClause=function(e,t){var r=this.CST_STACK,i=r[r.length-1];this.nestedRuleFinallyStateUpdate();var a=r[r.length-1];Object(n.addNoneTerminalToCst)(a,t,i),this.setNodeLocationFromNode(a.location,i.location)},e.prototype.getLastExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[e]},e.prototype.getLastExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-1]},e.prototype.getPreviousExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[e]},e.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-2]},e.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[e]},e.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},e.prototype.nestedRuleInvocationStateUpdate=function(e,t){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(t),this.cstNestedInvocationStateUpdate(e,t)},e.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"defaultVisit",(function(){return s})),r.d(t,"createBaseSemanticVisitorConstructor",(function(){return u})),r.d(t,"createBaseVisitorConstructorWithDefaults",(function(){return c})),r.d(t,"CstVisitorDefinitionError",(function(){return n})),r.d(t,"validateVisitor",(function(){return l})),r.d(t,"validateMissingCstMethods",(function(){return h})),r.d(t,"validateRedundantMethods",(function(){return f}));var n,i=r(158),a=r(187),o=r(177);function s(e,t){for(var r=Object(i.keys)(e),n=r.length,a=0;a<n;a++)for(var o=e[r[a]],s=o.length,u=0;u<s;u++){var c=o[u];void 0===c.tokenTypeIdx&&(void 0!==c.fullName?this[c.fullName](c.children,t):this[c.name](c.children,t))}}function u(e,t){var r=function(){};return Object(a.defineNameProp)(r,e+"BaseSemantics"),(r.prototype={visit:function(e,t){if(Object(i.isArray)(e)&&(e=e[0]),!Object(i.isUndefined)(e))return void 0!==e.fullName?this[e.fullName](e.children,t):this[e.name](e.children,t)},validateVisitor:function(){var e=l(this,t);if(!Object(i.isEmpty)(e)){var r=Object(i.map)(e,(function(e){return e.msg}));throw Error("Errors Detected in CST Visitor <"+Object(a.functionName)(this.constructor)+">:\n\t"+r.join("\n\n").replace(/\n/g,"\n\t"))}}}).constructor=r,r._RULE_NAMES=t,r}function c(e,t,r){var n=function(){};Object(a.defineNameProp)(n,e+"BaseSemanticsWithDefaults");var o=Object.create(r.prototype);return Object(i.forEach)(t,(function(e){o[e]=s})),(n.prototype=o).constructor=n,n}function l(e,t){var r=h(e,t),n=f(e,t);return r.concat(n)}function h(e,t){var r=Object(i.map)(t,(function(t){if(!Object(i.isFunction)(e[t]))return{msg:"Missing visitor method: <"+t+"> on "+Object(a.functionName)(e.constructor)+" CST Visitor.",type:n.MISSING_METHOD,methodName:t}}));return Object(i.compact)(r)}!function(e){e[e.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",e[e.MISSING_METHOD=1]="MISSING_METHOD"}(n||(n={}));var p=["constructor","visit","validateVisitor"];function f(e,t){var r=[];for(var s in e)o.validTermsPattern.test(s)&&Object(i.isFunction)(e[s])&&!Object(i.contains)(p,s)&&!Object(i.contains)(t,s)&&r.push({msg:"Redundant visitor method: <"+s+"> on "+Object(a.functionName)(e.constructor)+" CST Visitor\nThere is no Grammar Rule corresponding to this method's name.\nFor utility methods on visitor classes use methods names that do not match /"+o.validTermsPattern.source+"/.",type:n.REDUNDANT_METHOD,methodName:s});return r}},function(e,t,r){"use strict";r.r(t),r.d(t,"classNameFromInstance",(function(){return i})),r.d(t,"functionName",(function(){return o})),r.d(t,"defineNameProp",(function(){return s}));var n=r(158);function i(e){return o(e.constructor)}var a=/^\s*function\s*(\S*)\s*\(/;function o(e){var t=e.name;return t||e.toString().match(a)[1]}function s(e,t){var r=Object.getOwnPropertyDescriptor(e,"name");return!(!Object(n.isUndefined)(r)&&!r.configurable||(Object.defineProperty(e,"name",{enumerable:!1,configurable:!0,writable:!1,value:t}),0))}},function(e,t,r){"use strict";r.r(t),r.d(t,"LexerAdapter",(function(){return i}));var n=r(157),i=function(){function e(){}return e.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(e.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(!0!==this.selfAnalysisDone)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!0,configurable:!0}),e.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):n.END_OF_FILE},e.prototype.LA=function(e){var t=this.currIdx+e;return t<0||this.tokVectorLength<=t?n.END_OF_FILE:this.tokVector[t]},e.prototype.consumeToken=function(){this.currIdx++},e.prototype.exportLexerState=function(){return this.currIdx},e.prototype.importLexerState=function(e){this.currIdx=e},e.prototype.resetLexerState=function(){this.currIdx=-1},e.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},e.prototype.getLexerPosition=function(){return this.exportLexerState()},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"RecognizerApi",(function(){return c}));var n=r(158),i=r(183),a=r(157),o=r(176),s=r(177),u=r(161),c=function(){function e(){}return e.prototype.ACTION=function(e){return e.call(this)},e.prototype.consume=function(e,t,r){return this.consumeInternal(t,e,r)},e.prototype.subrule=function(e,t,r){return this.subruleInternal(t,e,r)},e.prototype.option=function(e,t){return this.optionInternal(t,e)},e.prototype.or=function(e,t){return this.orInternal(t,e)},e.prototype.many=function(e,t){return this.manyInternal(e,t)},e.prototype.atLeastOne=function(e,t){return this.atLeastOneInternal(e,t)},e.prototype.CONSUME=function(e,t){return this.consumeInternal(e,0,t)},e.prototype.CONSUME1=function(e,t){return this.consumeInternal(e,1,t)},e.prototype.CONSUME2=function(e,t){return this.consumeInternal(e,2,t)},e.prototype.CONSUME3=function(e,t){return this.consumeInternal(e,3,t)},e.prototype.CONSUME4=function(e,t){return this.consumeInternal(e,4,t)},e.prototype.CONSUME5=function(e,t){return this.consumeInternal(e,5,t)},e.prototype.CONSUME6=function(e,t){return this.consumeInternal(e,6,t)},e.prototype.CONSUME7=function(e,t){return this.consumeInternal(e,7,t)},e.prototype.CONSUME8=function(e,t){return this.consumeInternal(e,8,t)},e.prototype.CONSUME9=function(e,t){return this.consumeInternal(e,9,t)},e.prototype.SUBRULE=function(e,t){return this.subruleInternal(e,0,t)},e.prototype.SUBRULE1=function(e,t){return this.subruleInternal(e,1,t)},e.prototype.SUBRULE2=function(e,t){return this.subruleInternal(e,2,t)},e.prototype.SUBRULE3=function(e,t){return this.subruleInternal(e,3,t)},e.prototype.SUBRULE4=function(e,t){return this.subruleInternal(e,4,t)},e.prototype.SUBRULE5=function(e,t){return this.subruleInternal(e,5,t)},e.prototype.SUBRULE6=function(e,t){return this.subruleInternal(e,6,t)},e.prototype.SUBRULE7=function(e,t){return this.subruleInternal(e,7,t)},e.prototype.SUBRULE8=function(e,t){return this.subruleInternal(e,8,t)},e.prototype.SUBRULE9=function(e,t){return this.subruleInternal(e,9,t)},e.prototype.OPTION=function(e){return this.optionInternal(e,0)},e.prototype.OPTION1=function(e){return this.optionInternal(e,1)},e.prototype.OPTION2=function(e){return this.optionInternal(e,2)},e.prototype.OPTION3=function(e){return this.optionInternal(e,3)},e.prototype.OPTION4=function(e){return this.optionInternal(e,4)},e.prototype.OPTION5=function(e){return this.optionInternal(e,5)},e.prototype.OPTION6=function(e){return this.optionInternal(e,6)},e.prototype.OPTION7=function(e){return this.optionInternal(e,7)},e.prototype.OPTION8=function(e){return this.optionInternal(e,8)},e.prototype.OPTION9=function(e){return this.optionInternal(e,9)},e.prototype.OR=function(e){return this.orInternal(e,0)},e.prototype.OR1=function(e){return this.orInternal(e,1)},e.prototype.OR2=function(e){return this.orInternal(e,2)},e.prototype.OR3=function(e){return this.orInternal(e,3)},e.prototype.OR4=function(e){return this.orInternal(e,4)},e.prototype.OR5=function(e){return this.orInternal(e,5)},e.prototype.OR6=function(e){return this.orInternal(e,6)},e.prototype.OR7=function(e){return this.orInternal(e,7)},e.prototype.OR8=function(e){return this.orInternal(e,8)},e.prototype.OR9=function(e){return this.orInternal(e,9)},e.prototype.MANY=function(e){this.manyInternal(0,e)},e.prototype.MANY1=function(e){this.manyInternal(1,e)},e.prototype.MANY2=function(e){this.manyInternal(2,e)},e.prototype.MANY3=function(e){this.manyInternal(3,e)},e.prototype.MANY4=function(e){this.manyInternal(4,e)},e.prototype.MANY5=function(e){this.manyInternal(5,e)},e.prototype.MANY6=function(e){this.manyInternal(6,e)},e.prototype.MANY7=function(e){this.manyInternal(7,e)},e.prototype.MANY8=function(e){this.manyInternal(8,e)},e.prototype.MANY9=function(e){this.manyInternal(9,e)},e.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},e.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},e.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},e.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},e.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},e.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},e.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},e.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},e.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},e.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},e.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},e.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},e.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},e.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},e.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},e.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},e.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},e.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},e.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},e.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},e.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},e.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},e.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},e.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},e.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},e.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},e.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},e.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},e.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},e.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},e.prototype.RULE=function(e,t,r){if(void 0===r&&(r=a.DEFAULT_RULE_CONFIG),Object(n.contains)(this.definedRulesNames,e)){var i={message:o.defaultGrammarValidatorErrorProvider.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),type:a.ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(i)}this.definedRulesNames.push(e);var s=this.defineRule(e,t,r);return this[e]=s,s},e.prototype.OVERRIDE_RULE=function(e,t,r){void 0===r&&(r=a.DEFAULT_RULE_CONFIG);var n=[];n=n.concat(Object(s.validateRuleIsOverridden)(e,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,n);var i=this.defineRule(e,t,r);return this[e]=i,i},e.prototype.BACKTRACK=function(e,t){return function(){this.isBackTrackingStack.push(1);var r=this.saveRecogState();try{return e.apply(this,t),!0}catch(e){if(Object(i.isRecognitionException)(e))return!1;throw e}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}},e.prototype.getGAstProductions=function(){return this.gastProductionsCache},e.prototype.getSerializedGastProductions=function(){return Object(u.serializeGrammar)(Object(n.values)(this.gastProductionsCache))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"RecognizerEngine",(function(){return f}));var n=r(158),i=r(175),a=r(183),o=r(178),s=r(179),u=r(157),c=r(182),l=r(162),h=r(168),p=r(187),f=function(){function e(){}return e.prototype.initRecognizerEngine=function(e,t){if(this.className=Object(p.classNameFromInstance)(this),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=h.tokenStructuredMatcherNoCategories,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},Object(n.has)(t,"serializedGrammar"))throw Error("The Parser's configuration can no longer contain a <serializedGrammar> property.\n\tSee: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0\n\tFor Further details.");if(Object(n.isArray)(e)){if(Object(n.isEmpty)(e))throw Error("A Token Vocabulary cannot be empty.\n\tNote that the first argument for the parser constructor\n\tis no longer a Token vector (since v4.0).");if("number"==typeof e[0].startOffset)throw Error("The Parser constructor no longer accepts a token vector as the first argument.\n\tSee: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0\n\tFor Further details.")}if(Object(n.isArray)(e))this.tokensMap=Object(n.reduce)(e,(function(e,t){return e[t.name]=t,e}),{});else if(Object(n.has)(e,"modes")&&Object(n.every)(Object(n.flatten)(Object(n.values)(e.modes)),h.isTokenType)){var r=Object(n.flatten)(Object(n.values)(e.modes)),i=Object(n.uniq)(r);this.tokensMap=Object(n.reduce)(i,(function(e,t){return e[t.name]=t,e}),{})}else{if(!Object(n.isObject)(e))throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap=Object(n.cloneObj)(e)}this.tokensMap.EOF=l.EOF;var a=Object(n.every)(Object(n.values)(e),(function(e){return Object(n.isEmpty)(e.categoryMatches)}));this.tokenMatcher=a?h.tokenStructuredMatcherNoCategories:h.tokenStructuredMatcher,Object(h.augmentTokenTypes)(Object(n.values)(this.tokensMap))},e.prototype.defineRule=function(e,t,r){if(this.selfAnalysisDone)throw Error("Grammar rule <"+e+"> may not be defined after the 'performSelfAnalysis' method has been called'\nMake sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.");var a,o=Object(n.has)(r,"resyncEnabled")?r.resyncEnabled:u.DEFAULT_RULE_CONFIG.resyncEnabled,s=Object(n.has)(r,"recoveryValueFunc")?r.recoveryValueFunc:u.DEFAULT_RULE_CONFIG.recoveryValueFunc,c=this.ruleShortNameIdx<<i.BITS_FOR_METHOD_TYPE+i.BITS_FOR_OCCURRENCE_IDX;function l(e){try{if(!0===this.outputCst){t.apply(this,e);var r=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(r),r}return t.apply(this,e)}catch(e){return this.invokeRuleCatch(e,o,s)}finally{this.ruleFinallyStateUpdate()}}return this.ruleShortNameIdx++,this.shortRuleNameToFull[c]=e,this.fullRuleNameToShort[e]=c,(a=function(t,r){return void 0===t&&(t=0),this.ruleInvocationStateUpdate(c,e,t),l.call(this,r)}).ruleName=e,a.originalGrammarAction=t,a},e.prototype.invokeRuleCatch=function(e,t,r){var n=1===this.RULE_STACK.length,i=t&&!this.isBackTracking()&&this.recoveryEnabled;if(Object(a.isRecognitionException)(e)){var o=e;if(i){var s,u=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(u))return o.resyncedTokens=this.reSyncTo(u),this.outputCst?((s=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,s):r();throw this.outputCst&&((s=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,o.partialCstResult=s),o}if(n)return this.moveToTerminatedState(),r();throw o}throw e},e.prototype.optionInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(i.OPTION_IDX,t),n=this.nestedRuleBeforeClause(e,r);try{return this.optionInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.optionInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(i.OPTION_IDX,t);return this.optionInternalLogic(e,t,r)},e.prototype.optionInternalLogic=function(e,t,r){var n,i,a=this,o=this.getLaFuncFromCache(r);if(void 0!==e.DEF){if(n=e.DEF,void 0!==(i=e.GATE)){var s=o;o=function(){return i.call(a)&&s.call(a)}}}else n=e;if(!0===o.call(this))return n.call(this)},e.prototype.atLeastOneInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(i.AT_LEAST_ONE_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{return this.atLeastOneInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.atLeastOneInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(i.AT_LEAST_ONE_IDX,e);this.atLeastOneInternalLogic(e,t,r)},e.prototype.atLeastOneInternalLogic=function(e,t,r){var n,a,u=this,c=this.getLaFuncFromCache(r);if(void 0!==t.DEF){if(n=t.DEF,void 0!==(a=t.GATE)){var l=c;c=function(){return a.call(u)&&l.call(u)}}}else n=t;if(!0!==c.call(this))throw this.raiseEarlyExitException(e,o.PROD_TYPE.REPETITION_MANDATORY,t.ERR_MSG);for(var h=this.doSingleRepetition(n);!0===c.call(this)&&!0===h;)h=this.doSingleRepetition(n);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],c,i.AT_LEAST_ONE_IDX,e,s.NextTerminalAfterAtLeastOneWalker)},e.prototype.atLeastOneSepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(i.AT_LEAST_ONE_SEP_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{this.atLeastOneSepFirstInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.atLeastOneSepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(i.AT_LEAST_ONE_SEP_IDX,e);this.atLeastOneSepFirstInternalLogic(e,t,r)},e.prototype.atLeastOneSepFirstInternalLogic=function(e,t,r){var n=this,a=t.DEF,u=t.SEP;if(!0!==this.getLaFuncFromCache(r).call(this))throw this.raiseEarlyExitException(e,o.PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG);a.call(this);for(var c=function(){return n.tokenMatcher(n.LA(1),u)};!0===this.tokenMatcher(this.LA(1),u);)this.CONSUME(u),a.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,u,c,a,s.NextTerminalAfterAtLeastOneSepWalker],c,i.AT_LEAST_ONE_SEP_IDX,e,s.NextTerminalAfterAtLeastOneSepWalker)},e.prototype.manyInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(i.MANY_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{return this.manyInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.manyInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(i.MANY_IDX,e);return this.manyInternalLogic(e,t,r)},e.prototype.manyInternalLogic=function(e,t,r){var n,a,o=this,u=this.getLaFuncFromCache(r);if(void 0!==t.DEF){if(n=t.DEF,void 0!==(a=t.GATE)){var c=u;u=function(){return a.call(o)&&c.call(o)}}}else n=t;for(var l=!0;!0===u.call(this)&&!0===l;)l=this.doSingleRepetition(n);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],u,i.MANY_IDX,e,s.NextTerminalAfterManyWalker,l)},e.prototype.manySepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(i.MANY_SEP_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{this.manySepFirstInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.manySepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(i.MANY_SEP_IDX,e);this.manySepFirstInternalLogic(e,t,r)},e.prototype.manySepFirstInternalLogic=function(e,t,r){var n=this,a=t.DEF,o=t.SEP;if(!0===this.getLaFuncFromCache(r).call(this)){a.call(this);for(var u=function(){return n.tokenMatcher(n.LA(1),o)};!0===this.tokenMatcher(this.LA(1),o);)this.CONSUME(o),a.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,u,a,s.NextTerminalAfterManySepWalker],u,i.MANY_SEP_IDX,e,s.NextTerminalAfterManySepWalker)}},e.prototype.repetitionSepSecondInternal=function(e,t,r,n,a){for(;r();)this.CONSUME(t),n.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,r,n,a],r,i.AT_LEAST_ONE_SEP_IDX,e,a)},e.prototype.doSingleRepetition=function(e){var t=this.getLexerPosition();return e.call(this),this.getLexerPosition()>t},e.prototype.orInternalNoCst=function(e,t){var r=Object(n.isArray)(e)?e:e.DEF,a=this.getKeyForAutomaticLookahead(i.OR_IDX,t),o=this.getLaFuncFromCache(a).call(this,r);if(void 0!==o)return r[o].ALT.call(this);this.raiseNoAltException(t,e.ERR_MSG)},e.prototype.orInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(i.OR_IDX,t),a=this.nestedRuleBeforeClause(e,r);try{var o=Object(n.isArray)(e)?e:e.DEF,s=this.getLaFuncFromCache(r).call(this,o);if(void 0!==s){var u=o[s],c=this.nestedAltBeforeClause(u,t,i.OR_IDX,s);try{return u.ALT.call(this)}finally{void 0!==c&&this.nestedRuleFinallyClause(c.shortName,c.nestedName)}}this.raiseNoAltException(t,e.ERR_MSG)}finally{void 0!==a&&this.nestedRuleFinallyClause(r,a)}},e.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),0===this.RULE_STACK.length&&!1===this.isAtEndOfInput()){var e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new a.NotAllInputParsedException(t,e))}},e.prototype.subruleInternal=function(e,t,r){var n;try{var i=void 0!==r?r.ARGS:void 0;return n=e.call(this,t,i),this.cstPostNonTerminal(n,void 0!==r&&void 0!==r.LABEL?r.LABEL:e.ruleName),n}catch(t){this.subruleInternalError(t,r,e.ruleName)}},e.prototype.subruleInternalError=function(e,t,r){throw Object(a.isRecognitionException)(e)&&void 0!==e.partialCstResult&&(this.cstPostNonTerminal(e.partialCstResult,void 0!==t&&void 0!==t.LABEL?t.LABEL:r),delete e.partialCstResult),e},e.prototype.consumeInternal=function(e,t,r){var n;try{var i=this.LA(1);!0===this.tokenMatcher(i,e)?(this.consumeToken(),n=i):this.consumeInternalError(e,i,r)}catch(r){n=this.consumeInternalRecovery(e,t,r)}return this.cstPostTerminal(void 0!==r&&void 0!==r.LABEL?r.LABEL:e.name,n),n},e.prototype.consumeInternalError=function(e,t,r){var n,i=this.LA(0);throw n=void 0!==r&&r.ERR_MSG?r.ERR_MSG:this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:i,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new a.MismatchedTokenException(n,t,i))},e.prototype.consumeInternalRecovery=function(e,t,r){if(!this.recoveryEnabled||"MismatchedTokenException"!==r.name||this.isBackTracking())throw r;var n=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,n)}catch(e){throw e.name===c.IN_RULE_RECOVERY_EXCEPTION?r:e}},e.prototype.saveRecogState=function(){var e=this.errors,t=Object(n.cloneArr)(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},e.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},e.prototype.ruleInvocationStateUpdate=function(e,t,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t,e)},e.prototype.isBackTracking=function(){return 0!==this.isBackTrackingStack.length},e.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},e.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},e.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),l.EOF)},e.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"ErrorHandler",(function(){return s}));var n=r(183),i=r(158),a=r(178),o=r(157),s=function(){function e(){}return e.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=Object(i.defaults)(e.errorMessageProvider,o.DEFAULT_PARSER_CONFIG.errorMessageProvider)},e.prototype.SAVE_ERROR=function(e){if(Object(n.isRecognitionException)(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:Object(i.cloneArr)(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(e.prototype,"errors",{get:function(){return Object(i.cloneArr)(this._errors)},set:function(e){this._errors=e},enumerable:!0,configurable:!0}),e.prototype.raiseEarlyExitException=function(e,t,r){for(var i=this.getCurrRuleFullName(),o=this.getGAstProductions()[i],s=Object(a.getLookaheadPathsForOptionalProd)(e,o,t,this.maxLookahead)[0],u=[],c=1;c<=this.maxLookahead;c++)u.push(this.LA(c));var l=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:s,actual:u,previous:this.LA(0),customUserDescription:r,ruleName:i});throw this.SAVE_ERROR(new n.EarlyExitException(l,this.LA(1),this.LA(0)))},e.prototype.raiseNoAltException=function(e,t){for(var r=this.getCurrRuleFullName(),i=this.getGAstProductions()[r],o=Object(a.getLookaheadPathsForOr)(e,i,this.maxLookahead),s=[],u=1;u<=this.maxLookahead;u++)s.push(this.LA(u));var c=this.LA(0),l=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:o,actual:s,previous:c,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new n.NoViableAltException(l,this.LA(1),c))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"ContentAssist",(function(){return a}));var n=r(179),i=r(158),a=function(){function e(){}return e.prototype.initContentAssist=function(){},e.prototype.computeContentAssist=function(e,t){var r=this.gastProductionsCache[e];if(Object(i.isUndefined)(r))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return Object(n.nextPossibleTokensAfter)([r],t,this.tokenMatcher,this.maxLookahead)},e.prototype.getNextPossibleTokenTypes=function(e){var t=Object(i.first)(e.ruleStack),r=this.getGAstProductions()[t];return new n.NextAfterTokenWalker(r,e).startWalking()},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"GastRecorder",(function(){return m}));var n=r(158),i=r(161),a=r(163),o=r(168),s=r(162),u=r(157),c=r(175),l={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(l);var h=Math.pow(2,c.BITS_FOR_OCCURRENCE_IDX)-1,p=Object(s.createToken)({name:"RECORDING_PHASE_TOKEN",pattern:a.Lexer.NA});Object(o.augmentTokenTypes)([p]);var f=Object(s.createTokenInstance)(p,"This IToken indicates the Parser is in Recording Phase\n\tSee: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details",-1,-1,-1,-1,-1,-1);Object.freeze(f);var d={name:"This CSTNode indicates the Parser is in Recording Phase\n\tSee: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details",children:{}},m=function(){function e(){}return e.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},e.prototype.enableRecording=function(){var e=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",(function(){for(var t=function(t){var r=t>0?t:"";e["CONSUME"+r]=function(e,r){return this.consumeInternalRecord(e,t,r)},e["SUBRULE"+r]=function(e,r){return this.subruleInternalRecord(e,t,r)},e["OPTION"+r]=function(e){return this.optionInternalRecord(e,t)},e["OR"+r]=function(e){return this.orInternalRecord(e,t)},e["MANY"+r]=function(e){this.manyInternalRecord(t,e)},e["MANY_SEP"+r]=function(e){this.manySepFirstInternalRecord(t,e)},e["AT_LEAST_ONE"+r]=function(e){this.atLeastOneInternalRecord(t,e)},e["AT_LEAST_ONE_SEP"+r]=function(e){this.atLeastOneSepFirstInternalRecord(t,e)}},r=0;r<10;r++)t(r);e.consume=function(e,t,r){return this.consumeInternalRecord(t,e,r)},e.subrule=function(e,t,r){return this.subruleInternalRecord(t,e,r)},e.option=function(e,t){return this.optionInternalRecord(t,e)},e.or=function(e,t){return this.orInternalRecord(t,e)},e.many=function(e,t){this.manyInternalRecord(e,t)},e.atLeastOne=function(e,t){this.atLeastOneInternalRecord(e,t)},e.ACTION=e.ACTION_RECORD,e.BACKTRACK=e.BACKTRACK_RECORD,e.LA=e.LA_RECORD}))},e.prototype.disableRecording=function(){var e=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",(function(){for(var t=0;t<10;t++){var r=t>0?t:"";delete e["CONSUME"+r],delete e["SUBRULE"+r],delete e["OPTION"+r],delete e["OR"+r],delete e["MANY"+r],delete e["MANY_SEP"+r],delete e["AT_LEAST_ONE"+r],delete e["AT_LEAST_ONE_SEP"+r]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA}))},e.prototype.ACTION_RECORD=function(e){},e.prototype.BACKTRACK_RECORD=function(e,t){return function(){return!0}},e.prototype.LA_RECORD=function(e){return u.END_OF_FILE},e.prototype.topLevelRuleRecord=function(e,t){try{var r=new i.Rule({definition:[],name:e});return r.name=e,this.recordingProdStack.push(r),t.call(this),this.recordingProdStack.pop(),r}catch(e){if(!0!==e.KNOWN_RECORDER_ERROR)try{e.message=e.message+'\n\t This error was thrown during the "grammar recording phase" For more info see:\n\thttps://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording'}catch(t){throw e}throw e}},e.prototype.optionInternalRecord=function(e,t){return y.call(this,i.Option,e,t)},e.prototype.atLeastOneInternalRecord=function(e,t){y.call(this,i.RepetitionMandatory,t,e)},e.prototype.atLeastOneSepFirstInternalRecord=function(e,t){y.call(this,i.RepetitionMandatoryWithSeparator,t,e,!0)},e.prototype.manyInternalRecord=function(e,t){y.call(this,i.Repetition,t,e)},e.prototype.manySepFirstInternalRecord=function(e,t){y.call(this,i.RepetitionWithSeparator,t,e,!0)},e.prototype.orInternalRecord=function(e,t){return g.call(this,e,t)},e.prototype.subruleInternalRecord=function(e,t,r){if(E(t),!e||!1===Object(n.has)(e,"ruleName")){var a=new Error("<SUBRULE"+v(t)+"> argument is invalid expecting a Parser method reference but got: <"+JSON.stringify(e)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw a.KNOWN_RECORDER_ERROR=!0,a}var o=Object(n.peek)(this.recordingProdStack),s=e.ruleName,u=new i.NonTerminal({idx:t,nonTerminalName:s,referencedRule:void 0});return o.definition.push(u),this.outputCst?d:l},e.prototype.consumeInternalRecord=function(e,t,r){if(E(t),!Object(o.hasShortKeyProperty)(e)){var a=new Error("<CONSUME"+v(t)+"> argument is invalid expecting a TokenType reference but got: <"+JSON.stringify(e)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw a.KNOWN_RECORDER_ERROR=!0,a}var s=Object(n.peek)(this.recordingProdStack),u=new i.Terminal({idx:t,terminalType:e});return s.definition.push(u),f},e}();function y(e,t,r,i){void 0===i&&(i=!1),E(r);var a=Object(n.peek)(this.recordingProdStack),o=Object(n.isFunction)(t)?t:t.DEF,s=new e({definition:[],idx:r});return Object(n.has)(t,"NAME")&&(s.name=t.NAME),i&&(s.separator=t.SEP),Object(n.has)(t,"MAX_LOOKAHEAD")&&(s.maxLookahead=t.MAX_LOOKAHEAD),this.recordingProdStack.push(s),o.call(this),a.definition.push(s),this.recordingProdStack.pop(),l}function g(e,t){var r=this;E(t);var a=Object(n.peek)(this.recordingProdStack),o=!1===Object(n.isArray)(e),s=!1===o?e:e.DEF,u=new i.Alternation({definition:[],idx:t,ignoreAmbiguities:o&&!0===e.IGNORE_AMBIGUITIES});Object(n.has)(e,"NAME")&&(u.name=e.NAME),Object(n.has)(e,"MAX_LOOKAHEAD")&&(u.maxLookahead=e.MAX_LOOKAHEAD);var c=Object(n.some)(s,(function(e){return Object(n.isFunction)(e.GATE)}));return u.hasPredicates=c,a.definition.push(u),Object(n.forEach)(s,(function(e){var t=new i.Flat({definition:[]});u.definition.push(t),Object(n.has)(e,"NAME")&&(t.name=e.NAME),Object(n.has)(e,"IGNORE_AMBIGUITIES")?t.ignoreAmbiguities=e.IGNORE_AMBIGUITIES:Object(n.has)(e,"GATE")&&(t.ignoreAmbiguities=!0),r.recordingProdStack.push(t),e.ALT.call(r),r.recordingProdStack.pop()})),l}function v(e){return 0===e?"":""+e}function E(e){if(e<0||e>h){var t=new Error("Invalid DSL Method idx value: <"+e+">\n\tIdx value must be a none negative value smaller than "+(h+1));throw t.KNOWN_RECORDER_ERROR=!0,t}}},function(e,t,r){"use strict";r.r(t),r.d(t,"PerformanceTracer",(function(){return a}));var n=r(158),i=r(157),a=function(){function e(){}return e.prototype.initPerformanceTracer=function(e){if(Object(n.has)(e,"traceInitPerf")){var t=e.traceInitPerf,r="number"==typeof t;this.traceInitMaxIdent=r?t:1/0,this.traceInitPerf=r?t>0:t}else this.traceInitMaxIdent=0,this.traceInitPerf=i.DEFAULT_PARSER_CONFIG.traceInitPerf;this.traceInitIndent=-1},e.prototype.TRACE_INIT=function(e,t){if(!0===this.traceInitPerf){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--\x3e <"+e+">");var i=Object(n.timer)(t),a=i.time,o=i.value,s=a>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&s(r+"<-- <"+e+"> time: "+a+"ms"),this.traceInitIndent--,o}return t()},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"createSyntaxDiagramsCode",(function(){return i}));var n=r(156);function i(e,t){var r=void 0===t?{}:t,i=r.resourceBase,a=void 0===i?"https://unpkg.com/chevrotain@"+n.VERSION+"/diagrams/":i,o=r.css;return"\n\x3c!-- This is a generated file --\x3e\n<!DOCTYPE html>\n<meta charset=\"utf-8\">\n<style>\n  body {\n    background-color: hsl(30, 20%, 95%)\n  }\n</style>\n\n\n<link rel='stylesheet' href='"+(void 0===o?"https://unpkg.com/chevrotain@"+n.VERSION+"/diagrams/diagrams.css":o)+"'>\n\n<script src='"+a+"vendor/railroad-diagrams.js'><\/script>\n<script src='"+a+"src/diagrams_builder.js'><\/script>\n<script src='"+a+"src/diagrams_behavior.js'><\/script>\n<script src='"+a+'src/main.js\'><\/script>\n\n<div id="diagrams" align="center"></div>    \n\n<script>\n    window.serializedGrammar = '+JSON.stringify(e,null,"  ")+';\n<\/script>\n\n<script>\n    var diagramsDiv = document.getElementById("diagrams");\n    main.drawDiagramsFromSerializedGrammar(serializedGrammar, diagramsDiv);\n<\/script>\n'}},function(e,t,r){"use strict";r.r(t),r.d(t,"generateParserFactory",(function(){return i})),r.d(t,"generateParserModule",(function(){return a}));var n=r(197);function i(e){var t=Object(n.genWrapperFunction)({name:e.name,rules:e.rules}),i=new Function("tokenVocabulary","config","chevrotain",t);return function(t){return i(e.tokenVocabulary,t,r(155))}}function a(e){return Object(n.genUmdModule)({name:e.name,rules:e.rules})}},function(e,t,r){"use strict";r.r(t),r.d(t,"genUmdModule",(function(){return o})),r.d(t,"genWrapperFunction",(function(){return s})),r.d(t,"genClass",(function(){return u})),r.d(t,"genAllRules",(function(){return c})),r.d(t,"genRule",(function(){return l})),r.d(t,"genTerminal",(function(){return h})),r.d(t,"genNonTerminal",(function(){return p})),r.d(t,"genAlternation",(function(){return f})),r.d(t,"genSingleAlt",(function(){return d}));var n=r(158),i=r(161),a="\n";function o(e){return"\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(['chevrotain'], factory);\n    } else if (typeof module === 'object' && module.exports) {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory(require('chevrotain'));\n    } else {\n        // Browser globals (root is window)\n        root.returnExports = factory(root.b);\n    }\n}(typeof self !== 'undefined' ? self : this, function (chevrotain) {\n\n"+u(e)+"\n    \nreturn {\n    "+e.name+": "+e.name+" \n}\n}));\n"}function s(e){return"    \n"+u(e)+"\nreturn new "+e.name+"(tokenVocabulary, config)    \n"}function u(e){return"\nfunction "+e.name+"(tokenVocabulary, config) {\n    // invoke super constructor\n    // No support for embedded actions currently, so we can 'hardcode'\n    // The use of CstParser.\n    chevrotain.CstParser.call(this, tokenVocabulary, config)\n\n    const $ = this\n\n    "+c(e.rules)+"\n\n    // very important to call this after all the rules have been defined.\n    // otherwise the parser may not work correctly as it will lack information\n    // derived during the self analysis phase.\n    this.performSelfAnalysis(this)\n}\n\n// inheritance as implemented in javascript in the previous decade... :(\n"+e.name+".prototype = Object.create(chevrotain.CstParser.prototype)\n"+e.name+".prototype.constructor = "+e.name+"    \n    "}function c(e){return Object(n.map)(e,(function(e){return l(e,1)})).join("\n")}function l(e,t){var r=v(t,'$.RULE("'+e.name+'", function() {')+a;return r+=g(e.definition,t+1),r+=v(t+1,"})")+a}function h(e,t){var r=e.terminalType.name;return v(t,"$.CONSUME"+e.idx+"(this.tokensMap."+r+")"+a)}function p(e,t){return v(t,"$.SUBRULE"+e.idx+"($."+e.nonTerminalName+")"+a)}function f(e,t){var r=v(t,"$.OR"+e.idx+"([")+a;return r+=Object(n.map)(e.definition,(function(e){return d(e,t+1)})).join(",\n"),r+=a+v(t,"])\n")}function d(e,t){var r=v(t,"{")+a;return e.name&&(r+=v(t+1,'NAME: "'+e.name+'",')+a),r+=v(t+1,"ALT: function() {")+a,r+=g(e.definition,t+1),r+=v(t+1,"}")+a,r+=v(t,"}")}function m(e,t,r){var n=v(r,"$."+(e+t.idx)+"(");return t.name||t.separator?(n+="{\n",t.name&&(n+=v(r+1,'NAME: "'+t.name+'"')+","+a),t.separator&&(n+=v(r+1,"SEP: this.tokensMap."+t.separator.name)+","+a),n+="DEF: "+y(t.definition,r+2)+a,n+=v(r,"}")+a):n+=y(t.definition,r+1),n+=v(r,")")+a}function y(e,t){var r="function() {\n";return r+=g(e,t),r+=v(t,"}")+a}function g(e,t){var r="";return Object(n.forEach)(e,(function(e){r+=function(e,t){if(e instanceof i.NonTerminal)return p(e,t);if(e instanceof i.Option)return m("OPTION",e,t);if(e instanceof i.RepetitionMandatory)return m("AT_LEAST_ONE",e,t);if(e instanceof i.RepetitionMandatoryWithSeparator)return m("AT_LEAST_ONE_SEP",e,t);if(e instanceof i.RepetitionWithSeparator)return m("MANY_SEP",e,t);if(e instanceof i.Repetition)return m("MANY",e,t);if(e instanceof i.Alternation)return f(e,t);if(e instanceof i.Terminal)return h(e,t);if(e instanceof i.Flat)return g(e.definition,t);throw Error("non exhaustive match")}(e,t+1)})),r}function v(e,t){return Array(4*e+1).join(" ")+t}},function(e,t,r){"use strict";r(109),t.__esModule=!0,t.RowAddress=void 0;var n=r(106),i=r(153);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sheet=t,this.row=r,this.type=n}var t,r,o;return t=e,o=[{key:"absolute",value:function(t,r){return new e(t,r,i.ReferenceType.ABSOLUTE)}},{key:"relative",value:function(t,r){return new e(t,r,i.ReferenceType.RELATIVE)}}],(r=[{key:"isRowAbsolute",value:function(){return this.type===i.ReferenceType.ABSOLUTE}},{key:"isRowRelative",value:function(){return this.type===i.ReferenceType.RELATIVE}},{key:"isAbsolute",value:function(){return this.type===i.ReferenceType.ABSOLUTE&&null!==this.sheet}},{key:"moved",value:function(t,r,n){return new e(null===this.sheet?null:t,this.row+n,this.type)}},{key:"shiftedByRows",value:function(t){return new e(this.sheet,this.row+t,this.type)}},{key:"toSimpleRowAddress",value:function(e){var t=(0,n.absoluteSheetReference)(this,e),r=this.row;return this.isRowRelative()&&(r=e.row+this.row),(0,n.simpleRowAddress)(t,r)}},{key:"shiftRelativeDimensions",value:function(t,r){var n=this.isRowRelative()?this.row+r:this.row;return new e(this.sheet,n,this.type)}},{key:"shiftAbsoluteDimensions",value:function(t,r){var n=this.isRowAbsolute()?this.row+r:this.row;return new e(this.sheet,n,this.type)}},{key:"withAbsoluteSheet",value:function(t){return new e(t,this.row,this.type)}},{key:"hash",value:function(e){var t=e&&null!==this.sheet?"#".concat(this.sheet):"";switch(this.type){case i.ReferenceType.RELATIVE:return"".concat(t,"#ROWR").concat(this.row);case i.ReferenceType.ABSOLUTE:return"".concat(t,"#ROWA").concat(this.row)}}},{key:"unparse",value:function(e){var t=this.toSimpleRowAddress(e),r=this.type===i.ReferenceType.ABSOLUTE?"$":"";return"".concat(r).concat(t.row+1)}},{key:"exceedsSheetSizeLimits",value:function(e){return this.row>=e}}])&&a(t.prototype,r),o&&a(t,o),e}();t.RowAddress=o},function(e,t,r){"use strict";r(1),r(63),r(64),r(109),r(65),r(75),r(200),r(113),r(84),r(89),r(201),r(92),r(144),r(96),r(98),r(150),r(104),t.__esModule=!0,t.bindWhitespacesToTokens=g,t.ParserWithCaching=void 0;var n=r(155),i=r(106),a=r(138),o=r(139),s=r(203),u=r(204),c=r(205),l=r(208),h=r(154),p=r(214);function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var y=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.functionRegistry=r,this.sheetMapping=n,this.statsCacheUsed=0,this.lexerConfig=(0,h.buildLexerConfig)(t),this.lexer=new l.FormulaLexer(this.lexerConfig),this.formulaParser=new l.FormulaParser(this.lexerConfig,this.sheetMapping),this.cache=new c.Cache(this.functionRegistry)}var t,r,d;return t=e,(r=[{key:"parse",value:function(e,t){var r=this.lexer.tokenizeFormula(e);if(r.errors.length>0){var n=r.errors.map((function(e){return{type:s.ParsingErrorType.LexingError,message:e.message}}));return{ast:(0,a.buildParsingErrorAst)(),errors:n,hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]}}var i=this.computeHashFromTokens(r.tokens,t),o=this.cache.get(i);if(o)++this.statsCacheUsed;else{var u=g(r.tokens),c=this.formulaParser.parseFromTokens(u,t);if(c.errors.length>0)return Object.assign(Object.assign({},c),{hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]});o=this.cache.set(i,c.ast)}var l=o;return{ast:l.ast,errors:[],hasVolatileFunction:l.hasVolatileFunction,hasStructuralChangeFunction:l.hasStructuralChangeFunction,dependencies:l.relativeDependencies}}},{key:"fetchCachedResultForAst",value:function(e){var t=this.computeHashFromAst(e);return this.fetchCachedResult(t)}},{key:"fetchCachedResult",value:function(e){var t=this.cache.get(e);if(null===t)throw new Error("There is no AST with such key in the cache");return{ast:t.ast,errors:[],hasVolatileFunction:t.hasVolatileFunction,hasStructuralChangeFunction:t.hasStructuralChangeFunction,dependencies:t.relativeDependencies}}},{key:"computeHashFromTokens",value:function(e,t){for(var r,i="",a=0;a<e.length;){var s=e[a];if((0,n.tokenMatcher)(s,h.CellReference)){var u=(0,o.cellAddressFromString)(this.sheetMapping,s.image,t);i=void 0===u?i.concat(s.image):i.concat(u.hash(!0))}else if((0,n.tokenMatcher)(s,h.ProcedureName)){var c=s.image.toUpperCase().slice(0,-1),l=null!==(r=this.lexerConfig.functionMapping[c])&&void 0!==r?r:c;i=i.concat(l,"(")}else if((0,n.tokenMatcher)(s,h.ColumnRange)){var p=f(s.image.split(":"),2),d=p[0],m=p[1],y=(0,o.columnAddressFromString)(this.sheetMapping,d,t),g=(0,o.columnAddressFromString)(this.sheetMapping,m,t);i=void 0===y||void 0===g?i.concat("!REF"):i.concat(y.hash(!0),":",g.hash(!0))}else if((0,n.tokenMatcher)(s,h.RowRange)){var v=f(s.image.split(":"),2),E=v[0],T=v[1],b=(0,o.rowAddressFromString)(this.sheetMapping,E,t),x=(0,o.rowAddressFromString)(this.sheetMapping,T,t);i=void 0===b||void 0===x?i.concat("!REF"):i.concat(b.hash(!0),":",x.hash(!0))}else i=i.concat(s.image);a++}return i}},{key:"rememberNewAst",value:function(e){var t=this.computeHashFromAst(e);return this.cache.maybeSetAndThenGet(t,e)}},{key:"computeHashFromAst",value:function(e){return"="+this.computeHashOfAstNode(e)}},{key:"destroy",value:function(){this.cache.destroy()}},{key:"computeHashOfAstNode",value:function(e){var t=this;switch(e.type){case a.AstNodeType.EMPTY:return e.leadingWhitespace||"";case a.AstNodeType.NUMBER:return(0,s.imageWithWhitespace)((0,p.formatNumber)(e.value,this.config.decimalSeparator),e.leadingWhitespace);case a.AstNodeType.STRING:return(0,s.imageWithWhitespace)('"'+e.value+'"',e.leadingWhitespace);case a.AstNodeType.NAMED_EXPRESSION:return(0,s.imageWithWhitespace)(e.expressionName,e.leadingWhitespace);case a.AstNodeType.FUNCTION_CALL:var r=e.args.map((function(e){return t.computeHashOfAstNode(e)})).join(this.config.functionArgSeparator),n=e.procedureName+"("+r+(0,s.imageWithWhitespace)(")",e.internalWhitespace);return(0,s.imageWithWhitespace)(n,e.leadingWhitespace);case a.AstNodeType.CELL_REFERENCE:return(0,s.imageWithWhitespace)(e.reference.hash(!0),e.leadingWhitespace);case a.AstNodeType.COLUMN_RANGE:case a.AstNodeType.ROW_RANGE:case a.AstNodeType.CELL_RANGE:var o=e.start.hash(e.sheetReferenceType!==s.RangeSheetReferenceType.RELATIVE),c=e.end.hash(e.sheetReferenceType===s.RangeSheetReferenceType.BOTH_ABSOLUTE);return(0,s.imageWithWhitespace)(o+":"+c,e.leadingWhitespace);case a.AstNodeType.MINUS_UNARY_OP:return(0,s.imageWithWhitespace)("-"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case a.AstNodeType.PLUS_UNARY_OP:return(0,s.imageWithWhitespace)("+"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case a.AstNodeType.PERCENT_OP:return this.computeHashOfAstNode(e.value)+(0,s.imageWithWhitespace)("%",e.leadingWhitespace);case a.AstNodeType.ERROR:var l=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:i.ErrorType.ERROR);return(0,s.imageWithWhitespace)(l,e.leadingWhitespace);case a.AstNodeType.ERROR_WITH_RAW_INPUT:return(0,s.imageWithWhitespace)(e.rawInput,e.leadingWhitespace);case a.AstNodeType.PARENTHESIS:var h="("+this.computeHashOfAstNode(e.expression)+(0,s.imageWithWhitespace)(")",e.internalWhitespace);return(0,s.imageWithWhitespace)(h,e.leadingWhitespace);default:return this.computeHashOfAstNode(e.left)+(0,s.imageWithWhitespace)(u.binaryOpTokenMap[e.type],e.leadingWhitespace)+this.computeHashOfAstNode(e.right)}}}])&&m(t.prototype,r),d&&m(t,d),e}();function g(e){var t=[],r=e[0];(0,n.tokenMatcher)(r,h.WhiteSpace)||t.push(r);for(var i=1;i<e.length;++i){var a=e[i];if(!(0,n.tokenMatcher)(a,h.WhiteSpace)){var o=e[i-1];(0,n.tokenMatcher)(o,h.WhiteSpace)&&(a.leadingWhitespace=o),t.push(a)}}return t}t.ParserWithCaching=y},function(e,t,r){"use strict";var n=r(2),i=r(11),a=r(10),o=r(112),s=[].join,u=i!=Object,c=o("join",",");n({target:"Array",proto:!0,forced:u||!c},{join:function(e){return s.call(a(this),void 0===e?",":e)}})},function(e,t,r){var n=r(2),i=r(202);n({target:"Object",stat:!0,forced:Object.assign!==i},{assign:i})},function(e,t,r){"use strict";var n=r(6),i=r(7),a=r(52),o=r(44),s=r(8),u=r(49),c=r(11),l=Object.assign,h=Object.defineProperty;e.exports=!l||i((function(){if(n&&1!==l({b:1},l(h({},"a",{enumerable:!0,get:function(){h(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},r=Symbol();return e[r]=7,"abcdefghijklmnopqrst".split("").forEach((function(e){t[e]=e})),7!=l({},e)[r]||"abcdefghijklmnopqrst"!=a(l({},t)).join("")}))?function(e,t){for(var r=u(e),i=arguments.length,l=1,h=o.f,p=s.f;i>l;)for(var f,d=c(arguments[l++]),m=h?a(d).concat(h(d)):a(d),y=m.length,g=0;y>g;)f=m[g++],n&&!p.call(d,f)||(r[f]=d[f]);return r}:l},function(e,t,r){"use strict";r(84),t.__esModule=!0,t.imageWithWhitespace=function(e,t){return(null!=t?t:"")+e},t.buildParsingErrorAst=t.buildErrorWithRawInputAst=t.buildCellErrorAst=t.buildParenthesisAst=t.buildNamedExpressionAst=t.buildProcedureAst=t.buildPercentOpAst=t.buildPlusUnaryOpAst=t.buildMinusUnaryOpAst=t.buildPowerOpAst=t.buildDivOpAst=t.buildTimesOpAst=t.buildMinusOpAst=t.buildPlusOpAst=t.buildLessThanOrEqualOpAst=t.buildGreaterThanOrEqualOpAst=t.buildLessThanOpAst=t.buildGreaterThanOpAst=t.buildNotEqualOpAst=t.buildEqualsOpAst=t.buildConcatenateOpAst=t.buildRowRangeAst=t.buildColumnRangeAst=t.buildCellRangeAst=t.buildCellReferenceAst=t.buildStringAst=t.buildNumberAst=t.buildEmptyArgAst=t.RangeSheetReferenceType=t.AstNodeType=t.ParsingErrorType=t.parsingError=void 0;var n,i,a,o=r(106);
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */function s(e,t,r){if(null!==e.sheet&&null===t.sheet||null===e.sheet&&null!==t.sheet)throw new Error("Start address inconsistent with end address");if(null===e.sheet&&r!==a.RELATIVE||null!==e.sheet&&r===a.RELATIVE)throw new Error("Sheet address inconsistent with sheet reference type")}t.parsingError=function(e,t){return{type:e,message:t}},t.ParsingErrorType=n,function(e){e.LexingError="LexingError",e.ParserError="ParsingError",e.StaticOffsetError="StaticOffsetError",e.StaticOffsetOutOfRangeError="StaticOffsetOutOfRangeError",e.RangeOffsetNotAllowed="RangeOffsetNotAllowed"}(n||(t.ParsingErrorType=n={})),t.AstNodeType=i,function(e){e.EMPTY="EMPTY",e.NUMBER="NUMBER",e.STRING="STRING",e.MINUS_UNARY_OP="MINUS_UNARY_OP",e.PLUS_UNARY_OP="PLUS_UNARY_OP",e.PERCENT_OP="PERCENT_OP",e.CONCATENATE_OP="CONCATENATE_OP",e.EQUALS_OP="EQUALS_OP",e.NOT_EQUAL_OP="NOT_EQUAL_OP",e.GREATER_THAN_OP="GREATER_THAN_OP",e.LESS_THAN_OP="LESS_THAN_OP",e.GREATER_THAN_OR_EQUAL_OP="GREATER_THAN_OR_EQUAL_OP",e.LESS_THAN_OR_EQUAL_OP="LESS_THAN_OR_EQUAL_OP",e.PLUS_OP="PLUS_OP",e.MINUS_OP="MINUS_OP",e.TIMES_OP="TIMES_OP",e.DIV_OP="DIV_OP",e.POWER_OP="POWER_OP",e.FUNCTION_CALL="FUNCTION_CALL",e.NAMED_EXPRESSION="NAMED_EXPRESSION",e.PARENTHESIS="PARENTHESES",e.CELL_REFERENCE="CELL_REFERENCE",e.CELL_RANGE="CELL_RANGE",e.COLUMN_RANGE="COLUMN_RANGE",e.ROW_RANGE="ROW_RANGE",e.ERROR="ERROR",e.ERROR_WITH_RAW_INPUT="ERROR_WITH_RAW_INPUT"}(i||(t.AstNodeType=i={})),t.RangeSheetReferenceType=a,function(e){e[e.RELATIVE=0]="RELATIVE",e[e.START_ABSOLUTE=1]="START_ABSOLUTE",e[e.BOTH_ABSOLUTE=2]="BOTH_ABSOLUTE"}(a||(t.RangeSheetReferenceType=a={})),t.buildEmptyArgAst=function(e){return{type:i.EMPTY,leadingWhitespace:null==e?void 0:e.image}},t.buildNumberAst=function(e,t){return{type:i.NUMBER,value:e,leadingWhitespace:null==t?void 0:t.image}},t.buildStringAst=function(e){var t;return{type:i.STRING,value:e.image.slice(1,-1),leadingWhitespace:null===(t=e.leadingWhitespace)||void 0===t?void 0:t.image}},t.buildCellReferenceAst=function(e,t){return{type:i.CELL_REFERENCE,reference:e,leadingWhitespace:null==t?void 0:t.image}},t.buildCellRangeAst=function(e,t,r,n){return s(e,t,r),{type:i.CELL_RANGE,start:e,end:t,sheetReferenceType:r,leadingWhitespace:n}},t.buildColumnRangeAst=function(e,t,r,n){return s(e,t,r),{type:i.COLUMN_RANGE,start:e,end:t,sheetReferenceType:r,leadingWhitespace:null==n?void 0:n.image}},t.buildRowRangeAst=function(e,t,r,n){return s(e,t,r),{type:i.ROW_RANGE,start:e,end:t,sheetReferenceType:r,leadingWhitespace:null==n?void 0:n.image}},t.buildConcatenateOpAst=function(e,t,r){return{type:i.CONCATENATE_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}},t.buildEqualsOpAst=function(e,t,r){return{type:i.EQUALS_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}},t.buildNotEqualOpAst=function(e,t,r){return{type:i.NOT_EQUAL_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}},t.buildGreaterThanOpAst=function(e,t,r){return{type:i.GREATER_THAN_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}},t.buildLessThanOpAst=function(e,t,r){return{type:i.LESS_THAN_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}},t.buildGreaterThanOrEqualOpAst=function(e,t,r){return{type:i.GREATER_THAN_OR_EQUAL_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}},t.buildLessThanOrEqualOpAst=function(e,t,r){return{type:i.LESS_THAN_OR_EQUAL_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}},t.buildPlusOpAst=function(e,t,r){return{type:i.PLUS_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}},t.buildMinusOpAst=function(e,t,r){return{type:i.MINUS_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}},t.buildTimesOpAst=function(e,t,r){return{type:i.TIMES_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}},t.buildDivOpAst=function(e,t,r){return{type:i.DIV_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}},t.buildPowerOpAst=function(e,t,r){return{type:i.POWER_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}},t.buildMinusUnaryOpAst=function(e,t){return{type:i.MINUS_UNARY_OP,value:e,leadingWhitespace:null==t?void 0:t.image}},t.buildPlusUnaryOpAst=function(e,t){return{type:i.PLUS_UNARY_OP,value:e,leadingWhitespace:null==t?void 0:t.image}},t.buildPercentOpAst=function(e,t){return{type:i.PERCENT_OP,value:e,leadingWhitespace:null==t?void 0:t.image}},t.buildProcedureAst=function(e,t,r,n){return{type:i.FUNCTION_CALL,procedureName:e,args:t,leadingWhitespace:null==r?void 0:r.image,internalWhitespace:null==n?void 0:n.image}},t.buildNamedExpressionAst=function(e,t){return{type:i.NAMED_EXPRESSION,expressionName:e,leadingWhitespace:null==t?void 0:t.image}},t.buildParenthesisAst=function(e,t,r){return{type:i.PARENTHESIS,expression:e,leadingWhitespace:null==t?void 0:t.image,internalWhitespace:null==r?void 0:r.image}},t.buildCellErrorAst=function(e,t){return{type:i.ERROR,error:e,leadingWhitespace:null==t?void 0:t.image}},t.buildErrorWithRawInputAst=function(e,t,r){return{type:i.ERROR_WITH_RAW_INPUT,error:t,rawInput:e,leadingWhitespace:null==r?void 0:r.image}},t.buildParsingErrorAst=function(){return{type:i.ERROR,error:o.CellError.parsingError()}}},function(e,t,r){"use strict";t.__esModule=!0,t.binaryOpTokenMap=void 0;var n,i=r(203);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=(a(n={},i.AstNodeType.PLUS_OP,"+"),a(n,i.AstNodeType.MINUS_OP,"-"),a(n,i.AstNodeType.TIMES_OP,"*"),a(n,i.AstNodeType.DIV_OP,"/"),a(n,i.AstNodeType.CONCATENATE_OP,"&"),a(n,i.AstNodeType.POWER_OP,"^"),a(n,i.AstNodeType.EQUALS_OP,"="),a(n,i.AstNodeType.NOT_EQUAL_OP,"<>"),a(n,i.AstNodeType.GREATER_THAN_OP,">"),a(n,i.AstNodeType.GREATER_THAN_OR_EQUAL_OP,">="),a(n,i.AstNodeType.LESS_THAN_OP,"<"),a(n,i.AstNodeType.LESS_THAN_OR_EQUAL_OP,"<="),n);t.binaryOpTokenMap=o},function(e,t,r){"use strict";r(75),r(206),r(207),r(92),r(98),r(104),t.__esModule=!0,t.doesContainFunctions=t.Cache=void 0;var n=r(138);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.functionRegistry=t,this.cache=new Map}var t,r,a;return t=e,(r=[{key:"set",value:function(e,t){var r=function(e,t,r,n){return{ast:e,relativeDependencies:t,hasVolatileFunction:r,hasStructuralChangeFunction:n}}(t,(0,n.collectDependencies)(t,this.functionRegistry),o(t,this.functionRegistry.isFunctionVolatile),o(t,this.functionRegistry.isFunctionDependentOnSheetStructureChange));return this.cache.set(e,r),r}},{key:"get",value:function(e){return this.cache.get(e)||null}},{key:"maybeSetAndThenGet",value:function(e,t){var r=this.cache.get(e);return r?r.ast:(this.set(e,t),t)}},{key:"destroy",value:function(){this.cache.clear()}}])&&i(t.prototype,r),a&&i(t,a),e}();t.Cache=a;var o=function e(t,r){switch(t.type){case n.AstNodeType.EMPTY:case n.AstNodeType.NUMBER:case n.AstNodeType.STRING:case n.AstNodeType.ERROR:case n.AstNodeType.ERROR_WITH_RAW_INPUT:case n.AstNodeType.CELL_REFERENCE:case n.AstNodeType.CELL_RANGE:case n.AstNodeType.COLUMN_RANGE:case n.AstNodeType.ROW_RANGE:case n.AstNodeType.NAMED_EXPRESSION:return!1;case n.AstNodeType.PERCENT_OP:case n.AstNodeType.PLUS_UNARY_OP:case n.AstNodeType.MINUS_UNARY_OP:return e(t.value,r);case n.AstNodeType.CONCATENATE_OP:case n.AstNodeType.EQUALS_OP:case n.AstNodeType.NOT_EQUAL_OP:case n.AstNodeType.LESS_THAN_OP:case n.AstNodeType.GREATER_THAN_OP:case n.AstNodeType.LESS_THAN_OR_EQUAL_OP:case n.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case n.AstNodeType.MINUS_OP:case n.AstNodeType.PLUS_OP:case n.AstNodeType.TIMES_OP:case n.AstNodeType.DIV_OP:case n.AstNodeType.POWER_OP:return e(t.left,r)||e(t.right,r);case n.AstNodeType.PARENTHESIS:return e(t.expression,r);case n.AstNodeType.FUNCTION_CALL:return!!r(t.procedureName)||t.args.some((function(t){return e(t,r)}))}};t.doesContainFunctions=o},function(e,t,r){"use strict";var n=r(2),i=r(59).some,a=r(112),o=r(88),s=a("some"),u=o("some");n({target:"Array",proto:!0,forced:!s||!u},{some:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,r){"use strict";var n=r(115),i=r(121);e.exports=n("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),i)},function(e,t,r){"use strict";r(1),r(63),r(64),r(109),r(65),r(75),r(113),r(84),r(89),r(133),r(209),r(211),r(91),r(92),r(94),r(212),r(144),r(96),r(98),r(146),r(150),r(104),t.__esModule=!0,t.FormulaLexer=t.FormulaParser=void 0;var n=r(155),i=r(106),a=r(213),o=r(139),s=r(203),u=r(152),c=r(154);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function m(e,t,r){return t&&d(e.prototype,t),r&&d(e,r),e}function y(e,t,r){return(y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=T(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=T(e);if(t){var i=T(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return E(this,r)}}function E(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(r,e);var t=v(r);function r(e,a){var u;return f(this,r),(u=t.call(this,e.allTokens,{outputCst:!1,maxLookahead:7})).formula=u.RULE("formula",(function(){return u.CONSUME(c.EqualsOp),u.SUBRULE(u.booleanExpression)})),u.booleanExpression=u.RULE("booleanExpression",(function(){var e=u.SUBRULE(u.concatenateExpression);return u.MANY((function(){var t=u.CONSUME(c.BooleanOp),r=u.SUBRULE2(u.concatenateExpression);(0,n.tokenMatcher)(t,c.EqualsOp)?e=(0,s.buildEqualsOpAst)(e,r,t.leadingWhitespace):(0,n.tokenMatcher)(t,c.NotEqualOp)?e=(0,s.buildNotEqualOpAst)(e,r,t.leadingWhitespace):(0,n.tokenMatcher)(t,c.GreaterThanOp)?e=(0,s.buildGreaterThanOpAst)(e,r,t.leadingWhitespace):(0,n.tokenMatcher)(t,c.LessThanOp)?e=(0,s.buildLessThanOpAst)(e,r,t.leadingWhitespace):(0,n.tokenMatcher)(t,c.GreaterThanOrEqualOp)?e=(0,s.buildGreaterThanOrEqualOpAst)(e,r,t.leadingWhitespace):(0,n.tokenMatcher)(t,c.LessThanOrEqualOp)?e=(0,s.buildLessThanOrEqualOpAst)(e,r,t.leadingWhitespace):u.ACTION((function(){throw Error("Operator not supported")}))})),e})),u.booleanExpressionOrEmpty=u.RULE("booleanExpressionOrEmpty",(function(){return u.OR([{ALT:function(){return u.SUBRULE(u.booleanExpression)}},{ALT:(0,n.EMPTY_ALT)((0,s.buildEmptyArgAst)())}])})),u.concatenateExpression=u.RULE("concatenateExpression",(function(){var e=u.SUBRULE(u.additionExpression);return u.MANY((function(){var t=u.CONSUME(c.ConcatenateOp),r=u.SUBRULE2(u.additionExpression);e=(0,s.buildConcatenateOpAst)(e,r,t.leadingWhitespace)})),e})),u.additionExpression=u.RULE("additionExpression",(function(){var e=u.SUBRULE(u.multiplicationExpression);return u.MANY((function(){var t=u.CONSUME(c.AdditionOp),r=u.SUBRULE2(u.multiplicationExpression);(0,n.tokenMatcher)(t,c.PlusOp)?e=(0,s.buildPlusOpAst)(e,r,t.leadingWhitespace):(0,n.tokenMatcher)(t,c.MinusOp)?e=(0,s.buildMinusOpAst)(e,r,t.leadingWhitespace):u.ACTION((function(){throw Error("Operator not supported")}))})),e})),u.multiplicationExpression=u.RULE("multiplicationExpression",(function(){var e=u.SUBRULE(u.powerExpression);return u.MANY((function(){var t=u.CONSUME(c.MultiplicationOp),r=u.SUBRULE2(u.powerExpression);(0,n.tokenMatcher)(t,c.TimesOp)?e=(0,s.buildTimesOpAst)(e,r,t.leadingWhitespace):(0,n.tokenMatcher)(t,c.DivOp)?e=(0,s.buildDivOpAst)(e,r,t.leadingWhitespace):u.ACTION((function(){throw Error("Operator not supported")}))})),e})),u.powerExpression=u.RULE("powerExpression",(function(){var e=u.SUBRULE(u.atomicExpression);return u.MANY((function(){var t=u.CONSUME(c.PowerOp),r=u.SUBRULE2(u.atomicExpression);(0,n.tokenMatcher)(t,c.PowerOp)?e=(0,s.buildPowerOpAst)(e,r,t.leadingWhitespace):u.ACTION((function(){throw Error("Operator not supported")}))})),e})),u.atomicExpression=u.RULE("atomicExpression",(function(){return u.OR([{ALT:function(){var e=u.CONSUME(c.AdditionOp),t=u.SUBRULE(u.atomicExpression);return(0,n.tokenMatcher)(e,c.PlusOp)?(0,s.buildPlusUnaryOpAst)(t,e.leadingWhitespace):(0,n.tokenMatcher)(e,c.MinusOp)?(0,s.buildMinusUnaryOpAst)(t,e.leadingWhitespace):(u.customParsingError=(0,s.parsingError)(s.ParsingErrorType.ParserError,"Mismatched token type"),u.customParsingError)}},{ALT:function(){return u.SUBRULE2(u.rightUnaryOpAtomicExpression)}}])})),u.rightUnaryOpAtomicExpression=u.RULE("rightUnaryOpAtomicExpression",(function(){var e=u.SUBRULE(u.positiveAtomicExpression),t=u.OPTION((function(){return u.CONSUME(c.PercentOp)}));return t?(0,s.buildPercentOpAst)(e,t.leadingWhitespace):e})),u.positiveAtomicExpression=u.RULE("positiveAtomicExpression",(function(){return u.OR(u.atomicExpCache||(u.atomicExpCache=[{ALT:function(){return u.SUBRULE(u.parenthesisExpression)}},{ALT:function(){return u.SUBRULE(u.cellRangeExpression)}},{ALT:function(){return u.SUBRULE(u.columnRangeExpression)}},{ALT:function(){return u.SUBRULE(u.rowRangeExpression)}},{ALT:function(){return u.SUBRULE(u.offsetExpression)}},{ALT:function(){return u.SUBRULE(u.cellReference)}},{ALT:function(){return u.SUBRULE(u.procedureExpression)}},{ALT:function(){return u.SUBRULE(u.namedExpressionExpression)}},{ALT:function(){var e=u.CONSUME(u.lexerConfig.NumberLiteral);return(0,s.buildNumberAst)(u.numericStringToNumber(e.image),e.leadingWhitespace)}},{ALT:function(){var e=u.CONSUME(c.StringLiteral);return(0,s.buildStringAst)(e)}},{ALT:function(){var e=u.CONSUME(c.ErrorLiteral),t=e.image.toUpperCase(),r=u.lexerConfig.errorMapping[t];return r?(0,s.buildCellErrorAst)(new i.CellError(r),e.leadingWhitespace):u.parsingError(s.ParsingErrorType.ParserError,"Unknown error literal")}}]))})),u.procedureExpression=u.RULE("procedureExpression",(function(){var e,t=u.CONSUME(c.ProcedureName),r=t.image.toUpperCase().slice(0,-1),n=null!==(e=u.lexerConfig.functionMapping[r])&&void 0!==e?e:r,i=[],a=u.SUBRULE(u.booleanExpressionOrEmpty);u.MANY((function(){var e,t=u.CONSUME(u.lexerConfig.ArgSeparator);a.type===s.AstNodeType.EMPTY&&(a.leadingWhitespace=null===(e=t.leadingWhitespace)||void 0===e?void 0:e.image),i.push(a),a=u.SUBRULE2(u.booleanExpressionOrEmpty)})),i.push(a),1===i.length&&i[0].type===s.AstNodeType.EMPTY&&(i.length=0);var o=u.CONSUME(c.RParen);return(0,s.buildProcedureAst)(n,i,t.leadingWhitespace,o.leadingWhitespace)})),u.namedExpressionExpression=u.RULE("namedExpressionExpression",(function(){var e=u.CONSUME(c.NamedExpression);return(0,s.buildNamedExpressionAst)(e.image,e.leadingWhitespace)})),u.offsetExpression=u.RULE("offsetExpression",(function(){var e,t=u.SUBRULE(u.offsetProcedureExpression);return u.OPTION((function(){u.CONSUME(c.RangeSeparator),e=t.type===s.AstNodeType.CELL_RANGE?u.parsingError(s.ParsingErrorType.RangeOffsetNotAllowed,"Range offset not allowed here"):u.SUBRULE(u.endOfRangeWithOffsetStartExpression,{ARGS:[t]})})),void 0!==e?e:t})),u.offsetProcedureExpression=u.RULE("offsetProcedureExpression",(function(){var e=[];return u.CONSUME(u.lexerConfig.OffsetProcedureName),u.CONSUME(c.LParen),u.MANY_SEP({SEP:u.lexerConfig.ArgSeparator,DEF:function(){e.push(u.SUBRULE(u.booleanExpression))}}),u.CONSUME(c.RParen),u.handleOffsetHeuristic(e)})),u.cellRangeExpression=u.RULE("cellRangeExpression",(function(){var e=u.CONSUME(c.CellReference);return u.CONSUME2(c.RangeSeparator),u.SUBRULE(u.endOfRangeExpression,{ARGS:[e]})})),u.columnRangeExpression=u.RULE("columnRangeExpression",(function(){var e=u.CONSUME(c.ColumnRange),t=h(e.image.split(":"),2),r=t[0],n=t[1],a=u.ACTION((function(){return(0,o.columnAddressFromString)(u.sheetMapping,r,u.formulaAddress)})),l=u.ACTION((function(){return(0,o.columnAddressFromString)(u.sheetMapping,n,u.formulaAddress)}));if(void 0===a||void 0===l)return(0,s.buildCellErrorAst)(new i.CellError(i.ErrorType.REF));if(a.exceedsSheetSizeLimits(u.lexerConfig.maxColumns)||l.exceedsSheetSizeLimits(u.lexerConfig.maxColumns))return(0,s.buildErrorWithRawInputAst)(e.image,new i.CellError(i.ErrorType.NAME),e.leadingWhitespace);if(null===a.sheet&&null!==l.sheet)return u.parsingError(s.ParsingErrorType.ParserError,"Malformed range expression");var p=u.rangeSheetReferenceType(a.sheet,l.sheet);return null!==a.sheet&&null===l.sheet&&(l=l.withAbsoluteSheet(a.sheet)),(0,s.buildColumnRangeAst)(a,l,p,e.leadingWhitespace)})),u.rowRangeExpression=u.RULE("rowRangeExpression",(function(){var e=u.CONSUME(c.RowRange),t=h(e.image.split(":"),2),r=t[0],n=t[1],a=u.ACTION((function(){return(0,o.rowAddressFromString)(u.sheetMapping,r,u.formulaAddress)})),l=u.ACTION((function(){return(0,o.rowAddressFromString)(u.sheetMapping,n,u.formulaAddress)}));if(void 0===a||void 0===l)return(0,s.buildCellErrorAst)(new i.CellError(i.ErrorType.REF));if(a.exceedsSheetSizeLimits(u.lexerConfig.maxRows)||l.exceedsSheetSizeLimits(u.lexerConfig.maxRows))return(0,s.buildErrorWithRawInputAst)(e.image,new i.CellError(i.ErrorType.NAME),e.leadingWhitespace);if(null===a.sheet&&null!==l.sheet)return u.parsingError(s.ParsingErrorType.ParserError,"Malformed range expression");var p=u.rangeSheetReferenceType(a.sheet,l.sheet);return null!==a.sheet&&null===l.sheet&&(l=l.withAbsoluteSheet(a.sheet)),(0,s.buildRowRangeAst)(a,l,p,e.leadingWhitespace)})),u.cellReference=u.RULE("cellReference",(function(){var e=u.CONSUME(c.CellReference),t=u.ACTION((function(){return(0,o.cellAddressFromString)(u.sheetMapping,e.image,u.formulaAddress)}));return void 0===t?(0,s.buildErrorWithRawInputAst)(e.image,new i.CellError(i.ErrorType.REF),e.leadingWhitespace):t.exceedsSheetSizeLimits(u.lexerConfig.maxColumns,u.lexerConfig.maxRows)?(0,s.buildErrorWithRawInputAst)(e.image,new i.CellError(i.ErrorType.NAME),e.leadingWhitespace):(0,s.buildCellReferenceAst)(t,e.leadingWhitespace)})),u.endOfRangeExpression=u.RULE("endOfRangeExpression",(function(e){return u.OR([{ALT:function(){return u.SUBRULE(u.endRangeReference,{ARGS:[e]})}},{ALT:function(){var t,r=u.SUBRULE(u.offsetProcedureExpression),n=u.ACTION((function(){return(0,o.cellAddressFromString)(u.sheetMapping,e.image,u.formulaAddress)}));if(void 0===n)return(0,s.buildCellErrorAst)(new i.CellError(i.ErrorType.REF));if(r.type===s.AstNodeType.CELL_REFERENCE){var a=r.reference,c=s.RangeSheetReferenceType.RELATIVE;return null!==n.sheet&&(c=s.RangeSheetReferenceType.START_ABSOLUTE,a=a.withAbsoluteSheet(n.sheet)),(0,s.buildCellRangeAst)(n,a,c,null===(t=e.leadingWhitespace)||void 0===t?void 0:t.image)}return u.parsingError(s.ParsingErrorType.RangeOffsetNotAllowed,"Range offset not allowed here")}}])})),u.endOfRangeWithOffsetStartExpression=u.RULE("endOfRangeWithOffsetStartExpression",(function(e){return u.OR([{ALT:function(){return u.SUBRULE(u.endRangeWithOffsetStartReference,{ARGS:[e]})}},{ALT:function(){var t=u.SUBRULE(u.offsetProcedureExpression);if(t.type===s.AstNodeType.CELL_REFERENCE){var r=t.reference,n=s.RangeSheetReferenceType.RELATIVE;return null!==e.reference.sheet&&(n=s.RangeSheetReferenceType.START_ABSOLUTE,r=r.withAbsoluteSheet(e.reference.sheet)),(0,s.buildCellRangeAst)(e.reference,r,n,e.leadingWhitespace)}return u.parsingError(s.ParsingErrorType.RangeOffsetNotAllowed,"Range offset not allowed here")}}])})),u.endRangeReference=u.RULE("endRangeReference",(function(e){var t,r=u.CONSUME(c.CellReference),n=u.ACTION((function(){return(0,o.cellAddressFromString)(u.sheetMapping,e.image,u.formulaAddress)})),a=u.ACTION((function(){return(0,o.cellAddressFromString)(u.sheetMapping,r.image,u.formulaAddress)}));return void 0===n||void 0===a?u.ACTION((function(){return(0,s.buildErrorWithRawInputAst)("".concat(e.image,":").concat(r.image),new i.CellError(i.ErrorType.REF),e.leadingWhitespace)})):n.exceedsSheetSizeLimits(u.lexerConfig.maxColumns,u.lexerConfig.maxRows)||a.exceedsSheetSizeLimits(u.lexerConfig.maxColumns,u.lexerConfig.maxRows)?u.ACTION((function(){return(0,s.buildErrorWithRawInputAst)("".concat(e.image,":").concat(r.image),new i.CellError(i.ErrorType.NAME),e.leadingWhitespace)})):u.buildCellRange(n,a,null===(t=e.leadingWhitespace)||void 0===t?void 0:t.image)})),u.endRangeWithOffsetStartReference=u.RULE("endRangeWithOffsetStartReference",(function(e){var t=u.CONSUME(c.CellReference),r=u.ACTION((function(){return(0,o.cellAddressFromString)(u.sheetMapping,t.image,u.formulaAddress)}));return void 0===r?u.ACTION((function(){return(0,s.buildCellErrorAst)(new i.CellError(i.ErrorType.REF))})):u.buildCellRange(e.reference,r,e.leadingWhitespace)})),u.parenthesisExpression=u.RULE("parenthesisExpression",(function(){var e=u.CONSUME(c.LParen),t=u.SUBRULE(u.booleanExpression),r=u.CONSUME(c.RParen);return(0,s.buildParenthesisAst)(t,e.leadingWhitespace,r.leadingWhitespace)})),u.numericStringToNumber=function(e){var t=e.replace(u.lexerConfig.decimalSeparator,".");return Number(t)},u.lexerConfig=e,u.sheetMapping=a,u.formulaAddress=(0,i.simpleCellAddress)(0,0,0),u.performSelfAnalysis(),u}return m(r,[{key:"parseFromTokens",value:function(e,t){this.input=e;var r=this.formulaWithContext(t),n=[];return this.customParsingError&&n.push(this.customParsingError),(n=n.concat(this.errors.map((function(e){return{type:s.ParsingErrorType.ParserError,message:e.message}})))).length>0&&(r=(0,s.buildParsingErrorAst)()),{ast:r,errors:n}}},{key:"formulaWithContext",value:function(e){return this.formulaAddress=e,this.formula()}},{key:"reset",value:function(){y(T(r.prototype),"reset",this).call(this),this.customParsingError=void 0}},{key:"buildCellRange",value:function(e,t,r){if(null===e.sheet&&null!==t.sheet)return this.parsingError(s.ParsingErrorType.ParserError,"Malformed range expression");var n=this.rangeSheetReferenceType(e.sheet,t.sheet);return null!==e.sheet&&null===t.sheet&&(t=t.withAbsoluteSheet(e.sheet)),(0,s.buildCellRangeAst)(e,t,n,r)}},{key:"handleOffsetHeuristic",value:function(e){var t=e[0];if(t.type!==s.AstNodeType.CELL_REFERENCE)return this.parsingError(s.ParsingErrorType.StaticOffsetError,"First argument to OFFSET is not a reference");var r,n=e[1];if(n.type===s.AstNodeType.NUMBER&&Number.isInteger(n.value))r=n.value;else if(n.type===s.AstNodeType.PLUS_UNARY_OP&&n.value.type===s.AstNodeType.NUMBER&&Number.isInteger(n.value.value))r=n.value.value;else{if(n.type!==s.AstNodeType.MINUS_UNARY_OP||n.value.type!==s.AstNodeType.NUMBER||!Number.isInteger(n.value.value))return this.parsingError(s.ParsingErrorType.StaticOffsetError,"Second argument to OFFSET is not a static number");r=-n.value.value}var o,c=e[2];if(c.type===s.AstNodeType.NUMBER&&Number.isInteger(c.value))o=c.value;else if(c.type===s.AstNodeType.PLUS_UNARY_OP&&c.value.type===s.AstNodeType.NUMBER&&Number.isInteger(c.value.value))o=c.value.value;else{if(c.type!==s.AstNodeType.MINUS_UNARY_OP||c.value.type!==s.AstNodeType.NUMBER||!Number.isInteger(c.value.value))return this.parsingError(s.ParsingErrorType.StaticOffsetError,"Third argument to OFFSET is not a static number");o=-c.value.value}var l,h=e[3];if(void 0===h)l=1;else{if(h.type!==s.AstNodeType.NUMBER)return this.parsingError(s.ParsingErrorType.StaticOffsetError,"Fourth argument to OFFSET is not a static number");if((l=h.value)<1)return this.parsingError(s.ParsingErrorType.StaticOffsetError,"Fourth argument to OFFSET is too small number");if(!Number.isInteger(l))return this.parsingError(s.ParsingErrorType.StaticOffsetError,"Fourth argument to OFFSET is not integer")}var p,f=e[4];if(void 0===f)p=1;else{if(f.type!==s.AstNodeType.NUMBER)return this.parsingError(s.ParsingErrorType.StaticOffsetError,"Fifth argument to OFFSET is not a static number");if((p=f.value)<1)return this.parsingError(s.ParsingErrorType.StaticOffsetError,"Fifth argument to OFFSET is too small number");if(!Number.isInteger(p))return this.parsingError(s.ParsingErrorType.StaticOffsetError,"Fifth argument to OFFSET is not integer")}var d=new u.CellAddress(null,t.reference.col+o,t.reference.row+r,t.reference.type),m=d.col,y=d.row;if(t.reference.type!==u.CellReferenceType.CELL_REFERENCE_RELATIVE&&t.reference.type!==u.CellReferenceType.CELL_REFERENCE_ABSOLUTE_COL||(y+=this.formulaAddress.row),t.reference.type!==u.CellReferenceType.CELL_REFERENCE_RELATIVE&&t.reference.type!==u.CellReferenceType.CELL_REFERENCE_ABSOLUTE_ROW||(m+=this.formulaAddress.col),m<0||y<0)return(0,s.buildCellErrorAst)(new i.CellError(i.ErrorType.REF,a.ErrorMessage.OutOfSheet));if(1===p&&1===l)return(0,s.buildCellReferenceAst)(d);var g=new u.CellAddress(null,d.col+p-1,d.row+l-1,d.type);return(0,s.buildCellRangeAst)(d,g,s.RangeSheetReferenceType.RELATIVE)}},{key:"parsingError",value:function(e,t){return this.customParsingError=(0,s.parsingError)(e,t),(0,s.buildParsingErrorAst)()}},{key:"rangeSheetReferenceType",value:function(e,t){return null===e?s.RangeSheetReferenceType.RELATIVE:null===t?s.RangeSheetReferenceType.START_ABSOLUTE:s.RangeSheetReferenceType.BOTH_ABSOLUTE}}]),r}(n.EmbeddedActionsParser);t.FormulaParser=b;var x=function(){function e(t){f(this,e),this.lexerConfig=t,this.lexer=new n.Lexer(t.allTokens,{ensureOptimizations:!0})}return m(e,[{key:"tokenizeFormula",value:function(e){var t=this.lexer.tokenize(e),r=t.tokens;return r=this.trimTrailingWhitespaces(r),r=this.skipWhitespacesInsideRanges(r),r=this.skipWhitespacesBeforeArgSeparators(r),t.tokens=r,t}},{key:"skipWhitespacesInsideRanges",value:function(e){return this.filterTokensByNeighbors(e,(function(e,t,r){return((0,n.tokenMatcher)(e,c.CellReference)||(0,n.tokenMatcher)(e,c.RangeSeparator))&&(0,n.tokenMatcher)(t,c.WhiteSpace)&&((0,n.tokenMatcher)(r,c.CellReference)||(0,n.tokenMatcher)(r,c.RangeSeparator))}))}},{key:"skipWhitespacesBeforeArgSeparators",value:function(e){var t=this;return this.filterTokensByNeighbors(e,(function(e,r,i){return!(0,n.tokenMatcher)(e,t.lexerConfig.ArgSeparator)&&(0,n.tokenMatcher)(r,c.WhiteSpace)&&(0,n.tokenMatcher)(i,t.lexerConfig.ArgSeparator)}))}},{key:"filterTokensByNeighbors",value:function(e,t){if(e.length<3)return e;for(var r=0,n=[e[r++]];r<e.length-1;)t(e[r-1],e[r],e[r+1])||n.push(e[r]),++r;return n.push(e[r]),n}},{key:"trimTrailingWhitespaces",value:function(e){return e.length>0&&(0,n.tokenMatcher)(e[e.length-1],c.WhiteSpace)&&e.pop(),e}}]),e}();t.FormulaLexer=x},function(e,t,r){r(2)({target:"Number",stat:!0},{isInteger:r(210)})},function(e,t,r){var n=r(15),i=Math.floor;e.exports=function(e){return!n(e)&&isFinite(e)&&i(e)===e}},function(e,t,r){var n=r(2),i=r(7),a=r(10),o=r(5).f,s=r(6),u=i((function(){o(1)}));n({target:"Object",stat:!0,forced:!s||u,sham:!s},{getOwnPropertyDescriptor:function(e,t){return o(a(e),t)}})},function(e,t,r){var n=r(2),i=r(15),a=r(21),o=r(16),s=r(5),u=r(80);n({target:"Reflect",stat:!0},{get:function e(t,r){var n,c,l=arguments.length<3?t:arguments[2];return a(t)===l?t[r]:(n=s.f(t,r))?o(n,"value")?n.value:void 0===n.get?void 0:n.get.call(l):i(c=u(t))?e(c,r,l):void 0}})},function(e,t,r){"use strict";t.__esModule=!0,t.ErrorMessage=void 0;
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */
var n=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)};t.ErrorMessage=n,n.DistinctSigns="Distinct signs.",n.WrongArgNumber="Wrong number of arguments.",n.EmptyArg="Empty function argument.",n.MatrixDimensions="Matrix dimensions are not compatible.",n.ValueSmall="Value too small.",n.ValueLarge="Value too large.",n.BadCriterion="Incorrect criterion.",n.RangeManySheets="Range spans more than one sheet.",n.CellRangeExpected="Cell range expected.",n.ScalarExpected="Cell range not allowed.",n.NumberCoercion="Value cannot be coerced to number.",n.NumberExpected="Number argument expected.",n.IntegerExpected="Value needs to be an integer.",n.BadMode="Mode not recognized.",n.DateBounds="Date outside of bounds.",n.OutOfSheet="Resulting reference is out of the sheet.",n.WrongType="Wrong type of argument.",n.NaN="NaN or infinite value encountered.",n.EqualLength="Ranges need to be of equal length.",n.Negative="Value cannot be negative.",n.NotBinary="String does not represent a binary number.",n.NotOctal="String does not represent an octal number.",n.NotHex="String does not represent a hexadecimal number.",n.EndStartPeriod="End period needs to be at least start period.",n.CellRefExpected="Cell reference expected.",n.BadRef="Address is not correct.",n.NumberRange="Number-only range expected.",n.ValueNotFound="Value not found.",n.ValueBaseLarge="Value in base too large.",n.ValueBaseSmall="Value in base too small.",n.ValueBaseLong="Value in base too long.",n.NegativeLength="Length cannot be negative.",n.PatternNotFound="Pattern not found.",n.MatrixParams="Matrix function parameters are not compatible.",n.OneValue="Needs at least one value.",n.TwoValues="Range needs to contain at least two elements.",n.IndexBounds="Index out of bounds.",n.IndexLarge="Index too large.",n.Formula="Expected formula.",n.NegativeCount="Count cannot be negative.",n.ParseError="Parsing error.",n.SheetRef="Sheet does not exist.",n.MatrixFunction="Matrix function not recognized.",n.PeriodLong="Period number cannot exceed life length.",n.InvalidDate="Invalid date.",n.BitshiftLong="Result of bitshift is too long.",n.EmptyString="Empty-string argument not allowed.",n.LengthBounds="Length out of bounds.",n.NegativeTime="Time cannot be negative.",n.NoDefault="No default option.",n.Selector="Selector cannot exceed the number of arguments.",n.StartEndDate="Start date needs to be earlier than end date.",n.IncorrectDateTime="String does not represent correct DateTime.",n.CharacterCodeBounds="Character code out of bounds.",n.NonZero="Argument cannot be 0.",n.LessThanOne="Argument cannot be less than 1.",n.WeekendString="Incorrect weekend bitmask string.",n.FunctionName=function(e){return"Function name ".concat(e," not recognized.")},n.NamedExpressionName=function(e){return"Named expression ".concat(e," not recognized.")},n.LicenseKey=function(e){return"License key is ".concat(e,".")}},function(e,t,r){"use strict";r(109),r(200),r(113),r(92),r(144),r(96),r(146),t.__esModule=!0,t.formatNumber=l,t.Unparser=void 0;var n=r(106),i=r(203),a=r(204),o=r(139),s=r(0);function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.lexerConfig=r,this.sheetMappingFn=n,this.namedExpressions=i}var t,r,c;return t=e,(r=[{key:"unparse",value:function(e,t){return"="+this.unparseAst(e,t)}},{key:"unparseAst",value:function(e,t){var r,o=this;switch(e.type){case i.AstNodeType.EMPTY:return(0,i.imageWithWhitespace)("",e.leadingWhitespace);case i.AstNodeType.NUMBER:return(0,i.imageWithWhitespace)(l(e.value,this.config.decimalSeparator),e.leadingWhitespace);case i.AstNodeType.STRING:return(0,i.imageWithWhitespace)('"'+e.value+'"',e.leadingWhitespace);case i.AstNodeType.FUNCTION_CALL:var s=e.args.map((function(e){return void 0!==e?o.unparseAst(e,t):""})).join(this.config.functionArgSeparator),u=(this.config.translationPackage.isFunctionTranslated(e.procedureName)?this.config.translationPackage.getFunctionTranslation(e.procedureName):e.procedureName)+"("+s+(0,i.imageWithWhitespace)(")",e.internalWhitespace);return(0,i.imageWithWhitespace)(u,e.leadingWhitespace);case i.AstNodeType.NAMED_EXPRESSION:var c=null===(r=this.namedExpressions.nearestNamedExpression(e.expressionName,t.sheet))||void 0===r?void 0:r.displayName;return(0,i.imageWithWhitespace)(c||e.expressionName,e.leadingWhitespace);case i.AstNodeType.CELL_REFERENCE:var h;return h=null!==e.reference.sheet?this.unparseSheetName(e.reference.sheet)+"!"+e.reference.unparse(t):e.reference.unparse(t),(0,i.imageWithWhitespace)(h,e.leadingWhitespace);case i.AstNodeType.COLUMN_RANGE:case i.AstNodeType.ROW_RANGE:case i.AstNodeType.CELL_RANGE:return(0,i.imageWithWhitespace)(this.formatRange(e,t),e.leadingWhitespace);case i.AstNodeType.PLUS_UNARY_OP:var p=this.unparseAst(e.value,t);return(0,i.imageWithWhitespace)("+",e.leadingWhitespace)+p;case i.AstNodeType.MINUS_UNARY_OP:var f=this.unparseAst(e.value,t);return(0,i.imageWithWhitespace)("-",e.leadingWhitespace)+f;case i.AstNodeType.PERCENT_OP:return this.unparseAst(e.value,t)+(0,i.imageWithWhitespace)("%",e.leadingWhitespace);case i.AstNodeType.ERROR:var d=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:n.ErrorType.ERROR);return(0,i.imageWithWhitespace)(d,e.leadingWhitespace);case i.AstNodeType.ERROR_WITH_RAW_INPUT:return(0,i.imageWithWhitespace)(e.rawInput,e.leadingWhitespace);case i.AstNodeType.PARENTHESIS:var m="("+this.unparseAst(e.expression,t)+(0,i.imageWithWhitespace)(")",e.internalWhitespace);return(0,i.imageWithWhitespace)(m,e.leadingWhitespace);default:var y=this.unparseAst(e.left,t),g=this.unparseAst(e.right,t);return y+(0,i.imageWithWhitespace)(a.binaryOpTokenMap[e.type],e.leadingWhitespace)+g}}},{key:"unparseSheetName",value:function(e){var t=(0,o.sheetIndexToString)(e,this.sheetMappingFn);if(void 0===t)throw new s.NoSheetWithIdError(e);return t}},{key:"formatRange",value:function(e,t){var r="",n="";return null!==e.start.sheet&&e.sheetReferenceType!==i.RangeSheetReferenceType.RELATIVE&&(r=this.unparseSheetName(e.start.sheet)+"!"),null!==e.end.sheet&&e.sheetReferenceType===i.RangeSheetReferenceType.BOTH_ABSOLUTE&&(n=this.unparseSheetName(e.end.sheet)+"!"),"".concat(r).concat(e.start.unparse(t),":").concat(n).concat(e.end.unparse(t))}}])&&u(t.prototype,r),c&&u(t,c),e}();function l(e,t){return e.toString().replace(".",t)}t.Unparser=c},function(e,t,r){"use strict";r(110),r(124),t.__esModule=!0,t.collectDependencies=void 0;var n=r(138);
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */t.collectDependencies=function(e,t){var r=new Array;return function e(t,r,i){switch(t.type){case n.AstNodeType.EMPTY:case n.AstNodeType.NUMBER:case n.AstNodeType.STRING:case n.AstNodeType.ERROR:return;case n.AstNodeType.NAMED_EXPRESSION:return void i.push(new n.NamedExpressionDependency(t.expressionName));case n.AstNodeType.CELL_REFERENCE:return void i.push(new n.AddressDependency(t.reference));case n.AstNodeType.CELL_RANGE:return void(t.start.sheet===t.end.sheet&&i.push(new n.CellRangeDependency(t.start,t.end)));case n.AstNodeType.COLUMN_RANGE:return void(t.start.sheet===t.end.sheet&&i.push(new n.ColumnRangeDependency(t.start,t.end)));case n.AstNodeType.ROW_RANGE:return void(t.start.sheet===t.end.sheet&&i.push(new n.RowRangeDependency(t.start,t.end)));case n.AstNodeType.PERCENT_OP:case n.AstNodeType.PLUS_UNARY_OP:case n.AstNodeType.MINUS_UNARY_OP:return void e(t.value,r,i);case n.AstNodeType.CONCATENATE_OP:case n.AstNodeType.EQUALS_OP:case n.AstNodeType.NOT_EQUAL_OP:case n.AstNodeType.LESS_THAN_OP:case n.AstNodeType.GREATER_THAN_OP:case n.AstNodeType.LESS_THAN_OR_EQUAL_OP:case n.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case n.AstNodeType.MINUS_OP:case n.AstNodeType.PLUS_OP:case n.AstNodeType.TIMES_OP:case n.AstNodeType.DIV_OP:case n.AstNodeType.POWER_OP:return e(t.left,r,i),void e(t.right,r,i);case n.AstNodeType.PARENTHESIS:return void e(t.expression,r,i);case n.AstNodeType.FUNCTION_CALL:return void(r.doesFunctionNeedArgumentToBeComputed(t.procedureName)||t.args.forEach((function(t){return e(t,r,i)})))}}(e,t,r),r}},function(e,t,r){"use strict";r(89),t.__esModule=!0,t.NamedExpressionDependency=t.RowRangeDependency=t.ColumnRangeDependency=t.CellRangeDependency=t.AddressDependency=void 0;var n=r(132);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}var s=function(){function e(t){i(this,e),this.dependency=t}return o(e,[{key:"absolutize",value:function(e){return this.dependency.toSimpleCellAddress(e)}}]),e}();t.AddressDependency=s;var u=function(){function e(t,r){i(this,e),this.start=t,this.end=r}return o(e,[{key:"absolutize",value:function(e){return new n.AbsoluteCellRange(this.start.toSimpleCellAddress(e),this.end.toSimpleCellAddress(e))}}]),e}();t.CellRangeDependency=u;var c=function(){function e(t,r){i(this,e),this.start=t,this.end=r}return o(e,[{key:"absolutize",value:function(e){var t=this.start.toSimpleColumnAddress(e),r=this.end.toSimpleColumnAddress(e);return new n.AbsoluteColumnRange(t.sheet,t.col,r.col)}}]),e}();t.ColumnRangeDependency=c;var l=function(){function e(t,r){i(this,e),this.start=t,this.end=r}return o(e,[{key:"absolutize",value:function(e){var t=this.start.toSimpleRowAddress(e),r=this.end.toSimpleRowAddress(e);return new n.AbsoluteRowRange(t.sheet,t.row,r.row)}}]),e}();t.RowRangeDependency=l;var h=function(){function e(t){i(this,e),this.name=t}return o(e,[{key:"absolutize",value:function(e){return this}}]),e}();t.NamedExpressionDependency=h},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */t.__esModule=!0,t.ColumnsSpan=t.RowsSpan=void 0,r(125);var o=function(){function e(t,r,i){if(n(this,e),this.sheet=t,this.rowStart=r,this.rowEnd=i,r<0)throw Error("Starting row cant be less than 0");if(i<r)throw Error("Row span cant end before start")}return a(e,[{key:"rows",value:regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.rowStart;case 1:if(!(t<=this.rowEnd)){e.next=7;break}return e.next=4,t;case 4:++t,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))},{key:"intersect",value:function(t){if(this.sheet!==t.sheet)throw Error("Can't intersect spans from different sheets");var r=Math.max(this.rowStart,t.rowStart),n=Math.min(this.rowEnd,t.rowEnd);return r>n?null:new e(this.sheet,r,n)}},{key:"firstRow",value:function(){return new e(this.sheet,this.rowStart,this.rowStart)}},{key:"numberOfRows",get:function(){return this.rowEnd-this.rowStart+1}},{key:"start",get:function(){return this.rowStart}},{key:"end",get:function(){return this.rowEnd}}],[{key:"fromNumberOfRows",value:function(t,r,n){return new e(t,r,r+n-1)}},{key:"fromRowStartAndEnd",value:function(t,r,n){return new e(t,r,n)}}]),e}();t.RowsSpan=o;var s=function(){function e(t,r,i){if(n(this,e),this.sheet=t,this.columnStart=r,this.columnEnd=i,r<0)throw Error("Starting column cant be less than 0");if(i<r)throw Error("Column span cant end before start")}return a(e,[{key:"columns",value:regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.columnStart;case 1:if(!(t<=this.columnEnd)){e.next=7;break}return e.next=4,t;case 4:++t,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))},{key:"intersect",value:function(t){if(this.sheet!==t.sheet)throw Error("Can't intersect spans from different sheets");var r=Math.max(this.columnStart,t.columnStart),n=Math.min(this.columnEnd,t.columnEnd);return r>n?null:new e(this.sheet,r,n)}},{key:"firstColumn",value:function(){return new e(this.sheet,this.columnStart,this.columnStart)}},{key:"numberOfColumns",get:function(){return this.columnEnd-this.columnStart+1}},{key:"start",get:function(){return this.columnStart}},{key:"end",get:function(){return this.columnEnd}}],[{key:"fromNumberOfColumns",value:function(t,r,n){return new e(t,r,r+n-1)}},{key:"fromColumnStartAndEnd",value:function(t,r,n){return new e(t,r,n)}}]),e}();t.ColumnsSpan=s},function(e,t,r){"use strict";r(113),t.__esModule=!0,t.absolutizeDependencies=void 0,t.absolutizeDependencies=function(e,t){return e.map((function(e){return e.absolutize(t)}))}},function(e,t,r){"use strict";t.__esModule=!0,t.StatType=t.Statistics=t.EmptyStatistics=void 0;var n=r(220);t.EmptyStatistics=n.EmptyStatistics;var i=r(221);t.Statistics=i.Statistics;var a=r(222);t.StatType=a.StatType},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var i=c(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r(1),r(63),r(64),r(75),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.EmptyStatistics=void 0;var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(c,e);var t,r,n,u=s(c);function c(){return i(this,c),u.apply(this,arguments)}return t=c,(r=[{key:"incrementCriterionFunctionFullCacheUsed",value:function(){}},{key:"incrementCriterionFunctionPartialCacheUsed",value:function(){}},{key:"start",value:function(e){}},{key:"end",value:function(e){}}])&&a(t.prototype,r),n&&a(t,n),c}(r(221).Statistics);t.EmptyStatistics=l},function(e,t,r){"use strict";r(75),r(207),r(92),r(98),r(104),t.__esModule=!0,t.Statistics=void 0;var n=r(222);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.stats=new Map([[n.StatType.CRITERION_FUNCTION_FULL_CACHE_USED,0],[n.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]),this.startTimes=new Map}var t,r,a;return t=e,(r=[{key:"incrementCriterionFunctionFullCacheUsed",value:function(){var e=(this.stats.get(n.StatType.CRITERION_FUNCTION_FULL_CACHE_USED)||0)+1;this.stats.set(n.StatType.CRITERION_FUNCTION_FULL_CACHE_USED,e)}},{key:"incrementCriterionFunctionPartialCacheUsed",value:function(){var e=(this.stats.get(n.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED)||0)+1;this.stats.set(n.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED,e)}},{key:"reset",value:function(){this.stats.clear(),this.startTimes.clear(),this.stats.set(n.StatType.CRITERION_FUNCTION_FULL_CACHE_USED,0),this.stats.set(n.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}},{key:"start",value:function(e){if(this.startTimes.get(e))throw Error("Statistics ".concat(e," already started"));this.startTimes.set(e,Date.now())}},{key:"end",value:function(e){var t=Date.now(),r=this.startTimes.get(e);if(!r)throw Error("Statistics ".concat(e," not started"));var n=this.stats.get(e)||0;n+=t-r,this.stats.set(e,n),this.startTimes.delete(e)}},{key:"measure",value:function(e,t){this.start(e);var r=t();return this.end(e),r}},{key:"snapshot",value:function(){return new Map(this.stats)}},{key:"destroy",value:function(){this.stats.clear(),this.startTimes.clear()}}])&&i(t.prototype,r),a&&i(t,a),e}();t.Statistics=a},function(e,t,r){"use strict";
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */
var n;t.__esModule=!0,t.StatType=void 0,t.StatType=n,function(e){e.BUILD_ENGINE_TOTAL="BUILD_ENGINE_TOTAL",e.PARSER="PARSER",e.GRAPH_BUILD="GRAPH_BUILD",e.TOP_SORT="TOP_SORT",e.MATRIX_DETECTION="MATRIX_DETECTION",e.BUILD_COLUMN_INDEX="BUILD_COLUMN_INDEX",e.EVALUATION="EVALUATION",e.VLOOKUP="VLOOKUP",e.TRANSFORM_ASTS="TRANSFORM_ASTS",e.TRANSFORM_ASTS_POSTPONED="TRANSFORM_ASTS_POSTPONED",e.ADJUSTING_ADDRESS_MAPPING="ADJUSTING_ADDRESS_MAPPING",e.ADJUSTING_MATRIX_MAPPING="ADJUSTING_MATRIX_MAPPING",e.ADJUSTING_RANGES="ADJUSTING_RANGES",e.ADJUSTING_GRAPH="ADJUSTING_GRAPH",e.CRITERION_FUNCTION_FULL_CACHE_USED="CRITERION_FUNCTION_FULL_CACHE_USED",e.CRITERION_FUNCTION_PARTIAL_CACHE_USED="CRITERION_FUNCTION_PARTIAL_CACHE_USED"}(n||(t.StatType=n={}))},function(e,t,r){"use strict";r(1),r(63),r(64),r(224),r(65),r(75),r(84),r(89),r(207),r(92),r(96),r(98),r(104),t.__esModule=!0,t.AddressMapping=void 0,r(125);var n=r(106),i=r(107),a=r(226);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=u(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function u(e,t){if(e){if("string"==typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.policy=t,this.mapping=new Map}var t,r,u;return t=e,(r=[{key:"getCell",value:function(e){var t=this.mapping.get(e.sheet);if(!t)throw new a.NoSheetWithIdError(e.sheet);return t.getCell(e)}},{key:"fetchCell",value:function(e){var t=this.mapping.get(e.sheet);if(!t)throw new a.NoSheetWithIdError(e.sheet);var r=t.getCell(e);if(!r)throw Error("Vertex for address missing in AddressMapping");return r}},{key:"strategyFor",value:function(e){var t=this.mapping.get(e);if(!t)throw new a.NoSheetWithIdError(e);return t}},{key:"addSheet",value:function(e,t){if(this.mapping.has(e))throw Error("Sheet already added");this.mapping.set(e,t)}},{key:"autoAddSheet",value:function(e,t,r){var n=r.height,i=r.width,a=r.fill,o=this.policy.call(a);this.addSheet(e,new o(i,n))}},{key:"getCellValue",value:function(e){var t=this.getCell(e);return null===t?n.EmptyValue:t instanceof i.MatrixVertex?t.getMatrixCellValue(e):t.getCellValue()}},{key:"setCell",value:function(e,t){var r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized");r.setCell(e,t)}},{key:"removeCell",value:function(e){var t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet not initialized");t.removeCell(e)}},{key:"has",value:function(e){var t=this.mapping.get(e.sheet);return!!t&&t.has(e)}},{key:"getHeight",value:function(e){var t=this.mapping.get(e);if(!t)throw new a.NoSheetWithIdError(e);return t.getHeight()}},{key:"getWidth",value:function(e){var t=this.mapping.get(e);if(!t)throw new a.NoSheetWithIdError(e);return t.getWidth()}},{key:"addRows",value:function(e,t,r){var n=this.mapping.get(e);if(!n)throw Error("Sheet does not exist");n.addRows(t,r)}},{key:"removeRows",value:function(e){var t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet does not exist");t.removeRows(e)}},{key:"removeSheet",value:function(e){this.mapping.delete(e)}},{key:"addColumns",value:function(e,t,r){var n=this.mapping.get(e);if(!n)throw Error("Sheet does not exist");n.addColumns(t,r)}},{key:"removeColumns",value:function(e){var t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet does not exist");t.removeColumns(e)}},{key:"verticesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.mapping.get(t.sheet).verticesFromRowsSpan(t),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"verticesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.mapping.get(t.sheet).verticesFromColumnsSpan(t),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.mapping.get(t.sheet).entriesFromRowsSpan(t),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.mapping.get(t.sheet).entriesFromColumnsSpan(t),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"entries",value:regeneratorRuntime.mark((function e(){var t,r,n,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=s(this.mapping.entries()),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=8;break}return n=o(r.value,2),i=n[0],a=n[1],e.delegateYield(a.getEntries(i),"t0",6);case 6:e.next=3;break;case 8:e.next=13;break;case 10:e.prev=10,e.t1=e.catch(1),t.e(e.t1);case 13:return e.prev=13,t.f(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[1,10,13,16]])}))},{key:"sheetEntries",value:regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.mapping.get(t))){e.next=5;break}return e.delegateYield(r.getEntries(t),"t0",3);case 3:e.next=6;break;case 5:throw new Error("Sheet does not exists");case 6:case"end":return e.stop()}}),e,this)}))},{key:"destroy",value:function(){this.mapping.clear()}}])&&l(t.prototype,r),u&&l(t,u),e}();t.AddressMapping=h},function(e,t,r){var n=r(2),i=r(225),a=r(76);n({target:"Array",proto:!0},{fill:i}),a("fill")},function(e,t,r){"use strict";var n=r(49),i=r(42),a=r(40);e.exports=function(e){for(var t=n(this),r=a(t.length),o=arguments.length,s=i(o>1?arguments[1]:void 0,r),u=o>2?arguments[2]:void 0,c=void 0===u?r:i(u,r);c>s;)t[s++]=e;return t}},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function u(e){var t=p();return function(){var r,n=d(e);if(t){var i=d(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){var t="function"==typeof Map?new Map:void 0;return(l=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return h(e,arguments,d(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),f(n,e)})(e)}function h(e,t,r){return(h=p()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&f(i,r.prototype),i}).apply(null,arguments)}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */r(1),r(63),r(64),r(109),r(227),r(75),r(207),r(91),r(92),r(94),r(142),r(144),r(96),r(98),r(104),t.__esModule=!0,t.NoRelativeAddressesAllowedError=t.MatrixFormulasNotSupportedError=t.TargetLocationHasMatrixError=t.SourceLocationHasMatrixError=t.ProtectedFunctionError=t.FunctionPluginValidationError=t.LanguageAlreadyRegisteredError=t.LanguageNotRegisteredError=t.ProtectedFunctionTranslationError=t.MissingTranslationError=t.EvaluationSuspendedError=t.ExpectedOneOfValuesError=t.ConfigValueTooBigError=t.ConfigValueTooSmallError=t.ExpectedValueOfTypeError=t.UnableToParseError=t.NothingToPasteError=t.NoOperationToRedoError=t.NoOperationToUndoError=t.NamedExpressionDoesNotExistError=t.NamedExpressionNameIsInvalidError=t.NamedExpressionNameIsAlreadyTakenError=t.InvalidArgumentsError=t.InvalidAddressError=t.NotAFormulaError=t.SheetSizeLimitExceededError=t.SheetNameAlreadyTakenError=t.NoSheetWithNameError=t.NoSheetWithIdError=void 0;var m=function(e){s(r,e);var t=u(r);function r(e){return o(this,r),t.call(this,"There's no sheet with id = ".concat(e))}return r}(l(Error));t.NoSheetWithIdError=m;var y=function(e){s(r,e);var t=u(r);function r(e){return o(this,r),t.call(this,"There's no sheet with name '".concat(e,"'"))}return r}(l(Error));t.NoSheetWithNameError=y;var g=function(e){s(r,e);var t=u(r);function r(e){return o(this,r),t.call(this,"Sheet with name ".concat(e," already exists"))}return r}(l(Error));t.SheetNameAlreadyTakenError=g;var v=function(e){s(r,e);var t=u(r);function r(){return o(this,r),t.call(this,"Sheet size limit exceeded")}return r}(l(Error));t.SheetSizeLimitExceededError=v;var E=function(e){s(r,e);var t=u(r);function r(){return o(this,r),t.call(this,"This is not a formula")}return r}(l(Error));t.NotAFormulaError=E;var T=function(e){s(r,e);var t=u(r);function r(e){return o(this,r),t.call(this,"Address (row = ".concat(e.row,", col = ").concat(e.col,") is invalid"))}return r}(l(Error));t.InvalidAddressError=T;var b=function(e){s(r,e);var t=u(r);function r(e){return o(this,r),t.call(this,"Invalid arguments, expected ".concat(e))}return r}(l(Error));t.InvalidArgumentsError=b;var x=function(e){s(r,e);var t=u(r);function r(e){return o(this,r),t.call(this,"Name of Named Expression '".concat(e,"' is already present"))}return r}(l(Error));t.NamedExpressionNameIsAlreadyTakenError=x;var A=function(e){s(r,e);var t=u(r);function r(e){return o(this,r),t.call(this,"Name of Named Expression '".concat(e,"' is invalid"))}return r}(l(Error));t.NamedExpressionNameIsInvalidError=A;var S=function(e){s(r,e);var t=u(r);function r(e){return o(this,r),t.call(this,"Named Expression '".concat(e,"' does not exist"))}return r}(l(Error));t.NamedExpressionDoesNotExistError=S;var R=function(e){s(r,e);var t=u(r);function r(){return o(this,r),t.call(this,"There is no operation to undo")}return r}(l(Error));t.NoOperationToUndoError=R;var w=function(e){s(r,e);var t=u(r);function r(){return o(this,r),t.call(this,"There is no operation to redo")}return r}(l(Error));t.NoOperationToRedoError=w;var C=function(e){s(r,e);var t=u(r);function r(){return o(this,r),t.call(this,"There is nothing to paste")}return r}(l(Error));function O(e,t){switch(a(t)){case"function":case"symbol":return t.toString();case"bigint":return"BigInt("+t.toString()+")";default:return t instanceof RegExp?"RegExp("+t.toString()+")":t}}t.NothingToPasteError=C;var k=function(e){s(r,e);var t=u(r);function r(e){return o(this,r),t.call(this,"Unable to parse value: ".concat(JSON.stringify(e,O,4)))}return r}(l(Error));t.UnableToParseError=k;var N=function(e){s(r,e);var t=u(r);function r(e,n){return o(this,r),t.call(this,"Expected value of type: ".concat(e," for config parameter: ").concat(n))}return r}(l(Error));t.ExpectedValueOfTypeError=N;var _=function(e){s(r,e);var t=u(r);function r(e,n){return o(this,r),t.call(this,"Config parameter ".concat(e," should be at least ").concat(n))}return r}(l(Error));t.ConfigValueTooSmallError=_;var I=function(e){s(r,e);var t=u(r);function r(e,n){return o(this,r),t.call(this,"Config parameter ".concat(e," should be at most ").concat(n))}return r}(l(Error));t.ConfigValueTooBigError=I;var M=function(e){s(r,e);var t=u(r);function r(e,n){return o(this,r),t.call(this,"Expected one of ".concat(e," for config parameter: ").concat(n))}return r}(l(Error));t.ExpectedOneOfValuesError=M;var P=function(e){s(r,e);var t=u(r);function r(){return o(this,r),t.call(this,"Computations are suspended")}return r}(l(Error));t.EvaluationSuspendedError=P;var L=function(e){s(r,e);var t=u(r);function r(e){return o(this,r),t.call(this,"Translation for ".concat(e," is missing in the translation package you're using."))}return r}(l(Error));t.MissingTranslationError=L;var F=function(e){s(r,e);var t=u(r);function r(e){return o(this,r),t.call(this,"Cannot register translation for function with id: ".concat(e))}return r}(l(Error));t.ProtectedFunctionTranslationError=F;var D=function(e){s(r,e);var t=u(r);function r(){return o(this,r),t.call(this,"Language not registered.")}return r}(l(Error));t.LanguageNotRegisteredError=D;var U=function(e){s(r,e);var t=u(r);function r(){return o(this,r),t.call(this,"Language already registered.")}return r}(l(Error));t.LanguageAlreadyRegisteredError=U;var V=function(e){s(r,e);var t=u(r);function r(){return o(this,r),t.apply(this,arguments)}return i(r,null,[{key:"functionNotDeclaredInPlugin",value:function(e,t){return new r("Function with id ".concat(e," not declared in plugin ").concat(t))}},{key:"functionMethodNotFound",value:function(e,t){return new r("Function method ".concat(e," not found in plugin ").concat(t))}}]),r}(l(Error));t.FunctionPluginValidationError=V;var j=function(e){s(r,e);var t=u(r);function r(){return o(this,r),t.apply(this,arguments)}return i(r,null,[{key:"cannotRegisterFunctionWithId",value:function(e){return new r("Cannot register function with id ".concat(e))}},{key:"cannotUnregisterFunctionWithId",value:function(e){return new r("Cannot unregister function with id ".concat(e))}},{key:"cannotUnregisterProtectedPlugin",value:function(){return new r("Cannot unregister protected plugin")}}]),r}(l(Error));t.ProtectedFunctionError=j;var G=function(e){s(r,e);var t=u(r);function r(){return o(this,r),t.call(this,"Cannot perform this operation, source location has a matrix inside.")}return r}(l(Error));t.SourceLocationHasMatrixError=G;var B=function(e){s(r,e);var t=u(r);function r(){return o(this,r),t.call(this,"Cannot perform this operation, target location has a matrix inside.")}return r}(l(Error));t.TargetLocationHasMatrixError=B;var z=function(e){s(r,e);var t=u(r);function r(){return o(this,r),t.call(this,"Matrix formulas are not supported in named expressions.")}return r}(l(Error));t.MatrixFormulasNotSupportedError=z;var W=function(e){s(r,e);var t=u(r);function r(){return o(this,r),t.call(this,"Relative addresses not allowed in named expressions.")}return r}(l(Error));t.NoRelativeAddressesAllowedError=W},function(e,t,r){"use strict";var n=r(2),i=r(39).indexOf,a=r(112),o=r(88),s=[].indexOf,u=!!s&&1/[1].indexOf(1,-0)<0,c=a("indexOf"),l=o("indexOf",{ACCESSORS:!0,1:0});n({target:"Array",proto:!0,forced:u||!c||!l},{indexOf:function(e){return u?s.apply(this,arguments)||0:i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,r){"use strict";r(229),r(65),r(113),r(98),t.__esModule=!0,t.collectAddressesDependentToMatrix=void 0;var n=r(138),i=r(230),a=r(231),o=r(234);t.collectAddressesDependentToMatrix=function(e,t,r,s,u){var c,l,h=r.getRange();if(t instanceof o.RangeVertex){var p=t.range.intersectionWith(h);return null!==p?Array.from(p.addresses(u)):[]}if(t instanceof i.FormulaCellVertex)c=t.getFormula(s),l=t.getAddress(s);else{if(!(t instanceof a.MatrixVertex&&t.isFormula()))return[];c=t.getFormula(),l=t.getAddress()}return(0,n.collectDependencies)(c,e).filter((function(e){return e instanceof n.AddressDependency})).map((function(e){return e.dependency.toSimpleCellAddress(l)})).filter((function(e){return h.addressInRange(e)}))}},function(e,t,r){"use strict";var n=r(2),i=r(59).filter,a=r(85),o=r(88),s=a("filter"),u=o("filter");n({target:"Array",proto:!0,forced:!s||!u},{filter:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r(1),r(63),r(64),r(65),r(75),r(84),r(89),r(92),r(96),r(98),r(104),t.__esModule=!0,t.FormulaCellVertex=void 0;
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */
var o=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.formula=t,this.cellAddress=r,this.version=n,this.formula=t,this.cellAddress=r,this.cachedCellValue=null}var t,r,i;return t=e,(r=[{key:"getFormula",value:function(e){return this.ensureRecentData(e),this.formula}},{key:"ensureRecentData",value:function(e){if(this.version!=e.version()){var t=n(e.applyTransformations(this.formula,this.address,this.version),3),r=t[0],i=t[1],a=t[2];this.formula=r,this.cellAddress=i,this.version=a}}},{key:"getAddress",value:function(e){return this.ensureRecentData(e),this.cellAddress}},{key:"setCellValue",value:function(e){this.cachedCellValue=e}},{key:"getCellValue",value:function(){if(null!==this.cachedCellValue)return this.cachedCellValue;throw Error("Value of the formula cell is not computed.")}},{key:"valueOrNull",value:function(){return this.cachedCellValue}},{key:"isComputed",value:function(){return null!==this.cachedCellValue}},{key:"address",get:function(){return this.cellAddress}}])&&a(t.prototype,r),i&&a(t,i),e}();t.FormulaCellVertex=o},function(e,t,r){"use strict";t.__esModule=!0,t.MatrixVertex=void 0;var n=r(132),i=r(232),a=r(217);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(t,r,n,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cellAddress=t,this.formula=a||null,this.matrix=new i.NotComputedMatrix(new i.MatrixSize(r,n))}var t,r,s;return t=e,s=[{key:"fromRange",value:function(t,r){return new e(t.start,t.width(),t.height(),r)}}],(r=[{key:"setCellValue",value:function(e){this.matrix=e}},{key:"setErrorValue",value:function(e){this.matrix=new i.ErroredMatrix(e,this.matrix.size)}},{key:"getCellValue",value:function(){if(this.matrix instanceof i.NotComputedMatrix)throw Error("Matrix not computed yet.");return this.matrix}},{key:"getMatrixCellValue",value:function(e){var t=e.col-this.cellAddress.col,r=e.row-this.cellAddress.row;return this.matrix.get(t,r)}},{key:"setMatrixCellValue",value:function(e,t){var r=e.col-this.cellAddress.col,n=e.row-this.cellAddress.row;this.matrix instanceof i.Matrix&&this.matrix.set(r,n,t)}},{key:"getRange",value:function(){return n.AbsoluteCellRange.spanFrom(this.cellAddress,this.width,this.height)}},{key:"getAddress",value:function(){return this.cellAddress}},{key:"setAddress",value:function(e){this.cellAddress=e}},{key:"getFormula",value:function(){return this.formula}},{key:"setFormula",value:function(e){this.formula=e}},{key:"isFormula",value:function(){return null!==this.formula}},{key:"isNumeric",value:function(){return null===this.formula}},{key:"spansThroughSheetRows",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;return this.cellAddress.sheet===e&&this.cellAddress.row<=r&&t<this.cellAddress.row+this.height}},{key:"spansThroughSheetColumn",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;return this.cellAddress.sheet===e&&this.cellAddress.col<=r&&t<this.cellAddress.col+this.width}},{key:"addRows",value:function(e,t,r){this.matrix instanceof i.Matrix&&this.matrix.addRows(t-this.getAddress().row,r)}},{key:"addColumns",value:function(e,t,r){this.matrix instanceof i.Matrix&&this.matrix.addColumns(t-this.getAddress().col,r)}},{key:"removeRows",value:function(e){if(this.matrix instanceof i.Matrix){var t=this.rowsFromMatrix().intersect(e);this.matrix.removeRows(t.rowStart-this.getAddress().row,t.rowEnd-this.getAddress().row)}}},{key:"removeColumns",value:function(e){if(this.matrix instanceof i.Matrix){var t=this.columnsFromMatrix().intersect(e);this.matrix.removeColumns(t.columnStart-this.getAddress().col,t.columnEnd-this.getAddress().col)}}},{key:"isComputed",value:function(){return!(this.matrix instanceof i.NotComputedMatrix)}},{key:"columnsFromMatrix",value:function(){return a.ColumnsSpan.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}},{key:"rowsFromMatrix",value:function(){return a.RowsSpan.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}},{key:"width",get:function(){return this.matrix.width()}},{key:"height",get:function(){return this.matrix.height()}},{key:"sheet",get:function(){return this.cellAddress.sheet}}])&&o(t.prototype,r),s&&o(t,s),e}();t.MatrixVertex=s},function(e,t,r){"use strict";r(1),r(63),r(64),r(109),r(224),r(65),r(75),r(84),r(206),r(233),r(89),r(92),r(96),r(98),r(104),t.__esModule=!0,t.matrixSizeForTranspose=d,t.matrixSizeForMultiplication=m,t.matrixSizeForPoolFunction=y,t.checkMatrixSize=function e(t,r){if(t.type!==o.AstNodeType.FUNCTION_CALL){if(t.type===o.AstNodeType.CELL_RANGE){var s=n.AbsoluteCellRange.fromCellRange(t,r);return{width:s.width(),height:s.height()}}return t.type===o.AstNodeType.NUMBER||t.type===o.AstNodeType.CELL_REFERENCE?{width:1,height:1}:new i.CellError(i.ErrorType.VALUE)}switch(t.procedureName){case"MMULT":if(2!==t.args.length)return new i.CellError(i.ErrorType.NA,a.ErrorMessage.WrongArgNumber);if(t.args.some((function(e){return e.type===o.AstNodeType.EMPTY})))return new i.CellError(i.ErrorType.NUM,a.ErrorMessage.EmptyArg);var u=e(t.args[0],r),c=e(t.args[1],r);return u instanceof i.CellError?u:c instanceof i.CellError?c:u.width!==c.height?new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.MatrixDimensions):m(u,c);case"MEDIANPOOL":case"MAXPOOL":if(t.args.length<2||t.args.length>3)return new i.CellError(i.ErrorType.NA,a.ErrorMessage.WrongArgNumber);if(t.args.some((function(e){return e.type===o.AstNodeType.EMPTY})))return new i.CellError(i.ErrorType.NUM,a.ErrorMessage.EmptyArg);var l=e(t.args[0],r),h=t.args[1];if(l instanceof i.CellError)return l;if(h.type!==o.AstNodeType.NUMBER)return new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.NumberExpected);var p=h.value,f=h.value;if(3===t.args.length){var g=t.args[2];if(g.type!==o.AstNodeType.NUMBER)return new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.MatrixParams);f=g.value}return p>l.width||p>l.height||f>p||(l.width-p)%f!=0||(l.height-p)%f!=0?new i.CellError(i.ErrorType.VALUE):y(l,p,f);case"TRANSPOSE":if(1!==t.args.length)return new i.CellError(i.ErrorType.NA,a.ErrorMessage.WrongArgNumber);if(t.args[0].type===o.AstNodeType.EMPTY)return new i.CellError(i.ErrorType.NUM,a.ErrorMessage.EmptyArg);var v=e(t.args[0],r);return v instanceof i.CellError?v:d(v);default:return new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.MatrixFunction)}},t.ErroredMatrix=t.Matrix=t.NotComputedMatrix=t.MatrixSize=void 0,r(125);var n=r(132),i=r(106),a=r(213),o=r(138);function s(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(e){if("string"==typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),e}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var f=function e(t,r){if(p(this,e),this.width=t,this.height=r,t<=0||r<=0)throw Error("Incorrect matrix size")};function d(e){return new f(e.height,e.width)}function m(e,t){return new f(t.width,e.height)}function y(e,t,r){return new f(1+(e.width-t)/r,1+(e.height-t)/r)}t.MatrixSize=f;var g=function(){function e(t){p(this,e),this.size=t}return h(e,[{key:"width",value:function(){return this.size.width}},{key:"height",value:function(){return this.size.height}},{key:"get",value:function(e,t){throw Error("Matrix not computed yet.")}}]),e}();t.NotComputedMatrix=g;var v=function(){function e(t){p(this,e),this.size=new f(t.length>0?t[0].length:0,t.length),this.matrix=t}return h(e,[{key:"addRows",value:function(e,t){var r;(r=this.matrix).splice.apply(r,[e,0].concat(s(this.zeroArrays(t,this.width())))),this.size.height+=t}},{key:"addColumns",value:function(e,t){for(var r=0;r<this.height();r++){var n;(n=this.matrix[r]).splice.apply(n,[e,0].concat(s(new Array(t).fill(0))))}this.size.width+=t}},{key:"removeRows",value:function(e,t){if(this.outOfBound(0,e)||this.outOfBound(0,t))throw Error("Matrix index out of bound");var r=t-e+1;this.matrix.splice(e,r),this.size.height-=r}},{key:"removeColumns",value:function(e,t){if(this.outOfBound(e,0)||this.outOfBound(t,0))throw Error("Matrix index out of bound");var r,n=t-e+1,i=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=u(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}(this.matrix);try{for(i.s();!(r=i.n()).done;)r.value.splice(e,n)}catch(e){i.e(e)}finally{i.f()}this.size.width-=n}},{key:"zeroArrays",value:function(e,t){for(var r=[],n=0;n<e;++n)r.push(new Array(t).fill(0));return r}},{key:"get",value:function(e,t){if(this.outOfBound(e,t))throw Error("Matrix index out of bound");return this.matrix[t][e]}},{key:"set",value:function(e,t,r){if(this.outOfBound(e,t))throw Error("Matrix index out of bound");this.matrix[t][e]=r}},{key:"width",value:function(){return this.size.width}},{key:"height",value:function(){return this.size.height}},{key:"raw",value:function(){return this.matrix}},{key:"generateValues",value:regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0;case 1:if(!(r<this.size.height)){e.next=12;break}n=0;case 3:if(!(n<this.size.width)){e.next=9;break}return e.next=6,[this.matrix[r][n],(0,i.simpleCellAddress)(t.sheet,t.col+n,t.row+r)];case 6:++n,e.next=3;break;case 9:++r,e.next=1;break;case 12:case"end":return e.stop()}}),e,this)}))},{key:"outOfBound",value:function(e,t){return e<0||t<0||t>this.size.height-1||e>this.size.width-1}}]),e}();t.Matrix=v;var E=function(){function e(t,r){p(this,e),this.error=t,this.size=r}return h(e,[{key:"get",value:function(e,t){return this.error}},{key:"width",value:function(){return this.size.width}},{key:"height",value:function(){return this.size.height}}]),e}();t.ErroredMatrix=E},function(e,t,r){"use strict";var n=r(2),i=r(42),a=r(41),o=r(40),s=r(49),u=r(62),c=r(70),l=r(85),h=r(88),p=l("splice"),f=h("splice",{ACCESSORS:!0,0:0,1:2}),d=Math.max,m=Math.min;n({target:"Array",proto:!0,forced:!p||!f},{splice:function(e,t){var r,n,l,h,p,f,y=s(this),g=o(y.length),v=i(e,g),E=arguments.length;if(0===E?r=n=0:1===E?(r=0,n=g-v):(r=E-2,n=m(d(a(t),0),g-v)),g+r-n>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(l=u(y,n),h=0;h<n;h++)(p=v+h)in y&&c(l,h,y[p]);if(l.length=n,r<n){for(h=v;h<g-n;h++)f=h+r,(p=h+n)in y?y[f]=y[p]:delete y[f];for(h=g;h>g-n+r;h--)delete y[h-1]}else if(r>n)for(h=g-n;h>v;h--)f=h+r-1,(p=h+n-1)in y?y[f]=y[p]:delete y[f];for(h=0;h<r;h++)y[h+v]=arguments[h+2];return y.length=g-n+r,l}})},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r(110),r(75),r(207),r(92),r(114),r(98),r(124),r(104),t.__esModule=!0,t.RangeVertex=void 0;
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */
var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.range=t,this.functionCache=new Map,this.criterionFunctionCache=new Map,this.dependentCacheRanges=new Set,this.bruteForce=!1}var t,r,i;return t=e,(r=[{key:"getFunctionValue",value:function(e){return this.functionCache.get(e)||null}},{key:"setFunctionValue",value:function(e,t){this.functionCache.set(e,t)}},{key:"getCriterionFunctionValue",value:function(e,t){var r=this.getCriterionFunctionValues(e).get(t);return r?r[0]:null}},{key:"getCriterionFunctionValues",value:function(e){return this.criterionFunctionCache.get(e)||new Map}},{key:"setCriterionFunctionValues",value:function(e,t){this.criterionFunctionCache.set(e,t)}},{key:"addDependentCacheRange",value:function(e){e!==this&&this.dependentCacheRanges.add(e)}},{key:"clearCache",value:function(){this.functionCache.clear(),this.criterionFunctionCache.clear(),this.dependentCacheRanges.forEach((function(e){return e.criterionFunctionCache.clear()})),this.dependentCacheRanges.clear()}},{key:"getStart",value:function(){return this.start}},{key:"getEnd",value:function(){return this.end}},{key:"start",get:function(){return this.range.start}},{key:"end",get:function(){return this.range.end}},{key:"sheet",get:function(){return this.range.start.sheet}}])&&n(t.prototype,r),i&&n(t,i),e}();t.RangeVertex=i},function(e,t,r){"use strict";function n(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw o}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */
var o;r(1),r(63),r(64),r(110),r(65),r(75),r(236),r(84),r(89),r(207),r(92),r(96),r(114),r(98),r(124),r(104),t.__esModule=!0,t.Graph=void 0,function(e){e[e.ON_STACK=0]="ON_STACK",e[e.PROCESSED=1]="PROCESSED",e[e.POPPED=2]="POPPED"}(o||(o={}));var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dependencyQuery=t,this.nodes=new Set,this.specialNodes=new Set,this.specialNodesStructuralChanges=new Set,this.specialNodesRecentlyChanged=new Set,this.infiniteRanges=new Set,this.edges=new Map}var t,r,i;return t=e,(r=[{key:"addNode",value:function(e){this.nodes.add(e),this.edges.has(e)||this.edges.set(e,new Set)}},{key:"addEdge",value:function(e,t){if(!this.nodes.has(e))throw new Error("Unknown node ".concat(e));if(!this.nodes.has(t))throw new Error("Unknown node ".concat(t));this.edges.get(e).add(t)}},{key:"removeEdge",value:function(e,t){if(!this.existsEdge(e,t))throw new Error("Edge does not exist");this.edges.get(e).delete(t)}},{key:"softRemoveEdge",value:function(e,t){var r;null===(r=this.edges.get(e))||void 0===r||r.delete(t)}},{key:"removeIncomingEdges",value:function(e){this.edges.forEach((function(t){t.delete(e)}))}},{key:"adjacentNodes",value:function(e){return this.edges.get(e)}},{key:"adjacentNodesCount",value:function(e){return this.adjacentNodes(e).size}},{key:"hasNode",value:function(e){return this.nodes.has(e)}},{key:"nodesCount",value:function(){return this.nodes.size}},{key:"edgesCount",value:function(){var e=0;return this.edges.forEach((function(t){return e+=t.size})),e}},{key:"removeNode",value:function(e){var t,r=n(this.adjacentNodes(e).values());try{for(r.s();!(t=r.n()).done;){var i=t.value;this.markNodeAsSpecialRecentlyChanged(i)}}catch(e){r.e(e)}finally{r.f()}return this.edges.delete(e),this.nodes.delete(e),this.specialNodes.delete(e),this.specialNodesRecentlyChanged.delete(e),this.specialNodesStructuralChanges.delete(e),this.infiniteRanges.delete(e),this.removeDependencies(e)}},{key:"markNodeAsSpecial",value:function(e){this.specialNodes.add(e)}},{key:"markNodeAsSpecialRecentlyChanged",value:function(e){this.nodes.has(e)&&this.specialNodesRecentlyChanged.add(e)}},{key:"markNodeAsChangingWithStructure",value:function(e){this.specialNodesStructuralChanges.add(e)}},{key:"clearSpecialNodesRecentlyChanged",value:function(){this.specialNodesRecentlyChanged.clear()}},{key:"markNodeAsInfiniteRange",value:function(e){this.infiniteRanges.add(e)}},{key:"existsEdge",value:function(e,t){var r,n;return null!==(n=null===(r=this.edges.get(e))||void 0===r?void 0:r.has(t))&&void 0!==n&&n}},{key:"topSortWithScc",value:function(){return this.getTopSortedWithSccSubgraphFrom(Array.from(this.nodes),(function(e){return!0}),(function(e){}))}},{key:"getTopSortedWithSccSubgraphFrom",value:function(e,t,r){var n=this,i=new Map,a=new Map,s=new Map,u=new Map,c=[],l=0;e.reverse().forEach((function(e){if(void 0===u.get(e)){l++;var t=[e];u.set(e,o.ON_STACK);for(var r=function(){var e=t[t.length-1];switch(u.get(e)){case o.ON_STACK:u.set(e,o.PROCESSED),i.set(e,l),a.set(e,l),n.adjacentNodes(e).forEach((function(r){switch(u.get(r)){case o.POPPED:break;case o.PROCESSED:a.set(e,Math.min(a.get(e),i.get(r)));break;case void 0:case o.ON_STACK:s.set(r,e),t.push(r),u.set(r,o.ON_STACK),l++}}));break;case o.PROCESSED:var r=s.get(e);null!==r&&a.set(r,Math.min(a.get(r),a.get(e))),u.set(e,o.POPPED),c.push(e),t.pop();break;case o.POPPED:t.pop()}};t.length>0;)r()}}));var h=new Map,p=new Set;c.reverse(),c.forEach((function(e){i.get(e)===a.get(e)?h.set(e,e):h.set(e,h.get(s.get(e)))})),this.edges.forEach((function(e,t){e.forEach((function(e){var r=h.get(e);r===h.get(t)&&p.add(r)}))}));var f=new Set(e),d=[],m=[];return c.forEach((function(e){p.has(h.get(e))?(m.push(e),r(e),n.adjacentNodes(e).forEach((function(e){return f.add(e)}))):(d.push(e),f.has(e)&&t(e)&&n.adjacentNodes(e).forEach((function(e){return f.add(e)})))})),{sorted:d,cycled:m}}},{key:"getDependencies",value:function(e){var t=[];return this.edges.forEach((function(r,n){r.has(e)&&t.push(n)})),t}},{key:"destroy",value:function(){this.edges.clear(),this.nodes.clear(),this.specialNodes.clear(),this.specialNodesStructuralChanges.clear(),this.clearSpecialNodesRecentlyChanged()}},{key:"removeDependencies",value:function(e){var t=this.dependencyQuery(e);if(!t)return[];var r,i=n(t);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.softRemoveEdge(a,e)}}catch(e){i.e(e)}finally{i.f()}return t}}])&&a(t.prototype,r),i&&a(t,i),e}();t.Graph=s},function(e,t,r){"use strict";var n=r(2),i=r(48),a=[].reverse,o=[1,2];n({target:"Array",proto:!0,forced:String(o)===String(o.reverse())},{reverse:function(){return i(this)&&(this.length=this.length),a.call(this)}})},function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=a(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw o}}}}function a(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r(1),r(63),r(64),r(65),r(75),r(84),r(89),r(207),r(92),r(96),r(98),r(104),t.__esModule=!0,t.MatrixMapping=void 0,r(125);
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */
var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.matrixMapping=new Map}var t,r,a;return t=e,(r=[{key:"getMatrix",value:function(e){return this.matrixMapping.get(e.toString())}},{key:"setMatrix",value:function(e,t){this.matrixMapping.set(e.toString(),t)}},{key:"removeMatrix",value:function(e){this.matrixMapping.delete(e.toString())}},{key:"isFormulaMatrixInRow",value:function(e,t){var r,n=i(this.matrixMapping.values());try{for(n.s();!(r=n.n()).done;){var a=r.value;if(a.spansThroughSheetRows(e,t)&&a.isFormula())return!0}}catch(e){n.e(e)}finally{n.f()}return!1}},{key:"isFormulaMatrixInRows",value:function(e){var t,r=i(e.rows());try{for(r.s();!(t=r.n()).done;){var n=t.value;if(this.isFormulaMatrixInRow(e.sheet,n))return!0}}catch(e){r.e(e)}finally{r.f()}return!1}},{key:"isFormulaMatrixInColumn",value:function(e,t){var r,n=i(this.matrixMapping.values());try{for(n.s();!(r=n.n()).done;){var a=r.value;if(a.spansThroughSheetColumn(e,t)&&a.isFormula())return!0}}catch(e){n.e(e)}finally{n.f()}return!1}},{key:"isFormulaMatrixInColumns",value:function(e){var t,r=i(e.columns());try{for(r.s();!(t=r.n()).done;){var n=t.value;if(this.isFormulaMatrixInColumn(e.sheet,n))return!0}}catch(e){r.e(e)}finally{r.f()}return!1}},{key:"isFormulaMatrixInRange",value:function(e){var t,r=i(this.matrixMapping.values());try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n.isFormula()&&n.getRange().doesOverlap(e))return!0}}catch(e){r.e(e)}finally{r.f()}return!1}},{key:"isFormulaMatrixAtAddress",value:function(e){var t,r=i(this.matrixMapping.values());try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n.getRange().addressInRange(e)&&n.isFormula())return!0}}catch(e){r.e(e)}finally{r.f()}return!1}},{key:"numericMatrices",value:regeneratorRuntime.mark((function e(){var t,r,a,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=i(this.matrixMapping.entries()),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=10;break}if(a=n(r.value,2),o=a[0],(s=a[1]).isFormula()){e.next=8;break}return e.next=8,[o,s];case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"numericMatricesInRows",value:regeneratorRuntime.mark((function e(t){var r,a,o,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=i(this.matrixMapping.entries()),e.prev=1,r.s();case 3:if((a=r.n()).done){e.next=10;break}if(o=n(a.value,2),s=o[0],!(u=o[1]).spansThroughSheetRows(t.sheet,t.rowStart,t.rowEnd)||u.isFormula()){e.next=8;break}return e.next=8,[s,u];case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"numericMatricesInColumns",value:regeneratorRuntime.mark((function e(t){var r,a,o,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=i(this.matrixMapping.entries()),e.prev=1,r.s();case 3:if((a=r.n()).done){e.next=10;break}if(o=n(a.value,2),s=o[0],!(u=o[1]).spansThroughSheetColumn(t.sheet,t.columnStart,t.columnEnd)||u.isFormula()){e.next=8;break}return e.next=8,[s,u];case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"numericMatricesInRange",value:regeneratorRuntime.mark((function e(t){var r,a,o,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=i(this.matrixMapping.entries()),e.prev=1,r.s();case 3:if((a=r.n()).done){e.next=10;break}if(o=n(a.value,2),s=o[0],!(u=o[1]).getRange().doesOverlap(t)){e.next=8;break}return e.next=8,[s,u];case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"truncateMatricesByRows",value:function(e){var t,r=Array(),a=i(this.numericMatricesInRows(e));try{for(a.s();!(t=a.n()).done;){var o=n(t.value,2),s=o[0],u=o[1];u.removeRows(e),0===u.height&&(this.removeMatrix(s),r.push(u))}}catch(e){a.e(e)}finally{a.f()}return r}},{key:"truncateMatricesByColumns",value:function(e){var t,r=Array(),a=i(this.numericMatricesInColumns(e));try{for(a.s();!(t=a.n()).done;){var o=n(t.value,2),s=o[0],u=o[1];u.removeColumns(e),0===u.width&&(this.removeMatrix(s),r.push(u))}}catch(e){a.e(e)}finally{a.f()}return r}},{key:"destroy",value:function(){this.matrixMapping.clear()}}])&&s(t.prototype,r),a&&s(t,a),e}();t.MatrixMapping=u},function(e,t,r){"use strict";r(1),r(63),r(64),r(109),r(110),r(65),r(75),r(84),r(239),r(89),r(207),r(133),r(136),r(92),r(96),r(98),r(124),r(104),t.__esModule=!0,t.RangeMapping=void 0,r(125);var n=r(132),i=r(106);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=s(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw a}}}}function s(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rangeMapping=new Map}var t,r,s;return t=e,(r=[{key:"getMappingSize",value:function(e){var t,r;return null!==(r=null===(t=this.rangeMapping.get(e))||void 0===t?void 0:t.size)&&void 0!==r?r:0}},{key:"setRange",value:function(e){var t=this.rangeMapping.get(e.getStart().sheet);void 0===t&&(t=new Map,this.rangeMapping.set(e.getStart().sheet,t));var r=h(e.getStart(),e.getEnd());t.set(r,e)}},{key:"removeRange",value:function(e){var t=e.getStart().sheet,r=this.rangeMapping.get(t);if(void 0!==r){var n=h(e.getStart(),e.getEnd());r.delete(n),0===r.size&&this.rangeMapping.delete(t)}}},{key:"getRange",value:function(e,t){var r=this.rangeMapping.get(e.sheet),n=h(e,t);return null==r?void 0:r.get(n)}},{key:"fetchRange",value:function(e,t){var r=this.getRange(e,t);if(!r)throw Error("Range does not exist");return r}},{key:"truncateRanges",value:function(e,t){var r,n=Array(),i=Array(),s=e.sheet,u=o(this.entriesFromSheet(e.sheet));try{for(u.s();!(r=u.n()).done;){var c=a(r.value,2),l=c[0],h=c[1],d=h.range;e.start<=t(h.range.end)&&(d.removeSpan(e),d.shouldBeRemoved()?(this.removeByKey(s,l),n.push(h)):i.push([l,h]))}}catch(e){u.e(e)}finally{u.f()}var m,y=[],g=o(i.sort((function(e,r){return f(e[1],r[1],t)})));try{for(g.s();!(m=g.n()).done;){var v=a(m.value,2),E=v[0],T=v[1],b=p(T.range);if(b!==E){var x=this.getByKey(s,b);this.removeByKey(s,E),void 0!==x&&T!=x?y.push([x,T]):this.setRange(T)}}}catch(e){g.e(e)}finally{g.f()}return{verticesToRemove:n,verticesToMerge:y}}},{key:"moveAllRangesInSheetAfterRowByRows",value:function(e,t,r){this.updateVerticesFromSheet(e,(function(e,n){return t<=n.start.row?(n.range.shiftByRows(r),n):t>n.start.row&&t<=n.end.row?(n.range.expandByRows(r),n):void 0}))}},{key:"moveAllRangesInSheetAfterColumnByColumns",value:function(e,t,r){this.updateVerticesFromSheet(e,(function(e,n){return t<=n.start.col?(n.range.shiftByColumns(r),n):t>n.start.col&&t<=n.end.col?(n.range.expandByColumns(r),n):void 0}))}},{key:"moveRangesInsideSourceRange",value:function(e,t,r,n){this.updateVerticesFromSheet(e.sheet,(function(i,a){return e.containsRange(a.range)?(a.range.shiftByColumns(t),a.range.shiftByRows(r),a.range.moveToSheet(n),a):void 0}))}},{key:"removeRangesInSheet",value:function(e){if(this.rangeMapping.has(e)){var t=this.rangeMapping.get(e).values();return this.rangeMapping.delete(e),t}return[][Symbol.iterator]()}},{key:"rangesInSheet",value:regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.rangeMapping.get(t)){e.next=3;break}return e.abrupt("return");case 3:return e.delegateYield(r.values(),"t0",4);case 4:case"end":return e.stop()}}),e,this)}))},{key:"rangeVerticesContainedInRange",value:regeneratorRuntime.mark((function e(t){var r,n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=o(this.rangesInSheet(t.sheet)),e.prev=1,r.s();case 3:if((n=r.n()).done){e.next=10;break}if(i=n.value,!t.containsRange(i.range)){e.next=8;break}return e.next=8,i;case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"findSmallerRange",value:function(e){if(e.height()>1&&Number.isFinite(e.height())){var t=(0,i.simpleCellAddress)(e.end.sheet,e.end.col,e.end.row-1),r=this.getRange(e.start,t);if(void 0!==r)return{smallerRangeVertex:r,restRange:new n.AbsoluteCellRange((0,i.simpleCellAddress)(e.start.sheet,e.start.col,e.end.row),e.end)}}return{smallerRangeVertex:null,restRange:e}}},{key:"destroy",value:function(){this.rangeMapping.clear()}},{key:"entriesFromSheet",value:regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.rangeMapping.get(t)){e.next=3;break}return e.abrupt("return");case 3:return e.delegateYield(r.entries(),"t0",4);case 4:case"end":return e.stop()}}),e,this)}))},{key:"removeByKey",value:function(e,t){this.rangeMapping.get(e).delete(t)}},{key:"getByKey",value:function(e,t){var r;return null===(r=this.rangeMapping.get(e))||void 0===r?void 0:r.get(t)}},{key:"updateVerticesFromSheet",value:function(e,t){var r,n=this,i=Array(),s=o(this.entriesFromSheet(e));try{for(s.s();!(r=s.n()).done;){var u=a(r.value,2),c=u[0],l=t(c,u[1]);void 0!==l&&(this.removeByKey(e,c),i.push(l))}}catch(e){s.e(e)}finally{s.f()}i.forEach((function(e){n.setRange(e)}))}}])&&c(t.prototype,r),s&&c(t,s),e}();function h(e,t){return"".concat(e.col,",").concat(e.row,",").concat(t.col,",").concat(t.row)}function p(e){return h(e.start,e.end)}t.RangeMapping=l;var f=function(e,t,r){var n=r(e.range.start),i=r(e.range.start);return n===i?r(e.range.end)-r(t.range.end):n-i}},function(e,t,r){"use strict";var n=r(2),i=r(61),a=r(49),o=r(7),s=r(112),u=[],c=u.sort,l=o((function(){u.sort(void 0)})),h=o((function(){u.sort(null)})),p=s("sort");n({target:"Array",proto:!0,forced:l||!h||!p},{sort:function(e){return void 0===e?c.call(a(this)):c.call(a(this),i(e))}})},function(e,t,r){"use strict";r(1),r(63),r(64),r(109),r(65),r(75),r(113),r(84),r(89),r(207),r(92),r(96),r(98),r(104),t.__esModule=!0,t.SheetMapping=void 0,r(125);var n=r(241),i=r(226);function a(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t,r){return t&&u(e.prototype,t),r&&u(e,r),e}function l(e){return e.toLowerCase()}var h=function(){function e(t,r){s(this,e),this.id=t,this.displayName=r}return c(e,[{key:"canonicalName",get:function(){return l(this.displayName)}}]),e}(),p=function(){function e(t){var r=this;s(this,e),this.languages=t,this.mappingFromCanonicalName=new Map,this.mappingFromId=new Map,this.lastSheetId=-1,this.fetch=function(e){var t=r.mappingFromCanonicalName.get(l(e));if(void 0===t)throw new i.NoSheetWithNameError(e);return t.id},this.get=function(e){var t=r.mappingFromCanonicalName.get(l(e));return t?t.id:void 0},this.fetchDisplayName=function(e){return r.fetchSheetById(e).displayName},this.sheetNamePrefix=t.getUITranslation(n.UIElement.NEW_SHEET_PREFIX)}return c(e,[{key:"addSheet",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"".concat(this.sheetNamePrefix).concat(this.lastSheetId+2),t=l(e);if(this.mappingFromCanonicalName.has(t))throw new i.SheetNameAlreadyTakenError(e);this.lastSheetId++;var r=new h(this.lastSheetId,e);return this.store(r),r.id}},{key:"removeSheet",value:function(e){var t=this.fetchSheetById(e);e==this.lastSheetId&&--this.lastSheetId,this.mappingFromCanonicalName.delete(t.canonicalName),this.mappingFromId.delete(t.id)}},{key:"getDisplayName",value:function(e){var t=this.mappingFromId.get(e);return t?t.displayName:void 0}},{key:"getDisplayNameByName",value:function(e){var t=this.mappingFromCanonicalName.get(l(e));return t?t.displayName:void 0}},{key:"displayNames",value:regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=a(this.mappingFromCanonicalName.values()),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=9;break}return n=r.value,e.next=7,n.displayName;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:"numberOfSheets",value:function(){return this.mappingFromCanonicalName.size}},{key:"hasSheetWithId",value:function(e){return this.mappingFromId.has(e)}},{key:"hasSheetWithName",value:function(e){return this.mappingFromCanonicalName.has(l(e))}},{key:"renameSheet",value:function(e,t){var r=this.fetchSheetById(e),n=r.displayName;if(n!==t){var a=this.mappingFromCanonicalName.get(l(t));if(a&&a.id!==r.id)throw new i.SheetNameAlreadyTakenError(t);var o=r.canonicalName;return this.mappingFromCanonicalName.delete(o),r.displayName=t,this.store(r),n}}},{key:"destroy",value:function(){this.mappingFromCanonicalName.clear(),this.mappingFromId.clear()}},{key:"sheetNames",value:function(){return Array.from(this.mappingFromId.values()).map((function(e){return e.displayName}))}},{key:"store",value:function(e){this.mappingFromId.set(e.id,e),this.mappingFromCanonicalName.set(e.canonicalName,e)}},{key:"fetchSheetById",value:function(e){var t=this.mappingFromId.get(e);if(void 0===t)throw new i.NoSheetWithIdError(e);return t}}]),e}();t.SheetMapping=p},function(e,t,r){"use strict";t.__esModule=!0,t.UIElement=void 0;var n,i=r(242);t.buildTranslationPackage=i.buildTranslationPackage,t.TranslationPackage=i.TranslationPackage,t.UIElement=n,function(e){e.NEW_SHEET_PREFIX="NEW_SHEET_PREFIX"}(n||(t.UIElement=n={}))},function(e,t,r){"use strict";r(1),r(63),r(64),r(65),r(75),r(140),r(84),r(89),r(201),r(90),r(243),r(92),r(244),r(96),r(114),r(98),r(104),t.__esModule=!0,t.buildTranslationPackage=function(e){return new c(Object.assign({},e.functions),Object.assign({},e.errors),Object.assign({},e.ui))},t.TranslationPackage=void 0;var n=r(106),i=r(226),a=r(241);function o(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw a}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.functions=t,this.errors=r,this.ui=n,this._protectedTranslations={VERSION:"VERSION"},this.checkUI(),this.checkErrors(),this.checkFunctionTranslations(this.functions),Object.assign(this.functions,this._protectedTranslations)}var t,r,s;return t=e,(r=[{key:"extendFunctions",value:function(e){this.checkFunctionTranslations(e),Object.assign(this.functions,e)}},{key:"buildFunctionMapping",value:function(){var e=this;return Object.keys(this.functions).reduce((function(t,r){return t[e.functions[r]]=r,t}),{})}},{key:"buildErrorMapping",value:function(){var e=this;return Object.keys(this.errors).reduce((function(t,r){return t[e.errors[r]]=r,t}),{})}},{key:"isFunctionTranslated",value:function(e){return void 0!==this.functions[e]}},{key:"getFunctionTranslations",value:function(e){var t,r=[],n=o(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.isFunctionTranslated(i)&&r.push(this.functions[i])}}catch(e){n.e(e)}finally{n.f()}return r}},{key:"getFunctionTranslation",value:function(e){var t=this.functions[e];if(void 0===t)throw new i.MissingTranslationError("functions.".concat(e));return t}},{key:"getMaybeFunctionTranslation",value:function(e){return this.functions[e]}},{key:"getErrorTranslation",value:function(e){if(e===n.ErrorType.LIC)return"#".concat(n.ErrorType.LIC,"!");var t=this.errors[e];if(void 0===t)throw new i.MissingTranslationError("errors.".concat(e));return t}},{key:"getUITranslation",value:function(e){var t=this.ui[e];if(void 0===t)throw new i.MissingTranslationError("ui.".concat(e));return t}},{key:"checkUI",value:function(){for(var e=0,t=Object.values(a.UIElement);e<t.length;e++){var r=t[e];if(!(r in this.ui))throw new i.MissingTranslationError("ui.".concat(r))}}},{key:"checkErrors",value:function(){for(var e=0,t=Object.values(n.ErrorType);e<t.length;e++){var r=t[e];if(!(r in this.errors)&&r!==n.ErrorType.LIC)throw new i.MissingTranslationError("errors.".concat(r))}}},{key:"checkFunctionTranslations",value:function(e){var t,r=new Set(Object.getOwnPropertyNames(e)),n=o(Object.getOwnPropertyNames(this._protectedTranslations));try{for(n.s();!(t=n.n()).done;){var a=t.value;if(r.has(a))throw new i.ProtectedFunctionTranslationError(a)}}catch(e){n.e(e)}finally{n.f()}}}])&&u(t.prototype,r),s&&u(t,s),e}();t.TranslationPackage=c},function(e,t,r){var n=r(2),i=r(49),a=r(52);n({target:"Object",stat:!0,forced:r(7)((function(){a(1)}))},{keys:function(e){return a(i(e))}})},function(e,t,r){var n=r(2),i=r(245).values;n({target:"Object",stat:!0},{values:function(e){return i(e)}})},function(e,t,r){var n=r(6),i=r(52),a=r(10),o=r(8).f,s=function(e){return function(t){for(var r,s=a(t),u=i(s),c=u.length,l=0,h=[];c>l;)r=u[l++],n&&!o.call(s,r)||h.push(e?[r,s[r]]:s[r]);return h}};e.exports={entries:s(!0),values:s(!1)}},function(e,t,r){"use strict";r(1),r(63),r(64),r(65),r(75),r(84),r(89),r(92),r(96),r(98),r(104),t.__esModule=!0,t.SimpleRangeValue=t.OnlyRangeData=t.ArrayData=void 0,r(125);var n=r(106),i=r(213);function a(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=s(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw a}}}}function s(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),e}var p=function(){function e(t,r,n){c(this,e),this.size=t,this.data=r,this._hasOnlyNumbers=n}return h(e,[{key:"range",value:function(){}},{key:"hasOnlyNumbers",value:function(){return this._hasOnlyNumbers}},{key:"topLeftCorner",value:function(){if(this.size.height>0&&this.size.width>0)return this.data[0][0]}},{key:"valuesFromTopLeftCorner",value:function(){for(var e=[],t=0;t<this.size.height;t++)for(var r=0;r<this.size.width;r++)e.push(this.data[t][r]);return e}},{key:"iterateValuesFromTopLeftCorner",value:regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:if(!(t<this.size.height)){e.next=12;break}r=0;case 3:if(!(r<this.size.width)){e.next=9;break}return e.next=6,this.data[t][r];case 6:r++,e.next=3;break;case 9:t++,e.next=1;break;case 12:case"end":return e.stop()}}),e,this)}))},{key:"raw",value:function(){return this.data}},{key:"rawNumbers",value:function(){if(this.hasOnlyNumbers())return this.data;throw new Error("Data is not only numbers")}}]),e}();t.ArrayData=p;var f=function(){function e(t,r,n){c(this,e),this.size=t,this._range=r,this.dependencyGraph=n}return h(e,[{key:"raw",value:function(){return this.ensureThatComputed(),this.data}},{key:"rawNumbers",value:function(){if(this.hasOnlyNumbers())return this.data;throw new Error("Data is not only numbers")}},{key:"hasOnlyNumbers",value:function(){if(this.ensureThatComputed(),void 0===this._hasOnlyNumbers){var e,t=o(this.iterateValuesFromTopLeftCorner());try{for(t.s();!(e=t.n()).done;)if("number"!=typeof e.value){this._hasOnlyNumbers=!1;break}}catch(e){t.e(e)}finally{t.f()}this._hasOnlyNumbers=!0}return this._hasOnlyNumbers}},{key:"topLeftCorner",value:function(){if(void 0!==this.data&&this.size.height>0&&this.size.width>0)return this.data[0][0]}},{key:"range",value:function(){return this._range}},{key:"valuesFromTopLeftCorner",value:function(){this.ensureThatComputed();for(var e=[],t=0;t<this.data.length;t++)for(var r=0;r<this.data[0].length;r++)e.push(this.data[t][r]);return e}},{key:"iterateValuesFromTopLeftCorner",value:regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.ensureThatComputed(),t=0;case 2:if(!(t<this.data.length)){e.next=13;break}r=0;case 4:if(!(r<this.data[0].length)){e.next=10;break}return e.next=7,this.data[t][r];case 7:r++,e.next=4;break;case 10:t++,e.next=2;break;case 13:case"end":return e.stop()}}),e,this)}))},{key:"ensureThatComputed",value:function(){void 0===this.data&&(this.data=this.computeDataFromDependencyGraph())}},{key:"computeDataFromDependencyGraph",value:function(){var e,t=[],r=0,s=[],u=o(this._range.addresses(this.dependencyGraph));try{for(u.s();!(e=u.n()).done;){var c=e.value,l=this.dependencyGraph.getCellValue(c);l instanceof d?s.push(new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.ScalarExpected)):"number"==typeof l?s.push(l):(s.push(l),this._hasOnlyNumbers=!1),++r%this.size.width==0&&(r=0,t.push(a(s)),s=[])}}catch(e){u.e(e)}finally{u.f()}return t}}]),e}();t.OnlyRangeData=f;var d=function(){function e(t,r){c(this,e),this.data=t,this._range=r}return h(e,[{key:"width",value:function(){return this.data.size.width}},{key:"height",value:function(){return this.data.size.height}},{key:"raw",value:function(){return this.data.raw()}},{key:"topLeftCornerValue",value:function(){return this.data.topLeftCorner()}},{key:"valuesFromTopLeftCorner",value:function(){return this.data.valuesFromTopLeftCorner()}},{key:"iterateValuesFromTopLeftCorner",value:regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.data.iterateValuesFromTopLeftCorner(),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"numberOfElements",value:function(){return this.data.size.width*this.data.size.height}},{key:"hasOnlyNumbers",value:function(){return this.data.hasOnlyNumbers()}},{key:"rawNumbers",value:function(){return this.data.rawNumbers()}},{key:"range",value:function(){var e;return null!==(e=this._range)&&void 0!==e?e:this.data.range()}},{key:"sameDimensionsAs",value:function(e){return this.width()===e.width()&&this.height()===e.height()}},{key:"size",get:function(){return this.data.size}}],[{key:"onlyNumbersDataWithRange",value:function(t,r,n){return new e(new p(r,t,!0),n)}},{key:"onlyNumbersDataWithoutRange",value:function(t,r){return new e(new p(r,t,!0))}},{key:"onlyRange",value:function(t,r){return new e(new f({width:t.width(),height:t.height()},t,r))}},{key:"fromScalar",value:function(t){return new e(new p({width:1,height:1},[[t]],"number"==typeof t))}}]),e}();t.SimpleRangeValue=d},function(e,t,r){"use strict";t.__esModule=!0,t.EmptyCellVertex=void 0;var n=r(106);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.address=t}var t,r,a;return t=e,(r=[{key:"getCellValue",value:function(){return n.EmptyValue}}])&&i(t.prototype,r),a&&i(t,a),e}();t.EmptyCellVertex=a},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}t.__esModule=!0,t.ValueCellVertex=void 0;
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */
var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cellValue=t}var t,r,i;return t=e,(r=[{key:"getCellValue",value:function(){return this.cellValue}},{key:"setCellValue",value:function(e){this.cellValue=e}}])&&n(t.prototype,r),i&&n(t,i),e}();t.ValueCellVertex=i},function(e,t,r){"use strict";t.__esModule=!0,t.ParsingErrorVertex=void 0;var n=r(106);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.errors=t,this.rawInput=r}var t,r,a;return t=e,(r=[{key:"getCellValue",value:function(){return n.CellError.parsingError()}},{key:"getFormula",value:function(){return this.rawInput}}])&&i(t.prototype,r),a&&i(t,a),e}();t.ParsingErrorVertex=a},function(e,t,r){"use strict";r(1),r(63),r(64),r(110),r(65),r(75),r(84),r(89),r(207),r(92),r(96),r(98),r(124),r(104),t.__esModule=!0,t.SparseStrategy=void 0,r(125);var n=r(106);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=o(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}function o(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.width=t,this.height=r,this.mapping=new Map}var t,r,o;return t=e,(r=[{key:"getCell",value:function(e){var t=this.mapping.get(e.col);return t&&t.get(e.row)||null}},{key:"setCell",value:function(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);var r=this.mapping.get(e.col);r||(r=new Map,this.mapping.set(e.col,r)),r.set(e.row,t)}},{key:"has",value:function(e){var t=this.mapping.get(e.col);return!!t&&!!t.get(e.row)}},{key:"getHeight",value:function(){return this.height}},{key:"getWidth",value:function(){return this.width}},{key:"removeCell",value:function(e){var t=this.mapping.get(e.col);t&&t.delete(e.row)}},{key:"addRows",value:function(e,t){this.mapping.forEach((function(r){var n=new Map;r.forEach((function(i,a){a>=e&&(n.set(a+t,i),r.delete(a))})),n.forEach((function(e,t){r.set(t,e)}))})),this.height+=t}},{key:"addColumns",value:function(e,t){var r=this,n=new Map;this.mapping.forEach((function(i,a){a>=e&&(n.set(a+t,i),r.mapping.delete(a))})),n.forEach((function(e,t){r.mapping.set(t,e)})),this.width+=t}},{key:"removeRows",value:function(e){this.mapping.forEach((function(t){var r=new Map;t.forEach((function(n,i){i>=e.rowStart&&(t.delete(i),i>e.rowEnd&&r.set(i-e.numberOfRows,n))})),r.forEach((function(e,r){t.set(r,e)}))}));var t=Math.min(this.height-1,e.rowEnd),r=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-r)}},{key:"removeColumns",value:function(e){var t=this,r=new Map;this.mapping.forEach((function(n,i){i>=e.columnStart&&(t.mapping.delete(i),i>e.columnEnd&&r.set(i-e.numberOfColumns,n))})),r.forEach((function(e,r){t.mapping.set(r,e)}));var n=Math.min(this.width-1,e.columnEnd),i=Math.max(0,n-e.columnStart+1);this.width=Math.max(0,this.width-i)}},{key:"getEntries",value:regeneratorRuntime.mark((function e(t){var r,o,s,u,c,l,h,p,f,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=a(this.mapping),e.prev=1,r.s();case 3:if((o=r.n()).done){e.next=24;break}s=i(o.value,2),u=s[0],c=s[1],l=a(c),e.prev=6,l.s();case 8:if((h=l.n()).done){e.next=14;break}return p=i(h.value,2),f=p[0],d=p[1],e.next=12,[(0,n.simpleCellAddress)(t,u,f),d];case 12:e.next=8;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(6),l.e(e.t0);case 19:return e.prev=19,l.f(),e.finish(19);case 22:e.next=3;break;case 24:e.next=29;break;case 26:e.prev=26,e.t1=e.catch(1),r.e(e.t1);case 29:return e.prev=29,r.f(),e.finish(29);case 32:case"end":return e.stop()}}),e,this,[[1,26,29,32],[6,16,19,22]])}))},{key:"verticesFromColumn",value:regeneratorRuntime.mark((function e(t){var r,n,o,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.mapping.get(t)){e.next=3;break}return e.abrupt("return");case 3:n=a(r),e.prev=4,n.s();case 6:if((o=n.n()).done){e.next=12;break}return(s=i(o.value,2))[0],u=s[1],e.next=10,u;case 10:e.next=6;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),n.e(e.t0);case 17:return e.prev=17,n.f(),e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[4,14,17,20]])}))},{key:"verticesFromRow",value:regeneratorRuntime.mark((function e(t){var r,n,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=a(this.mapping.values()),e.prev=1,r.s();case 3:if((n=r.n()).done){e.next=11;break}if(i=n.value,!(o=i.get(t))){e.next=9;break}return e.next=9,o;case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),r.e(e.t0);case 16:return e.prev=16,r.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[1,13,16,19]])}))},{key:"verticesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){var r,n,o,s,u,c,l,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=a(t.columns()),e.prev=1,r.s();case 3:if((n=r.n()).done){e.next=27;break}if(o=n.value,s=this.mapping.get(o)){e.next=8;break}return e.abrupt("continue",25);case 8:u=a(s),e.prev=9,u.s();case 11:if((c=u.n()).done){e.next=17;break}return(l=i(c.value,2))[0],h=l[1],e.next=15,h;case 15:e.next=11;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(9),u.e(e.t0);case 22:return e.prev=22,u.f(),e.finish(22);case 25:e.next=3;break;case 27:e.next=32;break;case 29:e.prev=29,e.t1=e.catch(1),r.e(e.t1);case 32:return e.prev=32,r.f(),e.finish(32);case 35:case"end":return e.stop()}}),e,this,[[1,29,32,35],[9,19,22,25]])}))},{key:"verticesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){var r,n,i,o,s,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=a(this.mapping.values()),e.prev=1,r.s();case 3:if((n=r.n()).done){e.next=26;break}i=n.value,o=a(t.rows()),e.prev=6,o.s();case 8:if((s=o.n()).done){e.next=16;break}if(u=s.value,!(c=i.get(u))){e.next=14;break}return e.next=14,c;case 14:e.next=8;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),o.e(e.t0);case 21:return e.prev=21,o.f(),e.finish(21);case 24:e.next=3;break;case 26:e.next=31;break;case 28:e.prev=28,e.t1=e.catch(1),r.e(e.t1);case 31:return e.prev=31,r.f(),e.finish(31);case 34:case"end":return e.stop()}}),e,this,[[1,28,31,34],[6,18,21,24]])}))},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){var r,o,s,u,c,l,h,p,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=a(this.mapping.entries()),e.prev=1,r.s();case 3:if((o=r.n()).done){e.next=26;break}s=i(o.value,2),u=s[0],c=s[1],l=a(t.rows()),e.prev=6,l.s();case 8:if((h=l.n()).done){e.next=16;break}if(p=h.value,!(f=c.get(p))){e.next=14;break}return e.next=14,[(0,n.simpleCellAddress)(t.sheet,u,p),f];case 14:e.next=8;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),l.e(e.t0);case 21:return e.prev=21,l.f(),e.finish(21);case 24:e.next=3;break;case 26:e.next=31;break;case 28:e.prev=28,e.t1=e.catch(1),r.e(e.t1);case 31:return e.prev=31,r.f(),e.finish(31);case 34:case"end":return e.stop()}}),e,this,[[1,28,31,34],[6,18,21,24]])}))},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){var r,o,s,u,c,l,h,p,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=a(t.columns()),e.prev=1,r.s();case 3:if((o=r.n()).done){e.next=26;break}if(s=o.value,!(u=this.mapping.get(s))){e.next=24;break}c=a(u.entries()),e.prev=8,c.s();case 10:if((l=c.n()).done){e.next=16;break}return h=i(l.value,2),p=h[0],f=h[1],e.next=14,[(0,n.simpleCellAddress)(t.sheet,s,p),f];case 14:e.next=10;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(8),c.e(e.t0);case 21:return e.prev=21,c.f(),e.finish(21);case 24:e.next=3;break;case 26:e.next=31;break;case 28:e.prev=28,e.t1=e.catch(1),r.e(e.t1);case 31:return e.prev=31,r.f(),e.finish(31);case 34:case"end":return e.stop()}}),e,this,[[1,28,31,34],[8,18,21,24]])}))},{key:"vertices",value:regeneratorRuntime.mark((function e(){var t,r,n,o,s,u,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=a(this.mapping),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=25;break}(n=i(r.value,2))[0],o=n[1],s=a(o),e.prev=6,s.s();case 8:if((u=s.n()).done){e.next=15;break}if((c=i(u.value,2))[0],!(l=c[1])){e.next=13;break}return e.next=13,l;case 13:e.next=8;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(6),s.e(e.t0);case 20:return e.prev=20,s.f(),e.finish(20);case 23:e.next=3;break;case 25:e.next=30;break;case 27:e.prev=27,e.t1=e.catch(1),t.e(e.t1);case 30:return e.prev=30,t.f(),e.finish(30);case 33:case"end":return e.stop()}}),e,this,[[1,27,30,33],[6,17,20,23]])}))}])&&u(t.prototype,r),o&&u(t,o),e}();t.SparseStrategy=c},function(e,t,r){"use strict";r(1),r(63),r(64),r(109),r(65),r(75),r(84),r(233),r(89),r(92),r(96),r(98),r(104),t.__esModule=!0,t.DenseStrategy=void 0,r(125);var n=r(106);function i(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.width=t,this.height=r,this.mapping=new Array(r);for(var n=0;n<r;n++)this.mapping[n]=new Array(t)}var t,r,a;return t=e,(r=[{key:"getCell",value:function(e){return this.getCellVertex(e.col,e.row)}},{key:"setCell",value:function(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1),this.mapping[e.row]||(this.mapping[e.row]=new Array(this.width)),this.mapping[e.row][e.col]=t}},{key:"has",value:function(e){var t=this.mapping[e.row];return!!t&&!!t[e.col]}},{key:"getHeight",value:function(){return this.height}},{key:"getWidth",value:function(){return this.width}},{key:"removeCell",value:function(e){void 0!==this.mapping[e.row]&&delete this.mapping[e.row][e.col]}},{key:"addRows",value:function(e,t){for(var r,n=[],i=0;i<t;i++)n.push(new Array(this.width));(r=this.mapping).splice.apply(r,[e,0].concat(n)),this.height+=t}},{key:"addColumns",value:function(e,t){for(var r=0;r<this.height;r++){var n;(n=this.mapping[r]).splice.apply(n,[e,0].concat(i(new Array(t))))}this.width+=t}},{key:"removeRows",value:function(e){this.mapping.splice(e.rowStart,e.numberOfRows);var t=Math.min(this.height-1,e.rowEnd),r=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-r)}},{key:"removeColumns",value:function(e){for(var t=0;t<this.height;t++)this.mapping[t].splice(e.columnStart,e.numberOfColumns);var r=Math.min(this.width-1,e.columnEnd),n=Math.max(0,r-e.columnStart+1);this.width=Math.max(0,this.width-n)}},{key:"getEntries",value:regeneratorRuntime.mark((function e(t){var r,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0;case 1:if(!(r<this.height)){e.next=14;break}i=0;case 3:if(!(i<this.width)){e.next=11;break}if(!(a=this.getCellVertex(i,r))){e.next=8;break}return e.next=8,[(0,n.simpleCellAddress)(t,i,r),a];case 8:++i,e.next=3;break;case 11:++r,e.next=1;break;case 14:case"end":return e.stop()}}),e,this)}))},{key:"verticesFromColumn",value:regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0;case 1:if(!(r<this.height)){e.next=9;break}if(!(n=this.getCellVertex(t,r))){e.next=6;break}return e.next=6,n;case 6:++r,e.next=1;break;case 9:case"end":return e.stop()}}),e,this)}))},{key:"verticesFromRow",value:regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0;case 1:if(!(r<this.width)){e.next=9;break}if(!(n=this.getCellVertex(r,t))){e.next=6;break}return e.next=6,n;case 6:++r,e.next=1;break;case 9:case"end":return e.stop()}}),e,this)}))},{key:"verticesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){var r,n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.columnStart;case 1:if(!(r<=t.columnEnd)){e.next=14;break}n=0;case 3:if(!(n<this.height)){e.next=11;break}if(!(i=this.getCellVertex(r,n))){e.next=8;break}return e.next=8,i;case 8:++n,e.next=3;break;case 11:++r,e.next=1;break;case 14:case"end":return e.stop()}}),e,this)}))},{key:"verticesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){var r,n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0;case 1:if(!(r<this.width)){e.next=14;break}n=t.rowStart;case 3:if(!(n<=t.rowEnd)){e.next=11;break}if(!(i=this.getCellVertex(r,n))){e.next=8;break}return e.next=8,i;case 8:++n,e.next=3;break;case 11:++r,e.next=1;break;case 14:case"end":return e.stop()}}),e,this)}))},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){var r,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0;case 1:if(!(r<this.width)){e.next=14;break}i=t.rowStart;case 3:if(!(i<=t.rowEnd)){e.next=11;break}if(!(a=this.getCellVertex(r,i))){e.next=8;break}return e.next=8,[(0,n.simpleCellAddress)(t.sheet,r,i),a];case 8:++i,e.next=3;break;case 11:++r,e.next=1;break;case 14:case"end":return e.stop()}}),e,this)}))},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){var r,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0;case 1:if(!(r<this.height)){e.next=14;break}i=t.columnStart;case 3:if(!(i<=t.columnEnd)){e.next=11;break}if(!(a=this.getCellVertex(i,r))){e.next=8;break}return e.next=8,[(0,n.simpleCellAddress)(t.sheet,i,r),a];case 8:++i,e.next=3;break;case 11:++r,e.next=1;break;case 14:case"end":return e.stop()}}),e,this)}))},{key:"vertices",value:regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:if(!(t<this.height)){e.next=14;break}r=0;case 3:if(!(r<this.width)){e.next=11;break}if(!(n=this.getCellVertex(r,t))){e.next=8;break}return e.next=8,n;case 8:++r,e.next=3;break;case 11:++t,e.next=1;break;case 14:case"end":return e.stop()}}),e,this)}))},{key:"getCellVertex",value:function(e,t){return this.mapping[t]&&this.mapping[t][e]||null}}])&&o(t.prototype,r),a&&o(t,a),e}();t.DenseStrategy=s},function(e,t,r){"use strict";t.__esModule=!0,t.DetailedCellError=void 0,t.DetailedCellError=function e(t,r,n){var i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */(this,e),this.value=r,this.address=n,this.type=t.type,this.message=null!==(i=t.message)&&void 0!==i?i:""}},function(e,t,r){"use strict";r(89),r(254),t.__esModule=!0,t.Exporter=t.ExportedNamedExpressionChange=t.ExportedCellChange=void 0;var n=r(106),i=r(252),a=r(213),o=r(246),s=r(255),u=r(139);function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),e}var p=function(){function e(t,r){c(this,e),this.address=t,this.newValue=r}return h(e,[{key:"col",get:function(){return this.address.col}},{key:"row",get:function(){return this.address.row}},{key:"sheet",get:function(){return this.address.sheet}},{key:"value",get:function(){return this.newValue}}]),e}();t.ExportedCellChange=p;var f=function e(t,r){c(this,e),this.name=t,this.newValue=r};t.ExportedNamedExpressionChange=f;var d=function(){function e(t,r,n){c(this,e),this.config=t,this.namedExpressions=r,this.sheetIndexMapping=n}return h(e,[{key:"exportChange",value:function(e){if(e.sheet===s.NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS){var t=this.namedExpressions.namedExpressionInAddress(e.row);if(!t)throw"Missing named expression";return new f(t.displayName,this.exportValue(e.value))}return new p((0,n.simpleCellAddress)(e.sheet,e.col,e.row),this.exportValue(e.value))}},{key:"exportValue",value:function(e){return e instanceof o.SimpleRangeValue?this.detailedError(new n.CellError(n.ErrorType.VALUE,a.ErrorMessage.ScalarExpected)):this.config.smartRounding&&"number"==typeof e?this.cellValueRounding(e):e instanceof n.CellError?this.detailedError(e):e===n.EmptyValue?null:e}},{key:"detailedError",value:function(e){var t,r=void 0,n=e.address;return void 0!==n&&(r=n.sheet===s.NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS?null===(t=this.namedExpressions.namedExpressionInAddress(n.row))||void 0===t?void 0:t.displayName:(0,u.simpleCellAddressToString)(this.sheetIndexMapping,n,-1)),new i.DetailedCellError(e,this.config.translationPackage.getErrorTranslation(e.type),r)}},{key:"cellValueRounding",value:function(e){if(0===e)return e;var t=Math.floor(Math.log10(Math.abs(e))),r=Math.pow(10,this.config.precisionRounding-t);return e<0?-Math.round(-e*r)/r:Math.round(e*r)/r}}]),e}();t.Exporter=d},function(e,t,r){var n=r(2),i=Math.log,a=Math.LOG10E;n({target:"Math",stat:!0},{log10:function(e){return i(e)*a}})},function(e,t,r){"use strict";r(229),r(110),r(65),r(75),r(113),r(206),r(207),r(92),r(98),r(124),r(104),t.__esModule=!0,t.doesContainRelativeReferences=t.NamedExpressions=t.InternalNamedExpression=void 0;var n=r(106),i=r(138);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}var u=function(){function e(t,r,n,i){a(this,e),this.displayName=t,this.address=r,this.added=n,this.options=i}return s(e,[{key:"normalizeExpressionName",value:function(){return this.displayName.toLowerCase()}},{key:"copy",value:function(){return new e(this.displayName,this.address,this.added,this.options)}}]),e}();t.InternalNamedExpression=u;var c=function(){function e(){a(this,e),this.mapping=new Map}return s(e,[{key:"has",value:function(e){return this.mapping.has(this.normalizeExpressionName(e))}},{key:"isNameAvailable",value:function(e){var t=this.normalizeExpressionName(e),r=this.mapping.get(t);return!(r&&r.added)}},{key:"add",value:function(e){this.mapping.set(e.normalizeExpressionName(),e)}},{key:"get",value:function(e){return this.mapping.get(this.normalizeExpressionName(e))}},{key:"getExisting",value:function(e){var t=this.mapping.get(this.normalizeExpressionName(e));return t&&t.added?t:void 0}},{key:"remove",value:function(e){var t=this.normalizeExpressionName(e),r=this.mapping.get(t);r&&(r.added=!1)}},{key:"getAllNamedExpressions",value:function(){return Array.from(this.mapping.values()).filter((function(e){return e.added}))}},{key:"normalizeExpressionName",value:function(e){return e.toLowerCase()}}]),e}(),l=function(){function e(){a(this,e),this.mapping=new Map}return s(e,[{key:"add",value:function(e){this.mapping.set(this.normalizeExpressionName(e.displayName),e)}},{key:"get",value:function(e){return this.mapping.get(this.normalizeExpressionName(e))}},{key:"has",value:function(e){return this.mapping.has(this.normalizeExpressionName(e))}},{key:"getAllNamedExpressions",value:function(){return Array.from(this.mapping.values()).filter((function(e){return e.added}))}},{key:"normalizeExpressionName",value:function(e){return e.toLowerCase()}},{key:"isNameAvailable",value:function(e){var t=this.normalizeExpressionName(e);return!this.mapping.has(t)}},{key:"remove",value:function(e){var t=this.normalizeExpressionName(e);this.mapping.get(t)&&this.mapping.delete(t)}}]),e}(),h=function(){function e(){a(this,e),this.nextNamedExpressionRow=0,this.workbookStore=new c,this.worksheetStores=new Map,this.addressCache=new Map}return s(e,[{key:"isNameAvailable",value:function(e,t){return void 0===t?this.workbookStore.isNameAvailable(e):this.worksheetStore(t).isNameAvailable(e)}},{key:"namedExpressionInAddress",value:function(e){var t=this.addressCache.get(e);return t&&t.added?t:void 0}},{key:"namedExpressionForScope",value:function(e,t){return void 0===t?this.workbookStore.getExisting(e):this.worksheetStore(t).get(e)}},{key:"nearestNamedExpression",value:function(e,t){var r;return null!==(r=this.worksheetStore(t).get(e))&&void 0!==r?r:this.workbookStore.getExisting(e)}},{key:"isExpressionInScope",value:function(e,t){return this.worksheetStore(t).has(e)}},{key:"isNameValid",value:function(e){return!/^[A-Za-z]+[0-9]+$/.test(e)&&/^[A-Za-z\u00C0-\u02AF_][A-Za-z0-9\u00C0-\u02AF._]*$/.test(e)}},{key:"addNamedExpression",value:function(e,t,r){if(void 0===t){var n=this.workbookStore.get(e);return n?(n.added=!0,n.displayName=e,n.options=r):(n=new u(e,this.nextAddress(),!0,r),this.workbookStore.add(n)),this.addressCache.set(n.address.row,n),n}var i=this.worksheetStore(t),a=new u(e,this.nextAddress(),!0,r);return i.add(a),this.addressCache.set(a.address.row,a),a}},{key:"worksheetStore",value:function(e){var t=this.worksheetStores.get(e);return t||(t=new l,this.worksheetStores.set(e,t)),t}},{key:"namedExpressionOrPlaceholder",value:function(e,t){var r=this.worksheetStore(t).get(e);if(r)return r;var n=this.workbookStore.get(e);return void 0===n&&(n=new u(e,this.nextAddress(),!1),this.workbookStore.add(n)),n}},{key:"workbookNamedExpressionOrPlaceholder",value:function(e){var t=this.workbookStore.get(e);return void 0===t&&(t=new u(e,this.nextAddress(),!1),this.workbookStore.add(t)),t}},{key:"remove",value:function(e,t){var r,n=(r=void 0===t?this.workbookStore:this.worksheetStore(t)).get(e);if(void 0===n||!n.added)throw"Named expression does not exist";r.remove(e),this.addressCache.delete(n.address.row)}},{key:"getAllNamedExpressionsNames",value:function(){return this.workbookStore.getAllNamedExpressions().map((function(e){return e.displayName}))}},{key:"getAllNamedExpressions",value:function(){var e=[];return this.workbookStore.getAllNamedExpressions().forEach((function(t){e.push({expression:t,scope:void 0})})),this.worksheetStores.forEach((function(t,r){t.getAllNamedExpressions().forEach((function(t){e.push({expression:t,scope:r})}))})),e}},{key:"nextAddress",value:function(){return(0,n.simpleCellAddress)(e.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}},{key:"lookupNextAddress",value:function(t,r){if(void 0===r){var i=this.workbookStore.get(t);if(i)return i.address}return(0,n.simpleCellAddress)(e.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow)}}]),e}();t.NamedExpressions=h,h.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1,t.doesContainRelativeReferences=function e(t){switch(t.type){case i.AstNodeType.EMPTY:case i.AstNodeType.NUMBER:case i.AstNodeType.STRING:case i.AstNodeType.ERROR:case i.AstNodeType.ERROR_WITH_RAW_INPUT:return!1;case i.AstNodeType.CELL_REFERENCE:return!t.reference.isAbsolute();case i.AstNodeType.CELL_RANGE:case i.AstNodeType.COLUMN_RANGE:case i.AstNodeType.ROW_RANGE:return!t.start.isAbsolute();case i.AstNodeType.NAMED_EXPRESSION:return!1;case i.AstNodeType.PERCENT_OP:case i.AstNodeType.PLUS_UNARY_OP:case i.AstNodeType.MINUS_UNARY_OP:return e(t.value);case i.AstNodeType.CONCATENATE_OP:case i.AstNodeType.EQUALS_OP:case i.AstNodeType.NOT_EQUAL_OP:case i.AstNodeType.LESS_THAN_OP:case i.AstNodeType.GREATER_THAN_OP:case i.AstNodeType.LESS_THAN_OR_EQUAL_OP:case i.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case i.AstNodeType.MINUS_OP:case i.AstNodeType.PLUS_OP:case i.AstNodeType.TIMES_OP:case i.AstNodeType.DIV_OP:case i.AstNodeType.POWER_OP:return e(t.left)||e(t.right);case i.AstNodeType.PARENTHESIS:return e(t.expression);case i.AstNodeType.FUNCTION_CALL:return t.args.some((function(t){return e(t)}))}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(109),r(110),r(65),r(75),r(113),r(84),r(89),r(207),r(92),r(96),r(98),r(124),r(104),t.__esModule=!0,t.HyperFormula=void 0;var n=r(132),i=r(106),a=r(257),o=r(264),s=r(241),u=r(265),c=r(226),l=r(138),h=r(278),p=r(280),f=r(313);function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||y(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||y(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){if(e){if("string"==typeof e)return g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?g(e,t):void 0}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var E=function(){function e(t,r,n,i,a,o,s,u,c,l,p,f,d,m){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._config=t,this._stats=r,this._dependencyGraph=n,this._columnSearch=i,this._parser=a,this._unparser=o,this._cellContentParser=s,this._evaluator=u,this._lazilyTransformingAstService=c,this._crudOperations=l,this._exporter=p,this._namedExpressions=f,this._serialization=d,this._functionRegistry=m,this._emitter=new h.Emitter,this._evaluationSuspended=!1}var t,r,y;return t=e,y=[{key:"buildFromEngineState",value:function(t){return new e(t.config,t.stats,t.dependencyGraph,t.columnSearch,t.parser,t.unparser,t.cellContentParser,t.evaluator,t.lazilyTransformingAstService,t.crudOperations,t.exporter,t.namedExpressions,t.serialization,t.functionRegistry)}},{key:"buildFromArray",value:function(e,t){return this.buildFromEngineState(p.BuildEngineFactory.buildFromSheet(e,t))}},{key:"buildFromSheets",value:function(e,t){return this.buildFromEngineState(p.BuildEngineFactory.buildFromSheets(e,t))}},{key:"buildEmpty",value:function(e){return this.buildFromEngineState(p.BuildEngineFactory.buildEmpty(e))}},{key:"getLanguage",value:function(e){var t=this.registeredLanguages.get(e);if(void 0===t)throw new c.LanguageNotRegisteredError;return t}},{key:"registerLanguage",value:function(e,t){if(this.registeredLanguages.has(e))throw new c.LanguageAlreadyRegisteredError;this.registeredLanguages.set(e,(0,s.buildTranslationPackage)(t))}},{key:"unregisterLanguage",value:function(e){if(!this.registeredLanguages.has(e))throw new c.LanguageNotRegisteredError;this.registeredLanguages.delete(e)}},{key:"getRegisteredLanguagesCodes",value:function(){return Array.from(this.registeredLanguages.keys())}},{key:"registerFunctionPlugin",value:function(e,t){f.FunctionRegistry.registerFunctionPlugin(e,t)}},{key:"unregisterFunctionPlugin",value:function(e){f.FunctionRegistry.unregisterFunctionPlugin(e)}},{key:"registerFunction",value:function(e,t,r){f.FunctionRegistry.registerFunction(e,t,r)}},{key:"unregisterFunction",value:function(e){f.FunctionRegistry.unregisterFunction(e)}},{key:"unregisterAllFunctions",value:function(){f.FunctionRegistry.unregisterAll()}},{key:"getRegisteredFunctionNames",value:function(e){var t=f.FunctionRegistry.getRegisteredFunctionIds();return this.getLanguage(e).getFunctionTranslations(t)}},{key:"getFunctionPlugin",value:function(e){return f.FunctionRegistry.getFunctionPlugin(e)}},{key:"getAllFunctionPlugins",value:function(){return f.FunctionRegistry.getPlugins()}}],(r=[{key:"getCellValue",value:function(e){return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e)}},{key:"ensureEvaluationIsNotSuspended",value:function(){if(this._evaluationSuspended)throw new c.EvaluationSuspendedError}},{key:"getCellFormula",value:function(e){return this._serialization.getCellFormula(e)}},{key:"getCellSerialized",value:function(e){return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e)}},{key:"getSheetValues",value:function(e){return this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}},{key:"getSheetFormulas",value:function(e){return this._serialization.getSheetFormulas(e)}},{key:"getSheetSerialized",value:function(e){return this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}},{key:"getAllSheetsDimensions",value:function(){var e=this;return this._serialization.genericAllSheetsGetter((function(t){return e.getSheetDimensions(t)}))}},{key:"getSheetDimensions",value:function(e){return{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}},{key:"getAllSheetsValues",value:function(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}},{key:"getAllSheetsFormulas",value:function(){return this._serialization.getAllSheetsFormulas()}},{key:"getAllSheetsSerialized",value:function(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}},{key:"updateConfig",value:function(e){var t=this,r=this._config.mergeConfig(e),n=this._config.mergeConfig({language:e.language}),i=this._serialization.withNewConfig(n,this._namedExpressions).getAllSheetsSerialized(),a=this._serialization.getAllNamedExpressionsSerialized(),o=p.BuildEngineFactory.rebuildWithConfig(r,i,this._stats);this._config=o.config,this._stats=o.stats,this._dependencyGraph=o.dependencyGraph,this._columnSearch=o.columnSearch,this._parser=o.parser,this._unparser=o.unparser,this._cellContentParser=o.cellContentParser,this._evaluator=o.evaluator,this._lazilyTransformingAstService=o.lazilyTransformingAstService,this._crudOperations=o.crudOperations,this._exporter=o.exporter,this._namedExpressions=o.namedExpressions,this._serialization=o.serialization,this._functionRegistry=o.functionRegistry,a.forEach((function(e){t.addNamedExpression(e.name,e.expression,e.scope,e.options)}))}},{key:"getConfig",value:function(){return this._config.getConfig()}},{key:"rebuildAndRecalculate",value:function(){this.updateConfig({})}},{key:"getStats",value:function(){return this._stats.snapshot()}},{key:"undo",value:function(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}},{key:"redo",value:function(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isThereSomethingToUndo",value:function(){return this._crudOperations.isThereSomethingToUndo()}},{key:"isThereSomethingToRedo",value:function(){return this._crudOperations.isThereSomethingToRedo()}},{key:"isItPossibleToSetCellContents",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;try{this._crudOperations.ensureRangeInSizeLimits(n.AbsoluteCellRange.spanFrom(e,t,r));for(var i=0;i<t;i++)for(var a=0;a<r;a++)this._crudOperations.ensureItIsPossibleToChangeContent({col:e.col+i,row:e.row+a,sheet:e.sheet})}catch(e){return!1}return!0}},{key:"setCellContents",value:function(e,t){return this._crudOperations.setCellContents(e,t),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToAddRows",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=(0,u.normalizeAddedIndexes)(r);try{var a;return(a=this._crudOperations).ensureItIsPossibleToAddRows.apply(a,[e].concat(m(i))),!0}catch(e){return!1}}},{key:"addRows",value:function(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return(t=this._crudOperations).addRows.apply(t,[e].concat(n)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToRemoveRows",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=(0,u.normalizeRemovedIndexes)(r);try{var a;return(a=this._crudOperations).ensureItIsPossibleToRemoveRows.apply(a,[e].concat(m(i))),!0}catch(e){return!1}}},{key:"removeRows",value:function(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return(t=this._crudOperations).removeRows.apply(t,[e].concat(n)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToAddColumns",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=(0,u.normalizeAddedIndexes)(r);try{var a;return(a=this._crudOperations).ensureItIsPossibleToAddColumns.apply(a,[e].concat(m(i))),!0}catch(e){return!1}}},{key:"addColumns",value:function(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return(t=this._crudOperations).addColumns.apply(t,[e].concat(n)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToRemoveColumns",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=(0,u.normalizeRemovedIndexes)(r);try{var a;return(a=this._crudOperations).ensureItIsPossibleToRemoveColumns.apply(a,[e].concat(m(i))),!0}catch(e){return!1}}},{key:"removeColumns",value:function(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return(t=this._crudOperations).removeColumns.apply(t,[e].concat(n)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToMoveCells",value:function(e,t,r,n){try{return this._crudOperations.operations.ensureItIsPossibleToMoveCells(e,t,r,n),!0}catch(e){return!1}}},{key:"moveCells",value:function(e,t,r,n){return this._crudOperations.moveCells(e,t,r,n),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToMoveRows",value:function(e,t,r,n){try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,t,r,n),!0}catch(e){return!1}}},{key:"moveRows",value:function(e,t,r,n){return this._crudOperations.moveRows(e,t,r,n),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToMoveColumns",value:function(e,t,r,n){try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,t,r,n),!0}catch(e){return!1}}},{key:"moveColumns",value:function(e,t,r,n){return this._crudOperations.moveColumns(e,t,r,n),this.recomputeIfDependencyGraphNeedsIt()}},{key:"copy",value:function(e,t,r){return this._crudOperations.copy(e,t,r),this.getRangeValues(e,t,r)}},{key:"cut",value:function(e,t,r){return this._crudOperations.cut(e,t,r),this.getRangeValues(e,t,r)}},{key:"paste",value:function(e){return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isClipboardEmpty",value:function(){return this._crudOperations.isClipboardEmpty()}},{key:"clearClipboard",value:function(){this._crudOperations.clearClipboard()}},{key:"clearRedoStack",value:function(){this._crudOperations.undoRedo.clearRedoStack()}},{key:"clearUndoStack",value:function(){this._crudOperations.undoRedo.clearUndoStack()}},{key:"getRangeValues",value:function(e,t,r){var i=this;return n.AbsoluteCellRange.spanFrom(e,t,r).arrayOfAddressesInRange().map((function(e){return e.map((function(e){return i.getCellValue(e)}))}))}},{key:"getRangeFormulas",value:function(e,t,r){var i=this;return n.AbsoluteCellRange.spanFrom(e,t,r).arrayOfAddressesInRange().map((function(e){return e.map((function(e){return i.getCellFormula(e)}))}))}},{key:"getRangeSerialized",value:function(e,t,r){var i=this;return n.AbsoluteCellRange.spanFrom(e,t,r).arrayOfAddressesInRange().map((function(e){return e.map((function(e){return i.getCellSerialized(e)}))}))}},{key:"isItPossibleToAddSheet",value:function(e){try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch(e){return!1}}},{key:"addSheet",value:function(e){var t=this._crudOperations.addSheet(e);return this._emitter.emit(h.Events.SheetAdded,t),t}},{key:"isItPossibleToRemoveSheet",value:function(e){try{return this._crudOperations.ensureSheetExists(e),!0}catch(e){return!1}}},{key:"removeSheet",value:function(e){var t=this.sheetMapping.getDisplayNameByName(e);this._crudOperations.removeSheet(e);var r=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(h.Events.SheetRemoved,t,r),r}},{key:"isItPossibleToClearSheet",value:function(e){try{return this._crudOperations.ensureSheetExists(e),!0}catch(e){return!1}}},{key:"clearSheet",value:function(e){return this._crudOperations.ensureSheetExists(e),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToReplaceSheetContent",value:function(e,t){try{this._crudOperations.ensureSheetExists(e);var r=this.sheetMapping.fetch(e);return this._crudOperations.ensureItIsPossibleToChangeSheetContents(r,t),!0}catch(e){return!1}}},{key:"setSheetContent",value:function(e,t){return this._crudOperations.setSheetContent(e,t),this.recomputeIfDependencyGraphNeedsIt()}},{key:"simpleCellAddressFromString",value:function(e,t){return(0,l.simpleCellAddressFromString)(this.sheetMapping.get,e,t)}},{key:"simpleCellAddressToString",value:function(e,t){return(0,l.simpleCellAddressToString)(this.sheetMapping.fetchDisplayName,e,t)}},{key:"getCellDependents",value:function(e){var t;if(e instanceof n.AbsoluteCellRange){if(void 0===(t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end)))return[]}else if(null===(t=this._dependencyGraph.addressMapping.getCell(e)))return[];return this._dependencyGraph.getAdjacentNodesAddresses(t)}},{key:"getCellPrecedents",value:function(e){var t,r;if(e instanceof n.AbsoluteCellRange){if(void 0===(r=this._dependencyGraph.rangeMapping.getRange(e.start,e.end)))return[]}else if(null===(r=this._dependencyGraph.addressMapping.getCell(e)))return[];return null!==(t=this._dependencyGraph.dependencyQueryAddresses(r))&&void 0!==t?t:[]}},{key:"getSheetName",value:function(e){return this.sheetMapping.getDisplayName(e)}},{key:"getSheetNames",value:function(){return this.sheetMapping.sheetNames()}},{key:"getSheetId",value:function(e){return this.sheetMapping.get(e)}},{key:"doesSheetExist",value:function(e){return this.sheetMapping.hasSheetWithName(e)}},{key:"getCellType",value:function(e){var t=this.dependencyGraph.getCell(e);return(0,i.getCellType)(t)}},{key:"doesCellHaveSimpleValue",value:function(e){return this.getCellType(e)===i.CellType.VALUE}},{key:"doesCellHaveFormula",value:function(e){return this.getCellType(e)===i.CellType.FORMULA}},{key:"isCellEmpty",value:function(e){return this.getCellType(e)===i.CellType.EMPTY}},{key:"isCellPartOfMatrix",value:function(e){return this.getCellType(e)===i.CellType.MATRIX}},{key:"getCellValueType",value:function(e){this.ensureEvaluationIsNotSuspended();var t=this.dependencyGraph.getCellValue(e);return(0,i.getCellValueType)(t)}},{key:"countSheets",value:function(){return this.sheetMapping.numberOfSheets()}},{key:"isItPossibleToRenameSheet",value:function(e,t){try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,t),!0}catch(e){return!1}}},{key:"renameSheet",value:function(e,t){var r=this._crudOperations.renameSheet(e,t);void 0!==r&&this._emitter.emit(h.Events.SheetRenamed,r,t)}},{key:"batch",value:function(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(e){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),e}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}},{key:"suspendEvaluation",value:function(){this._evaluationSuspended=!0}},{key:"resumeEvaluation",value:function(){return this._evaluationSuspended=!1,this.recomputeIfDependencyGraphNeedsIt()}},{key:"isEvaluationSuspended",value:function(){return this._evaluationSuspended}},{key:"isItPossibleToAddNamedExpression",value:function(e,t,r){try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,t,r),!0}catch(e){return!1}}},{key:"addNamedExpression",value:function(e,t,r,n){this._crudOperations.addNamedExpression(e,t,r,n);var i=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(h.Events.NamedExpressionAdded,e,i),i}},{key:"getNamedExpressionValue",value:function(e,t){this.ensureEvaluationIsNotSuspended();var r=this._crudOperations.scopeId(t),n=this._namedExpressions.namedExpressionForScope(e,r);return n?this._serialization.getCellValue(n.address):void 0}},{key:"getNamedExpressionFormula",value:function(e,t){var r=this._crudOperations.scopeId(t),n=this._namedExpressions.namedExpressionForScope(e,r);return void 0===n?void 0:this._serialization.getCellFormula(n.address)}},{key:"getNamedExpression",value:function(e,t){var r=this._crudOperations.scopeId(t),n=this._namedExpressions.namedExpressionForScope(e,r);if(void 0!==n)return{name:e,scope:t,expression:this._serialization.getCellFormula(n.address),options:n.options}}},{key:"isItPossibleToChangeNamedExpression",value:function(e,t,r){try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,t,r),!0}catch(e){return!1}}},{key:"changeNamedExpression",value:function(e,t,r,n){return this._crudOperations.changeNamedExpressionExpression(e,r,t,n),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToRemoveNamedExpression",value:function(e,t){try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,t),!0}catch(e){return!1}}},{key:"removeNamedExpression",value:function(e,t){var r=this._crudOperations.removeNamedExpression(e,t);if(r){var n=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(h.Events.NamedExpressionRemoved,r.displayName,n),n}return[]}},{key:"listNamedExpressions",value:function(){return this._namedExpressions.getAllNamedExpressionsNames()}},{key:"normalizeFormula",value:function(e){var t=d(this.extractTemporaryFormula(e),2),r=t[0],n=t[1];if(void 0===r)throw new c.NotAFormulaError;return this._unparser.unparse(r,n)}},{key:"calculateFormula",value:function(e,t){this._crudOperations.ensureSheetExists(t);var r=this.sheetMapping.fetch(t),n=d(this.extractTemporaryFormula(e,r),3),i=n[0],a=n[1],o=n[2];if(void 0===i)throw new c.NotAFormulaError;var s=this.evaluator.runAndForget(i,a,o);return this._exporter.exportValue(s)}},{key:"validateFormula",value:function(e){var t=d(this.extractTemporaryFormula(e),1)[0];return void 0!==t&&!(t.type===l.AstNodeType.ERROR&&!t.error)}},{key:"getRegisteredFunctionNames",value:function(){return e.getLanguage(this._config.language).getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}},{key:"getFunctionPlugin",value:function(e){return this._functionRegistry.getFunctionPlugin(e)}},{key:"getAllFunctionPlugins",value:function(){return this._functionRegistry.getPlugins()}},{key:"numberToDateTime",value:function(e){return this._evaluator.dateHelper.numberToSimpleDateTime(e)}},{key:"numberToDate",value:function(e){return this._evaluator.dateHelper.numberToSimpleDate(e)}},{key:"numberToTime",value:function(e){return(0,o.numberToSimpleTime)(e)}},{key:"extractTemporaryFormula",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=this._cellContentParser.parse(e),n={sheet:t,col:0,row:0};if(!(r instanceof a.CellContent.Formula))return[void 0,n,[]];var i=this._parser.parse(r.formula,n),o=i.ast,s=i.errors,u=i.dependencies;return s.length>0?[void 0,n,[]]:[o,n,u]}},{key:"on",value:function(e,t){this._emitter.on(e,t)}},{key:"once",value:function(e,t){this._emitter.once(e,t)}},{key:"off",value:function(e,t){this._emitter.off(e,t)}},{key:"destroy",value:function(){this.dependencyGraph.destroy(),this.columnSearch.destroy(),this.evaluator.destroy(),this._parser.destroy(),this._lazilyTransformingAstService.destroy(),this._stats.destroy(),this._crudOperations.clearClipboard()}},{key:"recomputeIfDependencyGraphNeedsIt",value:function(){if(this._evaluationSuspended)return[];var e=this._crudOperations.getAndClearContentChanges(),t=Array.from(this.dependencyGraph.verticesToRecompute());this.dependencyGraph.clearRecentlyChangedVertices(),t.length>0&&e.addAll(this.evaluator.partialRun(t));var r=e.exportChanges(this._exporter);return e.isEmpty()||this._emitter.emit(h.Events.ValuesUpdated,r),r}},{key:"graph",get:function(){return this.dependencyGraph.graph}},{key:"rangeMapping",get:function(){return this.dependencyGraph.rangeMapping}},{key:"matrixMapping",get:function(){return this.dependencyGraph.matrixMapping}},{key:"sheetMapping",get:function(){return this.dependencyGraph.sheetMapping}},{key:"addressMapping",get:function(){return this.dependencyGraph.addressMapping}},{key:"dependencyGraph",get:function(){return this._dependencyGraph}},{key:"evaluator",get:function(){return this._evaluator}},{key:"columnSearch",get:function(){return this._columnSearch}},{key:"lazilyTransformingAstService",get:function(){return this._lazilyTransformingAstService}},{key:"licenseKeyValidityState",get:function(){return this._config.licenseKeyValidityState}}])&&v(t.prototype,r),y&&v(t,y),e}();t.HyperFormula=E,E.version="0.3.0",E.buildDate="22/10/2020 08:51:46",E.releaseDate="22/10/2020",E.languages={},E.registeredLanguages=new Map},function(e,t,r){"use strict";r(84),r(258),r(100),r(259),t.__esModule=!0,t.isFormula=l,t.isBoolean=h,t.isMatrix=p,t.isError=f,t.CellContentParser=t.CellContent=void 0;var n,i=r(106),a=r(226),o=r(261);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,r){return t&&s(e.prototype,t),r&&s(e,r),e}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e){return e.startsWith("=")}function h(e){var t=e.toLowerCase();return"true"===t||"false"===t}function p(e){return"string"==typeof e&&e.length>1&&e.startsWith("{")&&e.endsWith("}")}function f(e,t){var r=e.toUpperCase();return/#[A-Za-z0-9\/]+[?!]?/.test(r)&&Object.prototype.hasOwnProperty.call(t,r)}t.CellContent=n,function(e){e.Number=function e(t){c(this,e),this.value=t,this.value=(0,o.fixNegativeZero)(this.value)},e.String=function e(t){c(this,e),this.value=t},e.Boolean=function e(t){c(this,e),this.value=t};var t=function(){function e(){c(this,e)}return u(e,null,[{key:"getSingletonInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();e.Empty=t,e.Formula=function e(t){c(this,e),this.formula=t};var r=function(){function e(t){c(this,e),this.formula=t}return u(e,[{key:"formulaWithBraces",value:function(){return"{"+this.formula+"}"}}]),e}();e.MatrixFormula=r,e.Error=function e(t){c(this,e),this.value=new i.CellError(t)}}(n||(t.CellContent=n={}));var d=function(){function e(t,r,n){c(this,e),this.config=t,this.dateHelper=r,this.numberLiteralsHelper=n}return u(e,[{key:"parse",value:function(e){if(null==e)return n.Empty.getSingletonInstance();if("number"==typeof e)return(0,o.isNumberOverflow)(e)?new n.Error(i.ErrorType.NUM):new n.Number(e);if("boolean"==typeof e)return new n.Boolean(e);if(e instanceof Date)return new n.Number(this.dateHelper.dateToNumber({day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()}));if("string"==typeof e){if(h(e))return new n.Boolean("true"===e.toLowerCase());if(p(e))return new n.MatrixFormula(e.substr(1,e.length-2));if(l(e))return new n.Formula(e);if(f(e,this.config.errorMapping))return new n.Error(this.config.errorMapping[e.toUpperCase()]);var t=e.trim();if(this.numberLiteralsHelper.isNumber(t))return new n.Number(this.numberLiteralsHelper.numericStringToNumber(t));var r=this.dateHelper.dateStringToDateNumber(t);return void 0!==r?new n.Number(r):new n.String(e.startsWith("'")?e.slice(1):e)}throw new a.UnableToParseError(e)}}]),e}();t.CellContentParser=d},function(e,t,r){"use strict";var n,i=r(2),a=r(5).f,o=r(40),s=r(101),u=r(13),c=r(103),l=r(30),h="".endsWith,p=Math.min,f=c("endsWith");i({target:"String",proto:!0,forced:!(!l&&!f&&(n=a(String.prototype,"endsWith"),n&&!n.writable)||f)},{endsWith:function(e){var t=String(u(this));s(e);var r=arguments.length>1?arguments[1]:void 0,n=o(t.length),i=void 0===r?n:p(o(r),n),a=String(e);return h?h.call(t,a,i):t.slice(i-a.length,i)===a}})},function(e,t,r){"use strict";var n=r(2),i=r(134).trim;n({target:"String",proto:!0,forced:r(260)("trim")},{trim:function(){return i(this)}})},function(e,t,r){var n=r(7),i=r(135);e.exports=function(e){return n((function(){return!!i[e]()||"​᠎"!="​᠎"[e]()||i[e].name!==e}))}},function(e,t,r){"use strict";r(1),r(63),r(64),r(109),r(65),r(262),r(75),r(84),r(89),r(133),r(92),r(142),r(144),r(96),r(98),r(146),r(259),r(104),t.__esModule=!0,t.coerceToRange=function(e){return e instanceof o.SimpleRangeValue?e:o.SimpleRangeValue.fromScalar(e)},t.coerceToRangeNumbersOrError=function(e){return e instanceof o.SimpleRangeValue&&e.hasOnlyNumbers()||e instanceof n.CellError?e:"number"==typeof e?o.SimpleRangeValue.fromScalar(e):null},t.coerceBooleanToNumber=f,t.coerceEmptyToValue=d,t.coerceScalarToBoolean=function(e){if(e instanceof n.CellError||"boolean"==typeof e)return e;if(e===n.EmptyValue)return!1;if("number"==typeof e)return 0!==e;var t=e.toUpperCase();return"TRUE"===t||"FALSE"!==t&&""!==t&&void 0},t.coerceScalarToString=function(e){return e instanceof n.CellError||"string"==typeof e?e:e===n.EmptyValue?"":"number"==typeof e?e.toString():e?"TRUE":"FALSE"},t.zeroIfEmpty=function(e){return e===n.EmptyValue?0:e},t.numberCmp=m,t.isNumberOverflow=function(e){return isNaN(e)||e===1/0||e===-1/0},t.fixNegativeZero=function(e){return 0===e?0:e},t.ArithmeticHelper=void 0;var n=r(106),i=r(213),a=r(263),o=r(246);function s(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||c(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=c(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function c(e,t){if(e){if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var p=function(){function e(t,r,i){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.dateTimeHelper=r,this.numberLiteralsHelper=i,this.lt=function(e,t){return o.compare(e,t)<0},this.leq=function(e,t){return o.compare(e,t)<=0},this.gt=function(e,t){return o.compare(e,t)>0},this.geq=function(e,t){return o.compare(e,t)>=0},this.eq=function(e,t){return 0===o.compare(e,t)},this.neq=function(e,t){return 0!==o.compare(e,t)},this.pow=Math.pow,this.addWithEpsilon=function(e,t){var r=e+t;return Math.abs(r)<o.actualEps*Math.abs(e)?0:r},this.unaryMinus=function(e){return-e},this.unaryPlus=function(e){return e},this.unaryPercent=function(e){return e/100},this.concat=function(e,t){return e.concat(t)},this.nonstrictadd=function(e,t){return e instanceof n.CellError?e:t instanceof n.CellError?t:"number"==typeof e?"number"==typeof t?o.addWithEpsilon(e,t):e:"number"==typeof t?t:0},this.subtract=function(e,t){var r=e-t;return Math.abs(r)<o.actualEps*Math.abs(e)?0:r},this.divide=function(e,t){return 0===t?new n.CellError(n.ErrorType.DIV_BY_ZERO):e/t},this.multiply=function(e,t){return e*t},this.collator=(0,a.collatorFromConfig)(t),this.actualEps=t.smartRounding?t.precisionEpsilon:0}var t,r,c;return t=e,(r=[{key:"eqMatcherFunction",value:function(e){var t=this,r=this.buildRegex(e);return function(e){return"string"==typeof e&&r.test(t.normalizeString(e))}}},{key:"neqMatcherFunction",value:function(e){var t=this,r=this.buildRegex(e);return function(e){return"string"!=typeof e||!r.test(t.normalizeString(e))}}},{key:"searchString",value:function(e,t){var r,n=this.buildRegex(e,!1).exec(t);return null!==(r=null==n?void 0:n.index)&&void 0!==r?r:-1}},{key:"requiresRegex",value:function(e){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(var t=0;t<e.length;t++){var r=e.charAt(t);if(y(r)||this.config.useRegularExpressions&&v(r))return!0}return!1}},{key:"buildRegex",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e=this.normalizeString(e);var n=this.config.useWildcards,i=this.config.useRegularExpressions;if(i)try{RegExp(e)}catch(e){i=!1,n=!1}return t=i?b(e,this.config.caseSensitive):n?E(e,this.config.caseSensitive):T(e,this.config.caseSensitive),this.config.matchWholeCell&&r?RegExp("^("+t+")$"):RegExp(t)}},{key:"normalizeString",value:function(e){return this.config.caseSensitive||(e=e.toLowerCase()),this.config.accentSensitive||(e=e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")),e}},{key:"compare",value:function(e,t){if("string"==typeof e||"string"==typeof t){var r="string"==typeof e?this.dateTimeHelper.dateStringToDateNumber(e):e,i="string"==typeof t?this.dateTimeHelper.dateStringToDateNumber(t):t;if("number"==typeof r&&"number"==typeof i)return this.floatCmp(r,i)}return e===n.EmptyValue?e=d(t):t===n.EmptyValue&&(t=d(e)),"string"==typeof e&&"string"==typeof t?this.stringCmp(e,t):"boolean"==typeof e&&"boolean"==typeof t?m(f(e),f(t)):"number"==typeof e&&"number"==typeof t?this.floatCmp(e,t):e===n.EmptyValue&&t===n.EmptyValue?0:m((0,n.CellValueTypeOrd)((0,n.getCellValueType)(e)),(0,n.CellValueTypeOrd)((0,n.getCellValueType)(t)))}},{key:"floatCmp",value:function(e,t){var r=1+this.actualEps;return t>=0&&e*r>=t&&e<=t*r||t<=0&&e*r<=t&&e>=t*r?0:e>t?1:-1}},{key:"stringCmp",value:function(e,t){return this.collator.compare(e,t)}},{key:"coerceScalarToNumberOrError",value:function(e){var t;return e instanceof n.CellError?e:null!==(t=this.coerceToMaybeNumber(e))&&void 0!==t?t:new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.NumberCoercion)}},{key:"coerceToMaybeNumber",value:function(e){var t;return null!==(t=this.coerceNonDateScalarToMaybeNumber(e))&&void 0!==t?t:"string"==typeof e?this.dateTimeHelper.dateStringToDateNumber(e):void 0}},{key:"coerceNonDateScalarToMaybeNumber",value:function(e){if(e===n.EmptyValue)return 0;if("string"==typeof e&&this.numberLiteralsHelper.isNumber(e))return this.numberLiteralsHelper.numericStringToNumber(e);if(!("string"==typeof e&&e.length>0&&""===e.trim())){var t=Number(e);return isNaN(t)?void 0:t}}},{key:"coerceNumbersExpandRanges",value:function(e){var t,r=[],i=u(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(a instanceof o.SimpleRangeValue)r.push(a);else{var c=this.coerceScalarToNumberOrError(a);if(c instanceof n.CellError)return c;r.push(c)}}}catch(e){i.e(e)}finally{i.f()}for(var l=[],h=0,p=r;h<p.length;h++){var f=p[h];if(f instanceof o.SimpleRangeValue){var d=this.manyToExactNumbers(f.valuesFromTopLeftCorner());if(d instanceof n.CellError)return d;l.push.apply(l,s(d))}else l.push(f)}return l}},{key:"manyToExactNumbers",value:function(e){var t,r=[],i=u(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(a instanceof n.CellError)return a;"number"==typeof a&&r.push(a)}}catch(e){i.e(e)}finally{i.f()}return r}}])&&h(t.prototype,r),c&&h(t,c),e}();function f(e){return Number(e)}function d(e){return"string"==typeof e?"":"number"==typeof e?0:"boolean"!=typeof e&&n.EmptyValue}function m(e,t){return e>t?1:e<t?-1:0}function y(e){return["*","?"].includes(e)}t.ArithmeticHelper=p;var g=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function v(e){return g.includes(e)}function E(e,t){for(var r="",n=0;n<e.length;n++){var i=e.charAt(n);if("~"===i){if(n==e.length-1){r+="~";continue}var a=e.charAt(n+1);y(a)||v(a)?(r+="\\"+a,n++):(r+=a,n++)}else y(i)?r+="."+i:v(i)?r+="\\"+i:r+=t?i:i.toLowerCase()}return r}function T(e,t){for(var r="",n=0;n<e.length;n++){var i=e.charAt(n);y(i)||v(i)?r+="\\"+i:r+=t?i:i.toLowerCase()}return r}function b(e,t){for(var r="",n=0;n<e.length;n++){var i=e.charAt(n);y(i)||v(i)?r+=i:r+=t?i:i.toLowerCase()}return r}},function(e,t,r){"use strict";var n=r(2),i=r(39).includes,a=r(76);n({target:"Array",proto:!0,forced:!r(88)("indexOf",{ACCESSORS:!0,1:0})},{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),a("includes")},function(e,t,r){"use strict";t.__esModule=!0,t.collatorFromConfig=
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */
function(e){var t=e.caseSensitive?e.accentSensitive?"variant":"case":e.accentSensitive?"accent":"base",r=e.caseFirst,n=e.ignorePunctuation;return new Intl.Collator(e.localeLang,{sensitivity:t,caseFirst:r,ignorePunctuation:n})}},function(e,t,r){"use strict";function n(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw o}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */r(1),r(63),r(64),r(65),r(75),r(84),r(89),r(201),r(92),r(96),r(98),r(104),t.__esModule=!0,t.instanceOfSimpleDate=c,t.instanceOfSimpleTime=l,t.offsetMonth=function(e,t){var r=12*e.year+e.month-1+t;return{year:Math.floor(r/12),month:r%12+1,day:e.day}},t.truncateDayInMonth=function(e){return{year:e.year,month:e.month,day:Math.min(e.day,s[e.month-1])}},t.roundToNearestSecond=function(e){return Math.round(3600*e*24)/86400},t.numberToSimpleTime=f,t.timeToNumber=d,t.toBasisEU=function(e){return{year:e.year,month:e.month,day:Math.min(30,e.day)}},t.DateTimeHelper=t.maxDate=void 0;var s=[31,28,31,30,31,30,31,31,30,31,30,31],u=[0,31,59,90,120,151,181,212,243,273,303,334];function c(e){return!(!e||"object"!==o(e)&&"function"!=typeof e)&&"year"in e&&"number"==typeof e.year&&"month"in e&&"number"==typeof e.month&&"day"in e&&"number"==typeof e.day}function l(e){return!(!e||"object"!==o(e)&&"function"!=typeof e)&&"hours"in e&&"number"==typeof e.hours&&"minutes"in e&&"number"==typeof e.minutes&&"seconds"in e&&"number"==typeof e.seconds}var h={year:9999,month:12,day:31};t.maxDate=h;var p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.minDateAboluteValue=this.dateToNumberFromZero(t.nullDate),this.maxDateValue=this.dateToNumber(h),this.leapYear1900=t.leapYear1900,!this.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})?this.epochYearZero=this.numberToSimpleDate(2).year:this.epochYearZero=this.numberToSimpleDate(1).year,this.parseDateTime=t.parseDateTime}var t,r,i;return t=e,(r=[{key:"getWithinBounds",value:function(e){return e<=this.maxDateValue&&e>=0?e:void 0}},{key:"dateStringToDateNumber",value:function(e){var t=this.parseDateTimeFromConfigFormats(e);if(void 0!==t)return(l(t)?d(t):0)+(c(t)?this.dateToNumber(t):0)}},{key:"parseSingleFormat",value:function(e,t,r){var n=this.parseDateTime(e,t,r);if(!c(n)||(n.year>=0&&n.year<100&&(n.year<this.getNullYear()?n.year+=2e3:n.year+=1900),this.isValidDate(n)))return n}},{key:"parseDateTimeFromConfigFormats",value:function(e){return this.parseDateTimeFromFormats(e,this.config.dateFormats,this.config.timeFormats)}},{key:"parseDateTimeFromFormats",value:function(e,t,r){var i,a=n(t);try{for(a.s();!(i=a.n()).done;){var o,s=i.value,u=n(r);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=this.parseSingleFormat(e,s,c);if(void 0!==l)return l}}catch(e){u.e(e)}finally{u.f()}}}catch(e){a.e(e)}finally{a.f()}}},{key:"getNullYear",value:function(){return this.config.nullYear}},{key:"getEpochYearZero",value:function(){return this.epochYearZero}},{key:"isValidDate",value:function(e){return!(isNaN(e.year)||isNaN(e.month)||isNaN(e.day)||e.day!==Math.round(e.day)||e.month!==Math.round(e.month)||e.year!==Math.round(e.year)||e.year<1582||e.month<1||e.month>12||e.day<1||!(this.isLeapYear(e.year)&&2===e.month?e.day<=29:e.day<=s[e.month-1]))}},{key:"dateToNumber",value:function(e){return this.dateToNumberFromZero(e)-this.minDateAboluteValue}},{key:"relativeNumberToAbsoluteNumber",value:function(e){return e+this.minDateAboluteValue-(this.leapYear1900?1:0)}},{key:"numberToSimpleDate",value:function(e){var t=Math.floor(e)+this.minDateAboluteValue,r=Math.floor(t/365.2425);this.dateToNumberFromZero({year:r+1,month:1,day:1})<=t?r++:this.dateToNumberFromZero({year:r-1,month:1,day:1})>t&&r--;var n=t-this.dateToNumberFromZero({year:r,month:1,day:1}),i=function(e){var t=0;return u[t+6]<=e&&(t+=6),u[t+3]<=e&&(t+=3),u[t+2]<=e?t+=2:u[t+1]<=e&&(t+=1),t}(n-(this.isLeapYear(r)&&n>=59?1:0));return{year:r,month:i+1,day:n-u[i]-(this.isLeapYear(r)&&i>1?1:0)+1}}},{key:"numberToSimpleDateTime",value:function(e){return Object.assign(Object.assign({},this.numberToSimpleDate(Math.floor(e))),f(e%1))}},{key:"leapYearsCount",value:function(e){return Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+(this.config.leapYear1900&&e>=1900?1:0)}},{key:"countLeapDays",value:function(e){return e.month>2||2===e.month&&e.day>=29?this.leapYearsCount(e.year):this.leapYearsCount(e.year-1)}},{key:"dateToNumberFromZero",value:function(e){return 365*e.year+u[e.month-1]+e.day-1+(e.month<=2?this.leapYearsCount(e.year-1):this.leapYearsCount(e.year))}},{key:"isLeapYear",value:function(e){return!(e%4)&&(!!(e%100)||!(e%400)||1900===e&&this.config.leapYear1900)}},{key:"daysInMonth",value:function(e,t){return this.isLeapYear(e)&&2===t?29:s[t-1]}},{key:"endOfMonth",value:function(e){return{year:e.year,month:e.month,day:this.daysInMonth(e.year,e.month)}}},{key:"toBasisUS",value:function(e,t){return 31===e.day&&(e.day=30),30===e.day&&31===t.day&&(t.day=30),2===e.month&&e.day===this.daysInMonth(e.year,e.month)&&(e.day=30,2===t.month&&t.day===this.daysInMonth(t.year,t.month)&&(t.day=30)),[e,t]}},{key:"yearLengthForBasis",value:function(e,t){return e.year!==t.year?e.year+1!==t.year||e.month<t.month||e.month===t.month&&e.day<t.day?(this.leapYearsCount(t.year)-this.leapYearsCount(e.year-1))/(t.year-e.year+1)+365:this.countLeapDays(t)!==this.countLeapDays({year:e.year,month:e.month,day:e.day-1})?366:365:this.isLeapYear(e.year)?366:365}}])&&a(t.prototype,r),i&&a(t,i),e}();function f(e){e=Math.round(24*e*60*60*1e5)/864e7,e*=24;var t=Math.floor(e);e-=t,e*=60;var r=Math.floor(e);return e-=r,e*=60,{hours:t,minutes:r,seconds:Math.round(1e5*e)/1e5}}function d(e){return((e.seconds/60+e.minutes)/60+e.hours)/24}t.DateTimeHelper=p},function(e,t,r){"use strict";r(1),r(63),r(64),r(65),r(75),r(113),r(140),r(84),r(239),r(89),r(133),r(209),r(92),r(96),r(98),r(104),t.__esModule=!0,t.normalizeRemovedIndexes=F,t.normalizeAddedIndexes=D,t.Operations=t.RemoveColumnsCommand=t.AddColumnsCommand=t.AddRowsCommand=t.RemoveRowsCommand=void 0;var n=r(219),i=r(266),a=r(106),o=r(257),s=r(217),u=r(267),c=r(218),l=r(268),h=r(107),p=r(226),f=r(138),d=r(270),m=r(272),y=r(273),g=r(274),v=r(275),E=r(276),T=r(132),b=r(277),x=r(255);function A(e){return function(e){if(Array.isArray(e))return C(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||w(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||w(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=w(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function w(e,t){if(e){if("string"==typeof e)return C(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?C(e,t):void 0}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function N(e,t,r){return t&&k(e.prototype,t),r&&k(e,r),e}var _=function(){function e(t,r){O(this,e),this.sheet=t,this.indexes=r}return N(e,[{key:"normalizedIndexes",value:function(){return F(this.indexes)}},{key:"rowsSpans",value:function(){var e=this;return this.normalizedIndexes().map((function(t){return s.RowsSpan.fromNumberOfRows(e.sheet,t[0],t[1])}))}}]),e}();t.RemoveRowsCommand=_;var I=function(){function e(t,r){O(this,e),this.sheet=t,this.indexes=r}return N(e,[{key:"normalizedIndexes",value:function(){return D(this.indexes)}},{key:"rowsSpans",value:function(){var e=this;return this.normalizedIndexes().map((function(t){return s.RowsSpan.fromNumberOfRows(e.sheet,t[0],t[1])}))}}]),e}();t.AddRowsCommand=I;var M=function(){function e(t,r){O(this,e),this.sheet=t,this.indexes=r}return N(e,[{key:"normalizedIndexes",value:function(){return D(this.indexes)}},{key:"columnsSpans",value:function(){var e=this;return this.normalizedIndexes().map((function(t){return s.ColumnsSpan.fromNumberOfColumns(e.sheet,t[0],t[1])}))}}]),e}();t.AddColumnsCommand=M;var P=function(){function e(t,r){O(this,e),this.sheet=t,this.indexes=r}return N(e,[{key:"normalizedIndexes",value:function(){return F(this.indexes)}},{key:"columnsSpans",value:function(){var e=this;return this.normalizedIndexes().map((function(t){return s.ColumnsSpan.fromNumberOfColumns(e.sheet,t[0],t[1])}))}}]),e}();t.RemoveColumnsCommand=P;var L=function(){function e(t,r,n,i,a,o,s,c){O(this,e),this.dependencyGraph=t,this.columnSearch=r,this.cellContentParser=n,this.parser=i,this.stats=a,this.lazilyTransformingAstService=o,this.namedExpressions=s,this.config=c,this.changes=u.ContentChanges.empty(),this.allocateNamedExpressionAddressSpace()}return N(e,[{key:"removeRows",value:function(e){var t,r=[],n=R(e.rowsSpans());try{for(n.s();!(t=n.n()).done;){var i=t.value,a=this.doRemoveRows(i);a&&r.push(a)}}catch(e){n.e(e)}finally{n.f()}return r}},{key:"addRows",value:function(e){var t,r=R(e.rowsSpans());try{for(r.s();!(t=r.n()).done;){var n=t.value;this.doAddRows(n)}}catch(e){r.e(e)}finally{r.f()}}},{key:"addColumns",value:function(e){var t,r=R(e.columnsSpans());try{for(r.s();!(t=r.n()).done;){var n=t.value;this.doAddColumns(n)}}catch(e){r.e(e)}finally{r.f()}}},{key:"removeColumns",value:function(e){var t,r=[],n=R(e.columnsSpans());try{for(n.s();!(t=n.n()).done;){var i=t.value,a=this.doRemoveColumns(i);a&&r.push(a)}}catch(e){n.e(e)}finally{n.f()}return r}},{key:"removeSheet",value:function(e){var t,r=this,i=this.sheetMapping.fetch(e);return this.dependencyGraph.removeSheet(i),this.stats.measure(n.StatType.TRANSFORM_ASTS,(function(){var e=new v.RemoveSheetTransformer(i);e.performEagerTransformations(r.dependencyGraph,r.parser),t=r.lazilyTransformingAstService.addTransformation(e)})),this.sheetMapping.removeSheet(i),this.columnSearch.removeSheet(i),t}},{key:"clearSheet",value:function(e){this.dependencyGraph.clearSheet(e),this.columnSearch.removeSheet(e)}},{key:"addSheet",value:function(e){var t=this.sheetMapping.addSheet(e),r=[];return this.dependencyGraph.addressMapping.autoAddSheet(t,r,(0,b.findBoundaries)(r)),this.sheetMapping.fetchDisplayName(t)}},{key:"renameSheet",value:function(e,t){return this.sheetMapping.renameSheet(e,t)}},{key:"moveRows",value:function(e,t,r,n){var i=s.RowsSpan.fromNumberOfRows(e,n,r);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddRows(i),n<t&&(t+=r);var o=(0,a.simpleCellAddress)(e,0,t),u=(0,a.simpleCellAddress)(e,0,n);this.moveCells(o,Number.POSITIVE_INFINITY,r,u);var c=s.RowsSpan.fromNumberOfRows(e,t,r);return this.doRemoveRows(c),this.lazilyTransformingAstService.commitCombinedMode()}},{key:"moveColumns",value:function(e,t,r,n){var i=s.ColumnsSpan.fromNumberOfColumns(e,n,r);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddColumns(i),n<t&&(t+=r);var o=(0,a.simpleCellAddress)(e,t,0),u=(0,a.simpleCellAddress)(e,n,0);this.moveCells(o,r,Number.POSITIVE_INFINITY,u);var c=s.ColumnsSpan.fromNumberOfColumns(e,t,r);return this.doRemoveColumns(c),this.lazilyTransformingAstService.commitCombinedMode()}},{key:"moveCells",value:function(e,t,r,i){var a=this;this.ensureItIsPossibleToMoveCells(e,t,r,i);var o=T.AbsoluteCellRange.spanFrom(e,t,r),s=T.AbsoluteCellRange.spanFrom(i,t,r);this.dependencyGraph.breakNumericMatricesInRange(o),this.dependencyGraph.breakNumericMatricesInRange(s);var u=i.col-e.col,c=i.row-e.row,l=i.sheet,h=this.getRangeClipboardCells(s),p=this.dependencyGraph.valuesFromRange(s);this.columnSearch.removeValues(p);var f,d=this.dependencyGraph.valuesFromRange(o);this.columnSearch.moveValues(d,u,c,l),this.stats.measure(n.StatType.TRANSFORM_ASTS,(function(){var e=new g.MoveCellsTransformer(o,u,c,l);e.performEagerTransformations(a.dependencyGraph,a.parser),f=a.lazilyTransformingAstService.addTransformation(e)})),this.dependencyGraph.moveCells(o,u,c,l);var m=this.updateNamedExpressionsForMovedCells(e,t,r,i);return{version:f,overwrittenCellsData:h,addedGlobalNamedExpressions:m}}},{key:"addNamedExpression",value:function(e,t,r,n){this.storeNamedExpressionInCell(this.namedExpressions.lookupNextAddress(e,r),t);var i=this.namedExpressions.addNamedExpression(e,r,n);this.adjustNamedExpressionEdges(i,e,r)}},{key:"restoreNamedExpression",value:function(e,t,r){var n=e.displayName,i=e.options;this.restoreCell(e.address,t);var a=this.namedExpressions.addNamedExpression(n,r,i);this.adjustNamedExpressionEdges(a,n,r)}},{key:"changeNamedExpressionExpression",value:function(e,t,r,n){var i=this.namedExpressions.namedExpressionForScope(e,r);if(!i)throw new p.NamedExpressionDoesNotExistError(e);var a=i.copy();i.options=n;var o=this.getClipboardCell(i.address);return this.storeNamedExpressionInCell(i.address,t),[a,o]}},{key:"removeNamedExpression",value:function(e,t){var r=this.namedExpressions.namedExpressionForScope(e,t);if(!r)throw new p.NamedExpressionDoesNotExistError(e);this.namedExpressions.remove(r.displayName,t);var n=this.getClipboardCell(r.address);if(void 0!==t){var i=this.namedExpressions.workbookNamedExpressionOrPlaceholder(e);this.dependencyGraph.exchangeNode(r.address,i.address)}else this.dependencyGraph.setCellEmpty(r.address);return[r,n]}},{key:"ensureItIsPossibleToMoveCells",value:function(e,t,r,n){if((0,a.invalidSimpleCellAddress)(e)||!(U(t)&&U(r)||function(e,t,r){return 0===e.row&&U(t)&&r===Number.POSITIVE_INFINITY||0===e.col&&U(r)&&t===Number.POSITIVE_INFINITY}(e,t,r))||(0,a.invalidSimpleCellAddress)(n)||!this.sheetMapping.hasSheetWithId(e.sheet)||!this.sheetMapping.hasSheetWithId(n.sheet))throw new p.InvalidArgumentsError("a valid range of cells to move.");var i=T.AbsoluteCellRange.spanFrom(e,t,r),o=T.AbsoluteCellRange.spanFrom(n,t,r);if(o.exceedsSheetSizeLimits(this.config.maxColumns,this.config.maxRows))throw new p.SheetSizeLimitExceededError;if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRange(i))throw new p.SourceLocationHasMatrixError;if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRange(o))throw new p.TargetLocationHasMatrixError}},{key:"restoreClipboardCells",value:function(e,t){var r,n=[],a=R(t);try{for(a.s();!(r=a.n()).done;){var o=S(r.value,2),s=o[0],u=o[1];if(this.restoreCell(s,u),u.type===i.ClipboardCellType.FORMULA){var c=this.parser.fetchCachedResult(u.hash).dependencies;n.push.apply(n,A(this.updateNamedExpressionsForTargetAddress(e,s,c)))}}}catch(e){a.e(e)}finally{a.f()}return n}},{key:"restoreCell",value:function(e,t){switch(t.type){case i.ClipboardCellType.VALUE:this.setValueToCell(t.value,e);break;case i.ClipboardCellType.FORMULA:this.setFormulaToCellFromCache(t.hash,e);break;case i.ClipboardCellType.EMPTY:this.setCellEmpty(e);break;case i.ClipboardCellType.PARSING_ERROR:this.setParsingErrorToCell(t.rawInput,t.errors,e)}}},{key:"doRemoveRows",value:function(e){var t=this;if(!this.rowEffectivelyNotInSheet(e.rowStart,e.sheet)){var r,i,a=[],o=R(this.dependencyGraph.entriesFromRowsSpan(e));try{for(o.s();!(r=o.n()).done;){var s=S(r.value,1)[0];a.push({address:s,cellType:this.getClipboardCell(s)})}}catch(e){o.e(e)}finally{o.f()}return this.dependencyGraph.removeRows(e),this.stats.measure(n.StatType.TRANSFORM_ASTS,(function(){var r=new m.RemoveRowsTransformer(e);r.performEagerTransformations(t.dependencyGraph,t.parser),i=t.lazilyTransformingAstService.addTransformation(r)})),{version:i,removedCells:a,rowFrom:e.rowStart,rowCount:e.numberOfRows}}}},{key:"doRemoveColumns",value:function(e){var t=this;if(!this.columnEffectivelyNotInSheet(e.columnStart,e.sheet)){var r,i,a=[],o=R(this.dependencyGraph.entriesFromColumnsSpan(e));try{for(o.s();!(r=o.n()).done;){var s=S(r.value,1)[0];a.push({address:s,cellType:this.getClipboardCell(s)})}}catch(e){o.e(e)}finally{o.f()}return this.dependencyGraph.removeColumns(e),this.columnSearch.removeColumns(e),this.stats.measure(n.StatType.TRANSFORM_ASTS,(function(){var r=new E.RemoveColumnsTransformer(e);r.performEagerTransformations(t.dependencyGraph,t.parser),i=t.lazilyTransformingAstService.addTransformation(r)})),{version:i,removedCells:a,columnFrom:e.columnStart,columnCount:e.numberOfColumns}}}},{key:"doAddRows",value:function(e){var t=this;this.rowEffectivelyNotInSheet(e.rowStart,e.sheet)||(this.dependencyGraph.addRows(e),this.stats.measure(n.StatType.TRANSFORM_ASTS,(function(){var r=new d.AddRowsTransformer(e);r.performEagerTransformations(t.dependencyGraph,t.parser),t.lazilyTransformingAstService.addTransformation(r)})))}},{key:"doAddColumns",value:function(e){var t=this;this.columnEffectivelyNotInSheet(e.columnStart,e.sheet)||(this.dependencyGraph.addColumns(e),this.columnSearch.addColumns(e),this.stats.measure(n.StatType.TRANSFORM_ASTS,(function(){var r=new y.AddColumnsTransformer(e);r.performEagerTransformations(t.dependencyGraph,t.parser),t.lazilyTransformingAstService.addTransformation(r)})))}},{key:"getClipboardCell",value:function(e){var t=this.dependencyGraph.getCell(e);if(null===t||t instanceof h.EmptyCellVertex)return{type:i.ClipboardCellType.EMPTY};if(t instanceof h.ValueCellVertex)return{type:i.ClipboardCellType.VALUE,value:t.getCellValue()};if(t instanceof h.MatrixVertex)return{type:i.ClipboardCellType.VALUE,value:t.getMatrixCellValue(e)};if(t instanceof h.FormulaCellVertex)return{type:i.ClipboardCellType.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))};if(t instanceof h.ParsingErrorVertex)return{type:i.ClipboardCellType.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors};throw Error("Trying to copy unsupported type")}},{key:"getSheetClipboardCells",value:function(e){for(var t=this.dependencyGraph.getSheetHeight(e),r=this.dependencyGraph.getSheetWidth(e),n=new Array(t),i=0;i<t;i++){n[i]=new Array(r);for(var o=0;o<r;o++){var s=(0,a.simpleCellAddress)(e,o,i);n[i][o]=this.getClipboardCell(s)}}return n}},{key:"getRangeClipboardCells",value:function(e){var t,r=[],n=R(e.addresses(this.dependencyGraph));try{for(n.s();!(t=n.n()).done;){var i=t.value;r.push([i,this.getClipboardCell(i)])}}catch(e){n.e(e)}finally{n.f()}return r}},{key:"setCellContent",value:function(e,t){var r=this.cellContentParser.parse(t),n=this.dependencyGraph.getCell(e);if(!(n instanceof h.MatrixVertex)||n.isFormula()||r instanceof o.CellContent.Number||(this.dependencyGraph.breakNumericMatrix(n),n=this.dependencyGraph.getCell(e)),n instanceof h.MatrixVertex&&!n.isFormula()&&r instanceof o.CellContent.Number){var i=r.value,a=this.dependencyGraph.getCellValue(e);this.dependencyGraph.graph.markNodeAsSpecialRecentlyChanged(n),n.setMatrixCellValue(e,i),this.columnSearch.change(a,i,e),this.changes.addChange(i,e)}else if(!(n instanceof h.MatrixVertex)&&r instanceof o.CellContent.MatrixFormula){var s=this.parser.parse(r.formula,e),u=s.ast,p=s.errors,f=s.dependencies;if(p.length>0)this.dependencyGraph.setParsingErrorToCell(e,new h.ParsingErrorVertex(p,r.formulaWithBraces()));else{var d=(0,l.buildMatrixVertex)(u,e);if(d instanceof h.ValueCellVertex)throw Error("What if new matrix vertex is not properly constructed?");this.dependencyGraph.addNewMatrixVertex(d),this.dependencyGraph.processCellDependencies((0,c.absolutizeDependencies)(f,e),d),this.dependencyGraph.graph.markNodeAsSpecialRecentlyChanged(d)}}else{if(n instanceof h.MatrixVertex)throw new Error("Illegal operation");if(r instanceof o.CellContent.Formula){var m=this.parser.parse(r.formula,e),y=m.ast,g=m.errors,v=m.hasVolatileFunction,E=m.hasStructuralChangeFunction,T=m.dependencies;g.length>0?this.dependencyGraph.setParsingErrorToCell(e,new h.ParsingErrorVertex(g,r.formula)):this.dependencyGraph.setFormulaToCell(e,y,(0,c.absolutizeDependencies)(T,e),v,E)}else if(r instanceof o.CellContent.Empty)this.setCellEmpty(e);else{if(r instanceof o.CellContent.MatrixFormula)throw new Error("Cant happen");this.setValueToCell(r.value,e)}}}},{key:"setSheetContent",value:function(e,t){this.clearSheet(e);for(var r=0;r<t.length;r++)for(var n=0;n<t[r].length;n++){var i=(0,a.simpleCellAddress)(e,n,r);this.setCellContent(i,t[r][n])}}},{key:"setValueToCell",value:function(e,t){var r=this.dependencyGraph.getCellValue(t);this.dependencyGraph.setValueToCell(t,e),this.columnSearch.change(r,e,t),this.changes.addChange(e,t)}},{key:"setCellEmpty",value:function(e){var t=this.dependencyGraph.getCellValue(e);this.columnSearch.remove(t,e),this.changes.addChange(a.EmptyValue,e),this.dependencyGraph.setCellEmpty(e)}},{key:"setFormulaToCellFromCache",value:function(e,t){var r=this.parser.fetchCachedResult(e),n=r.ast,i=r.hasVolatileFunction,a=r.hasStructuralChangeFunction,o=r.dependencies;this.dependencyGraph.setFormulaToCell(t,n,(0,c.absolutizeDependencies)(o,t),i,a)}},{key:"setParsingErrorToCell",value:function(e,t,r){this.dependencyGraph.setParsingErrorToCell(r,new h.ParsingErrorVertex(t,e))}},{key:"rowEffectivelyNotInSheet",value:function(e,t){return e>=this.dependencyGraph.addressMapping.getHeight(t)}},{key:"getAndClearContentChanges",value:function(){var e=this.changes;return this.changes=u.ContentChanges.empty(),e}},{key:"forceApplyPostponedTransformations",value:function(){this.dependencyGraph.forceApplyPostponedTransformations()}},{key:"columnEffectivelyNotInSheet",value:function(e,t){return e>=this.dependencyGraph.addressMapping.getWidth(t)}},{key:"adjustNamedExpressionEdges",value:function(e,t,r){if(void 0!==r){var n,i=this.dependencyGraph.fetchCellOrCreateEmpty(e.address),a=this.namedExpressions.workbookNamedExpressionOrPlaceholder(t),o=this.dependencyGraph.fetchCellOrCreateEmpty(a.address),s=R(this.dependencyGraph.graph.adjacentNodes(o));try{for(s.s();!(n=s.n()).done;){var u=n.value;if(u instanceof h.FormulaCellVertex&&u.cellAddress.sheet===r){var l,p=u.getFormula(this.lazilyTransformingAstService),d=u.getAddress(this.lazilyTransformingAstService),m=this.parser.fetchCachedResultForAst(p).dependencies,y=R((0,c.absolutizeDependencies)(m,d));try{for(y.s();!(l=y.n()).done;){var g=l.value;g instanceof f.NamedExpressionDependency&&g.name.toLowerCase()===e.displayName.toLowerCase()&&(this.dependencyGraph.graph.removeEdge(o,u),this.dependencyGraph.graph.addEdge(i,u))}}catch(e){y.e(e)}finally{y.f()}}}}catch(e){s.e(e)}finally{s.f()}}}},{key:"storeNamedExpressionInCell",value:function(e,t){var r=this.cellContentParser.parse(t);if(r instanceof o.CellContent.MatrixFormula)throw new Error("Matrix formulas are not supported");if(r instanceof o.CellContent.Formula){var n=this.parser.parse(r.formula,(0,a.simpleCellAddress)(-1,0,0));if((0,x.doesContainRelativeReferences)(n.ast))throw new p.NoRelativeAddressesAllowedError;var i=n.ast,s=n.hasVolatileFunction,u=n.hasStructuralChangeFunction,l=n.dependencies;this.dependencyGraph.setFormulaToCell(e,i,(0,c.absolutizeDependencies)(l,e),s,u)}else r instanceof o.CellContent.Empty?this.setCellEmpty(e):this.setValueToCell(r.value,e)}},{key:"updateNamedExpressionsForMovedCells",value:function(e,t,r,n){if(e.sheet===n.sheet)return[];var i,a=[],o=R(T.AbsoluteCellRange.spanFrom(n,t,r).addresses(this.dependencyGraph));try{for(o.s();!(i=o.n()).done;){var s=i.value,u=this.addressMapping.fetchCell(s);if(u instanceof h.FormulaCellVertex&&s.sheet!==e.sheet){var c=u.getFormula(this.lazilyTransformingAstService),l=this.parser.fetchCachedResultForAst(c).dependencies;a.push.apply(a,A(this.updateNamedExpressionsForTargetAddress(e.sheet,s,l)))}}}catch(e){o.e(e)}finally{o.f()}return a}},{key:"updateNamedExpressionsForTargetAddress",value:function(e,t,r){if(e===t.sheet)return[];var n,i=[],a=this.addressMapping.fetchCell(t),o=R((0,c.absolutizeDependencies)(r,t));try{for(o.s();!(n=o.n()).done;){var s=n.value;if(s instanceof f.NamedExpressionDependency){var u=s.name,l=this.dependencyGraph.fetchNamedExpressionVertex(u,e),h=this.namedExpressions.isExpressionInScope(u,t.sheet)?this.dependencyGraph.fetchNamedExpressionVertex(u,t.sheet):this.copyOrFetchGlobalNamedExpressionVertex(u,l,i);h!==l&&(this.dependencyGraph.graph.softRemoveEdge(l,a),this.dependencyGraph.graph.addEdge(h,a))}}}catch(e){o.e(e)}finally{o.f()}return i}},{key:"allocateNamedExpressionAddressSpace",value:function(){this.dependencyGraph.addressMapping.addSheet(-1,new h.SparseStrategy(0,0))}},{key:"copyOrFetchGlobalNamedExpressionVertex",value:function(e,t,r){var n=this.namedExpressions.namedExpressionForScope(e);if(void 0===n)if(n=this.namedExpressions.addNamedExpression(e),r.push(n.normalizeExpressionName()),t instanceof h.FormulaCellVertex){var i=this.parser.fetchCachedResultForAst(t.getFormula(this.lazilyTransformingAstService)),a=i.ast,o=i.hasVolatileFunction,s=i.hasStructuralChangeFunction,u=i.dependencies;this.dependencyGraph.setFormulaToCell(n.address,a,(0,c.absolutizeDependencies)(u,n.address),o,s)}else t instanceof h.EmptyCellVertex?this.setCellEmpty(n.address):t instanceof h.ValueCellVertex&&this.setValueToCell(t.getCellValue(),n.address);return this.dependencyGraph.fetchCellOrCreateEmpty(n.address)}},{key:"sheetMapping",get:function(){return this.dependencyGraph.sheetMapping}},{key:"addressMapping",get:function(){return this.dependencyGraph.addressMapping}}]),e}();function F(e){if(e.length<=1)return e;for(var t=e.sort((function(e,t){var r=S(e,1)[0],n=S(t,1)[0];return r<n?-1:r>n?1:0})),r=t.reduce((function(e,t){var r=S(t,2),n=r[0],i=r[1],a=e[e.length-1],o=a[0]+a[1];return n<=o?a[1]+=Math.max(0,i-(o-n)):e.push([n,i]),e}),[t[0]]),n=0,i=0;i<r.length;++i)r[i][0]-=n,n+=r[i][1];return r}function D(e){if(e.length<=1)return e;for(var t=e.sort((function(e,t){var r=S(e,1)[0],n=S(t,1)[0];return r<n?-1:r>n?1:0})),r=t.reduce((function(e,t){var r=S(t,2),n=r[0],i=r[1],a=e[e.length-1];return n===a[0]?a[1]=Math.max(a[1],i):e.push([n,i]),e}),[t[0]]),n=0,i=0;i<r.length;++i)r[i][0]+=n,n+=r[i][1];return r}function U(e){return Number.isInteger(e)&&e>0}t.Operations=L},function(e,t,r){"use strict";t.__esModule=!0,t.ClipboardOperations=t.ClipboardCellType=void 0,r(125);var n,i,a=r(132),o=r(106),s=r(226);function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),e}!function(e){e[e.COPY=0]="COPY",e[e.CUT=1]="CUT"}(n||(n={})),t.ClipboardCellType=i,function(e){e[e.VALUE=0]="VALUE",e[e.EMPTY=1]="EMPTY",e[e.FORMULA=2]="FORMULA",e[e.PARSING_ERROR=3]="PARSING_ERROR"}(i||(t.ClipboardCellType=i={}));var h=function(){function e(t,r,n,i,a){u(this,e),this.sourceLeftCorner=t,this.width=r,this.height=n,this.type=i,this.content=a}return l(e,[{key:"getContent",value:regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.content){e.next=4;break}return e.abrupt("return");case 4:r=0;case 5:if(!(r<this.height)){e.next=16;break}n=0;case 7:if(!(n<this.width)){e.next=13;break}return e.next=10,[(0,o.simpleCellAddress)(t.sheet,t.col+n,t.row+r),this.content[r][n]];case 10:++n,e.next=7;break;case 13:++r,e.next=5;break;case 16:case"end":return e.stop()}}),e,this)}))}]),e}(),p=function(){function e(t,r,n,i,a){u(this,e),this.dependencyGraph=t,this.operations=r,this.parser=n,this.lazilyTransformingAstService=i,this.config=a}return l(e,[{key:"cut",value:function(e,t,r){this.clipboard=new h(e,t,r,n.CUT)}},{key:"copy",value:function(e,t,r){for(var i=[],a=0;a<r;++a){i[a]=[];for(var s=0;s<t;++s){var u=this.operations.getClipboardCell((0,o.simpleCellAddress)(e.sheet,e.col+s,e.row+a));i[a].push(u)}}this.clipboard=new h(e,t,r,n.COPY,i)}},{key:"abortCut",value:function(){this.clipboard&&this.clipboard.type===n.CUT&&this.clear()}},{key:"clear",value:function(){this.clipboard=void 0}},{key:"ensureItIsPossibleToCopyPaste",value:function(e){if(void 0!==this.clipboard){if((0,o.invalidSimpleCellAddress)(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new s.InvalidArgumentsError("a valid target address.");var t=a.AbsoluteCellRange.spanFrom(e,this.clipboard.width,this.clipboard.height);if(t.exceedsSheetSizeLimits(this.config.maxColumns,this.config.maxRows))throw new s.SheetSizeLimitExceededError;if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRange(t))throw new Error("It is not possible to paste onto matrix")}}},{key:"isCutClipboard",value:function(){return void 0!==this.clipboard&&this.clipboard.type===n.CUT}},{key:"isCopyClipboard",value:function(){return void 0!==this.clipboard&&this.clipboard.type===n.COPY}}]),e}();t.ClipboardOperations=p},function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r(1),r(63),r(64),r(110),r(65),r(75),r(84),r(89),r(92),r(96),r(98),r(124),r(104),t.__esModule=!0,t.ContentChanges=void 0;
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */
var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.changes=[]}var t,r,o;return t=e,o=[{key:"empty",value:function(){return new e}}],(r=[{key:"addAll",value:function(e){var t;return(t=this.changes).push.apply(t,i(e.changes)),this}},{key:"addMatrixChange",value:function(e,t){var r,i=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=a(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw o}}}}(e.generateValues(t));try{for(i.s();!(r=i.n()).done;){var o=n(r.value,2),s=o[0],u=o[1];this.addSingleCellValue(s,u)}}catch(e){i.e(e)}finally{i.f()}}},{key:"addChange",value:function(e,t){this.addSingleCellValue(e,t)}},{key:"add",value:function(){var e;(e=this.changes).push.apply(e,arguments)}},{key:"exportChanges",value:function(e){var t=this,r=[];return this.changes.forEach((function(n,i){r[i]=e.exportChange(t.changes[i])})),r}},{key:"getChanges",value:function(){return this.changes}},{key:"isEmpty",value:function(){return this.changes===[]}},{key:"addSingleCellValue",value:function(e,t){this.add({sheet:t.sheet,col:t.col,row:t.row,value:e})}}])&&s(t.prototype,r),o&&s(t,o),e}();t.ContentChanges=u},function(e,t,r){"use strict";r(1),r(63),r(64),r(110),r(65),r(75),r(236),r(84),r(89),r(207),r(133),r(92),r(96),r(98),r(124),r(104),t.__esModule=!0,t.buildMatrixVertex=v,t.MatrixDetectionStrategy=t.SimpleStrategy=t.GraphBuilder=void 0;var n=r(218),i=r(106),a=r(257),o=r(107),s=r(269),u=r(232),c=r(219);function l(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return h(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t,r){return t&&f(e.prototype,t),r&&f(e,r),e}var m=function(){function e(t,r,n,i,a,o){p(this,e),this.dependencyGraph=t,this.columnSearch=r,this.parser=n,this.cellContentParser=i,this.config=a,this.stats=o,this.config.matrixDetection?this.buildStrategy=new g(this.dependencyGraph,this.columnSearch,this.parser,this.stats,a.matrixDetectionThreshold,this.cellContentParser):this.buildStrategy=new y(this.dependencyGraph,this.columnSearch,this.parser,this.stats,this.cellContentParser)}return d(e,[{key:"buildGraph",value:function(e){var t=this.buildStrategy.run(e);this.processDependencies(t)}},{key:"processDependencies",value:function(e){var t=this;e.forEach((function(e,r){t.dependencyGraph.processCellDependencies(e,r)}))}}]),e}();t.GraphBuilder=m;var y=function(){function e(t,r,n,i,a){p(this,e),this.dependencyGraph=t,this.columnIndex=r,this.parser=n,this.stats=i,this.cellContentParser=a}return d(e,[{key:"run",value:function(e){var t=this,r=new Map;for(var s in e)for(var u=this.dependencyGraph.getSheetId(s),l=e[s],h=0;h<l.length;++h)for(var p=l[h],f=function(e){var s=p[e],l=(0,i.simpleCellAddress)(u,e,h),f=t.cellContentParser.parse(s);if(f instanceof a.CellContent.MatrixFormula){if(t.dependencyGraph.existsVertex(l))return"continue";var d=t.stats.measure(c.StatType.PARSER,(function(){return t.parser.parse(f.formula,l)}));if(d.errors.length>0){var m=new o.ParsingErrorVertex(d.errors,f.formulaWithBraces());t.dependencyGraph.addVertex(l,m)}else{var y=v(d.ast,l);r.set(y,(0,n.absolutizeDependencies)(d.dependencies,l)),t.dependencyGraph.addMatrixVertex(l,y)}}else if(f instanceof a.CellContent.Formula){var g=t.stats.measure(c.StatType.PARSER,(function(){return t.parser.parse(f.formula,l)}));if(g.errors.length>0){var E=new o.ParsingErrorVertex(g.errors,f.formula);t.dependencyGraph.addVertex(l,E)}else{var T=new o.FormulaCellVertex(g.ast,l,0);r.set(T,(0,n.absolutizeDependencies)(g.dependencies,l)),t.dependencyGraph.addVertex(l,T),g.hasVolatileFunction&&t.dependencyGraph.markAsVolatile(T),g.hasStructuralChangeFunction&&t.dependencyGraph.markAsDependentOnStructureChange(T)}}else if(f instanceof a.CellContent.Empty);else{var b=new o.ValueCellVertex(f.value);t.columnIndex.add(f.value,l),t.dependencyGraph.addVertex(l,b)}},d=0;d<p.length;++d)f(d);return r}}]),e}();t.SimpleStrategy=y;var g=function(){function e(t,r,n,i,a,o){p(this,e),this.dependencyGraph=t,this.columnSearch=r,this.parser=n,this.stats=i,this.threshold=a,this.cellContentParser=o}return d(e,[{key:"run",value:function(e){var t=this,r=new Map,u=new s.GraphBuilderMatrixHeuristic(this.dependencyGraph,this.columnSearch,this.threshold,this.cellContentParser);for(var h in e){var p=this.dependencyGraph.getSheetId(h),f=e[h];u.addSheet(p,{width:this.dependencyGraph.getSheetWidth(p),height:this.dependencyGraph.getSheetHeight(p)});for(var d=0;d<f.length;++d)for(var m=f[d],y=function(e){var s=m[e],l=(0,i.simpleCellAddress)(p,e,d),h=t.cellContentParser.parse(s);if(h instanceof a.CellContent.MatrixFormula){if(t.dependencyGraph.existsVertex(l))return"continue";var f=t.stats.measure(c.StatType.PARSER,(function(){return t.parser.parse(h.formula,l)}));if(f.errors.length>0){var y=new o.ParsingErrorVertex(f.errors,h.formulaWithBraces());t.dependencyGraph.addVertex(l,y)}else{var g=v(f.ast,l);r.set(g,(0,n.absolutizeDependencies)(f.dependencies,l)),t.dependencyGraph.addMatrixVertex(l,g)}}else if(h instanceof a.CellContent.Formula){var E=t.stats.measure(c.StatType.PARSER,(function(){return t.parser.parse(h.formula,l)}));if(E.errors.length>0){var T=new o.ParsingErrorVertex(E.errors,h.formula);t.dependencyGraph.addVertex(l,T)}else{var b=new o.FormulaCellVertex(E.ast,l,0);r.set(b,(0,n.absolutizeDependencies)(E.dependencies,l)),t.dependencyGraph.addVertex(l,b)}}else if(h instanceof a.CellContent.Empty);else if(h instanceof a.CellContent.Number)u.add(l);else{var x=new o.ValueCellVertex(h.value);t.columnSearch.add(h.value,l),t.dependencyGraph.addVertex(l,x)}},g=0;g<m.length;++g)y(g)}this.stats.start(c.StatType.MATRIX_DETECTION);for(var E=u.run(e),T=E.length-1;T>=0;--T){var b,x=l(E[T].cells.reverse());try{for(x.s();!(b=x.n()).done;){var A=b.value,S=e[this.dependencyGraph.getSheetName(A.sheet)][A.row][A.col],R=new o.ValueCellVertex(Number(S));this.columnSearch.add(Number(S),A),this.dependencyGraph.addVertex(A,R)}}catch(e){x.e(e)}finally{x.f()}}return this.stats.end(c.StatType.MATRIX_DETECTION),r}}]),e}();function v(e,t){var r=(0,u.checkMatrixSize)(e,t);return r instanceof i.CellError?new o.ValueCellVertex(r):new o.MatrixVertex(t,r.width,r.height,e)}t.MatrixDetectionStrategy=g},function(e,t,r){"use strict";r(1),r(63),r(64),r(110),r(65),r(75),r(84),r(89),r(207),r(92),r(96),r(98),r(124),r(104),t.__esModule=!0,t.findMatrices=m,t.GraphBuilderMatrixHeuristic=t.Array2d=void 0;var n=r(132),i=r(106),a=r(257),o=r(107),s=r(232);function u(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t,r){return t&&h(e.prototype,t),r&&h(e,r),e}var f=function(){function e(t){l(this,e),this._size=t,this.array=new Array(t.height);for(var r=0;r<t.height;++r)this.array[r]=new Array(t.width)}return p(e,[{key:"set",value:function(e,t,r){this.array[t][e]=r}},{key:"get",value:function(e,t){var r=this.array[t];return r&&r[e]||null}},{key:"size",value:function(){return this._size}}],[{key:"fromArray",value:function(t){for(var r=new s.MatrixSize(t[0].length,t.length),n=new e(r),i=0;i<r.height;++i)for(var a=0;a<r.width;++a)n.set(a,i,t[i][a]);return n}}]),e}();t.Array2d=f;var d=function(){function e(t,r,n,i){l(this,e),this.dependencyGraph=t,this.columnSearch=r,this.threshold=n,this.cellContentParser=i,this.mapping=new Map}return p(e,[{key:"addSheet",value:function(e,t){this.mapping.set(e,new f(t))}},{key:"add",value:function(e){if(!this.mapping.has(e.sheet))throw Error("Sheet with id: ".concat(e.sheet," does not exists"));this.mapping.get(e.sheet).set(e.col,e.row,!0)}},{key:"run",value:function(e){var t=this,r=[];return this.findMatrices().forEach((function(n){if(!n.isMatrix||n.range.size()<t.threshold)r.push(n);else{var i=n.range,a=o.MatrixVertex.fromRange(i),s=e[t.dependencyGraph.getSheetName(i.start.sheet)],u=t.matrixFromPlainValues(i,s);a.setCellValue(u),t.dependencyGraph.addMatrixVertex(a.getAddress(),a),t.columnSearch.add(u,a.getAddress())}})),this.mapping.clear(),r}},{key:"matrixFromPlainValues",value:function(e,t){for(var r=new Array(e.height()),n=0;n<e.height();++n)r[n]=new Array(e.width());var i,o=u(e.addresses(this.dependencyGraph));try{for(o.s();!(i=o.n()).done;){var c=i.value,l=t[c.row][c.col],h=this.cellContentParser.parse(l);if(!(h instanceof a.CellContent.Number))throw new Error("Range contains not numeric values");r[c.row-e.start.row][c.col-e.start.col]=h.value}}catch(e){o.e(e)}finally{o.f()}return new s.Matrix(r)}},{key:"findMatrices",value:function(){var e=[];return this.mapping.forEach((function(t,r){var n,i=u(m(r,t));try{for(i.s();!(n=i.n()).done;){var a=n.value;e.push(a)}}catch(e){i.e(e)}finally{i.f()}})),e}}]),e}();function m(e,t){for(var r=t.size(),a=new Map,o=new f(r),s=0,u=r.height-1;u>=0;--u)for(var c=r.width-1;c>=0;--c){var l=t.get(c,u),h=[t.get(c+1,u),o.get(c+1,u)],p=h[0],d=h[1],m=[t.get(c,u+1),o.get(c,u+1)],g=m[0],v=m[1],E=[t.get(c+1,u+1),o.get(c+1,u+1)],T=E[0],b=E[1];if(l)if(l!==p&&d===v)o.set(c,u,++s),a.set(s,y(n.AbsoluteCellRange.fromCoordinates(e,c,u,c,u),!0,[(0,i.simpleCellAddress)(e,c,u)])),a.has(d)&&(a.get(d).isMatrix=!1);else if(l!==T)if(p===l&&p===g)a.has(d)&&(a.get(d).isMatrix=!1),a.has(v)&&(a.get(v).isMatrix=!1),o.set(c,u,++s),a.set(s,y(n.AbsoluteCellRange.fromCoordinates(e,c,u,c,u),!0,[(0,i.simpleCellAddress)(e,c,u)]));else if(p!==l&&g===l)if(a.has(v)&&a.get(v).isMatrix){o.set(c,u,v);var x=a.get(v);x.cells.push((0,i.simpleCellAddress)(e,c,u)),a.set(v,y(x.range.withStart((0,i.simpleCellAddress)(e,c,u)),!0,x.cells))}else o.set(c,u,++s),a.set(s,y(n.AbsoluteCellRange.fromCoordinates(e,c,u,c,u),!0,[(0,i.simpleCellAddress)(e,c,u)]));else if(p===l&&g!==l){o.set(c,u,d);var A=a.get(d);A.cells.push((0,i.simpleCellAddress)(e,c,u)),a.set(d,y(A.range.withStart((0,i.simpleCellAddress)(e,c,u)),!0,A.cells))}else o.set(c,u,++s),a.set(s,y(n.AbsoluteCellRange.fromCoordinates(e,c,u,c,u),!0,[(0,i.simpleCellAddress)(e,c,u)]));else if(l===T&&b===d&&b===v){o.set(c,u,d);var S=a.get(d);S.cells.push((0,i.simpleCellAddress)(e,c,u)),a.set(d,y(S.range.withStart((0,i.simpleCellAddress)(e,c,u)),!0,S.cells))}else l===T&&(o.set(c,u,++s),a.set(s,y(n.AbsoluteCellRange.fromCoordinates(e,c,u,c,u),!0,[(0,i.simpleCellAddress)(e,c,u)])));else o.set(c,u,0),d===v&&a.has(d)&&(a.get(d).isMatrix=!1)}return a.values()}function y(e,t,r){return{isMatrix:t,range:e,cells:r}}t.GraphBuilderMatrixHeuristic=d},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(201),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.AddRowsTransformer=void 0;var n=r(106);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var i=c(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(c,e);var t,r,i,u=s(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=u.call(this)).rowsSpan=e,t}return t=c,(r=[{key:"isIrreversible",value:function(){return!1}},{key:"transformColumnRangeAst",value:function(e,t){return e}},{key:"transformCellRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformRowRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformColumnRange",value:function(e,t,r){throw Error("Not implemented")}},{key:"transformCellAddress",value:function(e,t){var r=(0,n.absoluteSheetReference)(e,t);if(r!==this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet)return!1;var i=e.toSimpleRowAddress(t);return r===this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet?this.rowsSpan.rowStart<=i.row&&e.shiftedByRows(this.rowsSpan.numberOfRows):t.sheet===this.rowsSpan.sheet&&r!==this.rowsSpan.sheet?!e.isRowAbsolute()&&!(t.row<this.rowsSpan.rowStart)&&e.shiftedByRows(-this.rowsSpan.numberOfRows):e.isRowAbsolute()?!(e.row<this.rowsSpan.rowStart)&&e.shiftedByRows(this.rowsSpan.numberOfRows):i.row<this.rowsSpan.rowStart?!(t.row<this.rowsSpan.rowStart)&&e.shiftedByRows(-this.rowsSpan.numberOfRows):t.row<this.rowsSpan.rowStart&&e.shiftedByRows(this.rowsSpan.numberOfRows)}},{key:"fixNodeAddress",value:function(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row+this.rowsSpan.numberOfRows}):e}},{key:"transformRange",value:function(e,t,r){var i=this.transformCellAddress(e,r),a=this.transformCellAddress(t,r);return i===n.ErrorType.REF||a===n.ErrorType.REF?n.ErrorType.REF:!(!i&&!a)&&[i||e,a||t]}},{key:"sheet",get:function(){return this.rowsSpan.sheet}}])&&a(t.prototype,r),i&&a(t,i),c}(r(271).Transformer);t.AddRowsTransformer=l},function(e,t,r){"use strict";r(1),r(63),r(64),r(65),r(75),r(113),r(84),r(89),r(201),r(92),r(96),r(98),r(104),t.__esModule=!0,t.Transformer=void 0;var n=r(106),i=r(138);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,s;return t=e,(r=[{key:"performEagerTransformations",value:function(e,t){var r,n=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=o(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}(e.matrixFormulaNodes());try{for(n.s();!(r=n.n()).done;){var i=r.value,s=a(this.transformSingleAst(i.getFormula(),i.getAddress()),2),u=s[0],c=s[1],l=t.rememberNewAst(u);i.setFormula(l),i.setAddress(c)}}catch(e){n.e(e)}finally{n.f()}}},{key:"transformSingleAst",value:function(e,t){return[this.transformAst(e,t),this.fixNodeAddress(t)]}},{key:"transformAst",value:function(e,t){var r=this;switch(e.type){case i.AstNodeType.CELL_REFERENCE:return this.transformCellReferenceAst(e,t);case i.AstNodeType.CELL_RANGE:return this.transformCellRangeAst(e,t);case i.AstNodeType.COLUMN_RANGE:return this.transformColumnRangeAst(e,t);case i.AstNodeType.ROW_RANGE:return this.transformRowRangeAst(e,t);case i.AstNodeType.EMPTY:case i.AstNodeType.ERROR:case i.AstNodeType.NUMBER:case i.AstNodeType.NAMED_EXPRESSION:case i.AstNodeType.ERROR_WITH_RAW_INPUT:case i.AstNodeType.STRING:return e;case i.AstNodeType.PERCENT_OP:case i.AstNodeType.MINUS_UNARY_OP:case i.AstNodeType.PLUS_UNARY_OP:return Object.assign(Object.assign({},e),{type:e.type,value:this.transformAst(e.value,t)});case i.AstNodeType.FUNCTION_CALL:return Object.assign(Object.assign({},e),{type:e.type,procedureName:e.procedureName,args:e.args.map((function(e){return r.transformAst(e,t)}))});case i.AstNodeType.PARENTHESIS:return Object.assign(Object.assign({},e),{type:e.type,expression:this.transformAst(e.expression,t)});default:return Object.assign(Object.assign({},e),{type:e.type,left:this.transformAst(e.left,t),right:this.transformAst(e.right,t)})}}},{key:"transformCellReferenceAst",value:function(e,t){var r=this.transformCellAddress(e.reference,t);return r instanceof i.CellAddress?Object.assign(Object.assign({},e),{reference:r}):r===n.ErrorType.REF?(0,i.buildCellErrorAst)(new n.CellError(n.ErrorType.REF)):e}},{key:"transformCellRangeAst",value:function(e,t){var r=this.transformCellRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===n.ErrorType.REF?(0,i.buildCellErrorAst)(new n.CellError(n.ErrorType.REF)):e}},{key:"transformColumnRangeAst",value:function(e,t){var r=this.transformColumnRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===n.ErrorType.REF?(0,i.buildCellErrorAst)(new n.CellError(n.ErrorType.REF)):e}},{key:"transformRowRangeAst",value:function(e,t){var r=this.transformRowRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===n.ErrorType.REF?(0,i.buildCellErrorAst)(new n.CellError(n.ErrorType.REF)):e}}])&&u(t.prototype,r),s&&u(t,s),e}();t.Transformer=c},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(201),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.RemoveRowsTransformer=void 0;var n=r(106);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var i=c(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(c,e);var t,r,i,u=s(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=u.call(this)).rowsSpan=e,t}return t=c,(r=[{key:"isIrreversible",value:function(){return!0}},{key:"transformColumnRangeAst",value:function(e,t){return e}},{key:"transformCellAddress",value:function(e,t){var r=(0,n.absoluteSheetReference)(e,t);if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet!==r)return!1;if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet===r){var i=e.toSimpleRowAddress(t);if(i.row<this.rowsSpan.rowStart)return!1;if(i.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet!==r){if(e.isRowAbsolute())return!1;if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet===r)if(e.isRowAbsolute()){if(e.row<this.rowsSpan.rowStart)return!1;if(e.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}else{var a=e.toSimpleRowAddress(t);if(a.row<this.rowsSpan.rowStart){if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}else if(a.row>this.rowsSpan.rowEnd){if(t.row<this.rowsSpan.rowStart)return e.shiftedByRows(-this.rowsSpan.numberOfRows);if(t.row>this.rowsSpan.rowEnd)return!1}}return n.ErrorType.REF}},{key:"transformCellRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformRowRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformColumnRange",value:function(e,t,r){throw Error("Not implemented")}},{key:"fixNodeAddress",value:function(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row-this.rowsSpan.numberOfRows}):e}},{key:"transformRange",value:function(e,t,r){var i=(0,n.absoluteSheetReference)(e,r),a=e,o=t;if(this.rowsSpan.sheet===i){var s=e.toSimpleRowAddress(r),u=t.toSimpleRowAddress(r);if(this.rowsSpan.rowStart<=s.row&&this.rowsSpan.rowEnd>=u.row)return n.ErrorType.REF;s.row>=this.rowsSpan.rowStart&&s.row<=this.rowsSpan.rowEnd&&(a=e.shiftedByRows(this.rowsSpan.rowEnd-s.row+1)),u.row>=this.rowsSpan.rowStart&&u.row<=this.rowsSpan.rowEnd&&(o=t.shiftedByRows(-(u.row-this.rowsSpan.rowStart+1)))}var c=this.transformCellAddress(a,r),l=this.transformCellAddress(o,r);if(!1===c&&!1===l)return[a,o];if(c===n.ErrorType.REF||l===n.ErrorType.REF)throw Error("Cannot happen");return[c||a,l||o]}},{key:"sheet",get:function(){return this.rowsSpan.sheet}}])&&a(t.prototype,r),i&&a(t,i),c}(r(271).Transformer);t.RemoveRowsTransformer=l},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(201),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.AddColumnsTransformer=void 0;var n=r(106);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var i=c(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(c,e);var t,r,i,u=s(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=u.call(this)).columnsSpan=e,t}return t=c,(r=[{key:"isIrreversible",value:function(){return!1}},{key:"transformRowRangeAst",value:function(e,t){return e}},{key:"transformCellRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformRowRange",value:function(e,t,r){throw Error("Not implemented")}},{key:"transformColumnRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformCellAddress",value:function(e,t){var r=(0,n.absoluteSheetReference)(e,t);if(r!==this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return!1;var i=e.toSimpleColumnAddress(t);return r===this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet?this.columnsSpan.columnStart<=i.col&&e.shiftedByColumns(this.columnsSpan.numberOfColumns):t.sheet===this.columnsSpan.sheet&&r!==this.columnsSpan.sheet?!e.isColumnAbsolute()&&!(t.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(-this.columnsSpan.numberOfColumns):e.isColumnAbsolute()?!(e.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(this.columnsSpan.numberOfColumns):e.toSimpleColumnAddress(t).col<this.columnsSpan.columnStart?!(t.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(-this.columnsSpan.numberOfColumns):t.col<this.columnsSpan.columnStart&&e.shiftedByColumns(this.columnsSpan.numberOfColumns)}},{key:"fixNodeAddress",value:function(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col+this.columnsSpan.numberOfColumns}):e}},{key:"transformRange",value:function(e,t,r){var i=this.transformCellAddress(e,r),a=this.transformCellAddress(t,r);return i===n.ErrorType.REF||a===n.ErrorType.REF?n.ErrorType.REF:!(!i&&!a)&&[i||e,a||t]}},{key:"sheet",get:function(){return this.columnsSpan.sheet}}])&&a(t.prototype,r),i&&a(t,i),c}(r(271).Transformer);t.AddColumnsTransformer=l},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.MoveCellsTransformer=void 0;var n=r(271),i=r(138),a=r(106),o=r(198);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),e}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m(e);if(t){var i=m(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d(this,r)}}function d(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=function(e){h(r,e);var t=f(r);function r(e,n,i,a){var o;return u(this,r),(o=t.call(this)).sourceRange=e,o.toRight=n,o.toBottom=i,o.toSheet=a,o.dependentFormulaTransformer=new g(e,n,i,a),o}return l(r,[{key:"isIrreversible",value:function(){return!0}},{key:"transformSingleAst",value:function(e,t){return this.sourceRange.addressInRange(t)?[this.transformAst(e,t),this.fixNodeAddress(t)]:this.dependentFormulaTransformer.transformSingleAst(e,t)}},{key:"fixNodeAddress",value:function(e){return(0,a.simpleCellAddress)(this.toSheet,e.col+this.toRight,e.row+this.toBottom)}},{key:"transformCellAddress",value:function(e,t){return this.transformAddress(e,t)}},{key:"transformCellRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformColumnRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformRowRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformAddress",value:function(e,t){var r=this.sourceRange;if(e instanceof i.CellAddress){var n=e.toSimpleCellAddress(t);if(r.addressInRange(n))return e.shiftAbsoluteDimensions(this.toRight,this.toBottom)}return e.shiftRelativeDimensions(-this.toRight,-this.toBottom)}},{key:"transformRange",value:function(e,t,r){var n=this.sourceRange;if(e instanceof i.CellAddress&&t instanceof i.CellAddress){var a=e.toSimpleCellAddress(r),o=t.toSimpleCellAddress(r);if(n.addressInRange(a)&&n.addressInRange(o))return[e.shiftAbsoluteDimensions(this.toRight,this.toBottom),t.shiftAbsoluteDimensions(this.toRight,this.toBottom)]}return[e.shiftRelativeDimensions(-this.toRight,-this.toBottom),t.shiftRelativeDimensions(-this.toRight,-this.toBottom)]}},{key:"sheet",get:function(){return this.sourceRange.sheet}}]),r}(n.Transformer);t.MoveCellsTransformer=y;var g=function(e){h(r,e);var t=f(r);function r(e,n,i,a){var o;return u(this,r),(o=t.call(this)).sourceRange=e,o.toRight=n,o.toBottom=i,o.toSheet=a,o}return l(r,[{key:"isIrreversible",value:function(){return!0}},{key:"fixNodeAddress",value:function(e){return e}},{key:"transformCellAddress",value:function(e,t){return!!this.shouldMove(e,t)&&e.moved(this.toSheet,this.toRight,this.toBottom)}},{key:"shouldMove",value:function(e,t){return e instanceof i.CellAddress?this.sourceRange.addressInRange(e.toSimpleCellAddress(t)):e instanceof o.RowAddress?this.sourceRange.rowInRange(e.toSimpleRowAddress(t))&&!this.sourceRange.isFinite():this.sourceRange.columnInRange(e.toSimpleColumnAddress(t))&&!this.sourceRange.isFinite()}},{key:"transformCellRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformColumnRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformRowRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformRange",value:function(e,t,r){var n=this.transformCellAddress(e,r),i=this.transformCellAddress(t,r);return!(!n||!i)&&[n,i]}},{key:"sheet",get:function(){return this.sourceRange.sheet}}]),r}(n.Transformer)},function(e,t,r){"use strict";r(1),r(63),r(64),r(65),r(75),r(84),r(89),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.RemoveSheetTransformer=void 0;var n=r(271),i=r(106);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f(e);if(t){var i=f(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(u,e);var t,r,n,a=h(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=a.call(this)).sheet=e,t}return t=u,(r=[{key:"isIrreversible",value:function(){return!0}},{key:"performEagerTransformations",value:function(e,t){var r,n=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=s(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw a}}}}(e.matrixFormulaNodes());try{for(n.s();!(r=n.n()).done;){var i=r.value,a=o(this.transformSingleAst(i.getFormula(),i.getAddress()),1)[0];i.setFormula(a)}}catch(e){n.e(e)}finally{n.f()}}},{key:"fixNodeAddress",value:function(e){return e}},{key:"transformCellAddress",value:function(e,t){return this.transformAddress(e)}},{key:"transformCellRange",value:function(e,t,r){return this.transformAddress(e)}},{key:"transformColumnRange",value:function(e,t,r){return this.transformAddress(e)}},{key:"transformRowRange",value:function(e,t,r){return this.transformAddress(e)}},{key:"transformAddress",value:function(e){return e.sheet===this.sheet&&i.ErrorType.REF}}])&&c(t.prototype,r),n&&c(t,n),u}(n.Transformer);t.RemoveSheetTransformer=d},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(201),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.RemoveColumnsTransformer=void 0;var n=r(106);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var i=c(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(c,e);var t,r,i,u=s(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=u.call(this)).columnsSpan=e,t}return t=c,(r=[{key:"isIrreversible",value:function(){return!0}},{key:"transformRowRangeAst",value:function(e,t){return e}},{key:"transformCellRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformRowRange",value:function(e,t,r){throw Error("Not implemented")}},{key:"transformColumnRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformCellAddress",value:function(e,t){var r=(0,n.absoluteSheetReference)(e,t);if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet!==r)return!1;if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet===r){var i=e.toSimpleColumnAddress(t);if(i.col<this.columnsSpan.columnStart)return!1;if(i.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet!==r){if(e.isColumnAbsolute())return!1;if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet===r)if(e.isColumnAbsolute()){if(e.col<this.columnsSpan.columnStart)return!1;if(e.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else{var a=e.toSimpleColumnAddress(t);if(a.col<this.columnsSpan.columnStart){if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}else if(a.col>this.columnsSpan.columnEnd){if(t.col<this.columnsSpan.columnStart)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(t.col>this.columnsSpan.columnEnd)return!1}}return n.ErrorType.REF}},{key:"fixNodeAddress",value:function(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col-this.columnsSpan.numberOfColumns}):e}},{key:"transformRange",value:function(e,t,r){var i=(0,n.absoluteSheetReference)(e,r),a=e,o=t;if(this.columnsSpan.sheet===i){var s=e.toSimpleColumnAddress(r),u=t.toSimpleColumnAddress(r);if(this.columnsSpan.columnStart<=s.col&&this.columnsSpan.columnEnd>=u.col)return n.ErrorType.REF;s.col>=this.columnsSpan.columnStart&&s.col<=this.columnsSpan.columnEnd&&(a=e.shiftedByColumns(this.columnsSpan.columnEnd-s.col+1)),u.col>=this.columnsSpan.columnStart&&u.col<=this.columnsSpan.columnEnd&&(o=t.shiftedByColumns(-(u.col-this.columnsSpan.columnStart+1)))}var c=this.transformCellAddress(a,r),l=this.transformCellAddress(o,r);if(!1===c&&!1===l)return[a,o];if(c===n.ErrorType.REF||l===n.ErrorType.REF)throw Error("Cannot happen");return[c||a,l||o]}},{key:"sheet",get:function(){return this.columnsSpan.sheet}}])&&a(t.prototype,r),i&&a(t,i),c}(r(271).Transformer);t.RemoveColumnsTransformer=l},function(e,t,r){"use strict";t.__esModule=!0,t.validateAsSheet=
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */
function(e){if(!Array.isArray(e))throw new n.InvalidArgumentsError("an array of arrays.");for(var t=0;t<e.length;t++)if(!Array.isArray(e[t]))throw new n.InvalidArgumentsError("an array of arrays.")},t.findBoundaries=function(e){for(var t=0,r=0,n=0,i=0;i<e.length;i++){for(var a=0,o=0;o<e[i].length;o++){var s=e[i][o];null!=s&&(a=o+1,++n)}t=Math.max(t,a),a>0&&(r=i+1)}var u=t*r;return{height:r,width:t,fill:0===u?0:n/u}};var n=r(226)},function(e,t,r){"use strict";r(1),r(63),r(64),r(109),r(75),r(211),r(91),r(92),r(94),r(212),r(96),r(98),r(104),t.__esModule=!0,t.Emitter=t.Events=void 0;var n,i=r(279);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,r){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var i=p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}t.Events=n,function(e){e.SheetAdded="sheetAdded",e.SheetRemoved="sheetRemoved",e.SheetRenamed="sheetRenamed",e.NamedExpressionAdded="namedExpressionAdded",e.NamedExpressionRemoved="namedExpressionRemoved",e.ValuesUpdated="valuesUpdated"}(n||(t.Events=n={}));var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(a,e);var t,r,n,i=l(a);function a(){return o(this,a),i.apply(this,arguments)}return t=a,(r=[{key:"emit",value:function(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return(t=u(p(a.prototype),"emit",this)).call.apply(t,[this,e].concat(n)),this}}])&&s(t.prototype,r),n&&s(t,n),a}(i.TinyEmitter);t.Emitter=f},function(e,t){function r(){}r.prototype={on:function(e,t,r){var n=this.e||(this.e={});return(n[e]||(n[e]=[])).push({fn:t,ctx:r}),this},once:function(e,t,r){var n=this;function i(){n.off(e,i),t.apply(r,arguments)}return i._=t,this.on(e,i,r)},emit:function(e){for(var t=[].slice.call(arguments,1),r=((this.e||(this.e={}))[e]||[]).slice(),n=0,i=r.length;n<i;n++)r[n].fn.apply(r[n].ctx,t);return this},off:function(e,t){var r=this.e||(this.e={}),n=r[e],i=[];if(n&&t)for(var a=0,o=n.length;a<o;a++)n[a].fn!==t&&n[a].fn._!==t&&i.push(n[a]);return i.length?r[e]=i:delete r[e],this}},e.exports=r,e.exports.TinyEmitter=r},function(e,t,r){"use strict";t.__esModule=!0,t.BuildEngineFactory=void 0;var n=r(253),i=r(281),a=r(257),o=r(283),s=r(289),u=r(264),c=r(307),l=r(107),h=r(309),p=r(268),f=r(241),d=r(255),m=r(316),y=r(138),g=r(317),v=r(219),E=r(226),T=r(277),b=r(313);function x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var A=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,A;return t=e,A=[{key:"buildEngine",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.useStats?new v.Statistics:new v.EmptyStatistics;r.start(v.StatType.BUILD_ENGINE_TOTAL);var s=new d.NamedExpressions,f=new b.FunctionRegistry(e),x=new i.LazilyTransformingAstService(r),A=l.DependencyGraph.buildEmpty(x,e,f,s,r),S=(0,o.buildColumnSearchStrategy)(A,e,r),R=A.sheetMapping,w=A.addressMapping;for(var C in t)if(Object.prototype.hasOwnProperty.call(t,C)){var O=t[C];(0,T.validateAsSheet)(O);var k=(0,T.findBoundaries)(O);if(k.height>e.maxRows||k.width>e.maxColumns)throw new E.SheetSizeLimitExceededError;var N=R.addSheet(C);w.autoAddSheet(N,O,k)}var _=new y.ParserWithCaching(e,f,R.get),I=new y.Unparser(e,(0,y.buildLexerConfig)(e),R.fetchDisplayName,s),M=new u.DateTimeHelper(e),P=new m.NumberLiteralHelper(e),L=new a.CellContentParser(e,M,P),F=new c.CrudOperations(e,r,A,S,_,L,x,s);r.measure(v.StatType.GRAPH_BUILD,(function(){new p.GraphBuilder(A,S,_,L,e,r).buildGraph(t)})),x.undoRedo=F.undoRedo,x.parser=_;var D=new n.Exporter(e,s,R.fetchDisplayName),U=new g.Serialization(A,I,e,D),V=new h.Evaluator(A,S,e,r,M,P,f,s,U);return V.run(),r.end(v.StatType.BUILD_ENGINE_TOTAL),{config:e,stats:r,dependencyGraph:A,columnSearch:S,parser:_,unparser:I,cellContentParser:L,evaluator:V,lazilyTransformingAstService:x,crudOperations:F,exporter:D,namedExpressions:s,serialization:U,functionRegistry:f}}},{key:"buildFromSheets",value:function(e,t){var r=new s.Config(t);return this.buildEngine(r,e)}},{key:"buildFromSheet",value:function(e,t){var r,n,i,a=new s.Config(t),o=a.translationPackage.getUITranslation(f.UIElement.NEW_SHEET_PREFIX)+"1";return this.buildEngine(a,(i=e,(n=o)in(r={})?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,r))}},{key:"buildEmpty",value:function(e){return this.buildEngine(new s.Config(e))}},{key:"rebuildWithConfig",value:function(e,t,r){return this.buildEngine(e,t,r)}}],(r=null)&&x(t.prototype,r),A&&x(t,A),e}();t.BuildEngineFactory=A},function(e,t,r){"use strict";r(1),r(63),r(64),r(65),r(75),r(84),r(89),r(92),r(96),r(98),r(104),t.__esModule=!0,t.LazilyTransformingAstService=void 0,r(125);var n=r(219),i=r(282);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.stats=t,this.transformations=[]}var t,r,o;return t=e,(r=[{key:"version",value:function(){return this.transformations.length}},{key:"addTransformation",value:function(e){return void 0!==this.combinedTransformer?this.combinedTransformer.add(e):this.transformations.push(e),this.version()}},{key:"beginCombinedMode",value:function(e){this.combinedTransformer=new i.CombinedTransformer(e)}},{key:"commitCombinedMode",value:function(){if(void 0===this.combinedTransformer)throw"Combined mode wasn't started";return this.transformations.push(this.combinedTransformer),this.combinedTransformer=void 0,this.version()}},{key:"applyTransformations",value:function(e,t,r){this.stats.start(n.StatType.TRANSFORM_ASTS_POSTPONED);for(var i=r;i<this.transformations.length;i++){var o=this.transformations[i];o.isIrreversible()&&(this.undoRedo.storeDataForVersion(i,t,this.parser.computeHashFromAst(e)),this.parser.rememberNewAst(e));var s=a(o.transformSingleAst(e,t),2);e=s[0],t=s[1]}var u=this.parser.rememberNewAst(e);return this.stats.end(n.StatType.TRANSFORM_ASTS_POSTPONED),[u,t,this.transformations.length]}},{key:"getTransformationsFrom",value:regeneratorRuntime.mark((function e(t,r){var n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t;case 1:if(!(n<this.transformations.length)){e.next=9;break}if(i=this.transformations[n],r&&!r(i)){e.next=6;break}return e.next=6,i;case 6:n++,e.next=1;break;case 9:case"end":return e.stop()}}),e,this)}))},{key:"destroy",value:function(){this.parser=void 0,this.transformations=[]}}])&&s(t.prototype,r),o&&s(t,o),e}();t.LazilyTransformingAstService=u},function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r(1),r(63),r(64),r(110),r(65),r(75),r(84),r(89),r(92),r(96),r(98),r(124),r(104),t.__esModule=!0,t.CombinedTransformer=void 0;
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */
var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sheet=t,this.transformations=[]}var t,r,i;return t=e,(r=[{key:"add",value:function(e){this.transformations.push(e)}},{key:"performEagerTransformations",value:function(e,t){this.transformations.forEach((function(r){return r.performEagerTransformations(e,t)}))}},{key:"transformSingleAst",value:function(e,t){var r=e,i=t;return this.transformations.forEach((function(e){var t=n(e.transformSingleAst(r,i),2);r=t[0],i=t[1]})),[r,i]}},{key:"isIrreversible",value:function(){return!0}}])&&a(t.prototype,r),i&&a(t,i),e}();t.CombinedTransformer=o},function(e,t,r){"use strict";t.__esModule=!0,t.buildColumnSearchStrategy=
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */
function(e,t,r){return t.useColumnIndex?new i.ColumnIndex(e,t,r):new n.ColumnBinarySearch(e,t)};var n=r(284),i=r(287)},function(e,t,r){"use strict";r(1),r(63),r(64),r(227),r(75),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.ColumnBinarySearch=void 0;var n=r(285);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var i=c(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(c,e);var t,r,i,u=s(c);function c(e,t){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(r=u.call(this,e)).dependencyGraph=e,r.config=t,r}return t=c,(r=[{key:"add",value:function(e,t){}},{key:"remove",value:function(e,t){}},{key:"change",value:function(e,t,r){}},{key:"addColumns",value:function(e){}},{key:"removeColumns",value:function(e){}},{key:"removeSheet",value:function(e){}},{key:"moveValues",value:function(e,t,r,n){}},{key:"removeValues",value:function(e){}},{key:"destroy",value:function(){}},{key:"find",value:function(e,t,r){if(t.height()<this.config.binarySearchThreshold||!r){var i=this.dependencyGraph.computeListOfValuesInRange(t).indexOf(e);return i<0?i:i+t.start.row}return(0,n.rangeLowerBound)(t,e,this.dependencyGraph,"row")}}])&&a(t.prototype,r),i&&a(t,i),c}(r(286).AdvancedFind);t.ColumnBinarySearch=l},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(92),r(98),r(104),t.__esModule=!0,t.rangeLowerBound=function(e,t,r,i){var o=e.start[i],s=e.end[i];return a("row"===i?function(t){return r.getCellValue((0,n.simpleCellAddress)(e.sheet,e.start.col,t))}:function(t){return r.getCellValue((0,n.simpleCellAddress)(e.sheet,t,e.start.row))},t,o,s)},t.lowerBound=a,t.compare=o;var n=r(106);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t,r,n){for(;r<=n;){var i=Math.floor((r+n)/2),a=o(t,e(i));if(a>0)r=i+1;else if(a<0)n=i-1;else{if(r==i)return i;n=i}}return n}function o(e,t){return i(e)===i(t)?e<t?-1:e>t?1:0:"number"==typeof e&&"string"==typeof t||"number"==typeof e&&"boolean"==typeof t?-1:"string"==typeof e&&"number"==typeof t?1:"string"==typeof e&&"boolean"==typeof t?-1:1}},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}t.__esModule=!0,t.AdvancedFind=void 0;
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */
var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dependencyGraph=t}var t,r,i;return t=e,(r=[{key:"advancedFind",value:function(e,t){for(var r=this.dependencyGraph.computeListOfValuesInRange(t),n=0;n<r.length;n++)if(e(r[n]))return n+t.start.col;return-1}}])&&n(t.prototype,r),i&&n(t,i),e}();t.AdvancedFind=i},function(e,t,r){"use strict";r(1),r(63),r(64),r(109),r(288),r(65),r(75),r(84),r(233),r(89),r(207),r(92),r(96),r(98),r(104),t.__esModule=!0,t.upperBound=g,t.lowerBound=v,t.ColumnIndex=void 0;var n=r(106),i=r(232),a=r(219),o=r(284),s=r(270),u=r(272),c=r(246);function l(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||f(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||f(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=f(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function f(e,t){if(e){if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var y=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dependencyGraph=t,this.config=r,this.stats=n,this.index=new Map,this.transformingService=this.dependencyGraph.lazilyTransformingAstService,this.binarySearchStrategy=new o.ColumnBinarySearch(t,r)}var t,r,f;return t=e,(r=[{key:"add",value:function(e,t){if(e instanceof i.Matrix){var r,a=p(e.generateValues(t));try{for(a.s();!(r=a.n()).done;){var o=h(r.value,2),s=o[0],u=o[1];this.addSingleCellValue(s,u)}}catch(e){a.e(e)}finally{a.f()}}else e instanceof n.CellError||e instanceof c.SimpleRangeValue||this.addSingleCellValue(e,t)}},{key:"remove",value:function(e,t){if(e)if(e instanceof i.Matrix){var r,n=p(e.generateValues(t));try{for(n.s();!(r=n.n()).done;){var a=h(r.value,2),o=a[0],s=a[1];this.removeSingleValue(o,s)}}catch(e){n.e(e)}finally{n.f()}}else this.removeSingleValue(e,t)}},{key:"change",value:function(e,t,r){e!==t&&(this.remove(e,r),this.add(t,r))}},{key:"moveValues",value:function(e,t,r,i){var a,o=p(e);try{for(o.s();!(a=o.n()).done;){var s=h(a.value,2),u=s[0],c=s[1],l=(0,n.movedSimpleCellAddress)(c,i,t,r);this.remove(u,c),this.add(u,l)}}catch(e){o.e(e)}finally{o.f()}}},{key:"removeValues",value:function(e){var t,r=p(e);try{for(r.s();!(t=r.n()).done;){var n=h(t.value,2),i=n[0],a=n[1];this.remove(i,a)}}catch(e){r.e(e)}finally{r.f()}}},{key:"find",value:function(e,t,r){this.ensureRecentData(t.sheet,t.start.col,e);var n=this.getColumnMap(t.sheet,t.start.col);if(!n)return-1;var i=n.get(e);if(!i)return this.binarySearchStrategy.find(e,t,r);var a=g(i.index,t.start.row),o=i.index[a];return o<=t.end.row?o:this.binarySearchStrategy.find(e,t,r)}},{key:"advancedFind",value:function(e,t){return this.binarySearchStrategy.advancedFind(e,t)}},{key:"addColumns",value:function(e){var t=this.index.get(e.sheet);t&&t.splice.apply(t,[e.columnStart,0].concat(l(Array(e.numberOfColumns))))}},{key:"removeColumns",value:function(e){var t=this.index.get(e.sheet);t&&t.splice(e.columnStart,e.numberOfColumns)}},{key:"removeSheet",value:function(e){this.index.delete(e)}},{key:"getColumnMap",value:function(e,t){this.index.has(e)||this.index.set(e,[]);var r=this.index.get(e),n=r[t];return n||(n=new Map,r[t]=n),n}},{key:"getValueIndex",value:function(e,t,r){var n=this.getColumnMap(e,t),i=this.getColumnMap(e,t).get(r);return i||(i={version:this.transformingService.version(),index:[]},n.set(r,i)),i}},{key:"ensureRecentData",value:function(e,t,r){var n=this.getValueIndex(e,t,r),i=this.transformingService.version();if(n.version!==i){var a,o=p(this.transformingService.getTransformationsFrom(n.version,(function(t){return t.sheet===e&&(t instanceof s.AddRowsTransformer||t instanceof u.RemoveRowsTransformer)})));try{for(o.s();!(a=o.n()).done;){var c=a.value;c instanceof s.AddRowsTransformer?this.addRows(t,c.rowsSpan,r):c instanceof u.RemoveRowsTransformer&&this.removeRows(t,c.rowsSpan,r)}}catch(e){o.e(e)}finally{o.f()}n.version=i}}},{key:"destroy",value:function(){this.index.clear()}},{key:"addSingleCellValue",value:function(e,t){var r=this;this.stats.measure(a.StatType.BUILD_COLUMN_INDEX,(function(){r.ensureRecentData(t.sheet,t.col,e);var n=r.getValueIndex(t.sheet,t.col,e);r.addValue(n,t.row)}))}},{key:"removeSingleValue",value:function(e,t){var r=this;this.stats.measure(a.StatType.BUILD_COLUMN_INDEX,(function(){r.ensureRecentData(t.sheet,t.col,e);var n=r.getColumnMap(t.sheet,t.col),i=n.get(e);if(i){var a=g(i.index,t.row);i.index.splice(a,1),0===i.index.length&&n.delete(e),0===n.size&&delete r.index.get(t.sheet)[t.col]}}))}},{key:"addRows",value:function(e,t,r){var n=this.getValueIndex(t.sheet,e,r);this.shiftRows(n,t.rowStart,t.numberOfRows)}},{key:"removeRows",value:function(e,t,r){var n=this.getValueIndex(t.sheet,e,r);this.removeRowsFromValues(n,t),this.shiftRows(n,t.rowEnd+1,-t.numberOfRows)}},{key:"addValue",value:function(e,t){var r=v(e.index,t);e.index[r]!==t&&(r===e.index.length-1?e.index.push(t):e.index.splice(r+1,0,t))}},{key:"removeRowsFromValues",value:function(e,t){var r=g(e.index,t.rowStart),n=v(e.index,t.rowEnd);e.index[r]<=t.rowEnd&&e.index.splice(r,n-r+1)}},{key:"shiftRows",value:function(e,t,r){for(var n=g(e.index,t);n<e.index.length;++n)e.index[n]+=r}}])&&m(t.prototype,r),f&&m(t,f),e}();function g(e,t){for(var r=0,n=e.length-1;r<=n;){var i=Math.floor((r+n)/2);if(t>e[i])r=i+1;else{if(!(t<e[i]))return i;n=i-1}}return r}function v(e,t){for(var r=0,n=e.length-1;r<=n;){var i=Math.floor((r+n)/2);if(t>e[i])r=i+1;else{if(!(t<e[i]))return i;n=i-1}}return n}t.ColumnIndex=y},function(e,t,r){"use strict";var n=r(2),i=r(59).find,a=r(76),o=r(88),s=!0,u=o("find");"find"in[]&&Array(1).find((function(){s=!1})),n({target:"Array",proto:!0,forced:s||!u},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),a("find")},function(e,t,r){"use strict";r(1),r(63),r(64),r(109),r(110),r(65),r(262),r(75),r(200),r(113),r(84),r(239),r(89),r(207),r(201),r(92),r(96),r(290),r(98),r(291),r(124),r(104),t.__esModule=!0,t.Config=void 0;var n=r(293),i=r(264),a=r(226),o=r(294),s=r(295),u=r(256),c=r(301);function l(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return h(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */
var m,y=function(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r},g=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},v=["gpu","cpu","dev"],E=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.accentSensitive,n=t.caseSensitive,a=t.caseFirst,o=t.chooseAddressMappingPolicy,s=t.dateFormats,l=t.timeFormats,h=t.functionArgSeparator,p=t.decimalSeparator,d=t.thousandSeparator,g=t.language,E=t.licenseKey,T=t.functionPlugins,b=t.gpuMode,x=t.ignorePunctuation,A=t.leapYear1900,S=t.localeLang,R=t.smartRounding,w=t.matrixDetection,C=t.matrixDetectionThreshold,O=t.evaluateNullToZero,k=t.nullYear,N=t.parseDateTime,_=t.stringifyDateTime,I=t.stringifyDuration,M=t.precisionEpsilon,P=t.precisionRounding,L=t.useColumnIndex,F=t.vlookupThreshold,D=t.binarySearchThreshold,U=t.nullDate,V=t.useStats,j=t.undoLimit,G=t.useRegularExpressions,B=t.useWildcards,z=t.matchWholeCell,W=t.maxRows,K=t.maxColumns;f(this,e),m.set(this,void 0),this.accentSensitive=this.valueFromParam(r,"boolean","accentSensitive"),this.caseSensitive=this.valueFromParam(n,"boolean","caseSensitive"),this.caseFirst=this.valueFromParam(a,["upper","lower","false"],"caseFirst"),this.ignorePunctuation=this.valueFromParam(x,"boolean","ignorePunctuation"),this.chooseAddressMappingPolicy=null!=o?o:e.defaultConfig.chooseAddressMappingPolicy,this.dateFormats=this.valueFromParamCheck(s,Array.isArray,"array","dateFormats"),this.timeFormats=this.valueFromParamCheck(l,Array.isArray,"array","timeFormats"),this.functionArgSeparator=this.valueFromParam(h,"string","functionArgSeparator"),this.decimalSeparator=this.valueFromParam(p,[".",","],"decimalSeparator"),this.language=this.valueFromParam(g,"string","language"),this.licenseKey=this.valueFromParam(E,"string","licenseKey"),y(this,m,(0,c.checkLicenseKeyValidity)(this.licenseKey)),this.thousandSeparator=this.valueFromParam(d,["",","," ","."],"thousandSeparator"),this.localeLang=this.valueFromParam(S,"string","localeLang"),this.functionPlugins=null!=T?T:e.defaultConfig.functionPlugins,this.gpuMode=this.valueFromParam(b,v,"gpuMode"),this.smartRounding=this.valueFromParam(R,"boolean","smartRounding"),this.matrixDetection=this.valueFromParam(w,"boolean","matrixDetection"),this.matrixDetectionThreshold=this.valueFromParam(C,"number","matrixDetectionThreshold"),this.validateNumberToBeAtLeast(this.matrixDetectionThreshold,"matrixDetectionThreshold",1),this.evaluateNullToZero=this.valueFromParam(O,"boolean","evaluateNullToZero"),this.nullYear=this.valueFromParam(k,"number","nullYear"),this.validateNumberToBeAtLeast(this.nullYear,"nullYear",0),this.validateNumberToBeAtMost(this.nullYear,"nullYear",100),this.precisionRounding=this.valueFromParam(P,"number","precisionRounding"),this.validateNumberToBeAtLeast(this.precisionRounding,"precisionRounding",0),this.precisionEpsilon=this.valueFromParam(M,"number","precisionEpsilon"),this.validateNumberToBeAtLeast(this.precisionEpsilon,"precisionEpsilon",0),this.useColumnIndex=this.valueFromParam(L,"boolean","useColumnIndex"),this.useStats=this.valueFromParam(V,"boolean","useStats"),this.vlookupThreshold=this.valueFromParam(F,"number","vlookupThreshold"),this.validateNumberToBeAtLeast(this.vlookupThreshold,"vlookupThreshold",1),this.binarySearchThreshold=this.valueFromParam(null!=D?D:F,"number","vlookupThreshold"),this.validateNumberToBeAtLeast(this.binarySearchThreshold,"binarySearchThreshold",1),this.parseDateTime=this.valueFromParam(N,"function","parseDateTime"),this.stringifyDateTime=this.valueFromParam(_,"function","stringifyDateTime"),this.stringifyDuration=this.valueFromParam(I,"function","stringifyDuration"),this.translationPackage=u.HyperFormula.getLanguage(this.language),this.errorMapping=this.translationPackage.buildErrorMapping(),this.nullDate=this.valueFromParamCheck(U,i.instanceOfSimpleDate,"IDate","nullDate"),this.leapYear1900=this.valueFromParam(A,"boolean","leapYear1900"),this.undoLimit=this.valueFromParam(j,"number","undoLimit"),this.useRegularExpressions=this.valueFromParam(G,"boolean","useRegularExpressions"),this.useWildcards=this.valueFromParam(B,"boolean","useWildcards"),this.matchWholeCell=this.valueFromParam(z,"boolean","matchWholeCell"),this.validateNumberToBeAtLeast(this.undoLimit,"undoLimit",0),this.maxRows=this.valueFromParam(W,"number","maxRows"),this.validateNumberToBeAtLeast(this.maxRows,"maxRows",1),this.maxColumns=this.valueFromParam(K,"number","maxColumns"),this.validateNumberToBeAtLeast(this.maxColumns,"maxColumns",1),this.warnDeprecatedIfUsed(F,"vlookupThreshold","v.0.3.0","binarySearchThreshold"),this.checkIfParametersNotInConflict({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"})}var t,r,n;return t=e,(r=[{key:"getConfig",value:function(){return this}},{key:"mergeConfig",value:function(t){return new e(Object.assign({},this.getConfig(),t))}},{key:"warnDeprecatedIfUsed",value:function(e,t,r,n){void 0!==e&&console.warn("".concat(t," option is deprecated since ").concat(r,", please use ").concat(n))}},{key:"valueFromParam",value:function(t,r,n){if(void 0===t)return e.defaultConfig[n];if("string"==typeof r){if(p(t)===r)return t;throw new a.ExpectedValueOfTypeError(r,n)}if(r.includes(t))return t;throw new a.ExpectedOneOfValuesError(r.map((function(e){return"'"+e+"'"})).join(" "),n)}},{key:"valueFromParamCheck",value:function(t,r,n,i){if(r(t))return t;if(void 0===t)return e.defaultConfig[i];throw new a.ExpectedValueOfTypeError(n,i)}},{key:"checkIfParametersNotInConflict",value:function(){for(var e=new Map,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];r.forEach((function(t){var r=e.get(t.value)||[];r.push(t.name),e.set(t.value,r)}));var i,a=[],o=l(e.values());try{for(o.s();!(i=o.n()).done;){var s=i.value;s.length>1&&a.push(s)}}catch(e){o.e(e)}finally{o.f()}if(a.length>0){var u=a.map((function(e){return"[".concat(e.sort(),"]")})).join("; ");throw new Error("Config initialization failed. Parameters in conflict: ".concat(u))}}},{key:"validateNumberToBeAtLeast",value:function(e,t,r){if(e<r)throw new a.ConfigValueTooSmallError(t,r)}},{key:"validateNumberToBeAtMost",value:function(e,t,r){if(e>r)throw new a.ConfigValueTooBigError(t,r)}},{key:"licenseKeyValidityState",get:function(){return g(this,m)}}])&&d(t.prototype,r),n&&d(t,n),e}();t.Config=E,m=new WeakMap,E.defaultConfig={accentSensitive:!1,caseSensitive:!1,caseFirst:"lower",ignorePunctuation:!1,chooseAddressMappingPolicy:new o.AlwaysDense,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],functionArgSeparator:",",decimalSeparator:".",thousandSeparator:"",language:"enGB",licenseKey:"",functionPlugins:[],gpuMode:"gpu",leapYear1900:!1,smartRounding:!0,localeLang:"en",matrixDetection:!0,matrixDetectionThreshold:100,evaluateNullToZero:!1,nullYear:30,parseDateTime:n.defaultParseToDateTime,stringifyDateTime:s.defaultStringifyDateTime,stringifyDuration:s.defaultStringifyDuration,precisionEpsilon:1e-13,precisionRounding:14,useColumnIndex:!1,useStats:!1,vlookupThreshold:20,binarySearchThreshold:20,nullDate:{year:1899,month:12,day:30},undoLimit:20,useRegularExpressions:!1,useWildcards:!0,matchWholeCell:!0,maxRows:4e4,maxColumns:18278}},function(e,t,r){"use strict";var n=r(2),i=r(101),a=r(13);n({target:"String",proto:!0,forced:!r(103)("includes")},{includes:function(e){return!!~String(a(this)).indexOf(i(e),arguments.length>1?arguments[1]:void 0)}})},function(e,t,r){"use strict";var n,i=r(3),a=r(122),o=r(116),s=r(115),u=r(292),c=r(15),l=r(26).enforce,h=r(27),p=!i.ActiveXObject&&"ActiveXObject"in i,f=Object.isExtensible,d=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},m=e.exports=s("WeakMap",d,u);if(h&&p){n=u.getConstructor(d,"WeakMap",!0),o.REQUIRED=!0;var y=m.prototype,g=y.delete,v=y.has,E=y.get,T=y.set;a(y,{delete:function(e){if(c(e)&&!f(e)){var t=l(this);return t.frozen||(t.frozen=new n),g.call(this,e)||t.frozen.delete(e)}return g.call(this,e)},has:function(e){if(c(e)&&!f(e)){var t=l(this);return t.frozen||(t.frozen=new n),v.call(this,e)||t.frozen.has(e)}return v.call(this,e)},get:function(e){if(c(e)&&!f(e)){var t=l(this);return t.frozen||(t.frozen=new n),v.call(this,e)?E.call(this,e):t.frozen.get(e)}return E.call(this,e)},set:function(e,t){if(c(e)&&!f(e)){var r=l(this);r.frozen||(r.frozen=new n),v.call(this,e)?T.call(this,e,t):r.frozen.set(e,t)}else T.call(this,e,t);return this}})}},function(e,t,r){"use strict";var n=r(122),i=r(116).getWeakData,a=r(21),o=r(15),s=r(119),u=r(118),c=r(59),l=r(16),h=r(26),p=h.set,f=h.getterFor,d=c.find,m=c.findIndex,y=0,g=function(e){return e.frozen||(e.frozen=new v)},v=function(){this.entries=[]},E=function(e,t){return d(e.entries,(function(e){return e[0]===t}))};v.prototype={get:function(e){var t=E(this,e);if(t)return t[1]},has:function(e){return!!E(this,e)},set:function(e,t){var r=E(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=m(this.entries,(function(t){return t[0]===e}));return~t&&this.entries.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,r,c){var h=e((function(e,n){s(e,h,t),p(e,{type:t,id:y++,frozen:void 0}),null!=n&&u(n,e[c],e,r)})),d=f(t),m=function(e,t,r){var n=d(e),o=i(a(t),!0);return!0===o?g(n).set(t,r):o[n.id]=r,e};return n(h.prototype,{delete:function(e){var t=d(this);if(!o(e))return!1;var r=i(e);return!0===r?g(t).delete(e):r&&l(r,t.id)&&delete r[t.id]},has:function(e){var t=d(this);if(!o(e))return!1;var r=i(e);return!0===r?g(t).has(e):r&&l(r,t.id)}}),n(h.prototype,r?{get:function(e){var t=d(this);if(o(e)){var r=i(e);return!0===r?g(t).get(e):r?r[t.id]:void 0}},set:function(e,t){return m(this,e,t)}}:{add:function(e){return m(this,e,!0)}}),h}}},function(e,t,r){"use strict";r(262),r(227),r(84),r(133),r(201),r(144),r(258),r(290),r(146),r(150),r(259),t.__esModule=!0,t.defaultParseToDateTime=
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */
function(e,t,r){var n=(e=e.replace(/\s\s+/g," ").trim().toLowerCase()).substring(e.length-2);"am"===n||"pm"===n?e=e.substring(0,e.length-2).trim():"a"===(n=e.substring(e.length-1))||"p"===n?e=e.substring(0,e.length-1).trim():n=void 0;var o=e.split(/[ /.-]/g);o.length>=2&&o[o.length-2].includes(":")&&(o[o.length-2]=o[o.length-2]+"."+o[o.length-1],o.pop());var s=o[o.length-1].split(":");if(void 0!==n&&s.push(n),1===o.length)return i(s,r);if(1===s.length)return a(o,t);var u=a(o.slice(0,o.length-1),t),c=i(s,r);return void 0===u||void 0===c?void 0:Object.assign(Object.assign({},u),c)},t.defaultParseToTime=i,t.defaultParseToDate=a,t.secondsExtendedRegexp=void 0;var n=/^ss\.(s+|0+)$/;function i(e,t){(t=t.toLowerCase()).endsWith("am/pm")?t=t.substring(0,t.length-5).trim():t.endsWith("a/p")&&(t=t.substring(0,t.length-3).trim());var r=t.split(":"),i=void 0;"am"===e[e.length-1]||"a"===e[e.length-1]?(i=!1,e.pop()):"pm"!==e[e.length-1]&&"p"!==e[e.length-1]||(i=!0,e.pop());var a=0;if(r.length>=1&&n.test(r[r.length-1])&&(a=r[r.length-1].length-3,r[r.length-1]="ss"),e.length===r.length){var o=r.indexOf("hh"),s=r.indexOf("mm"),u=r.indexOf("ss"),c=-1!==o?e[o]:"0";if(/^\d+$/.test(c)){var l=Number(c);if(void 0!==i){if(l<0||l>12)return;l%=12,i&&(l+=12)}var h=-1!==s?e[s]:"0";if(/^\d+$/.test(h)){var p=Number(h),f=-1!==u?e[u]:"0";if(/^\d+(\.\d+)?$/.test(f)){var d=Number(f);return{hours:l,minutes:p,seconds:d=Math.round(d*Math.pow(10,a))/Math.pow(10,a)}}}}}}function a(e,t){var r=t.toLowerCase().split(/[ /.-]/g);if(e.length===r.length){var n=r.indexOf("mm"),i=r.indexOf("dd"),a=r.indexOf("yyyy"),o=r.indexOf("yy");if(n in e&&i in e&&(a in e||o in e)&&(!(a in e)||!(o in e))){var s;if(a in e){var u=e[a];if(!/^\d+$/.test(u))return;if((s=Number(u))<1e3||s>9999)return}else{var c=e[o];if(!/^\d+$/.test(c))return;if((s=Number(c))<0||s>99)return}var l=e[n];if(/^\d+$/.test(l)){var h=Number(l),p=e[i];if(/^\d+$/.test(p))return{year:s,month:h,day:Number(p)}}}}}t.secondsExtendedRegexp=n},function(e,t,r){"use strict";t.__esModule=!0,t.AlwaysDense=t.AlwaysSparse=t.DenseSparseChooseBasedOnThreshold=void 0;var n=r(251),i=r(250);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}var u=function(){function e(t){a(this,e),this.threshold=t}return s(e,[{key:"call",value:function(e){return e>this.threshold?n.DenseStrategy:i.SparseStrategy}}]),e}();t.DenseSparseChooseBasedOnThreshold=u;var c=function(){function e(){a(this,e)}return s(e,[{key:"call",value:function(){return i.SparseStrategy}}]),e}();t.AlwaysSparse=c;var l=function(){function e(){a(this,e)}return s(e,[{key:"call",value:function(){return n.DenseStrategy}}]),e}();t.AlwaysDense=l},function(e,t,r){"use strict";r(1),r(63),r(64),r(65),r(75),r(84),r(206),r(89),r(133),r(296),r(92),r(144),r(96),r(98),r(150),r(100),r(104),t.__esModule=!0,t.format=function(e,t,r,n){var o=r.stringifyDateTime(n.numberToSimpleDateTime(e),t);if(void 0!==o)return o;var s=r.stringifyDuration((0,i.numberToSimpleTime)(e),t);if(void 0!==s)return s;var u=(0,a.parseForNumberFormat)(t);return void 0!==u?function(e,t){for(var r="",n=0;n<e.length;++n){var i=e[n];if(i.type!==a.TokenType.FREE_TEXT){var o=i.value.split("."),s=o[0],u=o[1]||"",p=o[1]?".":"",f=Number(t.toFixed(u.length)).toString().split("."),d=f[0]||"",m=f[1]||"";if(s.length>d.length){var y=h(s.substr(0,s.length-d.length),"0");d=c(d,y+d.length)}var g=h(u.substr(m.length,u.length-m.length),"0");m=l(m,g+m.length),r+=d+p+m}else r+=i.value}return r}(u.tokens,e):t},t.padLeft=c,t.padRight=l,t.defaultStringifyDuration=function(e,t){var r=(0,a.parseForDateTimeFormat)(t);if(void 0!==r){var i,o=r.tokens,u="",l=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=s(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw a}}}}(o);try{for(l.s();!(i=l.n()).done;){var h=i.value;if(h.type!==a.TokenType.FREE_TEXT)if(n.secondsExtendedRegexp.test(h.value)){var p=h.value.length-3;u+=(e.seconds<10?"0":"")+Math.round(e.seconds*Math.pow(10,p))/Math.pow(10,p)}else switch(h.value.toLowerCase()){case"h":case"hh":u+=c(e.hours,h.value.length),e.hours=0;break;case"[hh]":u+=c(e.hours,h.value.length-2),e.hours=0;break;case"m":case"mm":u+=c(e.minutes,h.value.length),e.minutes=0;break;case"[mm]":u+=c(e.minutes+60*e.hours,h.value.length-2),e.minutes=0,e.hours=0;break;case"s":case"ss":u+=c(e.seconds,h.value.length);break;default:return}else u+=h.value}}catch(e){l.e(e)}finally{l.f()}return u}},t.defaultStringifyDateTime=function(e,t){var r=(0,a.parseForDateTimeFormat)(t);if(void 0!==r){for(var i=r.tokens,s="",u=!1,l=i.some((function(e){return e.type===a.TokenType.FORMAT&&("a/p"===e.value||"A/P"===e.value||"am/pm"===e.value||"AM/PM"===e.value)})),h=0;h<i.length;h++){var p=i[h];if(p.type!==a.TokenType.FREE_TEXT)if(n.secondsExtendedRegexp.test(p.value)){var f=p.value.length-3;s+=(e.seconds<10?"0":"")+Math.round(e.seconds*Math.pow(10,f))/Math.pow(10,f)}else switch(p.value.toLowerCase()){case"h":case"hh":u=!0,s+=c(l?(e.hours+11)%12+1:e.hours,p.value.length);break;case"d":case"dd":s+=c(e.day,p.value.length);break;case"s":case"ss":s+=c(Math.round(e.seconds),p.value.length);break;case"m":case"mm":h+1<i.length&&i[h+1].value.startsWith(":")&&(u=!0),s+=c(u?e.minutes:e.month,p.value.length),u=!0;break;case"yy":s+=c(e.year%100,p.value.length);break;case"yyyy":s+=e.year;break;case"am/pm":case"a/p":var d=o(p.value.split("/"),2),m=d[0],y=d[1];s+=e.hours<12?m:y;break;default:return}else s+=p.value}return s}};var n=r(293),i=r(264),a=r(299);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t){for(var r=e+"";r.length<t;)r="0"+r;return r}function l(e,t){for(var r=e+"";r.length<t;)r+="0";return r}function h(e,t){return e.split(t).length-1}},function(e,t,r){"use strict";var n=r(2),i=r(41),a=r(297),o=r(298),s=r(7),u=1..toFixed,c=Math.floor,l=function e(t,r,n){return 0===r?n:r%2==1?e(t,r-1,n*t):e(t*t,r/2,n)};n({target:"Number",proto:!0,forced:u&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!s((function(){u.call({})}))},{toFixed:function(e){var t,r,n,s,u=a(this),h=i(e),p=[0,0,0,0,0,0],f="",d="0",m=function(e,t){for(var r=-1,n=t;++r<6;)n+=e*p[r],p[r]=n%1e7,n=c(n/1e7)},y=function(e){for(var t=6,r=0;--t>=0;)r+=p[t],p[t]=c(r/e),r=r%e*1e7},g=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==p[e]){var r=String(p[e]);t=""===t?r:t+o.call("0",7-r.length)+r}return t};if(h<0||h>20)throw RangeError("Incorrect fraction digits");if(u!=u)return"NaN";if(u<=-1e21||u>=1e21)return String(u);if(u<0&&(f="-",u=-u),u>1e-21)if(r=(t=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t}(u*l(2,69,1))-69)<0?u*l(2,-t,1):u/l(2,t,1),r*=4503599627370496,(t=52-t)>0){for(m(0,r),n=h;n>=7;)m(1e7,0),n-=7;for(m(l(10,n,1),0),n=t-1;n>=23;)y(1<<23),n-=23;y(1<<n),m(1,1),y(2),d=g()}else m(0,r),m(1<<-t,0),d=g()+o.call("0",h);return d=h>0?f+((s=d.length)<=h?"0."+o.call("0",h-s)+d:d.slice(0,s-h)+"."+d.slice(s-h)):f+d}})},function(e,t,r){var n=r(12);e.exports=function(e){if("number"!=typeof e&&"Number"!=n(e))throw TypeError("Incorrect invocation");return+e}},function(e,t,r){"use strict";var n=r(41),i=r(13);e.exports="".repeat||function(e){var t=String(i(this)),r="",a=n(e);if(a<0||a==1/0)throw RangeError("Wrong number of repetitions");for(;a>0;(a>>>=1)&&(t+=t))1&a&&(r+=t);return r}},function(e,t,r){"use strict";r(300),r(144),r(100),t.__esModule=!0,t.formatToken=s,t.parseForDateTimeFormat=c,t.parseForNumberFormat=l,t.parse=function(e){var t,r;return null!==(r=null!==(t=c(e))&&void 0!==t?t:l(e))&&void 0!==r?r:{type:i.STRING,tokens:[{type:n.FREE_TEXT,value:e}]}},t.isEscapeToken=h,t.FormatExpressionType=t.TokenType=void 0;
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */
var n,i,a=/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g,o=/(\\.|[#0]+(\.[#0]*)?)/g;function s(e,t){return{type:e,value:t}}function u(e,t){for(var r=[],i=0,a=0;a<e.length;++a){var o=e[a];if(o.index!==i){var u=t.substr(i,o.index-i);r.push(s(n.FREE_TEXT,u))}o[0].startsWith("\\")?r.push(s(n.FREE_TEXT,o[0])):r.push(s(n.FORMAT,o[0])),i=o.index+o[0].length}var c=e[e.length-1];if(c.index+c[0].length<t.length){var l=t.substr(c.index+c[0].length,t.length);r.push(s(n.FREE_TEXT,l))}return r}function c(e){var t=function(e){a.lastIndex=0;var t,r=[];do{null!==(t=a.exec(e))&&r.push(t)}while(t);return r}(e);return t.every((function(e){return h(e)}))?void 0:{type:i.DATE,tokens:u(t,e)}}function l(e){var t=function(e){o.lastIndex=0;var t=o.exec(e);return null!==t?[t]:[]}(e);return t.every((function(e){return h(e)}))?void 0:{type:i.NUMBER,tokens:u(t,e)}}function h(e){return e[0].startsWith("\\")}t.TokenType=n,function(e){e.FORMAT="FORMAT",e.FREE_TEXT="FREE_TEXT"}(n||(t.TokenType=n={})),t.FormatExpressionType=i,function(e){e.DATE="DATE",e.NUMBER="NUMBER",e.STRING="STRING"}(i||(t.FormatExpressionType=i={}))},function(e,t,r){"use strict";var n=r(2),i=r(59).every,a=r(112),o=r(88),s=a("every"),u=o("every");n({target:"Array",proto:!0,forced:!s||!u},{every:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,r){"use strict";r(1),r(63),r(64),r(109),r(65),r(75),r(84),r(89),r(92),r(144),r(96),r(98),r(150),r(104),t.__esModule=!0,t.checkLicenseKeyValidity=function(e){var t,r,s={template:"missing",vars:{}};if("non-commercial-and-evaluation"===e||"agpl-v3"===e||"internal-use-in-handsontable"===e)s.template="valid";else if("string"==typeof e&&(0,n.checkKeySchema)(e)){var u="22/10/2020".split("/"),c=(r=3,function(e){if(Array.isArray(e))return e}(t=u)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(t,r)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=c[0],h=c[1],p=c[2],f=Math.floor(new Date("".concat(h,"/").concat(l,"/").concat(p)).getTime()/864e5),d=(0,n.extractTime)(e);s.vars.keyValidityDate=function(e){var t=["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()],r=e.getDate(),n=e.getFullYear();return"".concat(t," ").concat(r,", ").concat(n)}(new Date(864e5*(d+1))),s.template=f>d?"expired":"valid"}else""!==e&&(s.template="invalid");return o||"valid"===s.template||(console.warn(a[s.template](s.vars)),o=!0),s.template};var n=r(302);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var a={invalid:function(){return"The license key for HyperFormula is invalid."},expired:function(e){var t=e.keyValidityDate;return"The license key for HyperFormula expired"+" on ".concat(t,", and is not valid for the installed version.")},missing:function(){return"The license key for HyperFormula is missing."}},o=!1},function(e,t,r){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r(1),r(63),r(64),r(109),r(65),r(75),r(140),r(84),r(89),r(92),r(144),r(96),r(303),r(98),r(304),r(146),r(104),t.__esModule=!0,t.extractTime=function(e){return 25===s(e)[i]?a(u(s(e),a("12"),c("F")))/(a(u(s(e),c("C"),c("Y")>>4))||1+(~~![][i]<<3)):0},t.checkKeySchema=function(e){if((e=(e+"").replace(/\-/g,""))[i]!==c("Z"))return!1;var t=0;return[[0,c("G")+1],[c("H"),c("H")-1],[c("G")+c("H"),c("G")]].reduce((function(r,i,s){var c,l,h=(l=2,function(e){if(Array.isArray(e))return e}
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */(c=i)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(c,l)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(c,l)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),p=h[0],f=h[1];return r|=(o("".concat(o(a(u.apply(void 0,[e].concat([t+p-(0===s?0:2),f+(s?2:0)])))+(a(u.apply(void 0,[e].concat([t+p+f,2])))+[]).padStart(2,"0"))))%97||2)>>1,t+=2,r}),c("A"))===[]+1>>1};var i="length",a=function(e){return parseInt(e,16)},o=function(e){return parseInt(e,10)},s=function(e){return(e+"").replace(/\-/g,"")},u=function(e,t,r){return e.substr(t,r)},c=function(e){return e.codePointAt(0)-65}},function(e,t,r){"use strict";var n=r(2),i=r(99).codeAt;n({target:"String",proto:!0},{codePointAt:function(e){return i(this,e)}})},function(e,t,r){"use strict";var n=r(2),i=r(305).start;n({target:"String",proto:!0,forced:r(306)},{padStart:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,r){var n=r(40),i=r(298),a=r(13),o=Math.ceil,s=function(e){return function(t,r,s){var u,c,l=String(a(t)),h=l.length,p=void 0===s?" ":String(s),f=n(r);return f<=h||""==p?l:(u=f-h,(c=i.call(p,o(u/p.length))).length>u&&(c=c.slice(0,u)),e?l+c:c+l)}};e.exports={start:s(!1),end:s(!0)}},function(e,t,r){var n=r(87);e.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(n)},function(e,t,r){"use strict";r(1),r(63),r(64),r(109),r(65),r(75),r(113),r(140),r(84),r(89),r(133),r(209),r(92),r(96),r(98),r(104),t.__esModule=!0,t.CrudOperations=void 0;var n=r(132),i=r(106),a=r(257),o=r(266),s=r(265),u=r(255),c=r(226),l=r(217),h=r(308),p=r(277);function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||d(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){if(e){if("string"==typeof e)return m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var g=function(){function e(t,r,n,i,a,u,c,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.stats=r,this.dependencyGraph=n,this.columnSearch=i,this.parser=a,this.cellContentParser=u,this.lazilyTransformingAstService=c,this.namedExpressions=l,this.operations=new s.Operations(this.dependencyGraph,this.columnSearch,this.cellContentParser,this.parser,this.stats,this.lazilyTransformingAstService,this.namedExpressions,this.config),this.clipboardOperations=new o.ClipboardOperations(this.dependencyGraph,this.operations,this.parser,this.lazilyTransformingAstService,this.config),this.undoRedo=new h.UndoRedo(this.config,this.operations)}var t,r,m;return t=e,(r=[{key:"addRows",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=new s.AddRowsCommand(e,r);this.ensureItIsPossibleToAddRows.apply(this,[e].concat(r)),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addRows(i),this.undoRedo.saveOperation(new h.AddRowsUndoEntry(i))}},{key:"removeRows",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=new s.RemoveRowsCommand(e,r);this.ensureItIsPossibleToRemoveRows.apply(this,[e].concat(r)),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var a=this.operations.removeRows(i);this.undoRedo.saveOperation(new h.RemoveRowsUndoEntry(i,a))}},{key:"addColumns",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=new s.AddColumnsCommand(e,r);this.ensureItIsPossibleToAddColumns.apply(this,[e].concat(r)),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addColumns(i),this.undoRedo.saveOperation(new h.AddColumnsUndoEntry(i))}},{key:"removeColumns",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=new s.RemoveColumnsCommand(e,r);this.ensureItIsPossibleToRemoveColumns.apply(this,[e].concat(r)),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var a=this.operations.removeColumns(i);this.undoRedo.saveOperation(new h.RemoveColumnsUndoEntry(i,a))}},{key:"moveCells",value:function(e,t,r,n){this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var i=this.operations.moveCells(e,t,r,n),a=i.version,o=i.overwrittenCellsData,s=i.addedGlobalNamedExpressions;this.undoRedo.saveOperation(new h.MoveCellsUndoEntry(e,t,r,n,o,s,a))}},{key:"moveRows",value:function(e,t,r,n){this.ensureItIsPossibleToMoveRows(e,t,r,n),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var i=this.operations.moveRows(e,t,r,n);this.undoRedo.saveOperation(new h.MoveRowsUndoEntry(e,t,r,n,i))}},{key:"moveColumns",value:function(e,t,r,n){this.ensureItIsPossibleToMoveColumns(e,t,r,n),this.undoRedo.clearRedoStack();var i=this.operations.moveColumns(e,t,r,n);this.undoRedo.saveOperation(new h.MoveColumnsUndoEntry(e,t,r,n,i))}},{key:"cut",value:function(e,t,r){this.clipboardOperations.cut(e,t,r)}},{key:"ensureItIsPossibleToCopy",value:function(e,t,r){if(!v(t))throw new c.InvalidArgumentsError("width to be positive integer.");if(!v(r))throw new c.InvalidArgumentsError("height to be positive integer.")}},{key:"copy",value:function(e,t,r){this.ensureItIsPossibleToCopy(e,t,r),this.clipboardOperations.copy(e,t,r)}},{key:"paste",value:function(e){var t=this.clipboardOperations.clipboard;if(void 0===t)throw new c.NothingToPasteError;if(this.clipboardOperations.isCutClipboard())this.moveCells(t.sourceLeftCorner,t.width,t.height,e);else if(this.clipboardOperations.isCopyClipboard()){this.clipboardOperations.ensureItIsPossibleToCopyPaste(e);var r=n.AbsoluteCellRange.spanFrom(e,t.width,t.height),i=this.operations.getRangeClipboardCells(r);this.undoRedo.clearRedoStack(),this.dependencyGraph.breakNumericMatricesInRange(r);var a=this.operations.restoreClipboardCells(t.sourceLeftCorner.sheet,t.getContent(e));this.undoRedo.saveOperation(new h.PasteUndoEntry(e,i,t.content,a))}}},{key:"beginUndoRedoBatchMode",value:function(){this.undoRedo.beginBatchMode()}},{key:"commitUndoRedoBatchMode",value:function(){this.undoRedo.commitBatchMode()}},{key:"isClipboardEmpty",value:function(){return void 0===this.clipboardOperations.clipboard}},{key:"clearClipboard",value:function(){this.clipboardOperations.clear()}},{key:"addSheet",value:function(e){e&&this.ensureItIsPossibleToAddSheet(e),this.undoRedo.clearRedoStack();var t=this.operations.addSheet(e);return this.undoRedo.saveOperation(new h.AddSheetUndoEntry(t)),t}},{key:"removeSheet",value:function(e){this.ensureSheetExists(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var t=this.sheetMapping.fetch(e),r=this.sheetMapping.fetchDisplayName(t),n=this.operations.getSheetClipboardCells(t),i=this.operations.removeSheet(e);this.undoRedo.saveOperation(new h.RemoveSheetUndoEntry(r,t,n,i))}},{key:"renameSheet",value:function(e,t){this.ensureItIsPossibleToRenameSheet(e,t);var r=this.operations.renameSheet(e,t);return void 0!==r&&(this.undoRedo.clearRedoStack(),this.undoRedo.saveOperation(new h.RenameSheetUndoEntry(e,r,t))),r}},{key:"clearSheet",value:function(e){this.ensureSheetExists(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var t=this.sheetMapping.fetch(e),r=this.operations.getSheetClipboardCells(t);this.operations.clearSheet(t),this.undoRedo.saveOperation(new h.ClearSheetUndoEntry(t,r))}},{key:"setCellContents",value:function(e,t){if(t instanceof Array)for(var r=0;r<t.length;r++){if(!(t[r]instanceof Array))throw new c.InvalidArgumentsError("an array of arrays or a raw cell value.");for(var n=0;n<t[r].length;n++)if((0,a.isMatrix)(t[r][n]))throw new Error("Cant change matrices in batch operation")}else t=[[t]];this.ensureItIsPossibleToChangeCellContents(e,t),this.undoRedo.clearRedoStack();for(var i=[],o=0;o<t.length;o++)for(var s=0;s<t[o].length;s++){var u={sheet:e.sheet,row:e.row+o,col:e.col+s};this.clipboardOperations.abortCut();var l=this.operations.getClipboardCell(u);this.operations.setCellContent(u,t[o][s]),i.push({address:u,newContent:t[o][s],oldContent:l})}this.undoRedo.saveOperation(new h.SetCellContentsUndoEntry(i))}},{key:"setSheetContent",value:function(e,t){this.ensureSheetExists(e);var r=this.sheetMapping.fetch(e);this.ensureItIsPossibleToChangeSheetContents(r,t),(0,p.validateAsSheet)(t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var n=this.operations.getSheetClipboardCells(r);this.operations.setSheetContent(r,t),this.undoRedo.saveOperation(new h.SetSheetContentUndoEntry(r,n,t))}},{key:"undo",value:function(){if(this.undoRedo.isUndoStackEmpty())throw new c.NoOperationToUndoError;this.clipboardOperations.abortCut(),this.undoRedo.undo()}},{key:"redo",value:function(){if(this.undoRedo.isRedoStackEmpty())throw new c.NoOperationToRedoError;this.clipboardOperations.abortCut(),this.undoRedo.redo()}},{key:"addNamedExpression",value:function(e,t,r,n){var i=this.scopeId(r);this.ensureNamedExpressionNameIsValid(e,i),this.operations.addNamedExpression(e,t,i,n),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new h.AddNamedExpressionUndoEntry(e,t,i,n))}},{key:"changeNamedExpressionExpression",value:function(e,t,r,n){var i=this.scopeId(t),a=f(this.operations.changeNamedExpressionExpression(e,r,i,n),2),o=a[0],s=a[1];this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new h.ChangeNamedExpressionUndoEntry(o,r,s,i,n))}},{key:"removeNamedExpression",value:function(e,t){var r=this.scopeId(t),n=f(this.operations.removeNamedExpression(e,r),2),i=n[0],a=n[1];return this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new h.RemoveNamedExpressionUndoEntry(i,a,r)),i}},{key:"ensureItIsPossibleToAddNamedExpression",value:function(e,t,r){var n=this.scopeId(r);this.ensureNamedExpressionNameIsValid(e,n),this.ensureNamedExpressionIsValid(t)}},{key:"ensureItIsPossibleToChangeNamedExpression",value:function(e,t,r){var n=this.scopeId(r);if(void 0===this.namedExpressions.namedExpressionForScope(e,n))throw new c.NamedExpressionDoesNotExistError(e);this.ensureNamedExpressionIsValid(t)}},{key:"isItPossibleToRemoveNamedExpression",value:function(e,t){var r=this.scopeId(t);if(void 0===this.namedExpressions.namedExpressionForScope(e,r))throw new c.NamedExpressionDoesNotExistError(e)}},{key:"ensureItIsPossibleToAddRows",value:function(e){if(!this.sheetMapping.hasSheetWithId(e))throw new c.NoSheetWithIdError(e);for(var t=this.dependencyGraph.getSheetHeight(e),r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var a=n.map((function(e){return e[1]})).reduce((function(e,t){return e+t}),0);if(t+a>this.config.maxRows)throw new c.SheetSizeLimitExceededError;for(var o=0,s=n;o<s.length;o++){var u=f(s[o],2),l=u[0],h=u[1];if(!E(l)||!v(h))throw new c.InvalidArgumentsError("row number to be nonnegative and number of rows to add to be positive.");if(v(l)&&this.dependencyGraph.matrixMapping.isFormulaMatrixInRow(e,l-1)&&this.dependencyGraph.matrixMapping.isFormulaMatrixInRow(e,l))throw new c.TargetLocationHasMatrixError}}},{key:"ensureItIsPossibleToRemoveRows",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(var i=0,a=r;i<a.length;i++){var o=f(a[i],2),s=o[0],u=o[1],h=s+u-1;if(!E(s)||!E(h))throw new c.InvalidArgumentsError("starting and ending row to be nonnegative.");if(h<s)throw new c.InvalidArgumentsError("starting row to be smaller than the ending row.");var p=l.RowsSpan.fromRowStartAndEnd(e,s,h);if(!this.sheetMapping.hasSheetWithId(e))throw new c.NoSheetWithIdError(e);if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRows(p))throw new c.SourceLocationHasMatrixError}}},{key:"ensureItIsPossibleToAddColumns",value:function(e){if(!this.sheetMapping.hasSheetWithId(e))throw new c.NoSheetWithIdError(e);for(var t=this.dependencyGraph.getSheetWidth(e),r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var a=n.map((function(e){return e[1]})).reduce((function(e,t){return e+t}),0);if(t+a>this.config.maxColumns)throw new c.SheetSizeLimitExceededError;for(var o=0,s=n;o<s.length;o++){var u=f(s[o],2),l=u[0],h=u[1];if(!E(l)||!v(h))throw new c.InvalidArgumentsError("column number to be nonnegative and number of columns to add to be positive.");if(v(l)&&this.dependencyGraph.matrixMapping.isFormulaMatrixInColumn(e,l-1)&&this.dependencyGraph.matrixMapping.isFormulaMatrixInColumn(e,l))throw new c.TargetLocationHasMatrixError}}},{key:"ensureItIsPossibleToRemoveColumns",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(var i=0,a=r;i<a.length;i++){var o=f(a[i],2),s=o[0],u=o[1],h=s+u-1;if(!E(s)||!E(h))throw new c.InvalidArgumentsError("starting and ending column to be nonnegative.");if(h<s)throw new c.InvalidArgumentsError("starting column to be smaller than the ending column.");var p=l.ColumnsSpan.fromColumnStartAndEnd(e,s,h);if(!this.sheetMapping.hasSheetWithId(e))throw new c.NoSheetWithIdError(e);if(this.dependencyGraph.matrixMapping.isFormulaMatrixInColumns(p))throw new c.SourceLocationHasMatrixError}}},{key:"ensureItIsPossibleToMoveRows",value:function(e,t,r,a){this.ensureItIsPossibleToAddRows(e,[a,r]);var o=(0,i.simpleCellAddress)(e,0,t),s=(0,i.simpleCellAddress)(e,0,a);if(!this.sheetMapping.hasSheetWithId(e)||(0,i.invalidSimpleCellAddress)(o)||(0,i.invalidSimpleCellAddress)(s)||!v(r)||a<=t+r&&a>=t)throw new c.InvalidArgumentsError("a valid range of rows to move.");var u=this.dependencyGraph.getSheetWidth(e),l=n.AbsoluteCellRange.spanFrom(o,u,r);if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRange(l))throw new c.SourceLocationHasMatrixError}},{key:"ensureItIsPossibleToMoveColumns",value:function(e,t,r,a){this.ensureItIsPossibleToAddColumns(e,[a,r]);var o=(0,i.simpleCellAddress)(e,t,0),s=(0,i.simpleCellAddress)(e,a,0);if(!this.sheetMapping.hasSheetWithId(e)||(0,i.invalidSimpleCellAddress)(o)||(0,i.invalidSimpleCellAddress)(s)||!v(r)||a<=t+r&&a>=t)throw new c.InvalidArgumentsError("a valid range of columns to move.");var u=this.dependencyGraph.getSheetHeight(e),l=n.AbsoluteCellRange.spanFrom(o,r,u);if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRange(l))throw new c.SourceLocationHasMatrixError}},{key:"ensureItIsPossibleToAddSheet",value:function(e){if(this.sheetMapping.hasSheetWithName(e))throw new c.SheetNameAlreadyTakenError(e)}},{key:"ensureItIsPossibleToRenameSheet",value:function(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new c.NoSheetWithIdError(e);var r=this.sheetMapping.get(t);if(void 0!==r&&r!==e)throw new c.SheetNameAlreadyTakenError(t)}},{key:"ensureItIsPossibleToChangeContent",value:function(e){if((0,i.invalidSimpleCellAddress)(e))throw new c.InvalidAddressError(e);if(!this.sheetMapping.hasSheetWithId(e.sheet))throw new c.NoSheetWithIdError(e.sheet);if(this.dependencyGraph.matrixMapping.isFormulaMatrixAtAddress(e))throw new c.SourceLocationHasMatrixError}},{key:"ensureItIsPossibleToChangeCellContents",value:function(e,t){var r=(0,p.findBoundaries)(t),i=n.AbsoluteCellRange.spanFrom(e,r.width,r.height);this.ensureRangeInSizeLimits(i);var a,o=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=d(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}(i.addresses(this.dependencyGraph));try{for(o.s();!(a=o.n()).done;){var s=a.value;this.ensureItIsPossibleToChangeContent(s)}}catch(e){o.e(e)}finally{o.f()}}},{key:"ensureItIsPossibleToChangeSheetContents",value:function(e,t){var r=(0,p.findBoundaries)(t),a=n.AbsoluteCellRange.spanFrom((0,i.simpleCellAddress)(e,0,0),r.width,r.height);this.ensureRangeInSizeLimits(a)}},{key:"ensureRangeInSizeLimits",value:function(e){if(e.exceedsSheetSizeLimits(this.config.maxColumns,this.config.maxRows))throw new c.SheetSizeLimitExceededError}},{key:"isThereSomethingToUndo",value:function(){return!this.undoRedo.isUndoStackEmpty()}},{key:"isThereSomethingToRedo",value:function(){return!this.undoRedo.isRedoStackEmpty()}},{key:"getAndClearContentChanges",value:function(){return this.operations.getAndClearContentChanges()}},{key:"ensureSheetExists",value:function(e){if(!this.sheetMapping.hasSheetWithName(e))throw new c.NoSheetWithNameError(e)}},{key:"scopeId",value:function(e){if(void 0!==e)return this.ensureSheetExists(e),this.sheetMapping.fetch(e)}},{key:"ensureNamedExpressionNameIsValid",value:function(e,t){if(!this.namedExpressions.isNameValid(e))throw new c.NamedExpressionNameIsInvalidError(e);if(!this.namedExpressions.isNameAvailable(e,t))throw new c.NamedExpressionNameIsAlreadyTakenError(e)}},{key:"ensureNamedExpressionIsValid",value:function(e){var t=this.cellContentParser.parse(e);if(t instanceof a.CellContent.MatrixFormula)throw new c.MatrixFormulasNotSupportedError;if(t instanceof a.CellContent.Formula){var r=this.parser.parse(t.formula,(0,i.simpleCellAddress)(-1,0,0));if((0,u.doesContainRelativeReferences)(r.ast))throw new c.NoRelativeAddressesAllowedError}}},{key:"sheetMapping",get:function(){return this.dependencyGraph.sheetMapping}}])&&y(t.prototype,r),m&&y(t,m),e}();function v(e){return Number.isInteger(e)&&e>0}function E(e){return Number.isInteger(e)&&e>=0}t.CrudOperations=g},function(e,t,r){"use strict";r(1),r(63),r(64),r(65),r(75),r(84),r(233),r(89),r(207),r(92),r(96),r(98),r(104),t.__esModule=!0,t.UndoRedo=t.BatchUndoEntry=t.ChangeNamedExpressionUndoEntry=t.RemoveNamedExpressionUndoEntry=t.AddNamedExpressionUndoEntry=t.PasteUndoEntry=t.SetCellContentsUndoEntry=t.ClearSheetUndoEntry=t.RenameSheetUndoEntry=t.RemoveSheetUndoEntry=t.AddSheetUndoEntry=t.RemoveColumnsUndoEntry=t.AddColumnsUndoEntry=t.MoveColumnsUndoEntry=t.MoveRowsUndoEntry=t.SetSheetContentUndoEntry=t.AddRowsUndoEntry=t.MoveCellsUndoEntry=t.RemoveRowsUndoEntry=void 0,r(125);var n=r(106),i=r(265);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=s(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw a}}}}function s(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),e}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var p=function e(t,r){h(this,e),this.command=t,this.rowsRemovals=r};t.RemoveRowsUndoEntry=p;var f=function e(t,r,n,i,a,o,s){h(this,e),this.sourceLeftCorner=t,this.width=r,this.height=n,this.destinationLeftCorner=i,this.overwrittenCellsData=a,this.addedGlobalNamedExpressions=o,this.version=s};t.MoveCellsUndoEntry=f;var d=function e(t){h(this,e),this.command=t};t.AddRowsUndoEntry=d;var m=function e(t,r,n){h(this,e),this.sheetId=t,this.oldSheetContent=r,this.newSheetContent=n};t.SetSheetContentUndoEntry=m;var y=function e(t,r,n,i,a){h(this,e),this.sheet=t,this.startRow=r,this.numberOfRows=n,this.targetRow=i,this.version=a,this.undoStart=this.startRow<this.targetRow?this.targetRow-this.numberOfRows:this.targetRow,this.undoEnd=this.startRow>this.targetRow?this.startRow+this.numberOfRows:this.startRow};t.MoveRowsUndoEntry=y;var g=function e(t,r,n,i,a){h(this,e),this.sheet=t,this.startColumn=r,this.numberOfColumns=n,this.targetColumn=i,this.version=a,this.undoStart=this.startColumn<this.targetColumn?this.targetColumn-this.numberOfColumns:this.targetColumn,this.undoEnd=this.startColumn>this.targetColumn?this.startColumn+this.numberOfColumns:this.startColumn};t.MoveColumnsUndoEntry=g;var v=function e(t){h(this,e),this.command=t};t.AddColumnsUndoEntry=v;var E=function e(t,r){h(this,e),this.command=t,this.columnsRemovals=r};t.RemoveColumnsUndoEntry=E;var T=function e(t){h(this,e),this.sheetName=t};t.AddSheetUndoEntry=T;var b=function e(t,r,n,i){h(this,e),this.sheetName=t,this.sheetId=r,this.oldSheetContent=n,this.version=i};t.RemoveSheetUndoEntry=b;var x=function e(t,r,n){h(this,e),this.sheetId=t,this.oldName=r,this.newName=n};t.RenameSheetUndoEntry=x;var A=function e(t,r){h(this,e),this.sheetId=t,this.oldSheetContent=r};t.ClearSheetUndoEntry=A;var S=function e(t){h(this,e),this.cellContents=t};t.SetCellContentsUndoEntry=S;var R=function e(t,r,n,i){h(this,e),this.targetLeftCorner=t,this.oldContent=r,this.newContent=n,this.addedGlobalNamedExpressions=i};t.PasteUndoEntry=R;var w=function e(t,r,n,i){h(this,e),this.name=t,this.newContent=r,this.scope=n,this.options=i};t.AddNamedExpressionUndoEntry=w;var C=function e(t,r,n){h(this,e),this.namedExpression=t,this.content=r,this.scope=n};t.RemoveNamedExpressionUndoEntry=C;var O=function e(t,r,n,i,a){h(this,e),this.namedExpression=t,this.newContent=r,this.oldContent=n,this.scope=i,this.options=a};t.ChangeNamedExpressionUndoEntry=O;var k=function(){function e(){h(this,e),this.operations=[]}return l(e,[{key:"add",value:function(e){this.operations.push(e)}},{key:"reversedOperations",value:regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.operations.length-1;case 1:if(!(t>=0)){e.next=7;break}return e.next=4,this.operations[t];case 4:t--,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))}]),e}();t.BatchUndoEntry=k;var N=function(){function e(t,r){h(this,e),this.operations=r,this.undoStack=[],this.redoStack=[],this.oldData=new Map,this.undoLimit=t.undoLimit}return l(e,[{key:"saveOperation",value:function(e){void 0!==this.batchUndoEntry?this.batchUndoEntry.add(e):this.addUndoEntry(e)}},{key:"beginBatchMode",value:function(){this.batchUndoEntry=new k}},{key:"addUndoEntry",value:function(e){this.undoStack.push(e),this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}},{key:"commitBatchMode",value:function(){if(void 0===this.batchUndoEntry)throw"Batch mode wasn't started";this.addUndoEntry(this.batchUndoEntry),this.batchUndoEntry=void 0}},{key:"storeDataForVersion",value:function(e,t,r){this.oldData.has(e)||this.oldData.set(e,[]),this.oldData.get(e).push([t,r])}},{key:"clearRedoStack",value:function(){this.redoStack=[]}},{key:"clearUndoStack",value:function(){this.undoStack=[]}},{key:"isUndoStackEmpty",value:function(){return 0===this.undoStack.length}},{key:"isRedoStackEmpty",value:function(){return 0===this.redoStack.length}},{key:"undo",value:function(){var e=this.undoStack.pop();if(!e)throw"Attempted to undo without operation on stack";this.undoEntry(e),this.redoStack.push(e)}},{key:"undoEntry",value:function(e){if(e instanceof p)this.undoRemoveRows(e);else if(e instanceof d)this.undoAddRows(e);else if(e instanceof S)this.undoSetCellContents(e);else if(e instanceof y)this.undoMoveRows(e);else if(e instanceof T)this.undoAddSheet(e);else if(e instanceof b)this.undoRemoveSheet(e);else if(e instanceof x)this.undoRenameSheet(e);else if(e instanceof A)this.undoClearSheet(e);else if(e instanceof v)this.undoAddColumns(e);else if(e instanceof E)this.undoRemoveColumns(e);else if(e instanceof g)this.undoMoveColumns(e);else if(e instanceof f)this.undoMoveCells(e);else if(e instanceof m)this.undoSetSheetContent(e);else if(e instanceof R)this.undoPaste(e);else if(e instanceof k)this.undoBatch(e);else if(e instanceof w)this.undoAddNamedExpression(e);else if(e instanceof C)this.undoRemoveNamedExpression(e);else{if(!(e instanceof O))throw"Unknown element";this.undoChangeNamedExpression(e)}}},{key:"undoBatch",value:function(e){var t,r=o(e.reversedOperations());try{for(r.s();!(t=r.n()).done;){var n=t.value;this.undoEntry(n)}}catch(e){r.e(e)}finally{r.f()}}},{key:"undoRemoveRows",value:function(e){this.operations.forceApplyPostponedTransformations();for(var t=e.command.sheet,r=e.rowsRemovals,n=r.length-1;n>=0;--n){var a=r[n];this.operations.addRows(new i.AddRowsCommand(t,[[a.rowFrom,a.rowCount]]));var s,u=o(a.removedCells);try{for(u.s();!(s=u.n()).done;){var c=s.value,l=c.address,h=c.cellType;this.operations.restoreCell(l,h)}}catch(e){u.e(e)}finally{u.f()}this.restoreOldDataFromVersion(a.version-1)}}},{key:"undoRemoveColumns",value:function(e){this.operations.forceApplyPostponedTransformations();for(var t=e.command.sheet,r=e.columnsRemovals,n=r.length-1;n>=0;--n){var a=r[n];this.operations.addColumns(new i.AddColumnsCommand(t,[[a.columnFrom,a.columnCount]]));var s,u=o(a.removedCells);try{for(u.s();!(s=u.n()).done;){var c=s.value,l=c.address,h=c.cellType;this.operations.restoreCell(l,h)}}catch(e){u.e(e)}finally{u.f()}this.restoreOldDataFromVersion(a.version-1)}}},{key:"undoAddRows",value:function(e){for(var t=e.command.rowsSpans(),r=t.length-1;r>=0;--r){var n=t[r];this.operations.removeRows(new i.RemoveRowsCommand(e.command.sheet,[[n.rowStart,n.numberOfRows]]))}}},{key:"undoAddColumns",value:function(e){for(var t=e.command.columnsSpans(),r=t.length-1;r>=0;--r){var n=t[r];this.operations.removeColumns(new i.RemoveColumnsCommand(e.command.sheet,[[n.columnStart,n.numberOfColumns]]))}}},{key:"undoSetCellContents",value:function(e){var t,r=o(e.cellContents);try{for(r.s();!(t=r.n()).done;){var n=t.value;this.operations.restoreCell(n.address,n.oldContent)}}catch(e){r.e(e)}finally{r.f()}}},{key:"undoPaste",value:function(e){var t,r=o(e.oldContent);try{for(r.s();!(t=r.n()).done;){var n=a(t.value,2),i=n[0],s=n[1];this.operations.restoreCell(i,s)}}catch(e){r.e(e)}finally{r.f()}var u,c=o(e.addedGlobalNamedExpressions);try{for(c.s();!(u=c.n()).done;){var l=u.value;this.operations.removeNamedExpression(l)}}catch(e){c.e(e)}finally{c.f()}}},{key:"undoMoveRows",value:function(e){var t=e.sheet;this.operations.moveRows(t,e.undoStart,e.numberOfRows,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}},{key:"undoMoveColumns",value:function(e){var t=e.sheet;this.operations.moveColumns(t,e.undoStart,e.numberOfColumns,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}},{key:"undoMoveCells",value:function(e){this.operations.forceApplyPostponedTransformations(),this.operations.moveCells(e.destinationLeftCorner,e.width,e.height,e.sourceLeftCorner);var t,r=o(e.overwrittenCellsData);try{for(r.s();!(t=r.n()).done;){var n=a(t.value,2),i=n[0],s=n[1];this.operations.restoreCell(i,s)}}catch(e){r.e(e)}finally{r.f()}this.restoreOldDataFromVersion(e.version-1);var u,c=o(e.addedGlobalNamedExpressions);try{for(c.s();!(u=c.n()).done;){var l=u.value;this.operations.removeNamedExpression(l)}}catch(e){c.e(e)}finally{c.f()}}},{key:"undoAddSheet",value:function(e){var t=e.sheetName;this.operations.removeSheet(t)}},{key:"undoRemoveSheet",value:function(e){this.operations.forceApplyPostponedTransformations();var t=e.oldSheetContent,r=e.sheetId;this.operations.addSheet(e.sheetName);for(var i=0;i<t.length;i++)for(var a=t[i],o=0;o<a.length;o++){var s=a[o],u=(0,n.simpleCellAddress)(r,o,i);this.operations.restoreCell(u,s)}this.restoreOldDataFromVersion(e.version-1)}},{key:"undoRenameSheet",value:function(e){this.operations.renameSheet(e.sheetId,e.oldName)}},{key:"undoClearSheet",value:function(e){for(var t=e.oldSheetContent,r=e.sheetId,i=0;i<t.length;i++)for(var a=t[i],o=0;o<a.length;o++){var s=a[o],u=(0,n.simpleCellAddress)(r,o,i);this.operations.restoreCell(u,s)}}},{key:"undoSetSheetContent",value:function(e){var t=e.oldSheetContent,r=e.sheetId;this.operations.clearSheet(r);for(var i=0;i<t.length;i++)for(var a=t[i],o=0;o<a.length;o++){var s=a[o],u=(0,n.simpleCellAddress)(r,o,i);this.operations.restoreCell(u,s)}}},{key:"undoAddNamedExpression",value:function(e){this.operations.removeNamedExpression(e.name,e.scope)}},{key:"undoRemoveNamedExpression",value:function(e){this.operations.restoreNamedExpression(e.namedExpression,e.content,e.scope)}},{key:"undoChangeNamedExpression",value:function(e){this.operations.restoreNamedExpression(e.namedExpression,e.oldContent,e.scope)}},{key:"redo",value:function(){var e=this.redoStack.pop();if(!e)throw"Attempted to redo without operation on stack";this.redoEntry(e),this.undoStack.push(e)}},{key:"redoEntry",value:function(e){if(e instanceof p)this.redoRemoveRows(e);else if(e instanceof d)this.redoAddRows(e);else if(e instanceof S)this.redoSetCellContents(e);else if(e instanceof y)this.redoMoveRows(e);else if(e instanceof T)this.redoAddSheet(e);else if(e instanceof b)this.redoRemoveSheet(e);else if(e instanceof x)this.redoRenameSheet(e);else if(e instanceof A)this.redoClearSheet(e);else if(e instanceof v)this.redoAddColumns(e);else if(e instanceof E)this.redoRemoveColumns(e);else if(e instanceof g)this.redoMoveColumns(e);else if(e instanceof f)this.redoMoveCells(e);else if(e instanceof m)this.redoSetSheetContent(e);else if(e instanceof R)this.redoPaste(e);else if(e instanceof k)this.redoBatch(e);else if(e instanceof w)this.redoAddNamedExpression(e);else if(e instanceof C)this.redoRemoveNamedExpression(e);else{if(!(e instanceof O))throw"Unknown element";this.redoChangeNamedExpression(e)}}},{key:"redoBatch",value:function(e){var t,r=o(e.operations);try{for(r.s();!(t=r.n()).done;){var n=t.value;this.redoEntry(n)}}catch(e){r.e(e)}finally{r.f()}}},{key:"redoRemoveRows",value:function(e){this.operations.removeRows(e.command)}},{key:"redoMoveCells",value:function(e){this.operations.moveCells(e.sourceLeftCorner,e.width,e.height,e.destinationLeftCorner)}},{key:"redoRemoveColumns",value:function(e){this.operations.removeColumns(e.command)}},{key:"redoPaste",value:function(e){for(var t=e.targetLeftCorner,r=e.newContent,i=r.length,a=r[0].length,o=0;o<i;++o)for(var s=0;s<a;++s){var u=(0,n.simpleCellAddress)(t.sheet,t.col+s,t.row+o);this.operations.restoreCell(u,r[o][s])}}},{key:"redoSetCellContents",value:function(e){var t,r=o(e.cellContents);try{for(r.s();!(t=r.n()).done;){var n=t.value;this.operations.setCellContent(n.address,n.newContent)}}catch(e){r.e(e)}finally{r.f()}}},{key:"redoAddRows",value:function(e){this.operations.addRows(e.command)}},{key:"redoAddColumns",value:function(e){this.operations.addColumns(e.command)}},{key:"redoRemoveSheet",value:function(e){this.operations.removeSheet(e.sheetName)}},{key:"redoAddSheet",value:function(e){this.operations.addSheet(e.sheetName)}},{key:"redoRenameSheet",value:function(e){this.operations.renameSheet(e.sheetId,e.newName)}},{key:"redoMoveRows",value:function(e){this.operations.moveRows(e.sheet,e.startRow,e.numberOfRows,e.targetRow)}},{key:"redoMoveColumns",value:function(e){this.operations.moveColumns(e.sheet,e.startColumn,e.numberOfColumns,e.targetColumn)}},{key:"redoClearSheet",value:function(e){this.operations.clearSheet(e.sheetId)}},{key:"redoSetSheetContent",value:function(e){var t=e.sheetId,r=e.newSheetContent;this.operations.setSheetContent(t,r)}},{key:"redoAddNamedExpression",value:function(e){this.operations.addNamedExpression(e.name,e.newContent,e.scope,e.options)}},{key:"redoRemoveNamedExpression",value:function(e){this.operations.removeNamedExpression(e.namedExpression.displayName,e.scope)}},{key:"redoChangeNamedExpression",value:function(e){this.operations.changeNamedExpressionExpression(e.namedExpression.displayName,e.newContent,e.scope,e.options)}},{key:"restoreOldDataFromVersion",value:function(e){var t,r=o(this.oldData.get(e)||[]);try{for(r.s();!(t=r.n()).done;){var n=a(t.value,2),i=n[0],s=n[1];this.operations.setFormulaToCellFromCache(s,i)}}catch(e){r.e(e)}finally{r.f()}}}]),e}();t.UndoRedo=N},function(e,t,r){"use strict";r(1),r(63),r(64),r(110),r(65),r(75),r(84),r(89),r(92),r(96),r(98),r(124),r(104),t.__esModule=!0,t.Evaluator=void 0;var n=r(132),i=r(218),a=r(106),o=r(267),s=r(107),u=r(213),c=r(310),l=r(246),h=r(232),p=r(219);function f(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var y=function(){function e(t,r,n,i,a,o,s,u,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dependencyGraph=t,this.columnSearch=r,this.config=n,this.stats=i,this.dateHelper=a,this.numberLiteralsHelper=o,this.functionRegistry=s,this.namedExpressions=u,this.serialization=l,this.interpreter=new c.Interpreter(this.dependencyGraph,this.columnSearch,this.config,this.stats,this.dateHelper,this.numberLiteralsHelper,this.functionRegistry,this.namedExpressions,this.serialization)}var t,r,d;return t=e,(r=[{key:"run",value:function(){var e=this;this.stats.start(p.StatType.TOP_SORT);var t=this.dependencyGraph.topSortWithScc(),r=t.sorted,n=t.cycled;this.stats.end(p.StatType.TOP_SORT),this.stats.measure(p.StatType.EVALUATION,(function(){e.recomputeFormulas(n,r)}))}},{key:"partialRun",value:function(e){var t=this,r=new o.ContentChanges;return this.stats.measure(p.StatType.EVALUATION,(function(){t.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(e,(function(e){if(e instanceof s.FormulaCellVertex){var n=e.getAddress(t.dependencyGraph.lazilyTransformingAstService),i=e.getFormula(t.dependencyGraph.lazilyTransformingAstService),a=e.isComputed()?e.getCellValue():null,o=t.evaluateAstToCellValue(i,n);return e.setCellValue(o),o!==a&&(r.addChange(o,n),t.columnSearch.change(a,o,n),!0)}if(e instanceof s.MatrixVertex&&e.isFormula()){var u=e.getAddress(),c=e.getFormula(),p=e.isComputed()?e.getCellValue():null,f=t.evaluateAstToRangeValue(c,u);if(f instanceof l.SimpleRangeValue){var d=new h.Matrix(f.rawNumbers());e.setCellValue(d),r.addMatrixChange(d,u),t.columnSearch.change(p,d,u)}else e.setErrorValue(f),r.addChange(f,u),t.columnSearch.change(p,f,u);return!0}return!(e instanceof s.RangeVertex&&(e.clearCache(),0))}),(function(e){if(e instanceof s.RangeVertex)e.clearCache();else if(e instanceof s.FormulaCellVertex){var n=e.getAddress(t.dependencyGraph.lazilyTransformingAstService);t.columnSearch.remove(e.valueOrNull(),n);var i=new a.CellError(a.ErrorType.CYCLE,void 0,e.address);e.setCellValue(i),r.addChange(i,e.address)}}))})),r}},{key:"destroy",value:function(){this.interpreter.destroy()}},{key:"runAndForget",value:function(e,t,r){var a,o=this,u=[],c=f((0,i.absolutizeDependencies)(r,t));try{for(c.s();!(a=c.n()).done;){var l=a.value;if(l instanceof n.AbsoluteCellRange){var h=l;if(void 0===this.dependencyGraph.getRange(h.start,h.end)){var p=new s.RangeVertex(h);this.dependencyGraph.rangeMapping.setRange(p),u.push(p)}}}}catch(e){c.e(e)}finally{c.f()}var d=this.evaluateAstToCellValue(e,t);return u.forEach((function(e){o.dependencyGraph.rangeMapping.removeRange(e)})),d}},{key:"recomputeFormulas",value:function(e,t){var r=this;e.forEach((function(e){e instanceof s.FormulaCellVertex&&e.setCellValue(new a.CellError(a.ErrorType.CYCLE,void 0,e.address))})),t.forEach((function(e){if(e instanceof s.FormulaCellVertex){var t=e.getAddress(r.dependencyGraph.lazilyTransformingAstService),n=e.getFormula(r.dependencyGraph.lazilyTransformingAstService),i=r.evaluateAstToCellValue(n,t);e.setCellValue(i),r.columnSearch.add(i,t)}else if(e instanceof s.MatrixVertex&&e.isFormula()){var a=e.getAddress(),o=e.getFormula(),u=r.evaluateAstToRangeValue(o,a);if(u instanceof l.SimpleRangeValue){var c=new h.Matrix(u.rawNumbers());e.setCellValue(c),r.columnSearch.add(c,a)}else e.setErrorValue(u),r.columnSearch.add(u,a)}else e instanceof s.RangeVertex&&e.clearCache()}))}},{key:"evaluateAstToCellValue",value:function(e,t){var r=this.interpreter.evaluateAst(e,t);return r instanceof l.SimpleRangeValue?r:r===a.EmptyValue&&this.config.evaluateNullToZero?0:r}},{key:"evaluateAstToRangeValue",value:function(e,t){var r=this.interpreter.evaluateAst(e,t);return r instanceof a.CellError||r instanceof l.SimpleRangeValue&&r.hasOnlyNumbers()?r:new a.CellError(a.ErrorType.VALUE,u.ErrorMessage.CellRangeExpected)}}])&&m(t.prototype,r),d&&m(t,d),e}();t.Evaluator=y},function(e,t,r){"use strict";r(1),r(63),r(64),r(109),r(65),r(75),r(84),r(89),r(92),r(96),r(98),r(104),t.__esModule=!0,t.Interpreter=void 0;var n,i=(n=r(311))&&n.__esModule?n:{default:n},a=r(132),o=r(106),s=r(213),u=r(232),c=r(203),l=r(261),h=r(312),p=r(313),f=r(246);function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var g=function(){function e(t,r,n,i,a,o,s,u,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dependencyGraph=t,this.columnSearch=r,this.config=n,this.stats=i,this.dateHelper=a,this.numberLiteralsHelper=o,this.functionRegistry=s,this.namedExpressions=u,this.serialization=c,this.functionRegistry.initializePlugins(this),this.arithmeticHelper=new l.ArithmeticHelper(n,a,o),this.criterionBuilder=new h.CriterionBuilder(n)}var t,r,n;return t=e,(r=[{key:"evaluateAst",value:function(e,t){var r=this.evaluateAstWithoutPostoprocessing(e,t);if("number"==typeof r){if((0,l.isNumberOverflow)(r))return new o.CellError(o.ErrorType.NUM,s.ErrorMessage.NaN);r=(0,l.fixNegativeZero)(r)}return function(e,t){return e instanceof o.CellError?e.attachAddress(t):e}(r,t)}},{key:"evaluateAstWithoutPostoprocessing",value:function(e,t){var r,n,i,h,m,y,g,b,x,A,S,R;switch(e.type){case c.AstNodeType.EMPTY:return o.EmptyValue;case c.AstNodeType.CELL_REFERENCE:var w=e.reference.toSimpleCellAddress(t);return(0,o.invalidSimpleCellAddress)(w)?new o.CellError(o.ErrorType.REF,s.ErrorMessage.BadRef):this.dependencyGraph.getCellValue(w);case c.AstNodeType.NUMBER:case c.AstNodeType.STRING:return e.value;case c.AstNodeType.CONCATENATE_OP:var C=this.evaluateAst(e.left,t),O=this.evaluateAst(e.right,t);return null!==(r=v(C,O))&&void 0!==r?r:T(this.arithmeticHelper.concat,(0,l.coerceScalarToString)(C),(0,l.coerceScalarToString)(O));case c.AstNodeType.EQUALS_OP:var k=this.evaluateAst(e.left,t),N=this.evaluateAst(e.right,t);return null!==(n=v(k,N))&&void 0!==n?n:this.arithmeticHelper.eq(k,N);case c.AstNodeType.NOT_EQUAL_OP:var _=this.evaluateAst(e.left,t),I=this.evaluateAst(e.right,t);return null!==(i=v(_,I))&&void 0!==i?i:this.arithmeticHelper.neq(_,I);case c.AstNodeType.GREATER_THAN_OP:var M=this.evaluateAst(e.left,t),P=this.evaluateAst(e.right,t);return null!==(h=v(M,P))&&void 0!==h?h:this.arithmeticHelper.gt(M,P);case c.AstNodeType.LESS_THAN_OP:var L=this.evaluateAst(e.left,t),F=this.evaluateAst(e.right,t);return null!==(m=v(L,F))&&void 0!==m?m:this.arithmeticHelper.lt(L,F);case c.AstNodeType.GREATER_THAN_OR_EQUAL_OP:var D=this.evaluateAst(e.left,t),U=this.evaluateAst(e.right,t);return null!==(y=v(D,U))&&void 0!==y?y:this.arithmeticHelper.geq(D,U);case c.AstNodeType.LESS_THAN_OR_EQUAL_OP:var V=this.evaluateAst(e.left,t),j=this.evaluateAst(e.right,t);return null!==(g=v(V,j))&&void 0!==g?g:this.arithmeticHelper.leq(V,j);case c.AstNodeType.PLUS_OP:var G=this.evaluateAst(e.left,t),B=this.evaluateAst(e.right,t);return null!==(b=v(G,B))&&void 0!==b?b:T(this.arithmeticHelper.addWithEpsilon,this.arithmeticHelper.coerceScalarToNumberOrError(G),this.arithmeticHelper.coerceScalarToNumberOrError(B));case c.AstNodeType.MINUS_OP:var z=this.evaluateAst(e.left,t),W=this.evaluateAst(e.right,t);return null!==(x=v(z,W))&&void 0!==x?x:T(this.arithmeticHelper.subtract,this.arithmeticHelper.coerceScalarToNumberOrError(z),this.arithmeticHelper.coerceScalarToNumberOrError(W));case c.AstNodeType.TIMES_OP:var K=this.evaluateAst(e.left,t),H=this.evaluateAst(e.right,t);return null!==(A=v(K,H))&&void 0!==A?A:T(this.arithmeticHelper.multiply,this.arithmeticHelper.coerceScalarToNumberOrError(K),this.arithmeticHelper.coerceScalarToNumberOrError(H));case c.AstNodeType.POWER_OP:var X=this.evaluateAst(e.left,t),Y=this.evaluateAst(e.right,t);return null!==(S=v(X,Y))&&void 0!==S?S:T(this.arithmeticHelper.pow,this.arithmeticHelper.coerceScalarToNumberOrError(X),this.arithmeticHelper.coerceScalarToNumberOrError(Y));case c.AstNodeType.DIV_OP:var q=this.evaluateAst(e.left,t),$=this.evaluateAst(e.right,t);return null!==(R=v(q,$))&&void 0!==R?R:T(this.arithmeticHelper.divide,this.arithmeticHelper.coerceScalarToNumberOrError(q),this.arithmeticHelper.coerceScalarToNumberOrError($));case c.AstNodeType.PLUS_UNARY_OP:var Q=this.evaluateAst(e.value,t);return Q instanceof f.SimpleRangeValue?new o.CellError(o.ErrorType.VALUE,s.ErrorMessage.ScalarExpected):"number"==typeof Q?this.arithmeticHelper.unaryPlus(Q):Q;case c.AstNodeType.MINUS_UNARY_OP:var Z=this.evaluateAst(e.value,t);return Z instanceof f.SimpleRangeValue?new o.CellError(o.ErrorType.VALUE,s.ErrorMessage.ScalarExpected):E(this.arithmeticHelper.unaryMinus,this.arithmeticHelper.coerceScalarToNumberOrError(Z));case c.AstNodeType.PERCENT_OP:var J=this.evaluateAst(e.value,t);return J instanceof f.SimpleRangeValue?new o.CellError(o.ErrorType.VALUE,s.ErrorMessage.ScalarExpected):E(this.arithmeticHelper.unaryPercent,this.arithmeticHelper.coerceScalarToNumberOrError(J));case c.AstNodeType.FUNCTION_CALL:if("valid"!==this.config.licenseKeyValidityState&&!p.FunctionRegistry.functionIsProtected(e.procedureName))return new o.CellError(o.ErrorType.LIC,s.ErrorMessage.LicenseKey(this.config.licenseKeyValidityState));var ee=this.functionRegistry.getFunction(e.procedureName);if(ee&&this.config.translationPackage.isFunctionTranslated(e.procedureName)){var te=d(ee,2),re=te[0];return te[1][re](e,t)}return new o.CellError(o.ErrorType.NAME,s.ErrorMessage.FunctionName(e.procedureName));case c.AstNodeType.NAMED_EXPRESSION:var ne=this.namedExpressions.nearestNamedExpression(e.expressionName,t.sheet);return ne?this.dependencyGraph.getCellValue(ne.address):new o.CellError(o.ErrorType.NAME,s.ErrorMessage.NamedExpressionName(e.expressionName));case c.AstNodeType.CELL_RANGE:if(!this.rangeSpansOneSheet(e))return new o.CellError(o.ErrorType.REF,s.ErrorMessage.RangeManySheets);var ie=a.AbsoluteCellRange.fromCellRange(e,t),ae=this.dependencyGraph.getMatrix(ie);if(ae){var oe=ae.matrix;if(oe instanceof u.NotComputedMatrix)throw new Error("Matrix should be already computed");if(oe instanceof o.CellError)return oe;if(oe instanceof u.Matrix)return f.SimpleRangeValue.onlyNumbersDataWithRange(oe.raw(),oe.size,ie);throw new Error("Unknown matrix")}return f.SimpleRangeValue.onlyRange(ie,this.dependencyGraph);case c.AstNodeType.COLUMN_RANGE:if(!this.rangeSpansOneSheet(e))return new o.CellError(o.ErrorType.REF,s.ErrorMessage.RangeManySheets);var se=a.AbsoluteColumnRange.fromColumnRange(e,t);return f.SimpleRangeValue.onlyRange(se,this.dependencyGraph);case c.AstNodeType.ROW_RANGE:if(!this.rangeSpansOneSheet(e))return new o.CellError(o.ErrorType.REF,s.ErrorMessage.RangeManySheets);var ue=a.AbsoluteRowRange.fromRowRange(e,t);return f.SimpleRangeValue.onlyRange(ue,this.dependencyGraph);case c.AstNodeType.PARENTHESIS:return this.evaluateAst(e.expression,t);case c.AstNodeType.ERROR_WITH_RAW_INPUT:case c.AstNodeType.ERROR:return e.error}}},{key:"getGpuInstance",value:function(){if(!this.gpu){var e=i.default.GPU||i.default;this.gpu=new e({mode:this.config.gpuMode})}return this.gpu}},{key:"destroy",value:function(){this.gpu&&this.gpu.destroy()}},{key:"rangeSpansOneSheet",value:function(e){return e.start.sheet===e.end.sheet}}])&&y(t.prototype,r),n&&y(t,n),e}();function v(e,t){return e instanceof o.CellError?e:e instanceof f.SimpleRangeValue?new o.CellError(o.ErrorType.VALUE,s.ErrorMessage.ScalarExpected):t instanceof o.CellError?t:t instanceof f.SimpleRangeValue?new o.CellError(o.ErrorType.VALUE,s.ErrorMessage.ScalarExpected):void 0}function E(e,t){return t instanceof o.CellError?t:e(t)}function T(e,t,r){return t instanceof o.CellError?t:r instanceof o.CellError?r:e(t,r)}t.Interpreter=g},function(e,t,r){e.exports=function e(t,r,n){function i(o,s){if(!r[o]){if(!t[o]){if(a)return a(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[o]={exports:{}};t[o][0].call(c.exports,(function(e){return i(t[o][1][e]||e)}),c,c.exports,e,t,r,n)}return r[o].exports}for(var a=!1,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t,r){var n,i;n=this,i=function(e){"use strict";var t={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},r="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",n={5:r,"5module":r+" export import",6:r+" const class extends export import super"},i=/^in(stanceof)?$/,a="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙՠ-ֈא-תׯ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࡠ-ࡪࢠ-ࢴࢶ-ࢽऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱৼਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄຆ-ຊຌ-ຣລວ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡸᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᲐ-ᲺᲽ-Ჿᳩ-ᳬᳮ-ᳳᳵᳶᳺᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄯㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿯ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞿꟂ-Ᶎꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꣾꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭧꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",o="‌‍·̀-ͯ·҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-٩ٰۖ-ۜ۟-۪ۤۧۨ-ۭ۰-۹ܑܰ-݊ަ-ް߀-߉߫-߽߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛࣓-ࣣ࣡-ःऺ-़ा-ॏ॑-ॗॢॣ०-९ঁ-ঃ়া-ৄেৈো-্ৗৢৣ০-৯৾ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣ૦-૯ૺ-૿ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୢୣ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఀ-ఄా-ౄె-ైొ-్ౕౖౢౣ౦-౯ಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣ೦-೯ഀ-ഃ഻഼ാ-ൄെ-ൈൊ-്ൗൢൣ൦-൯ංඃ්ා-ුූෘ-ෟ෦-෯ෲෳัิ-ฺ็-๎๐-๙ັິ-ຼ່-ໍ໐-໙༘༙༠-༩༹༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှ၀-၉ၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟፩-፱ᜒ-᜔ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝០-៩᠋-᠍᠐-᠙ᢩᤠ-ᤫᤰ-᤻᥆-᥏᧐-᧚ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪰-᪽ᬀ-ᬄ᬴-᭄᭐-᭙᭫-᭳ᮀ-ᮂᮡ-ᮭ᮰-᮹᯦-᯳ᰤ-᰷᱀-᱉᱐-᱙᳐-᳔᳒-᳨᳭᳴᳷-᳹᷀-᷹᷻-᷿‿⁀⁔⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯꘠-꘩꙯ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧꢀꢁꢴ-ꣅ꣐-꣙꣠-꣱ꣿ-꤉ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀꧐-꧙ꧥ꧰-꧹ꨩ-ꨶꩃꩌꩍ꩐-꩙ꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭꯰-꯹ﬞ︀-️︠-︯︳︴﹍-﹏０-９＿",s=new RegExp("["+a+"]"),u=new RegExp("["+a+o+"]");a=o=null;var c=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,477,28,11,0,9,21,155,22,13,52,76,44,33,24,27,35,30,0,12,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,0,33,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,230,43,117,63,32,0,161,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,35,56,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,270,921,103,110,18,195,2749,1070,4050,582,8634,568,8,30,114,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,754,9486,286,50,2,18,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,2357,44,11,6,17,0,370,43,1301,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42710,42,4148,12,221,3,5761,15,7472,3104,541],l=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,525,10,176,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,4,9,83,11,7,0,161,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,232,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,19306,9,135,4,60,6,26,9,1014,0,2,54,8,3,19723,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,262,6,10,9,419,13,1495,6,110,6,6,9,792487,239];function h(e,t){for(var r=65536,n=0;n<t.length;n+=2){if((r+=t[n])>e)return!1;if((r+=t[n+1])>=e)return!0}}function p(e,t){return e<65?36===e:e<91||(e<97?95===e:e<123||(e<=65535?e>=170&&s.test(String.fromCharCode(e)):!1!==t&&h(e,c)))}function f(e,t){return e<48?36===e:e<58||!(e<65)&&(e<91||(e<97?95===e:e<123||(e<=65535?e>=170&&u.test(String.fromCharCode(e)):!1!==t&&(h(e,c)||h(e,l)))))}var d=function(e,t){void 0===t&&(t={}),this.label=e,this.keyword=t.keyword,this.beforeExpr=!!t.beforeExpr,this.startsExpr=!!t.startsExpr,this.isLoop=!!t.isLoop,this.isAssign=!!t.isAssign,this.prefix=!!t.prefix,this.postfix=!!t.postfix,this.binop=t.binop||null,this.updateContext=null};function m(e,t){return new d(e,{beforeExpr:!0,binop:t})}var y={beforeExpr:!0},g={startsExpr:!0},v={};function E(e,t){return void 0===t&&(t={}),t.keyword=e,v[e]=new d(e,t)}var T={num:new d("num",g),regexp:new d("regexp",g),string:new d("string",g),name:new d("name",g),eof:new d("eof"),bracketL:new d("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new d("]"),braceL:new d("{",{beforeExpr:!0,startsExpr:!0}),braceR:new d("}"),parenL:new d("(",{beforeExpr:!0,startsExpr:!0}),parenR:new d(")"),comma:new d(",",y),semi:new d(";",y),colon:new d(":",y),dot:new d("."),question:new d("?",y),arrow:new d("=>",y),template:new d("template"),invalidTemplate:new d("invalidTemplate"),ellipsis:new d("...",y),backQuote:new d("`",g),dollarBraceL:new d("${",{beforeExpr:!0,startsExpr:!0}),eq:new d("=",{beforeExpr:!0,isAssign:!0}),assign:new d("_=",{beforeExpr:!0,isAssign:!0}),incDec:new d("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new d("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:m("||",1),logicalAND:m("&&",2),bitwiseOR:m("|",3),bitwiseXOR:m("^",4),bitwiseAND:m("&",5),equality:m("==/!=/===/!==",6),relational:m("</>/<=/>=",7),bitShift:m("<</>>/>>>",8),plusMin:new d("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:m("%",10),star:m("*",10),slash:m("/",10),starstar:new d("**",{beforeExpr:!0}),_break:E("break"),_case:E("case",y),_catch:E("catch"),_continue:E("continue"),_debugger:E("debugger"),_default:E("default",y),_do:E("do",{isLoop:!0,beforeExpr:!0}),_else:E("else",y),_finally:E("finally"),_for:E("for",{isLoop:!0}),_function:E("function",g),_if:E("if"),_return:E("return",y),_switch:E("switch"),_throw:E("throw",y),_try:E("try"),_var:E("var"),_const:E("const"),_while:E("while",{isLoop:!0}),_with:E("with"),_new:E("new",{beforeExpr:!0,startsExpr:!0}),_this:E("this",g),_super:E("super",g),_class:E("class",g),_extends:E("extends",y),_export:E("export"),_import:E("import",g),_null:E("null",g),_true:E("true",g),_false:E("false",g),_in:E("in",{beforeExpr:!0,binop:7}),_instanceof:E("instanceof",{beforeExpr:!0,binop:7}),_typeof:E("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:E("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:E("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},b=/\r\n?|\n|\u2028|\u2029/,x=new RegExp(b.source,"g");function A(e,t){return 10===e||13===e||!t&&(8232===e||8233===e)}var S=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,R=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,w=Object.prototype,C=w.hasOwnProperty,O=w.toString;function k(e,t){return C.call(e,t)}var N=Array.isArray||function(e){return"[object Array]"===O.call(e)};function _(e){return new RegExp("^(?:"+e.replace(/ /g,"|")+")$")}var I=function(e,t){this.line=e,this.column=t};I.prototype.offset=function(e){return new I(this.line,this.column+e)};var M=function(e,t,r){this.start=t,this.end=r,null!==e.sourceFile&&(this.source=e.sourceFile)};function P(e,t){for(var r=1,n=0;;){x.lastIndex=n;var i=x.exec(e);if(!(i&&i.index<t))return new I(r,t-n);++r,n=i.index+i[0].length}}var L={ecmaVersion:10,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1};function F(e){var t={};for(var r in L)t[r]=e&&k(e,r)?e[r]:L[r];if(t.ecmaVersion>=2015&&(t.ecmaVersion-=2009),null==t.allowReserved&&(t.allowReserved=t.ecmaVersion<5),N(t.onToken)){var n=t.onToken;t.onToken=function(e){return n.push(e)}}return N(t.onComment)&&(t.onComment=function(e,t){return function(r,n,i,a,o,s){var u={type:r?"Block":"Line",value:n,start:i,end:a};e.locations&&(u.loc=new M(this,o,s)),e.ranges&&(u.range=[i,a]),t.push(u)}}(t,t.onComment)),t}function D(e,t){return 2|(e?4:0)|(t?8:0)}var U=function(e,r,i){this.options=e=F(e),this.sourceFile=e.sourceFile,this.keywords=_(n[e.ecmaVersion>=6?6:"module"===e.sourceType?"5module":5]);var a="";if(!0!==e.allowReserved){for(var o=e.ecmaVersion;!(a=t[o]);o--);"module"===e.sourceType&&(a+=" await")}this.reservedWords=_(a);var s=(a?a+" ":"")+t.strict;this.reservedWordsStrict=_(s),this.reservedWordsStrictBind=_(s+" "+t.strictBind),this.input=String(r),this.containsEsc=!1,i?(this.pos=i,this.lineStart=this.input.lastIndexOf("\n",i-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(b).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=T.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule="module"===e.sourceType,this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports={},0===this.pos&&e.allowHashBang&&"#!"===this.input.slice(0,2)&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(1),this.regexpState=null},V={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0}};U.prototype.parse=function(){var e=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(e)},V.inFunction.get=function(){return(2&this.currentVarScope().flags)>0},V.inGenerator.get=function(){return(8&this.currentVarScope().flags)>0},V.inAsync.get=function(){return(4&this.currentVarScope().flags)>0},V.allowSuper.get=function(){return(64&this.currentThisScope().flags)>0},V.allowDirectSuper.get=function(){return(128&this.currentThisScope().flags)>0},V.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},U.prototype.inNonArrowFunction=function(){return(2&this.currentThisScope().flags)>0},U.extend=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];for(var r=this,n=0;n<e.length;n++)r=e[n](r);return r},U.parse=function(e,t){return new this(t,e).parse()},U.parseExpressionAt=function(e,t,r){var n=new this(r,e,t);return n.nextToken(),n.parseExpression()},U.tokenizer=function(e,t){return new this(t,e)},Object.defineProperties(U.prototype,V);var j=U.prototype,G=/^(?:'((?:\\.|[^'])*?)'|"((?:\\.|[^"])*?)")/;function B(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1}j.strictDirective=function(e){for(;;){R.lastIndex=e,e+=R.exec(this.input)[0].length;var t=G.exec(this.input.slice(e));if(!t)return!1;if("use strict"===(t[1]||t[2]))return!0;e+=t[0].length,R.lastIndex=e,e+=R.exec(this.input)[0].length,";"===this.input[e]&&e++}},j.eat=function(e){return this.type===e&&(this.next(),!0)},j.isContextual=function(e){return this.type===T.name&&this.value===e&&!this.containsEsc},j.eatContextual=function(e){return!!this.isContextual(e)&&(this.next(),!0)},j.expectContextual=function(e){this.eatContextual(e)||this.unexpected()},j.canInsertSemicolon=function(){return this.type===T.eof||this.type===T.braceR||b.test(this.input.slice(this.lastTokEnd,this.start))},j.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},j.semicolon=function(){this.eat(T.semi)||this.insertSemicolon()||this.unexpected()},j.afterTrailingComma=function(e,t){if(this.type===e)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),t||this.next(),!0},j.expect=function(e){this.eat(e)||this.unexpected()},j.unexpected=function(e){this.raise(null!=e?e:this.start,"Unexpected token")},j.checkPatternErrors=function(e,t){if(e){e.trailingComma>-1&&this.raiseRecoverable(e.trailingComma,"Comma is not permitted after the rest element");var r=t?e.parenthesizedAssign:e.parenthesizedBind;r>-1&&this.raiseRecoverable(r,"Parenthesized pattern")}},j.checkExpressionErrors=function(e,t){if(!e)return!1;var r=e.shorthandAssign,n=e.doubleProto;if(!t)return r>=0||n>=0;r>=0&&this.raise(r,"Shorthand property assignments are valid only in destructuring patterns"),n>=0&&this.raiseRecoverable(n,"Redefinition of __proto__ property")},j.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},j.isSimpleAssignTarget=function(e){return"ParenthesizedExpression"===e.type?this.isSimpleAssignTarget(e.expression):"Identifier"===e.type||"MemberExpression"===e.type};var z=U.prototype;z.parseTopLevel=function(e){var t={};for(e.body||(e.body=[]);this.type!==T.eof;){var r=this.parseStatement(null,!0,t);e.body.push(r)}if(this.inModule)for(var n=0,i=Object.keys(this.undefinedExports);n<i.length;n+=1){var a=i[n];this.raiseRecoverable(this.undefinedExports[a].start,"Export '"+a+"' is not defined")}return this.adaptDirectivePrologue(e.body),this.next(),e.sourceType=this.options.sourceType,this.finishNode(e,"Program")};var W={kind:"loop"},K={kind:"switch"};z.isLet=function(e){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;R.lastIndex=this.pos;var t=R.exec(this.input),r=this.pos+t[0].length,n=this.input.charCodeAt(r);if(91===n)return!0;if(e)return!1;if(123===n)return!0;if(p(n,!0)){for(var a=r+1;f(this.input.charCodeAt(a),!0);)++a;var o=this.input.slice(r,a);if(!i.test(o))return!0}return!1},z.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;R.lastIndex=this.pos;var e=R.exec(this.input),t=this.pos+e[0].length;return!(b.test(this.input.slice(this.pos,t))||"function"!==this.input.slice(t,t+8)||t+8!==this.input.length&&f(this.input.charAt(t+8)))},z.parseStatement=function(e,t,r){var n,i=this.type,a=this.startNode();switch(this.isLet(e)&&(i=T._var,n="let"),i){case T._break:case T._continue:return this.parseBreakContinueStatement(a,i.keyword);case T._debugger:return this.parseDebuggerStatement(a);case T._do:return this.parseDoStatement(a);case T._for:return this.parseForStatement(a);case T._function:return e&&(this.strict||"if"!==e&&"label"!==e)&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(a,!1,!e);case T._class:return e&&this.unexpected(),this.parseClass(a,!0);case T._if:return this.parseIfStatement(a);case T._return:return this.parseReturnStatement(a);case T._switch:return this.parseSwitchStatement(a);case T._throw:return this.parseThrowStatement(a);case T._try:return this.parseTryStatement(a);case T._const:case T._var:return n=n||this.value,e&&"var"!==n&&this.unexpected(),this.parseVarStatement(a,n);case T._while:return this.parseWhileStatement(a);case T._with:return this.parseWithStatement(a);case T.braceL:return this.parseBlock(!0,a);case T.semi:return this.parseEmptyStatement(a);case T._export:case T._import:if(this.options.ecmaVersion>10&&i===T._import){R.lastIndex=this.pos;var o=R.exec(this.input),s=this.pos+o[0].length;if(40===this.input.charCodeAt(s))return this.parseExpressionStatement(a,this.parseExpression())}return this.options.allowImportExportEverywhere||(t||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),i===T._import?this.parseImport(a):this.parseExport(a,r);default:if(this.isAsyncFunction())return e&&this.unexpected(),this.next(),this.parseFunctionStatement(a,!0,!e);var u=this.value,c=this.parseExpression();return i===T.name&&"Identifier"===c.type&&this.eat(T.colon)?this.parseLabeledStatement(a,u,c,e):this.parseExpressionStatement(a,c)}},z.parseBreakContinueStatement=function(e,t){var r="break"===t;this.next(),this.eat(T.semi)||this.insertSemicolon()?e.label=null:this.type!==T.name?this.unexpected():(e.label=this.parseIdent(),this.semicolon());for(var n=0;n<this.labels.length;++n){var i=this.labels[n];if(null==e.label||i.name===e.label.name){if(null!=i.kind&&(r||"loop"===i.kind))break;if(e.label&&r)break}}return n===this.labels.length&&this.raise(e.start,"Unsyntactic "+t),this.finishNode(e,r?"BreakStatement":"ContinueStatement")},z.parseDebuggerStatement=function(e){return this.next(),this.semicolon(),this.finishNode(e,"DebuggerStatement")},z.parseDoStatement=function(e){return this.next(),this.labels.push(W),e.body=this.parseStatement("do"),this.labels.pop(),this.expect(T._while),e.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(T.semi):this.semicolon(),this.finishNode(e,"DoWhileStatement")},z.parseForStatement=function(e){this.next();var t=this.options.ecmaVersion>=9&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction)&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(W),this.enterScope(0),this.expect(T.parenL),this.type===T.semi)return t>-1&&this.unexpected(t),this.parseFor(e,null);var r=this.isLet();if(this.type===T._var||this.type===T._const||r){var n=this.startNode(),i=r?"let":this.value;return this.next(),this.parseVar(n,!0,i),this.finishNode(n,"VariableDeclaration"),(this.type===T._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&1===n.declarations.length?(this.options.ecmaVersion>=9&&(this.type===T._in?t>-1&&this.unexpected(t):e.await=t>-1),this.parseForIn(e,n)):(t>-1&&this.unexpected(t),this.parseFor(e,n))}var a=new B,o=this.parseExpression(!0,a);return this.type===T._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.options.ecmaVersion>=9&&(this.type===T._in?t>-1&&this.unexpected(t):e.await=t>-1),this.toAssignable(o,!1,a),this.checkLVal(o),this.parseForIn(e,o)):(this.checkExpressionErrors(a,!0),t>-1&&this.unexpected(t),this.parseFor(e,o))},z.parseFunctionStatement=function(e,t,r){return this.next(),this.parseFunction(e,X|(r?0:Y),!1,t)},z.parseIfStatement=function(e){return this.next(),e.test=this.parseParenExpression(),e.consequent=this.parseStatement("if"),e.alternate=this.eat(T._else)?this.parseStatement("if"):null,this.finishNode(e,"IfStatement")},z.parseReturnStatement=function(e){return this.inFunction||this.options.allowReturnOutsideFunction||this.raise(this.start,"'return' outside of function"),this.next(),this.eat(T.semi)||this.insertSemicolon()?e.argument=null:(e.argument=this.parseExpression(),this.semicolon()),this.finishNode(e,"ReturnStatement")},z.parseSwitchStatement=function(e){var t;this.next(),e.discriminant=this.parseParenExpression(),e.cases=[],this.expect(T.braceL),this.labels.push(K),this.enterScope(0);for(var r=!1;this.type!==T.braceR;)if(this.type===T._case||this.type===T._default){var n=this.type===T._case;t&&this.finishNode(t,"SwitchCase"),e.cases.push(t=this.startNode()),t.consequent=[],this.next(),n?t.test=this.parseExpression():(r&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),r=!0,t.test=null),this.expect(T.colon)}else t||this.unexpected(),t.consequent.push(this.parseStatement(null));return this.exitScope(),t&&this.finishNode(t,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(e,"SwitchStatement")},z.parseThrowStatement=function(e){return this.next(),b.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),e.argument=this.parseExpression(),this.semicolon(),this.finishNode(e,"ThrowStatement")};var H=[];z.parseTryStatement=function(e){if(this.next(),e.block=this.parseBlock(),e.handler=null,this.type===T._catch){var t=this.startNode();if(this.next(),this.eat(T.parenL)){t.param=this.parseBindingAtom();var r="Identifier"===t.param.type;this.enterScope(r?32:0),this.checkLVal(t.param,r?4:2),this.expect(T.parenR)}else this.options.ecmaVersion<10&&this.unexpected(),t.param=null,this.enterScope(0);t.body=this.parseBlock(!1),this.exitScope(),e.handler=this.finishNode(t,"CatchClause")}return e.finalizer=this.eat(T._finally)?this.parseBlock():null,e.handler||e.finalizer||this.raise(e.start,"Missing catch or finally clause"),this.finishNode(e,"TryStatement")},z.parseVarStatement=function(e,t){return this.next(),this.parseVar(e,!1,t),this.semicolon(),this.finishNode(e,"VariableDeclaration")},z.parseWhileStatement=function(e){return this.next(),e.test=this.parseParenExpression(),this.labels.push(W),e.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(e,"WhileStatement")},z.parseWithStatement=function(e){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),e.object=this.parseParenExpression(),e.body=this.parseStatement("with"),this.finishNode(e,"WithStatement")},z.parseEmptyStatement=function(e){return this.next(),this.finishNode(e,"EmptyStatement")},z.parseLabeledStatement=function(e,t,r,n){for(var i=0,a=this.labels;i<a.length;i+=1)a[i].name===t&&this.raise(r.start,"Label '"+t+"' is already declared");for(var o=this.type.isLoop?"loop":this.type===T._switch?"switch":null,s=this.labels.length-1;s>=0;s--){var u=this.labels[s];if(u.statementStart!==e.start)break;u.statementStart=this.start,u.kind=o}return this.labels.push({name:t,kind:o,statementStart:this.start}),e.body=this.parseStatement(n?-1===n.indexOf("label")?n+"label":n:"label"),this.labels.pop(),e.label=r,this.finishNode(e,"LabeledStatement")},z.parseExpressionStatement=function(e,t){return e.expression=t,this.semicolon(),this.finishNode(e,"ExpressionStatement")},z.parseBlock=function(e,t){for(void 0===e&&(e=!0),void 0===t&&(t=this.startNode()),t.body=[],this.expect(T.braceL),e&&this.enterScope(0);!this.eat(T.braceR);){var r=this.parseStatement(null);t.body.push(r)}return e&&this.exitScope(),this.finishNode(t,"BlockStatement")},z.parseFor=function(e,t){return e.init=t,this.expect(T.semi),e.test=this.type===T.semi?null:this.parseExpression(),this.expect(T.semi),e.update=this.type===T.parenR?null:this.parseExpression(),this.expect(T.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,"ForStatement")},z.parseForIn=function(e,t){var r=this.type===T._in;return this.next(),"VariableDeclaration"===t.type&&null!=t.declarations[0].init&&(!r||this.options.ecmaVersion<8||this.strict||"var"!==t.kind||"Identifier"!==t.declarations[0].id.type)?this.raise(t.start,(r?"for-in":"for-of")+" loop variable declaration may not have an initializer"):"AssignmentPattern"===t.type&&this.raise(t.start,"Invalid left-hand side in for-loop"),e.left=t,e.right=r?this.parseExpression():this.parseMaybeAssign(),this.expect(T.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,r?"ForInStatement":"ForOfStatement")},z.parseVar=function(e,t,r){for(e.declarations=[],e.kind=r;;){var n=this.startNode();if(this.parseVarId(n,r),this.eat(T.eq)?n.init=this.parseMaybeAssign(t):"const"!==r||this.type===T._in||this.options.ecmaVersion>=6&&this.isContextual("of")?"Identifier"===n.id.type||t&&(this.type===T._in||this.isContextual("of"))?n.init=null:this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):this.unexpected(),e.declarations.push(this.finishNode(n,"VariableDeclarator")),!this.eat(T.comma))break}return e},z.parseVarId=function(e,t){e.id=this.parseBindingAtom(),this.checkLVal(e.id,"var"===t?1:2,!1)};var X=1,Y=2;z.parseFunction=function(e,t,r,n){this.initFunction(e),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!n)&&(this.type===T.star&&t&Y&&this.unexpected(),e.generator=this.eat(T.star)),this.options.ecmaVersion>=8&&(e.async=!!n),t&X&&(e.id=4&t&&this.type!==T.name?null:this.parseIdent(),!e.id||t&Y||this.checkLVal(e.id,this.strict||e.generator||e.async?this.treatFunctionsAsVar?1:2:3));var i=this.yieldPos,a=this.awaitPos,o=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(D(e.async,e.generator)),t&X||(e.id=this.type===T.name?this.parseIdent():null),this.parseFunctionParams(e),this.parseFunctionBody(e,r,!1),this.yieldPos=i,this.awaitPos=a,this.awaitIdentPos=o,this.finishNode(e,t&X?"FunctionDeclaration":"FunctionExpression")},z.parseFunctionParams=function(e){this.expect(T.parenL),e.params=this.parseBindingList(T.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},z.parseClass=function(e,t){this.next();var r=this.strict;this.strict=!0,this.parseClassId(e,t),this.parseClassSuper(e);var n=this.startNode(),i=!1;for(n.body=[],this.expect(T.braceL);!this.eat(T.braceR);){var a=this.parseClassElement(null!==e.superClass);a&&(n.body.push(a),"MethodDefinition"===a.type&&"constructor"===a.kind&&(i&&this.raise(a.start,"Duplicate constructor in the same class"),i=!0))}return e.body=this.finishNode(n,"ClassBody"),this.strict=r,this.finishNode(e,t?"ClassDeclaration":"ClassExpression")},z.parseClassElement=function(e){var t=this;if(this.eat(T.semi))return null;var r=this.startNode(),n=function(e,n){void 0===n&&(n=!1);var i=t.start,a=t.startLoc;return!(!t.eatContextual(e)||(t.type===T.parenL||n&&t.canInsertSemicolon())&&(r.key&&t.unexpected(),r.computed=!1,r.key=t.startNodeAt(i,a),r.key.name=e,t.finishNode(r.key,"Identifier"),1))};r.kind="method",r.static=n("static");var i=this.eat(T.star),a=!1;i||(this.options.ecmaVersion>=8&&n("async",!0)?(a=!0,i=this.options.ecmaVersion>=9&&this.eat(T.star)):n("get")?r.kind="get":n("set")&&(r.kind="set")),r.key||this.parsePropertyName(r);var o=r.key,s=!1;return r.computed||r.static||!("Identifier"===o.type&&"constructor"===o.name||"Literal"===o.type&&"constructor"===o.value)?r.static&&"Identifier"===o.type&&"prototype"===o.name&&this.raise(o.start,"Classes may not have a static property named prototype"):("method"!==r.kind&&this.raise(o.start,"Constructor can't have get/set modifier"),i&&this.raise(o.start,"Constructor can't be a generator"),a&&this.raise(o.start,"Constructor can't be an async method"),r.kind="constructor",s=e),this.parseClassMethod(r,i,a,s),"get"===r.kind&&0!==r.value.params.length&&this.raiseRecoverable(r.value.start,"getter should have no params"),"set"===r.kind&&1!==r.value.params.length&&this.raiseRecoverable(r.value.start,"setter should have exactly one param"),"set"===r.kind&&"RestElement"===r.value.params[0].type&&this.raiseRecoverable(r.value.params[0].start,"Setter cannot use rest params"),r},z.parseClassMethod=function(e,t,r,n){return e.value=this.parseMethod(t,r,n),this.finishNode(e,"MethodDefinition")},z.parseClassId=function(e,t){this.type===T.name?(e.id=this.parseIdent(),t&&this.checkLVal(e.id,2,!1)):(!0===t&&this.unexpected(),e.id=null)},z.parseClassSuper=function(e){e.superClass=this.eat(T._extends)?this.parseExprSubscripts():null},z.parseExport=function(e,t){if(this.next(),this.eat(T.star))return this.expectContextual("from"),this.type!==T.string&&this.unexpected(),e.source=this.parseExprAtom(),this.semicolon(),this.finishNode(e,"ExportAllDeclaration");if(this.eat(T._default)){var r;if(this.checkExport(t,"default",this.lastTokStart),this.type===T._function||(r=this.isAsyncFunction())){var n=this.startNode();this.next(),r&&this.next(),e.declaration=this.parseFunction(n,4|X,!1,r)}else if(this.type===T._class){var i=this.startNode();e.declaration=this.parseClass(i,"nullableID")}else e.declaration=this.parseMaybeAssign(),this.semicolon();return this.finishNode(e,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())e.declaration=this.parseStatement(null),"VariableDeclaration"===e.declaration.type?this.checkVariableExport(t,e.declaration.declarations):this.checkExport(t,e.declaration.id.name,e.declaration.id.start),e.specifiers=[],e.source=null;else{if(e.declaration=null,e.specifiers=this.parseExportSpecifiers(t),this.eatContextual("from"))this.type!==T.string&&this.unexpected(),e.source=this.parseExprAtom();else{for(var a=0,o=e.specifiers;a<o.length;a+=1){var s=o[a];this.checkUnreserved(s.local),this.checkLocalExport(s.local)}e.source=null}this.semicolon()}return this.finishNode(e,"ExportNamedDeclaration")},z.checkExport=function(e,t,r){e&&(k(e,t)&&this.raiseRecoverable(r,"Duplicate export '"+t+"'"),e[t]=!0)},z.checkPatternExport=function(e,t){var r=t.type;if("Identifier"===r)this.checkExport(e,t.name,t.start);else if("ObjectPattern"===r)for(var n=0,i=t.properties;n<i.length;n+=1){var a=i[n];this.checkPatternExport(e,a)}else if("ArrayPattern"===r)for(var o=0,s=t.elements;o<s.length;o+=1){var u=s[o];u&&this.checkPatternExport(e,u)}else"Property"===r?this.checkPatternExport(e,t.value):"AssignmentPattern"===r?this.checkPatternExport(e,t.left):"RestElement"===r?this.checkPatternExport(e,t.argument):"ParenthesizedExpression"===r&&this.checkPatternExport(e,t.expression)},z.checkVariableExport=function(e,t){if(e)for(var r=0,n=t;r<n.length;r+=1){var i=n[r];this.checkPatternExport(e,i.id)}},z.shouldParseExportStatement=function(){return"var"===this.type.keyword||"const"===this.type.keyword||"class"===this.type.keyword||"function"===this.type.keyword||this.isLet()||this.isAsyncFunction()},z.parseExportSpecifiers=function(e){var t=[],r=!0;for(this.expect(T.braceL);!this.eat(T.braceR);){if(r)r=!1;else if(this.expect(T.comma),this.afterTrailingComma(T.braceR))break;var n=this.startNode();n.local=this.parseIdent(!0),n.exported=this.eatContextual("as")?this.parseIdent(!0):n.local,this.checkExport(e,n.exported.name,n.exported.start),t.push(this.finishNode(n,"ExportSpecifier"))}return t},z.parseImport=function(e){return this.next(),this.type===T.string?(e.specifiers=H,e.source=this.parseExprAtom()):(e.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),e.source=this.type===T.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(e,"ImportDeclaration")},z.parseImportSpecifiers=function(){var e=[],t=!0;if(this.type===T.name){var r=this.startNode();if(r.local=this.parseIdent(),this.checkLVal(r.local,2),e.push(this.finishNode(r,"ImportDefaultSpecifier")),!this.eat(T.comma))return e}if(this.type===T.star){var n=this.startNode();return this.next(),this.expectContextual("as"),n.local=this.parseIdent(),this.checkLVal(n.local,2),e.push(this.finishNode(n,"ImportNamespaceSpecifier")),e}for(this.expect(T.braceL);!this.eat(T.braceR);){if(t)t=!1;else if(this.expect(T.comma),this.afterTrailingComma(T.braceR))break;var i=this.startNode();i.imported=this.parseIdent(!0),this.eatContextual("as")?i.local=this.parseIdent():(this.checkUnreserved(i.imported),i.local=i.imported),this.checkLVal(i.local,2),e.push(this.finishNode(i,"ImportSpecifier"))}return e},z.adaptDirectivePrologue=function(e){for(var t=0;t<e.length&&this.isDirectiveCandidate(e[t]);++t)e[t].directive=e[t].expression.raw.slice(1,-1)},z.isDirectiveCandidate=function(e){return"ExpressionStatement"===e.type&&"Literal"===e.expression.type&&"string"==typeof e.expression.value&&('"'===this.input[e.start]||"'"===this.input[e.start])};var q=U.prototype;q.toAssignable=function(e,t,r){if(this.options.ecmaVersion>=6&&e)switch(e.type){case"Identifier":this.inAsync&&"await"===e.name&&this.raise(e.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"RestElement":break;case"ObjectExpression":e.type="ObjectPattern",r&&this.checkPatternErrors(r,!0);for(var n=0,i=e.properties;n<i.length;n+=1){var a=i[n];this.toAssignable(a,t),"RestElement"!==a.type||"ArrayPattern"!==a.argument.type&&"ObjectPattern"!==a.argument.type||this.raise(a.argument.start,"Unexpected token")}break;case"Property":"init"!==e.kind&&this.raise(e.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(e.value,t);break;case"ArrayExpression":e.type="ArrayPattern",r&&this.checkPatternErrors(r,!0),this.toAssignableList(e.elements,t);break;case"SpreadElement":e.type="RestElement",this.toAssignable(e.argument,t),"AssignmentPattern"===e.argument.type&&this.raise(e.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":"="!==e.operator&&this.raise(e.left.end,"Only '=' operator can be used for specifying default value."),e.type="AssignmentPattern",delete e.operator,this.toAssignable(e.left,t);case"AssignmentPattern":break;case"ParenthesizedExpression":this.toAssignable(e.expression,t,r);break;case"MemberExpression":if(!t)break;default:this.raise(e.start,"Assigning to rvalue")}else r&&this.checkPatternErrors(r,!0);return e},q.toAssignableList=function(e,t){for(var r=e.length,n=0;n<r;n++){var i=e[n];i&&this.toAssignable(i,t)}if(r){var a=e[r-1];6===this.options.ecmaVersion&&t&&a&&"RestElement"===a.type&&"Identifier"!==a.argument.type&&this.unexpected(a.argument.start)}return e},q.parseSpread=function(e){var t=this.startNode();return this.next(),t.argument=this.parseMaybeAssign(!1,e),this.finishNode(t,"SpreadElement")},q.parseRestBinding=function(){var e=this.startNode();return this.next(),6===this.options.ecmaVersion&&this.type!==T.name&&this.unexpected(),e.argument=this.parseBindingAtom(),this.finishNode(e,"RestElement")},q.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case T.bracketL:var e=this.startNode();return this.next(),e.elements=this.parseBindingList(T.bracketR,!0,!0),this.finishNode(e,"ArrayPattern");case T.braceL:return this.parseObj(!0)}return this.parseIdent()},q.parseBindingList=function(e,t,r){for(var n=[],i=!0;!this.eat(e);)if(i?i=!1:this.expect(T.comma),t&&this.type===T.comma)n.push(null);else{if(r&&this.afterTrailingComma(e))break;if(this.type===T.ellipsis){var a=this.parseRestBinding();this.parseBindingListItem(a),n.push(a),this.type===T.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.expect(e);break}var o=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(o),n.push(o)}return n},q.parseBindingListItem=function(e){return e},q.parseMaybeDefault=function(e,t,r){if(r=r||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(T.eq))return r;var n=this.startNodeAt(e,t);return n.left=r,n.right=this.parseMaybeAssign(),this.finishNode(n,"AssignmentPattern")},q.checkLVal=function(e,t,r){switch(void 0===t&&(t=0),e.type){case"Identifier":2===t&&"let"===e.name&&this.raiseRecoverable(e.start,"let is disallowed as a lexically bound name"),this.strict&&this.reservedWordsStrictBind.test(e.name)&&this.raiseRecoverable(e.start,(t?"Binding ":"Assigning to ")+e.name+" in strict mode"),r&&(k(r,e.name)&&this.raiseRecoverable(e.start,"Argument name clash"),r[e.name]=!0),0!==t&&5!==t&&this.declareName(e.name,t,e.start);break;case"MemberExpression":t&&this.raiseRecoverable(e.start,"Binding member expression");break;case"ObjectPattern":for(var n=0,i=e.properties;n<i.length;n+=1){var a=i[n];this.checkLVal(a,t,r)}break;case"Property":this.checkLVal(e.value,t,r);break;case"ArrayPattern":for(var o=0,s=e.elements;o<s.length;o+=1){var u=s[o];u&&this.checkLVal(u,t,r)}break;case"AssignmentPattern":this.checkLVal(e.left,t,r);break;case"RestElement":this.checkLVal(e.argument,t,r);break;case"ParenthesizedExpression":this.checkLVal(e.expression,t,r);break;default:this.raise(e.start,(t?"Binding":"Assigning to")+" rvalue")}};var $=U.prototype;$.checkPropClash=function(e,t,r){if(!(this.options.ecmaVersion>=9&&"SpreadElement"===e.type||this.options.ecmaVersion>=6&&(e.computed||e.method||e.shorthand))){var n,i=e.key;switch(i.type){case"Identifier":n=i.name;break;case"Literal":n=String(i.value);break;default:return}var a=e.kind;if(this.options.ecmaVersion>=6)"__proto__"===n&&"init"===a&&(t.proto&&(r&&r.doubleProto<0?r.doubleProto=i.start:this.raiseRecoverable(i.start,"Redefinition of __proto__ property")),t.proto=!0);else{var o=t[n="$"+n];o?("init"===a?this.strict&&o.init||o.get||o.set:o.init||o[a])&&this.raiseRecoverable(i.start,"Redefinition of property"):o=t[n]={init:!1,get:!1,set:!1},o[a]=!0}}},$.parseExpression=function(e,t){var r=this.start,n=this.startLoc,i=this.parseMaybeAssign(e,t);if(this.type===T.comma){var a=this.startNodeAt(r,n);for(a.expressions=[i];this.eat(T.comma);)a.expressions.push(this.parseMaybeAssign(e,t));return this.finishNode(a,"SequenceExpression")}return i},$.parseMaybeAssign=function(e,t,r){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(e);this.exprAllowed=!1}var n=!1,i=-1,a=-1,o=-1;t?(i=t.parenthesizedAssign,a=t.trailingComma,o=t.shorthandAssign,t.parenthesizedAssign=t.trailingComma=t.shorthandAssign=-1):(t=new B,n=!0);var s=this.start,u=this.startLoc;this.type!==T.parenL&&this.type!==T.name||(this.potentialArrowAt=this.start);var c=this.parseMaybeConditional(e,t);if(r&&(c=r.call(this,c,s,u)),this.type.isAssign){var l=this.startNodeAt(s,u);return l.operator=this.value,l.left=this.type===T.eq?this.toAssignable(c,!1,t):c,n||B.call(t),t.shorthandAssign=-1,this.checkLVal(c),this.next(),l.right=this.parseMaybeAssign(e),this.finishNode(l,"AssignmentExpression")}return n&&this.checkExpressionErrors(t,!0),i>-1&&(t.parenthesizedAssign=i),a>-1&&(t.trailingComma=a),o>-1&&(t.shorthandAssign=o),c},$.parseMaybeConditional=function(e,t){var r=this.start,n=this.startLoc,i=this.parseExprOps(e,t);if(this.checkExpressionErrors(t))return i;if(this.eat(T.question)){var a=this.startNodeAt(r,n);return a.test=i,a.consequent=this.parseMaybeAssign(),this.expect(T.colon),a.alternate=this.parseMaybeAssign(e),this.finishNode(a,"ConditionalExpression")}return i},$.parseExprOps=function(e,t){var r=this.start,n=this.startLoc,i=this.parseMaybeUnary(t,!1);return this.checkExpressionErrors(t)||i.start===r&&"ArrowFunctionExpression"===i.type?i:this.parseExprOp(i,r,n,-1,e)},$.parseExprOp=function(e,t,r,n,i){var a=this.type.binop;if(null!=a&&(!i||this.type!==T._in)&&a>n){var o=this.type===T.logicalOR||this.type===T.logicalAND,s=this.value;this.next();var u=this.start,c=this.startLoc,l=this.parseExprOp(this.parseMaybeUnary(null,!1),u,c,a,i),h=this.buildBinary(t,r,e,l,s,o);return this.parseExprOp(h,t,r,n,i)}return e},$.buildBinary=function(e,t,r,n,i,a){var o=this.startNodeAt(e,t);return o.left=r,o.operator=i,o.right=n,this.finishNode(o,a?"LogicalExpression":"BinaryExpression")},$.parseMaybeUnary=function(e,t){var r,n=this.start,i=this.startLoc;if(this.isContextual("await")&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction))r=this.parseAwait(),t=!0;else if(this.type.prefix){var a=this.startNode(),o=this.type===T.incDec;a.operator=this.value,a.prefix=!0,this.next(),a.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(e,!0),o?this.checkLVal(a.argument):this.strict&&"delete"===a.operator&&"Identifier"===a.argument.type?this.raiseRecoverable(a.start,"Deleting local variable in strict mode"):t=!0,r=this.finishNode(a,o?"UpdateExpression":"UnaryExpression")}else{if(r=this.parseExprSubscripts(e),this.checkExpressionErrors(e))return r;for(;this.type.postfix&&!this.canInsertSemicolon();){var s=this.startNodeAt(n,i);s.operator=this.value,s.prefix=!1,s.argument=r,this.checkLVal(r),this.next(),r=this.finishNode(s,"UpdateExpression")}}return!t&&this.eat(T.starstar)?this.buildBinary(n,i,r,this.parseMaybeUnary(null,!1),"**",!1):r},$.parseExprSubscripts=function(e){var t=this.start,r=this.startLoc,n=this.parseExprAtom(e),i="ArrowFunctionExpression"===n.type&&")"!==this.input.slice(this.lastTokStart,this.lastTokEnd);if(this.checkExpressionErrors(e)||i)return n;var a=this.parseSubscripts(n,t,r);return e&&"MemberExpression"===a.type&&(e.parenthesizedAssign>=a.start&&(e.parenthesizedAssign=-1),e.parenthesizedBind>=a.start&&(e.parenthesizedBind=-1)),a},$.parseSubscripts=function(e,t,r,n){for(var i=this.options.ecmaVersion>=8&&"Identifier"===e.type&&"async"===e.name&&this.lastTokEnd===e.end&&!this.canInsertSemicolon()&&"async"===this.input.slice(e.start,e.end);;){var a=this.parseSubscript(e,t,r,n,i);if(a===e||"ArrowFunctionExpression"===a.type)return a;e=a}},$.parseSubscript=function(e,t,r,n,i){var a=this.eat(T.bracketL);if(a||this.eat(T.dot)){var o=this.startNodeAt(t,r);o.object=e,o.property=a?this.parseExpression():this.parseIdent("never"!==this.options.allowReserved),o.computed=!!a,a&&this.expect(T.bracketR),e=this.finishNode(o,"MemberExpression")}else if(!n&&this.eat(T.parenL)){var s=new B,u=this.yieldPos,c=this.awaitPos,l=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var h=this.parseExprList(T.parenR,this.options.ecmaVersion>=8,!1,s);if(i&&!this.canInsertSemicolon()&&this.eat(T.arrow))return this.checkPatternErrors(s,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=u,this.awaitPos=c,this.awaitIdentPos=l,this.parseArrowExpression(this.startNodeAt(t,r),h,!0);this.checkExpressionErrors(s,!0),this.yieldPos=u||this.yieldPos,this.awaitPos=c||this.awaitPos,this.awaitIdentPos=l||this.awaitIdentPos;var p=this.startNodeAt(t,r);p.callee=e,p.arguments=h,e=this.finishNode(p,"CallExpression")}else if(this.type===T.backQuote){var f=this.startNodeAt(t,r);f.tag=e,f.quasi=this.parseTemplate({isTagged:!0}),e=this.finishNode(f,"TaggedTemplateExpression")}return e},$.parseExprAtom=function(e){this.type===T.slash&&this.readRegexp();var t,r=this.potentialArrowAt===this.start;switch(this.type){case T._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),t=this.startNode(),this.next(),this.type!==T.parenL||this.allowDirectSuper||this.raise(t.start,"super() call outside constructor of a subclass"),this.type!==T.dot&&this.type!==T.bracketL&&this.type!==T.parenL&&this.unexpected(),this.finishNode(t,"Super");case T._this:return t=this.startNode(),this.next(),this.finishNode(t,"ThisExpression");case T.name:var n=this.start,i=this.startLoc,a=this.containsEsc,o=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!a&&"async"===o.name&&!this.canInsertSemicolon()&&this.eat(T._function))return this.parseFunction(this.startNodeAt(n,i),0,!1,!0);if(r&&!this.canInsertSemicolon()){if(this.eat(T.arrow))return this.parseArrowExpression(this.startNodeAt(n,i),[o],!1);if(this.options.ecmaVersion>=8&&"async"===o.name&&this.type===T.name&&!a)return o=this.parseIdent(!1),!this.canInsertSemicolon()&&this.eat(T.arrow)||this.unexpected(),this.parseArrowExpression(this.startNodeAt(n,i),[o],!0)}return o;case T.regexp:var s=this.value;return(t=this.parseLiteral(s.value)).regex={pattern:s.pattern,flags:s.flags},t;case T.num:case T.string:return this.parseLiteral(this.value);case T._null:case T._true:case T._false:return(t=this.startNode()).value=this.type===T._null?null:this.type===T._true,t.raw=this.type.keyword,this.next(),this.finishNode(t,"Literal");case T.parenL:var u=this.start,c=this.parseParenAndDistinguishExpression(r);return e&&(e.parenthesizedAssign<0&&!this.isSimpleAssignTarget(c)&&(e.parenthesizedAssign=u),e.parenthesizedBind<0&&(e.parenthesizedBind=u)),c;case T.bracketL:return t=this.startNode(),this.next(),t.elements=this.parseExprList(T.bracketR,!0,!0,e),this.finishNode(t,"ArrayExpression");case T.braceL:return this.parseObj(!1,e);case T._function:return t=this.startNode(),this.next(),this.parseFunction(t,0);case T._class:return this.parseClass(this.startNode(),!1);case T._new:return this.parseNew();case T.backQuote:return this.parseTemplate();case T._import:return this.options.ecmaVersion>=11?this.parseExprImport():this.unexpected();default:this.unexpected()}},$.parseExprImport=function(){var e=this.startNode();switch(this.next(),this.type){case T.parenL:return this.parseDynamicImport(e);default:this.unexpected()}},$.parseDynamicImport=function(e){if(this.next(),e.source=this.parseMaybeAssign(),!this.eat(T.parenR)){var t=this.start;this.eat(T.comma)&&this.eat(T.parenR)?this.raiseRecoverable(t,"Trailing comma is not allowed in import()"):this.unexpected(t)}return this.finishNode(e,"ImportExpression")},$.parseLiteral=function(e){var t=this.startNode();return t.value=e,t.raw=this.input.slice(this.start,this.end),110===t.raw.charCodeAt(t.raw.length-1)&&(t.bigint=t.raw.slice(0,-1)),this.next(),this.finishNode(t,"Literal")},$.parseParenExpression=function(){this.expect(T.parenL);var e=this.parseExpression();return this.expect(T.parenR),e},$.parseParenAndDistinguishExpression=function(e){var t,r=this.start,n=this.startLoc,i=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var a,o=this.start,s=this.startLoc,u=[],c=!0,l=!1,h=new B,p=this.yieldPos,f=this.awaitPos;for(this.yieldPos=0,this.awaitPos=0;this.type!==T.parenR;){if(c?c=!1:this.expect(T.comma),i&&this.afterTrailingComma(T.parenR,!0)){l=!0;break}if(this.type===T.ellipsis){a=this.start,u.push(this.parseParenItem(this.parseRestBinding())),this.type===T.comma&&this.raise(this.start,"Comma is not permitted after the rest element");break}u.push(this.parseMaybeAssign(!1,h,this.parseParenItem))}var d=this.start,m=this.startLoc;if(this.expect(T.parenR),e&&!this.canInsertSemicolon()&&this.eat(T.arrow))return this.checkPatternErrors(h,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=p,this.awaitPos=f,this.parseParenArrowList(r,n,u);u.length&&!l||this.unexpected(this.lastTokStart),a&&this.unexpected(a),this.checkExpressionErrors(h,!0),this.yieldPos=p||this.yieldPos,this.awaitPos=f||this.awaitPos,u.length>1?((t=this.startNodeAt(o,s)).expressions=u,this.finishNodeAt(t,"SequenceExpression",d,m)):t=u[0]}else t=this.parseParenExpression();if(this.options.preserveParens){var y=this.startNodeAt(r,n);return y.expression=t,this.finishNode(y,"ParenthesizedExpression")}return t},$.parseParenItem=function(e){return e},$.parseParenArrowList=function(e,t,r){return this.parseArrowExpression(this.startNodeAt(e,t),r)};var Q=[];$.parseNew=function(){var e=this.startNode(),t=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(T.dot)){e.meta=t;var r=this.containsEsc;return e.property=this.parseIdent(!0),("target"!==e.property.name||r)&&this.raiseRecoverable(e.property.start,"The only valid meta property for new is new.target"),this.inNonArrowFunction()||this.raiseRecoverable(e.start,"new.target can only be used in functions"),this.finishNode(e,"MetaProperty")}var n=this.start,i=this.startLoc,a=this.type===T._import;return e.callee=this.parseSubscripts(this.parseExprAtom(),n,i,!0),a&&"ImportExpression"===e.callee.type&&this.raise(n,"Cannot use new with import()"),this.eat(T.parenL)?e.arguments=this.parseExprList(T.parenR,this.options.ecmaVersion>=8,!1):e.arguments=Q,this.finishNode(e,"NewExpression")},$.parseTemplateElement=function(e){var t=e.isTagged,r=this.startNode();return this.type===T.invalidTemplate?(t||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),r.value={raw:this.value,cooked:null}):r.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,"\n"),cooked:this.value},this.next(),r.tail=this.type===T.backQuote,this.finishNode(r,"TemplateElement")},$.parseTemplate=function(e){void 0===e&&(e={});var t=e.isTagged;void 0===t&&(t=!1);var r=this.startNode();this.next(),r.expressions=[];var n=this.parseTemplateElement({isTagged:t});for(r.quasis=[n];!n.tail;)this.type===T.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(T.dollarBraceL),r.expressions.push(this.parseExpression()),this.expect(T.braceR),r.quasis.push(n=this.parseTemplateElement({isTagged:t}));return this.next(),this.finishNode(r,"TemplateLiteral")},$.isAsyncProp=function(e){return!e.computed&&"Identifier"===e.key.type&&"async"===e.key.name&&(this.type===T.name||this.type===T.num||this.type===T.string||this.type===T.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===T.star)&&!b.test(this.input.slice(this.lastTokEnd,this.start))},$.parseObj=function(e,t){var r=this.startNode(),n=!0,i={};for(r.properties=[],this.next();!this.eat(T.braceR);){if(n)n=!1;else if(this.expect(T.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(T.braceR))break;var a=this.parseProperty(e,t);e||this.checkPropClash(a,i,t),r.properties.push(a)}return this.finishNode(r,e?"ObjectPattern":"ObjectExpression")},$.parseProperty=function(e,t){var r,n,i,a,o=this.startNode();if(this.options.ecmaVersion>=9&&this.eat(T.ellipsis))return e?(o.argument=this.parseIdent(!1),this.type===T.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.finishNode(o,"RestElement")):(this.type===T.parenL&&t&&(t.parenthesizedAssign<0&&(t.parenthesizedAssign=this.start),t.parenthesizedBind<0&&(t.parenthesizedBind=this.start)),o.argument=this.parseMaybeAssign(!1,t),this.type===T.comma&&t&&t.trailingComma<0&&(t.trailingComma=this.start),this.finishNode(o,"SpreadElement"));this.options.ecmaVersion>=6&&(o.method=!1,o.shorthand=!1,(e||t)&&(i=this.start,a=this.startLoc),e||(r=this.eat(T.star)));var s=this.containsEsc;return this.parsePropertyName(o),!e&&!s&&this.options.ecmaVersion>=8&&!r&&this.isAsyncProp(o)?(n=!0,r=this.options.ecmaVersion>=9&&this.eat(T.star),this.parsePropertyName(o,t)):n=!1,this.parsePropertyValue(o,e,r,n,i,a,t,s),this.finishNode(o,"Property")},$.parsePropertyValue=function(e,t,r,n,i,a,o,s){if((r||n)&&this.type===T.colon&&this.unexpected(),this.eat(T.colon))e.value=t?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,o),e.kind="init";else if(this.options.ecmaVersion>=6&&this.type===T.parenL)t&&this.unexpected(),e.kind="init",e.method=!0,e.value=this.parseMethod(r,n);else if(t||s||!(this.options.ecmaVersion>=5)||e.computed||"Identifier"!==e.key.type||"get"!==e.key.name&&"set"!==e.key.name||this.type===T.comma||this.type===T.braceR)this.options.ecmaVersion>=6&&!e.computed&&"Identifier"===e.key.type?((r||n)&&this.unexpected(),this.checkUnreserved(e.key),"await"!==e.key.name||this.awaitIdentPos||(this.awaitIdentPos=i),e.kind="init",t?e.value=this.parseMaybeDefault(i,a,e.key):this.type===T.eq&&o?(o.shorthandAssign<0&&(o.shorthandAssign=this.start),e.value=this.parseMaybeDefault(i,a,e.key)):e.value=e.key,e.shorthand=!0):this.unexpected();else{(r||n)&&this.unexpected(),e.kind=e.key.name,this.parsePropertyName(e),e.value=this.parseMethod(!1);var u="get"===e.kind?0:1;if(e.value.params.length!==u){var c=e.value.start;"get"===e.kind?this.raiseRecoverable(c,"getter should have no params"):this.raiseRecoverable(c,"setter should have exactly one param")}else"set"===e.kind&&"RestElement"===e.value.params[0].type&&this.raiseRecoverable(e.value.params[0].start,"Setter cannot use rest params")}},$.parsePropertyName=function(e){if(this.options.ecmaVersion>=6){if(this.eat(T.bracketL))return e.computed=!0,e.key=this.parseMaybeAssign(),this.expect(T.bracketR),e.key;e.computed=!1}return e.key=this.type===T.num||this.type===T.string?this.parseExprAtom():this.parseIdent("never"!==this.options.allowReserved)},$.initFunction=function(e){e.id=null,this.options.ecmaVersion>=6&&(e.generator=e.expression=!1),this.options.ecmaVersion>=8&&(e.async=!1)},$.parseMethod=function(e,t,r){var n=this.startNode(),i=this.yieldPos,a=this.awaitPos,o=this.awaitIdentPos;return this.initFunction(n),this.options.ecmaVersion>=6&&(n.generator=e),this.options.ecmaVersion>=8&&(n.async=!!t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(64|D(t,n.generator)|(r?128:0)),this.expect(T.parenL),n.params=this.parseBindingList(T.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(n,!1,!0),this.yieldPos=i,this.awaitPos=a,this.awaitIdentPos=o,this.finishNode(n,"FunctionExpression")},$.parseArrowExpression=function(e,t,r){var n=this.yieldPos,i=this.awaitPos,a=this.awaitIdentPos;return this.enterScope(16|D(r,!1)),this.initFunction(e),this.options.ecmaVersion>=8&&(e.async=!!r),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,e.params=this.toAssignableList(t,!0),this.parseFunctionBody(e,!0,!1),this.yieldPos=n,this.awaitPos=i,this.awaitIdentPos=a,this.finishNode(e,"ArrowFunctionExpression")},$.parseFunctionBody=function(e,t,r){var n=t&&this.type!==T.braceL,i=this.strict,a=!1;if(n)e.body=this.parseMaybeAssign(),e.expression=!0,this.checkParams(e,!1);else{var o=this.options.ecmaVersion>=7&&!this.isSimpleParamList(e.params);i&&!o||(a=this.strictDirective(this.end))&&o&&this.raiseRecoverable(e.start,"Illegal 'use strict' directive in function with non-simple parameter list");var s=this.labels;this.labels=[],a&&(this.strict=!0),this.checkParams(e,!i&&!a&&!t&&!r&&this.isSimpleParamList(e.params)),e.body=this.parseBlock(!1),e.expression=!1,this.adaptDirectivePrologue(e.body.body),this.labels=s}this.exitScope(),this.strict&&e.id&&this.checkLVal(e.id,5),this.strict=i},$.isSimpleParamList=function(e){for(var t=0,r=e;t<r.length;t+=1)if("Identifier"!==r[t].type)return!1;return!0},$.checkParams=function(e,t){for(var r={},n=0,i=e.params;n<i.length;n+=1){var a=i[n];this.checkLVal(a,1,t?null:r)}},$.parseExprList=function(e,t,r,n){for(var i=[],a=!0;!this.eat(e);){if(a)a=!1;else if(this.expect(T.comma),t&&this.afterTrailingComma(e))break;var o=void 0;r&&this.type===T.comma?o=null:this.type===T.ellipsis?(o=this.parseSpread(n),n&&this.type===T.comma&&n.trailingComma<0&&(n.trailingComma=this.start)):o=this.parseMaybeAssign(!1,n),i.push(o)}return i},$.checkUnreserved=function(e){var t=e.start,r=e.end,n=e.name;this.inGenerator&&"yield"===n&&this.raiseRecoverable(t,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&"await"===n&&this.raiseRecoverable(t,"Cannot use 'await' as identifier inside an async function"),this.keywords.test(n)&&this.raise(t,"Unexpected keyword '"+n+"'"),this.options.ecmaVersion<6&&-1!==this.input.slice(t,r).indexOf("\\")||(this.strict?this.reservedWordsStrict:this.reservedWords).test(n)&&(this.inAsync||"await"!==n||this.raiseRecoverable(t,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(t,"The keyword '"+n+"' is reserved"))},$.parseIdent=function(e,t){var r=this.startNode();return this.type===T.name?r.name=this.value:this.type.keyword?(r.name=this.type.keyword,"class"!==r.name&&"function"!==r.name||this.lastTokEnd===this.lastTokStart+1&&46===this.input.charCodeAt(this.lastTokStart)||this.context.pop()):this.unexpected(),this.next(),this.finishNode(r,"Identifier"),e||(this.checkUnreserved(r),"await"!==r.name||this.awaitIdentPos||(this.awaitIdentPos=r.start)),r},$.parseYield=function(e){this.yieldPos||(this.yieldPos=this.start);var t=this.startNode();return this.next(),this.type===T.semi||this.canInsertSemicolon()||this.type!==T.star&&!this.type.startsExpr?(t.delegate=!1,t.argument=null):(t.delegate=this.eat(T.star),t.argument=this.parseMaybeAssign(e)),this.finishNode(t,"YieldExpression")},$.parseAwait=function(){this.awaitPos||(this.awaitPos=this.start);var e=this.startNode();return this.next(),e.argument=this.parseMaybeUnary(null,!0),this.finishNode(e,"AwaitExpression")};var Z=U.prototype;Z.raise=function(e,t){var r=P(this.input,e);t+=" ("+r.line+":"+r.column+")";var n=new SyntaxError(t);throw n.pos=e,n.loc=r,n.raisedAt=this.pos,n},Z.raiseRecoverable=Z.raise,Z.curPosition=function(){if(this.options.locations)return new I(this.curLine,this.pos-this.lineStart)};var J=U.prototype,ee=function(e){this.flags=e,this.var=[],this.lexical=[],this.functions=[]};J.enterScope=function(e){this.scopeStack.push(new ee(e))},J.exitScope=function(){this.scopeStack.pop()},J.treatFunctionsAsVarInScope=function(e){return 2&e.flags||!this.inModule&&1&e.flags},J.declareName=function(e,t,r){var n=!1;if(2===t){var i=this.currentScope();n=i.lexical.indexOf(e)>-1||i.functions.indexOf(e)>-1||i.var.indexOf(e)>-1,i.lexical.push(e),this.inModule&&1&i.flags&&delete this.undefinedExports[e]}else if(4===t)this.currentScope().lexical.push(e);else if(3===t){var a=this.currentScope();n=this.treatFunctionsAsVar?a.lexical.indexOf(e)>-1:a.lexical.indexOf(e)>-1||a.var.indexOf(e)>-1,a.functions.push(e)}else for(var o=this.scopeStack.length-1;o>=0;--o){var s=this.scopeStack[o];if(s.lexical.indexOf(e)>-1&&!(32&s.flags&&s.lexical[0]===e)||!this.treatFunctionsAsVarInScope(s)&&s.functions.indexOf(e)>-1){n=!0;break}if(s.var.push(e),this.inModule&&1&s.flags&&delete this.undefinedExports[e],3&s.flags)break}n&&this.raiseRecoverable(r,"Identifier '"+e+"' has already been declared")},J.checkLocalExport=function(e){-1===this.scopeStack[0].lexical.indexOf(e.name)&&-1===this.scopeStack[0].var.indexOf(e.name)&&(this.undefinedExports[e.name]=e)},J.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},J.currentVarScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(3&t.flags)return t}},J.currentThisScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(3&t.flags&&!(16&t.flags))return t}};var te=function(e,t,r){this.type="",this.start=t,this.end=0,e.options.locations&&(this.loc=new M(e,r)),e.options.directSourceFile&&(this.sourceFile=e.options.directSourceFile),e.options.ranges&&(this.range=[t,0])},re=U.prototype;function ne(e,t,r,n){return e.type=t,e.end=r,this.options.locations&&(e.loc.end=n),this.options.ranges&&(e.range[1]=r),e}re.startNode=function(){return new te(this,this.start,this.startLoc)},re.startNodeAt=function(e,t){return new te(this,e,t)},re.finishNode=function(e,t){return ne.call(this,e,t,this.lastTokEnd,this.lastTokEndLoc)},re.finishNodeAt=function(e,t,r,n){return ne.call(this,e,t,r,n)};var ie=function(e,t,r,n,i){this.token=e,this.isExpr=!!t,this.preserveSpace=!!r,this.override=n,this.generator=!!i},ae={b_stat:new ie("{",!1),b_expr:new ie("{",!0),b_tmpl:new ie("${",!1),p_stat:new ie("(",!1),p_expr:new ie("(",!0),q_tmpl:new ie("`",!0,!0,(function(e){return e.tryReadTemplateToken()})),f_stat:new ie("function",!1),f_expr:new ie("function",!0),f_expr_gen:new ie("function",!0,!1,null,!0),f_gen:new ie("function",!1,!1,null,!0)},oe=U.prototype;oe.initialContext=function(){return[ae.b_stat]},oe.braceIsBlock=function(e){var t=this.curContext();return t===ae.f_expr||t===ae.f_stat||(e!==T.colon||t!==ae.b_stat&&t!==ae.b_expr?e===T._return||e===T.name&&this.exprAllowed?b.test(this.input.slice(this.lastTokEnd,this.start)):e===T._else||e===T.semi||e===T.eof||e===T.parenR||e===T.arrow||(e===T.braceL?t===ae.b_stat:e!==T._var&&e!==T._const&&e!==T.name&&!this.exprAllowed):!t.isExpr)},oe.inGeneratorContext=function(){for(var e=this.context.length-1;e>=1;e--){var t=this.context[e];if("function"===t.token)return t.generator}return!1},oe.updateContext=function(e){var t,r=this.type;r.keyword&&e===T.dot?this.exprAllowed=!1:(t=r.updateContext)?t.call(this,e):this.exprAllowed=r.beforeExpr},T.parenR.updateContext=T.braceR.updateContext=function(){if(1!==this.context.length){var e=this.context.pop();e===ae.b_stat&&"function"===this.curContext().token&&(e=this.context.pop()),this.exprAllowed=!e.isExpr}else this.exprAllowed=!0},T.braceL.updateContext=function(e){this.context.push(this.braceIsBlock(e)?ae.b_stat:ae.b_expr),this.exprAllowed=!0},T.dollarBraceL.updateContext=function(){this.context.push(ae.b_tmpl),this.exprAllowed=!0},T.parenL.updateContext=function(e){var t=e===T._if||e===T._for||e===T._with||e===T._while;this.context.push(t?ae.p_stat:ae.p_expr),this.exprAllowed=!0},T.incDec.updateContext=function(){},T._function.updateContext=T._class.updateContext=function(e){!e.beforeExpr||e===T.semi||e===T._else||e===T._return&&b.test(this.input.slice(this.lastTokEnd,this.start))||(e===T.colon||e===T.braceL)&&this.curContext()===ae.b_stat?this.context.push(ae.f_stat):this.context.push(ae.f_expr),this.exprAllowed=!1},T.backQuote.updateContext=function(){this.curContext()===ae.q_tmpl?this.context.pop():this.context.push(ae.q_tmpl),this.exprAllowed=!1},T.star.updateContext=function(e){if(e===T._function){var t=this.context.length-1;this.context[t]===ae.f_expr?this.context[t]=ae.f_expr_gen:this.context[t]=ae.f_gen}this.exprAllowed=!0},T.name.updateContext=function(e){var t=!1;this.options.ecmaVersion>=6&&e!==T.dot&&("of"===this.value&&!this.exprAllowed||"yield"===this.value&&this.inGeneratorContext())&&(t=!0),this.exprAllowed=t};var se="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",ue=se+" Extended_Pictographic",ce={9:se,10:ue,11:"ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS Extended_Pictographic"},le="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",he="Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",pe=he+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",fe={9:he,10:pe,11:"Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho"},de={};function me(e){var t=de[e]={binary:_(ce[e]+" "+le),nonBinary:{General_Category:_(le),Script:_(fe[e])}};t.nonBinary.Script_Extensions=t.nonBinary.Script,t.nonBinary.gc=t.nonBinary.General_Category,t.nonBinary.sc=t.nonBinary.Script,t.nonBinary.scx=t.nonBinary.Script_Extensions}me(9),me(10),me(11);var ye=U.prototype,ge=function(e){this.parser=e,this.validFlags="gim"+(e.options.ecmaVersion>=6?"uy":"")+(e.options.ecmaVersion>=9?"s":""),this.unicodeProperties=de[e.options.ecmaVersion>=11?11:e.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};function ve(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}function Ee(e){return 36===e||e>=40&&e<=43||46===e||63===e||e>=91&&e<=94||e>=123&&e<=125}function Te(e){return e>=65&&e<=90||e>=97&&e<=122}function be(e){return Te(e)||95===e}function xe(e){return be(e)||Ae(e)}function Ae(e){return e>=48&&e<=57}function Se(e){return e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102}function Re(e){return e>=65&&e<=70?e-65+10:e>=97&&e<=102?e-97+10:e-48}function we(e){return e>=48&&e<=55}ge.prototype.reset=function(e,t,r){var n=-1!==r.indexOf("u");this.start=0|e,this.source=t+"",this.flags=r,this.switchU=n&&this.parser.options.ecmaVersion>=6,this.switchN=n&&this.parser.options.ecmaVersion>=9},ge.prototype.raise=function(e){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+e)},ge.prototype.at=function(e){var t=this.source,r=t.length;if(e>=r)return-1;var n=t.charCodeAt(e);return!this.switchU||n<=55295||n>=57344||e+1>=r?n:(n<<10)+t.charCodeAt(e+1)-56613888},ge.prototype.nextIndex=function(e){var t=this.source,r=t.length;if(e>=r)return r;var n=t.charCodeAt(e);return!this.switchU||n<=55295||n>=57344||e+1>=r?e+1:e+2},ge.prototype.current=function(){return this.at(this.pos)},ge.prototype.lookahead=function(){return this.at(this.nextIndex(this.pos))},ge.prototype.advance=function(){this.pos=this.nextIndex(this.pos)},ge.prototype.eat=function(e){return this.current()===e&&(this.advance(),!0)},ye.validateRegExpFlags=function(e){for(var t=e.validFlags,r=e.flags,n=0;n<r.length;n++){var i=r.charAt(n);-1===t.indexOf(i)&&this.raise(e.start,"Invalid regular expression flag"),r.indexOf(i,n+1)>-1&&this.raise(e.start,"Duplicate regular expression flag")}},ye.validateRegExpPattern=function(e){this.regexp_pattern(e),!e.switchN&&this.options.ecmaVersion>=9&&e.groupNames.length>0&&(e.switchN=!0,this.regexp_pattern(e))},ye.regexp_pattern=function(e){e.pos=0,e.lastIntValue=0,e.lastStringValue="",e.lastAssertionIsQuantifiable=!1,e.numCapturingParens=0,e.maxBackReference=0,e.groupNames.length=0,e.backReferenceNames.length=0,this.regexp_disjunction(e),e.pos!==e.source.length&&(e.eat(41)&&e.raise("Unmatched ')'"),(e.eat(93)||e.eat(125))&&e.raise("Lone quantifier brackets")),e.maxBackReference>e.numCapturingParens&&e.raise("Invalid escape");for(var t=0,r=e.backReferenceNames;t<r.length;t+=1){var n=r[t];-1===e.groupNames.indexOf(n)&&e.raise("Invalid named capture referenced")}},ye.regexp_disjunction=function(e){for(this.regexp_alternative(e);e.eat(124);)this.regexp_alternative(e);this.regexp_eatQuantifier(e,!0)&&e.raise("Nothing to repeat"),e.eat(123)&&e.raise("Lone quantifier brackets")},ye.regexp_alternative=function(e){for(;e.pos<e.source.length&&this.regexp_eatTerm(e););},ye.regexp_eatTerm=function(e){return this.regexp_eatAssertion(e)?(e.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(e)&&e.switchU&&e.raise("Invalid quantifier"),!0):!!(e.switchU?this.regexp_eatAtom(e):this.regexp_eatExtendedAtom(e))&&(this.regexp_eatQuantifier(e),!0)},ye.regexp_eatAssertion=function(e){var t=e.pos;if(e.lastAssertionIsQuantifiable=!1,e.eat(94)||e.eat(36))return!0;if(e.eat(92)){if(e.eat(66)||e.eat(98))return!0;e.pos=t}if(e.eat(40)&&e.eat(63)){var r=!1;if(this.options.ecmaVersion>=9&&(r=e.eat(60)),e.eat(61)||e.eat(33))return this.regexp_disjunction(e),e.eat(41)||e.raise("Unterminated group"),e.lastAssertionIsQuantifiable=!r,!0}return e.pos=t,!1},ye.regexp_eatQuantifier=function(e,t){return void 0===t&&(t=!1),!!this.regexp_eatQuantifierPrefix(e,t)&&(e.eat(63),!0)},ye.regexp_eatQuantifierPrefix=function(e,t){return e.eat(42)||e.eat(43)||e.eat(63)||this.regexp_eatBracedQuantifier(e,t)},ye.regexp_eatBracedQuantifier=function(e,t){var r=e.pos;if(e.eat(123)){var n=0,i=-1;if(this.regexp_eatDecimalDigits(e)&&(n=e.lastIntValue,e.eat(44)&&this.regexp_eatDecimalDigits(e)&&(i=e.lastIntValue),e.eat(125)))return-1!==i&&i<n&&!t&&e.raise("numbers out of order in {} quantifier"),!0;e.switchU&&!t&&e.raise("Incomplete quantifier"),e.pos=r}return!1},ye.regexp_eatAtom=function(e){return this.regexp_eatPatternCharacters(e)||e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)},ye.regexp_eatReverseSolidusAtomEscape=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatAtomEscape(e))return!0;e.pos=t}return!1},ye.regexp_eatUncapturingGroup=function(e){var t=e.pos;if(e.eat(40)){if(e.eat(63)&&e.eat(58)){if(this.regexp_disjunction(e),e.eat(41))return!0;e.raise("Unterminated group")}e.pos=t}return!1},ye.regexp_eatCapturingGroup=function(e){if(e.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(e):63===e.current()&&e.raise("Invalid group"),this.regexp_disjunction(e),e.eat(41))return e.numCapturingParens+=1,!0;e.raise("Unterminated group")}return!1},ye.regexp_eatExtendedAtom=function(e){return e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)||this.regexp_eatInvalidBracedQuantifier(e)||this.regexp_eatExtendedPatternCharacter(e)},ye.regexp_eatInvalidBracedQuantifier=function(e){return this.regexp_eatBracedQuantifier(e,!0)&&e.raise("Nothing to repeat"),!1},ye.regexp_eatSyntaxCharacter=function(e){var t=e.current();return!!Ee(t)&&(e.lastIntValue=t,e.advance(),!0)},ye.regexp_eatPatternCharacters=function(e){for(var t=e.pos,r=0;-1!==(r=e.current())&&!Ee(r);)e.advance();return e.pos!==t},ye.regexp_eatExtendedPatternCharacter=function(e){var t=e.current();return!(-1===t||36===t||t>=40&&t<=43||46===t||63===t||91===t||94===t||124===t||(e.advance(),0))},ye.regexp_groupSpecifier=function(e){if(e.eat(63)){if(this.regexp_eatGroupName(e))return-1!==e.groupNames.indexOf(e.lastStringValue)&&e.raise("Duplicate capture group name"),void e.groupNames.push(e.lastStringValue);e.raise("Invalid group")}},ye.regexp_eatGroupName=function(e){if(e.lastStringValue="",e.eat(60)){if(this.regexp_eatRegExpIdentifierName(e)&&e.eat(62))return!0;e.raise("Invalid capture group name")}return!1},ye.regexp_eatRegExpIdentifierName=function(e){if(e.lastStringValue="",this.regexp_eatRegExpIdentifierStart(e)){for(e.lastStringValue+=ve(e.lastIntValue);this.regexp_eatRegExpIdentifierPart(e);)e.lastStringValue+=ve(e.lastIntValue);return!0}return!1},ye.regexp_eatRegExpIdentifierStart=function(e){var t=e.pos,r=e.current();return e.advance(),92===r&&this.regexp_eatRegExpUnicodeEscapeSequence(e)&&(r=e.lastIntValue),function(e){return p(e,!0)||36===e||95===e}(r)?(e.lastIntValue=r,!0):(e.pos=t,!1)},ye.regexp_eatRegExpIdentifierPart=function(e){var t=e.pos,r=e.current();return e.advance(),92===r&&this.regexp_eatRegExpUnicodeEscapeSequence(e)&&(r=e.lastIntValue),function(e){return f(e,!0)||36===e||95===e||8204===e||8205===e}(r)?(e.lastIntValue=r,!0):(e.pos=t,!1)},ye.regexp_eatAtomEscape=function(e){return!!(this.regexp_eatBackReference(e)||this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)||e.switchN&&this.regexp_eatKGroupName(e))||(e.switchU&&(99===e.current()&&e.raise("Invalid unicode escape"),e.raise("Invalid escape")),!1)},ye.regexp_eatBackReference=function(e){var t=e.pos;if(this.regexp_eatDecimalEscape(e)){var r=e.lastIntValue;if(e.switchU)return r>e.maxBackReference&&(e.maxBackReference=r),!0;if(r<=e.numCapturingParens)return!0;e.pos=t}return!1},ye.regexp_eatKGroupName=function(e){if(e.eat(107)){if(this.regexp_eatGroupName(e))return e.backReferenceNames.push(e.lastStringValue),!0;e.raise("Invalid named reference")}return!1},ye.regexp_eatCharacterEscape=function(e){return this.regexp_eatControlEscape(e)||this.regexp_eatCControlLetter(e)||this.regexp_eatZero(e)||this.regexp_eatHexEscapeSequence(e)||this.regexp_eatRegExpUnicodeEscapeSequence(e)||!e.switchU&&this.regexp_eatLegacyOctalEscapeSequence(e)||this.regexp_eatIdentityEscape(e)},ye.regexp_eatCControlLetter=function(e){var t=e.pos;if(e.eat(99)){if(this.regexp_eatControlLetter(e))return!0;e.pos=t}return!1},ye.regexp_eatZero=function(e){return 48===e.current()&&!Ae(e.lookahead())&&(e.lastIntValue=0,e.advance(),!0)},ye.regexp_eatControlEscape=function(e){var t=e.current();return 116===t?(e.lastIntValue=9,e.advance(),!0):110===t?(e.lastIntValue=10,e.advance(),!0):118===t?(e.lastIntValue=11,e.advance(),!0):102===t?(e.lastIntValue=12,e.advance(),!0):114===t&&(e.lastIntValue=13,e.advance(),!0)},ye.regexp_eatControlLetter=function(e){var t=e.current();return!!Te(t)&&(e.lastIntValue=t%32,e.advance(),!0)},ye.regexp_eatRegExpUnicodeEscapeSequence=function(e){var t,r=e.pos;if(e.eat(117)){if(this.regexp_eatFixedHexDigits(e,4)){var n=e.lastIntValue;if(e.switchU&&n>=55296&&n<=56319){var i=e.pos;if(e.eat(92)&&e.eat(117)&&this.regexp_eatFixedHexDigits(e,4)){var a=e.lastIntValue;if(a>=56320&&a<=57343)return e.lastIntValue=1024*(n-55296)+(a-56320)+65536,!0}e.pos=i,e.lastIntValue=n}return!0}if(e.switchU&&e.eat(123)&&this.regexp_eatHexDigits(e)&&e.eat(125)&&(t=e.lastIntValue)>=0&&t<=1114111)return!0;e.switchU&&e.raise("Invalid unicode escape"),e.pos=r}return!1},ye.regexp_eatIdentityEscape=function(e){if(e.switchU)return!!this.regexp_eatSyntaxCharacter(e)||!!e.eat(47)&&(e.lastIntValue=47,!0);var t=e.current();return!(99===t||e.switchN&&107===t||(e.lastIntValue=t,e.advance(),0))},ye.regexp_eatDecimalEscape=function(e){e.lastIntValue=0;var t=e.current();if(t>=49&&t<=57){do{e.lastIntValue=10*e.lastIntValue+(t-48),e.advance()}while((t=e.current())>=48&&t<=57);return!0}return!1},ye.regexp_eatCharacterClassEscape=function(e){var t=e.current();if(function(e){return 100===e||68===e||115===e||83===e||119===e||87===e}(t))return e.lastIntValue=-1,e.advance(),!0;if(e.switchU&&this.options.ecmaVersion>=9&&(80===t||112===t)){if(e.lastIntValue=-1,e.advance(),e.eat(123)&&this.regexp_eatUnicodePropertyValueExpression(e)&&e.eat(125))return!0;e.raise("Invalid property name")}return!1},ye.regexp_eatUnicodePropertyValueExpression=function(e){var t=e.pos;if(this.regexp_eatUnicodePropertyName(e)&&e.eat(61)){var r=e.lastStringValue;if(this.regexp_eatUnicodePropertyValue(e)){var n=e.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(e,r,n),!0}}if(e.pos=t,this.regexp_eatLoneUnicodePropertyNameOrValue(e)){var i=e.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(e,i),!0}return!1},ye.regexp_validateUnicodePropertyNameAndValue=function(e,t,r){k(e.unicodeProperties.nonBinary,t)||e.raise("Invalid property name"),e.unicodeProperties.nonBinary[t].test(r)||e.raise("Invalid property value")},ye.regexp_validateUnicodePropertyNameOrValue=function(e,t){e.unicodeProperties.binary.test(t)||e.raise("Invalid property name")},ye.regexp_eatUnicodePropertyName=function(e){var t=0;for(e.lastStringValue="";be(t=e.current());)e.lastStringValue+=ve(t),e.advance();return""!==e.lastStringValue},ye.regexp_eatUnicodePropertyValue=function(e){var t=0;for(e.lastStringValue="";xe(t=e.current());)e.lastStringValue+=ve(t),e.advance();return""!==e.lastStringValue},ye.regexp_eatLoneUnicodePropertyNameOrValue=function(e){return this.regexp_eatUnicodePropertyValue(e)},ye.regexp_eatCharacterClass=function(e){if(e.eat(91)){if(e.eat(94),this.regexp_classRanges(e),e.eat(93))return!0;e.raise("Unterminated character class")}return!1},ye.regexp_classRanges=function(e){for(;this.regexp_eatClassAtom(e);){var t=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassAtom(e)){var r=e.lastIntValue;!e.switchU||-1!==t&&-1!==r||e.raise("Invalid character class"),-1!==t&&-1!==r&&t>r&&e.raise("Range out of order in character class")}}},ye.regexp_eatClassAtom=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatClassEscape(e))return!0;if(e.switchU){var r=e.current();(99===r||we(r))&&e.raise("Invalid class escape"),e.raise("Invalid escape")}e.pos=t}var n=e.current();return 93!==n&&(e.lastIntValue=n,e.advance(),!0)},ye.regexp_eatClassEscape=function(e){var t=e.pos;if(e.eat(98))return e.lastIntValue=8,!0;if(e.switchU&&e.eat(45))return e.lastIntValue=45,!0;if(!e.switchU&&e.eat(99)){if(this.regexp_eatClassControlLetter(e))return!0;e.pos=t}return this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)},ye.regexp_eatClassControlLetter=function(e){var t=e.current();return!(!Ae(t)&&95!==t||(e.lastIntValue=t%32,e.advance(),0))},ye.regexp_eatHexEscapeSequence=function(e){var t=e.pos;if(e.eat(120)){if(this.regexp_eatFixedHexDigits(e,2))return!0;e.switchU&&e.raise("Invalid escape"),e.pos=t}return!1},ye.regexp_eatDecimalDigits=function(e){var t=e.pos,r=0;for(e.lastIntValue=0;Ae(r=e.current());)e.lastIntValue=10*e.lastIntValue+(r-48),e.advance();return e.pos!==t},ye.regexp_eatHexDigits=function(e){var t=e.pos,r=0;for(e.lastIntValue=0;Se(r=e.current());)e.lastIntValue=16*e.lastIntValue+Re(r),e.advance();return e.pos!==t},ye.regexp_eatLegacyOctalEscapeSequence=function(e){if(this.regexp_eatOctalDigit(e)){var t=e.lastIntValue;if(this.regexp_eatOctalDigit(e)){var r=e.lastIntValue;t<=3&&this.regexp_eatOctalDigit(e)?e.lastIntValue=64*t+8*r+e.lastIntValue:e.lastIntValue=8*t+r}else e.lastIntValue=t;return!0}return!1},ye.regexp_eatOctalDigit=function(e){var t=e.current();return we(t)?(e.lastIntValue=t-48,e.advance(),!0):(e.lastIntValue=0,!1)},ye.regexp_eatFixedHexDigits=function(e,t){var r=e.pos;e.lastIntValue=0;for(var n=0;n<t;++n){var i=e.current();if(!Se(i))return e.pos=r,!1;e.lastIntValue=16*e.lastIntValue+Re(i),e.advance()}return!0};var Ce=function(e){this.type=e.type,this.value=e.value,this.start=e.start,this.end=e.end,e.options.locations&&(this.loc=new M(e,e.startLoc,e.endLoc)),e.options.ranges&&(this.range=[e.start,e.end])},Oe=U.prototype;function ke(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}Oe.next=function(){this.options.onToken&&this.options.onToken(new Ce(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},Oe.getToken=function(){return this.next(),new Ce(this)},"undefined"!=typeof Symbol&&(Oe[Symbol.iterator]=function(){var e=this;return{next:function(){var t=e.getToken();return{done:t.type===T.eof,value:t}}}}),Oe.curContext=function(){return this.context[this.context.length-1]},Oe.nextToken=function(){var e=this.curContext();return e&&e.preserveSpace||this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length?this.finishToken(T.eof):e.override?e.override(this):void this.readToken(this.fullCharCodeAtPos())},Oe.readToken=function(e){return p(e,this.options.ecmaVersion>=6)||92===e?this.readWord():this.getTokenFromCode(e)},Oe.fullCharCodeAtPos=function(){var e=this.input.charCodeAt(this.pos);return e<=55295||e>=57344?e:(e<<10)+this.input.charCodeAt(this.pos+1)-56613888},Oe.skipBlockComment=function(){var e,t=this.options.onComment&&this.curPosition(),r=this.pos,n=this.input.indexOf("*/",this.pos+=2);if(-1===n&&this.raise(this.pos-2,"Unterminated comment"),this.pos=n+2,this.options.locations)for(x.lastIndex=r;(e=x.exec(this.input))&&e.index<this.pos;)++this.curLine,this.lineStart=e.index+e[0].length;this.options.onComment&&this.options.onComment(!0,this.input.slice(r+2,n),r,this.pos,t,this.curPosition())},Oe.skipLineComment=function(e){for(var t=this.pos,r=this.options.onComment&&this.curPosition(),n=this.input.charCodeAt(this.pos+=e);this.pos<this.input.length&&!A(n);)n=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(t+e,this.pos),t,this.pos,r,this.curPosition())},Oe.skipSpace=function(){e:for(;this.pos<this.input.length;){var e=this.input.charCodeAt(this.pos);switch(e){case 32:case 160:++this.pos;break;case 13:10===this.input.charCodeAt(this.pos+1)&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(!(e>8&&e<14||e>=5760&&S.test(String.fromCharCode(e))))break e;++this.pos}}},Oe.finishToken=function(e,t){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var r=this.type;this.type=e,this.value=t,this.updateContext(r)},Oe.readToken_dot=function(){var e=this.input.charCodeAt(this.pos+1);if(e>=48&&e<=57)return this.readNumber(!0);var t=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&46===e&&46===t?(this.pos+=3,this.finishToken(T.ellipsis)):(++this.pos,this.finishToken(T.dot))},Oe.readToken_slash=function(){var e=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):61===e?this.finishOp(T.assign,2):this.finishOp(T.slash,1)},Oe.readToken_mult_modulo_exp=function(e){var t=this.input.charCodeAt(this.pos+1),r=1,n=42===e?T.star:T.modulo;return this.options.ecmaVersion>=7&&42===e&&42===t&&(++r,n=T.starstar,t=this.input.charCodeAt(this.pos+2)),61===t?this.finishOp(T.assign,r+1):this.finishOp(n,r)},Oe.readToken_pipe_amp=function(e){var t=this.input.charCodeAt(this.pos+1);return t===e?this.finishOp(124===e?T.logicalOR:T.logicalAND,2):61===t?this.finishOp(T.assign,2):this.finishOp(124===e?T.bitwiseOR:T.bitwiseAND,1)},Oe.readToken_caret=function(){return 61===this.input.charCodeAt(this.pos+1)?this.finishOp(T.assign,2):this.finishOp(T.bitwiseXOR,1)},Oe.readToken_plus_min=function(e){var t=this.input.charCodeAt(this.pos+1);return t===e?45!==t||this.inModule||62!==this.input.charCodeAt(this.pos+2)||0!==this.lastTokEnd&&!b.test(this.input.slice(this.lastTokEnd,this.pos))?this.finishOp(T.incDec,2):(this.skipLineComment(3),this.skipSpace(),this.nextToken()):61===t?this.finishOp(T.assign,2):this.finishOp(T.plusMin,1)},Oe.readToken_lt_gt=function(e){var t=this.input.charCodeAt(this.pos+1),r=1;return t===e?(r=62===e&&62===this.input.charCodeAt(this.pos+2)?3:2,61===this.input.charCodeAt(this.pos+r)?this.finishOp(T.assign,r+1):this.finishOp(T.bitShift,r)):33!==t||60!==e||this.inModule||45!==this.input.charCodeAt(this.pos+2)||45!==this.input.charCodeAt(this.pos+3)?(61===t&&(r=2),this.finishOp(T.relational,r)):(this.skipLineComment(4),this.skipSpace(),this.nextToken())},Oe.readToken_eq_excl=function(e){var t=this.input.charCodeAt(this.pos+1);return 61===t?this.finishOp(T.equality,61===this.input.charCodeAt(this.pos+2)?3:2):61===e&&62===t&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(T.arrow)):this.finishOp(61===e?T.eq:T.prefix,1)},Oe.getTokenFromCode=function(e){switch(e){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(T.parenL);case 41:return++this.pos,this.finishToken(T.parenR);case 59:return++this.pos,this.finishToken(T.semi);case 44:return++this.pos,this.finishToken(T.comma);case 91:return++this.pos,this.finishToken(T.bracketL);case 93:return++this.pos,this.finishToken(T.bracketR);case 123:return++this.pos,this.finishToken(T.braceL);case 125:return++this.pos,this.finishToken(T.braceR);case 58:return++this.pos,this.finishToken(T.colon);case 63:return++this.pos,this.finishToken(T.question);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(T.backQuote);case 48:var t=this.input.charCodeAt(this.pos+1);if(120===t||88===t)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(111===t||79===t)return this.readRadixNumber(8);if(98===t||66===t)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(e);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(e);case 124:case 38:return this.readToken_pipe_amp(e);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(e);case 60:case 62:return this.readToken_lt_gt(e);case 61:case 33:return this.readToken_eq_excl(e);case 126:return this.finishOp(T.prefix,1)}this.raise(this.pos,"Unexpected character '"+ke(e)+"'")},Oe.finishOp=function(e,t){var r=this.input.slice(this.pos,this.pos+t);return this.pos+=t,this.finishToken(e,r)},Oe.readRegexp=function(){for(var e,t,r=this.pos;;){this.pos>=this.input.length&&this.raise(r,"Unterminated regular expression");var n=this.input.charAt(this.pos);if(b.test(n)&&this.raise(r,"Unterminated regular expression"),e)e=!1;else{if("["===n)t=!0;else if("]"===n&&t)t=!1;else if("/"===n&&!t)break;e="\\"===n}++this.pos}var i=this.input.slice(r,this.pos);++this.pos;var a=this.pos,o=this.readWord1();this.containsEsc&&this.unexpected(a);var s=this.regexpState||(this.regexpState=new ge(this));s.reset(r,i,o),this.validateRegExpFlags(s),this.validateRegExpPattern(s);var u=null;try{u=new RegExp(i,o)}catch(e){}return this.finishToken(T.regexp,{pattern:i,flags:o,value:u})},Oe.readInt=function(e,t){for(var r=this.pos,n=0,i=0,a=null==t?1/0:t;i<a;++i){var o=this.input.charCodeAt(this.pos),s=void 0;if((s=o>=97?o-97+10:o>=65?o-65+10:o>=48&&o<=57?o-48:1/0)>=e)break;++this.pos,n=n*e+s}return this.pos===r||null!=t&&this.pos-r!==t?null:n},Oe.readRadixNumber=function(e){var t=this.pos;this.pos+=2;var r=this.readInt(e);return null==r&&this.raise(this.start+2,"Expected number in radix "+e),this.options.ecmaVersion>=11&&110===this.input.charCodeAt(this.pos)?(r="undefined"!=typeof BigInt?BigInt(this.input.slice(t,this.pos)):null,++this.pos):p(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(T.num,r)},Oe.readNumber=function(e){var t=this.pos;e||null!==this.readInt(10)||this.raise(t,"Invalid number");var r=this.pos-t>=2&&48===this.input.charCodeAt(t);r&&this.strict&&this.raise(t,"Invalid number"),r&&/[89]/.test(this.input.slice(t,this.pos))&&(r=!1);var n=this.input.charCodeAt(this.pos);if(!r&&!e&&this.options.ecmaVersion>=11&&110===n){var i=this.input.slice(t,this.pos),a="undefined"!=typeof BigInt?BigInt(i):null;return++this.pos,p(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(T.num,a)}46!==n||r||(++this.pos,this.readInt(10),n=this.input.charCodeAt(this.pos)),69!==n&&101!==n||r||(43!==(n=this.input.charCodeAt(++this.pos))&&45!==n||++this.pos,null===this.readInt(10)&&this.raise(t,"Invalid number")),p(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var o=this.input.slice(t,this.pos),s=r?parseInt(o,8):parseFloat(o);return this.finishToken(T.num,s)},Oe.readCodePoint=function(){var e;if(123===this.input.charCodeAt(this.pos)){this.options.ecmaVersion<6&&this.unexpected();var t=++this.pos;e=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,e>1114111&&this.invalidStringToken(t,"Code point out of bounds")}else e=this.readHexChar(4);return e},Oe.readString=function(e){for(var t="",r=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var n=this.input.charCodeAt(this.pos);if(n===e)break;92===n?(t+=this.input.slice(r,this.pos),t+=this.readEscapedChar(!1),r=this.pos):(A(n,this.options.ecmaVersion>=10)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return t+=this.input.slice(r,this.pos++),this.finishToken(T.string,t)};var Ne={};Oe.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(e){if(e!==Ne)throw e;this.readInvalidTemplateToken()}this.inTemplateElement=!1},Oe.invalidStringToken=function(e,t){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw Ne;this.raise(e,t)},Oe.readTmplToken=function(){for(var e="",t=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var r=this.input.charCodeAt(this.pos);if(96===r||36===r&&123===this.input.charCodeAt(this.pos+1))return this.pos!==this.start||this.type!==T.template&&this.type!==T.invalidTemplate?(e+=this.input.slice(t,this.pos),this.finishToken(T.template,e)):36===r?(this.pos+=2,this.finishToken(T.dollarBraceL)):(++this.pos,this.finishToken(T.backQuote));if(92===r)e+=this.input.slice(t,this.pos),e+=this.readEscapedChar(!0),t=this.pos;else if(A(r)){switch(e+=this.input.slice(t,this.pos),++this.pos,r){case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:e+="\n";break;default:e+=String.fromCharCode(r)}this.options.locations&&(++this.curLine,this.lineStart=this.pos),t=this.pos}else++this.pos}},Oe.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if("{"!==this.input[this.pos+1])break;case"`":return this.finishToken(T.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},Oe.readEscapedChar=function(e){var t=this.input.charCodeAt(++this.pos);switch(++this.pos,t){case 110:return"\n";case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return ke(this.readCodePoint());case 116:return"\t";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";default:if(t>=48&&t<=55){var r=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],n=parseInt(r,8);return n>255&&(r=r.slice(0,-1),n=parseInt(r,8)),this.pos+=r.length-1,t=this.input.charCodeAt(this.pos),"0"===r&&56!==t&&57!==t||!this.strict&&!e||this.invalidStringToken(this.pos-1-r.length,e?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(n)}return A(t)?"":String.fromCharCode(t)}},Oe.readHexChar=function(e){var t=this.pos,r=this.readInt(16,e);return null===r&&this.invalidStringToken(t,"Bad character escape sequence"),r},Oe.readWord1=function(){this.containsEsc=!1;for(var e="",t=!0,r=this.pos,n=this.options.ecmaVersion>=6;this.pos<this.input.length;){var i=this.fullCharCodeAtPos();if(f(i,n))this.pos+=i<=65535?1:2;else{if(92!==i)break;this.containsEsc=!0,e+=this.input.slice(r,this.pos);var a=this.pos;117!==this.input.charCodeAt(++this.pos)&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var o=this.readCodePoint();(t?p:f)(o,n)||this.invalidStringToken(a,"Invalid Unicode escape"),e+=ke(o),r=this.pos}t=!1}return e+this.input.slice(r,this.pos)},Oe.readWord=function(){var e=this.readWord1(),t=T.name;return this.keywords.test(e)&&(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+e),t=v[e]),this.finishToken(t,e)},U.acorn={Parser:U,version:"7.1.0",defaultOptions:L,Position:I,SourceLocation:M,getLineInfo:P,Node:te,TokenType:d,tokTypes:T,keywordTypes:v,TokContext:ie,tokContexts:ae,isIdentifierChar:f,isIdentifierStart:p,Token:Ce,isNewLine:A,lineBreak:b,lineBreakG:x,nonASCIIwhitespace:S},e.Node=te,e.Parser=U,e.Position=I,e.SourceLocation=M,e.TokContext=ie,e.Token=Ce,e.TokenType=d,e.defaultOptions=L,e.getLineInfo=P,e.isIdentifierChar=f,e.isIdentifierStart=p,e.isNewLine=A,e.keywordTypes=v,e.lineBreak=b,e.lineBreakG=x,e.nonASCIIwhitespace=S,e.parse=function(e,t){return U.parse(e,t)},e.parseExpressionAt=function(e,t,r){return U.parseExpressionAt(e,t,r)},e.tokContexts=ae,e.tokTypes=T,e.tokenizer=function(e,t){return U.tokenizer(e,t)},e.version="7.1.0",Object.defineProperty(e,"__esModule",{value:!0})},"object"===d(r)&&void 0!==t?i(r):i((n=n||self).acorn={})},{}],2:[function(e,t,r){},{}],3:[function(e,t,r){function n(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.contextName,s=void 0===n?"gl":n,u=r.throwGetError,c=r.useTrackablePrimitives,l=r.readPixelsFile,h=r.recording,p=void 0===h?[]:h,f=r.variables,m=void 0===f?{}:f,y=r.onReadPixels,g=r.onUnrecognizedArgumentLookup,v=new Proxy(e,{get:A}),E=[],T={},b=0,x="";return v;function A(r,n){switch(n){case"addComment":return _;case"checkThrowError":return I;case"getReadPixelsVariableName":return t;case"insertVariable":return w;case"reset":return R;case"setIndent":return O;case"toString":return S;case"getContextVariableName":return L}return"function"==typeof e[n]?function(){switch(n){case"getError":return u?p.push("".concat(x,"if (").concat(s,".getError() !== ").concat(s,".NONE) throw new Error('error');")):p.push("".concat(x).concat(s,".getError();")),e.getError();case"getExtension":var r="".concat(s,"Variables").concat(E.length);p.push("".concat(x,"const ").concat(r," = ").concat(s,".getExtension('").concat(arguments[0],"');"));var h=e.getExtension(arguments[0]);if(h&&"object"===d(h)){var f=i(h,{getEntity:C,useTrackablePrimitives:c,recording:p,contextName:r,contextVariables:E,variables:m,indent:x,onUnrecognizedArgumentLookup:g});return E.push(f),f}return E.push(null),h;case"readPixels":var v,T=E.indexOf(arguments[6]);if(-1===T){var b=P(arguments[6]);b?(v=b,p.push("".concat(x).concat(b))):(v="".concat(s,"Variable").concat(E.length),E.push(arguments[6]),p.push("".concat(x,"const ").concat(v," = new ").concat(arguments[6].constructor.name,"(").concat(arguments[6].length,");")))}else v="".concat(s,"Variable").concat(T);t=v;var A=[arguments[0],arguments[1],arguments[2],arguments[3],C(arguments[4]),C(arguments[5]),v];return p.push("".concat(x).concat(s,".readPixels(").concat(A.join(", "),");")),l&&N(arguments[2],arguments[3]),y&&y(v,A),e.readPixels.apply(e,arguments);case"drawBuffers":return p.push("".concat(x).concat(s,".drawBuffers([").concat(a(arguments[0],{contextName:s,contextVariables:E,getEntity:C,addVariable:k,variables:m,onUnrecognizedArgumentLookup:g}),"]);")),e.drawBuffers(arguments[0])}var S=e[n].apply(e,arguments);switch(d(S)){case"undefined":return void p.push("".concat(x).concat(M(n,arguments),";"));case"number":case"boolean":if(c&&-1===E.indexOf(o(S))){p.push("".concat(x,"const ").concat(s,"Variable").concat(E.length," = ").concat(M(n,arguments),";")),E.push(S=o(S));break}default:null===S?p.push("".concat(M(n,arguments),";")):p.push("".concat(x,"const ").concat(s,"Variable").concat(E.length," = ").concat(M(n,arguments),";")),E.push(S)}return S}:(T[e[n]]=n,e[n])}function S(){return p.join("\n")}function R(){for(;p.length>0;)p.pop()}function w(e,t){m[e]=t}function C(e){var t=T[e];return t?s+"."+t:e}function O(e){x=" ".repeat(e)}function k(e,t){var r="".concat(s,"Variable").concat(E.length);return p.push("".concat(x,"const ").concat(r," = ").concat(t,";")),E.push(e),r}function N(e,t){var r="".concat(s,"Variable").concat(E.length),n="imageDatum".concat(b);p.push("".concat(x,"let ").concat(n,' = ["P3\\n# ').concat(l,'.ppm\\n", ').concat(e,", ' ', ").concat(t,', "\\n255\\n"].join("");')),p.push("".concat(x,"for (let i = 0; i < ").concat(n,".length; i += 4) {")),p.push("".concat(x,"  ").concat(n," += ").concat(r,"[i] + ' ' + ").concat(r,"[i + 1] + ' ' + ").concat(r,"[i + 2] + ' ';")),p.push("".concat(x,"}")),p.push("".concat(x,'if (typeof require !== "undefined") {')),p.push("".concat(x,"  require('fs').writeFileSync('./").concat(l,".ppm', ").concat(n,");")),p.push("".concat(x,"}")),b++}function _(e){p.push("".concat(x,"// ").concat(e))}function I(){p.push("".concat(x,"(() => {\n").concat(x,"const error = ").concat(s,".getError();\n").concat(x,"if (error !== ").concat(s,".NONE) {\n").concat(x,"  const names = Object.getOwnPropertyNames(gl);\n").concat(x,"  for (let i = 0; i < names.length; i++) {\n").concat(x,"    const name = names[i];\n").concat(x,"    if (").concat(s,"[name] === error) {\n").concat(x,"      throw new Error('").concat(s," threw ' + name);\n").concat(x,"    }\n").concat(x,"  }\n").concat(x,"}\n").concat(x,"})();"))}function M(e,t){return"".concat(s,".").concat(e,"(").concat(a(t,{contextName:s,contextVariables:E,getEntity:C,addVariable:k,variables:m,onUnrecognizedArgumentLookup:g}),")")}function P(e){if(m)for(var t in m)if(m[t]===e)return t;return null}function L(e){var t=E.indexOf(e);return-1!==t?"".concat(s,"Variable").concat(t):null}}function i(e,t){var r=new Proxy(e,{get:function(t,r){return"function"==typeof t[r]?function(){switch(r){case"drawBuffersWEBGL":return l.push("".concat(p).concat(i,".drawBuffersWEBGL([").concat(a(arguments[0],{contextName:i,contextVariables:s,getEntity:m,addVariable:g,variables:h,onUnrecognizedArgumentLookup:f}),"]);")),e.drawBuffersWEBGL(arguments[0])}var t=e[r].apply(e,arguments);switch(d(t)){case"undefined":return void l.push("".concat(p).concat(y(r,arguments),";"));case"number":case"boolean":c&&-1===s.indexOf(o(t))?(l.push("".concat(p,"const ").concat(i,"Variable").concat(s.length," = ").concat(y(r,arguments),";")),s.push(t=o(t))):(l.push("".concat(p,"const ").concat(i,"Variable").concat(s.length," = ").concat(y(r,arguments),";")),s.push(t));break;default:null===t?l.push("".concat(y(r,arguments),";")):l.push("".concat(p,"const ").concat(i,"Variable").concat(s.length," = ").concat(y(r,arguments),";")),s.push(t)}return t}:(n[e[r]]=r,e[r])}}),n={},i=t.contextName,s=t.contextVariables,u=t.getEntity,c=t.useTrackablePrimitives,l=t.recording,h=t.variables,p=t.indent,f=t.onUnrecognizedArgumentLookup;return r;function m(e){return n.hasOwnProperty(e)?"".concat(i,".").concat(n[e]):u(e)}function y(e,t){return"".concat(i,".").concat(e,"(").concat(a(t,{contextName:i,contextVariables:s,getEntity:m,addVariable:g,variables:h,onUnrecognizedArgumentLookup:f}),")")}function g(e,t){var r="".concat(i,"Variable").concat(s.length);return s.push(e),l.push("".concat(p,"const ").concat(r," = ").concat(t,";")),r}}function a(e,t){var r=t.variables,n=t.onUnrecognizedArgumentLookup;return Array.from(e).map((function(e){var i=function(e){if(r)for(var t in r)if(r.hasOwnProperty(t)&&r[t]===e)return t;return n?n(e):null}(e);return i||function(e,t){var r=t.contextName,n=t.contextVariables,i=t.getEntity,a=t.addVariable,o=t.onUnrecognizedArgumentLookup;if(void 0===e)return"undefined";if(null===e)return"null";var s=n.indexOf(e);if(s>-1)return"".concat(r,"Variable").concat(s);switch(e.constructor.name){case"String":var u=/\n/.test(e),c=/'/.test(e),l=/"/.test(e);return u?"`"+e+"`":c&&!l?'"'+e+'"':"'"+e+"'";case"Number":case"Boolean":return i(e);case"Array":return a(e,"new ".concat(e.constructor.name,"([").concat(Array.from(e).join(","),"])"));case"Float32Array":case"Uint8Array":case"Uint16Array":case"Int32Array":return a(e,"new ".concat(e.constructor.name,"(").concat(JSON.stringify(Array.from(e)),")"));default:if(o){var h=o(e);if(h)return h}throw new Error("unrecognized argument type ".concat(e.constructor.name))}}(e,t)})).join(", ")}function o(e){return new e.constructor(e)}void 0!==t&&(t.exports={glWiretap:n,glExtensionWiretap:i}),"undefined"!=typeof window&&(n.glExtensionWiretap=i,window.glWiretap=n)},{}],4:[function(e,t,r){function n(e){for(var t=new Array(e.length),r=0;r<e.length;r++){var n=e[r];n.toArray?t[r]=n.toArray():t[r]=n}return t}function i(){for(var e=n(arguments),t=new Float32Array(this.output.x),r=0;r<this.output.x;r++)this.thread.x=r,this.thread.y=0,this.thread.z=0,t[r]=this._fn.apply(this,e);return t}function a(){for(var e=n(arguments),t=new Array(this.output.y),r=0;r<this.output.y;r++){for(var i=new Float32Array(this.output.x),a=0;a<this.output.x;a++)this.thread.x=a,this.thread.y=r,this.thread.z=0,i[a]=this._fn.apply(this,e);t[r]=i}return t}function o(){for(var e=n(arguments),t=0;t<this.output.y;t++)for(var r=0;r<this.output.x;r++)this.thread.x=r,this.thread.y=t,this.thread.z=0,this._fn.apply(this,e)}function s(){for(var e=n(arguments),t=new Array(this.output.z),r=0;r<this.output.z;r++){for(var i=new Array(this.output.y),a=0;a<this.output.y;a++){for(var o=new Float32Array(this.output.x),s=0;s<this.output.x;s++)this.thread.x=s,this.thread.y=a,this.thread.z=r,o[s]=this._fn.apply(this,e);i[a]=o}t[r]=i}return t}function u(e){e.setOutput=function(t){e.output=l(t),e.graphical&&c(e)},e.toJSON=function(){throw new Error("Not usable with gpuMock")},e.setConstants=function(t){return e.constants=t,e},e.setGraphical=function(t){return e.graphical=t,e},e.setCanvas=function(t){return e.canvas=t,e},e.setContext=function(t){return e.context=t,e},e.destroy=function(){},e.validateSettings=function(){},e.graphical&&e.output&&c(e),e.exec=function(){var t=arguments;return new Promise((function(r,n){try{r(e.apply(e,t))}catch(e){n(e)}}))},e.getPixels=function(t){var r=e.output,n=r.x,i=r.y;return t?function(e,t,r){for(var n=r/2|0,i=4*t,a=new Uint8ClampedArray(4*t),o=e.slice(0),s=0;s<n;++s){var u=s*i,c=(r-s-1)*i;a.set(o.subarray(u,u+i)),o.copyWithin(u,c,c+i),o.set(a,c)}return o}(e._imageData.data,n,i):e._imageData.data.slice(0)},e.color=function(t,r,n,i){void 0===i&&(i=1),t=Math.floor(255*t),r=Math.floor(255*r),n=Math.floor(255*n),i=Math.floor(255*i);var a=e.output.x,o=e.output.y,s=e.thread.x+(o-e.thread.y-1)*a;e._colorData[4*s+0]=t,e._colorData[4*s+1]=r,e._colorData[4*s+2]=n,e._colorData[4*s+3]=i};for(var t=function(){return e},r=["setWarnVarUsage","setArgumentTypes","setTactic","setOptimizeFloatMemory","setDebug","setLoopMaxIterations","setConstantTypes","setFunctions","setNativeFunctions","setInjectedNative","setPipeline","setPrecision","setOutputToTexture","setImmutable","setStrictIntegers","setDynamicOutput","setHardcodeConstants","setDynamicArguments","setUseLegacyEncoder","setWarnVarUsage","addSubKernel"],n=0;n<r.length;n++)e[r[n]]=t;return e}function c(e){var t=e.output,r=t.x,n=t.y;if(e.context&&e.context.createImageData){var i=new Uint8ClampedArray(r*n*4);e._imageData=e.context.createImageData(r,n),e._colorData=i}else{var a=new Uint8ClampedArray(r*n*4);e._imageData={data:a},e._colorData=a}}function l(e){var t=null;if(e.length)if(3===e.length){var r=f(e,3);t={x:r[0],y:r[1],z:r[2]}}else if(2===e.length){var n=f(e,2);t={x:n[0],y:n[1]}}else t={x:f(e,1)[0]};else t=e;return t}t.exports={gpuMock:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.output?l(t.output):null;function n(){return n.output.z?s.apply(n,arguments):n.output.y?n.graphical?o.apply(n,arguments):a.apply(n,arguments):i.apply(n,arguments)}return n._fn=e,n.constants=t.constants||null,n.context=t.context||null,n.canvas=t.canvas||null,n.graphical=t.graphical||!1,n._imageData=null,n._colorData=null,n.output=r,n.thread={x:0,y:0,z:0},u(n)}}},{}],5:[function(e,t,r){var n=e("./utils").utils;t.exports={alias:function(e,t){var r=t.toString();return new Function("return function ".concat(e," (").concat(n.getArgumentNamesFromString(r).join(", "),") {\n  ").concat(n.getFunctionBodyFromString(r),"\n}"))()}}},{"./utils":113}],6:[function(e,t,r){var n=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"astFunction",value:function(e,t){if(!this.isRootKernel){t.push("function"),t.push(" "),t.push(this.name),t.push("(");for(var r=0;r<this.argumentNames.length;++r){var n=this.argumentNames[r];r>0&&t.push(", "),t.push("user_"),t.push(n)}t.push(") {\n")}for(var i=0;i<e.body.body.length;++i)this.astGeneric(e.body.body[i],t),t.push("\n");return this.isRootKernel||t.push("}\n"),t}},{key:"astReturnStatement",value:function(e,t){var r=this.returnType||this.getType(e.argument);return this.returnType||(this.returnType=r),this.isRootKernel?(t.push(this.leadingReturnStatement),this.astGeneric(e.argument,t),t.push(";\n"),t.push(this.followingReturnStatement),t.push("continue;\n")):this.isSubKernel?(t.push("subKernelResult_".concat(this.name," = ")),this.astGeneric(e.argument,t),t.push(";"),t.push("return subKernelResult_".concat(this.name,";"))):(t.push("return "),this.astGeneric(e.argument,t),t.push(";")),t}},{key:"astLiteral",value:function(e,t){if(isNaN(e.value))throw this.astErrorOutput("Non-numeric literal not supported : "+e.value,e);return t.push(e.value),t}},{key:"astBinaryExpression",value:function(e,t){return t.push("("),this.astGeneric(e.left,t),t.push(e.operator),this.astGeneric(e.right,t),t.push(")"),t}},{key:"astIdentifierExpression",value:function(e,t){if("Identifier"!==e.type)throw this.astErrorOutput("IdentifierExpression - not an Identifier",e);switch(e.name){case"Infinity":t.push("Infinity");break;default:this.constants&&this.constants.hasOwnProperty(e.name)?t.push("constants_"+e.name):t.push("user_"+e.name)}return t}},{key:"astForStatement",value:function(e,t){if("ForStatement"!==e.type)throw this.astErrorOutput("Invalid for statement",e);var r=[],n=[],i=[],a=[],o=null;if(e.init){this.pushState("in-for-loop-init"),this.astGeneric(e.init,r);for(var s=0;s<r.length;s++)r[s].includes&&r[s].includes(",")&&(o=!1);this.popState("in-for-loop-init")}else o=!1;if(e.test?this.astGeneric(e.test,n):o=!1,e.update?this.astGeneric(e.update,i):o=!1,e.body&&(this.pushState("loop-body"),this.astGeneric(e.body,a),this.popState("loop-body")),null===o&&(o=this.isSafe(e.init)&&this.isSafe(e.test)),o)t.push("for (".concat(r.join(""),";").concat(n.join(""),";").concat(i.join(""),"){\n")),t.push(a.join("")),t.push("}\n");else{var u=this.getInternalVariableName("safeI");r.length>0&&t.push(r.join(""),";\n"),t.push("for (let ".concat(u,"=0;").concat(u,"<LOOP_MAX;").concat(u,"++){\n")),n.length>0&&t.push("if (!".concat(n.join(""),") break;\n")),t.push(a.join("")),t.push("\n".concat(i.join(""),";")),t.push("}\n")}return t}},{key:"astWhileStatement",value:function(e,t){if("WhileStatement"!==e.type)throw this.astErrorOutput("Invalid while statement",e);return t.push("for (let i = 0; i < LOOP_MAX; i++) {"),t.push("if ("),this.astGeneric(e.test,t),t.push(") {\n"),this.astGeneric(e.body,t),t.push("} else {\n"),t.push("break;\n"),t.push("}\n"),t.push("}\n"),t}},{key:"astDoWhileStatement",value:function(e,t){if("DoWhileStatement"!==e.type)throw this.astErrorOutput("Invalid while statement",e);return t.push("for (let i = 0; i < LOOP_MAX; i++) {"),this.astGeneric(e.body,t),t.push("if (!"),this.astGeneric(e.test,t),t.push(") {\n"),t.push("break;\n"),t.push("}\n"),t.push("}\n"),t}},{key:"astAssignmentExpression",value:function(e,t){var r=this.getDeclaration(e.left);if(r&&!r.assignable)throw this.astErrorOutput("Variable ".concat(e.left.name," is not assignable here"),e);return this.astGeneric(e.left,t),t.push(e.operator),this.astGeneric(e.right,t),t}},{key:"astBlockStatement",value:function(e,t){if(this.isState("loop-body")){this.pushState("block-body");for(var r=0;r<e.body.length;r++)this.astGeneric(e.body[r],t);this.popState("block-body")}else{t.push("{\n");for(var n=0;n<e.body.length;n++)this.astGeneric(e.body[n],t);t.push("}\n")}return t}},{key:"astVariableDeclaration",value:function(e,t){"var"===e.kind&&this.warnVarUsage&&this.varWarn(),t.push("".concat(e.kind," "));for(var r=e.declarations,n=0;n<r.length;n++)n>0&&t.push(","),this.astGeneric(r[n],t);return this.isState("in-for-loop-init")||t.push(";"),t}},{key:"astIfStatement",value:function(e,t){return t.push("if ("),this.astGeneric(e.test,t),t.push(")"),"BlockStatement"===e.consequent.type?this.astGeneric(e.consequent,t):(t.push(" {\n"),this.astGeneric(e.consequent,t),t.push("\n}\n")),e.alternate&&(t.push("else "),"BlockStatement"===e.alternate.type||"IfStatement"===e.alternate.type?this.astGeneric(e.alternate,t):(t.push(" {\n"),this.astGeneric(e.alternate,t),t.push("\n}\n"))),t}},{key:"astSwitchStatement",value:function(e,t){var r=e.discriminant,n=e.cases;t.push("switch ("),this.astGeneric(r,t),t.push(") {\n");for(var i=0;i<n.length;i++)null!==n[i].test?(t.push("case "),this.astGeneric(n[i].test,t),t.push(":\n"),n[i].consequent&&n[i].consequent.length>0&&(this.astGeneric(n[i].consequent,t),t.push("break;\n"))):(t.push("default:\n"),this.astGeneric(n[i].consequent,t),n[i].consequent&&n[i].consequent.length>0&&t.push("break;\n"));t.push("\n}")}},{key:"astThisExpression",value:function(e,t){return t.push("_this"),t}},{key:"astMemberExpression",value:function(e,t){var r=this.getMemberExpressionDetails(e),n=r.signature,i=r.type,a=r.property,o=r.xProperty,s=r.yProperty,u=r.zProperty,c=r.name,l=r.origin;switch(n){case"this.thread.value":return t.push("_this.thread.".concat(c)),t;case"this.output.value":switch(c){case"x":t.push("outputX");break;case"y":t.push("outputY");break;case"z":t.push("outputZ");break;default:throw this.astErrorOutput("Unexpected expression",e)}return t;case"value":throw this.astErrorOutput("Unexpected expression",e);case"value[]":case"value[][]":case"value[][][]":case"value.value":if("Math"===l)return t.push(Math[c]),t;switch(a){case"r":return t.push("user_".concat(c,"[0]")),t;case"g":return t.push("user_".concat(c,"[1]")),t;case"b":return t.push("user_".concat(c,"[2]")),t;case"a":return t.push("user_".concat(c,"[3]")),t}break;case"value.value[]":return this.removeIstanbulCoverage||t.push("".concat(e.object.object.name,".").concat(e.object.property.name,"[").concat(e.property.value,"]")),t;case"value.value[][]":return this.removeIstanbulCoverage||t.push("".concat(e.object.object.object.name,".").concat(e.object.object.property.name,"[").concat(e.object.property.value,"][").concat(e.property.value,"]")),t;case"this.constants.value":case"this.constants.value[]":case"this.constants.value[][]":case"this.constants.value[][][]":break;case"fn()[]":return this.astGeneric(e.object,t),t.push("["),this.astGeneric(e.property,t),t.push("]"),t;default:throw this.astErrorOutput("Unexpected expression",e)}if(!e.computed)switch(i){case"Number":case"Integer":case"Float":case"Boolean":return t.push("".concat(l,"_").concat(c)),t}var h="".concat(l,"_").concat(c);switch(i){case"Array(2)":case"Array(3)":case"Array(4)":case"HTMLImageArray":case"ArrayTexture(1)":case"ArrayTexture(2)":case"ArrayTexture(3)":case"ArrayTexture(4)":case"HTMLImage":default:var p,f;if("constants"===l){var d=this.constants[c];p=(f="Input"===this.constantTypes[c])?d.size:null}else p=(f=this.isInput(c))?this.argumentSizes[this.argumentNames.indexOf(c)]:null;t.push("".concat(h)),u&&s?f?(t.push("[("),this.astGeneric(u,t),t.push("*".concat(this.dynamicArguments?"(outputY * outputX)":p[1]*p[0],")+(")),this.astGeneric(s,t),t.push("*".concat(this.dynamicArguments?"outputX":p[0],")+")),this.astGeneric(o,t),t.push("]")):(t.push("["),this.astGeneric(u,t),t.push("]"),t.push("["),this.astGeneric(s,t),t.push("]"),t.push("["),this.astGeneric(o,t),t.push("]")):s?f?(t.push("[("),this.astGeneric(s,t),t.push("*".concat(this.dynamicArguments?"outputX":p[0],")+")),this.astGeneric(o,t),t.push("]")):(t.push("["),this.astGeneric(s,t),t.push("]"),t.push("["),this.astGeneric(o,t),t.push("]")):void 0!==o&&(t.push("["),this.astGeneric(o,t),t.push("]"))}return t}},{key:"astCallExpression",value:function(e,t){if("CallExpression"!==e.type)throw this.astErrorOutput("Unknown CallExpression",e);var r=this.astMemberExpressionUnroll(e.callee);this.calledFunctions.indexOf(r)<0&&this.calledFunctions.push(r),this.isAstMathFunction(e),this.onFunctionCall&&this.onFunctionCall(this.name,r,e.arguments),t.push(r),t.push("(");for(var n=this.lookupFunctionArgumentTypes(r)||[],i=0;i<e.arguments.length;++i){var a=e.arguments[i],o=this.getType(a);n[i]||this.triggerImplyArgumentType(r,i,o,this),i>0&&t.push(", "),this.astGeneric(a,t)}return t.push(")"),t}},{key:"astArrayExpression",value:function(e,t){var r=e.elements.length;t.push("new Float32Array([");for(var n=0;n<r;++n){n>0&&t.push(", ");var i=e.elements[n];this.astGeneric(i,t)}return t.push("])"),t}},{key:"astDebuggerStatement",value:function(e,t){return t.push("debugger;"),t}}]),r}(e("../function-node").FunctionNode);t.exports={CPUFunctionNode:n}},{"../function-node":10}],7:[function(e,t,r){var n=e("../../utils").utils;t.exports={cpuKernelString:function(e,t){var r=[],i=[],a=[],o=!/^function/.test(e.color.toString());if(r.push("  const { context, canvas, constants: incomingConstants } = settings;","  const output = new Int32Array(".concat(JSON.stringify(Array.from(e.output)),");"),"  const _constantTypes = ".concat(JSON.stringify(e.constantTypes),";"),"  const _constants = ".concat(function(e,t){var r=[];for(var n in t)if(t.hasOwnProperty(n)){var i=t[n],a=e[n];switch(i){case"Number":case"Integer":case"Float":case"Boolean":r.push("".concat(n,":").concat(a));break;case"Array(2)":case"Array(3)":case"Array(4)":r.push("".concat(n,":new ").concat(a.constructor.name,"(").concat(JSON.stringify(Array.from(a)),")"))}}return"{ ".concat(r.join()," }")}(e.constants,e.constantTypes),";")),i.push("    constants: _constants,","    context,","    output,","    thread: {x: 0, y: 0, z: 0},"),e.graphical){r.push("  const _imageData = context.createImageData(".concat(e.output[0],", ").concat(e.output[1],");")),r.push("  const _colorData = new Uint8ClampedArray(".concat(e.output[0]," * ").concat(e.output[1]," * 4);"));var s=n.flattenFunctionToString((o?"function ":"")+e.color.toString(),{thisLookup:function(t){switch(t){case"_colorData":return"_colorData";case"_imageData":return"_imageData";case"output":return"output";case"thread":return"this.thread"}return JSON.stringify(e[t])},findDependency:function(e,t){return null}}),u=n.flattenFunctionToString((o?"function ":"")+e.getPixels.toString(),{thisLookup:function(t){switch(t){case"_colorData":return"_colorData";case"_imageData":return"_imageData";case"output":return"output";case"thread":return"this.thread"}return JSON.stringify(e[t])},findDependency:function(){return null}});i.push("    _imageData,","    _colorData,","    color: ".concat(s,",")),a.push("  kernel.getPixels = ".concat(u,";"))}for(var c=[],l=Object.keys(e.constantTypes),h=0;h<l.length;h++)c.push(e.constantTypes[l]);if(-1!==e.argumentTypes.indexOf("HTMLImageArray")||-1!==c.indexOf("HTMLImageArray")){var p=n.flattenFunctionToString((o?"function ":"")+e._imageTo3DArray.toString(),{doNotDefine:["canvas"],findDependency:function(t,r){return"this"===t?(o?"function ":"")+e[r].toString():null},thisLookup:function(e){switch(e){case"canvas":return;case"context":return"context"}}});a.push(p),i.push("    _mediaTo2DArray,"),i.push("    _imageTo3DArray,")}else if(-1!==e.argumentTypes.indexOf("HTMLImage")||-1!==c.indexOf("HTMLImage")){var f=n.flattenFunctionToString((o?"function ":"")+e._mediaTo2DArray.toString(),{findDependency:function(e,t){return null},thisLookup:function(e){switch(e){case"canvas":return"settings.canvas";case"context":return"settings.context"}throw new Error("unhandled thisLookup")}});a.push(f),i.push("    _mediaTo2DArray,")}return"function(settings) {\n".concat(r.join("\n"),"\n  for (const p in _constantTypes) {\n    if (!_constantTypes.hasOwnProperty(p)) continue;\n    const type = _constantTypes[p];\n    switch (type) {\n      case 'Number':\n      case 'Integer':\n      case 'Float':\n      case 'Boolean':\n      case 'Array(2)':\n      case 'Array(3)':\n      case 'Array(4)':\n        if (incomingConstants.hasOwnProperty(p)) {\n          console.warn('constant ' + p + ' of type ' + type + ' cannot be resigned');\n        }\n        continue;\n    }\n    if (!incomingConstants.hasOwnProperty(p)) {\n      throw new Error('constant ' + p + ' not found');\n    }\n    _constants[p] = incomingConstants[p];\n  }\n  const kernel = (function() {\n").concat(e._kernelString,"\n  })\n    .apply({ ").concat(i.join("\n")," });\n  ").concat(a.join("\n"),"\n  return kernel;\n}")}}},{"../../utils":113}],8:[function(e,t,r){var n=e("../kernel").Kernel,i=e("../function-builder").FunctionBuilder,a=e("./function-node").CPUFunctionNode,o=e("../../utils").utils,d=e("./kernel-string").cpuKernelString,m=function(e){"use strict";h(r,e);var t=p(r);function r(e,n){var i;return c(this,r),(i=t.call(this,e,n)).mergeSettings(e.settings||n),i._imageData=null,i._colorData=null,i._kernelString=null,i._prependedString=[],i.thread={x:0,y:0,z:0},i.translatedSources=null,i}return l(r,null,[{key:"getFeatures",value:function(){return this.features}},{key:"isContextMatch",value:function(e){return!1}},{key:"nativeFunctionArguments",value:function(){return null}},{key:"nativeFunctionReturnType",value:function(){return null}},{key:"combineKernels",value:function(e){return e}},{key:"features",get:function(){return Object.freeze({kernelMap:!0,isIntegerDivisionAccurate:!0})}},{key:"isSupported",get:function(){return!0}},{key:"mode",get:function(){return"cpu"}}]),l(r,[{key:"initCanvas",value:function(){return"undefined"!=typeof document?document.createElement("canvas"):"undefined"!=typeof OffscreenCanvas?new OffscreenCanvas(0,0):void 0}},{key:"initContext",value:function(){return this.canvas?this.canvas.getContext("2d"):null}},{key:"initPlugins",value:function(e){return[]}},{key:"validateSettings",value:function(e){if(!this.output||0===this.output.length){if(1!==e.length)throw new Error("Auto output only supported for kernels with only one input");var t=o.getVariableType(e[0],this.strictIntegers);if("Array"===t)this.output=o.getDimensions(t);else{if("NumberTexture"!==t&&"ArrayTexture(4)"!==t)throw new Error("Auto output not supported for input type: "+t);this.output=e[0].output}}if(this.graphical&&2!==this.output.length)throw new Error("Output must have 2 dimensions on graphical mode");this.checkOutput()}},{key:"translateSource",value:function(){if(this.leadingReturnStatement=this.output.length>1?"resultX[x] = ":"result[x] = ",this.subKernels){for(var e=[],t=0;t<this.subKernels.length;t++){var r=this.subKernels[t].name;e.push(this.output.length>1?"resultX_".concat(r,"[x] = subKernelResult_").concat(r,";\n"):"result_".concat(r,"[x] = subKernelResult_").concat(r,";\n"))}this.followingReturnStatement=e.join("")}var n=i.fromKernel(this,a);this.translatedSources=n.getPrototypes("kernel"),this.graphical||this.returnType||(this.returnType=n.getKernelResultType())}},{key:"build",value:function(){if(this.setupConstants(),this.setupArguments(arguments),this.validateSettings(arguments),this.translateSource(),this.graphical){var e=this.canvas,t=this.output;if(!e)throw new Error("no canvas available for using graphical output");var r=t[0],n=t[1]||1;e.width=r,e.height=n,this._imageData=this.context.createImageData(r,n),this._colorData=new Uint8ClampedArray(r*n*4)}var i=this.getKernelString();this.kernelString=i,this.debug&&(console.log("Function output:"),console.log(i));try{this.run=new Function([],i).bind(this)()}catch(e){console.error("An error occurred compiling the javascript: ",e)}this.built=!0}},{key:"color",value:function(e,t,r,n){void 0===n&&(n=1),e=Math.floor(255*e),t=Math.floor(255*t),r=Math.floor(255*r),n=Math.floor(255*n);var i=this.output[0],a=this.output[1],o=this.thread.x+(a-this.thread.y-1)*i;this._colorData[4*o+0]=e,this._colorData[4*o+1]=t,this._colorData[4*o+2]=r,this._colorData[4*o+3]=n}},{key:"getKernelString",value:function(){if(null!==this._kernelString)return this._kernelString;var e=null,t=this.translatedSources;return t.length>1?t=t.filter((function(t){return/^function/.test(t)?t:(e=t,!1)})):e=t.shift(),this._kernelString="  const LOOP_MAX = ".concat(this._getLoopMaxString(),";\n  ").concat(this.injectedNative||"","\n  const _this = this;\n  ").concat(this._processConstants(),"\n  return (").concat(this.argumentNames.map((function(e){return"user_"+e})).join(", "),") => {\n    ").concat(this._prependedString.join(""),"\n    ").concat(this._processArguments(),"\n    ").concat(this.graphical?this._graphicalKernelBody(e):this._resultKernelBody(e),"\n    ").concat(t.length>0?t.join("\n"):"","\n  };")}},{key:"toString",value:function(){return d(this)}},{key:"_getLoopMaxString",value:function(){return this.loopMaxIterations?" ".concat(parseInt(this.loopMaxIterations),";"):" 1000;"}},{key:"_processConstants",value:function(){if(!this.constants)return"";var e=[];for(var t in this.constants)switch(this.constantTypes[t]){case"HTMLImage":case"HTMLVideo":e.push("    const constants_".concat(t," = this._mediaTo2DArray(this.constants.").concat(t,");\n"));break;case"HTMLImageArray":e.push("    const constants_".concat(t," = this._imageTo3DArray(this.constants.").concat(t,");\n"));break;case"Input":e.push("    const constants_".concat(t," = this.constants.").concat(t,".value;\n"));break;default:e.push("    const constants_".concat(t," = this.constants.").concat(t,";\n"))}return e.join("")}},{key:"_processArguments",value:function(){for(var e=[],t=0;t<this.argumentTypes.length;t++){var r="user_".concat(this.argumentNames[t]);switch(this.argumentTypes[t]){case"HTMLImage":case"HTMLVideo":e.push("    ".concat(r," = this._mediaTo2DArray(").concat(r,");\n"));break;case"HTMLImageArray":e.push("    ".concat(r," = this._imageTo3DArray(").concat(r,");\n"));break;case"Input":e.push("    ".concat(r," = ").concat(r,".value;\n"));break;case"ArrayTexture(1)":case"ArrayTexture(2)":case"ArrayTexture(3)":case"ArrayTexture(4)":case"NumberTexture":case"MemoryOptimizedNumberTexture":e.push("\n    if (".concat(r,".toArray) {\n      if (!_this.textureCache) {\n        _this.textureCache = [];\n        _this.arrayCache = [];\n      }\n      const textureIndex = _this.textureCache.indexOf(").concat(r,");\n      if (textureIndex !== -1) {\n        ").concat(r," = _this.arrayCache[textureIndex];\n      } else {\n        _this.textureCache.push(").concat(r,");\n        ").concat(r," = ").concat(r,".toArray();\n        _this.arrayCache.push(").concat(r,");\n      }\n    }"))}}return e.join("")}},{key:"_mediaTo2DArray",value:function(e){var t=this.canvas,r=e.width>0?e.width:e.videoWidth,n=e.height>0?e.height:e.videoHeight;t.width<r&&(t.width=r),t.height<n&&(t.height=n);var i=this.context;i.drawImage(e,0,0,r,n);for(var a=i.getImageData(0,0,r,n).data,o=new Array(n),s=0,u=n-1;u>=0;u--)for(var c=o[u]=new Array(r),l=0;l<r;l++){var h=new Float32Array(4);h[0]=a[s++]/255,h[1]=a[s++]/255,h[2]=a[s++]/255,h[3]=a[s++]/255,c[l]=h}return o}},{key:"getPixels",value:function(e){var t=f(this.output,2),r=t[0],n=t[1];return e?o.flipPixels(this._imageData.data,r,n):this._imageData.data.slice(0)}},{key:"_imageTo3DArray",value:function(e){for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=this._mediaTo2DArray(e[r]);return t}},{key:"_resultKernelBody",value:function(e){switch(this.output.length){case 1:return this._resultKernel1DLoop(e)+this._kernelOutput();case 2:return this._resultKernel2DLoop(e)+this._kernelOutput();case 3:return this._resultKernel3DLoop(e)+this._kernelOutput();default:throw new Error("unsupported size kernel")}}},{key:"_graphicalKernelBody",value:function(e){switch(this.output.length){case 2:return this._graphicalKernel2DLoop(e)+this._graphicalOutput();default:throw new Error("unsupported size kernel")}}},{key:"_graphicalOutput",value:function(){return"\n    this._imageData.data.set(this._colorData);\n    this.context.putImageData(this._imageData, 0, 0);\n    return;"}},{key:"_getKernelResultTypeConstructorString",value:function(){switch(this.returnType){case"LiteralInteger":case"Number":case"Integer":case"Float":return"Float32Array";case"Array(2)":case"Array(3)":case"Array(4)":return"Array";default:if(this.graphical)return"Float32Array";throw new Error("unhandled returnType ".concat(this.returnType))}}},{key:"_resultKernel1DLoop",value:function(e){var t=this._getKernelResultTypeConstructorString();return"  const outputX = _this.output[0];\n    const result = new ".concat(t,"(outputX);\n    ").concat(this._mapSubKernels((function(e){return"const result_".concat(e.name," = new ").concat(t,"(outputX);\n")})).join("    "),"\n    ").concat(this._mapSubKernels((function(e){return"let subKernelResult_".concat(e.name,";\n")})).join("    "),"\n    for (let x = 0; x < outputX; x++) {\n      this.thread.x = x;\n      this.thread.y = 0;\n      this.thread.z = 0;\n      ").concat(e,"\n    }")}},{key:"_resultKernel2DLoop",value:function(e){var t=this._getKernelResultTypeConstructorString();return"  const outputX = _this.output[0];\n    const outputY = _this.output[1];\n    const result = new Array(outputY);\n    ".concat(this._mapSubKernels((function(e){return"const result_".concat(e.name," = new Array(outputY);\n")})).join("    "),"\n    ").concat(this._mapSubKernels((function(e){return"let subKernelResult_".concat(e.name,";\n")})).join("    "),"\n    for (let y = 0; y < outputY; y++) {\n      this.thread.z = 0;\n      this.thread.y = y;\n      const resultX = result[y] = new ").concat(t,"(outputX);\n      ").concat(this._mapSubKernels((function(e){return"const resultX_".concat(e.name," = result_").concat(e.name,"[y] = new ").concat(t,"(outputX);\n")})).join(""),"\n      for (let x = 0; x < outputX; x++) {\n        this.thread.x = x;\n        ").concat(e,"\n      }\n    }")}},{key:"_graphicalKernel2DLoop",value:function(e){var t=this._getKernelResultTypeConstructorString();return"  const outputX = _this.output[0];\n    const outputY = _this.output[1];\n    ".concat(this._mapSubKernels((function(e){return"const result_".concat(e.name," = new Array(outputY);\n")})).join("    "),"\n    ").concat(this._mapSubKernels((function(e){return"let subKernelResult_".concat(e.name,";\n")})).join("    "),"\n    for (let y = 0; y < outputY; y++) {\n      this.thread.z = 0;\n      this.thread.y = y;\n      ").concat(this._mapSubKernels((function(e){return"const resultX_".concat(e.name," = result_").concat(e.name,"[y] = new ").concat(t,"(outputX);\n")})).join(""),"\n      for (let x = 0; x < outputX; x++) {\n        this.thread.x = x;\n        ").concat(e,"\n      }\n    }")}},{key:"_resultKernel3DLoop",value:function(e){var t=this._getKernelResultTypeConstructorString();return"  const outputX = _this.output[0];\n    const outputY = _this.output[1];\n    const outputZ = _this.output[2];\n    const result = new Array(outputZ);\n    ".concat(this._mapSubKernels((function(e){return"const result_".concat(e.name," = new Array(outputZ);\n")})).join("    "),"\n    ").concat(this._mapSubKernels((function(e){return"let subKernelResult_".concat(e.name,";\n")})).join("    "),"\n    for (let z = 0; z < outputZ; z++) {\n      this.thread.z = z;\n      const resultY = result[z] = new Array(outputY);\n      ").concat(this._mapSubKernels((function(e){return"const resultY_".concat(e.name," = result_").concat(e.name,"[z] = new Array(outputY);\n")})).join("      "),"\n      for (let y = 0; y < outputY; y++) {\n        this.thread.y = y;\n        const resultX = resultY[y] = new ").concat(t,"(outputX);\n        ").concat(this._mapSubKernels((function(e){return"const resultX_".concat(e.name," = resultY_").concat(e.name,"[y] = new ").concat(t,"(outputX);\n")})).join("        "),"\n        for (let x = 0; x < outputX; x++) {\n          this.thread.x = x;\n          ").concat(e,"\n        }\n      }\n    }")}},{key:"_kernelOutput",value:function(){return this.subKernels?"\n    return {\n      result: result,\n      ".concat(this.subKernels.map((function(e){return"".concat(e.property,": result_").concat(e.name)})).join(",\n      "),"\n    };"):"\n    return result;"}},{key:"_mapSubKernels",value:function(e){return null===this.subKernels?[""]:this.subKernels.map(e)}},{key:"destroy",value:function(e){e&&delete this.canvas}},{key:"toJSON",value:function(){var e=s(u(r.prototype),"toJSON",this).call(this);return e.functionNodes=i.fromKernel(this,a).toJSON(),e}},{key:"setOutput",value:function(e){s(u(r.prototype),"setOutput",this).call(this,e);var t=f(this.output,2),n=t[0],i=t[1];this.graphical&&(this._imageData=this.context.createImageData(n,i),this._colorData=new Uint8ClampedArray(n*i*4))}},{key:"prependString",value:function(e){if(this._kernelString)throw new Error("Kernel already built");this._prependedString.push(e)}},{key:"hasPrependString",value:function(e){return this._prependedString.indexOf(e)>-1}}],[{key:"destroyContext",value:function(e){}}]),r}(n);t.exports={CPUKernel:m}},{"../../utils":113,"../function-builder":9,"../kernel":36,"./function-node":6,"./kernel-string":7}],9:[function(e,t,r){var n=function(){"use strict";function e(t){if(c(this,e),t=t||{},this.kernel=t.kernel,this.rootNode=t.rootNode,this.functionNodes=t.functionNodes||[],this.subKernelNodes=t.subKernelNodes||[],this.nativeFunctions=t.nativeFunctions||[],this.functionMap={},this.nativeFunctionNames=[],this.lookupChain=[],this.functionNodeDependencies={},this.functionCalls={},this.rootNode&&(this.functionMap.kernel=this.rootNode),this.functionNodes)for(var r=0;r<this.functionNodes.length;r++)this.functionMap[this.functionNodes[r].name]=this.functionNodes[r];if(this.subKernelNodes)for(var n=0;n<this.subKernelNodes.length;n++)this.functionMap[this.subKernelNodes[n].name]=this.subKernelNodes[n];if(this.nativeFunctions)for(var i=0;i<this.nativeFunctions.length;i++){var a=this.nativeFunctions[i];this.nativeFunctionNames.push(a.name)}}return l(e,null,[{key:"fromKernel",value:function(t,r,n){for(var i=t.kernelArguments,a=t.kernelConstants,o=t.argumentNames,s=t.argumentSizes,u=t.argumentBitRatios,c=t.constants,l=t.constantBitRatios,h=t.debug,p=t.loopMaxIterations,f=t.nativeFunctions,m=t.output,y=t.optimizeFloatMemory,g=t.precision,v=t.plugins,E=t.source,T=t.subKernels,b=t.functions,x=t.leadingReturnStatement,A=t.followingReturnStatement,S=t.dynamicArguments,R=t.dynamicOutput,w=t.warnVarUsage,C=t.onIstanbulCoverageVariable,O=t.removeIstanbulCoverage,k=new Array(i.length),N={},_=0;_<i.length;_++)k[_]=i[_].type;for(var I=0;I<a.length;I++){var M=a[I];N[M.name]=M.type}var P=function(e,t){return q.needsArgumentType(e,t)},L=function(e,t,r){q.assignArgumentType(e,t,r)},F=function(e,t,r){return q.lookupReturnType(e,t,r)},D=function(e){return q.lookupFunctionArgumentTypes(e)},U=function(e,t){return q.lookupFunctionArgumentName(e,t)},V=function(e,t){return q.lookupFunctionArgumentBitRatio(e,t)},j=function(e,t,r,n){q.assignArgumentType(e,t,r,n)},G=function(e,t,r,n){q.assignArgumentBitRatio(e,t,r,n)},B=function(e,t,r){q.trackFunctionCall(e,t,r)},z=function(e,t){for(var n=[],i=0;i<e.params.length;i++)n.push(e.params[i].name);var a=new r(null,Object.assign({},W,{returnType:null,ast:e,name:e.id.name,argumentNames:n,lookupReturnType:F,lookupFunctionArgumentTypes:D,lookupFunctionArgumentName:U,lookupFunctionArgumentBitRatio:V,needsArgumentType:P,assignArgumentType:L,triggerImplyArgumentType:j,triggerImplyArgumentBitRatio:G,onFunctionCall:B,warnVarUsage:w}));a.traceFunctionAST(e),q.addFunctionNode(a)},W=Object.assign({isRootKernel:!1,onNestedFunction:z,lookupReturnType:F,lookupFunctionArgumentTypes:D,lookupFunctionArgumentName:U,lookupFunctionArgumentBitRatio:V,needsArgumentType:P,assignArgumentType:L,triggerImplyArgumentType:j,triggerImplyArgumentBitRatio:G,onFunctionCall:B,warnVarUsage:w,onIstanbulCoverageVariable:C?function(e){return C(e,t)}:null,removeIstanbulCoverage:O,optimizeFloatMemory:y,precision:g,constants:c,constantTypes:N,constantBitRatios:l,debug:h,loopMaxIterations:p,output:m,plugins:v,dynamicArguments:S,dynamicOutput:R},n||{}),K=Object.assign({},W,{isRootKernel:!0,name:"kernel",argumentNames:o,argumentTypes:k,argumentSizes:s,argumentBitRatios:u,leadingReturnStatement:x,followingReturnStatement:A});if("object"===d(E)&&E.functionNodes)return(new e).fromJSON(E.functionNodes,r);var H=new r(E,K),X=null;b&&(X=b.map((function(e){return new r(e.source,{returnType:e.returnType,argumentTypes:e.argumentTypes,output:m,plugins:v,constants:c,constantTypes:N,constantBitRatios:l,optimizeFloatMemory:y,precision:g,lookupReturnType:F,lookupFunctionArgumentTypes:D,lookupFunctionArgumentName:U,lookupFunctionArgumentBitRatio:V,needsArgumentType:P,assignArgumentType:L,triggerImplyArgumentType:j,triggerImplyArgumentBitRatio:G,onFunctionCall:B,onNestedFunction:z,onIstanbulCoverageVariable:C?function(e){return C(e,t)}:null,removeIstanbulCoverage:O})})));var Y=null;T&&(Y=T.map((function(e){var t=e.name,n=e.source;return new r(n,Object.assign({},W,{name:t,isSubKernel:!0,isRootKernel:!1}))})));var q=new e({kernel:t,rootNode:H,functionNodes:X,nativeFunctions:f,subKernelNodes:Y});return q}}]),l(e,[{key:"addFunctionNode",value:function(e){if(!e.name)throw new Error("functionNode.name needs set");this.functionMap[e.name]=e,e.isRootKernel&&(this.rootNode=e)}},{key:"traceFunctionCalls",value:function(e,t){if(e=e||"kernel",t=t||[],this.nativeFunctionNames.indexOf(e)>-1)return-1===t.indexOf(e)&&t.push(e),t;var r=this.functionMap[e];if(r){var n=t.indexOf(e);if(-1===n){t.push(e),r.toString();for(var i=0;i<r.calledFunctions.length;++i)this.traceFunctionCalls(r.calledFunctions[i],t)}else{var a=t.splice(n,1)[0];t.push(a)}}return t}},{key:"getPrototypeString",value:function(e){return this.getPrototypes(e).join("\n")}},{key:"getPrototypes",value:function(e){return this.rootNode&&this.rootNode.toString(),e?this.getPrototypesFromFunctionNames(this.traceFunctionCalls(e,[]).reverse()):this.getPrototypesFromFunctionNames(Object.keys(this.functionMap))}},{key:"getStringFromFunctionNames",value:function(e){for(var t=[],r=0;r<e.length;++r)this.functionMap[e[r]]&&t.push(this.functionMap[e[r]].toString());return t.join("\n")}},{key:"getPrototypesFromFunctionNames",value:function(e){for(var t=[],r=0;r<e.length;++r){var n=e[r],i=this.nativeFunctionNames.indexOf(n);if(i>-1)t.push(this.nativeFunctions[i].source);else{var a=this.functionMap[n];a&&t.push(a.toString())}}return t}},{key:"toJSON",value:function(){var e=this;return this.traceFunctionCalls(this.rootNode.name).reverse().map((function(t){var r=e.nativeFunctions.indexOf(t);if(r>-1)return{name:t,source:e.nativeFunctions[r].source};if(e.functionMap[t])return e.functionMap[t].toJSON();throw new Error("function ".concat(t," not found"))}))}},{key:"fromJSON",value:function(e,t){this.functionMap={};for(var r=0;r<e.length;r++){var n=e[r];this.functionMap[n.settings.name]=new t(n.ast,n.settings)}return this}},{key:"getString",value:function(e){return e?this.getStringFromFunctionNames(this.traceFunctionCalls(e).reverse()):this.getStringFromFunctionNames(Object.keys(this.functionMap))}},{key:"lookupReturnType",value:function(e,t,r){if("CallExpression"!==t.type)throw new Error('expected ast type of "CallExpression", but is '.concat(t.type));if(this._isNativeFunction(e))return this._lookupNativeFunctionReturnType(e);if(this._isFunction(e)){var n=this._getFunction(e);if(n.returnType)return n.returnType;for(var i=0;i<this.lookupChain.length;i++)if(this.lookupChain[i].ast===t){if(0===n.argumentTypes.length&&t.arguments.length>0){for(var a=t.arguments,o=0;o<a.length;o++)this.lookupChain.push({name:r.name,ast:a[i],requestingNode:r}),n.argumentTypes[o]=r.getType(a[o]),this.lookupChain.pop();return n.returnType=n.getType(n.getJsAST())}throw new Error("circlical logic detected!")}this.lookupChain.push({name:r.name,ast:t,requestingNode:r});var s=n.getType(n.getJsAST());return this.lookupChain.pop(),n.returnType=s}return null}},{key:"_getFunction",value:function(e){return this._isFunction(e)||new Error("Function ".concat(e," not found")),this.functionMap[e]}},{key:"_isFunction",value:function(e){return Boolean(this.functionMap[e])}},{key:"_getNativeFunction",value:function(e){for(var t=0;t<this.nativeFunctions.length;t++)if(this.nativeFunctions[t].name===e)return this.nativeFunctions[t];return null}},{key:"_isNativeFunction",value:function(e){return Boolean(this._getNativeFunction(e))}},{key:"_lookupNativeFunctionReturnType",value:function(e){var t=this._getNativeFunction(e);if(t)return t.returnType;throw new Error("Native function ".concat(e," not found"))}},{key:"lookupFunctionArgumentTypes",value:function(e){return this._isNativeFunction(e)?this._getNativeFunction(e).argumentTypes:this._isFunction(e)?this._getFunction(e).argumentTypes:null}},{key:"lookupFunctionArgumentName",value:function(e,t){return this._getFunction(e).argumentNames[t]}},{key:"lookupFunctionArgumentBitRatio",value:function(e,t){if(!this._isFunction(e))throw new Error("function not found");if(this.rootNode.name===e){var r=this.rootNode.argumentNames.indexOf(t);if(-1!==r)return this.rootNode.argumentBitRatios[r]}var n=this._getFunction(e),i=n.argumentNames.indexOf(t);if(-1===i)throw new Error("argument not found");var a=n.argumentBitRatios[i];if("number"!=typeof a)throw new Error("argument bit ratio not found");return a}},{key:"needsArgumentType",value:function(e,t){return!!this._isFunction(e)&&!this._getFunction(e).argumentTypes[t]}},{key:"assignArgumentType",value:function(e,t,r,n){if(this._isFunction(e)){var i=this._getFunction(e);i.argumentTypes[t]||(i.argumentTypes[t]=r)}}},{key:"assignArgumentBitRatio",value:function(e,t,r,n){var i=this._getFunction(e);if(this._isNativeFunction(r))return null;var a=this._getFunction(r),o=i.argumentNames.indexOf(t);if(-1===o)throw new Error("Argument ".concat(t," not found in arguments from function ").concat(e));var s=i.argumentBitRatios[o];if("number"!=typeof s)throw new Error("Bit ratio for argument ".concat(t," not found in function ").concat(e));a.argumentBitRatios||(a.argumentBitRatios=new Array(a.argumentNames.length));var u=a.argumentBitRatios[o];if("number"==typeof u){if(u!==s)throw new Error("Incompatible bit ratio found at function ".concat(e," at argument ").concat(t));return u}return a.argumentBitRatios[o]=s,s}},{key:"trackFunctionCall",value:function(e,t,r){this.functionNodeDependencies[e]||(this.functionNodeDependencies[e]=new Set,this.functionCalls[e]=[]),this.functionNodeDependencies[e].add(t),this.functionCalls[e].push(r)}},{key:"getKernelResultType",value:function(){return this.rootNode.returnType||this.rootNode.getType(this.rootNode.ast)}},{key:"getSubKernelResultType",value:function(e){for(var t=this.subKernelNodes[e],r=!1,n=0;n<this.rootNode.functionCalls.length;n++)this.rootNode.functionCalls[n].ast.callee.name===t.name&&(r=!0);if(!r)throw new Error("SubKernel ".concat(t.name," never called by kernel"));return t.returnType||t.getType(t.getJsAST())}},{key:"getReturnTypes",value:function(){for(var e=o({},this.rootNode.name,this.rootNode.getType(this.rootNode.ast)),t=this.traceFunctionCalls(this.rootNode.name),r=0;r<t.length;r++){var n=t[r],i=this.functionMap[n];e[n]=i.getType(i.ast)}return e}}]),e}();t.exports={FunctionBuilder:n}},{}],10:[function(e,t,r){var n=e("acorn"),i=e("../utils").utils,a=e("./function-tracer").FunctionTracer,o=function(){"use strict";function e(t,r){if(c(this,e),!t&&!r.ast)throw new Error("source parameter is missing");if(r=r||{},this.source=t,this.ast=null,this.name="string"==typeof t?r.isRootKernel?"kernel":r.name||i.getFunctionNameFromString(t):null,this.calledFunctions=[],this.constants={},this.constantTypes={},this.constantBitRatios={},this.isRootKernel=!1,this.isSubKernel=!1,this.debug=null,this.declarations=null,this.functions=null,this.identifiers=null,this.contexts=null,this.functionCalls=null,this.states=[],this.needsArgumentType=null,this.assignArgumentType=null,this.lookupReturnType=null,this.lookupFunctionArgumentTypes=null,this.lookupFunctionArgumentBitRatio=null,this.triggerImplyArgumentType=null,this.triggerImplyArgumentBitRatio=null,this.onNestedFunction=null,this.onFunctionCall=null,this.optimizeFloatMemory=null,this.precision=null,this.loopMaxIterations=null,this.argumentNames="string"==typeof this.source?i.getArgumentNamesFromString(this.source):null,this.argumentTypes=[],this.argumentSizes=[],this.argumentBitRatios=null,this.returnType=null,this.output=[],this.plugins=null,this.leadingReturnStatement=null,this.followingReturnStatement=null,this.dynamicOutput=null,this.dynamicArguments=null,this.strictTypingChecking=!1,this.fixIntegerDivisionAccuracy=null,this.warnVarUsage=!0,this.onIstanbulCoverageVariable=null,this.removeIstanbulCoverage=!1,r)for(var n in r)r.hasOwnProperty(n)&&this.hasOwnProperty(n)&&(this[n]=r[n]);this.literalTypes={},this.validate(),this._string=null,this._internalVariableNames={}}return l(e,[{key:"validate",value:function(){if("string"!=typeof this.source&&!this.ast)throw new Error("this.source not a string");if(!this.ast&&!i.isFunctionString(this.source))throw new Error("this.source not a function string");if(!this.name)throw new Error("this.name could not be set");if(this.argumentTypes.length>0&&this.argumentTypes.length!==this.argumentNames.length)throw new Error("argumentTypes count of ".concat(this.argumentTypes.length," exceeds ").concat(this.argumentNames.length));if(this.output.length<1)throw new Error("this.output is not big enough")}},{key:"isIdentifierConstant",value:function(e){return!!this.constants&&this.constants.hasOwnProperty(e)}},{key:"isInput",value:function(e){return"Input"===this.argumentTypes[this.argumentNames.indexOf(e)]}},{key:"pushState",value:function(e){this.states.push(e)}},{key:"popState",value:function(e){if(this.state!==e)throw new Error("Cannot popState ".concat(e," when in ").concat(this.state));this.states.pop()}},{key:"isState",value:function(e){return this.state===e}},{key:"astMemberExpressionUnroll",value:function(e){if("Identifier"===e.type)return e.name;if("ThisExpression"===e.type)return"this";if("MemberExpression"===e.type&&e.object&&e.property)return e.object.hasOwnProperty("name")&&"_"===e.object.name[0]?this.astMemberExpressionUnroll(e.property):this.astMemberExpressionUnroll(e.object)+"."+this.astMemberExpressionUnroll(e.property);if(e.hasOwnProperty("expressions")){var t=e.expressions[0];if("Literal"===t.type&&0===t.value&&2===e.expressions.length)return this.astMemberExpressionUnroll(e.expressions[1])}throw this.astErrorOutput("Unknown astMemberExpressionUnroll",e)}},{key:"getJsAST",value:function(e){if(this.ast)return this.ast;if("object"===d(this.source))return this.traceFunctionAST(this.source),this.ast=this.source;if(null===(e=e||n))throw new Error("Missing JS to AST parser");var t=Object.freeze(e.parse("const parser_".concat(this.name," = ").concat(this.source,";"),{locations:!0})),r=t.body[0].declarations[0].init;if(this.traceFunctionAST(r),!t)throw new Error("Failed to parse JS code");return this.ast=r}},{key:"traceFunctionAST",value:function(e){var t=new a(e),r=t.contexts,n=t.declarations,i=t.functions,o=t.identifiers,s=t.functionCalls;this.contexts=r,this.identifiers=o,this.functionCalls=s,this.declarations=[],this.functions=i;for(var u=0;u<n.length;u++){var c=n[u],l=c.ast,h=c.context,p=c.name,f=c.origin,d=c.forceInteger,m=c.assignable,y=l.init,g=this.getDependencies(y),v=null;if(d)v="Integer";else if(y){var E=this.getType(y);switch(E){case"Integer":case"Float":case"Number":v="MemberExpression"===y.type?E:"Number";break;case"LiteralInteger":v="Number";break;default:v=E}}this.declarations.push({valueType:v,dependencies:g,isSafe:this.isSafeDependencies(g),ast:l,name:p,context:h,origin:f,assignable:m})}for(var T=0;T<i.length;T++)this.onNestedFunction(i[T])}},{key:"getDeclaration",value:function(e){for(var t=0;t<this.identifiers.length;t++){var r=this.identifiers[t];if(e===r.ast&&r.context.hasOwnProperty(e.name))for(var n=0;n<this.declarations.length;n++){var i=this.declarations[n];if(i.name===e.name&&i.context[e.name]===r.context[e.name])return i}}return null}},{key:"getVariableType",value:function(e){if("Identifier"!==e.type)throw new Error("ast of ".concat(e.type,' not "Identifier"'));var t=null,r=this.argumentNames.indexOf(e.name);if(-1===r){var n=this.getDeclaration(e);if(n)return n.valueType}else{var i=this.argumentTypes[r];i&&(t=i)}if(!t&&this.strictTypingChecking)throw new Error("Declaration of ".concat(name," not found"));return t}},{key:"getLookupType",value:function(e){if(!s.hasOwnProperty(e))throw new Error("unknown typeLookupMap ".concat(e));return s[e]}},{key:"getConstantType",value:function(e){if(this.constantTypes[e]){var t=this.constantTypes[e];return"Float"===t?"Number":t}throw new Error('Type for constant "'.concat(e,'" not declared'))}},{key:"toString",value:function(){return this._string?this._string:this._string=this.astGeneric(this.getJsAST(),[]).join("").trim()}},{key:"toJSON",value:function(){var e={source:this.source,name:this.name,constants:this.constants,constantTypes:this.constantTypes,isRootKernel:this.isRootKernel,isSubKernel:this.isSubKernel,debug:this.debug,output:this.output,loopMaxIterations:this.loopMaxIterations,argumentNames:this.argumentNames,argumentTypes:this.argumentTypes,argumentSizes:this.argumentSizes,returnType:this.returnType,leadingReturnStatement:this.leadingReturnStatement,followingReturnStatement:this.followingReturnStatement};return{ast:this.ast,settings:e}}},{key:"getType",value:function(e){if(Array.isArray(e))return this.getType(e[e.length-1]);switch(e.type){case"BlockStatement":return this.getType(e.body);case"ArrayExpression":return"Array(".concat(e.elements.length,")");case"Literal":var t=this.astKey(e);return this.literalTypes[t]?this.literalTypes[t]:Number.isInteger(e.value)?"LiteralInteger":!0===e.value||!1===e.value?"Boolean":"Number";case"AssignmentExpression":return this.getType(e.left);case"CallExpression":if(this.isAstMathFunction(e))return"Number";if(!e.callee||!e.callee.name){if("SequenceExpression"===e.callee.type&&e.callee.expressions[e.callee.expressions.length-1].property.name){var r=e.callee.expressions[e.callee.expressions.length-1].property.name;return this.inferArgumentTypesIfNeeded(r,e.arguments),this.lookupReturnType(r,e,this)}throw this.astErrorOutput("Unknown call expression",e)}if(e.callee&&e.callee.name){var n=e.callee.name;return this.inferArgumentTypesIfNeeded(n,e.arguments),this.lookupReturnType(n,e,this)}throw this.astErrorOutput('Unhandled getType Type "'.concat(e.type,'"'),e);case"BinaryExpression":switch(e.operator){case"%":case"/":if(this.fixIntegerDivisionAccuracy)return"Number";break;case">":case"<":return"Boolean";case"&":case"|":case"^":case"<<":case">>":case">>>":return"Integer"}var i=this.getType(e.left);if(this.isState("skip-literal-correction"))return i;if("LiteralInteger"===i){var a=this.getType(e.right);return"LiteralInteger"===a?e.left.value%1==0?"Integer":"Float":a}return s[i]||i;case"UpdateExpression":return this.getType(e.argument);case"UnaryExpression":return"~"===e.operator?"Integer":this.getType(e.argument);case"VariableDeclaration":for(var o,u=e.declarations,c=0;c<u.length;c++){var l=u[c];o=this.getType(l)}if(!o)throw this.astErrorOutput("Unable to find type for declaration",e);return o;case"VariableDeclarator":var h=this.getDeclaration(e.id);if(!h)throw this.astErrorOutput("Unable to find declarator",e);if(!h.valueType)throw this.astErrorOutput("Unable to find declarator valueType",e);return h.valueType;case"Identifier":if("Infinity"===e.name)return"Number";if(this.isAstVariable(e)&&"value"===this.getVariableSignature(e)){var p=this.getVariableType(e);if(!p)throw this.astErrorOutput("Unable to find identifier valueType",e);return p}var f=this.findIdentifierOrigin(e);return f&&f.init?this.getType(f.init):null;case"ReturnStatement":return this.getType(e.argument);case"MemberExpression":if(this.isAstMathFunction(e)){switch(e.property.name){case"ceil":case"floor":case"round":return"Integer"}return"Number"}if(this.isAstVariable(e)){switch(this.getVariableSignature(e)){case"value[]":return this.getLookupType(this.getVariableType(e.object));case"value[][]":return this.getLookupType(this.getVariableType(e.object.object));case"value[][][]":return this.getLookupType(this.getVariableType(e.object.object.object));case"value[][][][]":return this.getLookupType(this.getVariableType(e.object.object.object.object));case"value.thread.value":case"this.thread.value":return"Integer";case"this.output.value":return this.dynamicOutput?"Integer":"LiteralInteger";case"this.constants.value":return this.getConstantType(e.property.name);case"this.constants.value[]":return this.getLookupType(this.getConstantType(e.object.property.name));case"this.constants.value[][]":return this.getLookupType(this.getConstantType(e.object.object.property.name));case"this.constants.value[][][]":return this.getLookupType(this.getConstantType(e.object.object.object.property.name));case"this.constants.value[][][][]":return this.getLookupType(this.getConstantType(e.object.object.object.object.property.name));case"fn()[]":case"fn()[][]":case"fn()[][][]":return this.getLookupType(this.getType(e.object));case"value.value":if(this.isAstMathVariable(e))return"Number";switch(e.property.name){case"r":case"g":case"b":case"a":return this.getLookupType(this.getVariableType(e.object))}case"[][]":return"Number"}throw this.astErrorOutput("Unhandled getType MemberExpression",e)}throw this.astErrorOutput("Unhandled getType MemberExpression",e);case"ConditionalExpression":return this.getType(e.consequent);case"FunctionDeclaration":case"FunctionExpression":var d=this.findLastReturn(e.body);return d?this.getType(d):null;case"IfStatement":return this.getType(e.consequent);case"SequenceExpression":return this.getType(e.expressions[e.expressions.length-1]);default:throw this.astErrorOutput('Unhandled getType Type "'.concat(e.type,'"'),e)}}},{key:"inferArgumentTypesIfNeeded",value:function(e,t){for(var r=0;r<t.length;r++)if(this.needsArgumentType(e,r)){var n=this.getType(t[r]);if(!n)throw this.astErrorOutput("Unable to infer argument ".concat(r),t[r]);this.assignArgumentType(e,r,n)}}},{key:"isAstMathVariable",value:function(e){return"MemberExpression"===e.type&&e.object&&"Identifier"===e.object.type&&"Math"===e.object.name&&e.property&&"Identifier"===e.property.type&&["E","PI","SQRT2","SQRT1_2","LN2","LN10","LOG2E","LOG10E"].indexOf(e.property.name)>-1}},{key:"isAstMathFunction",value:function(e){return"CallExpression"===e.type&&e.callee&&"MemberExpression"===e.callee.type&&e.callee.object&&"Identifier"===e.callee.object.type&&"Math"===e.callee.object.name&&e.callee.property&&"Identifier"===e.callee.property.type&&["abs","acos","asin","atan","atan2","ceil","cos","exp","floor","log","log2","max","min","pow","random","round","sign","sin","sqrt","tan"].indexOf(e.callee.property.name)>-1}},{key:"isAstVariable",value:function(e){return"Identifier"===e.type||"MemberExpression"===e.type}},{key:"isSafe",value:function(e){return this.isSafeDependencies(this.getDependencies(e))}},{key:"isSafeDependencies",value:function(e){return!e||!e.every||e.every((function(e){return e.isSafe}))}},{key:"getDependencies",value:function(e,t,r){if(t||(t=[]),!e)return null;if(Array.isArray(e)){for(var n=0;n<e.length;n++)this.getDependencies(e[n],t,r);return t}switch(e.type){case"AssignmentExpression":return this.getDependencies(e.left,t,r),this.getDependencies(e.right,t,r),t;case"ConditionalExpression":return this.getDependencies(e.test,t,r),this.getDependencies(e.alternate,t,r),this.getDependencies(e.consequent,t,r),t;case"Literal":t.push({origin:"literal",value:e.value,isSafe:!0!==r&&e.value>-1/0&&e.value<1/0&&!isNaN(e.value)});break;case"VariableDeclarator":return this.getDependencies(e.init,t,r);case"Identifier":var i=this.getDeclaration(e);if(i)t.push({name:e.name,origin:"declaration",isSafe:!r&&this.isSafeDependencies(i.dependencies)});else if(this.argumentNames.indexOf(e.name)>-1)t.push({name:e.name,origin:"argument",isSafe:!1});else if(this.strictTypingChecking)throw new Error('Cannot find identifier origin "'.concat(e.name,'"'));break;case"FunctionDeclaration":return this.getDependencies(e.body.body[e.body.body.length-1],t,r);case"ReturnStatement":return this.getDependencies(e.argument,t);case"BinaryExpression":return r="/"===e.operator||"*"===e.operator,this.getDependencies(e.left,t,r),this.getDependencies(e.right,t,r),t;case"UnaryExpression":case"UpdateExpression":return this.getDependencies(e.argument,t,r);case"VariableDeclaration":return this.getDependencies(e.declarations,t,r);case"ArrayExpression":return t.push({origin:"declaration",isSafe:!0}),t;case"CallExpression":return t.push({origin:"function",isSafe:!0}),t;case"MemberExpression":var a=this.getMemberExpressionDetails(e);switch(a.signature){case"value[]":this.getDependencies(e.object,t,r);break;case"value[][]":this.getDependencies(e.object.object,t,r);break;case"value[][][]":this.getDependencies(e.object.object.object,t,r);break;case"this.output.value":this.dynamicOutput&&t.push({name:a.name,origin:"output",isSafe:!1})}if(a)return a.property&&this.getDependencies(a.property,t,r),a.xProperty&&this.getDependencies(a.xProperty,t,r),a.yProperty&&this.getDependencies(a.yProperty,t,r),a.zProperty&&this.getDependencies(a.zProperty,t,r),t;case"SequenceExpression":return this.getDependencies(e.expressions,t,r);default:throw this.astErrorOutput("Unhandled type ".concat(e.type," in getDependencies"),e)}return t}},{key:"getVariableSignature",value:function(e){if(!this.isAstVariable(e))throw new Error('ast of type "'.concat(e.type,'" is not a variable signature'));if("Identifier"===e.type)return"value";for(var t=[];e;)e.computed?t.push("[]"):"ThisExpression"===e.type?t.unshift("this"):e.property&&e.property.name?"x"===e.property.name||"y"===e.property.name||"z"===e.property.name?t.unshift(".value"):"constants"===e.property.name||"thread"===e.property.name||"output"===e.property.name?t.unshift("."+e.property.name):t.unshift(".value"):e.name?t.unshift("value"):e.callee&&e.callee.name?t.unshift("fn()"):e.elements?t.unshift("[]"):t.unshift("unknown"),e=e.object;var r=t.join("");return["value","value[]","value[][]","value[][][]","value[][][][]","value.value","value.value[]","value.value[][]","value.thread.value","this.thread.value","this.output.value","this.constants.value","this.constants.value[]","this.constants.value[][]","this.constants.value[][][]","this.constants.value[][][][]","fn()[]","fn()[][]","fn()[][][]","[][]"].indexOf(r)>-1?r:null}},{key:"build",value:function(){return this.toString().length>0}},{key:"astGeneric",value:function(e,t){if(null===e)throw this.astErrorOutput("NULL ast",e);if(Array.isArray(e)){for(var r=0;r<e.length;r++)this.astGeneric(e[r],t);return t}switch(e.type){case"FunctionDeclaration":return this.astFunctionDeclaration(e,t);case"FunctionExpression":return this.astFunctionExpression(e,t);case"ReturnStatement":return this.astReturnStatement(e,t);case"Literal":return this.astLiteral(e,t);case"BinaryExpression":return this.astBinaryExpression(e,t);case"Identifier":return this.astIdentifierExpression(e,t);case"AssignmentExpression":return this.astAssignmentExpression(e,t);case"ExpressionStatement":return this.astExpressionStatement(e,t);case"EmptyStatement":return this.astEmptyStatement(e,t);case"BlockStatement":return this.astBlockStatement(e,t);case"IfStatement":return this.astIfStatement(e,t);case"SwitchStatement":return this.astSwitchStatement(e,t);case"BreakStatement":return this.astBreakStatement(e,t);case"ContinueStatement":return this.astContinueStatement(e,t);case"ForStatement":return this.astForStatement(e,t);case"WhileStatement":return this.astWhileStatement(e,t);case"DoWhileStatement":return this.astDoWhileStatement(e,t);case"VariableDeclaration":return this.astVariableDeclaration(e,t);case"VariableDeclarator":return this.astVariableDeclarator(e,t);case"ThisExpression":return this.astThisExpression(e,t);case"SequenceExpression":return this.astSequenceExpression(e,t);case"UnaryExpression":return this.astUnaryExpression(e,t);case"UpdateExpression":return this.astUpdateExpression(e,t);case"LogicalExpression":return this.astLogicalExpression(e,t);case"MemberExpression":return this.astMemberExpression(e,t);case"CallExpression":return this.astCallExpression(e,t);case"ArrayExpression":return this.astArrayExpression(e,t);case"DebuggerStatement":return this.astDebuggerStatement(e,t);case"ConditionalExpression":return this.astConditionalExpression(e,t)}throw this.astErrorOutput("Unknown ast type : "+e.type,e)}},{key:"astErrorOutput",value:function(e,t){if("string"!=typeof this.source)return new Error(e);var r=i.getAstString(this.source,t),n=this.source.substr(t.start).split(/\n/),a=n.length>0?n[n.length-1]:0;return new Error("".concat(e," on line ").concat(n.length,", position ").concat(a.length,":\n ").concat(r))}},{key:"astDebuggerStatement",value:function(e,t){return t}},{key:"astConditionalExpression",value:function(e,t){if("ConditionalExpression"!==e.type)throw this.astErrorOutput("Not a conditional expression",e);return t.push("("),this.astGeneric(e.test,t),t.push("?"),this.astGeneric(e.consequent,t),t.push(":"),this.astGeneric(e.alternate,t),t.push(")"),t}},{key:"astFunction",value:function(e,t){throw new Error('"astFunction" not defined on '.concat(this.constructor.name))}},{key:"astFunctionDeclaration",value:function(e,t){return this.isChildFunction(e)?t:this.astFunction(e,t)}},{key:"astFunctionExpression",value:function(e,t){return this.isChildFunction(e)?t:this.astFunction(e,t)}},{key:"isChildFunction",value:function(e){for(var t=0;t<this.functions.length;t++)if(this.functions[t]===e)return!0;return!1}},{key:"astReturnStatement",value:function(e,t){return t}},{key:"astLiteral",value:function(e,t){return this.literalTypes[this.astKey(e)]="Number",t}},{key:"astBinaryExpression",value:function(e,t){return t}},{key:"astIdentifierExpression",value:function(e,t){return t}},{key:"astAssignmentExpression",value:function(e,t){return t}},{key:"astExpressionStatement",value:function(e,t){return this.astGeneric(e.expression,t),t.push(";"),t}},{key:"astEmptyStatement",value:function(e,t){return t}},{key:"astBlockStatement",value:function(e,t){return t}},{key:"astIfStatement",value:function(e,t){return t}},{key:"astSwitchStatement",value:function(e,t){return t}},{key:"astBreakStatement",value:function(e,t){return t.push("break;"),t}},{key:"astContinueStatement",value:function(e,t){return t.push("continue;\n"),t}},{key:"astForStatement",value:function(e,t){return t}},{key:"astWhileStatement",value:function(e,t){return t}},{key:"astDoWhileStatement",value:function(e,t){return t}},{key:"astVariableDeclaration",value:function(e,t){var r=e.declarations;if(!r||!r[0]||!r[0].init)throw this.astErrorOutput("Unexpected expression",e);var n=r[0],i=n.init,a=this.isState("in-for-loop-init")?"Integer":this.getType(i);"LiteralInteger"===a&&(a="Number");var o=typeMap[a];if(!o)throw this.astErrorOutput("Markup type ".concat(o," not handled"),e);throw this.getDependencies(n.init),new Error("remove me")}},{key:"astVariableDeclarator",value:function(e,t){return this.astGeneric(e.id,t),null!==e.init&&(t.push("="),this.astGeneric(e.init,t)),t}},{key:"astThisExpression",value:function(e,t){return t}},{key:"isIstanbulAST",value:function(e){var t=this.getVariableSignature(e);return"value.value[]"===t||"value.value[][]"===t}},{key:"astSequenceExpression",value:function(e,t){for(var r=e.expressions,n=[],i=0;i<r.length;i++){var a=r[i];if(!this.removeIstanbulCoverage||"UpdateExpression"!==a.type||!this.isIstanbulAST(a.argument)){var o=[];this.astGeneric(a,o),n.push(o.join(""))}}return n.length>1?t.push("(",n.join(","),")"):t.push(n[0]),t}},{key:"astUnaryExpression",value:function(e,t){return this.checkAndUpconvertBitwiseUnary(e,t)||(e.prefix?(t.push(e.operator),this.astGeneric(e.argument,t)):(this.astGeneric(e.argument,t),t.push(e.operator))),t}},{key:"checkAndUpconvertBitwiseUnary",value:function(e,t){}},{key:"astUpdateExpression",value:function(e,t){return this.removeIstanbulCoverage&&(this.getVariableSignature(e.argument),this.isIstanbulAST(e.argument))||(e.prefix?(t.push(e.operator),this.astGeneric(e.argument,t)):(this.astGeneric(e.argument,t),t.push(e.operator))),t}},{key:"astLogicalExpression",value:function(e,t){return t.push("("),this.astGeneric(e.left,t),t.push(e.operator),this.astGeneric(e.right,t),t.push(")"),t}},{key:"astMemberExpression",value:function(e,t){return t}},{key:"astCallExpression",value:function(e,t){return t}},{key:"astArrayExpression",value:function(e,t){return t}},{key:"getMemberExpressionDetails",value:function(e){if("MemberExpression"!==e.type)throw this.astErrorOutput("Expression ".concat(e.type," not a MemberExpression"),e);var t=null,r=null,n=this.getVariableSignature(e);switch(n){case"value":return null;case"value.thread.value":case"this.thread.value":case"this.output.value":return{signature:n,type:"Integer",name:e.property.name};case"value[]":if("string"!=typeof e.object.name)throw this.astErrorOutput("Unexpected expression",e);return{name:t=e.object.name,origin:"user",signature:n,type:this.getVariableType(e.object),xProperty:e.property};case"value[][]":if("string"!=typeof e.object.object.name)throw this.astErrorOutput("Unexpected expression",e);return{name:t=e.object.object.name,origin:"user",signature:n,type:this.getVariableType(e.object.object),yProperty:e.object.property,xProperty:e.property};case"value[][][]":if("string"!=typeof e.object.object.object.name)throw this.astErrorOutput("Unexpected expression",e);return{name:t=e.object.object.object.name,origin:"user",signature:n,type:this.getVariableType(e.object.object.object),zProperty:e.object.object.property,yProperty:e.object.property,xProperty:e.property};case"value[][][][]":if("string"!=typeof e.object.object.object.object.name)throw this.astErrorOutput("Unexpected expression",e);return{name:t=e.object.object.object.object.name,origin:"user",signature:n,type:this.getVariableType(e.object.object.object.object),zProperty:e.object.object.property,yProperty:e.object.property,xProperty:e.property};case"value.value":if("string"!=typeof e.property.name)throw this.astErrorOutput("Unexpected expression",e);if(this.isAstMathVariable(e))return{name:t=e.property.name,origin:"Math",type:"Number",signature:n};switch(e.property.name){case"r":case"g":case"b":case"a":return{name:t=e.object.name,property:e.property.name,origin:"user",signature:n,type:"Number"};default:throw this.astErrorOutput("Unexpected expression",e)}case"this.constants.value":if("string"!=typeof e.property.name)throw this.astErrorOutput("Unexpected expression",e);if(t=e.property.name,!(r=this.getConstantType(t)))throw this.astErrorOutput("Constant has no type",e);return{name:t,type:r,origin:"constants",signature:n};case"this.constants.value[]":if("string"!=typeof e.object.property.name)throw this.astErrorOutput("Unexpected expression",e);if(t=e.object.property.name,!(r=this.getConstantType(t)))throw this.astErrorOutput("Constant has no type",e);return{name:t,type:r,origin:"constants",signature:n,xProperty:e.property};case"this.constants.value[][]":if("string"!=typeof e.object.object.property.name)throw this.astErrorOutput("Unexpected expression",e);if(t=e.object.object.property.name,!(r=this.getConstantType(t)))throw this.astErrorOutput("Constant has no type",e);return{name:t,type:r,origin:"constants",signature:n,yProperty:e.object.property,xProperty:e.property};case"this.constants.value[][][]":if("string"!=typeof e.object.object.object.property.name)throw this.astErrorOutput("Unexpected expression",e);if(t=e.object.object.object.property.name,!(r=this.getConstantType(t)))throw this.astErrorOutput("Constant has no type",e);return{name:t,type:r,origin:"constants",signature:n,zProperty:e.object.object.property,yProperty:e.object.property,xProperty:e.property};case"fn()[]":case"[][]":return{signature:n,property:e.property};case"value.value[]":if(this.removeIstanbulCoverage)return{signature:n};if(this.onIstanbulCoverageVariable)return this.onIstanbulCoverageVariable(e.object.object.name),{signature:n};case"value.value[][]":if(this.removeIstanbulCoverage)return{signature:n};if(this.onIstanbulCoverageVariable)return this.onIstanbulCoverageVariable(e.object.object.object.name),{signature:n};default:throw this.astErrorOutput("Unexpected expression",e)}}},{key:"findIdentifierOrigin",value:function(e){for(var t=[this.ast];t.length>0;){var r=t[0];if("VariableDeclarator"===r.type&&r.id&&r.id.name&&r.id.name===e.name)return r;if(t.shift(),r.argument)t.push(r.argument);else if(r.body)t.push(r.body);else if(r.declarations)t.push(r.declarations);else if(Array.isArray(r))for(var n=0;n<r.length;n++)t.push(r[n])}return null}},{key:"findLastReturn",value:function(e){for(var t=[e||this.ast];t.length>0;){var r=t.pop();if("ReturnStatement"===r.type)return r;if("FunctionDeclaration"!==r.type)if(r.argument)t.push(r.argument);else if(r.body)t.push(r.body);else if(r.declarations)t.push(r.declarations);else if(Array.isArray(r))for(var n=0;n<r.length;n++)t.push(r[n]);else r.consequent?t.push(r.consequent):r.cases&&t.push(r.cases)}return null}},{key:"getInternalVariableName",value:function(e){return this._internalVariableNames.hasOwnProperty(e)||(this._internalVariableNames[e]=0),this._internalVariableNames[e]++,1===this._internalVariableNames[e]?e:e+this._internalVariableNames[e]}},{key:"varWarn",value:function(){console.warn("var declarations are deprecated, weird things happen when falling back to CPU because var scope differs in javascript than in most languages.  Use const or let")}},{key:"astKey",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";if(!e.start||!e.end)throw new Error("AST start and end needed");return"".concat(e.start).concat(t).concat(e.end)}},{key:"state",get:function(){return this.states[this.states.length-1]}}]),e}(),s={Number:"Number",Float:"Float",Integer:"Integer",Array:"Number","Array(2)":"Number","Array(3)":"Number","Array(4)":"Number",Array2D:"Number",Array3D:"Number",Input:"Number",HTMLImage:"Array(4)",HTMLVideo:"Array(4)",HTMLImageArray:"Array(4)",NumberTexture:"Number",MemoryOptimizedNumberTexture:"Number","Array1D(2)":"Array(2)","Array1D(3)":"Array(3)","Array1D(4)":"Array(4)","Array2D(2)":"Array(2)","Array2D(3)":"Array(3)","Array2D(4)":"Array(4)","Array3D(2)":"Array(2)","Array3D(3)":"Array(3)","Array3D(4)":"Array(4)","ArrayTexture(1)":"Number","ArrayTexture(2)":"Array(2)","ArrayTexture(3)":"Array(3)","ArrayTexture(4)":"Array(4)"};t.exports={FunctionNode:o}},{"../utils":113,"./function-tracer":11,acorn:1}],11:[function(e,t,r){var n=e("../utils").utils,i=function(){"use strict";function e(t){c(this,e),this.runningContexts=[],this.contexts=[],this.functionCalls=[],this.declarations=[],this.identifiers=[],this.functions=[],this.returnStatements=[],this.inLoopInit=!1,this.scan(t)}return l(e,[{key:"newContext",value:function(e){var t=Object.assign({},this.currentContext);this.contexts.push(t),this.runningContexts.push(t),e(),this.runningContexts.pop()}},{key:"scan",value:function(e){var t=this;if(e)if(Array.isArray(e))for(var r=0;r<e.length;r++)this.scan(e[r]);else switch(e.type){case"Program":this.scan(e.body);break;case"BlockStatement":this.newContext((function(){t.scan(e.body)}));break;case"AssignmentExpression":case"LogicalExpression":case"BinaryExpression":this.scan(e.left),this.scan(e.right);break;case"UpdateExpression":case"UnaryExpression":this.scan(e.argument);break;case"VariableDeclaration":e.declarations=n.normalizeDeclarations(e),this.scan(e.declarations);break;case"VariableDeclarator":var i=this.currentContext,a={ast:e,context:i,name:e.id.name,origin:"declaration",forceInteger:this.inLoopInit,assignable:!this.inLoopInit&&!i.hasOwnProperty(e.id.name)};i[e.id.name]=a,this.declarations.push(a),this.scan(e.id),this.scan(e.init);break;case"FunctionExpression":case"FunctionDeclaration":0===this.runningContexts.length?this.scan(e.body):this.functions.push(e);break;case"IfStatement":this.scan(e.test),this.scan(e.consequent),e.alternate&&this.scan(e.alternate);break;case"ForStatement":this.newContext((function(){t.inLoopInit=!0,t.scan(e.init),t.inLoopInit=!1,t.scan(e.test),t.scan(e.update),t.newContext((function(){t.scan(e.body)}))}));break;case"DoWhileStatement":case"WhileStatement":this.newContext((function(){t.scan(e.body),t.scan(e.test)}));break;case"Identifier":this.identifiers.push({context:this.currentContext,ast:e});break;case"ReturnStatement":this.returnStatements.push(e),this.scan(e.argument);break;case"MemberExpression":this.scan(e.object),this.scan(e.property);break;case"ExpressionStatement":this.scan(e.expression);break;case"SequenceExpression":this.scan(e.expressions);break;case"CallExpression":this.functionCalls.push({context:this.currentContext,ast:e}),this.scan(e.arguments);break;case"ArrayExpression":this.scan(e.elements);break;case"ConditionalExpression":this.scan(e.test),this.scan(e.alternate),this.scan(e.consequent);break;case"SwitchStatement":this.scan(e.discriminant),this.scan(e.cases);break;case"SwitchCase":this.scan(e.test),this.scan(e.consequent);break;case"ThisExpression":case"Literal":case"DebuggerStatement":case"EmptyStatement":case"BreakStatement":case"ContinueStatement":break;default:throw new Error('unhandled type "'.concat(e.type,'"'))}}},{key:"currentContext",get:function(){return this.runningContexts.length>0?this.runningContexts[this.runningContexts.length-1]:null}}]),e}();t.exports={FunctionTracer:i}},{"../utils":113}],12:[function(e,t,r){var n=e("gl-wiretap").glWiretap,i=e("../../utils").utils;function a(e){return e.toString().replace("=>","").replace(/^function /,"").replace(/utils[.]/g,"/*utils.*/")}function o(e,t){var r="single"===t.precision?e:"new Float32Array(".concat(e,".buffer)");return t.output[2]?"renderOutput(".concat(r,", ").concat(t.output[0],", ").concat(t.output[1],", ").concat(t.output[2],")"):t.output[1]?"renderOutput(".concat(r,", ").concat(t.output[0],", ").concat(t.output[1],")"):"renderOutput(".concat(r,", ").concat(t.output[0],")")}function s(e,t){var r=e.toArray.toString(),n=!/^function/.test(r),a=i.flattenFunctionToString("".concat(n?"function ":"").concat(r),{findDependency:function(t,r){if("utils"===t)return"const ".concat(r," = ").concat(i[r].toString(),";");if("this"===t)return"".concat(n?"function ":"").concat(e[r].toString());throw new Error("unhandled fromObject")},thisLookup:function(r){if("texture"===r)return t;if("context"===r)return null;if(e.hasOwnProperty(r))return JSON.stringify(e[r]);throw new Error("unhandled thisLookup ".concat(r))}});return"() => {\n  ".concat(a,"\n  return toArray();\n  }")}function u(e,t,r,n,i){if(null===e)return null;switch(d(e)){case"boolean":case"number":return null}if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement){for(var a=0;a<t.length;a++){var o=t[a];if("HTMLImageArray"===o.type&&o.uploadValue===e){var s=r[a].indexOf(e);if(-1!==s){var u="uploadValue_".concat(o.name,"[").concat(s,"]");return n.insertVariable(u,e),u}}}return null}for(var c=0;c<t.length;c++){var l=t[c];if(e===l.uploadValue){var h="uploadValue_".concat(l.name);return n.insertVariable(h,l),h}}return null}t.exports={glKernelString:function(e,t,r,c,l){r.built||r.build.apply(r,t),t=t?Array.from(t).map((function(e){switch(d(e)){case"boolean":return new Boolean(e);case"number":return new Number(e);default:return e}})):null;var h=[],p=n(r.context,{useTrackablePrimitives:!0,onReadPixels:function(e){if(P.subKernels){if(f){var t=P.subKernels[m++].property;h.push("    result".concat(isNaN(t)?"."+t:"[".concat(t,"]")," = ").concat(o(e,P),";"))}else h.push("    const result = { result: ".concat(o(e,P)," };")),f=!0;m===P.subKernels.length&&h.push("    return result;")}else e?h.push("    return ".concat(o(e,P),";")):h.push("    return null;")},onUnrecognizedArgumentLookup:function(e){var t=u(e,P.kernelArguments,[],p);if(t)return t;var r=u(e,P.kernelConstants,x?Object.keys(x).map((function(e){return x[e]})):[],p);return r||null}}),f=!1,m=0,y=r.source,g=r.canvas,v=r.output,E=r.pipeline,T=r.graphical,b=r.loopMaxIterations,x=r.constants,A=r.optimizeFloatMemory,S=r.precision,R=r.fixIntegerDivisionAccuracy,w=r.functions,C=r.nativeFunctions,O=r.subKernels,k=r.immutable,N=r.argumentTypes,_=r.constantTypes,I=(r.kernelArguments,r.kernelConstants),M=r.tactic,P=new e(y,{canvas:g,context:p,checkContext:!1,output:v,pipeline:E,graphical:T,loopMaxIterations:b,constants:x,optimizeFloatMemory:A,precision:S,fixIntegerDivisionAccuracy:R,functions:w,nativeFunctions:C,subKernels:O,immutable:k,argumentTypes:N,constantTypes:_,tactic:M}),L=[];if(p.setIndent(2),P.build.apply(P,t),L.push(p.toString()),p.reset(),P.kernelArguments.forEach((function(e,r){switch(e.type){case"Integer":case"Boolean":case"Number":case"Float":case"Array":case"Array(2)":case"Array(3)":case"Array(4)":case"HTMLImage":case"HTMLVideo":p.insertVariable("uploadValue_".concat(e.name),e.uploadValue);break;case"HTMLImageArray":for(var n=0;n<t[r].length;n++){var i=t[r];p.insertVariable("uploadValue_".concat(e.name,"[").concat(n,"]"),i[n])}break;case"Input":p.insertVariable("uploadValue_".concat(e.name),e.uploadValue);break;case"MemoryOptimizedNumberTexture":case"NumberTexture":case"Array1D(2)":case"Array1D(3)":case"Array1D(4)":case"Array2D(2)":case"Array2D(3)":case"Array2D(4)":case"Array3D(2)":case"Array3D(3)":case"Array3D(4)":case"ArrayTexture(1)":case"ArrayTexture(2)":case"ArrayTexture(3)":case"ArrayTexture(4)":p.insertVariable("uploadValue_".concat(e.name),t[r].texture);break;default:throw new Error("unhandled kernelArgumentType insertion for glWiretap of type ".concat(e.type))}})),L.push("/** start of injected functions **/"),L.push("function ".concat(a(i.flattenTo))),L.push("function ".concat(a(i.flatten2dArrayTo))),L.push("function ".concat(a(i.flatten3dArrayTo))),L.push("function ".concat(a(i.flatten4dArrayTo))),L.push("function ".concat(a(i.isArray))),P.renderOutput!==P.renderTexture&&P.formatValues&&L.push("  const renderOutput = function ".concat(a(P.formatValues),";")),L.push("/** end of injected functions **/"),L.push("  const innerKernel = function (".concat(P.kernelArguments.map((function(e){return e.varName})).join(", "),") {")),p.setIndent(4),P.run.apply(P,t),P.renderKernels?P.renderKernels():P.renderOutput&&P.renderOutput(),L.push("    /** start setup uploads for kernel values **/"),P.kernelArguments.forEach((function(e){L.push("    "+e.getStringValueHandler().split("\n").join("\n    "))})),L.push("    /** end setup uploads for kernel values **/"),L.push(p.toString()),P.renderOutput===P.renderTexture)if(p.reset(),P.renderKernels){var F=P.renderKernels(),D=p.getContextVariableName(P.outputTexture);L.push("    return {\n      result: {\n        texture: ".concat(D,",\n        type: '").concat(F.result.type,"',\n        toArray: ").concat(s(F.result,D),"\n      },"));for(var U=P.subKernels,V=P.subKernelOutputTextures,j=0;j<U.length;j++){var G=V[j],B=U[j],z=F[B.property],W=p.getContextVariableName(G);L.push("\n      ".concat(B.property,": {\n        texture: ").concat(W,",\n        type: '").concat(z.type,"',\n        toArray: ").concat(s(z,W),"\n      },"))}L.push("    };")}else{var K=P.renderOutput(),H=p.getContextVariableName(P.outputTexture);L.push("    return {\n        texture: ".concat(H,",\n        type: '").concat(K.type,"',\n        toArray: ").concat(s(K,H),"\n      };"))}L.push("    ".concat(l?"\n"+l+"    ":"")),L.push(h.join("\n")),L.push("  };"),P.graphical&&(L.push(function(e){var t=e.getPixels.toString(),r=!/^function/.test(t);return i.flattenFunctionToString("".concat(r?"function ":"").concat(t),{findDependency:function(e,t){return"utils"===e?"const ".concat(t," = ").concat(i[t].toString(),";"):null},thisLookup:function(t){if("context"===t)return null;if(e.hasOwnProperty(t))return JSON.stringify(e[t]);throw new Error("unhandled thisLookup ".concat(t))}})}(P)),L.push("  innerKernel.getPixels = getPixels;")),L.push("  return innerKernel;");var X=[];return I.forEach((function(e){X.push("".concat(e.getStringValueHandler()))})),"function kernel(settings) {\n  const { context, constants } = settings;\n  ".concat(X.join(""),"\n  ").concat(c||"","\n").concat(L.join("\n"),"\n}")}}},{"../../utils":113,"gl-wiretap":3}],13:[function(e,t,r){var n=e("../kernel").Kernel,i=e("../../utils").utils,a=e("./texture/array-2-float").GLTextureArray2Float,o=e("./texture/array-2-float-2d").GLTextureArray2Float2D,s=e("./texture/array-2-float-3d").GLTextureArray2Float3D,u=e("./texture/array-3-float").GLTextureArray3Float,d=e("./texture/array-3-float-2d").GLTextureArray3Float2D,m=e("./texture/array-3-float-3d").GLTextureArray3Float3D,y=e("./texture/array-4-float").GLTextureArray4Float,g=e("./texture/array-4-float-2d").GLTextureArray4Float2D,v=e("./texture/array-4-float-3d").GLTextureArray4Float3D,E=e("./texture/float").GLTextureFloat,T=e("./texture/float-2d").GLTextureFloat2D,b=e("./texture/float-3d").GLTextureFloat3D,x=e("./texture/memory-optimized").GLTextureMemoryOptimized,A=e("./texture/memory-optimized-2d").GLTextureMemoryOptimized2D,S=e("./texture/memory-optimized-3d").GLTextureMemoryOptimized3D,R=e("./texture/unsigned").GLTextureUnsigned,w=e("./texture/unsigned-2d").GLTextureUnsigned2D,C=e("./texture/unsigned-3d").GLTextureUnsigned3D,O=e("./texture/graphical").GLTextureGraphical,k=function(e){"use strict";h(r,e);var t=p(r);function r(e,n){var i;return c(this,r),(i=t.call(this,e,n)).transferValues=null,i.formatValues=null,i.TextureConstructor=null,i.renderOutput=null,i.renderRawOutput=null,i.texSize=null,i.translatedSource=null,i.renderStrategy=null,i.compiledFragmentShader=null,i.compiledVertexShader=null,i.switchingKernels=null,i}return l(r,[{key:"setFixIntegerDivisionAccuracy",value:function(e){return this.fixIntegerDivisionAccuracy=e,this}},{key:"setPrecision",value:function(e){return this.precision=e,this}},{key:"setFloatTextures",value:function(e){return i.warnDeprecated("method","setFloatTextures","setOptimizeFloatMemory"),this.floatTextures=e,this}}],[{key:"getIsFloatRead",value:function(){var e=new this("function kernelFunction() {\n      return 1;\n    }",{context:this.testContext,canvas:this.testCanvas,validate:!1,output:[1],precision:"single",returnType:"Number",tactic:"speed"});e.build(),e.run();var t=e.renderOutput();return e.destroy(!0),1===t[0]}},{key:"getIsIntegerDivisionAccurate",value:function(){var e=new this(function(e,t){return e[this.thread.x]/t[this.thread.x]}.toString(),{context:this.testContext,canvas:this.testCanvas,validate:!1,output:[2],returnType:"Number",precision:"unsigned",tactic:"speed"}),t=[[6,6030401],[3,3991]];e.build.apply(e,t),e.run.apply(e,t);var r=e.renderOutput();return e.destroy(!0),2===r[0]&&1511===r[1]}},{key:"getFeatures",value:function(){var e=this.testContext,t=this.getIsDrawBuffers();return Object.freeze({isFloatRead:this.getIsFloatRead(),isIntegerDivisionAccurate:this.getIsIntegerDivisionAccurate(),isTextureFloat:this.getIsTextureFloat(),isDrawBuffers:t,kernelMap:t,channelCount:this.getChannelCount(),maxTextureSize:this.getMaxTextureSize(),lowIntPrecision:e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.LOW_INT),lowFloatPrecision:e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.LOW_FLOAT),mediumIntPrecision:e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_INT),mediumFloatPrecision:e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT),highIntPrecision:e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_INT),highFloatPrecision:e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT)})}},{key:"setupFeatureChecks",value:function(){throw new Error('"setupFeatureChecks" not defined on '.concat(this.name))}},{key:"nativeFunctionArguments",value:function(e){for(var t=[],r=[],n=[],i=/^[a-zA-Z_]/,a=/[a-zA-Z_0-9]/,o=0,s=null,u=null;o<e.length;){var c=e[o],l=e[o+1],h=n.length>0?n[n.length-1]:null;if("FUNCTION_ARGUMENTS"!==h||"/"!==c||"*"!==l)if("MULTI_LINE_COMMENT"!==h||"*"!==c||"/"!==l)if("FUNCTION_ARGUMENTS"!==h||"/"!==c||"/"!==l)if("COMMENT"!==h||"\n"!==c)if(null!==h||"("!==c){if("FUNCTION_ARGUMENTS"===h){if(")"===c){n.pop();break}if("f"===c&&"l"===l&&"o"===e[o+2]&&"a"===e[o+3]&&"t"===e[o+4]&&" "===e[o+5]){n.push("DECLARE_VARIABLE"),u="float",s="",o+=6;continue}if("i"===c&&"n"===l&&"t"===e[o+2]&&" "===e[o+3]){n.push("DECLARE_VARIABLE"),u="int",s="",o+=4;continue}if("v"===c&&"e"===l&&"c"===e[o+2]&&"2"===e[o+3]&&" "===e[o+4]){n.push("DECLARE_VARIABLE"),u="vec2",s="",o+=5;continue}if("v"===c&&"e"===l&&"c"===e[o+2]&&"3"===e[o+3]&&" "===e[o+4]){n.push("DECLARE_VARIABLE"),u="vec3",s="",o+=5;continue}if("v"===c&&"e"===l&&"c"===e[o+2]&&"4"===e[o+3]&&" "===e[o+4]){n.push("DECLARE_VARIABLE"),u="vec4",s="",o+=5;continue}}else if("DECLARE_VARIABLE"===h){if(""===s){if(" "===c){o++;continue}if(!i.test(c))throw new Error("variable name is not expected string")}s+=c,a.test(l)||(n.pop(),r.push(s),t.push(_[u]))}o++}else n.push("FUNCTION_ARGUMENTS"),o++;else n.pop(),o++;else n.push("COMMENT"),o+=2;else n.pop(),o+=2;else n.push("MULTI_LINE_COMMENT"),o+=2}if(n.length>0)throw new Error("GLSL function was not parsable");return{argumentNames:r,argumentTypes:t}}},{key:"nativeFunctionReturnType",value:function(e){return _[e.match(/int|float|vec[2-4]/)[0]]}},{key:"combineKernels",value:function(e,t){e.apply(null,arguments);var r,n=t.texSize,a=n.texSize,o=n.context,s=n.threadDim;if("single"===t.precision){var u=a[0],c=Math.ceil(a[1]/4);r=new Float32Array(u*c*4*4),o.readPixels(0,0,u,4*c,o.RGBA,o.FLOAT,r)}else{var l=new Uint8Array(a[0]*a[1]*4);o.readPixels(0,0,a[0],a[1],o.RGBA,o.UNSIGNED_BYTE,l),r=new Float32Array(l.buffer)}if(r=r.subarray(0,s[0]*s[1]*s[2]),1===t.output.length)return r;if(2===t.output.length)return i.splitArray(r,t.output[0]);if(3===t.output.length){var h=i.splitArray(r,t.output[0]*t.output[1]);return h.map((function(e){return i.splitArray(e,t.output[0])}))}}},{key:"mode",get:function(){return"gpu"}},{key:"testCanvas",get:function(){throw new Error('"testCanvas" not defined on '.concat(this.name))}},{key:"testContext",get:function(){throw new Error('"testContext" not defined on '.concat(this.name))}}]),l(r,[{key:"checkTextureSize",value:function(){var e=this.constructor.features;if(this.texSize[0]>e.maxTextureSize||this.texSize[1]>e.maxTextureSize)throw new Error("Texture size [".concat(this.texSize[0],",").concat(this.texSize[1],"] generated by kernel is larger than supported size [").concat(e.maxTextureSize,",").concat(e.maxTextureSize,"]"))}},{key:"translateSource",value:function(){throw new Error('"translateSource" not defined on '.concat(this.constructor.name))}},{key:"pickRenderStrategy",value:function(e){if(this.graphical)return this.renderRawOutput=this.readPackedPixelsToUint8Array,this.transferValues=function(e){return e},this.TextureConstructor=O,null;if("unsigned"===this.precision)if(this.renderRawOutput=this.readPackedPixelsToUint8Array,this.transferValues=this.readPackedPixelsToFloat32Array,this.pipeline)switch(this.renderOutput=this.renderTexture,null!==this.subKernels&&(this.renderKernels=this.renderKernelsToTextures),this.returnType){case"LiteralInteger":case"Float":case"Number":case"Integer":return this.output[2]>0?(this.TextureConstructor=C,this.renderStrategy=N.PackedPixelTo3DFloat,null):this.output[1]>0?(this.TextureConstructor=w,this.renderStrategy=N.PackedPixelTo2DFloat,null):(this.TextureConstructor=R,this.renderStrategy=N.PackedPixelToFloat,null);case"Array(2)":case"Array(3)":case"Array(4)":return this.requestFallback(e)}else switch(null!==this.subKernels&&(this.renderKernels=this.renderKernelsToArrays),this.returnType){case"LiteralInteger":case"Float":case"Number":case"Integer":return this.renderOutput=this.renderValues,this.output[2]>0?(this.TextureConstructor=C,this.renderStrategy=N.PackedPixelTo3DFloat,this.formatValues=i.erect3DPackedFloat,null):this.output[1]>0?(this.TextureConstructor=w,this.renderStrategy=N.PackedPixelTo2DFloat,this.formatValues=i.erect2DPackedFloat,null):(this.TextureConstructor=R,this.renderStrategy=N.PackedPixelToFloat,this.formatValues=i.erectPackedFloat,null);case"Array(2)":case"Array(3)":case"Array(4)":return this.requestFallback(e)}else{if("single"!==this.precision)throw new Error('unhandled precision of "'.concat(this.precision,'"'));if(this.renderRawOutput=this.readFloatPixelsToFloat32Array,this.transferValues=this.readFloatPixelsToFloat32Array,this.pipeline)switch(this.renderStrategy=N.FloatTexture,this.renderOutput=this.renderTexture,null!==this.subKernels&&(this.renderKernels=this.renderKernelsToTextures),this.returnType){case"LiteralInteger":case"Float":case"Number":case"Integer":return this.optimizeFloatMemory?this.output[2]>0?(this.TextureConstructor=S,null):this.output[1]>0?(this.TextureConstructor=A,null):(this.TextureConstructor=x,null):this.output[2]>0?(this.TextureConstructor=b,null):this.output[1]>0?(this.TextureConstructor=T,null):(this.TextureConstructor=E,null);case"Array(2)":return this.output[2]>0?(this.TextureConstructor=s,null):this.output[1]>0?(this.TextureConstructor=o,null):(this.TextureConstructor=a,null);case"Array(3)":return this.output[2]>0?(this.TextureConstructor=m,null):this.output[1]>0?(this.TextureConstructor=d,null):(this.TextureConstructor=u,null);case"Array(4)":return this.output[2]>0?(this.TextureConstructor=v,null):this.output[1]>0?(this.TextureConstructor=g,null):(this.TextureConstructor=y,null)}if(this.renderOutput=this.renderValues,null!==this.subKernels&&(this.renderKernels=this.renderKernelsToArrays),this.optimizeFloatMemory)switch(this.returnType){case"LiteralInteger":case"Float":case"Number":case"Integer":return this.output[2]>0?(this.TextureConstructor=S,this.renderStrategy=N.MemoryOptimizedFloatPixelToMemoryOptimized3DFloat,this.formatValues=i.erectMemoryOptimized3DFloat,null):this.output[1]>0?(this.TextureConstructor=A,this.renderStrategy=N.MemoryOptimizedFloatPixelToMemoryOptimized2DFloat,this.formatValues=i.erectMemoryOptimized2DFloat,null):(this.TextureConstructor=x,this.renderStrategy=N.MemoryOptimizedFloatPixelToMemoryOptimizedFloat,this.formatValues=i.erectMemoryOptimizedFloat,null);case"Array(2)":return this.output[2]>0?(this.TextureConstructor=s,this.renderStrategy=N.FloatPixelTo3DArray2,this.formatValues=i.erect3DArray2,null):this.output[1]>0?(this.TextureConstructor=o,this.renderStrategy=N.FloatPixelTo2DArray2,this.formatValues=i.erect2DArray2,null):(this.TextureConstructor=a,this.renderStrategy=N.FloatPixelToArray2,this.formatValues=i.erectArray2,null);case"Array(3)":return this.output[2]>0?(this.TextureConstructor=m,this.renderStrategy=N.FloatPixelTo3DArray3,this.formatValues=i.erect3DArray3,null):this.output[1]>0?(this.TextureConstructor=d,this.renderStrategy=N.FloatPixelTo2DArray3,this.formatValues=i.erect2DArray3,null):(this.TextureConstructor=u,this.renderStrategy=N.FloatPixelToArray3,this.formatValues=i.erectArray3,null);case"Array(4)":return this.output[2]>0?(this.TextureConstructor=v,this.renderStrategy=N.FloatPixelTo3DArray4,this.formatValues=i.erect3DArray4,null):this.output[1]>0?(this.TextureConstructor=g,this.renderStrategy=N.FloatPixelTo2DArray4,this.formatValues=i.erect2DArray4,null):(this.TextureConstructor=y,this.renderStrategy=N.FloatPixelToArray4,this.formatValues=i.erectArray4,null)}else switch(this.returnType){case"LiteralInteger":case"Float":case"Number":case"Integer":return this.output[2]>0?(this.TextureConstructor=b,this.renderStrategy=N.FloatPixelTo3DFloat,this.formatValues=i.erect3DFloat,null):this.output[1]>0?(this.TextureConstructor=T,this.renderStrategy=N.FloatPixelTo2DFloat,this.formatValues=i.erect2DFloat,null):(this.TextureConstructor=E,this.renderStrategy=N.FloatPixelToFloat,this.formatValues=i.erectFloat,null);case"Array(2)":return this.output[2]>0?(this.TextureConstructor=s,this.renderStrategy=N.FloatPixelTo3DArray2,this.formatValues=i.erect3DArray2,null):this.output[1]>0?(this.TextureConstructor=o,this.renderStrategy=N.FloatPixelTo2DArray2,this.formatValues=i.erect2DArray2,null):(this.TextureConstructor=a,this.renderStrategy=N.FloatPixelToArray2,this.formatValues=i.erectArray2,null);case"Array(3)":return this.output[2]>0?(this.TextureConstructor=m,this.renderStrategy=N.FloatPixelTo3DArray3,this.formatValues=i.erect3DArray3,null):this.output[1]>0?(this.TextureConstructor=d,this.renderStrategy=N.FloatPixelTo2DArray3,this.formatValues=i.erect2DArray3,null):(this.TextureConstructor=u,this.renderStrategy=N.FloatPixelToArray3,this.formatValues=i.erectArray3,null);case"Array(4)":return this.output[2]>0?(this.TextureConstructor=v,this.renderStrategy=N.FloatPixelTo3DArray4,this.formatValues=i.erect3DArray4,null):this.output[1]>0?(this.TextureConstructor=g,this.renderStrategy=N.FloatPixelTo2DArray4,this.formatValues=i.erect2DArray4,null):(this.TextureConstructor=y,this.renderStrategy=N.FloatPixelToArray4,this.formatValues=i.erectArray4,null)}}throw new Error('unhandled return type "'.concat(this.returnType,'"'))}},{key:"getKernelString",value:function(){throw new Error("abstract method call")}},{key:"getMainResultTexture",value:function(){switch(this.returnType){case"LiteralInteger":case"Float":case"Integer":case"Number":return this.getMainResultNumberTexture();case"Array(2)":return this.getMainResultArray2Texture();case"Array(3)":return this.getMainResultArray3Texture();case"Array(4)":return this.getMainResultArray4Texture();default:throw new Error("unhandled returnType type ".concat(this.returnType))}}},{key:"getMainResultKernelNumberTexture",value:function(){throw new Error("abstract method call")}},{key:"getMainResultSubKernelNumberTexture",value:function(){throw new Error("abstract method call")}},{key:"getMainResultKernelArray2Texture",value:function(){throw new Error("abstract method call")}},{key:"getMainResultSubKernelArray2Texture",value:function(){throw new Error("abstract method call")}},{key:"getMainResultKernelArray3Texture",value:function(){throw new Error("abstract method call")}},{key:"getMainResultSubKernelArray3Texture",value:function(){throw new Error("abstract method call")}},{key:"getMainResultKernelArray4Texture",value:function(){throw new Error("abstract method call")}},{key:"getMainResultSubKernelArray4Texture",value:function(){throw new Error("abstract method call")}},{key:"getMainResultGraphical",value:function(){throw new Error("abstract method call")}},{key:"getMainResultMemoryOptimizedFloats",value:function(){throw new Error("abstract method call")}},{key:"getMainResultPackedPixels",value:function(){throw new Error("abstract method call")}},{key:"getMainResultString",value:function(){return this.graphical?this.getMainResultGraphical():"single"===this.precision?this.optimizeFloatMemory?this.getMainResultMemoryOptimizedFloats():this.getMainResultTexture():this.getMainResultPackedPixels()}},{key:"getMainResultNumberTexture",value:function(){return i.linesToString(this.getMainResultKernelNumberTexture())+i.linesToString(this.getMainResultSubKernelNumberTexture())}},{key:"getMainResultArray2Texture",value:function(){return i.linesToString(this.getMainResultKernelArray2Texture())+i.linesToString(this.getMainResultSubKernelArray2Texture())}},{key:"getMainResultArray3Texture",value:function(){return i.linesToString(this.getMainResultKernelArray3Texture())+i.linesToString(this.getMainResultSubKernelArray3Texture())}},{key:"getMainResultArray4Texture",value:function(){return i.linesToString(this.getMainResultKernelArray4Texture())+i.linesToString(this.getMainResultSubKernelArray4Texture())}},{key:"getFloatTacticDeclaration",value:function(){var e=this.getVariablePrecisionString(this.texSize,this.tactic);return"precision ".concat(e," float;\n")}},{key:"getIntTacticDeclaration",value:function(){return"precision ".concat(this.getVariablePrecisionString(this.texSize,this.tactic,!0)," int;\n")}},{key:"getSampler2DTacticDeclaration",value:function(){return"precision ".concat(this.getVariablePrecisionString(this.texSize,this.tactic)," sampler2D;\n")}},{key:"getSampler2DArrayTacticDeclaration",value:function(){return"precision ".concat(this.getVariablePrecisionString(this.texSize,this.tactic)," sampler2DArray;\n")}},{key:"renderTexture",value:function(){return new this.TextureConstructor({texture:this.outputTexture,size:this.texSize,dimensions:this.threadDim,output:this.output,context:this.context,kernel:this,internalFormat:this.getInternalFormat(),textureFormat:this.getTextureFormat()})}},{key:"readPackedPixelsToUint8Array",value:function(){if("unsigned"!==this.precision)throw new Error('Requires this.precision to be "unsigned"');var e=this.texSize,t=this.context,r=new Uint8Array(e[0]*e[1]*4);return t.readPixels(0,0,e[0],e[1],t.RGBA,t.UNSIGNED_BYTE,r),r}},{key:"readPackedPixelsToFloat32Array",value:function(){return new Float32Array(this.readPackedPixelsToUint8Array().buffer)}},{key:"readFloatPixelsToFloat32Array",value:function(){if("single"!==this.precision)throw new Error('Requires this.precision to be "single"');var e=this.texSize,t=this.context,r=e[0],n=e[1],i=new Float32Array(r*n*4);return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,i),i}},{key:"getPixels",value:function(e){var t=this.context,r=this.output,n=f(r,2),a=n[0],o=n[1],s=new Uint8Array(a*o*4);return t.readPixels(0,0,a,o,t.RGBA,t.UNSIGNED_BYTE,s),new Uint8ClampedArray((e?s:i.flipPixels(s,a,o)).buffer)}},{key:"renderKernelsToArrays",value:function(){for(var e={result:this.renderOutput()},t=0;t<this.subKernels.length;t++)e[this.subKernels[t].property]=new this.TextureConstructor({texture:this.subKernelOutputTextures[t],size:this.texSize,dimensions:this.threadDim,output:this.output,context:this.context,internalFormat:this.getInternalFormat(),textureFormat:this.getTextureFormat()}).toArray();return e}},{key:"renderKernelsToTextures",value:function(){for(var e={result:this.renderOutput()},t=0;t<this.subKernels.length;t++)e[this.subKernels[t].property]=new this.TextureConstructor({texture:this.subKernelOutputTextures[t],size:this.texSize,dimensions:this.threadDim,output:this.output,context:this.context,internalFormat:this.getInternalFormat(),textureFormat:this.getTextureFormat()});return e}},{key:"resetSwitchingKernels",value:function(){var e=this.switchingKernels;return this.switchingKernels=null,e}},{key:"setOutput",value:function(e){var t=this.toKernelOutput(e);if(this.program){if(!this.dynamicOutput)throw new Error("Resizing a kernel with dynamicOutput: false is not possible");var r=[t[0],t[1]||1,t[2]||1],n=i.getKernelTextureSize({optimizeFloatMemory:this.optimizeFloatMemory,precision:this.precision},r),a=this.texSize;if(a){var o=this.getVariablePrecisionString(a,this.tactic),s=this.getVariablePrecisionString(n,this.tactic);if(o!==s)return console.warn("Precision requirement changed, asking GPU instance to recompile"),void this.switchKernels({type:"outputPrecisionMismatch",precision:s,needed:e})}this.output=t,this.threadDim=r,this.texSize=n;var u=this.context;u.bindFramebuffer(u.FRAMEBUFFER,this.framebuffer),this.updateMaxTexSize(),this.framebuffer.width=this.texSize[0],this.framebuffer.height=this.texSize[1],u.viewport(0,0,this.maxTexSize[0],this.maxTexSize[1]),this.canvas.width=this.maxTexSize[0],this.canvas.height=this.maxTexSize[1],this._setupOutputTexture(),this.subKernels&&this.subKernels.length>0&&this._setupSubOutputTextures()}else this.output=t;return this}},{key:"renderValues",value:function(){return this.formatValues(this.transferValues(),this.output[0],this.output[1],this.output[2])}},{key:"switchKernels",value:function(e){this.switchingKernels?this.switchingKernels.push(e):this.switchingKernels=[e]}},{key:"getVariablePrecisionString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.texSize,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.tactic,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!t){var n=this.constructor.features[r?"lowIntPrecision":"lowFloatPrecision"],i=this.constructor.features[r?"mediumIntPrecision":"mediumFloatPrecision"],a=this.constructor.features[r?"highIntPrecision":"highFloatPrecision"],o=Math.log2(e[0]*e[1]);if(o<=n.rangeMax)return"lowp";if(o<=i.rangeMax)return"mediump";if(o<=a.rangeMax)return"highp";throw new Error("The required size exceeds that of the ability of your system")}switch(t){case"speed":return"lowp";case"balanced":return"mediump";case"precision":return"highp";default:throw new Error('Unknown tactic "'.concat(t,'" use "speed", "balanced", "precision", or empty for auto'))}}}]),r}(n),N=Object.freeze({PackedPixelToUint8Array:Symbol("PackedPixelToUint8Array"),PackedPixelToFloat:Symbol("PackedPixelToFloat"),PackedPixelTo2DFloat:Symbol("PackedPixelTo2DFloat"),PackedPixelTo3DFloat:Symbol("PackedPixelTo3DFloat"),PackedTexture:Symbol("PackedTexture"),FloatPixelToFloat32Array:Symbol("FloatPixelToFloat32Array"),FloatPixelToFloat:Symbol("FloatPixelToFloat"),FloatPixelTo2DFloat:Symbol("FloatPixelTo2DFloat"),FloatPixelTo3DFloat:Symbol("FloatPixelTo3DFloat"),FloatPixelToArray2:Symbol("FloatPixelToArray2"),FloatPixelTo2DArray2:Symbol("FloatPixelTo2DArray2"),FloatPixelTo3DArray2:Symbol("FloatPixelTo3DArray2"),FloatPixelToArray3:Symbol("FloatPixelToArray3"),FloatPixelTo2DArray3:Symbol("FloatPixelTo2DArray3"),FloatPixelTo3DArray3:Symbol("FloatPixelTo3DArray3"),FloatPixelToArray4:Symbol("FloatPixelToArray4"),FloatPixelTo2DArray4:Symbol("FloatPixelTo2DArray4"),FloatPixelTo3DArray4:Symbol("FloatPixelTo3DArray4"),FloatTexture:Symbol("FloatTexture"),MemoryOptimizedFloatPixelToMemoryOptimizedFloat:Symbol("MemoryOptimizedFloatPixelToFloat"),MemoryOptimizedFloatPixelToMemoryOptimized2DFloat:Symbol("MemoryOptimizedFloatPixelTo2DFloat"),MemoryOptimizedFloatPixelToMemoryOptimized3DFloat:Symbol("MemoryOptimizedFloatPixelTo3DFloat")}),_={int:"Integer",float:"Number",vec2:"Array(2)",vec3:"Array(3)",vec4:"Array(4)"};t.exports={GLKernel:k,renderStrategy:N}},{"../../utils":113,"../kernel":36,"./texture/array-2-float":16,"./texture/array-2-float-2d":14,"./texture/array-2-float-3d":15,"./texture/array-3-float":19,"./texture/array-3-float-2d":17,"./texture/array-3-float-3d":18,"./texture/array-4-float":22,"./texture/array-4-float-2d":20,"./texture/array-4-float-3d":21,"./texture/float":25,"./texture/float-2d":23,"./texture/float-3d":24,"./texture/graphical":26,"./texture/memory-optimized":30,"./texture/memory-optimized-2d":28,"./texture/memory-optimized-3d":29,"./texture/unsigned":33,"./texture/unsigned-2d":31,"./texture/unsigned-3d":32}],14:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e){var n;return c(this,r),(n=t.call(this,e)).type="ArrayTexture(2)",n}return l(r,[{key:"toArray",value:function(){return n.erect2DArray2(this.renderValues(),this.output[0],this.output[1])}}]),r}(e("./float").GLTextureFloat);t.exports={GLTextureArray2Float2D:i}},{"../../../utils":113,"./float":25}],15:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e){var n;return c(this,r),(n=t.call(this,e)).type="ArrayTexture(2)",n}return l(r,[{key:"toArray",value:function(){return n.erect3DArray2(this.renderValues(),this.output[0],this.output[1],this.output[2])}}]),r}(e("./float").GLTextureFloat);t.exports={GLTextureArray2Float3D:i}},{"../../../utils":113,"./float":25}],16:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e){var n;return c(this,r),(n=t.call(this,e)).type="ArrayTexture(2)",n}return l(r,[{key:"toArray",value:function(){return n.erectArray2(this.renderValues(),this.output[0],this.output[1])}}]),r}(e("./float").GLTextureFloat);t.exports={GLTextureArray2Float:i}},{"../../../utils":113,"./float":25}],17:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e){var n;return c(this,r),(n=t.call(this,e)).type="ArrayTexture(3)",n}return l(r,[{key:"toArray",value:function(){return n.erect2DArray3(this.renderValues(),this.output[0],this.output[1])}}]),r}(e("./float").GLTextureFloat);t.exports={GLTextureArray3Float2D:i}},{"../../../utils":113,"./float":25}],18:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e){var n;return c(this,r),(n=t.call(this,e)).type="ArrayTexture(3)",n}return l(r,[{key:"toArray",value:function(){return n.erect3DArray3(this.renderValues(),this.output[0],this.output[1],this.output[2])}}]),r}(e("./float").GLTextureFloat);t.exports={GLTextureArray3Float3D:i}},{"../../../utils":113,"./float":25}],19:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e){var n;return c(this,r),(n=t.call(this,e)).type="ArrayTexture(3)",n}return l(r,[{key:"toArray",value:function(){return n.erectArray3(this.renderValues(),this.output[0])}}]),r}(e("./float").GLTextureFloat);t.exports={GLTextureArray3Float:i}},{"../../../utils":113,"./float":25}],20:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e){var n;return c(this,r),(n=t.call(this,e)).type="ArrayTexture(4)",n}return l(r,[{key:"toArray",value:function(){return n.erect2DArray4(this.renderValues(),this.output[0],this.output[1])}}]),r}(e("./float").GLTextureFloat);t.exports={GLTextureArray4Float2D:i}},{"../../../utils":113,"./float":25}],21:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e){var n;return c(this,r),(n=t.call(this,e)).type="ArrayTexture(4)",n}return l(r,[{key:"toArray",value:function(){return n.erect3DArray4(this.renderValues(),this.output[0],this.output[1],this.output[2])}}]),r}(e("./float").GLTextureFloat);t.exports={GLTextureArray4Float3D:i}},{"../../../utils":113,"./float":25}],22:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e){var n;return c(this,r),(n=t.call(this,e)).type="ArrayTexture(4)",n}return l(r,[{key:"toArray",value:function(){return n.erectArray4(this.renderValues(),this.output[0])}}]),r}(e("./float").GLTextureFloat);t.exports={GLTextureArray4Float:i}},{"../../../utils":113,"./float":25}],23:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e){var n;return c(this,r),(n=t.call(this,e)).type="ArrayTexture(1)",n}return l(r,[{key:"toArray",value:function(){return n.erect2DFloat(this.renderValues(),this.output[0],this.output[1])}}]),r}(e("./float").GLTextureFloat);t.exports={GLTextureFloat2D:i}},{"../../../utils":113,"./float":25}],24:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e){var n;return c(this,r),(n=t.call(this,e)).type="ArrayTexture(1)",n}return l(r,[{key:"toArray",value:function(){return n.erect3DFloat(this.renderValues(),this.output[0],this.output[1],this.output[2])}}]),r}(e("./float").GLTextureFloat);t.exports={GLTextureFloat3D:i}},{"../../../utils":113,"./float":25}],25:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e){var n;return c(this,r),(n=t.call(this,e)).type="ArrayTexture(1)",n}return l(r,[{key:"textureType",get:function(){return this.context.FLOAT}}]),l(r,[{key:"renderRawOutput",value:function(){var e=this.context,t=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,t),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture,0);var r=new Float32Array(this.size[0]*this.size[1]*4);return e.readPixels(0,0,this.size[0],this.size[1],e.RGBA,e.FLOAT,r),r}},{key:"renderValues",value:function(){return this._deleted?null:this.renderRawOutput()}},{key:"toArray",value:function(){return n.erectFloat(this.renderValues(),this.output[0])}}]),r}(e("./index").GLTexture);t.exports={GLTextureFloat:i}},{"../../../utils":113,"./index":27}],26:[function(e,t,r){var n=function(e){"use strict";h(r,e);var t=p(r);function r(e){var n;return c(this,r),(n=t.call(this,e)).type="ArrayTexture(4)",n}return l(r,[{key:"toArray",value:function(){return this.renderValues()}}]),r}(e("./unsigned").GLTextureUnsigned);t.exports={GLTextureGraphical:n}},{"./unsigned":33}],27:[function(e,t,r){var n=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"clone",value:function(){var e=this.context,t=this.size,r=this.texture;e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var n=e.createTexture();return e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,this.internalFormat,t[0],t[1],0,this.textureFormat,this.textureType,null),e.copyTexSubImage2D(e.TEXTURE_2D,0,0,0,0,0,t[0],t[1]),new this.constructor(Object.assign({},this,{texture:n}))}},{key:"textureType",get:function(){throw new Error('"textureType" not implemented on '.concat(this.name))}}]),r}(e("../../../texture").Texture);t.exports={GLTexture:n}},{"../../../texture":112}],28:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e){var n;return c(this,r),(n=t.call(this,e)).type="MemoryOptimizedNumberTexture",n}return l(r,[{key:"toArray",value:function(){return n.erectMemoryOptimized2DFloat(this.renderValues(),this.output[0],this.output[1])}}]),r}(e("./float").GLTextureFloat);t.exports={GLTextureMemoryOptimized2D:i}},{"../../../utils":113,"./float":25}],29:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e){var n;return c(this,r),(n=t.call(this,e)).type="MemoryOptimizedNumberTexture",n}return l(r,[{key:"toArray",value:function(){return n.erectMemoryOptimized3DFloat(this.renderValues(),this.output[0],this.output[1],this.output[2])}}]),r}(e("./float").GLTextureFloat);t.exports={GLTextureMemoryOptimized3D:i}},{"../../../utils":113,"./float":25}],30:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e){var n;return c(this,r),(n=t.call(this,e)).type="MemoryOptimizedNumberTexture",n}return l(r,[{key:"toArray",value:function(){return n.erectMemoryOptimizedFloat(this.renderValues(),this.output[0])}}]),r}(e("./float").GLTextureFloat);t.exports={GLTextureMemoryOptimized:i}},{"../../../utils":113,"./float":25}],31:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e){var n;return c(this,r),(n=t.call(this,e)).type="NumberTexture",n}return l(r,[{key:"toArray",value:function(){return n.erect2DPackedFloat(this.renderValues(),this.output[0],this.output[1])}}]),r}(e("./unsigned").GLTextureUnsigned);t.exports={GLTextureUnsigned2D:i}},{"../../../utils":113,"./unsigned":33}],32:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e){var n;return c(this,r),(n=t.call(this,e)).type="NumberTexture",n}return l(r,[{key:"toArray",value:function(){return n.erect3DPackedFloat(this.renderValues(),this.output[0],this.output[1],this.output[2])}}]),r}(e("./unsigned").GLTextureUnsigned);t.exports={GLTextureUnsigned3D:i}},{"../../../utils":113,"./unsigned":33}],33:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e){var n;return c(this,r),(n=t.call(this,e)).type="NumberTexture",n}return l(r,[{key:"textureType",get:function(){return this.context.UNSIGNED_BYTE}}]),l(r,[{key:"renderRawOutput",value:function(){var e=this.context,t=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,t),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture,0);var r=new Uint8Array(this.size[0]*this.size[1]*4);return e.readPixels(0,0,this.size[0],this.size[1],e.RGBA,e.UNSIGNED_BYTE,r),r}},{key:"renderValues",value:function(){return this._deleted?null:new Float32Array(this.renderRawOutput().buffer)}},{key:"toArray",value:function(){return n.erectPackedFloat(this.renderValues(),this.output[0])}}]),r}(e("./index").GLTexture);t.exports={GLTextureUnsigned:i}},{"../../../utils":113,"./index":27}],34:[function(e,t,r){var n=e("gl"),i=e("../web-gl/kernel").WebGLKernel,a=e("../gl/kernel-string").glKernelString,o=null,f=null,d=null,m=null,y=null,g=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"initCanvas",value:function(){return{}}},{key:"initContext",value:function(){return n(2,2,{preserveDrawingBuffer:!0})}},{key:"initExtensions",value:function(){this.extensions={STACKGL_resize_drawingbuffer:this.context.getExtension("STACKGL_resize_drawingbuffer"),STACKGL_destroy_context:this.context.getExtension("STACKGL_destroy_context"),OES_texture_float:this.context.getExtension("OES_texture_float"),OES_texture_float_linear:this.context.getExtension("OES_texture_float_linear"),OES_element_index_uint:this.context.getExtension("OES_element_index_uint"),WEBGL_draw_buffers:this.context.getExtension("WEBGL_draw_buffers")}}},{key:"build",value:function(){s(u(r.prototype),"build",this).apply(this,arguments),this.fallbackRequested||this.extensions.STACKGL_resize_drawingbuffer.resize(this.maxTexSize[0],this.maxTexSize[1])}},{key:"destroyExtensions",value:function(){this.extensions.STACKGL_resize_drawingbuffer=null,this.extensions.STACKGL_destroy_context=null,this.extensions.OES_texture_float=null,this.extensions.OES_texture_float_linear=null,this.extensions.OES_element_index_uint=null,this.extensions.WEBGL_draw_buffers=null}},{key:"toString",value:function(){var e="const gl = context || require('gl')(1, 1);\n",t="    if (!context) { gl.getExtension('STACKGL_destroy_context').destroy(); }\n";return a(this.constructor,arguments,this,e,t)}},{key:"setOutput",value:function(e){return s(u(r.prototype),"setOutput",this).call(this,e),this.graphical&&this.extensions.STACKGL_resize_drawingbuffer&&this.extensions.STACKGL_resize_drawingbuffer.resize(this.maxTexSize[0],this.maxTexSize[1]),this}}],[{key:"setupFeatureChecks",value:function(){if(f=null,m=null,"function"==typeof n)try{if(!(d=n(2,2,{preserveDrawingBuffer:!0}))||!d.getExtension)return;m={STACKGL_resize_drawingbuffer:d.getExtension("STACKGL_resize_drawingbuffer"),STACKGL_destroy_context:d.getExtension("STACKGL_destroy_context"),OES_texture_float:d.getExtension("OES_texture_float"),OES_texture_float_linear:d.getExtension("OES_texture_float_linear"),OES_element_index_uint:d.getExtension("OES_element_index_uint"),WEBGL_draw_buffers:d.getExtension("WEBGL_draw_buffers"),WEBGL_color_buffer_float:d.getExtension("WEBGL_color_buffer_float")},y=this.getFeatures()}catch(e){console.warn(e)}}},{key:"isContextMatch",value:function(e){try{return"ANGLE"===e.getParameter(e.RENDERER)}catch(e){return!1}}},{key:"getIsTextureFloat",value:function(){return Boolean(m.OES_texture_float)}},{key:"getIsDrawBuffers",value:function(){return Boolean(m.WEBGL_draw_buffers)}},{key:"getChannelCount",value:function(){return m.WEBGL_draw_buffers?d.getParameter(m.WEBGL_draw_buffers.MAX_DRAW_BUFFERS_WEBGL):1}},{key:"getMaxTextureSize",value:function(){return d.getParameter(d.MAX_TEXTURE_SIZE)}},{key:"destroyContext",value:function(e){var t=e.getExtension("STACKGL_destroy_context");t&&t.destroy&&t.destroy()}},{key:"isSupported",get:function(){return null!==o?o:(this.setupFeatureChecks(),o=null!==d)}},{key:"testCanvas",get:function(){return f}},{key:"testContext",get:function(){return d}},{key:"features",get:function(){return y}}]),r}(i);t.exports={HeadlessGLKernel:g}},{"../gl/kernel-string":12,"../web-gl/kernel":69,gl:2}],35:[function(e,t,r){var n=function(){"use strict";function e(t,r){c(this,e);var n=r.name,i=r.kernel,a=r.context,o=r.checkContext,s=r.onRequestContextHandle,u=r.onUpdateValueMismatch,l=r.origin,h=r.strictIntegers,p=r.type,f=r.tactic;if(!n)throw new Error("name not set");if(!p)throw new Error("type not set");if(!l)throw new Error("origin not set");if("user"!==l&&"constants"!==l)throw new Error('origin must be "user" or "constants" value is "'.concat(l,'"'));if(!s)throw new Error("onRequestContextHandle is not set");this.name=n,this.origin=l,this.tactic=f,this.id="".concat(this.origin,"_").concat(n),this.varName="constants"===l?"constants.".concat(n):n,this.kernel=i,this.strictIntegers=h,this.type=t.type||p,this.size=t.size||null,this.index=null,this.context=a,this.checkContext=null==o||o,this.contextHandle=null,this.onRequestContextHandle=s,this.onUpdateValueMismatch=u,this.forceUploadEachRun=null}return l(e,[{key:"getSource",value:function(){throw new Error('"getSource" not defined on '.concat(this.constructor.name))}},{key:"updateValue",value:function(e){throw new Error('"updateValue" not defined on '.concat(this.constructor.name))}}]),e}();t.exports={KernelValue:n}},{}],36:[function(e,t,r){var n=e("../utils").utils,i=e("../input").Input,a=function(){"use strict";function e(t,r){if(c(this,e),"object"!==d(t)){if("string"!=typeof t)throw new Error("source not a string");if(!n.isFunctionString(t))throw new Error("source not a function string")}this.useLegacyEncoder=!1,this.fallbackRequested=!1,this.onRequestFallback=null,this.argumentNames="string"==typeof t?n.getArgumentNamesFromString(t):null,this.argumentTypes=null,this.argumentSizes=null,this.argumentBitRatios=null,this.kernelArguments=null,this.kernelConstants=null,this.forceUploadKernelConstants=null,this.source=t,this.output=null,this.debug=!1,this.graphical=!1,this.loopMaxIterations=0,this.constants=null,this.constantTypes=null,this.constantBitRatios=null,this.dynamicArguments=!1,this.dynamicOutput=!1,this.canvas=null,this.context=null,this.checkContext=null,this.gpu=null,this.functions=null,this.nativeFunctions=null,this.injectedNative=null,this.subKernels=null,this.validate=!0,this.immutable=!1,this.pipeline=!1,this.precision=null,this.tactic=null,this.plugins=null,this.returnType=null,this.leadingReturnStatement=null,this.followingReturnStatement=null,this.optimizeFloatMemory=null,this.strictIntegers=!1,this.fixIntegerDivisionAccuracy=null,this.warnVarUsage=!0,this.onIstanbulCoverageVariable=null,this.removeIstanbulCoverage=!1,this.built=!1}return l(e,null,[{key:"isContextMatch",value:function(e){throw new Error('"isContextMatch" not implemented on '.concat(this.name))}},{key:"getFeatures",value:function(){throw new Error('"getFeatures" not implemented on '.concat(this.name))}},{key:"destroyContext",value:function(e){throw new Error('"destroyContext" called on '.concat(this.name))}},{key:"nativeFunctionArguments",value:function(){throw new Error('"nativeFunctionArguments" called on '.concat(this.name))}},{key:"nativeFunctionReturnType",value:function(){throw new Error('"nativeFunctionReturnType" called on '.concat(this.name))}},{key:"combineKernels",value:function(){throw new Error('"combineKernels" called on '.concat(this.name))}},{key:"isSupported",get:function(){throw new Error('"isSupported" not implemented on '.concat(this.name))}}]),l(e,[{key:"mergeSettings",value:function(e){for(var t in e)if(e.hasOwnProperty(t)&&this.hasOwnProperty(t)){switch(t){case"output":if(!Array.isArray(e.output)){this.setOutput(e.output);continue}break;case"functions":if("function"==typeof e.functions[0]){this.functions=e.functions.map((function(e){return n.functionToIFunction(e)}));continue}break;case"graphical":e[t]&&!e.hasOwnProperty("precision")&&(this.precision="unsigned"),this[t]=e[t];continue;case"removeIstanbulCoverage":null!==e[t]&&(this[t]=e[t]);continue}this[t]=e[t]}this.canvas||(this.canvas=this.initCanvas()),this.context||(this.context=this.initContext()),this.plugins||(this.plugins=this.initPlugins(e))}},{key:"build",value:function(){throw new Error('"build" not defined on '.concat(this.constructor.name))}},{key:"run",value:function(){throw new Error('"run" not defined on '.concat(this.constructor.name))}},{key:"initCanvas",value:function(){throw new Error('"initCanvas" not defined on '.concat(this.constructor.name))}},{key:"initContext",value:function(){throw new Error('"initContext" not defined on '.concat(this.constructor.name))}},{key:"initPlugins",value:function(e){throw new Error('"initPlugins" not defined on '.concat(this.constructor.name))}},{key:"setupArguments",value:function(e){if(this.kernelArguments=[],this.argumentTypes)for(var t=0;t<this.argumentTypes.length;t++)this.kernelArguments.push({type:this.argumentTypes[t]});else if(!this.argumentTypes){this.argumentTypes=[];for(var r=0;r<e.length;r++){var a=n.getVariableType(e[r],this.strictIntegers),o="Integer"===a?"Number":a;this.argumentTypes.push(o),this.kernelArguments.push({type:o})}}this.argumentSizes=new Array(e.length),this.argumentBitRatios=new Int32Array(e.length);for(var s=0;s<e.length;s++){var u=e[s];this.argumentSizes[s]=u.constructor===i?u.size:null,this.argumentBitRatios[s]=this.getBitRatio(u)}if(this.argumentNames.length!==e.length)throw new Error("arguments are miss-aligned")}},{key:"setupConstants",value:function(){this.kernelConstants=[];var e=null===this.constantTypes;if(e&&(this.constantTypes={}),this.constantBitRatios={},this.constants)for(var t in this.constants){if(e){var r=n.getVariableType(this.constants[t],this.strictIntegers);this.constantTypes[t]=r,this.kernelConstants.push({name:t,type:r})}else this.kernelConstants.push({name:t,type:this.constantTypes[t]});this.constantBitRatios[t]=this.getBitRatio(this.constants[t])}}},{key:"setOptimizeFloatMemory",value:function(e){return this.optimizeFloatMemory=e,this}},{key:"toKernelOutput",value:function(e){return e.hasOwnProperty("x")?e.hasOwnProperty("y")?e.hasOwnProperty("z")?[e.x,e.y,e.z]:[e.x,e.y]:[e.x]:e}},{key:"setOutput",value:function(e){return this.output=this.toKernelOutput(e),this}},{key:"setDebug",value:function(e){return this.debug=e,this}},{key:"setGraphical",value:function(e){return this.graphical=e,this.precision="unsigned",this}},{key:"setLoopMaxIterations",value:function(e){return this.loopMaxIterations=e,this}},{key:"setConstants",value:function(e){return this.constants=e,this}},{key:"setConstantTypes",value:function(e){return this.constantTypes=e,this}},{key:"setFunctions",value:function(e){return"function"==typeof e[0]?this.functions=e.map((function(e){return n.functionToIFunction(e)})):this.functions=e,this}},{key:"setNativeFunctions",value:function(e){return this.nativeFunctions=e,this}},{key:"setInjectedNative",value:function(e){return this.injectedNative=e,this}},{key:"setPipeline",value:function(e){return this.pipeline=e,this}},{key:"setPrecision",value:function(e){return this.precision=e,this}},{key:"setOutputToTexture",value:function(e){return n.warnDeprecated("method","setOutputToTexture","setPipeline"),this.pipeline=e,this}},{key:"setImmutable",value:function(e){return this.immutable=e,this}},{key:"setCanvas",value:function(e){return this.canvas=e,this}},{key:"setStrictIntegers",value:function(e){return this.strictIntegers=e,this}},{key:"setDynamicOutput",value:function(e){return this.dynamicOutput=e,this}},{key:"setHardcodeConstants",value:function(e){return n.warnDeprecated("method","setHardcodeConstants"),this.setDynamicOutput(e),this.setDynamicArguments(e),this}},{key:"setDynamicArguments",value:function(e){return this.dynamicArguments=e,this}},{key:"setUseLegacyEncoder",value:function(e){return this.useLegacyEncoder=e,this}},{key:"setWarnVarUsage",value:function(e){return this.warnVarUsage=e,this}},{key:"getCanvas",value:function(){return n.warnDeprecated("method","getCanvas"),this.canvas}},{key:"getWebGl",value:function(){return n.warnDeprecated("method","getWebGl"),this.context}},{key:"setContext",value:function(e){return this.context=e,this}},{key:"setArgumentTypes",value:function(e){if(Array.isArray(e))this.argumentTypes=e;else for(var t in this.argumentTypes=[],e)if(e.hasOwnProperty(t)){var r=this.argumentNames.indexOf(t);if(-1===r)throw new Error("unable to find argument ".concat(t));this.argumentTypes[r]=e[t]}return this}},{key:"setTactic",value:function(e){return this.tactic=e,this}},{key:"requestFallback",value:function(e){if(!this.onRequestFallback)throw new Error('"onRequestFallback" not defined on '.concat(this.constructor.name));return this.fallbackRequested=!0,this.onRequestFallback(e)}},{key:"validateSettings",value:function(){throw new Error('"validateSettings" not defined on '.concat(this.constructor.name))}},{key:"addSubKernel",value:function(e){if(null===this.subKernels&&(this.subKernels=[]),!e.source)throw new Error('subKernel missing "source" property');if(!e.property&&isNaN(e.property))throw new Error('subKernel missing "property" property');if(!e.name)throw new Error('subKernel missing "name" property');return this.subKernels.push(e),this}},{key:"destroy",value:function(e){throw new Error('"destroy" called on '.concat(this.constructor.name))}},{key:"getBitRatio",value:function(e){if("single"===this.precision)return 4;if(Array.isArray(e[0]))return this.getBitRatio(e[0]);if(e.constructor===i)return this.getBitRatio(e.value);switch(e.constructor){case Uint8ClampedArray:case Uint8Array:case Int8Array:return 1;case Uint16Array:case Int16Array:return 2;case Float32Array:case Int32Array:default:return 4}}},{key:"getPixels",value:function(e){throw new Error('"getPixels" called on '.concat(this.constructor.name))}},{key:"checkOutput",value:function(){if(!this.output||!n.isArray(this.output))throw new Error("kernel.output not an array");if(this.output.length<1)throw new Error("kernel.output is empty, needs at least 1 value");for(var e=0;e<this.output.length;e++)if(isNaN(this.output[e])||this.output[e]<1)throw new Error("".concat(this.constructor.name,".output[").concat(e,"] incorrectly defined as `").concat(this.output[e],"`, needs to be numeric, and greater than 0"))}},{key:"prependString",value:function(e){throw new Error('"prependString" called on '.concat(this.constructor.name))}},{key:"hasPrependString",value:function(e){throw new Error('"hasPrependString" called on '.concat(this.constructor.name))}},{key:"toJSON",value:function(){return{settings:{output:this.output,pipeline:this.pipeline,argumentNames:this.argumentNames,argumentsTypes:this.argumentTypes,constants:this.constants,pluginNames:this.plugins?this.plugins.map((function(e){return e.name})):null,returnType:this.returnType}}}}]),e}();t.exports={Kernel:a}},{"../input":109,"../utils":113}],37:[function(e,t,r){t.exports={fragmentShader:"__HEADER__;\n__FLOAT_TACTIC_DECLARATION__;\n__INT_TACTIC_DECLARATION__;\n__SAMPLER_2D_TACTIC_DECLARATION__;\n\nconst int LOOP_MAX = __LOOP_MAX__;\n\n__PLUGINS__;\n__CONSTANTS__;\n\nvarying vec2 vTexCoord;\n\nvec4 round(vec4 x) {\n  return floor(x + 0.5);\n}\n\nfloat round(float x) {\n  return floor(x + 0.5);\n}\n\nconst int BIT_COUNT = 32;\nint modi(int x, int y) {\n  return x - y * (x / y);\n}\n\nint bitwiseOr(int a, int b) {\n  int result = 0;\n  int n = 1;\n  \n  for (int i = 0; i < BIT_COUNT; i++) {\n    if ((modi(a, 2) == 1) || (modi(b, 2) == 1)) {\n      result += n;\n    }\n    a = a / 2;\n    b = b / 2;\n    n = n * 2;\n    if(!(a > 0 || b > 0)) {\n      break;\n    }\n  }\n  return result;\n}\nint bitwiseXOR(int a, int b) {\n  int result = 0;\n  int n = 1;\n  \n  for (int i = 0; i < BIT_COUNT; i++) {\n    if ((modi(a, 2) == 1) != (modi(b, 2) == 1)) {\n      result += n;\n    }\n    a = a / 2;\n    b = b / 2;\n    n = n * 2;\n    if(!(a > 0 || b > 0)) {\n      break;\n    }\n  }\n  return result;\n}\nint bitwiseAnd(int a, int b) {\n  int result = 0;\n  int n = 1;\n  for (int i = 0; i < BIT_COUNT; i++) {\n    if ((modi(a, 2) == 1) && (modi(b, 2) == 1)) {\n      result += n;\n    }\n    a = a / 2;\n    b = b / 2;\n    n = n * 2;\n    if(!(a > 0 && b > 0)) {\n      break;\n    }\n  }\n  return result;\n}\nint bitwiseNot(int a) {\n  int result = 0;\n  int n = 1;\n  \n  for (int i = 0; i < BIT_COUNT; i++) {\n    if (modi(a, 2) == 0) {\n      result += n;    \n    }\n    a = a / 2;\n    n = n * 2;\n  }\n  return result;\n}\nint bitwiseZeroFillLeftShift(int n, int shift) {\n  int maxBytes = BIT_COUNT;\n  for (int i = 0; i < BIT_COUNT; i++) {\n    if (maxBytes >= n) {\n      break;\n    }\n    maxBytes *= 2;\n  }\n  for (int i = 0; i < BIT_COUNT; i++) {\n    if (i >= shift) {\n      break;\n    }\n    n *= 2;\n  }\n\n  int result = 0;\n  int byteVal = 1;\n  for (int i = 0; i < BIT_COUNT; i++) {\n    if (i >= maxBytes) break;\n    if (modi(n, 2) > 0) { result += byteVal; }\n    n = int(n / 2);\n    byteVal *= 2;\n  }\n  return result;\n}\n\nint bitwiseSignedRightShift(int num, int shifts) {\n  return int(floor(float(num) / pow(2.0, float(shifts))));\n}\n\nint bitwiseZeroFillRightShift(int n, int shift) {\n  int maxBytes = BIT_COUNT;\n  for (int i = 0; i < BIT_COUNT; i++) {\n    if (maxBytes >= n) {\n      break;\n    }\n    maxBytes *= 2;\n  }\n  for (int i = 0; i < BIT_COUNT; i++) {\n    if (i >= shift) {\n      break;\n    }\n    n /= 2;\n  }\n  int result = 0;\n  int byteVal = 1;\n  for (int i = 0; i < BIT_COUNT; i++) {\n    if (i >= maxBytes) break;\n    if (modi(n, 2) > 0) { result += byteVal; }\n    n = int(n / 2);\n    byteVal *= 2;\n  }\n  return result;\n}\n\nvec2 integerMod(vec2 x, float y) {\n  vec2 res = floor(mod(x, y));\n  return res * step(1.0 - floor(y), -res);\n}\n\nvec3 integerMod(vec3 x, float y) {\n  vec3 res = floor(mod(x, y));\n  return res * step(1.0 - floor(y), -res);\n}\n\nvec4 integerMod(vec4 x, vec4 y) {\n  vec4 res = floor(mod(x, y));\n  return res * step(1.0 - floor(y), -res);\n}\n\nfloat integerMod(float x, float y) {\n  float res = floor(mod(x, y));\n  return res * (res > floor(y) - 1.0 ? 0.0 : 1.0);\n}\n\nint integerMod(int x, int y) {\n  return x - (y * int(x / y));\n}\n\n__DIVIDE_WITH_INTEGER_CHECK__;\n\n// Here be dragons!\n// DO NOT OPTIMIZE THIS CODE\n// YOU WILL BREAK SOMETHING ON SOMEBODY'S MACHINE\n// LEAVE IT AS IT IS, LEST YOU WASTE YOUR OWN TIME\nconst vec2 MAGIC_VEC = vec2(1.0, -256.0);\nconst vec4 SCALE_FACTOR = vec4(1.0, 256.0, 65536.0, 0.0);\nconst vec4 SCALE_FACTOR_INV = vec4(1.0, 0.00390625, 0.0000152587890625, 0.0); // 1, 1/256, 1/65536\nfloat decode32(vec4 texel) {\n  __DECODE32_ENDIANNESS__;\n  texel *= 255.0;\n  vec2 gte128;\n  gte128.x = texel.b >= 128.0 ? 1.0 : 0.0;\n  gte128.y = texel.a >= 128.0 ? 1.0 : 0.0;\n  float exponent = 2.0 * texel.a - 127.0 + dot(gte128, MAGIC_VEC);\n  float res = exp2(round(exponent));\n  texel.b = texel.b - 128.0 * gte128.x;\n  res = dot(texel, SCALE_FACTOR) * exp2(round(exponent-23.0)) + res;\n  res *= gte128.y * -2.0 + 1.0;\n  return res;\n}\n\nfloat decode16(vec4 texel, int index) {\n  int channel = integerMod(index, 2);\n  if (channel == 0) return texel.r * 255.0 + texel.g * 65280.0;\n  if (channel == 1) return texel.b * 255.0 + texel.a * 65280.0;\n  return 0.0;\n}\n\nfloat decode8(vec4 texel, int index) {\n  int channel = integerMod(index, 4);\n  if (channel == 0) return texel.r * 255.0;\n  if (channel == 1) return texel.g * 255.0;\n  if (channel == 2) return texel.b * 255.0;\n  if (channel == 3) return texel.a * 255.0;\n  return 0.0;\n}\n\nvec4 legacyEncode32(float f) {\n  float F = abs(f);\n  float sign = f < 0.0 ? 1.0 : 0.0;\n  float exponent = floor(log2(F));\n  float mantissa = (exp2(-exponent) * F);\n  // exponent += floor(log2(mantissa));\n  vec4 texel = vec4(F * exp2(23.0-exponent)) * SCALE_FACTOR_INV;\n  texel.rg = integerMod(texel.rg, 256.0);\n  texel.b = integerMod(texel.b, 128.0);\n  texel.a = exponent*0.5 + 63.5;\n  texel.ba += vec2(integerMod(exponent+127.0, 2.0), sign) * 128.0;\n  texel = floor(texel);\n  texel *= 0.003921569; // 1/255\n  __ENCODE32_ENDIANNESS__;\n  return texel;\n}\n\n// https://github.com/gpujs/gpu.js/wiki/Encoder-details\nvec4 encode32(float value) {\n  if (value == 0.0) return vec4(0, 0, 0, 0);\n\n  float exponent;\n  float mantissa;\n  vec4  result;\n  float sgn;\n\n  sgn = step(0.0, -value);\n  value = abs(value);\n\n  exponent = floor(log2(value));\n\n  mantissa = value*pow(2.0, -exponent)-1.0;\n  exponent = exponent+127.0;\n  result   = vec4(0,0,0,0);\n\n  result.a = floor(exponent/2.0);\n  exponent = exponent - result.a*2.0;\n  result.a = result.a + 128.0*sgn;\n\n  result.b = floor(mantissa * 128.0);\n  mantissa = mantissa - result.b / 128.0;\n  result.b = result.b + exponent*128.0;\n\n  result.g = floor(mantissa*32768.0);\n  mantissa = mantissa - result.g/32768.0;\n\n  result.r = floor(mantissa*8388608.0);\n  return result/255.0;\n}\n// Dragons end here\n\nint index;\nivec3 threadId;\n\nivec3 indexTo3D(int idx, ivec3 texDim) {\n  int z = int(idx / (texDim.x * texDim.y));\n  idx -= z * int(texDim.x * texDim.y);\n  int y = int(idx / texDim.x);\n  int x = int(integerMod(idx, texDim.x));\n  return ivec3(x, y, z);\n}\n\nfloat get32(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  int index = x + texDim.x * (y + texDim.y * z);\n  int w = texSize.x;\n  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;\n  vec4 texel = texture2D(tex, st / vec2(texSize));\n  return decode32(texel);\n}\n\nfloat get16(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  int index = x + texDim.x * (y + texDim.y * z);\n  int w = texSize.x * 2;\n  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;\n  vec4 texel = texture2D(tex, st / vec2(texSize.x * 2, texSize.y));\n  return decode16(texel, index);\n}\n\nfloat get8(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  int index = x + texDim.x * (y + texDim.y * z);\n  int w = texSize.x * 4;\n  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;\n  vec4 texel = texture2D(tex, st / vec2(texSize.x * 4, texSize.y));\n  return decode8(texel, index);\n}\n\nfloat getMemoryOptimized32(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  int index = x + texDim.x * (y + texDim.y * z);\n  int channel = integerMod(index, 4);\n  index = index / 4;\n  int w = texSize.x;\n  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;\n  vec4 texel = texture2D(tex, st / vec2(texSize));\n  if (channel == 0) return texel.r;\n  if (channel == 1) return texel.g;\n  if (channel == 2) return texel.b;\n  if (channel == 3) return texel.a;\n  return 0.0;\n}\n\nvec4 getImage2D(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  int index = x + texDim.x * (y + texDim.y * z);\n  int w = texSize.x;\n  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;\n  return texture2D(tex, st / vec2(texSize));\n}\n\nfloat getFloatFromSampler2D(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  vec4 result = getImage2D(tex, texSize, texDim, z, y, x);\n  return result[0];\n}\n\nvec2 getVec2FromSampler2D(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  vec4 result = getImage2D(tex, texSize, texDim, z, y, x);\n  return vec2(result[0], result[1]);\n}\n\nvec2 getMemoryOptimizedVec2(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  int index = x + (texDim.x * (y + (texDim.y * z)));\n  int channel = integerMod(index, 2);\n  index = index / 2;\n  int w = texSize.x;\n  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;\n  vec4 texel = texture2D(tex, st / vec2(texSize));\n  if (channel == 0) return vec2(texel.r, texel.g);\n  if (channel == 1) return vec2(texel.b, texel.a);\n  return vec2(0.0, 0.0);\n}\n\nvec3 getVec3FromSampler2D(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  vec4 result = getImage2D(tex, texSize, texDim, z, y, x);\n  return vec3(result[0], result[1], result[2]);\n}\n\nvec3 getMemoryOptimizedVec3(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  int fieldIndex = 3 * (x + texDim.x * (y + texDim.y * z));\n  int vectorIndex = fieldIndex / 4;\n  int vectorOffset = fieldIndex - vectorIndex * 4;\n  int readY = vectorIndex / texSize.x;\n  int readX = vectorIndex - readY * texSize.x;\n  vec4 tex1 = texture2D(tex, (vec2(readX, readY) + 0.5) / vec2(texSize));\n  \n  if (vectorOffset == 0) {\n    return tex1.xyz;\n  } else if (vectorOffset == 1) {\n    return tex1.yzw;\n  } else {\n    readX++;\n    if (readX >= texSize.x) {\n      readX = 0;\n      readY++;\n    }\n    vec4 tex2 = texture2D(tex, vec2(readX, readY) / vec2(texSize));\n    if (vectorOffset == 2) {\n      return vec3(tex1.z, tex1.w, tex2.x);\n    } else {\n      return vec3(tex1.w, tex2.x, tex2.y);\n    }\n  }\n}\n\nvec4 getVec4FromSampler2D(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  return getImage2D(tex, texSize, texDim, z, y, x);\n}\n\nvec4 getMemoryOptimizedVec4(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  int index = x + texDim.x * (y + texDim.y * z);\n  int channel = integerMod(index, 2);\n  int w = texSize.x;\n  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;\n  vec4 texel = texture2D(tex, st / vec2(texSize));\n  return vec4(texel.r, texel.g, texel.b, texel.a);\n}\n\nvec4 actualColor;\nvoid color(float r, float g, float b, float a) {\n  actualColor = vec4(r,g,b,a);\n}\n\nvoid color(float r, float g, float b) {\n  color(r,g,b,1.0);\n}\n\nvoid color(sampler2D image) {\n  actualColor = texture2D(image, vTexCoord);\n}\n\n__INJECTED_NATIVE__;\n__MAIN_CONSTANTS__;\n__MAIN_ARGUMENTS__;\n__KERNEL__;\n\nvoid main(void) {\n  index = int(vTexCoord.s * float(uTexSize.x)) + int(vTexCoord.t * float(uTexSize.y)) * uTexSize.x;\n  __MAIN_RESULT__;\n}"}},{}],38:[function(e,t,r){var n=function(e){"use strict";h(r,e);var t=p(r);function r(e,n){var i;return c(this,r),i=t.call(this,e,n),n&&n.hasOwnProperty("fixIntegerDivisionAccuracy")&&(i.fixIntegerDivisionAccuracy=n.fixIntegerDivisionAccuracy),i}return l(r,[{key:"astFunction",value:function(e,t){if(this.isRootKernel)t.push("void");else{this.returnType||this.findLastReturn()&&(this.returnType=this.getType(e.body),"LiteralInteger"===this.returnType&&(this.returnType="Number"));var r=this.returnType;if(r){var n=i[r];if(!n)throw new Error("unknown type ".concat(r));t.push(n)}else t.push("void")}if(t.push(" "),t.push(this.name),t.push("("),!this.isRootKernel)for(var a=0;a<this.argumentNames.length;++a){var o=this.argumentNames[a];a>0&&t.push(", ");var s=this.argumentTypes[this.argumentNames.indexOf(o)];if(!s)throw this.astErrorOutput("Unknown argument ".concat(o," type"),e);"LiteralInteger"===s&&(this.argumentTypes[a]=s="Number");var u=i[s];if(!u)throw this.astErrorOutput("Unexpected expression",e);"sampler2D"===u||"sampler2DArray"===u?t.push("".concat(u," user_").concat(o,",ivec2 user_").concat(o,"Size,ivec3 user_").concat(o,"Dim")):t.push("".concat(u," user_").concat(o))}t.push(") {\n");for(var c=0;c<e.body.body.length;++c)this.astGeneric(e.body.body[c],t),t.push("\n");return t.push("}\n"),t}},{key:"astReturnStatement",value:function(e,t){if(!e.argument)throw this.astErrorOutput("Unexpected return statement",e);this.pushState("skip-literal-correction");var r=this.getType(e.argument);this.popState("skip-literal-correction");var n=[];switch(this.returnType||(this.returnType="LiteralInteger"===r||"Integer"===r?"Number":r),this.returnType){case"LiteralInteger":case"Number":case"Float":switch(r){case"Integer":n.push("float("),this.astGeneric(e.argument,n),n.push(")");break;case"LiteralInteger":this.castLiteralToFloat(e.argument,n),"Integer"===this.getType(e)&&(n.unshift("float("),n.push(")"));break;default:this.astGeneric(e.argument,n)}break;case"Integer":switch(r){case"Float":case"Number":this.castValueToInteger(e.argument,n);break;case"LiteralInteger":this.castLiteralToInteger(e.argument,n);break;default:this.astGeneric(e.argument,n)}break;case"Array(4)":case"Array(3)":case"Array(2)":case"Input":this.astGeneric(e.argument,n);break;default:throw this.astErrorOutput("unhandled return type ".concat(this.returnType),e)}return this.isRootKernel?(t.push("kernelResult = ".concat(n.join(""),";")),t.push("return;")):this.isSubKernel?(t.push("subKernelResult_".concat(this.name," = ").concat(n.join(""),";")),t.push("return subKernelResult_".concat(this.name,";"))):t.push("return ".concat(n.join(""),";")),t}},{key:"astLiteral",value:function(e,t){if(isNaN(e.value))throw this.astErrorOutput("Non-numeric literal not supported : "+e.value,e);var r=this.astKey(e);return Number.isInteger(e.value)?this.isState("in-for-loop-init")||this.isState("casting-to-integer")||this.isState("building-integer")?(this.literalTypes[r]="Integer",t.push("".concat(e.value))):(this.isState("casting-to-float")||this.isState("building-float"),this.literalTypes[r]="Number",t.push("".concat(e.value,".0"))):this.isState("casting-to-integer")||this.isState("building-integer")?(this.literalTypes[r]="Integer",t.push(Math.round(e.value))):(this.literalTypes[r]="Number",t.push("".concat(e.value))),t}},{key:"astBinaryExpression",value:function(e,t){if(this.checkAndUpconvertOperator(e,t))return t;if(this.fixIntegerDivisionAccuracy&&"/"===e.operator){switch(t.push("div_with_int_check("),this.pushState("building-float"),this.getType(e.left)){case"Integer":this.castValueToFloat(e.left,t);break;case"LiteralInteger":this.castLiteralToFloat(e.left,t);break;default:this.astGeneric(e.left,t)}switch(t.push(", "),this.getType(e.right)){case"Integer":this.castValueToFloat(e.right,t);break;case"LiteralInteger":this.castLiteralToFloat(e.right,t);break;default:this.astGeneric(e.right,t)}return this.popState("building-float"),t.push(")"),t}t.push("(");var r=this.getType(e.left)||"Number",n=this.getType(e.right)||"Number";if(!r||!n)throw this.astErrorOutput("Unhandled binary expression",e);var i=r+" & "+n;switch(i){case"Integer & Integer":this.pushState("building-integer"),this.astGeneric(e.left,t),t.push(a[e.operator]||e.operator),this.astGeneric(e.right,t),this.popState("building-integer");break;case"Number & Float":case"Float & Number":case"Float & Float":case"Number & Number":this.pushState("building-float"),this.astGeneric(e.left,t),t.push(a[e.operator]||e.operator),this.astGeneric(e.right,t),this.popState("building-float");break;case"LiteralInteger & LiteralInteger":this.isState("casting-to-integer")||this.isState("building-integer")?(this.pushState("building-integer"),this.astGeneric(e.left,t),t.push(a[e.operator]||e.operator),this.astGeneric(e.right,t),this.popState("building-integer")):(this.pushState("building-float"),this.castLiteralToFloat(e.left,t),t.push(a[e.operator]||e.operator),this.castLiteralToFloat(e.right,t),this.popState("building-float"));break;case"Integer & Float":case"Integer & Number":if((">"===e.operator||"<"===e.operator&&"Literal"===e.right.type)&&!Number.isInteger(e.right.value)){this.pushState("building-float"),this.castValueToFloat(e.left,t),t.push(a[e.operator]||e.operator),this.astGeneric(e.right,t),this.popState("building-float");break}if(this.pushState("building-integer"),this.astGeneric(e.left,t),t.push(a[e.operator]||e.operator),this.pushState("casting-to-integer"),"Literal"===e.right.type){var o=[];if(this.astGeneric(e.right,o),"Integer"!==this.getType(e.right))throw this.astErrorOutput("Unhandled binary expression with literal",e);t.push(o.join(""))}else t.push("int("),this.astGeneric(e.right,t),t.push(")");this.popState("casting-to-integer"),this.popState("building-integer");break;case"Integer & LiteralInteger":this.pushState("building-integer"),this.astGeneric(e.left,t),t.push(a[e.operator]||e.operator),this.castLiteralToInteger(e.right,t),this.popState("building-integer");break;case"Number & Integer":this.pushState("building-float"),this.astGeneric(e.left,t),t.push(a[e.operator]||e.operator),this.castValueToFloat(e.right,t),this.popState("building-float");break;case"Float & LiteralInteger":case"Number & LiteralInteger":this.isState("in-for-loop-test")?(this.pushState("building-integer"),t.push("int("),this.astGeneric(e.left,t),t.push(")"),t.push(a[e.operator]||e.operator),this.castLiteralToInteger(e.right,t),this.popState("building-integer")):(this.pushState("building-float"),this.astGeneric(e.left,t),t.push(a[e.operator]||e.operator),this.castLiteralToFloat(e.right,t),this.popState("building-float"));break;case"LiteralInteger & Float":case"LiteralInteger & Number":this.isState("in-for-loop-test")||this.isState("in-for-loop-init")||this.isState("casting-to-integer")?(this.pushState("building-integer"),this.castLiteralToInteger(e.left,t),t.push(a[e.operator]||e.operator),this.castValueToInteger(e.right,t),this.popState("building-integer")):(this.pushState("building-float"),this.astGeneric(e.left,t),t.push(a[e.operator]||e.operator),this.pushState("casting-to-float"),this.astGeneric(e.right,t),this.popState("casting-to-float"),this.popState("building-float"));break;case"LiteralInteger & Integer":this.pushState("building-integer"),this.castLiteralToInteger(e.left,t),t.push(a[e.operator]||e.operator),this.astGeneric(e.right,t),this.popState("building-integer");break;case"Boolean & Boolean":this.pushState("building-boolean"),this.astGeneric(e.left,t),t.push(a[e.operator]||e.operator),this.astGeneric(e.right,t),this.popState("building-boolean");break;case"Float & Integer":this.pushState("building-float"),this.astGeneric(e.left,t),t.push(a[e.operator]||e.operator),this.castValueToFloat(e.right,t),this.popState("building-float");break;default:throw this.astErrorOutput("Unhandled binary expression between ".concat(i),e)}return t.push(")"),t}},{key:"checkAndUpconvertOperator",value:function(e,t){var r=this.checkAndUpconvertBitwiseOperators(e,t);if(r)return r;var n={"%":"mod","**":"pow"}[e.operator];if(!n)return null;switch(t.push(n),t.push("("),this.getType(e.left)){case"Integer":this.castValueToFloat(e.left,t);break;case"LiteralInteger":this.castLiteralToFloat(e.left,t);break;default:this.astGeneric(e.left,t)}switch(t.push(","),this.getType(e.right)){case"Integer":this.castValueToFloat(e.right,t);break;case"LiteralInteger":this.castLiteralToFloat(e.right,t);break;default:this.astGeneric(e.right,t)}return t.push(")"),t}},{key:"checkAndUpconvertBitwiseOperators",value:function(e,t){var r={"&":"bitwiseAnd","|":"bitwiseOr","^":"bitwiseXOR","<<":"bitwiseZeroFillLeftShift",">>":"bitwiseSignedRightShift",">>>":"bitwiseZeroFillRightShift"}[e.operator];if(!r)return null;switch(t.push(r),t.push("("),this.getType(e.left)){case"Number":case"Float":this.castValueToInteger(e.left,t);break;case"LiteralInteger":this.castLiteralToInteger(e.left,t);break;default:this.astGeneric(e.left,t)}switch(t.push(","),this.getType(e.right)){case"Number":case"Float":this.castValueToInteger(e.right,t);break;case"LiteralInteger":this.castLiteralToInteger(e.right,t);break;default:this.astGeneric(e.right,t)}return t.push(")"),t}},{key:"checkAndUpconvertBitwiseUnary",value:function(e,t){var r={"~":"bitwiseNot"}[e.operator];if(!r)return null;switch(t.push(r),t.push("("),this.getType(e.argument)){case"Number":case"Float":this.castValueToInteger(e.argument,t);break;case"LiteralInteger":this.castLiteralToInteger(e.argument,t);break;default:this.astGeneric(e.argument,t)}return t.push(")"),t}},{key:"castLiteralToInteger",value:function(e,t){return this.pushState("casting-to-integer"),this.astGeneric(e,t),this.popState("casting-to-integer"),t}},{key:"castLiteralToFloat",value:function(e,t){return this.pushState("casting-to-float"),this.astGeneric(e,t),this.popState("casting-to-float"),t}},{key:"castValueToInteger",value:function(e,t){return this.pushState("casting-to-integer"),t.push("int("),this.astGeneric(e,t),t.push(")"),this.popState("casting-to-integer"),t}},{key:"castValueToFloat",value:function(e,t){return this.pushState("casting-to-float"),t.push("float("),this.astGeneric(e,t),t.push(")"),this.popState("casting-to-float"),t}},{key:"astIdentifierExpression",value:function(e,t){if("Identifier"!==e.type)throw this.astErrorOutput("IdentifierExpression - not an Identifier",e);var r=this.getType(e);return"Infinity"===e.name?t.push("3.402823466e+38"):"Boolean"===r&&this.argumentNames.indexOf(e.name)>-1?t.push("bool(user_".concat(e.name,")")):t.push("user_".concat(e.name)),t}},{key:"astForStatement",value:function(e,t){if("ForStatement"!==e.type)throw this.astErrorOutput("Invalid for statement",e);var r=[],n=[],i=[],a=[],o=null;if(e.init){this.pushState("in-for-loop-init"),this.astGeneric(e.init,r);for(var s=e.init.declarations,u=0;u<s.length;u++)s[u].init&&"Literal"!==s[u].init.type&&(o=!1);if(o)for(var c=0;c<r.length;c++)r[c].includes&&r[c].includes(",")&&(o=!1);this.popState("in-for-loop-init")}else o=!1;if(e.test?(this.pushState("in-for-loop-test"),this.astGeneric(e.test,n),this.popState("in-for-loop-test")):o=!1,e.update?this.astGeneric(e.update,i):o=!1,e.body&&(this.pushState("loop-body"),this.astGeneric(e.body,a),this.popState("loop-body")),null===o&&(o=this.isSafe(e.init)&&this.isSafe(e.test)),o)t.push("for (".concat(r.join(""),";").concat(n.join(""),";").concat(i.join(""),"){\n")),t.push(a.join("")),t.push("}\n");else{var l=this.getInternalVariableName("safeI");r.length>0&&t.push(r.join(""),";\n"),t.push("for (int ".concat(l,"=0;").concat(l,"<LOOP_MAX;").concat(l,"++){\n")),n.length>0&&t.push("if (!".concat(n.join(""),") break;\n")),t.push(a.join("")),t.push("\n".concat(i.join(""),";")),t.push("}\n")}return t}},{key:"astWhileStatement",value:function(e,t){if("WhileStatement"!==e.type)throw this.astErrorOutput("Invalid while statement",e);var r=this.getInternalVariableName("safeI");return t.push("for (int ".concat(r,"=0;").concat(r,"<LOOP_MAX;").concat(r,"++){\n")),t.push("if (!"),this.astGeneric(e.test,t),t.push(") break;\n"),this.astGeneric(e.body,t),t.push("}\n"),t}},{key:"astDoWhileStatement",value:function(e,t){if("DoWhileStatement"!==e.type)throw this.astErrorOutput("Invalid while statement",e);var r=this.getInternalVariableName("safeI");return t.push("for (int ".concat(r,"=0;").concat(r,"<LOOP_MAX;").concat(r,"++){\n")),this.astGeneric(e.body,t),t.push("if (!"),this.astGeneric(e.test,t),t.push(") break;\n"),t.push("}\n"),t}},{key:"astAssignmentExpression",value:function(e,t){if("%="===e.operator)this.astGeneric(e.left,t),t.push("="),t.push("mod("),this.astGeneric(e.left,t),t.push(","),this.astGeneric(e.right,t),t.push(")");else{if("**="!==e.operator){var r=this.getType(e.left),n=this.getType(e.right);return this.astGeneric(e.left,t),t.push(e.operator),"Integer"!==r&&"Integer"===n?(t.push("float("),this.astGeneric(e.right,t),t.push(")")):this.astGeneric(e.right,t),t}this.astGeneric(e.left,t),t.push("="),t.push("pow("),this.astGeneric(e.left,t),t.push(","),this.astGeneric(e.right,t),t.push(")")}}},{key:"astBlockStatement",value:function(e,t){if(this.isState("loop-body")){this.pushState("block-body");for(var r=0;r<e.body.length;r++)this.astGeneric(e.body[r],t);this.popState("block-body")}else{t.push("{\n");for(var n=0;n<e.body.length;n++)this.astGeneric(e.body[n],t);t.push("}\n")}return t}},{key:"astVariableDeclaration",value:function(e,t){"var"===e.kind&&this.warnVarUsage&&this.varWarn();var r=e.declarations;if(!r||!r[0]||!r[0].init)throw this.astErrorOutput("Unexpected expression",e);for(var n=[],a=null,o=this.isState("in-for-loop-init"),s=0;s<r.length;s++){var u=r[s],c=u.init,l=this.getDeclaration(u.id),h=this.getType(u.init),p=o?"Integer":h;"LiteralInteger"===p&&(p="Number");var f=i[p];if(!f)throw this.astErrorOutput("Markup type ".concat(f," not handled"),e);var d=[];if("Integer"!==h||"Integer"!==p||o)l.valueType=p,0===s||null===a?d.push("".concat(f," ")):p!==a?(n.push(";"),d.push("".concat(f," "))):d.push(","),a=p,d.push("user_".concat(u.id.name,"=")),"Number"===h&&"Integer"===p?c.left&&"Literal"===c.left.type?this.astGeneric(c,d):(d.push("int("),this.astGeneric(c,d),d.push(")")):this.astGeneric(c,d);else{if(l.valueType="Number",0===s||null===a)d.push("float ");else{if(p!==a)throw new Error("Unhandled declaration");d.push(",")}a=p,d.push("user_".concat(u.id.name,"=")),d.push("float("),this.astGeneric(c,d),d.push(")")}n.push(d.join(""))}return t.push(n.join("")),o||t.push(";"),t}},{key:"astIfStatement",value:function(e,t){return t.push("if ("),this.astGeneric(e.test,t),t.push(")"),"BlockStatement"===e.consequent.type?this.astGeneric(e.consequent,t):(t.push(" {\n"),this.astGeneric(e.consequent,t),t.push("\n}\n")),e.alternate&&(t.push("else "),"BlockStatement"===e.alternate.type||"IfStatement"===e.alternate.type?this.astGeneric(e.alternate,t):(t.push(" {\n"),this.astGeneric(e.alternate,t),t.push("\n}\n"))),t}},{key:"astSwitchStatement",value:function(e,t){if("SwitchStatement"!==e.type)throw this.astErrorOutput("Invalid switch statement",e);var r=e.discriminant,n=e.cases,i=this.getType(r),a="switchDiscriminant".concat(this.astKey(e,"_"));switch(i){case"Float":case"Number":t.push("float ".concat(a," = ")),this.astGeneric(r,t),t.push(";\n");break;case"Integer":t.push("int ".concat(a," = ")),this.astGeneric(r,t),t.push(";\n")}if(1===n.length&&!n[0].test)return this.astGeneric(n[0].consequent,t),t;for(var o=!1,s=[],u=!1,c=!1,l=0;l<n.length;l++){if(n[l].test){if(0!==l&&c?o?(t.push("".concat(a," == ")),o=!1):t.push(" else if (".concat(a," == ")):(c=!0,t.push("if (".concat(a," == "))),"Integer"===i)switch(this.getType(n[l].test)){case"Number":case"Float":this.castValueToInteger(n[l].test,t);break;case"LiteralInteger":this.castLiteralToInteger(n[l].test,t)}else{if("Float"!==i)throw new Error("unhanlded");switch(this.getType(n[l].test)){case"LiteralInteger":this.castLiteralToFloat(n[l].test,t);break;case"Integer":this.castValueToFloat(n[l].test,t)}}if(!n[l].consequent||0===n[l].consequent.length){o=!0,t.push(" || ");continue}t.push(") {\n")}else{if(n.length>l+1){u=!0,this.astGeneric(n[l].consequent,s);continue}t.push(" else {\n")}this.astGeneric(n[l].consequent,t),t.push("\n}")}return u&&(t.push(" else {"),t.push(s.join("")),t.push("}")),t}},{key:"astThisExpression",value:function(e,t){return t.push("this"),t}},{key:"astMemberExpression",value:function(e,t){var r=this.getMemberExpressionDetails(e),n=r.property,i=r.name,a=r.signature,o=r.origin,s=r.type,u=r.xProperty,c=r.yProperty,l=r.zProperty;switch(a){case"value.thread.value":case"this.thread.value":if("x"!==i&&"y"!==i&&"z"!==i)throw this.astErrorOutput("Unexpected expression, expected `this.thread.x`, `this.thread.y`, or `this.thread.z`",e);return t.push("threadId.".concat(i)),t;case"this.output.value":if(this.dynamicOutput)switch(i){case"x":this.isState("casting-to-float")?t.push("float(uOutputDim.x)"):t.push("uOutputDim.x");break;case"y":this.isState("casting-to-float")?t.push("float(uOutputDim.y)"):t.push("uOutputDim.y");break;case"z":this.isState("casting-to-float")?t.push("float(uOutputDim.z)"):t.push("uOutputDim.z");break;default:throw this.astErrorOutput("Unexpected expression",e)}else switch(i){case"x":this.isState("casting-to-integer")?t.push(this.output[0]):t.push(this.output[0],".0");break;case"y":this.isState("casting-to-integer")?t.push(this.output[1]):t.push(this.output[1],".0");break;case"z":this.isState("casting-to-integer")?t.push(this.output[2]):t.push(this.output[2],".0");break;default:throw this.astErrorOutput("Unexpected expression",e)}return t;case"value":throw this.astErrorOutput("Unexpected expression",e);case"value[]":case"value[][]":case"value[][][]":case"value[][][][]":case"value.value":if("Math"===o)return t.push(Math[i]),t;switch(n){case"r":return t.push("user_".concat(i,".r")),t;case"g":return t.push("user_".concat(i,".g")),t;case"b":return t.push("user_".concat(i,".b")),t;case"a":return t.push("user_".concat(i,".a")),t}break;case"this.constants.value":if(void 0===u)switch(s){case"Array(2)":case"Array(3)":case"Array(4)":return t.push("constants_".concat(i)),t}case"this.constants.value[]":case"this.constants.value[][]":case"this.constants.value[][][]":case"this.constants.value[][][][]":break;case"fn()[]":return this.astCallExpression(e.object,t),t.push("["),t.push(this.memberExpressionPropertyMarkup(n)),t.push("]"),t;case"[][]":return this.astArrayExpression(e.object,t),t.push("["),t.push(this.memberExpressionPropertyMarkup(n)),t.push("]"),t;case"value.value[]":case"value.value[][]":if(this.removeIstanbulCoverage)return t;default:throw this.astErrorOutput("Unexpected expression",e)}if(!1===e.computed)switch(s){case"Number":case"Integer":case"Float":case"Boolean":return t.push("".concat(o,"_").concat(i)),t}var h="".concat(o,"_").concat(i);switch(s){case"Array(2)":case"Array(3)":case"Array(4)":this.astGeneric(e.object,t),t.push("["),t.push(this.memberExpressionPropertyMarkup(u)),t.push("]");break;case"HTMLImageArray":t.push("getImage3D(".concat(h,", ").concat(h,"Size, ").concat(h,"Dim, ")),this.memberExpressionXYZ(u,c,l,t),t.push(")");break;case"ArrayTexture(1)":t.push("getFloatFromSampler2D(".concat(h,", ").concat(h,"Size, ").concat(h,"Dim, ")),this.memberExpressionXYZ(u,c,l,t),t.push(")");break;case"Array1D(2)":case"Array2D(2)":case"Array3D(2)":t.push("getMemoryOptimizedVec2(".concat(h,", ").concat(h,"Size, ").concat(h,"Dim, ")),this.memberExpressionXYZ(u,c,l,t),t.push(")");break;case"ArrayTexture(2)":t.push("getVec2FromSampler2D(".concat(h,", ").concat(h,"Size, ").concat(h,"Dim, ")),this.memberExpressionXYZ(u,c,l,t),t.push(")");break;case"Array1D(3)":case"Array2D(3)":case"Array3D(3)":t.push("getMemoryOptimizedVec3(".concat(h,", ").concat(h,"Size, ").concat(h,"Dim, ")),this.memberExpressionXYZ(u,c,l,t),t.push(")");break;case"ArrayTexture(3)":t.push("getVec3FromSampler2D(".concat(h,", ").concat(h,"Size, ").concat(h,"Dim, ")),this.memberExpressionXYZ(u,c,l,t),t.push(")");break;case"Array1D(4)":case"Array2D(4)":case"Array3D(4)":t.push("getMemoryOptimizedVec4(".concat(h,", ").concat(h,"Size, ").concat(h,"Dim, ")),this.memberExpressionXYZ(u,c,l,t),t.push(")");break;case"ArrayTexture(4)":case"HTMLImage":case"HTMLVideo":t.push("getVec4FromSampler2D(".concat(h,", ").concat(h,"Size, ").concat(h,"Dim, ")),this.memberExpressionXYZ(u,c,l,t),t.push(")");break;case"NumberTexture":case"Array":case"Array2D":case"Array3D":case"Array4D":case"Input":case"Number":case"Float":case"Integer":if("single"===this.precision)t.push("getMemoryOptimized32(".concat(h,", ").concat(h,"Size, ").concat(h,"Dim, ")),this.memberExpressionXYZ(u,c,l,t),t.push(")");else{var p="user"===o?this.lookupFunctionArgumentBitRatio(this.name,i):this.constantBitRatios[i];switch(p){case 1:t.push("get8(".concat(h,", ").concat(h,"Size, ").concat(h,"Dim, "));break;case 2:t.push("get16(".concat(h,", ").concat(h,"Size, ").concat(h,"Dim, "));break;case 4:case 0:t.push("get32(".concat(h,", ").concat(h,"Size, ").concat(h,"Dim, "));break;default:throw new Error("unhandled bit ratio of ".concat(p))}this.memberExpressionXYZ(u,c,l,t),t.push(")")}break;case"MemoryOptimizedNumberTexture":t.push("getMemoryOptimized32(".concat(h,", ").concat(h,"Size, ").concat(h,"Dim, ")),this.memberExpressionXYZ(u,c,l,t),t.push(")");break;default:throw new Error('unhandled member expression "'.concat(s,'"'))}return t}},{key:"astCallExpression",value:function(e,t){if(!e.callee)throw this.astErrorOutput("Unknown CallExpression",e);var r=null,n=this.isAstMathFunction(e);if(!(r=n||e.callee.object&&"ThisExpression"===e.callee.object.type?e.callee.property.name:"SequenceExpression"!==e.callee.type||"Literal"!==e.callee.expressions[0].type||isNaN(e.callee.expressions[0].raw)?e.callee.name:e.callee.expressions[1].property.name))throw this.astErrorOutput("Unhandled function, couldn't find name",e);if("atan2"===r&&(r="atan"),this.calledFunctions.indexOf(r)<0&&this.calledFunctions.push(r),"random"===r&&this.plugins&&this.plugins.length>0)for(var i=0;i<this.plugins.length;i++){var a=this.plugins[i];if("Math.random()"===a.functionMatch&&a.functionReplace)return t.push(a.functionReplace),t}if(this.onFunctionCall&&this.onFunctionCall(this.name,r,e.arguments),t.push(r),t.push("("),n)for(var o=0;o<e.arguments.length;++o){var s=e.arguments[o],u=this.getType(s);switch(o>0&&t.push(", "),u){case"Integer":this.castValueToFloat(s,t);break;default:this.astGeneric(s,t)}}else for(var c=this.lookupFunctionArgumentTypes(r)||[],l=0;l<e.arguments.length;++l){var h=e.arguments[l],p=c[l];l>0&&t.push(", ");var f=this.getType(h);switch(p||(this.triggerImplyArgumentType(r,l,f,this),p=f),f){case"Number":case"Float":if("Integer"===p){t.push("int("),this.astGeneric(h,t),t.push(")");continue}if("Number"===p||"Float"===p){this.astGeneric(h,t);continue}if("LiteralInteger"===p){this.castLiteralToFloat(h,t);continue}break;case"Integer":if("Number"===p||"Float"===p){t.push("float("),this.astGeneric(h,t),t.push(")");continue}if("Integer"===p){this.astGeneric(h,t);continue}break;case"LiteralInteger":if("Integer"===p){this.castLiteralToInteger(h,t);continue}if("Number"===p||"Float"===p){this.castLiteralToFloat(h,t);continue}if("LiteralInteger"===p){this.astGeneric(h,t);continue}break;case"Array(2)":case"Array(3)":case"Array(4)":if(p===f){if("Identifier"===h.type)t.push("user_".concat(h.name));else{if("ArrayExpression"!==h.type)throw this.astErrorOutput("Unhandled argument type ".concat(h.type),e);this.astGeneric(h,t)}continue}break;case"HTMLImage":case"HTMLImageArray":case"HTMLVideo":case"ArrayTexture(1)":case"ArrayTexture(2)":case"ArrayTexture(3)":case"ArrayTexture(4)":case"Array":case"Input":if(p===f){if("Identifier"!==h.type)throw this.astErrorOutput("Unhandled argument type ".concat(h.type),e);this.triggerImplyArgumentBitRatio(this.name,h.name,r,l),t.push("user_".concat(h.name,",user_").concat(h.name,"Size,user_").concat(h.name,"Dim"));continue}}throw this.astErrorOutput("Unhandled argument combination of ".concat(f," and ").concat(p,' for argument named "').concat(h.name,'"'),e)}return t.push(")"),t}},{key:"astArrayExpression",value:function(e,t){var r=e.elements.length;t.push("vec"+r+"(");for(var n=0;n<r;++n){n>0&&t.push(", ");var i=e.elements[n];this.astGeneric(i,t)}return t.push(")"),t}},{key:"memberExpressionXYZ",value:function(e,t,r,n){return r?n.push(this.memberExpressionPropertyMarkup(r),", "):n.push("0, "),t?n.push(this.memberExpressionPropertyMarkup(t),", "):n.push("0, "),n.push(this.memberExpressionPropertyMarkup(e)),n}},{key:"memberExpressionPropertyMarkup",value:function(e){if(!e)throw new Error("Property not set");var t=[];switch(this.getType(e)){case"Number":case"Float":this.castValueToInteger(e,t);break;case"LiteralInteger":this.castLiteralToInteger(e,t);break;default:this.astGeneric(e,t)}return t.join("")}}]),r}(e("../function-node").FunctionNode),i={Array:"sampler2D","Array(2)":"vec2","Array(3)":"vec3","Array(4)":"vec4",Array2D:"sampler2D",Array3D:"sampler2D",Boolean:"bool",Float:"float",Input:"sampler2D",Integer:"int",Number:"float",LiteralInteger:"float",NumberTexture:"sampler2D",MemoryOptimizedNumberTexture:"sampler2D","ArrayTexture(1)":"sampler2D","ArrayTexture(2)":"sampler2D","ArrayTexture(3)":"sampler2D","ArrayTexture(4)":"sampler2D",HTMLVideo:"sampler2D",HTMLImage:"sampler2D",HTMLImageArray:"sampler2DArray"},a={"===":"==","!==":"!="};t.exports={WebGLFunctionNode:n}},{"../function-node":10}],39:[function(e,t,r){var n=e("./kernel-value/boolean").WebGLKernelValueBoolean,i=e("./kernel-value/float").WebGLKernelValueFloat,a=e("./kernel-value/integer").WebGLKernelValueInteger,o=e("./kernel-value/html-image").WebGLKernelValueHTMLImage,s=e("./kernel-value/dynamic-html-image").WebGLKernelValueDynamicHTMLImage,u=e("./kernel-value/html-video").WebGLKernelValueHTMLVideo,c=e("./kernel-value/dynamic-html-video").WebGLKernelValueDynamicHTMLVideo,l=e("./kernel-value/single-input").WebGLKernelValueSingleInput,h=e("./kernel-value/dynamic-single-input").WebGLKernelValueDynamicSingleInput,p=e("./kernel-value/unsigned-input").WebGLKernelValueUnsignedInput,f=e("./kernel-value/dynamic-unsigned-input").WebGLKernelValueDynamicUnsignedInput,d=e("./kernel-value/memory-optimized-number-texture").WebGLKernelValueMemoryOptimizedNumberTexture,m=e("./kernel-value/dynamic-memory-optimized-number-texture").WebGLKernelValueDynamicMemoryOptimizedNumberTexture,y=e("./kernel-value/number-texture").WebGLKernelValueNumberTexture,g=e("./kernel-value/dynamic-number-texture").WebGLKernelValueDynamicNumberTexture,v=e("./kernel-value/single-array").WebGLKernelValueSingleArray,E=e("./kernel-value/dynamic-single-array").WebGLKernelValueDynamicSingleArray,T=e("./kernel-value/single-array1d-i").WebGLKernelValueSingleArray1DI,b=e("./kernel-value/dynamic-single-array1d-i").WebGLKernelValueDynamicSingleArray1DI,x=e("./kernel-value/single-array2d-i").WebGLKernelValueSingleArray2DI,A=e("./kernel-value/dynamic-single-array2d-i").WebGLKernelValueDynamicSingleArray2DI,S=e("./kernel-value/single-array3d-i").WebGLKernelValueSingleArray3DI,R=e("./kernel-value/dynamic-single-array3d-i").WebGLKernelValueDynamicSingleArray3DI,w=e("./kernel-value/single-array2").WebGLKernelValueSingleArray2,C=e("./kernel-value/single-array3").WebGLKernelValueSingleArray3,O=e("./kernel-value/single-array4").WebGLKernelValueSingleArray4,k=e("./kernel-value/unsigned-array").WebGLKernelValueUnsignedArray,N={unsigned:{dynamic:{Boolean:n,Integer:a,Float:i,Array:e("./kernel-value/dynamic-unsigned-array").WebGLKernelValueDynamicUnsignedArray,"Array(2)":!1,"Array(3)":!1,"Array(4)":!1,"Array1D(2)":!1,"Array1D(3)":!1,"Array1D(4)":!1,"Array2D(2)":!1,"Array2D(3)":!1,"Array2D(4)":!1,"Array3D(2)":!1,"Array3D(3)":!1,"Array3D(4)":!1,Input:f,NumberTexture:g,"ArrayTexture(1)":g,"ArrayTexture(2)":g,"ArrayTexture(3)":g,"ArrayTexture(4)":g,MemoryOptimizedNumberTexture:m,HTMLImage:s,HTMLImageArray:!1,HTMLVideo:c},static:{Boolean:n,Float:i,Integer:a,Array:k,"Array(2)":!1,"Array(3)":!1,"Array(4)":!1,"Array1D(2)":!1,"Array1D(3)":!1,"Array1D(4)":!1,"Array2D(2)":!1,"Array2D(3)":!1,"Array2D(4)":!1,"Array3D(2)":!1,"Array3D(3)":!1,"Array3D(4)":!1,Input:p,NumberTexture:y,"ArrayTexture(1)":y,"ArrayTexture(2)":y,"ArrayTexture(3)":y,"ArrayTexture(4)":y,MemoryOptimizedNumberTexture:d,HTMLImage:o,HTMLImageArray:!1,HTMLVideo:u}},single:{dynamic:{Boolean:n,Integer:a,Float:i,Array:E,"Array(2)":w,"Array(3)":C,"Array(4)":O,"Array1D(2)":b,"Array1D(3)":b,"Array1D(4)":b,"Array2D(2)":A,"Array2D(3)":A,"Array2D(4)":A,"Array3D(2)":R,"Array3D(3)":R,"Array3D(4)":R,Input:h,NumberTexture:g,"ArrayTexture(1)":g,"ArrayTexture(2)":g,"ArrayTexture(3)":g,"ArrayTexture(4)":g,MemoryOptimizedNumberTexture:m,HTMLImage:s,HTMLImageArray:!1,HTMLVideo:c},static:{Boolean:n,Float:i,Integer:a,Array:v,"Array(2)":w,"Array(3)":C,"Array(4)":O,"Array1D(2)":T,"Array1D(3)":T,"Array1D(4)":T,"Array2D(2)":x,"Array2D(3)":x,"Array2D(4)":x,"Array3D(2)":S,"Array3D(3)":S,"Array3D(4)":S,Input:l,NumberTexture:y,"ArrayTexture(1)":y,"ArrayTexture(2)":y,"ArrayTexture(3)":y,"ArrayTexture(4)":y,MemoryOptimizedNumberTexture:d,HTMLImage:o,HTMLImageArray:!1,HTMLVideo:u}}};t.exports={lookupKernelValueType:function(e,t,r,n){if(!e)throw new Error("type missing");if(!t)throw new Error("dynamic missing");if(!r)throw new Error("precision missing");n.type&&(e=n.type);var i=N[r][t];if(!1===i[e])return null;if(void 0===i[e])throw new Error("Could not find a KernelValue for ".concat(e));return i[e]},kernelValueMaps:N}},{"./kernel-value/boolean":40,"./kernel-value/dynamic-html-image":41,"./kernel-value/dynamic-html-video":42,"./kernel-value/dynamic-memory-optimized-number-texture":43,"./kernel-value/dynamic-number-texture":44,"./kernel-value/dynamic-single-array":45,"./kernel-value/dynamic-single-array1d-i":46,"./kernel-value/dynamic-single-array2d-i":47,"./kernel-value/dynamic-single-array3d-i":48,"./kernel-value/dynamic-single-input":49,"./kernel-value/dynamic-unsigned-array":50,"./kernel-value/dynamic-unsigned-input":51,"./kernel-value/float":52,"./kernel-value/html-image":53,"./kernel-value/html-video":54,"./kernel-value/integer":56,"./kernel-value/memory-optimized-number-texture":57,"./kernel-value/number-texture":58,"./kernel-value/single-array":59,"./kernel-value/single-array1d-i":60,"./kernel-value/single-array2":61,"./kernel-value/single-array2d-i":62,"./kernel-value/single-array3":63,"./kernel-value/single-array3d-i":64,"./kernel-value/single-array4":65,"./kernel-value/single-input":66,"./kernel-value/unsigned-array":67,"./kernel-value/unsigned-input":68}],40:[function(e,t,r){e("../../../utils").utils;var n=function(e){"use strict";h(r,e);var t=p(r);function r(e,n){var i;return c(this,r),(i=t.call(this,e,n)).uploadValue=e,i}return l(r,[{key:"getSource",value:function(e){return"constants"===this.origin?"const bool ".concat(this.id," = ").concat(e,";\n"):"uniform bool ".concat(this.id,";\n")}},{key:"getStringValueHandler",value:function(){return"const uploadValue_".concat(this.name," = ").concat(this.varName,";\n")}},{key:"updateValue",value:function(e){"constants"!==this.origin&&this.kernel.setUniform1i(this.id,this.uploadValue=e)}}]),r}(e("./index").WebGLKernelValue);t.exports={WebGLKernelValueBoolean:n}},{"../../../utils":113,"./index":55}],41:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){return n.linesToString(["uniform sampler2D ".concat(this.id),"uniform ivec2 ".concat(this.sizeId),"uniform ivec3 ".concat(this.dimensionsId)])}},{key:"updateValue",value:function(e){var t=e.width,n=e.height;this.checkSize(t,n),this.dimensions=[t,n,1],this.textureSize=[t,n],this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),s(u(r.prototype),"updateValue",this).call(this,e)}}]),r}(e("./html-image").WebGLKernelValueHTMLImage);t.exports={WebGLKernelValueDynamicHTMLImage:i}},{"../../../utils":113,"./html-image":53}],42:[function(e,t,r){var n=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return r}(e("./dynamic-html-image").WebGLKernelValueDynamicHTMLImage);t.exports={WebGLKernelValueDynamicHTMLVideo:n}},{"./dynamic-html-image":41}],43:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){return n.linesToString(["uniform sampler2D ".concat(this.id),"uniform ivec2 ".concat(this.sizeId),"uniform ivec3 ".concat(this.dimensionsId)])}},{key:"updateValue",value:function(e){this.checkSize(e.size[0],e.size[1]),this.dimensions=e.dimensions,this.textureSize=e.size,this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),s(u(r.prototype),"updateValue",this).call(this,e)}}]),r}(e("./memory-optimized-number-texture").WebGLKernelValueMemoryOptimizedNumberTexture);t.exports={WebGLKernelValueDynamicMemoryOptimizedNumberTexture:i}},{"../../../utils":113,"./memory-optimized-number-texture":57}],44:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){return n.linesToString(["uniform sampler2D ".concat(this.id),"uniform ivec2 ".concat(this.sizeId),"uniform ivec3 ".concat(this.dimensionsId)])}},{key:"updateValue",value:function(e){this.dimensions=e.dimensions,this.checkSize(e.size[0],e.size[1]),this.textureSize=e.size,this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),s(u(r.prototype),"updateValue",this).call(this,e)}}]),r}(e("./number-texture").WebGLKernelValueNumberTexture);t.exports={WebGLKernelValueDynamicNumberTexture:i}},{"../../../utils":113,"./number-texture":58}],45:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){return n.linesToString(["uniform sampler2D ".concat(this.id),"uniform ivec2 ".concat(this.sizeId),"uniform ivec3 ".concat(this.dimensionsId)])}},{key:"updateValue",value:function(e){this.dimensions=n.getDimensions(e,!0),this.textureSize=n.getMemoryOptimizedFloatTextureSize(this.dimensions,this.bitRatio),this.uploadArrayLength=this.textureSize[0]*this.textureSize[1]*this.bitRatio,this.checkSize(this.textureSize[0]*this.bitRatio,this.textureSize[1]*this.bitRatio),this.uploadValue=new Float32Array(this.uploadArrayLength),this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),s(u(r.prototype),"updateValue",this).call(this,e)}}]),r}(e("./single-array").WebGLKernelValueSingleArray);t.exports={WebGLKernelValueDynamicSingleArray:i}},{"../../../utils":113,"./single-array":59}],46:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){return n.linesToString(["uniform sampler2D ".concat(this.id),"uniform ivec2 ".concat(this.sizeId),"uniform ivec3 ".concat(this.dimensionsId)])}},{key:"updateValue",value:function(e){this.setShape(e),this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),s(u(r.prototype),"updateValue",this).call(this,e)}}]),r}(e("./single-array1d-i").WebGLKernelValueSingleArray1DI);t.exports={WebGLKernelValueDynamicSingleArray1DI:i}},{"../../../utils":113,"./single-array1d-i":60}],47:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){return n.linesToString(["uniform sampler2D ".concat(this.id),"uniform ivec2 ".concat(this.sizeId),"uniform ivec3 ".concat(this.dimensionsId)])}},{key:"updateValue",value:function(e){this.setShape(e),this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),s(u(r.prototype),"updateValue",this).call(this,e)}}]),r}(e("./single-array2d-i").WebGLKernelValueSingleArray2DI);t.exports={WebGLKernelValueDynamicSingleArray2DI:i}},{"../../../utils":113,"./single-array2d-i":62}],48:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){return n.linesToString(["uniform sampler2D ".concat(this.id),"uniform ivec2 ".concat(this.sizeId),"uniform ivec3 ".concat(this.dimensionsId)])}},{key:"updateValue",value:function(e){this.setShape(e),this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),s(u(r.prototype),"updateValue",this).call(this,e)}}]),r}(e("./single-array3d-i").WebGLKernelValueSingleArray3DI);t.exports={WebGLKernelValueDynamicSingleArray3DI:i}},{"../../../utils":113,"./single-array3d-i":64}],49:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){return n.linesToString(["uniform sampler2D ".concat(this.id),"uniform ivec2 ".concat(this.sizeId),"uniform ivec3 ".concat(this.dimensionsId)])}},{key:"updateValue",value:function(e){var t=f(e.size,3),i=t[0],a=t[1],o=t[2];this.dimensions=new Int32Array([i||1,a||1,o||1]),this.textureSize=n.getMemoryOptimizedFloatTextureSize(this.dimensions,this.bitRatio),this.uploadArrayLength=this.textureSize[0]*this.textureSize[1]*this.bitRatio,this.checkSize(this.textureSize[0]*this.bitRatio,this.textureSize[1]*this.bitRatio),this.uploadValue=new Float32Array(this.uploadArrayLength),this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),s(u(r.prototype),"updateValue",this).call(this,e)}}]),r}(e("./single-input").WebGLKernelValueSingleInput);t.exports={WebGLKernelValueDynamicSingleInput:i}},{"../../../utils":113,"./single-input":66}],50:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){return n.linesToString(["uniform sampler2D ".concat(this.id),"uniform ivec2 ".concat(this.sizeId),"uniform ivec3 ".concat(this.dimensionsId)])}},{key:"updateValue",value:function(e){this.dimensions=n.getDimensions(e,!0),this.textureSize=n.getMemoryOptimizedPackedTextureSize(this.dimensions,this.bitRatio),this.uploadArrayLength=this.textureSize[0]*this.textureSize[1]*(4/this.bitRatio),this.checkSize(this.textureSize[0]*(4/this.bitRatio),this.textureSize[1]*(4/this.bitRatio));var t=this.getTransferArrayType(e);this.preUploadValue=new t(this.uploadArrayLength),this.uploadValue=new Uint8Array(this.preUploadValue.buffer),this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),s(u(r.prototype),"updateValue",this).call(this,e)}}]),r}(e("./unsigned-array").WebGLKernelValueUnsignedArray);t.exports={WebGLKernelValueDynamicUnsignedArray:i}},{"../../../utils":113,"./unsigned-array":67}],51:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){return n.linesToString(["uniform sampler2D ".concat(this.id),"uniform ivec2 ".concat(this.sizeId),"uniform ivec3 ".concat(this.dimensionsId)])}},{key:"updateValue",value:function(e){var t=f(e.size,3),i=t[0],a=t[1],o=t[2];this.dimensions=new Int32Array([i||1,a||1,o||1]),this.textureSize=n.getMemoryOptimizedPackedTextureSize(this.dimensions,this.bitRatio),this.uploadArrayLength=this.textureSize[0]*this.textureSize[1]*(4/this.bitRatio),this.checkSize(this.textureSize[0]*(4/this.bitRatio),this.textureSize[1]*(4/this.bitRatio));var c=this.getTransferArrayType(e.value);this.preUploadValue=new c(this.uploadArrayLength),this.uploadValue=new Uint8Array(this.preUploadValue.buffer),this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),s(u(r.prototype),"updateValue",this).call(this,e)}}]),r}(e("./unsigned-input").WebGLKernelValueUnsignedInput);t.exports={WebGLKernelValueDynamicUnsignedInput:i}},{"../../../utils":113,"./unsigned-input":68}],52:[function(e,t,r){e("../../../utils").utils;var n=function(e){"use strict";h(r,e);var t=p(r);function r(e,n){var i;return c(this,r),(i=t.call(this,e,n)).uploadValue=e,i}return l(r,[{key:"getStringValueHandler",value:function(){return"const uploadValue_".concat(this.name," = ").concat(this.varName,";\n")}},{key:"getSource",value:function(e){return"constants"===this.origin?Number.isInteger(e)?"const float ".concat(this.id," = ").concat(e,".0;\n"):"const float ".concat(this.id," = ").concat(e,";\n"):"uniform float ".concat(this.id,";\n")}},{key:"updateValue",value:function(e){"constants"!==this.origin&&this.kernel.setUniform1f(this.id,this.uploadValue=e)}}]),r}(e("./index").WebGLKernelValue);t.exports={WebGLKernelValueFloat:n}},{"../../../utils":113,"./index":55}],53:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e,n){var i;c(this,r),i=t.call(this,e,n);var a=e.width,o=e.height;return i.checkSize(a,o),i.dimensions=[a,o,1],i.requestTexture(),i.textureSize=[a,o],i.uploadValue=e,i}return l(r,[{key:"getStringValueHandler",value:function(){return"const uploadValue_".concat(this.name," = ").concat(this.varName,";\n")}},{key:"getSource",value:function(){return n.linesToString(["uniform sampler2D ".concat(this.id),"ivec2 ".concat(this.sizeId," = ivec2(").concat(this.textureSize[0],", ").concat(this.textureSize[1],")"),"ivec3 ".concat(this.dimensionsId," = ivec3(").concat(this.dimensions[0],", ").concat(this.dimensions[1],", ").concat(this.dimensions[2],")")])}},{key:"updateValue",value:function(e){if(e.constructor===this.initialValueConstructor){var t=this.context;t.activeTexture(this.contextHandle),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.uploadValue=e),this.kernel.setUniform1i(this.id,this.index)}else this.onUpdateValueMismatch(e.constructor)}}]),r}(e("./index").WebGLKernelValue);t.exports={WebGLKernelValueHTMLImage:i}},{"../../../utils":113,"./index":55}],54:[function(e,t,r){var n=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return r}(e("./html-image").WebGLKernelValueHTMLImage);t.exports={WebGLKernelValueHTMLVideo:n}},{"./html-image":53}],55:[function(e,t,r){var n=e("../../../utils").utils,i=e("../../../input").Input,a=function(e){"use strict";h(r,e);var t=p(r);function r(e,n){var i;return c(this,r),(i=t.call(this,e,n)).dimensionsId=null,i.sizeId=null,i.initialValueConstructor=e.constructor,i.onRequestTexture=n.onRequestTexture,i.onRequestIndex=n.onRequestIndex,i.uploadValue=null,i.textureSize=null,i.bitRatio=null,i}return l(r,[{key:"checkSize",value:function(e,t){if(this.kernel.validate){var r=this.kernel.constructor.features.maxTextureSize;if(e>r||t>r)throw e>t?new Error("Argument width of ".concat(e," larger than maximum size of ").concat(r," for your GPU")):new Error("Argument height of ".concat(t," larger than maximum size of ").concat(r," for your GPU"))}}},{key:"requestTexture",value:function(){this.texture=this.onRequestTexture(),this.setupTexture()}},{key:"setupTexture",value:function(){this.contextHandle=this.onRequestContextHandle(),this.index=this.onRequestIndex(),this.dimensionsId=this.id+"Dim",this.sizeId=this.id+"Size"}},{key:"getTransferArrayType",value:function(e){if(Array.isArray(e[0]))return this.getTransferArrayType(e[0]);switch(e.constructor){case Array:case Int32Array:case Int16Array:case Int8Array:return Float32Array;case Uint8ClampedArray:case Uint8Array:case Uint16Array:case Uint32Array:case Float32Array:case Float64Array:return e.constructor}return console.warn("Unfamiliar constructor type.  Will go ahead and use, but likley this may result in a transfer of zeros"),e.constructor}},{key:"formatArrayTransfer",value:function(e,t,r){if(n.isArray(e[0])||this.optimizeFloatMemory){var i=new Float32Array(t);return n.flattenTo(e,i),i}switch(e.constructor){case Uint8ClampedArray:case Uint8Array:case Int8Array:case Uint16Array:case Int16Array:case Float32Array:case Int32Array:var a=new(r||e.constructor)(t);return n.flattenTo(e,a),a;default:var o=new Float32Array(t);return n.flattenTo(e,o),o}}},{key:"getBitRatio",value:function(e){if(Array.isArray(e[0]))return this.getBitRatio(e[0]);if(e.constructor===i)return this.getBitRatio(e.value);switch(e.constructor){case Uint8ClampedArray:case Uint8Array:case Int8Array:return 1;case Uint16Array:case Int16Array:return 2;case Float32Array:case Int32Array:default:return 4}}},{key:"getStringValueHandler",value:function(){throw new Error('"getStringValueHandler" not implemented on '.concat(this.constructor.name))}},{key:"getVariablePrecisionString",value:function(){return this.kernel.getVariablePrecisionString(this.textureSize||void 0,this.tactic||void 0)}}]),r}(e("../../kernel-value").KernelValue);t.exports={WebGLKernelValue:a}},{"../../../input":109,"../../../utils":113,"../../kernel-value":35}],56:[function(e,t,r){e("../../../utils").utils;var n=function(e){"use strict";h(r,e);var t=p(r);function r(e,n){var i;return c(this,r),(i=t.call(this,e,n)).uploadValue=e,i}return l(r,[{key:"getStringValueHandler",value:function(){return"const uploadValue_".concat(this.name," = ").concat(this.varName,";\n")}},{key:"getSource",value:function(e){return"constants"===this.origin?"const int ".concat(this.id," = ").concat(parseInt(e),";\n"):"uniform int ".concat(this.id,";\n")}},{key:"updateValue",value:function(e){"constants"!==this.origin&&this.kernel.setUniform1i(this.id,this.uploadValue=e)}}]),r}(e("./index").WebGLKernelValue);t.exports={WebGLKernelValueInteger:n}},{"../../../utils":113,"./index":55}],57:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e,n){var i;c(this,r),i=t.call(this,e,n);var a=f(e.size,2),o=a[0],s=a[1];return i.checkSize(o,s),i.setupTexture(),i.dimensions=e.dimensions,i.textureSize=e.size,i.uploadValue=e.texture,i.forceUploadEachRun=!0,i}return l(r,[{key:"getStringValueHandler",value:function(){return"const uploadValue_".concat(this.name," = ").concat(this.varName,".texture;\n")}},{key:"getSource",value:function(){return n.linesToString(["uniform sampler2D ".concat(this.id),"ivec2 ".concat(this.sizeId," = ivec2(").concat(this.textureSize[0],", ").concat(this.textureSize[1],")"),"ivec3 ".concat(this.dimensionsId," = ivec3(").concat(this.dimensions[0],", ").concat(this.dimensions[1],", ").concat(this.dimensions[2],")")])}},{key:"updateValue",value:function(e){if(e.constructor===this.initialValueConstructor){if(this.checkContext&&e.context!==this.context)throw new Error("Value ".concat(this.name," (").concat(this.type,") must be from same context"));var t=this.context;e.texture===this.kernel.outputTexture&&(e=e.clone(),t.useProgram(this.kernel.program),this.kernel.textureGarbage.push(e)),t.activeTexture(this.contextHandle),t.bindTexture(t.TEXTURE_2D,this.uploadValue=e.texture),this.kernel.setUniform1i(this.id,this.index)}else this.onUpdateValueMismatch(e.constructor)}}]),r}(e("./index").WebGLKernelValue);t.exports={WebGLKernelValueMemoryOptimizedNumberTexture:i}},{"../../../utils":113,"./index":55}],58:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e,n){var i;c(this,r),i=t.call(this,e,n);var a=f(e.size,2),o=a[0],s=a[1];i.checkSize(o,s),i.setupTexture();var u=e.size,l=e.dimensions;return i.bitRatio=i.getBitRatio(e),i.dimensions=l,i.textureSize=u,i.uploadValue=e.texture,i.forceUploadEachRun=!0,i}return l(r,[{key:"getStringValueHandler",value:function(){return"const uploadValue_".concat(this.name," = ").concat(this.varName,".texture;\n")}},{key:"getSource",value:function(){return n.linesToString(["uniform sampler2D ".concat(this.id),"ivec2 ".concat(this.sizeId," = ivec2(").concat(this.textureSize[0],", ").concat(this.textureSize[1],")"),"ivec3 ".concat(this.dimensionsId," = ivec3(").concat(this.dimensions[0],", ").concat(this.dimensions[1],", ").concat(this.dimensions[2],")")])}},{key:"updateValue",value:function(e){if(e.constructor===this.initialValueConstructor){if(this.checkContext&&e.context!==this.context)throw new Error("Value ".concat(this.name," (").concat(this.type,") must be from same context"));var t=this.context;e.texture===this.kernel.outputTexture&&(e=e.clone(),t.useProgram(this.kernel.program),this.kernel.textureGarbage.push(e)),t.activeTexture(this.contextHandle),t.bindTexture(t.TEXTURE_2D,this.uploadValue=e.texture),this.kernel.setUniform1i(this.id,this.index)}else this.onUpdateValueMismatch(e.constructor)}}]),r}(e("./index").WebGLKernelValue);t.exports={WebGLKernelValueNumberTexture:i}},{"../../../utils":113,"./index":55}],59:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e,i){var a;return c(this,r),(a=t.call(this,e,i)).requestTexture(),a.bitRatio=4,a.dimensions=n.getDimensions(e,!0),a.textureSize=n.getMemoryOptimizedFloatTextureSize(a.dimensions,a.bitRatio),a.uploadArrayLength=a.textureSize[0]*a.textureSize[1]*a.bitRatio,a.checkSize(a.textureSize[0]*a.bitRatio,a.textureSize[1]*a.bitRatio),a.uploadValue=new Float32Array(a.uploadArrayLength),a}return l(r,[{key:"getStringValueHandler",value:function(){return n.linesToString(["const uploadValue_".concat(this.name," = new Float32Array(").concat(this.uploadArrayLength,")"),"flattenTo(".concat(this.varName,", uploadValue_").concat(this.name,")")])}},{key:"getSource",value:function(){return n.linesToString(["uniform sampler2D ".concat(this.id),"ivec2 ".concat(this.sizeId," = ivec2(").concat(this.textureSize[0],", ").concat(this.textureSize[1],")"),"ivec3 ".concat(this.dimensionsId," = ivec3(").concat(this.dimensions[0],", ").concat(this.dimensions[1],", ").concat(this.dimensions[2],")")])}},{key:"updateValue",value:function(e){if(e.constructor===this.initialValueConstructor){var t=this.context;n.flattenTo(e,this.uploadValue),t.activeTexture(this.contextHandle),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.textureSize[0],this.textureSize[1],0,t.RGBA,t.FLOAT,this.uploadValue),this.kernel.setUniform1i(this.id,this.index)}else this.onUpdateValueMismatch()}}]),r}(e("./index").WebGLKernelValue);t.exports={WebGLKernelValueSingleArray:i}},{"../../../utils":113,"./index":55}],60:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e,n){var i;return c(this,r),(i=t.call(this,e,n)).requestTexture(),i.bitRatio=4,i.setShape(e),i}return l(r,[{key:"setShape",value:function(e){var t=n.getDimensions(e,!0);this.textureSize=n.getMemoryOptimizedFloatTextureSize(t,this.bitRatio),this.dimensions=new Int32Array([t[1],1,1]),this.uploadArrayLength=this.textureSize[0]*this.textureSize[1]*this.bitRatio,this.checkSize(this.textureSize[0]*this.bitRatio,this.textureSize[1]*this.bitRatio),this.uploadValue=new Float32Array(this.uploadArrayLength)}},{key:"getStringValueHandler",value:function(){return n.linesToString(["const uploadValue_".concat(this.name," = new Float32Array(").concat(this.uploadArrayLength,")"),"flattenTo(".concat(this.varName,", uploadValue_").concat(this.name,")")])}},{key:"getSource",value:function(){return n.linesToString(["uniform sampler2D ".concat(this.id),"ivec2 ".concat(this.sizeId," = ivec2(").concat(this.textureSize[0],", ").concat(this.textureSize[1],")"),"ivec3 ".concat(this.dimensionsId," = ivec3(").concat(this.dimensions[0],", ").concat(this.dimensions[1],", ").concat(this.dimensions[2],")")])}},{key:"updateValue",value:function(e){if(e.constructor===this.initialValueConstructor){var t=this.context;n.flatten2dArrayTo(e,this.uploadValue),t.activeTexture(this.contextHandle),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.textureSize[0],this.textureSize[1],0,t.RGBA,t.FLOAT,this.uploadValue),this.kernel.setUniform1i(this.id,this.index)}else this.onUpdateValueMismatch(e.constructor)}}]),r}(e("./index").WebGLKernelValue);t.exports={WebGLKernelValueSingleArray1DI:i}},{"../../../utils":113,"./index":55}],61:[function(e,t,r){e("../../../utils").utils;var n=function(e){"use strict";h(r,e);var t=p(r);function r(e,n){var i;return c(this,r),(i=t.call(this,e,n)).uploadValue=e,i}return l(r,[{key:"getSource",value:function(e){return"constants"===this.origin?"const vec2 ".concat(this.id," = vec2(").concat(e[0],",").concat(e[1],");\n"):"uniform vec2 ".concat(this.id,";\n")}},{key:"getStringValueHandler",value:function(){return"constants"===this.origin?"":"const uploadValue_".concat(this.name," = ").concat(this.varName,";\n")}},{key:"updateValue",value:function(e){"constants"!==this.origin&&this.kernel.setUniform2fv(this.id,this.uploadValue=e)}}]),r}(e("./index").WebGLKernelValue);t.exports={WebGLKernelValueSingleArray2:n}},{"../../../utils":113,"./index":55}],62:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e,n){var i;return c(this,r),(i=t.call(this,e,n)).requestTexture(),i.bitRatio=4,i.setShape(e),i}return l(r,[{key:"setShape",value:function(e){var t=n.getDimensions(e,!0);this.textureSize=n.getMemoryOptimizedFloatTextureSize(t,this.bitRatio),this.dimensions=new Int32Array([t[1],t[2],1]),this.uploadArrayLength=this.textureSize[0]*this.textureSize[1]*this.bitRatio,this.checkSize(this.textureSize[0]*this.bitRatio,this.textureSize[1]*this.bitRatio),this.uploadValue=new Float32Array(this.uploadArrayLength)}},{key:"getStringValueHandler",value:function(){return n.linesToString(["const uploadValue_".concat(this.name," = new Float32Array(").concat(this.uploadArrayLength,")"),"flattenTo(".concat(this.varName,", uploadValue_").concat(this.name,")")])}},{key:"getSource",value:function(){return n.linesToString(["uniform sampler2D ".concat(this.id),"ivec2 ".concat(this.sizeId," = ivec2(").concat(this.textureSize[0],", ").concat(this.textureSize[1],")"),"ivec3 ".concat(this.dimensionsId," = ivec3(").concat(this.dimensions[0],", ").concat(this.dimensions[1],", ").concat(this.dimensions[2],")")])}},{key:"updateValue",value:function(e){if(e.constructor===this.initialValueConstructor){var t=this.context;n.flatten3dArrayTo(e,this.uploadValue),t.activeTexture(this.contextHandle),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.textureSize[0],this.textureSize[1],0,t.RGBA,t.FLOAT,this.uploadValue),this.kernel.setUniform1i(this.id,this.index)}else this.onUpdateValueMismatch(e.constructor)}}]),r}(e("./index").WebGLKernelValue);t.exports={WebGLKernelValueSingleArray2DI:i}},{"../../../utils":113,"./index":55}],63:[function(e,t,r){e("../../../utils").utils;var n=function(e){"use strict";h(r,e);var t=p(r);function r(e,n){var i;return c(this,r),(i=t.call(this,e,n)).uploadValue=e,i}return l(r,[{key:"getSource",value:function(e){return"constants"===this.origin?"const vec3 ".concat(this.id," = vec3(").concat(e[0],",").concat(e[1],",").concat(e[2],");\n"):"uniform vec3 ".concat(this.id,";\n")}},{key:"getStringValueHandler",value:function(){return"constants"===this.origin?"":"const uploadValue_".concat(this.name," = ").concat(this.varName,";\n")}},{key:"updateValue",value:function(e){"constants"!==this.origin&&this.kernel.setUniform3fv(this.id,this.uploadValue=e)}}]),r}(e("./index").WebGLKernelValue);t.exports={WebGLKernelValueSingleArray3:n}},{"../../../utils":113,"./index":55}],64:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e,n){var i;return c(this,r),(i=t.call(this,e,n)).requestTexture(),i.bitRatio=4,i.setShape(e),i}return l(r,[{key:"setShape",value:function(e){var t=n.getDimensions(e,!0);this.textureSize=n.getMemoryOptimizedFloatTextureSize(t,this.bitRatio),this.dimensions=new Int32Array([t[1],t[2],t[3]]),this.uploadArrayLength=this.textureSize[0]*this.textureSize[1]*this.bitRatio,this.checkSize(this.textureSize[0]*this.bitRatio,this.textureSize[1]*this.bitRatio),this.uploadValue=new Float32Array(this.uploadArrayLength)}},{key:"getStringValueHandler",value:function(){return n.linesToString(["const uploadValue_".concat(this.name," = new Float32Array(").concat(this.uploadArrayLength,")"),"flattenTo(".concat(this.varName,", uploadValue_").concat(this.name,")")])}},{key:"getSource",value:function(){return n.linesToString(["uniform sampler2D ".concat(this.id),"ivec2 ".concat(this.sizeId," = ivec2(").concat(this.textureSize[0],", ").concat(this.textureSize[1],")"),"ivec3 ".concat(this.dimensionsId," = ivec3(").concat(this.dimensions[0],", ").concat(this.dimensions[1],", ").concat(this.dimensions[2],")")])}},{key:"updateValue",value:function(e){if(e.constructor===this.initialValueConstructor){var t=this.context;n.flatten4dArrayTo(e,this.uploadValue),t.activeTexture(this.contextHandle),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.textureSize[0],this.textureSize[1],0,t.RGBA,t.FLOAT,this.uploadValue),this.kernel.setUniform1i(this.id,this.index)}else this.onUpdateValueMismatch()}}]),r}(e("./index").WebGLKernelValue);t.exports={WebGLKernelValueSingleArray3DI:i}},{"../../../utils":113,"./index":55}],65:[function(e,t,r){e("../../../utils").utils;var n=function(e){"use strict";h(r,e);var t=p(r);function r(e,n){var i;return c(this,r),(i=t.call(this,e,n)).uploadValue=e,i}return l(r,[{key:"getSource",value:function(e){return"constants"===this.origin?"const vec4 ".concat(this.id," = vec4(").concat(e[0],",").concat(e[1],",").concat(e[2],",").concat(e[3],");\n"):"uniform vec4 ".concat(this.id,";\n")}},{key:"getStringValueHandler",value:function(){return"constants"===this.origin?"":"const uploadValue_".concat(this.name," = ").concat(this.varName,";\n")}},{key:"updateValue",value:function(e){"constants"!==this.origin&&this.kernel.setUniform4fv(this.id,this.uploadValue=e)}}]),r}(e("./index").WebGLKernelValue);t.exports={WebGLKernelValueSingleArray4:n}},{"../../../utils":113,"./index":55}],66:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e,i){var a;c(this,r),(a=t.call(this,e,i)).requestTexture(),a.bitRatio=4;var o=f(e.size,3),s=o[0],u=o[1],l=o[2];return a.dimensions=new Int32Array([s||1,u||1,l||1]),a.textureSize=n.getMemoryOptimizedFloatTextureSize(a.dimensions,a.bitRatio),a.uploadArrayLength=a.textureSize[0]*a.textureSize[1]*a.bitRatio,a.checkSize(a.textureSize[0]*a.bitRatio,a.textureSize[1]*a.bitRatio),a.uploadValue=new Float32Array(a.uploadArrayLength),a}return l(r,[{key:"getStringValueHandler",value:function(){return n.linesToString(["const uploadValue_".concat(this.name," = new Float32Array(").concat(this.uploadArrayLength,")"),"flattenTo(".concat(this.varName,".value, uploadValue_").concat(this.name,")")])}},{key:"getSource",value:function(){return n.linesToString(["uniform sampler2D ".concat(this.id),"ivec2 ".concat(this.sizeId," = ivec2(").concat(this.textureSize[0],", ").concat(this.textureSize[1],")"),"ivec3 ".concat(this.dimensionsId," = ivec3(").concat(this.dimensions[0],", ").concat(this.dimensions[1],", ").concat(this.dimensions[2],")")])}},{key:"updateValue",value:function(e){if(e.constructor===this.initialValueConstructor){var t=this.context;n.flattenTo(e.value,this.uploadValue),t.activeTexture(this.contextHandle),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.textureSize[0],this.textureSize[1],0,t.RGBA,t.FLOAT,this.uploadValue),this.kernel.setUniform1i(this.id,this.index)}else this.onUpdateValueMismatch()}}]),r}(e("./index").WebGLKernelValue);t.exports={WebGLKernelValueSingleInput:i}},{"../../../utils":113,"./index":55}],67:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e,i){var a;return c(this,r),(a=t.call(this,e,i)).requestTexture(),a.bitRatio=a.getBitRatio(e),a.dimensions=n.getDimensions(e,!0),a.textureSize=n.getMemoryOptimizedPackedTextureSize(a.dimensions,a.bitRatio),a.uploadArrayLength=a.textureSize[0]*a.textureSize[1]*(4/a.bitRatio),a.checkSize(a.textureSize[0]*(4/a.bitRatio),a.textureSize[1]*(4/a.bitRatio)),a.TranserArrayType=a.getTransferArrayType(e),a.preUploadValue=new a.TranserArrayType(a.uploadArrayLength),a.uploadValue=new Uint8Array(a.preUploadValue.buffer),a}return l(r,[{key:"getStringValueHandler",value:function(){return n.linesToString(["const preUploadValue_".concat(this.name," = new ").concat(this.TranserArrayType.name,"(").concat(this.uploadArrayLength,")"),"const uploadValue_".concat(this.name," = new Uint8Array(preUploadValue_").concat(this.name,".buffer)"),"flattenTo(".concat(this.varName,", preUploadValue_").concat(this.name,")")])}},{key:"getSource",value:function(){return n.linesToString(["uniform sampler2D ".concat(this.id),"ivec2 ".concat(this.sizeId," = ivec2(").concat(this.textureSize[0],", ").concat(this.textureSize[1],")"),"ivec3 ".concat(this.dimensionsId," = ivec3(").concat(this.dimensions[0],", ").concat(this.dimensions[1],", ").concat(this.dimensions[2],")")])}},{key:"updateValue",value:function(e){if(e.constructor===this.initialValueConstructor){var t=this.context;n.flattenTo(e,this.preUploadValue),t.activeTexture(this.contextHandle),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.textureSize[0],this.textureSize[1],0,t.RGBA,t.UNSIGNED_BYTE,this.uploadValue),this.kernel.setUniform1i(this.id,this.index)}else this.onUpdateValueMismatch()}}]),r}(e("./index").WebGLKernelValue);t.exports={WebGLKernelValueUnsignedArray:i}},{"../../../utils":113,"./index":55}],68:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e,i){var a;c(this,r),(a=t.call(this,e,i)).requestTexture(),a.bitRatio=a.getBitRatio(e);var o=f(e.size,3),s=o[0],u=o[1],l=o[2];return a.dimensions=new Int32Array([s||1,u||1,l||1]),a.textureSize=n.getMemoryOptimizedPackedTextureSize(a.dimensions,a.bitRatio),a.uploadArrayLength=a.textureSize[0]*a.textureSize[1]*(4/a.bitRatio),a.checkSize(a.textureSize[0]*(4/a.bitRatio),a.textureSize[1]*(4/a.bitRatio)),a.TranserArrayType=a.getTransferArrayType(e.value),a.preUploadValue=new a.TranserArrayType(a.uploadArrayLength),a.uploadValue=new Uint8Array(a.preUploadValue.buffer),a}return l(r,[{key:"getStringValueHandler",value:function(){return n.linesToString(["const preUploadValue_".concat(this.name," = new ").concat(this.TranserArrayType.name,"(").concat(this.uploadArrayLength,")"),"const uploadValue_".concat(this.name," = new Uint8Array(preUploadValue_").concat(this.name,".buffer)"),"flattenTo(".concat(this.varName,".value, preUploadValue_").concat(this.name,")")])}},{key:"getSource",value:function(){return n.linesToString(["uniform sampler2D ".concat(this.id),"ivec2 ".concat(this.sizeId," = ivec2(").concat(this.textureSize[0],", ").concat(this.textureSize[1],")"),"ivec3 ".concat(this.dimensionsId," = ivec3(").concat(this.dimensions[0],", ").concat(this.dimensions[1],", ").concat(this.dimensions[2],")")])}},{key:"updateValue",value:function(e){if(e.constructor===this.initialValueConstructor){var t=this.context;n.flattenTo(e.value,this.preUploadValue),t.activeTexture(this.contextHandle),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.textureSize[0],this.textureSize[1],0,t.RGBA,t.UNSIGNED_BYTE,this.uploadValue),this.kernel.setUniform1i(this.id,this.index)}else this.onUpdateValueMismatch()}}]),r}(e("./index").WebGLKernelValue);t.exports={WebGLKernelValueUnsignedInput:i}},{"../../../utils":113,"./index":55}],69:[function(e,t,r){var n=e("../gl/kernel").GLKernel,i=e("../function-builder").FunctionBuilder,a=e("./function-node").WebGLFunctionNode,o=e("../../utils").utils,f=e("../../plugins/math-random-uniformly-distributed"),m=e("./fragment-shader").fragmentShader,y=e("./vertex-shader").vertexShader,g=e("../gl/kernel-string").glKernelString,v=e("./kernel-value-maps").lookupKernelValueType,E=null,T=null,b=null,x=null,A=null,S=[f],R=[],w={},C=function(e){"use strict";h(r,e);var t=p(r);function r(e,n){var i;return c(this,r),(i=t.call(this,e,n)).program=null,i.pipeline=n.pipeline,i.endianness=o.systemEndianness(),i.extensions={},i.subKernelOutputTextures=null,i.argumentTextureCount=0,i.constantTextureCount=0,i.fragShader=null,i.vertShader=null,i.drawBuffersMap=null,i.outputTexture=null,i.maxTexSize=null,i.onRequestSwitchKernel=null,i.removeIstanbulCoverage=!0,i.mergeSettings(e.settings||n),i.threadDim=null,i.framebuffer=null,i.buffer=null,i.textureGarbage=[],i.textureCache=[],i.programUniformLocationCache={},i.uniform1fCache={},i.uniform1iCache={},i.uniform2fCache={},i.uniform2fvCache={},i.uniform2ivCache={},i.uniform3fvCache={},i.uniform3ivCache={},i.uniform4fvCache={},i.uniform4ivCache={},i}return l(r,null,[{key:"setupFeatureChecks",value:function(){"undefined"!=typeof document?T=document.createElement("canvas"):"undefined"!=typeof OffscreenCanvas&&(T=new OffscreenCanvas(0,0)),T&&(b=T.getContext("webgl")||T.getContext("experimental-webgl"))&&b.getExtension&&(x={OES_texture_float:b.getExtension("OES_texture_float"),OES_texture_float_linear:b.getExtension("OES_texture_float_linear"),OES_element_index_uint:b.getExtension("OES_element_index_uint"),WEBGL_draw_buffers:b.getExtension("WEBGL_draw_buffers")},A=this.getFeatures())}},{key:"isContextMatch",value:function(e){return"undefined"!=typeof WebGLRenderingContext&&e instanceof WebGLRenderingContext}},{key:"getIsTextureFloat",value:function(){return Boolean(x.OES_texture_float)}},{key:"getIsDrawBuffers",value:function(){return Boolean(x.WEBGL_draw_buffers)}},{key:"getChannelCount",value:function(){return x.WEBGL_draw_buffers?b.getParameter(x.WEBGL_draw_buffers.MAX_DRAW_BUFFERS_WEBGL):1}},{key:"getMaxTextureSize",value:function(){return b.getParameter(b.MAX_TEXTURE_SIZE)}},{key:"lookupKernelValueType",value:function(e,t,r,n){return v(e,t,r,n)}},{key:"isSupported",get:function(){return null!==E?E:(this.setupFeatureChecks(),E=this.isContextMatch(b))}},{key:"testCanvas",get:function(){return T}},{key:"testContext",get:function(){return b}},{key:"features",get:function(){return A}},{key:"fragmentShader",get:function(){return m}},{key:"vertexShader",get:function(){return y}}]),l(r,[{key:"initCanvas",value:function(){if("undefined"!=typeof document){var e=document.createElement("canvas");return e.width=2,e.height=2,e}if("undefined"!=typeof OffscreenCanvas)return new OffscreenCanvas(0,0)}},{key:"initContext",value:function(){var e={alpha:!1,depth:!1,antialias:!1};return this.canvas.getContext("webgl",e)||this.canvas.getContext("experimental-webgl",e)}},{key:"initPlugins",value:function(e){var t=[],r=this.source;if("string"==typeof r)for(var n=0;n<S.length;n++){var i=S[n];r.match(i.functionMatch)&&t.push(i)}else if("object"===d(r)&&e.pluginNames)for(var a=function(r){var n=S[r];e.pluginNames.some((function(e){return e===n.name}))&&t.push(n)},o=0;o<S.length;o++)a(o);return t}},{key:"initExtensions",value:function(){this.extensions={OES_texture_float:this.context.getExtension("OES_texture_float"),OES_texture_float_linear:this.context.getExtension("OES_texture_float_linear"),OES_element_index_uint:this.context.getExtension("OES_element_index_uint"),WEBGL_draw_buffers:this.context.getExtension("WEBGL_draw_buffers"),WEBGL_color_buffer_float:this.context.getExtension("WEBGL_color_buffer_float")}}},{key:"validateSettings",value:function(e){if(this.validate){var t=this.constructor.features;if(!0===this.optimizeFloatMemory&&!t.isTextureFloat)throw new Error("Float textures are not supported");if("single"===this.precision&&!t.isFloatRead)throw new Error("Single precision not supported");if(!this.graphical&&null===this.precision&&t.isTextureFloat&&(this.precision=t.isFloatRead?"single":"unsigned"),this.subKernels&&this.subKernels.length>0&&!this.extensions.WEBGL_draw_buffers)throw new Error("could not instantiate draw buffers extension");if(null===this.fixIntegerDivisionAccuracy?this.fixIntegerDivisionAccuracy=!t.isIntegerDivisionAccurate:this.fixIntegerDivisionAccuracy&&t.isIntegerDivisionAccurate&&(this.fixIntegerDivisionAccuracy=!1),this.checkOutput(),!this.output||0===this.output.length){if(1!==e.length)throw new Error("Auto output only supported for kernels with only one input");var r=o.getVariableType(e[0],this.strictIntegers);switch(r){case"Array":this.output=o.getDimensions(r);break;case"NumberTexture":case"MemoryOptimizedNumberTexture":case"ArrayTexture(1)":case"ArrayTexture(2)":case"ArrayTexture(3)":case"ArrayTexture(4)":this.output=e[0].output;break;default:throw new Error("Auto output not supported for input type: "+r)}}if(this.graphical){if(2!==this.output.length)throw new Error("Output must have 2 dimensions on graphical mode");return"precision"===this.precision&&(this.precision="unsigned",console.warn("Cannot use graphical mode and single precision at the same time")),void(this.texSize=o.clone(this.output))}null===this.precision&&t.isTextureFloat&&(this.precision="single"),this.texSize=o.getKernelTextureSize({optimizeFloatMemory:this.optimizeFloatMemory,precision:this.precision},this.output),this.checkTextureSize()}else this.texSize=o.getKernelTextureSize({optimizeFloatMemory:this.optimizeFloatMemory,precision:this.precision},this.output)}},{key:"updateMaxTexSize",value:function(){var e=this.texSize,t=this.canvas;if(null===this.maxTexSize){var r=R.indexOf(t);-1===r&&(r=R.length,R.push(t),w[r]=[e[0],e[1]]),this.maxTexSize=w[r]}this.maxTexSize[0]<e[0]&&(this.maxTexSize[0]=e[0]),this.maxTexSize[1]<e[1]&&(this.maxTexSize[1]=e[1])}},{key:"setupArguments",value:function(e){var t=this;this.kernelArguments=[],this.argumentTextureCount=0;var r=null===this.argumentTypes;if(r&&(this.argumentTypes=[]),this.argumentSizes=[],this.argumentBitRatios=[],e.length<this.argumentNames.length)throw new Error("not enough arguments for kernel");if(e.length>this.argumentNames.length)throw new Error("too many arguments for kernel");for(var n=this.context,i=0,a=function(){return t.createTexture()},s=function(){return i++},u=function(e){t.switchKernels({type:"argumentMismatch",needed:e})},c=function(){return n.TEXTURE0+t.constantTextureCount+t.argumentTextureCount++},l=0;l<e.length;l++){var h=e[l],p=this.argumentNames[l],f=void 0;r?(f=o.getVariableType(h,this.strictIntegers),this.argumentTypes.push(f)):f=this.argumentTypes[l];var d=this.constructor.lookupKernelValueType(f,this.dynamicArguments?"dynamic":"static",this.precision,e[l]);if(null===d)return this.requestFallback(e);var m=new d(h,{name:p,type:f,tactic:this.tactic,origin:"user",context:n,checkContext:this.checkContext,kernel:this,strictIntegers:this.strictIntegers,onRequestTexture:a,onRequestIndex:s,onUpdateValueMismatch:u,onRequestContextHandle:c});this.kernelArguments.push(m),this.argumentSizes.push(m.textureSize),this.argumentBitRatios[l]=m.bitRatio}}},{key:"createTexture",value:function(){var e=this.context.createTexture();return this.textureCache.push(e),e}},{key:"setupConstants",value:function(e){var t=this,r=this.context;this.kernelConstants=[],this.forceUploadKernelConstants=[];var n=null===this.constantTypes;n&&(this.constantTypes={}),this.constantBitRatios={};var i=0;for(var a in this.constants){var s=this.constants[a],u=void 0;n?(u=o.getVariableType(s,this.strictIntegers),this.constantTypes[a]=u):u=this.constantTypes[a];var c=this.constructor.lookupKernelValueType(u,"static",this.precision,s);if(null===c)return this.requestFallback(e);var l=new c(s,{name:a,type:u,tactic:this.tactic,origin:"constants",context:this.context,checkContext:this.checkContext,kernel:this,strictIntegers:this.strictIntegers,onRequestTexture:function(){return t.createTexture()},onRequestIndex:function(){return i++},onRequestContextHandle:function(){return r.TEXTURE0+t.constantTextureCount++}});this.constantBitRatios[a]=l.bitRatio,this.kernelConstants.push(l),l.forceUploadEachRun&&this.forceUploadKernelConstants.push(l)}}},{key:"build",value:function(){if(this.initExtensions(),this.validateSettings(arguments),this.setupConstants(arguments),!this.fallbackRequested&&(this.setupArguments(arguments),!this.fallbackRequested)){this.updateMaxTexSize(),this.translateSource();var e=this.pickRenderStrategy(arguments);if(e)return e;var t=this.texSize,r=this.context,n=this.canvas;r.enable(r.SCISSOR_TEST),this.pipeline&&this.precision,r.viewport(0,0,this.maxTexSize[0],this.maxTexSize[1]),n.width=this.maxTexSize[0],n.height=this.maxTexSize[1];for(var i=this.threadDim=Array.from(this.output);i.length<3;)i.push(1);var a=this.getVertexShader(arguments),o=r.createShader(r.VERTEX_SHADER);r.shaderSource(o,a),r.compileShader(o),this.vertShader=o;var s=this.getFragmentShader(arguments),u=r.createShader(r.FRAGMENT_SHADER);if(r.shaderSource(u,s),r.compileShader(u),this.fragShader=u,this.debug&&(console.log("GLSL Shader Output:"),console.log(s)),!r.getShaderParameter(o,r.COMPILE_STATUS))throw new Error("Error compiling vertex shader: "+r.getShaderInfoLog(o));if(!r.getShaderParameter(u,r.COMPILE_STATUS))throw new Error("Error compiling fragment shader: "+r.getShaderInfoLog(u));var c=this.program=r.createProgram();r.attachShader(c,o),r.attachShader(c,u),r.linkProgram(c),this.framebuffer=r.createFramebuffer(),this.framebuffer.width=t[0],this.framebuffer.height=t[1];var l=new Float32Array([-1,-1,1,-1,-1,1,1,1]),h=new Float32Array([0,0,1,0,0,1,1,1]),p=l.byteLength,f=this.buffer;f?r.bindBuffer(r.ARRAY_BUFFER,f):(f=this.buffer=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,f),r.bufferData(r.ARRAY_BUFFER,l.byteLength+h.byteLength,r.STATIC_DRAW)),r.bufferSubData(r.ARRAY_BUFFER,0,l),r.bufferSubData(r.ARRAY_BUFFER,p,h);var d=r.getAttribLocation(this.program,"aPos");r.enableVertexAttribArray(d),r.vertexAttribPointer(d,2,r.FLOAT,!1,0,0);var m=r.getAttribLocation(this.program,"aTexCoord");r.enableVertexAttribArray(m),r.vertexAttribPointer(m,2,r.FLOAT,!1,0,p),r.bindFramebuffer(r.FRAMEBUFFER,this.framebuffer);var y=0;for(var g in r.useProgram(this.program),this.constants)this.kernelConstants[y++].updateValue(this.constants[g]);this.immutable||(this._setupOutputTexture(),null!==this.subKernels&&this.subKernels.length>0&&this._setupSubOutputTextures()),this.built=!0}}},{key:"translateSource",value:function(){var e=i.fromKernel(this,a,{fixIntegerDivisionAccuracy:this.fixIntegerDivisionAccuracy});this.translatedSource=e.getPrototypeString("kernel"),this.setupReturnTypes(e)}},{key:"setupReturnTypes",value:function(e){if(this.graphical||this.returnType||(this.returnType=e.getKernelResultType()),this.subKernels&&this.subKernels.length>0)for(var t=0;t<this.subKernels.length;t++){var r=this.subKernels[t];r.returnType||(r.returnType=e.getSubKernelResultType(t))}}},{key:"run",value:function(){var e=this.kernelArguments,t=this.texSize,r=this.forceUploadKernelConstants,n=this.context;n.useProgram(this.program),n.scissor(0,0,t[0],t[1]),this.dynamicOutput&&(this.setUniform3iv("uOutputDim",new Int32Array(this.threadDim)),this.setUniform2iv("uTexSize",t)),this.setUniform2f("ratio",t[0]/this.maxTexSize[0],t[1]/this.maxTexSize[1]);for(var i=0;i<r.length;i++){var a=r[i];if(a.updateValue(this.constants[a.name]),this.switchingKernels)return}for(var o=0;o<e.length;o++)if(e[o].updateValue(arguments[o]),this.switchingKernels)return;if(this.plugins)for(var s=0;s<this.plugins.length;s++){var u=this.plugins[s];u.onBeforeRun&&u.onBeforeRun(this)}if(this.graphical)return this.pipeline?(n.bindRenderbuffer(n.RENDERBUFFER,null),n.bindFramebuffer(n.FRAMEBUFFER,this.framebuffer),this.outputTexture&&!this.immutable||this._setupOutputTexture(),n.drawArrays(n.TRIANGLE_STRIP,0,4),new this.TextureConstructor({texture:this.outputTexture,size:t,dimensions:this.threadDim,output:this.output,context:this.context,internalFormat:this.getInternalFormat(),textureFormat:this.getTextureFormat()})):(n.bindRenderbuffer(n.RENDERBUFFER,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.drawArrays(n.TRIANGLE_STRIP,0,4),void this.garbageCollect());n.bindFramebuffer(n.FRAMEBUFFER,this.framebuffer),this.immutable&&this._setupOutputTexture(),null!==this.subKernels&&(this.immutable&&this._setupSubOutputTextures(),this.drawBuffers()),n.drawArrays(n.TRIANGLE_STRIP,0,4),this.garbageCollect()}},{key:"garbageCollect",value:function(){for(;this.textureGarbage.length>0;)this.textureGarbage.pop().delete()}},{key:"drawBuffers",value:function(){this.extensions.WEBGL_draw_buffers.drawBuffersWEBGL(this.drawBuffersMap)}},{key:"getInternalFormat",value:function(){return this.context.RGBA}},{key:"getTextureFormat",value:function(){var e=this.context;switch(this.getInternalFormat()){case e.RGBA:return e.RGBA;default:throw new Error("Unknown internal format")}}},{key:"_setupOutputTexture",value:function(){var e=this.context,t=this.texSize,r=this.outputTexture=this.createTexture();e.activeTexture(e.TEXTURE0+this.constantTextureCount+this.argumentTextureCount),e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST);var n=this.getInternalFormat();"single"===this.precision?e.texImage2D(e.TEXTURE_2D,0,n,t[0],t[1],0,e.RGBA,e.FLOAT,null):e.texImage2D(e.TEXTURE_2D,0,n,t[0],t[1],0,n,e.UNSIGNED_BYTE,null),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0)}},{key:"_setupSubOutputTextures",value:function(){var e=this.context,t=this.texSize;this.drawBuffersMap=[e.COLOR_ATTACHMENT0],this.subKernelOutputTextures=[];for(var r=0;r<this.subKernels.length;r++){var n=this.createTexture();this.subKernelOutputTextures.push(n),this.drawBuffersMap.push(e.COLOR_ATTACHMENT0+r+1),e.activeTexture(e.TEXTURE0+this.constantTextureCount+this.argumentTextureCount+r),e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),"single"===this.precision?e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t[0],t[1],0,e.RGBA,e.FLOAT,null):e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t[0],t[1],0,e.RGBA,e.UNSIGNED_BYTE,null),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+r+1,e.TEXTURE_2D,n,0)}}},{key:"setUniform1f",value:function(e,t){if(!this.uniform1fCache.hasOwnProperty(e)||t!==this.uniform1fCache[e]){this.uniform1fCache[e]=t;var r=this.getUniformLocation(e);this.context.uniform1f(r,t)}}},{key:"setUniform1i",value:function(e,t){if(!this.uniform1iCache.hasOwnProperty(e)||t!==this.uniform1iCache[e]){this.uniform1iCache[e]=t;var r=this.getUniformLocation(e);this.context.uniform1i(r,t)}}},{key:"setUniform2f",value:function(e,t,r){if(this.uniform2fCache.hasOwnProperty(e)){var n=this.uniform2fCache[e];if(t===n[0]&&r===n[1])return}this.uniform2fCache[e]=[t,r];var i=this.getUniformLocation(e);this.context.uniform2f(i,t,r)}},{key:"setUniform2fv",value:function(e,t){if(this.uniform2fvCache.hasOwnProperty(e)){var r=this.uniform2fvCache[e];if(t[0]===r[0]&&t[1]===r[1])return}this.uniform2fvCache[e]=t;var n=this.getUniformLocation(e);this.context.uniform2fv(n,t)}},{key:"setUniform2iv",value:function(e,t){if(this.uniform2ivCache.hasOwnProperty(e)){var r=this.uniform2ivCache[e];if(t[0]===r[0]&&t[1]===r[1])return}this.uniform2ivCache[e]=t;var n=this.getUniformLocation(e);this.context.uniform2iv(n,t)}},{key:"setUniform3fv",value:function(e,t){if(this.uniform3fvCache.hasOwnProperty(e)){var r=this.uniform3fvCache[e];if(t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2])return}this.uniform3fvCache[e]=t;var n=this.getUniformLocation(e);this.context.uniform3fv(n,t)}},{key:"setUniform3iv",value:function(e,t){if(this.uniform3ivCache.hasOwnProperty(e)){var r=this.uniform3ivCache[e];if(t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2])return}this.uniform3ivCache[e]=t;var n=this.getUniformLocation(e);this.context.uniform3iv(n,t)}},{key:"setUniform4fv",value:function(e,t){if(this.uniform4fvCache.hasOwnProperty(e)){var r=this.uniform4fvCache[e];if(t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3])return}this.uniform4fvCache[e]=t;var n=this.getUniformLocation(e);this.context.uniform4fv(n,t)}},{key:"setUniform4iv",value:function(e,t){if(this.uniform4ivCache.hasOwnProperty(e)){var r=this.uniform4ivCache[e];if(t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3])return}this.uniform4ivCache[e]=t;var n=this.getUniformLocation(e);this.context.uniform4iv(n,t)}},{key:"getUniformLocation",value:function(e){return this.programUniformLocationCache.hasOwnProperty(e)?this.programUniformLocationCache[e]:this.programUniformLocationCache[e]=this.context.getUniformLocation(this.program,e)}},{key:"_getFragShaderArtifactMap",value:function(e){return{HEADER:this._getHeaderString(),LOOP_MAX:this._getLoopMaxString(),PLUGINS:this._getPluginsString(),CONSTANTS:this._getConstantsString(),DECODE32_ENDIANNESS:this._getDecode32EndiannessString(),ENCODE32_ENDIANNESS:this._getEncode32EndiannessString(),DIVIDE_WITH_INTEGER_CHECK:this._getDivideWithIntegerCheckString(),INJECTED_NATIVE:this._getInjectedNative(),MAIN_CONSTANTS:this._getMainConstantsString(),MAIN_ARGUMENTS:this._getMainArgumentsString(e),KERNEL:this.getKernelString(),MAIN_RESULT:this.getMainResultString(),FLOAT_TACTIC_DECLARATION:this.getFloatTacticDeclaration(),INT_TACTIC_DECLARATION:this.getIntTacticDeclaration(),SAMPLER_2D_TACTIC_DECLARATION:this.getSampler2DTacticDeclaration(),SAMPLER_2D_ARRAY_TACTIC_DECLARATION:this.getSampler2DArrayTacticDeclaration()}}},{key:"_getVertShaderArtifactMap",value:function(e){return{FLOAT_TACTIC_DECLARATION:this.getFloatTacticDeclaration(),INT_TACTIC_DECLARATION:this.getIntTacticDeclaration(),SAMPLER_2D_TACTIC_DECLARATION:this.getSampler2DTacticDeclaration(),SAMPLER_2D_ARRAY_TACTIC_DECLARATION:this.getSampler2DArrayTacticDeclaration()}}},{key:"_getHeaderString",value:function(){return null!==this.subKernels?"#extension GL_EXT_draw_buffers : require\n":""}},{key:"_getLoopMaxString",value:function(){return this.loopMaxIterations?" ".concat(parseInt(this.loopMaxIterations),";\n"):" 1000;\n"}},{key:"_getPluginsString",value:function(){var e=this;return this.plugins?this.plugins.map((function(t){return t.source&&e.source.match(t.functionMatch)?t.source:""})).join("\n"):"\n"}},{key:"_getConstantsString",value:function(){var e=[],t=this.threadDim,r=this.texSize;return this.dynamicOutput?e.push("uniform ivec3 uOutputDim","uniform ivec2 uTexSize"):e.push("ivec3 uOutputDim = ivec3(".concat(t[0],", ").concat(t[1],", ").concat(t[2],")"),"ivec2 uTexSize = ivec2(".concat(r[0],", ").concat(r[1],")")),o.linesToString(e)}},{key:"_getTextureCoordinate",value:function(){var e=this.subKernels;return null===e||e.length<1?"varying vec2 vTexCoord;\n":"out vec2 vTexCoord;\n"}},{key:"_getDecode32EndiannessString",value:function(){return"LE"===this.endianness?"":"  texel.rgba = texel.abgr;\n"}},{key:"_getEncode32EndiannessString",value:function(){return"LE"===this.endianness?"":"  texel.rgba = texel.abgr;\n"}},{key:"_getDivideWithIntegerCheckString",value:function(){return this.fixIntegerDivisionAccuracy?"float div_with_int_check(float x, float y) {\n  if (floor(x) == x && floor(y) == y && integerMod(x, y) == 0.0) {\n    return float(int(x)/int(y));\n  }\n  return x / y;\n}":""}},{key:"_getMainArgumentsString",value:function(e){for(var t=[],r=this.argumentNames,n=0;n<r.length;n++)t.push(this.kernelArguments[n].getSource(e[n]));return t.join("")}},{key:"_getInjectedNative",value:function(){return this.injectedNative||""}},{key:"_getMainConstantsString",value:function(){var e=[],t=this.constants;if(t){var r=0;for(var n in t)this.constants.hasOwnProperty(n)&&e.push(this.kernelConstants[r++].getSource(this.constants[n]))}return e.join("")}},{key:"getKernelResultDeclaration",value:function(){switch(this.returnType){case"Array(2)":return"vec2 kernelResult";case"Array(3)":return"vec3 kernelResult";case"Array(4)":return"vec4 kernelResult";case"LiteralInteger":case"Float":case"Number":case"Integer":return"float kernelResult";default:if(this.graphical)return"float kernelResult";throw new Error('unrecognized output type "'.concat(this.returnType,'"'))}}},{key:"getKernelString",value:function(){var e=[this.getKernelResultDeclaration()],t=this.subKernels;if(null!==t)switch(this.returnType){case"Number":case"Float":case"Integer":for(var r=0;r<t.length;r++){var n=t[r];e.push("Integer"===n.returnType?"int subKernelResult_".concat(n.name," = 0"):"float subKernelResult_".concat(n.name," = 0.0"))}break;case"Array(2)":for(var i=0;i<t.length;i++)e.push("vec2 subKernelResult_".concat(t[i].name));break;case"Array(3)":for(var a=0;a<t.length;a++)e.push("vec3 subKernelResult_".concat(t[a].name));break;case"Array(4)":for(var s=0;s<t.length;s++)e.push("vec4 subKernelResult_".concat(t[s].name))}return o.linesToString(e)+this.translatedSource}},{key:"getMainResultGraphical",value:function(){return o.linesToString(["  threadId = indexTo3D(index, uOutputDim)","  kernel()","  gl_FragColor = actualColor"])}},{key:"getMainResultPackedPixels",value:function(){switch(this.returnType){case"LiteralInteger":case"Number":case"Integer":case"Float":return this.getMainResultKernelPackedPixels()+this.getMainResultSubKernelPackedPixels();default:throw new Error('packed output only usable with Numbers, "'.concat(this.returnType,'" specified'))}}},{key:"getMainResultKernelPackedPixels",value:function(){return o.linesToString(["  threadId = indexTo3D(index, uOutputDim)","  kernel()","  gl_FragData[0] = ".concat(this.useLegacyEncoder?"legacyEncode32":"encode32","(kernelResult)")])}},{key:"getMainResultSubKernelPackedPixels",value:function(){var e=[];if(!this.subKernels)return"";for(var t=0;t<this.subKernels.length;t++)"Integer"===this.subKernels[t].returnType?e.push("  gl_FragData[".concat(t+1,"] = ").concat(this.useLegacyEncoder?"legacyEncode32":"encode32","(float(subKernelResult_").concat(this.subKernels[t].name,"))")):e.push("  gl_FragData[".concat(t+1,"] = ").concat(this.useLegacyEncoder?"legacyEncode32":"encode32","(subKernelResult_").concat(this.subKernels[t].name,")"));return o.linesToString(e)}},{key:"getMainResultMemoryOptimizedFloats",value:function(){var e=["  index *= 4"];switch(this.returnType){case"Number":case"Integer":case"Float":for(var t=["r","g","b","a"],r=0;r<t.length;r++){var n=t[r];this.getMainResultKernelMemoryOptimizedFloats(e,n),this.getMainResultSubKernelMemoryOptimizedFloats(e,n),r+1<t.length&&e.push("  index += 1")}break;default:throw new Error("optimized output only usable with Numbers, ".concat(this.returnType," specified"))}return o.linesToString(e)}},{key:"getMainResultKernelMemoryOptimizedFloats",value:function(e,t){e.push("  threadId = indexTo3D(index, uOutputDim)","  kernel()","  gl_FragData[0].".concat(t," = kernelResult"))}},{key:"getMainResultSubKernelMemoryOptimizedFloats",value:function(e,t){if(!this.subKernels)return e;for(var r=0;r<this.subKernels.length;r++)"Integer"===this.subKernels[r].returnType?e.push("  gl_FragData[".concat(r+1,"].").concat(t," = float(subKernelResult_").concat(this.subKernels[r].name,")")):e.push("  gl_FragData[".concat(r+1,"].").concat(t," = subKernelResult_").concat(this.subKernels[r].name))}},{key:"getMainResultKernelNumberTexture",value:function(){return["  threadId = indexTo3D(index, uOutputDim)","  kernel()","  gl_FragData[0][0] = kernelResult"]}},{key:"getMainResultSubKernelNumberTexture",value:function(){var e=[];if(!this.subKernels)return e;for(var t=0;t<this.subKernels.length;++t){var r=this.subKernels[t];"Integer"===r.returnType?e.push("  gl_FragData[".concat(t+1,"][0] = float(subKernelResult_").concat(r.name,")")):e.push("  gl_FragData[".concat(t+1,"][0] = subKernelResult_").concat(r.name))}return e}},{key:"getMainResultKernelArray2Texture",value:function(){return["  threadId = indexTo3D(index, uOutputDim)","  kernel()","  gl_FragData[0][0] = kernelResult[0]","  gl_FragData[0][1] = kernelResult[1]"]}},{key:"getMainResultSubKernelArray2Texture",value:function(){var e=[];if(!this.subKernels)return e;for(var t=0;t<this.subKernels.length;++t)e.push("  gl_FragData[".concat(t+1,"][0] = subKernelResult_").concat(this.subKernels[t].name,"[0]"),"  gl_FragData[".concat(t+1,"][1] = subKernelResult_").concat(this.subKernels[t].name,"[1]"));return e}},{key:"getMainResultKernelArray3Texture",value:function(){return["  threadId = indexTo3D(index, uOutputDim)","  kernel()","  gl_FragData[0][0] = kernelResult[0]","  gl_FragData[0][1] = kernelResult[1]","  gl_FragData[0][2] = kernelResult[2]"]}},{key:"getMainResultSubKernelArray3Texture",value:function(){var e=[];if(!this.subKernels)return e;for(var t=0;t<this.subKernels.length;++t)e.push("  gl_FragData[".concat(t+1,"][0] = subKernelResult_").concat(this.subKernels[t].name,"[0]"),"  gl_FragData[".concat(t+1,"][1] = subKernelResult_").concat(this.subKernels[t].name,"[1]"),"  gl_FragData[".concat(t+1,"][2] = subKernelResult_").concat(this.subKernels[t].name,"[2]"));return e}},{key:"getMainResultKernelArray4Texture",value:function(){return["  threadId = indexTo3D(index, uOutputDim)","  kernel()","  gl_FragData[0] = kernelResult"]}},{key:"getMainResultSubKernelArray4Texture",value:function(){var e=[];if(!this.subKernels)return e;switch(this.returnType){case"Number":case"Float":case"Integer":for(var t=0;t<this.subKernels.length;++t)"Integer"===this.subKernels[t].returnType?e.push("  gl_FragData[".concat(t+1,"] = float(subKernelResult_").concat(this.subKernels[t].name,")")):e.push("  gl_FragData[".concat(t+1,"] = subKernelResult_").concat(this.subKernels[t].name));break;case"Array(2)":for(var r=0;r<this.subKernels.length;++r)e.push("  gl_FragData[".concat(r+1,"][0] = subKernelResult_").concat(this.subKernels[r].name,"[0]"),"  gl_FragData[".concat(r+1,"][1] = subKernelResult_").concat(this.subKernels[r].name,"[1]"));break;case"Array(3)":for(var n=0;n<this.subKernels.length;++n)e.push("  gl_FragData[".concat(n+1,"][0] = subKernelResult_").concat(this.subKernels[n].name,"[0]"),"  gl_FragData[".concat(n+1,"][1] = subKernelResult_").concat(this.subKernels[n].name,"[1]"),"  gl_FragData[".concat(n+1,"][2] = subKernelResult_").concat(this.subKernels[n].name,"[2]"));break;case"Array(4)":for(var i=0;i<this.subKernels.length;++i)e.push("  gl_FragData[".concat(i+1,"][0] = subKernelResult_").concat(this.subKernels[i].name,"[0]"),"  gl_FragData[".concat(i+1,"][1] = subKernelResult_").concat(this.subKernels[i].name,"[1]"),"  gl_FragData[".concat(i+1,"][2] = subKernelResult_").concat(this.subKernels[i].name,"[2]"),"  gl_FragData[".concat(i+1,"][3] = subKernelResult_").concat(this.subKernels[i].name,"[3]"))}return e}},{key:"replaceArtifacts",value:function(e,t){return e.replace(/[ ]*__([A-Z]+[0-9]*([_]?[A-Z]*[0-9]?)*)__;\n/g,(function(e,r){if(t.hasOwnProperty(r))return t[r];throw"unhandled artifact ".concat(r)}))}},{key:"getFragmentShader",value:function(e){return null!==this.compiledFragmentShader?this.compiledFragmentShader:this.compiledFragmentShader=this.replaceArtifacts(this.constructor.fragmentShader,this._getFragShaderArtifactMap(e))}},{key:"getVertexShader",value:function(e){return null!==this.compiledVertexShader?this.compiledVertexShader:this.compiledVertexShader=this.replaceArtifacts(this.constructor.vertexShader,this._getVertShaderArtifactMap(e))}},{key:"toString",value:function(){var e=o.linesToString(["const gl = context"]);return g(this.constructor,arguments,this,e)}},{key:"destroy",value:function(e){for(this.buffer&&this.context.deleteBuffer(this.buffer),this.framebuffer&&this.context.deleteFramebuffer(this.framebuffer),this.vertShader&&this.context.deleteShader(this.vertShader),this.fragShader&&this.context.deleteShader(this.fragShader),this.program&&this.context.deleteProgram(this.program);this.textureCache.length>0;){var t=this.textureCache.pop();this.context.deleteTexture(t)}if(e){var r=R.indexOf(this.canvas);r>=0&&(R[r]=null,w[r]=null)}this.destroyExtensions(),delete this.context,delete this.canvas}},{key:"destroyExtensions",value:function(){this.extensions.OES_texture_float=null,this.extensions.OES_texture_float_linear=null,this.extensions.OES_element_index_uint=null,this.extensions.WEBGL_draw_buffers=null}},{key:"toJSON",value:function(){var e=s(u(r.prototype),"toJSON",this).call(this);return e.functionNodes=i.fromKernel(this,a).toJSON(),e.settings.threadDim=this.threadDim,e}}],[{key:"destroyContext",value:function(e){var t=e.getExtension("WEBGL_lose_context");t&&t.loseContext()}}]),r}(n);t.exports={WebGLKernel:C}},{"../../plugins/math-random-uniformly-distributed":111,"../../utils":113,"../function-builder":9,"../gl/kernel":13,"../gl/kernel-string":12,"./fragment-shader":37,"./function-node":38,"./kernel-value-maps":39,"./vertex-shader":70}],70:[function(e,t,r){t.exports={vertexShader:"__FLOAT_TACTIC_DECLARATION__;\n__INT_TACTIC_DECLARATION__;\n__SAMPLER_2D_TACTIC_DECLARATION__;\n\nattribute vec2 aPos;\nattribute vec2 aTexCoord;\n\nvarying vec2 vTexCoord;\nuniform vec2 ratio;\n\nvoid main(void) {\n  gl_Position = vec4((aPos + vec2(1)) * ratio + vec2(-1), 0, 1);\n  vTexCoord = aTexCoord;\n}"}},{}],71:[function(e,t,r){t.exports={fragmentShader:"#version 300 es\n__HEADER__;\n__FLOAT_TACTIC_DECLARATION__;\n__INT_TACTIC_DECLARATION__;\n__SAMPLER_2D_TACTIC_DECLARATION__;\n__SAMPLER_2D_ARRAY_TACTIC_DECLARATION__;\n\nconst int LOOP_MAX = __LOOP_MAX__;\n\n__PLUGINS__;\n__CONSTANTS__;\n\nin vec2 vTexCoord;\n\nconst int BIT_COUNT = 32;\nint modi(int x, int y) {\n  return x - y * (x / y);\n}\n\nint bitwiseOr(int a, int b) {\n  int result = 0;\n  int n = 1;\n  \n  for (int i = 0; i < BIT_COUNT; i++) {\n    if ((modi(a, 2) == 1) || (modi(b, 2) == 1)) {\n      result += n;\n    }\n    a = a / 2;\n    b = b / 2;\n    n = n * 2;\n    if(!(a > 0 || b > 0)) {\n      break;\n    }\n  }\n  return result;\n}\nint bitwiseXOR(int a, int b) {\n  int result = 0;\n  int n = 1;\n  \n  for (int i = 0; i < BIT_COUNT; i++) {\n    if ((modi(a, 2) == 1) != (modi(b, 2) == 1)) {\n      result += n;\n    }\n    a = a / 2;\n    b = b / 2;\n    n = n * 2;\n    if(!(a > 0 || b > 0)) {\n      break;\n    }\n  }\n  return result;\n}\nint bitwiseAnd(int a, int b) {\n  int result = 0;\n  int n = 1;\n  for (int i = 0; i < BIT_COUNT; i++) {\n    if ((modi(a, 2) == 1) && (modi(b, 2) == 1)) {\n      result += n;\n    }\n    a = a / 2;\n    b = b / 2;\n    n = n * 2;\n    if(!(a > 0 && b > 0)) {\n      break;\n    }\n  }\n  return result;\n}\nint bitwiseNot(int a) {\n  int result = 0;\n  int n = 1;\n  \n  for (int i = 0; i < BIT_COUNT; i++) {\n    if (modi(a, 2) == 0) {\n      result += n;    \n    }\n    a = a / 2;\n    n = n * 2;\n  }\n  return result;\n}\nint bitwiseZeroFillLeftShift(int n, int shift) {\n  int maxBytes = BIT_COUNT;\n  for (int i = 0; i < BIT_COUNT; i++) {\n    if (maxBytes >= n) {\n      break;\n    }\n    maxBytes *= 2;\n  }\n  for (int i = 0; i < BIT_COUNT; i++) {\n    if (i >= shift) {\n      break;\n    }\n    n *= 2;\n  }\n\n  int result = 0;\n  int byteVal = 1;\n  for (int i = 0; i < BIT_COUNT; i++) {\n    if (i >= maxBytes) break;\n    if (modi(n, 2) > 0) { result += byteVal; }\n    n = int(n / 2);\n    byteVal *= 2;\n  }\n  return result;\n}\n\nint bitwiseSignedRightShift(int num, int shifts) {\n  return int(floor(float(num) / pow(2.0, float(shifts))));\n}\n\nint bitwiseZeroFillRightShift(int n, int shift) {\n  int maxBytes = BIT_COUNT;\n  for (int i = 0; i < BIT_COUNT; i++) {\n    if (maxBytes >= n) {\n      break;\n    }\n    maxBytes *= 2;\n  }\n  for (int i = 0; i < BIT_COUNT; i++) {\n    if (i >= shift) {\n      break;\n    }\n    n /= 2;\n  }\n  int result = 0;\n  int byteVal = 1;\n  for (int i = 0; i < BIT_COUNT; i++) {\n    if (i >= maxBytes) break;\n    if (modi(n, 2) > 0) { result += byteVal; }\n    n = int(n / 2);\n    byteVal *= 2;\n  }\n  return result;\n}\n\nvec2 integerMod(vec2 x, float y) {\n  vec2 res = floor(mod(x, y));\n  return res * step(1.0 - floor(y), -res);\n}\n\nvec3 integerMod(vec3 x, float y) {\n  vec3 res = floor(mod(x, y));\n  return res * step(1.0 - floor(y), -res);\n}\n\nvec4 integerMod(vec4 x, vec4 y) {\n  vec4 res = floor(mod(x, y));\n  return res * step(1.0 - floor(y), -res);\n}\n\nfloat integerMod(float x, float y) {\n  float res = floor(mod(x, y));\n  return res * (res > floor(y) - 1.0 ? 0.0 : 1.0);\n}\n\nint integerMod(int x, int y) {\n  return x - (y * int(x/y));\n}\n\n__DIVIDE_WITH_INTEGER_CHECK__;\n\n// Here be dragons!\n// DO NOT OPTIMIZE THIS CODE\n// YOU WILL BREAK SOMETHING ON SOMEBODY'S MACHINE\n// LEAVE IT AS IT IS, LEST YOU WASTE YOUR OWN TIME\nconst vec2 MAGIC_VEC = vec2(1.0, -256.0);\nconst vec4 SCALE_FACTOR = vec4(1.0, 256.0, 65536.0, 0.0);\nconst vec4 SCALE_FACTOR_INV = vec4(1.0, 0.00390625, 0.0000152587890625, 0.0); // 1, 1/256, 1/65536\nfloat decode32(vec4 texel) {\n  __DECODE32_ENDIANNESS__;\n  texel *= 255.0;\n  vec2 gte128;\n  gte128.x = texel.b >= 128.0 ? 1.0 : 0.0;\n  gte128.y = texel.a >= 128.0 ? 1.0 : 0.0;\n  float exponent = 2.0 * texel.a - 127.0 + dot(gte128, MAGIC_VEC);\n  float res = exp2(round(exponent));\n  texel.b = texel.b - 128.0 * gte128.x;\n  res = dot(texel, SCALE_FACTOR) * exp2(round(exponent-23.0)) + res;\n  res *= gte128.y * -2.0 + 1.0;\n  return res;\n}\n\nfloat decode16(vec4 texel, int index) {\n  int channel = integerMod(index, 2);\n  return texel[channel*2] * 255.0 + texel[channel*2 + 1] * 65280.0;\n}\n\nfloat decode8(vec4 texel, int index) {\n  int channel = integerMod(index, 4);\n  return texel[channel] * 255.0;\n}\n\nvec4 legacyEncode32(float f) {\n  float F = abs(f);\n  float sign = f < 0.0 ? 1.0 : 0.0;\n  float exponent = floor(log2(F));\n  float mantissa = (exp2(-exponent) * F);\n  // exponent += floor(log2(mantissa));\n  vec4 texel = vec4(F * exp2(23.0-exponent)) * SCALE_FACTOR_INV;\n  texel.rg = integerMod(texel.rg, 256.0);\n  texel.b = integerMod(texel.b, 128.0);\n  texel.a = exponent*0.5 + 63.5;\n  texel.ba += vec2(integerMod(exponent+127.0, 2.0), sign) * 128.0;\n  texel = floor(texel);\n  texel *= 0.003921569; // 1/255\n  __ENCODE32_ENDIANNESS__;\n  return texel;\n}\n\n// https://github.com/gpujs/gpu.js/wiki/Encoder-details\nvec4 encode32(float value) {\n  if (value == 0.0) return vec4(0, 0, 0, 0);\n\n  float exponent;\n  float mantissa;\n  vec4  result;\n  float sgn;\n\n  sgn = step(0.0, -value);\n  value = abs(value);\n\n  exponent = floor(log2(value));\n\n  mantissa = value*pow(2.0, -exponent)-1.0;\n  exponent = exponent+127.0;\n  result   = vec4(0,0,0,0);\n\n  result.a = floor(exponent/2.0);\n  exponent = exponent - result.a*2.0;\n  result.a = result.a + 128.0*sgn;\n\n  result.b = floor(mantissa * 128.0);\n  mantissa = mantissa - result.b / 128.0;\n  result.b = result.b + exponent*128.0;\n\n  result.g = floor(mantissa*32768.0);\n  mantissa = mantissa - result.g/32768.0;\n\n  result.r = floor(mantissa*8388608.0);\n  return result/255.0;\n}\n// Dragons end here\n\nint index;\nivec3 threadId;\n\nivec3 indexTo3D(int idx, ivec3 texDim) {\n  int z = int(idx / (texDim.x * texDim.y));\n  idx -= z * int(texDim.x * texDim.y);\n  int y = int(idx / texDim.x);\n  int x = int(integerMod(idx, texDim.x));\n  return ivec3(x, y, z);\n}\n\nfloat get32(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  int index = x + texDim.x * (y + texDim.y * z);\n  int w = texSize.x;\n  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;\n  vec4 texel = texture(tex, st / vec2(texSize));\n  return decode32(texel);\n}\n\nfloat get16(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  int index = x + (texDim.x * (y + (texDim.y * z)));\n  int w = texSize.x * 2;\n  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;\n  vec4 texel = texture(tex, st / vec2(texSize.x * 2, texSize.y));\n  return decode16(texel, index);\n}\n\nfloat get8(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  int index = x + (texDim.x * (y + (texDim.y * z)));\n  int w = texSize.x * 4;\n  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;\n  vec4 texel = texture(tex, st / vec2(texSize.x * 4, texSize.y));\n  return decode8(texel, index);\n}\n\nfloat getMemoryOptimized32(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  int index = x + (texDim.x * (y + (texDim.y * z)));\n  int channel = integerMod(index, 4);\n  index = index / 4;\n  int w = texSize.x;\n  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;\n  index = index / 4;\n  vec4 texel = texture(tex, st / vec2(texSize));\n  return texel[channel];\n}\n\nvec4 getImage2D(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  int index = x + texDim.x * (y + texDim.y * z);\n  int w = texSize.x;\n  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;\n  return texture(tex, st / vec2(texSize));\n}\n\nvec4 getImage3D(sampler2DArray tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  int index = x + texDim.x * (y + texDim.y * z);\n  int w = texSize.x;\n  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;\n  return texture(tex, vec3(st / vec2(texSize), z));\n}\n\nfloat getFloatFromSampler2D(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  vec4 result = getImage2D(tex, texSize, texDim, z, y, x);\n  return result[0];\n}\n\nvec2 getVec2FromSampler2D(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  vec4 result = getImage2D(tex, texSize, texDim, z, y, x);\n  return vec2(result[0], result[1]);\n}\n\nvec2 getMemoryOptimizedVec2(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  int index = x + texDim.x * (y + texDim.y * z);\n  int channel = integerMod(index, 2);\n  index = index / 2;\n  int w = texSize.x;\n  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;\n  vec4 texel = texture(tex, st / vec2(texSize));\n  if (channel == 0) return vec2(texel.r, texel.g);\n  if (channel == 1) return vec2(texel.b, texel.a);\n  return vec2(0.0, 0.0);\n}\n\nvec3 getVec3FromSampler2D(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  vec4 result = getImage2D(tex, texSize, texDim, z, y, x);\n  return vec3(result[0], result[1], result[2]);\n}\n\nvec3 getMemoryOptimizedVec3(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  int fieldIndex = 3 * (x + texDim.x * (y + texDim.y * z));\n  int vectorIndex = fieldIndex / 4;\n  int vectorOffset = fieldIndex - vectorIndex * 4;\n  int readY = vectorIndex / texSize.x;\n  int readX = vectorIndex - readY * texSize.x;\n  vec4 tex1 = texture(tex, (vec2(readX, readY) + 0.5) / vec2(texSize));\n\n  if (vectorOffset == 0) {\n    return tex1.xyz;\n  } else if (vectorOffset == 1) {\n    return tex1.yzw;\n  } else {\n    readX++;\n    if (readX >= texSize.x) {\n      readX = 0;\n      readY++;\n    }\n    vec4 tex2 = texture(tex, vec2(readX, readY) / vec2(texSize));\n    if (vectorOffset == 2) {\n      return vec3(tex1.z, tex1.w, tex2.x);\n    } else {\n      return vec3(tex1.w, tex2.x, tex2.y);\n    }\n  }\n}\n\nvec4 getVec4FromSampler2D(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  return getImage2D(tex, texSize, texDim, z, y, x);\n}\n\nvec4 getMemoryOptimizedVec4(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  int index = x + texDim.x * (y + texDim.y * z);\n  int channel = integerMod(index, 2);\n  int w = texSize.x;\n  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;\n  vec4 texel = texture(tex, st / vec2(texSize));\n  return vec4(texel.r, texel.g, texel.b, texel.a);\n}\n\nvec4 actualColor;\nvoid color(float r, float g, float b, float a) {\n  actualColor = vec4(r,g,b,a);\n}\n\nvoid color(float r, float g, float b) {\n  color(r,g,b,1.0);\n}\n\n__INJECTED_NATIVE__;\n__MAIN_CONSTANTS__;\n__MAIN_ARGUMENTS__;\n__KERNEL__;\n\nvoid main(void) {\n  index = int(vTexCoord.s * float(uTexSize.x)) + int(vTexCoord.t * float(uTexSize.y)) * uTexSize.x;\n  __MAIN_RESULT__;\n}"}},{}],72:[function(e,t,r){var n=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"astIdentifierExpression",value:function(e,t){if("Identifier"!==e.type)throw this.astErrorOutput("IdentifierExpression - not an Identifier",e);var r=this.getType(e);return"Infinity"===e.name?t.push("intBitsToFloat(2139095039)"):"Boolean"===r&&this.argumentNames.indexOf(e.name)>-1?t.push("bool(user_".concat(e.name,")")):t.push("user_".concat(e.name)),t}}]),r}(e("../web-gl/function-node").WebGLFunctionNode);t.exports={WebGL2FunctionNode:n}},{"../web-gl/function-node":38}],73:[function(e,t,r){var n=e("./kernel-value/boolean").WebGL2KernelValueBoolean,i=e("./kernel-value/float").WebGL2KernelValueFloat,a=e("./kernel-value/integer").WebGL2KernelValueInteger,o=e("./kernel-value/html-image").WebGL2KernelValueHTMLImage,s=e("./kernel-value/dynamic-html-image").WebGL2KernelValueDynamicHTMLImage,u=e("./kernel-value/html-image-array").WebGL2KernelValueHTMLImageArray,c=e("./kernel-value/dynamic-html-image-array").WebGL2KernelValueDynamicHTMLImageArray,l=e("./kernel-value/html-video").WebGL2KernelValueHTMLVideo,h=e("./kernel-value/dynamic-html-video").WebGL2KernelValueDynamicHTMLVideo,p=e("./kernel-value/single-input").WebGL2KernelValueSingleInput,f=e("./kernel-value/dynamic-single-input").WebGL2KernelValueDynamicSingleInput,d=e("./kernel-value/unsigned-input").WebGL2KernelValueUnsignedInput,m=e("./kernel-value/dynamic-unsigned-input").WebGL2KernelValueDynamicUnsignedInput,y=e("./kernel-value/memory-optimized-number-texture").WebGL2KernelValueMemoryOptimizedNumberTexture,g=e("./kernel-value/dynamic-memory-optimized-number-texture").WebGL2KernelValueDynamicMemoryOptimizedNumberTexture,v=e("./kernel-value/number-texture").WebGL2KernelValueNumberTexture,E=e("./kernel-value/dynamic-number-texture").WebGL2KernelValueDynamicNumberTexture,T=e("./kernel-value/single-array").WebGL2KernelValueSingleArray,b=e("./kernel-value/dynamic-single-array").WebGL2KernelValueDynamicSingleArray,x=e("./kernel-value/single-array1d-i").WebGL2KernelValueSingleArray1DI,A=e("./kernel-value/dynamic-single-array1d-i").WebGL2KernelValueDynamicSingleArray1DI,S=e("./kernel-value/single-array2d-i").WebGL2KernelValueSingleArray2DI,R=e("./kernel-value/dynamic-single-array2d-i").WebGL2KernelValueDynamicSingleArray2DI,w=e("./kernel-value/single-array3d-i").WebGL2KernelValueSingleArray3DI,C=e("./kernel-value/dynamic-single-array3d-i").WebGL2KernelValueDynamicSingleArray3DI,O=e("./kernel-value/single-array2").WebGL2KernelValueSingleArray2,k=e("./kernel-value/single-array3").WebGL2KernelValueSingleArray3,N=e("./kernel-value/single-array4").WebGL2KernelValueSingleArray4,_=e("./kernel-value/unsigned-array").WebGL2KernelValueUnsignedArray,I={unsigned:{dynamic:{Boolean:n,Integer:a,Float:i,Array:e("./kernel-value/dynamic-unsigned-array").WebGL2KernelValueDynamicUnsignedArray,"Array(2)":!1,"Array(3)":!1,"Array(4)":!1,"Array1D(2)":!1,"Array1D(3)":!1,"Array1D(4)":!1,"Array2D(2)":!1,"Array2D(3)":!1,"Array2D(4)":!1,"Array3D(2)":!1,"Array3D(3)":!1,"Array3D(4)":!1,Input:m,NumberTexture:E,"ArrayTexture(1)":E,"ArrayTexture(2)":E,"ArrayTexture(3)":E,"ArrayTexture(4)":E,MemoryOptimizedNumberTexture:g,HTMLImage:s,HTMLImageArray:c,HTMLVideo:h},static:{Boolean:n,Float:i,Integer:a,Array:_,"Array(2)":!1,"Array(3)":!1,"Array(4)":!1,"Array1D(2)":!1,"Array1D(3)":!1,"Array1D(4)":!1,"Array2D(2)":!1,"Array2D(3)":!1,"Array2D(4)":!1,"Array3D(2)":!1,"Array3D(3)":!1,"Array3D(4)":!1,Input:d,NumberTexture:v,"ArrayTexture(1)":v,"ArrayTexture(2)":v,"ArrayTexture(3)":v,"ArrayTexture(4)":v,MemoryOptimizedNumberTexture:g,HTMLImage:o,HTMLImageArray:u,HTMLVideo:l}},single:{dynamic:{Boolean:n,Integer:a,Float:i,Array:b,"Array(2)":O,"Array(3)":k,"Array(4)":N,"Array1D(2)":A,"Array1D(3)":A,"Array1D(4)":A,"Array2D(2)":R,"Array2D(3)":R,"Array2D(4)":R,"Array3D(2)":C,"Array3D(3)":C,"Array3D(4)":C,Input:f,NumberTexture:E,"ArrayTexture(1)":E,"ArrayTexture(2)":E,"ArrayTexture(3)":E,"ArrayTexture(4)":E,MemoryOptimizedNumberTexture:g,HTMLImage:s,HTMLImageArray:c,HTMLVideo:h},static:{Boolean:n,Float:i,Integer:a,Array:T,"Array(2)":O,"Array(3)":k,"Array(4)":N,"Array1D(2)":x,"Array1D(3)":x,"Array1D(4)":x,"Array2D(2)":S,"Array2D(3)":S,"Array2D(4)":S,"Array3D(2)":w,"Array3D(3)":w,"Array3D(4)":w,Input:p,NumberTexture:v,"ArrayTexture(1)":v,"ArrayTexture(2)":v,"ArrayTexture(3)":v,"ArrayTexture(4)":v,MemoryOptimizedNumberTexture:y,HTMLImage:o,HTMLImageArray:u,HTMLVideo:l}}};t.exports={kernelValueMaps:I,lookupKernelValueType:function(e,t,r,n){if(!e)throw new Error("type missing");if(!t)throw new Error("dynamic missing");if(!r)throw new Error("precision missing");n.type&&(e=n.type);var i=I[r][t];if(!1===i[e])return null;if(void 0===i[e])throw new Error("Could not find a KernelValue for ".concat(e));return i[e]}}},{"./kernel-value/boolean":74,"./kernel-value/dynamic-html-image":76,"./kernel-value/dynamic-html-image-array":75,"./kernel-value/dynamic-html-video":77,"./kernel-value/dynamic-memory-optimized-number-texture":78,"./kernel-value/dynamic-number-texture":79,"./kernel-value/dynamic-single-array":80,"./kernel-value/dynamic-single-array1d-i":81,"./kernel-value/dynamic-single-array2d-i":82,"./kernel-value/dynamic-single-array3d-i":83,"./kernel-value/dynamic-single-input":84,"./kernel-value/dynamic-unsigned-array":85,"./kernel-value/dynamic-unsigned-input":86,"./kernel-value/float":87,"./kernel-value/html-image":89,"./kernel-value/html-image-array":88,"./kernel-value/html-video":90,"./kernel-value/integer":91,"./kernel-value/memory-optimized-number-texture":92,"./kernel-value/number-texture":93,"./kernel-value/single-array":94,"./kernel-value/single-array1d-i":95,"./kernel-value/single-array2":96,"./kernel-value/single-array2d-i":97,"./kernel-value/single-array3":98,"./kernel-value/single-array3d-i":99,"./kernel-value/single-array4":100,"./kernel-value/single-input":101,"./kernel-value/unsigned-array":102,"./kernel-value/unsigned-input":103}],74:[function(e,t,r){var n=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return r}(e("../../web-gl/kernel-value/boolean").WebGLKernelValueBoolean);t.exports={WebGL2KernelValueBoolean:n}},{"../../web-gl/kernel-value/boolean":40}],75:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){var e=this.getVariablePrecisionString();return n.linesToString(["uniform ".concat(e," sampler2DArray ").concat(this.id),"uniform ".concat(e," ivec2 ").concat(this.sizeId),"uniform ".concat(e," ivec3 ").concat(this.dimensionsId)])}},{key:"updateValue",value:function(e){var t=e[0],n=t.width,i=t.height;this.checkSize(n,i),this.dimensions=[n,i,e.length],this.textureSize=[n,i],this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),s(u(r.prototype),"updateValue",this).call(this,e)}}]),r}(e("./html-image-array").WebGL2KernelValueHTMLImageArray);t.exports={WebGL2KernelValueDynamicHTMLImageArray:i}},{"../../../utils":113,"./html-image-array":88}],76:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){var e=this.getVariablePrecisionString();return n.linesToString(["uniform ".concat(e," sampler2D ").concat(this.id),"uniform ".concat(e," ivec2 ").concat(this.sizeId),"uniform ".concat(e," ivec3 ").concat(this.dimensionsId)])}}]),r}(e("../../web-gl/kernel-value/dynamic-html-image").WebGLKernelValueDynamicHTMLImage);t.exports={WebGL2KernelValueDynamicHTMLImage:i}},{"../../../utils":113,"../../web-gl/kernel-value/dynamic-html-image":41}],77:[function(e,t,r){e("../../../utils").utils;var n=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return r}(e("./dynamic-html-image").WebGL2KernelValueDynamicHTMLImage);t.exports={WebGL2KernelValueDynamicHTMLVideo:n}},{"../../../utils":113,"./dynamic-html-image":76}],78:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){return n.linesToString(["uniform sampler2D ".concat(this.id),"uniform ivec2 ".concat(this.sizeId),"uniform ivec3 ".concat(this.dimensionsId)])}}]),r}(e("../../web-gl/kernel-value/dynamic-memory-optimized-number-texture").WebGLKernelValueDynamicMemoryOptimizedNumberTexture);t.exports={WebGL2KernelValueDynamicMemoryOptimizedNumberTexture:i}},{"../../../utils":113,"../../web-gl/kernel-value/dynamic-memory-optimized-number-texture":43}],79:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){var e=this.getVariablePrecisionString();return n.linesToString(["uniform ".concat(e," sampler2D ").concat(this.id),"uniform ".concat(e," ivec2 ").concat(this.sizeId),"uniform ".concat(e," ivec3 ").concat(this.dimensionsId)])}}]),r}(e("../../web-gl/kernel-value/dynamic-number-texture").WebGLKernelValueDynamicNumberTexture);t.exports={WebGL2KernelValueDynamicNumberTexture:i}},{"../../../utils":113,"../../web-gl/kernel-value/dynamic-number-texture":44}],80:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){var e=this.getVariablePrecisionString();return n.linesToString(["uniform ".concat(e," sampler2D ").concat(this.id),"uniform ".concat(e," ivec2 ").concat(this.sizeId),"uniform ".concat(e," ivec3 ").concat(this.dimensionsId)])}},{key:"updateValue",value:function(e){this.dimensions=n.getDimensions(e,!0),this.textureSize=n.getMemoryOptimizedFloatTextureSize(this.dimensions,this.bitRatio),this.uploadArrayLength=this.textureSize[0]*this.textureSize[1]*this.bitRatio,this.checkSize(this.textureSize[0]*this.bitRatio,this.textureSize[1]*this.bitRatio),this.uploadValue=new Float32Array(this.uploadArrayLength),this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),s(u(r.prototype),"updateValue",this).call(this,e)}}]),r}(e("../../web-gl2/kernel-value/single-array").WebGL2KernelValueSingleArray);t.exports={WebGL2KernelValueDynamicSingleArray:i}},{"../../../utils":113,"../../web-gl2/kernel-value/single-array":94}],81:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){var e=this.getVariablePrecisionString();return n.linesToString(["uniform ".concat(e," sampler2D ").concat(this.id),"uniform ".concat(e," ivec2 ").concat(this.sizeId),"uniform ".concat(e," ivec3 ").concat(this.dimensionsId)])}},{key:"updateValue",value:function(e){this.setShape(e),this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),s(u(r.prototype),"updateValue",this).call(this,e)}}]),r}(e("../../web-gl2/kernel-value/single-array1d-i").WebGL2KernelValueSingleArray1DI);t.exports={WebGL2KernelValueDynamicSingleArray1DI:i}},{"../../../utils":113,"../../web-gl2/kernel-value/single-array1d-i":95}],82:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){var e=this.getVariablePrecisionString();return n.linesToString(["uniform ".concat(e," sampler2D ").concat(this.id),"uniform ".concat(e," ivec2 ").concat(this.sizeId),"uniform ".concat(e," ivec3 ").concat(this.dimensionsId)])}},{key:"updateValue",value:function(e){this.setShape(e),this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),s(u(r.prototype),"updateValue",this).call(this,e)}}]),r}(e("../../web-gl2/kernel-value/single-array2d-i").WebGL2KernelValueSingleArray2DI);t.exports={WebGL2KernelValueDynamicSingleArray2DI:i}},{"../../../utils":113,"../../web-gl2/kernel-value/single-array2d-i":97}],83:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){var e=this.getVariablePrecisionString();return n.linesToString(["uniform ".concat(e," sampler2D ").concat(this.id),"uniform ".concat(e," ivec2 ").concat(this.sizeId),"uniform ".concat(e," ivec3 ").concat(this.dimensionsId)])}},{key:"updateValue",value:function(e){this.setShape(e),this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),s(u(r.prototype),"updateValue",this).call(this,e)}}]),r}(e("../../web-gl2/kernel-value/single-array3d-i").WebGL2KernelValueSingleArray3DI);t.exports={WebGL2KernelValueDynamicSingleArray3DI:i}},{"../../../utils":113,"../../web-gl2/kernel-value/single-array3d-i":99}],84:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){var e=this.getVariablePrecisionString();return n.linesToString(["uniform ".concat(e," sampler2D ").concat(this.id),"uniform ".concat(e," ivec2 ").concat(this.sizeId),"uniform ".concat(e," ivec3 ").concat(this.dimensionsId)])}},{key:"updateValue",value:function(e){var t=f(e.size,3),i=t[0],a=t[1],o=t[2];this.dimensions=new Int32Array([i||1,a||1,o||1]),this.textureSize=n.getMemoryOptimizedFloatTextureSize(this.dimensions,this.bitRatio),this.uploadArrayLength=this.textureSize[0]*this.textureSize[1]*this.bitRatio,this.checkSize(this.textureSize[0]*this.bitRatio,this.textureSize[1]*this.bitRatio),this.uploadValue=new Float32Array(this.uploadArrayLength),this.kernel.setUniform3iv(this.dimensionsId,this.dimensions),this.kernel.setUniform2iv(this.sizeId,this.textureSize),s(u(r.prototype),"updateValue",this).call(this,e)}}]),r}(e("../../web-gl2/kernel-value/single-input").WebGL2KernelValueSingleInput);t.exports={WebGL2KernelValueDynamicSingleInput:i}},{"../../../utils":113,"../../web-gl2/kernel-value/single-input":101}],85:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){var e=this.getVariablePrecisionString();return n.linesToString(["uniform ".concat(e," sampler2D ").concat(this.id),"uniform ".concat(e," ivec2 ").concat(this.sizeId),"uniform ".concat(e," ivec3 ").concat(this.dimensionsId)])}}]),r}(e("../../web-gl/kernel-value/dynamic-unsigned-array").WebGLKernelValueDynamicUnsignedArray);t.exports={WebGL2KernelValueDynamicUnsignedArray:i}},{"../../../utils":113,"../../web-gl/kernel-value/dynamic-unsigned-array":50}],86:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){var e=this.getVariablePrecisionString();return n.linesToString(["uniform ".concat(e," sampler2D ").concat(this.id),"uniform ".concat(e," ivec2 ").concat(this.sizeId),"uniform ".concat(e," ivec3 ").concat(this.dimensionsId)])}}]),r}(e("../../web-gl/kernel-value/dynamic-unsigned-input").WebGLKernelValueDynamicUnsignedInput);t.exports={WebGL2KernelValueDynamicUnsignedInput:i}},{"../../../utils":113,"../../web-gl/kernel-value/dynamic-unsigned-input":51}],87:[function(e,t,r){e("../../../utils").utils;var n=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return r}(e("../../web-gl/kernel-value/float").WebGLKernelValueFloat);t.exports={WebGL2KernelValueFloat:n}},{"../../../utils":113,"../../web-gl/kernel-value/float":52}],88:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(e,n){var i;return c(this,r),(i=t.call(this,e,n)).checkSize(e[0].width,e[0].height),i.requestTexture(),i.dimensions=[e[0].width,e[0].height,e.length],i.textureSize=[e[0].width,e[0].height],i}return l(r,[{key:"getStringValueHandler",value:function(){return"const uploadValue_".concat(this.name," = ").concat(this.varName,";\n")}},{key:"getSource",value:function(){var e=this.getVariablePrecisionString();return n.linesToString(["uniform ".concat(e," sampler2DArray ").concat(this.id),"".concat(e," ivec2 ").concat(this.sizeId," = ivec2(").concat(this.textureSize[0],", ").concat(this.textureSize[1],")"),"".concat(e," ivec3 ").concat(this.dimensionsId," = ivec3(").concat(this.dimensions[0],", ").concat(this.dimensions[1],", ").concat(this.dimensions[2],")")])}},{key:"updateValue",value:function(e){var t=this.context;t.activeTexture(this.contextHandle),t.bindTexture(t.TEXTURE_2D_ARRAY,this.texture),t.texParameteri(t.TEXTURE_2D_ARRAY,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D_ARRAY,t.TEXTURE_MIN_FILTER,t.NEAREST),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),t.texImage3D(t.TEXTURE_2D_ARRAY,0,t.RGBA,e[0].width,e[0].height,e.length,0,t.RGBA,t.UNSIGNED_BYTE,null);for(var r=0;r<e.length;r++)t.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,r,e[r].width,e[r].height,1,t.RGBA,t.UNSIGNED_BYTE,this.uploadValue=e[r]);this.kernel.setUniform1i(this.id,this.index)}}]),r}(e("../../web-gl/kernel-value/index").WebGLKernelValue);t.exports={WebGL2KernelValueHTMLImageArray:i}},{"../../../utils":113,"../../web-gl/kernel-value/index":55}],89:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){var e=this.getVariablePrecisionString();return n.linesToString(["uniform ".concat(e," sampler2D ").concat(this.id),"".concat(e," ivec2 ").concat(this.sizeId," = ivec2(").concat(this.textureSize[0],", ").concat(this.textureSize[1],")"),"".concat(e," ivec3 ").concat(this.dimensionsId," = ivec3(").concat(this.dimensions[0],", ").concat(this.dimensions[1],", ").concat(this.dimensions[2],")")])}}]),r}(e("../../web-gl/kernel-value/html-image").WebGLKernelValueHTMLImage);t.exports={WebGL2KernelValueHTMLImage:i}},{"../../../utils":113,"../../web-gl/kernel-value/html-image":53}],90:[function(e,t,r){e("../../../utils").utils;var n=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return r}(e("./html-image").WebGL2KernelValueHTMLImage);t.exports={WebGL2KernelValueHTMLVideo:n}},{"../../../utils":113,"./html-image":89}],91:[function(e,t,r){var n=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(e){var t=this.getVariablePrecisionString();return"constants"===this.origin?"const ".concat(t," int ").concat(this.id," = ").concat(parseInt(e),";\n"):"uniform ".concat(t," int ").concat(this.id,";\n")}},{key:"updateValue",value:function(e){"constants"!==this.origin&&this.kernel.setUniform1i(this.id,this.uploadValue=e)}}]),r}(e("../../web-gl/kernel-value/integer").WebGLKernelValueInteger);t.exports={WebGL2KernelValueInteger:n}},{"../../web-gl/kernel-value/integer":56}],92:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){var e=this.id,t=this.sizeId,r=this.textureSize,i=this.dimensionsId,a=this.dimensions,o=this.getVariablePrecisionString();return n.linesToString(["uniform sampler2D ".concat(e),"".concat(o," ivec2 ").concat(t," = ivec2(").concat(r[0],", ").concat(r[1],")"),"".concat(o," ivec3 ").concat(i," = ivec3(").concat(a[0],", ").concat(a[1],", ").concat(a[2],")")])}}]),r}(e("../../web-gl/kernel-value/memory-optimized-number-texture").WebGLKernelValueMemoryOptimizedNumberTexture);t.exports={WebGL2KernelValueMemoryOptimizedNumberTexture:i}},{"../../../utils":113,"../../web-gl/kernel-value/memory-optimized-number-texture":57}],93:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){var e=this.id,t=this.sizeId,r=this.textureSize,i=this.dimensionsId,a=this.dimensions,o=this.getVariablePrecisionString();return n.linesToString(["uniform ".concat(o," sampler2D ").concat(e),"".concat(o," ivec2 ").concat(t," = ivec2(").concat(r[0],", ").concat(r[1],")"),"".concat(o," ivec3 ").concat(i," = ivec3(").concat(a[0],", ").concat(a[1],", ").concat(a[2],")")])}}]),r}(e("../../web-gl/kernel-value/number-texture").WebGLKernelValueNumberTexture);t.exports={WebGL2KernelValueNumberTexture:i}},{"../../../utils":113,"../../web-gl/kernel-value/number-texture":58}],94:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){var e=this.getVariablePrecisionString();return n.linesToString(["uniform ".concat(e," sampler2D ").concat(this.id),"".concat(e," ivec2 ").concat(this.sizeId," = ivec2(").concat(this.textureSize[0],", ").concat(this.textureSize[1],")"),"".concat(e," ivec3 ").concat(this.dimensionsId," = ivec3(").concat(this.dimensions[0],", ").concat(this.dimensions[1],", ").concat(this.dimensions[2],")")])}},{key:"updateValue",value:function(e){if(e.constructor===this.initialValueConstructor){var t=this.context;n.flattenTo(e,this.uploadValue),t.activeTexture(this.contextHandle),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texImage2D(t.TEXTURE_2D,0,t.RGBA32F,this.textureSize[0],this.textureSize[1],0,t.RGBA,t.FLOAT,this.uploadValue),this.kernel.setUniform1i(this.id,this.index)}else this.onUpdateValueMismatch()}}]),r}(e("../../web-gl/kernel-value/single-array").WebGLKernelValueSingleArray);t.exports={WebGL2KernelValueSingleArray:i}},{"../../../utils":113,"../../web-gl/kernel-value/single-array":59}],95:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"updateValue",value:function(e){if(e.constructor===this.initialValueConstructor){var t=this.context;n.flattenTo(e,this.uploadValue),t.activeTexture(this.contextHandle),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texImage2D(t.TEXTURE_2D,0,t.RGBA32F,this.textureSize[0],this.textureSize[1],0,t.RGBA,t.FLOAT,this.uploadValue),this.kernel.setUniform1i(this.id,this.index)}else this.onUpdateValueMismatch()}}]),r}(e("../../web-gl/kernel-value/single-array1d-i").WebGLKernelValueSingleArray1DI);t.exports={WebGL2KernelValueSingleArray1DI:i}},{"../../../utils":113,"../../web-gl/kernel-value/single-array1d-i":60}],96:[function(e,t,r){var n=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return r}(e("../../web-gl/kernel-value/single-array2").WebGLKernelValueSingleArray2);t.exports={WebGL2KernelValueSingleArray2:n}},{"../../web-gl/kernel-value/single-array2":61}],97:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"updateValue",value:function(e){if(e.constructor===this.initialValueConstructor){var t=this.context;n.flattenTo(e,this.uploadValue),t.activeTexture(this.contextHandle),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texImage2D(t.TEXTURE_2D,0,t.RGBA32F,this.textureSize[0],this.textureSize[1],0,t.RGBA,t.FLOAT,this.uploadValue),this.kernel.setUniform1i(this.id,this.index)}else this.onUpdateValueMismatch()}}]),r}(e("../../web-gl/kernel-value/single-array2d-i").WebGLKernelValueSingleArray2DI);t.exports={WebGL2KernelValueSingleArray2DI:i}},{"../../../utils":113,"../../web-gl/kernel-value/single-array2d-i":62}],98:[function(e,t,r){var n=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return r}(e("../../web-gl/kernel-value/single-array3").WebGLKernelValueSingleArray3);t.exports={WebGL2KernelValueSingleArray3:n}},{"../../web-gl/kernel-value/single-array3":63}],99:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"updateValue",value:function(e){if(e.constructor===this.initialValueConstructor){var t=this.context;n.flattenTo(e,this.uploadValue),t.activeTexture(this.contextHandle),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texImage2D(t.TEXTURE_2D,0,t.RGBA32F,this.textureSize[0],this.textureSize[1],0,t.RGBA,t.FLOAT,this.uploadValue),this.kernel.setUniform1i(this.id,this.index)}else this.onUpdateValueMismatch()}}]),r}(e("../../web-gl/kernel-value/single-array3d-i").WebGLKernelValueSingleArray3DI);t.exports={WebGL2KernelValueSingleArray3DI:i}},{"../../../utils":113,"../../web-gl/kernel-value/single-array3d-i":64}],100:[function(e,t,r){var n=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return r}(e("../../web-gl/kernel-value/single-array4").WebGLKernelValueSingleArray4);t.exports={WebGL2KernelValueSingleArray4:n}},{"../../web-gl/kernel-value/single-array4":65}],101:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){var e=this.getVariablePrecisionString();return n.linesToString(["uniform ".concat(e," sampler2D ").concat(this.id),"".concat(e," ivec2 ").concat(this.sizeId," = ivec2(").concat(this.textureSize[0],", ").concat(this.textureSize[1],")"),"".concat(e," ivec3 ").concat(this.dimensionsId," = ivec3(").concat(this.dimensions[0],", ").concat(this.dimensions[1],", ").concat(this.dimensions[2],")")])}},{key:"updateValue",value:function(e){var t=this.context;n.flattenTo(e.value,this.uploadValue),t.activeTexture(this.contextHandle),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texImage2D(t.TEXTURE_2D,0,t.RGBA32F,this.textureSize[0],this.textureSize[1],0,t.RGBA,t.FLOAT,this.uploadValue),this.kernel.setUniform1i(this.id,this.index)}}]),r}(e("../../web-gl/kernel-value/single-input").WebGLKernelValueSingleInput);t.exports={WebGL2KernelValueSingleInput:i}},{"../../../utils":113,"../../web-gl/kernel-value/single-input":66}],102:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){var e=this.getVariablePrecisionString();return n.linesToString(["uniform ".concat(e," sampler2D ").concat(this.id),"".concat(e," ivec2 ").concat(this.sizeId," = ivec2(").concat(this.textureSize[0],", ").concat(this.textureSize[1],")"),"".concat(e," ivec3 ").concat(this.dimensionsId," = ivec3(").concat(this.dimensions[0],", ").concat(this.dimensions[1],", ").concat(this.dimensions[2],")")])}}]),r}(e("../../web-gl/kernel-value/unsigned-array").WebGLKernelValueUnsignedArray);t.exports={WebGL2KernelValueUnsignedArray:i}},{"../../../utils":113,"../../web-gl/kernel-value/unsigned-array":67}],103:[function(e,t,r){var n=e("../../../utils").utils,i=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"getSource",value:function(){var e=this.getVariablePrecisionString();return n.linesToString(["uniform ".concat(e," sampler2D ").concat(this.id),"".concat(e," ivec2 ").concat(this.sizeId," = ivec2(").concat(this.textureSize[0],", ").concat(this.textureSize[1],")"),"".concat(e," ivec3 ").concat(this.dimensionsId," = ivec3(").concat(this.dimensions[0],", ").concat(this.dimensions[1],", ").concat(this.dimensions[2],")")])}}]),r}(e("../../web-gl/kernel-value/unsigned-input").WebGLKernelValueUnsignedInput);t.exports={WebGL2KernelValueUnsignedInput:i}},{"../../../utils":113,"../../web-gl/kernel-value/unsigned-input":68}],104:[function(e,t,r){var n=e("../web-gl/kernel").WebGLKernel,i=e("./function-node").WebGL2FunctionNode,a=e("../function-builder").FunctionBuilder,o=e("../../utils").utils,f=e("./fragment-shader").fragmentShader,d=e("./vertex-shader").vertexShader,m=e("./kernel-value-maps").lookupKernelValueType,y=null,g=null,v=null,E=null,T=function(e){"use strict";h(r,e);var t=p(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"initContext",value:function(){return this.canvas.getContext("webgl2",{alpha:!1,depth:!1,antialias:!1})}},{key:"initExtensions",value:function(){this.extensions={EXT_color_buffer_float:this.context.getExtension("EXT_color_buffer_float"),OES_texture_float_linear:this.context.getExtension("OES_texture_float_linear")}}},{key:"validateSettings",value:function(e){if(this.validate){var t=this.constructor.features;if("single"===this.precision&&!t.isFloatRead)throw new Error("Float texture outputs are not supported");if(this.graphical||null!==this.precision||(this.precision=t.isFloatRead?"single":"unsigned"),null===this.fixIntegerDivisionAccuracy?this.fixIntegerDivisionAccuracy=!t.isIntegerDivisionAccurate:this.fixIntegerDivisionAccuracy&&t.isIntegerDivisionAccurate&&(this.fixIntegerDivisionAccuracy=!1),this.checkOutput(),!this.output||0===this.output.length){if(1!==e.length)throw new Error("Auto output only supported for kernels with only one input");var r=o.getVariableType(e[0],this.strictIntegers);switch(r){case"Array":this.output=o.getDimensions(r);break;case"NumberTexture":case"MemoryOptimizedNumberTexture":case"ArrayTexture(1)":case"ArrayTexture(2)":case"ArrayTexture(3)":case"ArrayTexture(4)":this.output=e[0].output;break;default:throw new Error("Auto output not supported for input type: "+r)}}if(this.graphical){if(2!==this.output.length)throw new Error("Output must have 2 dimensions on graphical mode");return"single"===this.precision&&(console.warn("Cannot use graphical mode and single precision at the same time"),this.precision="unsigned"),void(this.texSize=o.clone(this.output))}!this.graphical&&null===this.precision&&t.isTextureFloat&&(this.precision="single"),this.texSize=o.getKernelTextureSize({optimizeFloatMemory:this.optimizeFloatMemory,precision:this.precision},this.output),this.checkTextureSize()}else this.texSize=o.getKernelTextureSize({optimizeFloatMemory:this.optimizeFloatMemory,precision:this.precision},this.output)}},{key:"translateSource",value:function(){var e=a.fromKernel(this,i,{fixIntegerDivisionAccuracy:this.fixIntegerDivisionAccuracy});this.translatedSource=e.getPrototypeString("kernel"),this.setupReturnTypes(e)}},{key:"drawBuffers",value:function(){this.context.drawBuffers(this.drawBuffersMap)}},{key:"getTextureFormat",value:function(){var e=this.context;switch(this.getInternalFormat()){case e.R32F:return e.RED;case e.RG32F:return e.RG;case e.RGBA32F:case e.RGBA:return e.RGBA;default:throw new Error("Unknown internal format")}}},{key:"getInternalFormat",value:function(){var e=this.context;if(this.optimizeFloatMemory,this.pipeline,this.precision,"single"===this.precision){if(this.pipeline)switch(this.returnType){case"Number":case"Float":case"Integer":return this.optimizeFloatMemory?e.RGBA32F:e.R32F;case"Array(2)":return e.RG32F;case"Array(3)":case"Array(4)":return e.RGBA32F;default:throw new Error("Unhandled return type")}return e.RGBA32F}return e.RGBA}},{key:"_setupOutputTexture",value:function(){var e=this.texSize,t=this.context,r=this.outputTexture=t.createTexture();t.activeTexture(t.TEXTURE0+this.constantTextureCount+this.argumentTextureCount),t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST);var n=this.getInternalFormat();"single"===this.precision?t.texStorage2D(t.TEXTURE_2D,1,n,e[0],e[1]):t.texImage2D(t.TEXTURE_2D,0,n,e[0],e[1],0,n,t.UNSIGNED_BYTE,null),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0)}},{key:"_setupSubOutputTextures",value:function(){var e=this.texSize,t=this.context;this.drawBuffersMap=[t.COLOR_ATTACHMENT0],this.subKernelOutputTextures=[];for(var r=0;r<this.subKernels.length;r++){var n=this.createTexture();this.subKernelOutputTextures.push(n),this.drawBuffersMap.push(t.COLOR_ATTACHMENT0+r+1),t.activeTexture(t.TEXTURE0+this.constantTextureCount+this.argumentTextureCount+r),t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),"single"===this.precision?t.texImage2D(t.TEXTURE_2D,0,t.RGBA32F,e[0],e[1],0,t.RGBA,t.FLOAT,null):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e[0],e[1],0,t.RGBA,t.UNSIGNED_BYTE,null),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+r+1,t.TEXTURE_2D,n,0)}}},{key:"_getHeaderString",value:function(){return""}},{key:"_getTextureCoordinate",value:function(){var e=this.subKernels,t=this.getVariablePrecisionString(this.texSize,this.tactic);return null===e||e.length<1?"in ".concat(t," vec2 vTexCoord;\n"):"out ".concat(t," vec2 vTexCoord;\n")}},{key:"_getMainArgumentsString",value:function(e){for(var t=[],r=this.argumentNames,n=0;n<r.length;n++)t.push(this.kernelArguments[n].getSource(e[n]));return t.join("")}},{key:"getKernelString",value:function(){var e=[],t=this.subKernels;if(null!==t){e.push(this.getKernelResultDeclaration(),"layout(location = 0) out vec4 data0");for(var r=0;r<t.length;r++){var n=t[r];e.push("Integer"===n.returnType?"int subKernelResult_".concat(n.name," = 0"):"float subKernelResult_".concat(n.name," = 0.0"),"layout(location = ".concat(r+1,") out vec4 data").concat(r+1))}}else e.push("out vec4 data0",this.getKernelResultDeclaration());return o.linesToString(e)+this.translatedSource}},{key:"getMainResultGraphical",value:function(){return o.linesToString(["  threadId = indexTo3D(index, uOutputDim)","  kernel()","  data0 = actualColor"])}},{key:"getMainResultPackedPixels",value:function(){switch(this.returnType){case"LiteralInteger":case"Number":case"Integer":case"Float":return this.getMainResultKernelPackedPixels()+this.getMainResultSubKernelPackedPixels();default:throw new Error('packed output only usable with Numbers, "'.concat(this.returnType,'" specified'))}}},{key:"getMainResultKernelPackedPixels",value:function(){return o.linesToString(["  threadId = indexTo3D(index, uOutputDim)","  kernel()","  data0 = ".concat(this.useLegacyEncoder?"legacyEncode32":"encode32","(kernelResult)")])}},{key:"getMainResultSubKernelPackedPixels",value:function(){var e=[];if(!this.subKernels)return"";for(var t=0;t<this.subKernels.length;t++)"Integer"===this.subKernels[t].returnType?e.push("  data".concat(t+1," = ").concat(this.useLegacyEncoder?"legacyEncode32":"encode32","(float(subKernelResult_").concat(this.subKernels[t].name,"))")):e.push("  data".concat(t+1," = ").concat(this.useLegacyEncoder?"legacyEncode32":"encode32","(subKernelResult_").concat(this.subKernels[t].name,")"));return o.linesToString(e)}},{key:"getMainResultKernelMemoryOptimizedFloats",value:function(e,t){e.push("  threadId = indexTo3D(index, uOutputDim)","  kernel()","  data0.".concat(t," = kernelResult"))}},{key:"getMainResultSubKernelMemoryOptimizedFloats",value:function(e,t){if(!this.subKernels)return e;for(var r=0;r<this.subKernels.length;r++){var n=this.subKernels[r];"Integer"===n.returnType?e.push("  data".concat(r+1,".").concat(t," = float(subKernelResult_").concat(n.name,")")):e.push("  data".concat(r+1,".").concat(t," = subKernelResult_").concat(n.name))}}},{key:"getMainResultKernelNumberTexture",value:function(){return["  threadId = indexTo3D(index, uOutputDim)","  kernel()","  data0[0] = kernelResult"]}},{key:"getMainResultSubKernelNumberTexture",value:function(){var e=[];if(!this.subKernels)return e;for(var t=0;t<this.subKernels.length;++t){var r=this.subKernels[t];"Integer"===r.returnType?e.push("  data".concat(t+1,"[0] = float(subKernelResult_").concat(r.name,")")):e.push("  data".concat(t+1,"[0] = subKernelResult_").concat(r.name))}return e}},{key:"getMainResultKernelArray2Texture",value:function(){return["  threadId = indexTo3D(index, uOutputDim)","  kernel()","  data0[0] = kernelResult[0]","  data0[1] = kernelResult[1]"]}},{key:"getMainResultSubKernelArray2Texture",value:function(){var e=[];if(!this.subKernels)return e;for(var t=0;t<this.subKernels.length;++t){var r=this.subKernels[t];e.push("  data".concat(t+1,"[0] = subKernelResult_").concat(r.name,"[0]"),"  data".concat(t+1,"[1] = subKernelResult_").concat(r.name,"[1]"))}return e}},{key:"getMainResultKernelArray3Texture",value:function(){return["  threadId = indexTo3D(index, uOutputDim)","  kernel()","  data0[0] = kernelResult[0]","  data0[1] = kernelResult[1]","  data0[2] = kernelResult[2]"]}},{key:"getMainResultSubKernelArray3Texture",value:function(){var e=[];if(!this.subKernels)return e;for(var t=0;t<this.subKernels.length;++t){var r=this.subKernels[t];e.push("  data".concat(t+1,"[0] = subKernelResult_").concat(r.name,"[0]"),"  data".concat(t+1,"[1] = subKernelResult_").concat(r.name,"[1]"),"  data".concat(t+1,"[2] = subKernelResult_").concat(r.name,"[2]"))}return e}},{key:"getMainResultKernelArray4Texture",value:function(){return["  threadId = indexTo3D(index, uOutputDim)","  kernel()","  data0 = kernelResult"]}},{key:"getMainResultSubKernelArray4Texture",value:function(){var e=[];if(!this.subKernels)return e;for(var t=0;t<this.subKernels.length;++t)e.push("  data".concat(t+1," = subKernelResult_").concat(this.subKernels[t].name));return e}},{key:"destroyExtensions",value:function(){this.extensions.EXT_color_buffer_float=null,this.extensions.OES_texture_float_linear=null}},{key:"toJSON",value:function(){var e=s(u(r.prototype),"toJSON",this).call(this);return e.functionNodes=a.fromKernel(this,i).toJSON(),e.settings.threadDim=this.threadDim,e}}],[{key:"setupFeatureChecks",value:function(){"undefined"!=typeof document?g=document.createElement("canvas"):"undefined"!=typeof OffscreenCanvas&&(g=new OffscreenCanvas(0,0)),g&&(v=g.getContext("webgl2"))&&v.getExtension&&(v.getExtension("EXT_color_buffer_float"),v.getExtension("OES_texture_float_linear"),E=this.getFeatures())}},{key:"isContextMatch",value:function(e){return"undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext}},{key:"getFeatures",value:function(){var e=this.testContext;return Object.freeze({isFloatRead:this.getIsFloatRead(),isIntegerDivisionAccurate:this.getIsIntegerDivisionAccurate(),kernelMap:!0,isTextureFloat:!0,isDrawBuffers:!0,channelCount:this.getChannelCount(),maxTextureSize:this.getMaxTextureSize(),lowIntPrecision:e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.LOW_INT),lowFloatPrecision:e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.LOW_FLOAT),mediumIntPrecision:e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_INT),mediumFloatPrecision:e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT),highIntPrecision:e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_INT),highFloatPrecision:e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT)})}},{key:"getIsTextureFloat",value:function(){return!0}},{key:"getIsIntegerDivisionAccurate",value:function(){return s(u(r),"getIsIntegerDivisionAccurate",this).call(this)}},{key:"getChannelCount",value:function(){return v.getParameter(v.MAX_DRAW_BUFFERS)}},{key:"getMaxTextureSize",value:function(){return v.getParameter(v.MAX_TEXTURE_SIZE)}},{key:"lookupKernelValueType",value:function(e,t,r,n){return m(e,t,r,n)}},{key:"isSupported",get:function(){return null!==y?y:(this.setupFeatureChecks(),y=this.isContextMatch(v))}},{key:"testCanvas",get:function(){return g}},{key:"testContext",get:function(){return v}},{key:"features",get:function(){return E}},{key:"fragmentShader",get:function(){return f}},{key:"vertexShader",get:function(){return d}}]),r}(n);t.exports={WebGL2Kernel:T}},{"../../utils":113,"../function-builder":9,"../web-gl/kernel":69,"./fragment-shader":71,"./function-node":72,"./kernel-value-maps":73,"./vertex-shader":105}],105:[function(e,t,r){t.exports={vertexShader:"#version 300 es\n__FLOAT_TACTIC_DECLARATION__;\n__INT_TACTIC_DECLARATION__;\n__SAMPLER_2D_TACTIC_DECLARATION__;\n\nin vec2 aPos;\nin vec2 aTexCoord;\n\nout vec2 vTexCoord;\nuniform vec2 ratio;\n\nvoid main(void) {\n  gl_Position = vec4((aPos + vec2(1)) * ratio + vec2(-1), 0, 1);\n  vTexCoord = aTexCoord;\n}"}},{}],106:[function(e,t,r){var n=e("./index"),i=n.GPU;for(var a in n)n.hasOwnProperty(a)&&"GPU"!==a&&(i[a]=n[a]);t.exports=i},{"./index":108}],107:[function(e,t,r){var n=e("gpu-mock.js").gpuMock,i=e("./utils").utils,a=e("./backend/cpu/kernel").CPUKernel,o=e("./backend/headless-gl/kernel").HeadlessGLKernel,s=e("./backend/web-gl2/kernel").WebGL2Kernel,u=e("./backend/web-gl/kernel").WebGLKernel,h=e("./kernel-run-shortcut").kernelRunShortcut,p=[o,s,u],f=["gpu","cpu"],m={headlessgl:o,webgl2:s,webgl:u},y=!0,g=function(){"use strict";function e(t){if(c(this,e),t=t||{},this.canvas=t.canvas||null,this.context=t.context||null,this.mode=t.mode,this.Kernel=null,this.kernels=[],this.functions=[],this.nativeFunctions=[],this.injectedNative=null,this.onIstanbulCoverageVariable=t.onIstanbulCoverageVariable||null,this.removeIstanbulCoverage=t.hasOwnProperty("removeIstanbulCoverage")?t.removeIstanbulCoverage:null,"dev"!==this.mode){if(this.chooseKernel(),t.functions)for(var r=0;r<t.functions.length;r++)this.addFunction(t.functions[r]);if(t.nativeFunctions)for(var n in t.nativeFunctions)t.nativeFunctions.hasOwnProperty(n)&&this.addNativeFunction(n,t.nativeFunctions[n])}}return l(e,null,[{key:"disableValidation",value:function(){y=!1}},{key:"enableValidation",value:function(){y=!0}},{key:"isGPUSupported",get:function(){return p.some((function(e){return e.isSupported}))}},{key:"isKernelMapSupported",get:function(){return p.some((function(e){return e.isSupported&&e.features.kernelMap}))}},{key:"isOffscreenCanvasSupported",get:function(){return"undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas||"undefined"!=typeof importScripts}},{key:"isWebGLSupported",get:function(){return u.isSupported}},{key:"isWebGL2Supported",get:function(){return s.isSupported}},{key:"isHeadlessGLSupported",get:function(){return o.isSupported}},{key:"isCanvasSupported",get:function(){return"undefined"!=typeof HTMLCanvasElement}},{key:"isGPUHTMLImageArraySupported",get:function(){return s.isSupported}},{key:"isSinglePrecisionSupported",get:function(){return p.some((function(e){return e.isSupported&&e.features.isFloatRead&&e.features.isTextureFloat}))}}]),l(e,[{key:"chooseKernel",value:function(){if(!this.Kernel){var e=null;if(this.context){for(var t=0;t<p.length;t++){var r=p[t];if(r.isContextMatch(this.context)){if(!r.isSupported)throw new Error("Kernel type ".concat(r.name," not supported"));e=r;break}}if(null===e)throw new Error("unknown Context")}else if(this.mode){if(this.mode in m)y&&!m[this.mode].isSupported||(e=m[this.mode]);else if("gpu"===this.mode){for(var n=0;n<p.length;n++)if(p[n].isSupported){e=p[n];break}}else"cpu"===this.mode&&(e=a);if(!e)throw new Error('A requested mode of "'.concat(this.mode,'" and is not supported'))}else{for(var i=0;i<p.length;i++)if(p[i].isSupported){e=p[i];break}e||(e=a)}this.mode||(this.mode=e.mode),this.Kernel=e}}},{key:"createKernel",value:function(e,t){if(void 0===e)throw new Error("Missing source parameter");if("object"!==d(e)&&!i.isFunction(e)&&"string"!=typeof e)throw new Error("source parameter not a function");if("dev"===this.mode){var r=n(e,v(t));return this.kernels.push(r),r}e="function"==typeof e?e.toString():e;var o={},s=v(t)||{};function u(t){console.warn("Falling back to CPU");var r=new a(e,{argumentTypes:l.argumentTypes,constantTypes:l.constantTypes,graphical:l.graphical,loopMaxIterations:l.loopMaxIterations,constants:l.constants,dynamicOutput:l.dynamicOutput,dynamicArgument:l.dynamicArguments,output:l.output,precision:l.precision,pipeline:l.pipeline,immutable:l.immutable,optimizeFloatMemory:l.optimizeFloatMemory,fixIntegerDivisionAccuracy:l.fixIntegerDivisionAccuracy,functions:l.functions,nativeFunctions:l.nativeFunctions,injectedNative:l.injectedNative,subKernels:l.subKernels,strictIntegers:l.strictIntegers,debug:l.debug,warnVarUsage:l.warnVarUsage});r.build.apply(r,t);var n=r.run.apply(r,t);return l.replaceKernel(r),n}t&&"object"===d(t.argumentTypes)&&(s.argumentTypes=Object.keys(t.argumentTypes).map((function(e){return t.argumentTypes[e]})));var c=Object.assign({context:this.context,canvas:this.canvas,functions:this.functions,nativeFunctions:this.nativeFunctions,injectedNative:this.injectedNative,onIstanbulCoverageVariable:this.onIstanbulCoverageVariable,removeIstanbulCoverage:this.removeIstanbulCoverage,gpu:this,validate:y,onRequestFallback:u,onRequestSwitchKernel:function t(r,n,a){console.warn("Switching kernels");var s=null;if(a.dynamicOutput)for(var c=r.length-1;c>=0;c--){var h=r[c];"outputPrecisionMismatch"===h.type&&(s=h.needed)}for(var p=new Array(n.length),f=0;f<n.length;f++){var d=n[f],m=a.argumentTypes[f];if(d.type)p[f]=d.type;else switch(m){case"Number":case"Integer":case"Float":case"ArrayTexture(1)":p[f]=i.getVariableType(d);break;default:p[f]=m}}var g=a.getVariablePrecisionString()+(p.length>0?":"+p.join(","):""),v=o[g];if(v)return v;var E=o[g]=new a.constructor(e,{argumentTypes:p,constantTypes:a.constantTypes,graphical:a.graphical,loopMaxIterations:a.loopMaxIterations,constants:a.constants,dynamicOutput:a.dynamicOutput,dynamicArgument:a.dynamicArguments,context:a.context,canvas:a.canvas,output:s||a.output,precision:a.precision,pipeline:a.pipeline,immutable:a.immutable,optimizeFloatMemory:a.optimizeFloatMemory,fixIntegerDivisionAccuracy:a.fixIntegerDivisionAccuracy,functions:a.functions,nativeFunctions:a.nativeFunctions,injectedNative:a.injectedNative,subKernels:a.subKernels,strictIntegers:a.strictIntegers,debug:a.debug,gpu:a.gpu,validate:y,warnVarUsage:a.warnVarUsage,returnType:a.returnType,onIstanbulCoverageVariable:a.onIstanbulCoverageVariable,removeIstanbulCoverage:a.removeIstanbulCoverage,tactic:a.tactic,onRequestFallback:u,onRequestSwitchKernel:t});return E.build.apply(E,n),l.replaceKernel(E),E}},s),l=h(new this.Kernel(e,c));return this.canvas||(this.canvas=l.canvas),this.context||(this.context=l.context),this.kernels.push(l),l}},{key:"createKernelMap",value:function(){var e,t;if("function"==typeof arguments[arguments.length-2]?(e=arguments[arguments.length-2],t=arguments[arguments.length-1]):e=arguments[arguments.length-1],"dev"!==this.mode&&(!this.Kernel.isSupported||!this.Kernel.features.kernelMap)&&this.mode&&f.indexOf(this.mode)<0)throw new Error("kernelMap not supported on ".concat(this.Kernel.name));var r=v(t);if(t&&"object"===d(t.argumentTypes)&&(r.argumentTypes=Object.keys(t.argumentTypes).map((function(e){return t.argumentTypes[e]}))),Array.isArray(arguments[0])){r.subKernels=[];for(var n=arguments[0],a=0;a<n.length;a++){var o=n[a].toString(),s=i.getFunctionNameFromString(o);r.subKernels.push({name:s,source:o,property:a})}}else{r.subKernels=[];var u=arguments[0];for(var c in u)if(u.hasOwnProperty(c)){var l=u[c].toString(),h=i.getFunctionNameFromString(l);r.subKernels.push({name:h||c,source:l,property:c})}}return this.createKernel(e,r)}},{key:"combineKernels",value:function(){var e=arguments[0],t=arguments[arguments.length-1];if("cpu"===e.kernel.constructor.mode)return t;for(var r=arguments[0].canvas,n=arguments[0].context,i=arguments.length-1,a=0;a<i;a++)arguments[a].setCanvas(r).setContext(n).setPipeline(!0);return function(){var e=t.apply(this,arguments);return e.toArray?e.toArray():e}}},{key:"addFunction",value:function(e,t){return this.functions.push(i.functionToIFunction(e,t)),this}},{key:"addNativeFunction",value:function(e,t,r){if(this.kernels.length>0)throw new Error('Cannot call "addNativeFunction" after "createKernels" has been called.');r=r||{};var n=this.Kernel.nativeFunctionArguments(t)||{},i=n.argumentTypes,a=n.argumentNames;return this.nativeFunctions.push({name:e,source:t,settings:r,argumentTypes:i,argumentNames:a,returnType:r.returnType||this.Kernel.nativeFunctionReturnType(t)}),this}},{key:"injectNative",value:function(e){return this.injectedNative=e,this}},{key:"destroy",value:function(){var e=this;this.kernels&&setTimeout((function(){for(var t=0;t<e.kernels.length;t++)e.kernels[t].destroy(!0);var r=e.kernels[0];r&&(r.kernel&&(r=r.kernel),r.constructor.destroyContext&&r.constructor.destroyContext(e.context))}),0)}}]),e}();function v(e){if(!e)return{};var t=Object.assign({},e);return e.hasOwnProperty("floatOutput")&&(i.warnDeprecated("setting","floatOutput","precision"),t.precision=e.floatOutput?"single":"unsigned"),e.hasOwnProperty("outputToTexture")&&(i.warnDeprecated("setting","outputToTexture","pipeline"),t.pipeline=Boolean(e.outputToTexture)),e.hasOwnProperty("outputImmutable")&&(i.warnDeprecated("setting","outputImmutable","immutable"),t.immutable=Boolean(e.outputImmutable)),e.hasOwnProperty("floatTextures")&&(i.warnDeprecated("setting","floatTextures","optimizeFloatMemory"),t.optimizeFloatMemory=Boolean(e.floatTextures)),t}t.exports={GPU:g,kernelOrder:p,kernelTypes:f}},{"./backend/cpu/kernel":8,"./backend/headless-gl/kernel":34,"./backend/web-gl/kernel":69,"./backend/web-gl2/kernel":104,"./kernel-run-shortcut":110,"./utils":113,"gpu-mock.js":4}],108:[function(e,t,r){var n=e("./gpu").GPU,i=e("./alias").alias,a=e("./utils").utils,o=e("./input"),s=o.Input,u=o.input,c=e("./texture").Texture,l=e("./backend/function-builder").FunctionBuilder,h=e("./backend/function-node").FunctionNode,p=e("./backend/cpu/function-node").CPUFunctionNode,f=e("./backend/cpu/kernel").CPUKernel,d=e("./backend/headless-gl/kernel").HeadlessGLKernel,m=e("./backend/web-gl/function-node").WebGLFunctionNode,y=e("./backend/web-gl/kernel").WebGLKernel,g=e("./backend/web-gl/kernel-value-maps").kernelValueMaps,v=e("./backend/web-gl2/function-node").WebGL2FunctionNode,E=e("./backend/web-gl2/kernel").WebGL2Kernel,T=e("./backend/web-gl2/kernel-value-maps").kernelValueMaps,b=e("./backend/gl/kernel").GLKernel,x=e("./backend/kernel").Kernel,A=e("./backend/function-tracer").FunctionTracer,S=e("./plugins/math-random-uniformly-distributed");t.exports={alias:i,CPUFunctionNode:p,CPUKernel:f,GPU:n,FunctionBuilder:l,FunctionNode:h,HeadlessGLKernel:d,Input:s,input:u,Texture:c,utils:a,WebGL2FunctionNode:v,WebGL2Kernel:E,webGL2KernelValueMaps:T,WebGLFunctionNode:m,WebGLKernel:y,webGLKernelValueMaps:g,GLKernel:b,Kernel:x,FunctionTracer:A,plugins:{mathRandom:S}}},{"./alias":5,"./backend/cpu/function-node":6,"./backend/cpu/kernel":8,"./backend/function-builder":9,"./backend/function-node":10,"./backend/function-tracer":11,"./backend/gl/kernel":13,"./backend/headless-gl/kernel":34,"./backend/kernel":36,"./backend/web-gl/function-node":38,"./backend/web-gl/kernel":69,"./backend/web-gl/kernel-value-maps":39,"./backend/web-gl2/function-node":72,"./backend/web-gl2/kernel":104,"./backend/web-gl2/kernel-value-maps":73,"./gpu":107,"./input":109,"./plugins/math-random-uniformly-distributed":111,"./texture":112,"./utils":113}],109:[function(e,t,r){var n=function(){"use strict";function t(e,r){c(this,t),this.value=e,Array.isArray(r)?this.size=r:(this.size=new Int32Array(3),r.z?this.size=new Int32Array([r.x,r.y,r.z]):r.y?this.size=new Int32Array([r.x,r.y]):this.size=new Int32Array([r.x]));var n=f(this.size,3),i=n[0],a=n[1],o=n[2];if(o){if(this.value.length!==i*a*o)throw new Error("Input size ".concat(this.value.length," does not match ").concat(i," * ").concat(a," * ").concat(o," = ").concat(a*i*o))}else if(a){if(this.value.length!==i*a)throw new Error("Input size ".concat(this.value.length," does not match ").concat(i," * ").concat(a," = ").concat(a*i))}else if(this.value.length!==i)throw new Error("Input size ".concat(this.value.length," does not match ").concat(i))}return l(t,[{key:"toArray",value:function(){var t=e("./utils").utils,r=f(this.size,3),n=r[0],i=r[1],a=r[2];return a?t.erectMemoryOptimized3DFloat(this.value.subarray?this.value:new Float32Array(this.value),n,i,a):i?t.erectMemoryOptimized2DFloat(this.value.subarray?this.value:new Float32Array(this.value),n,i):this.value}}]),t}();t.exports={Input:n,input:function(e,t){return new n(e,t)}}},{"./utils":113}],110:[function(e,t,r){var n=e("./utils").utils;function i(e,t){for(var r=n.allPropertiesOf(e),i=function(n){var i=r[n];if("_"===i[0]&&"_"===i[1])return"continue";"function"==typeof e[i]?"add"===i.substring(0,3)||"set"===i.substring(0,3)?t[i]=function(){return e[i].apply(e,arguments),t}:"toString"===i?t.toString=function(){return e.toString.apply(e,arguments)}:t[i]=e[i].bind(e):(t.__defineGetter__(i,(function(){return e[i]})),t.__defineSetter__(i,(function(t){e[i]=t})))},a=0;a<r.length;a++)i(a)}t.exports={kernelRunShortcut:function(e){var t=function(){return e.build.apply(e,arguments),(t=function(){var t=e.run.apply(e,arguments);if(e.switchingKernels){var r=e.resetSwitchingKernels(),n=e.onRequestSwitchKernel(r,arguments,e);t=n.run.apply(n,arguments)}return e.renderKernels?e.renderKernels():e.renderOutput?e.renderOutput():t}).apply(e,arguments)},r=function(){return t.apply(e,arguments)};return r.exec=function(){var e=arguments,r=this;return new Promise((function(n,i){try{n(t.apply(r,e))}catch(e){i(e)}}))},r.replaceKernel=function(t){i(e=t,r),r.kernel=e},i(e,r),r.kernel=e,r}}},{"./utils":113}],111:[function(e,t,r){var n={name:"math-random-uniformly-distributed",onBeforeRun:function(e){e.setUniform1f("randomSeed1",Math.random()),e.setUniform1f("randomSeed2",Math.random())},functionMatch:"Math.random()",functionReplace:"nrand(vTexCoord)",functionReturnType:"Number",source:"// https://www.shadertoy.com/view/4t2SDh\n//note: uniformly distributed, normalized rand, [0,1]\nhighp float randomSeedShift = 1.0;\nhighp float slide = 1.0;\nuniform highp float randomSeed1;\nuniform highp float randomSeed2;\n\nhighp float nrand(highp vec2 n) {\n  highp float result = fract(sin(dot((n.xy + 1.0) * vec2(randomSeed1 * slide, randomSeed2 * randomSeedShift), vec2(12.9898, 78.233))) * 43758.5453);\n  randomSeedShift = result;\n  if (randomSeedShift > 0.5) {\n    slide += 0.00009; \n  } else {\n    slide += 0.0009;\n  }\n  return result;\n}"};t.exports=n},{}],112:[function(e,t,r){var n=function(){"use strict";function e(t){c(this,e);var r=t.texture,n=t.size,i=t.dimensions,a=t.output,o=t.context,s=t.type,u=void 0===s?"NumberTexture":s,l=t.kernel,h=t.internalFormat,p=t.textureFormat;if(!a)throw new Error('settings property "output" required.');if(!o)throw new Error('settings property "context" required.');this.texture=r,this.size=n,this.dimensions=i,this.output=a,this.context=o,this.kernel=l,this.type=u,this._deleted=!1,this.internalFormat=h,this.textureFormat=p}return l(e,[{key:"toArray",value:function(){throw new Error("Not implemented on ".concat(this.constructor.name))}},{key:"clone",value:function(){throw new Error("Not implemented on ".concat(this.constructor.name))}},{key:"delete",value:function(){return this._deleted=!0,this.context.deleteTexture(this.texture)}}]),e}();t.exports={Texture:n}},{}],113:[function(e,t,r){var n=e("acorn"),i=e("./input").Input,a=e("./texture").Texture,o=/function ([^(]*)/,s=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,u=/([^\s,]+)/g,c={systemEndianness:function(){return l},getSystemEndianness:function(){var e=new ArrayBuffer(4),t=new Uint32Array(e),r=new Uint8Array(e);if(t[0]=3735928559,239===r[0])return"LE";if(222===r[0])return"BE";throw new Error("unknown endianness")},isFunction:function(e){return"function"==typeof e},isFunctionString:function(e){return"string"==typeof e&&"function"===e.slice(0,"function".length).toLowerCase()},getFunctionNameFromString:function(e){return o.exec(e)[1].trim()},getFunctionBodyFromString:function(e){return e.substring(e.indexOf("{")+1,e.lastIndexOf("}"))},getArgumentNamesFromString:function(e){var t=e.replace(s,""),r=t.slice(t.indexOf("(")+1,t.indexOf(")")).match(u);return null===r&&(r=[]),r},clone:function(e){if(null===e||"object"!==d(e)||e.hasOwnProperty("isActiveClone"))return e;var t=e.constructor();for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e.isActiveClone=null,t[r]=c.clone(e[r]),delete e.isActiveClone);return t},isArray:function(e){return!isNaN(e.length)},getVariableType:function(e,t){if(c.isArray(e))return"IMG"===e[0].nodeName?"HTMLImageArray":"Array";switch(e.constructor){case Boolean:return"Boolean";case Number:return t&&Number.isInteger(e)?"Integer":"Float";case a:return e.type;case i:return"Input"}switch(e.nodeName){case"IMG":return"HTMLImage";case"VIDEO":return"HTMLVideo"}return e.hasOwnProperty("type")?e.type:"Unknown"},getKernelTextureSize:function(e,t){var r=f(t,3),n=r[0],i=r[1],a=(n||1)*(i||1)*(r[2]||1);return e.optimizeFloatMemory&&"single"===e.precision&&(n=a=Math.ceil(a/4)),i>1&&n*i===a?new Int32Array([n,i]):c.closestSquareDimensions(a)},closestSquareDimensions:function(e){for(var t=Math.sqrt(e),r=Math.ceil(t),n=Math.floor(t);r*n<e;)r--,n=Math.ceil(e/r);return new Int32Array([n,Math.ceil(e/n)])},getMemoryOptimizedFloatTextureSize:function(e,t){var r=c.roundTo((e[0]||1)*(e[1]||1)*(e[2]||1)*(e[3]||1),4)/t;return c.closestSquareDimensions(r)},getMemoryOptimizedPackedTextureSize:function(e,t){var r=f(e,3),n=r[0],i=r[1],a=r[2],o=c.roundTo((n||1)*(i||1)*(a||1),4)/(4/t);return c.closestSquareDimensions(o)},roundTo:function(e,t){return Math.floor((e+t-1)/t)*t},getDimensions:function(e,t){var r;if(c.isArray(e)){for(var n=[],o=e;c.isArray(o);)n.push(o.length),o=o[0];r=n.reverse()}else if(e instanceof a)r=e.output;else{if(!(e instanceof i))throw new Error("Unknown dimensions of ".concat(e));r=e.size}if(t)for(r=Array.from(r);r.length<3;)r.push(1);return new Int32Array(r)},flatten2dArrayTo:function(e,t){for(var r=0,n=0;n<e.length;n++)t.set(e[n],r),r+=e[n].length},flatten3dArrayTo:function(e,t){for(var r=0,n=0;n<e.length;n++)for(var i=0;i<e[n].length;i++)t.set(e[n][i],r),r+=e[n][i].length},flatten4dArrayTo:function(e,t){for(var r=0,n=0;n<e.length;n++)for(var i=0;i<e[n].length;i++)for(var a=0;a<e[n][i].length;a++)t.set(e[n][i][a],r),r+=e[n][i][a].length},flattenTo:function(e,t){c.isArray(e[0])?c.isArray(e[0][0])?c.isArray(e[0][0][0])?c.flatten4dArrayTo(e,t):c.flatten3dArrayTo(e,t):c.flatten2dArrayTo(e,t):t.set(e)},splitArray:function(e,t){for(var r=[],n=0;n<e.length;n+=t)r.push(new e.constructor(e.buffer,4*n+e.byteOffset,t));return r},getAstString:function(e,t){var r=Array.isArray(e)?e:e.split(/\r?\n/g),n=t.loc.start,i=t.loc.end,a=[];if(n.line===i.line)a.push(r[n.line-1].substring(n.column,i.column));else{a.push(r[n.line-1].slice(n.column));for(var o=n.line;o<i.line;o++)a.push(r[o]);a.push(r[i.line-1].slice(0,i.column))}return a.join("\n")},allPropertiesOf:function(e){var t=[];do{t.push.apply(t,Object.getOwnPropertyNames(e))}while(e=Object.getPrototypeOf(e));return t},linesToString:function(e){return e.length>0?e.join(";\n")+";\n":"\n"},warnDeprecated:function(e,t,r){r?console.warn("You are using a deprecated ".concat(e,' "').concat(t,'". It has been replaced with "').concat(r,'". Fixing, but please upgrade as it will soon be removed.')):console.warn("You are using a deprecated ".concat(e,' "').concat(t,'". It has been removed. Fixing, but please upgrade as it will soon be removed.'))},functionToIFunction:function(e,t){if(t=t||{},"string"!=typeof e&&"function"!=typeof e)throw new Error("source not a string or function");var r="string"==typeof e?e:e.toString();return{source:r,argumentTypes:Array.isArray(t.argumentTypes)?t.argumentTypes:"object"===d(t.argumentTypes)?c.getArgumentNamesFromString(r).map((function(e){return t.argumentTypes[e]}))||[]:t.argumentTypes||[],returnType:t.returnType||null}},flipPixels:function(e,t,r){for(var n=r/2|0,i=4*t,a=new Uint8ClampedArray(4*t),o=e.slice(0),s=0;s<n;++s){var u=s*i,c=(r-s-1)*i;a.set(o.subarray(u,u+i)),o.copyWithin(u,c,c+i),o.set(a,c)}return o},erectPackedFloat:function(e,t){return e.subarray(0,t)},erect2DPackedFloat:function(e,t,r){for(var n=new Array(r),i=0;i<r;i++){var a=i*t,o=a+t;n[i]=e.subarray(a,o)}return n},erect3DPackedFloat:function(e,t,r,n){for(var i=new Array(n),a=0;a<n;a++){for(var o=new Array(r),s=0;s<r;s++){var u=a*r*t+s*t,c=u+t;o[s]=e.subarray(u,c)}i[a]=o}return i},erectMemoryOptimizedFloat:function(e,t){return e.subarray(0,t)},erectMemoryOptimized2DFloat:function(e,t,r){for(var n=new Array(r),i=0;i<r;i++){var a=i*t;n[i]=e.subarray(a,a+t)}return n},erectMemoryOptimized3DFloat:function(e,t,r,n){for(var i=new Array(n),a=0;a<n;a++){for(var o=new Array(r),s=0;s<r;s++){var u=a*r*t+s*t;o[s]=e.subarray(u,u+t)}i[a]=o}return i},erectFloat:function(e,t){for(var r=new Float32Array(t),n=0,i=0;i<t;i++)r[i]=e[n],n+=4;return r},erect2DFloat:function(e,t,r){for(var n=new Array(r),i=0,a=0;a<r;a++){for(var o=new Float32Array(t),s=0;s<t;s++)o[s]=e[i],i+=4;n[a]=o}return n},erect3DFloat:function(e,t,r,n){for(var i=new Array(n),a=0,o=0;o<n;o++){for(var s=new Array(r),u=0;u<r;u++){for(var c=new Float32Array(t),l=0;l<t;l++)c[l]=e[a],a+=4;s[u]=c}i[o]=s}return i},erectArray2:function(e,t){for(var r=new Array(t),n=4*t,i=0,a=0;a<n;a+=4)r[i++]=e.subarray(a,a+2);return r},erect2DArray2:function(e,t,r){for(var n=new Array(r),i=4*t,a=0;a<r;a++){for(var o=new Array(t),s=a*i,u=0,c=0;c<i;c+=4)o[u++]=e.subarray(c+s,c+s+2);n[a]=o}return n},erect3DArray2:function(e,t,r,n){for(var i=4*t,a=new Array(n),o=0;o<n;o++){for(var s=new Array(r),u=0;u<r;u++){for(var c=new Array(t),l=o*i*r+u*i,h=0,p=0;p<i;p+=4)c[h++]=e.subarray(p+l,p+l+2);s[u]=c}a[o]=s}return a},erectArray3:function(e,t){for(var r=new Array(t),n=4*t,i=0,a=0;a<n;a+=4)r[i++]=e.subarray(a,a+3);return r},erect2DArray3:function(e,t,r){for(var n=4*t,i=new Array(r),a=0;a<r;a++){for(var o=new Array(t),s=a*n,u=0,c=0;c<n;c+=4)o[u++]=e.subarray(c+s,c+s+3);i[a]=o}return i},erect3DArray3:function(e,t,r,n){for(var i=4*t,a=new Array(n),o=0;o<n;o++){for(var s=new Array(r),u=0;u<r;u++){for(var c=new Array(t),l=o*i*r+u*i,h=0,p=0;p<i;p+=4)c[h++]=e.subarray(p+l,p+l+3);s[u]=c}a[o]=s}return a},erectArray4:function(e,t){for(var r=new Array(e),n=4*t,i=0,a=0;a<n;a+=4)r[i++]=e.subarray(a,a+4);return r},erect2DArray4:function(e,t,r){for(var n=4*t,i=new Array(r),a=0;a<r;a++){for(var o=new Array(t),s=a*n,u=0,c=0;c<n;c+=4)o[u++]=e.subarray(c+s,c+s+4);i[a]=o}return i},erect3DArray4:function(e,t,r,n){for(var i=4*t,a=new Array(n),o=0;o<n;o++){for(var s=new Array(r),u=0;u<r;u++){for(var c=new Array(t),l=o*i*r+u*i,h=0,p=0;p<i;p+=4)c[h++]=e.subarray(p+l,p+l+4);s[u]=c}a[o]=s}return a},flattenFunctionToString:function(e,t){var r=t.findDependency,i=t.thisLookup,a=(t.doNotDefine,t.flattened);a||(a=t.flattened={});var o=n.parse(e),s=[],u=0,l=function e(t){if(Array.isArray(t)){for(var n=[],a=0;a<t.length;a++)n.push(e(t[a]));return n.join("")}switch(t.type){case"Program":return e(t.body)+("VariableDeclaration"===t.body[0].type?";":"");case"FunctionDeclaration":return"function ".concat(t.id.name,"(").concat(t.params.map(e).join(", "),") ").concat(e(t.body));case"BlockStatement":var o=[];u+=2;for(var l=0;l<t.body.length;l++){var h=e(t.body[l]);h&&o.push(" ".repeat(u)+h,";\n")}return u-=2,"{\n".concat(o.join(""),"}");case"VariableDeclaration":var p=c.normalizeDeclarations(t).map(e).filter((function(e){return null!==e}));return p.length<1?"":"".concat(t.kind," ").concat(p.join(","));case"VariableDeclarator":return t.init.object&&"ThisExpression"===t.init.object.type?i(t.init.property.name)?"".concat(t.id.name," = ").concat(e(t.init)):null:"".concat(t.id.name," = ").concat(e(t.init));case"CallExpression":if("subarray"===t.callee.property.name)return"".concat(e(t.callee.object),".").concat(e(t.callee.property),"(").concat(t.arguments.map((function(t){return e(t)})).join(", "),")");if("gl"===t.callee.object.name||"context"===t.callee.object.name)return"".concat(e(t.callee.object),".").concat(e(t.callee.property),"(").concat(t.arguments.map((function(t){return e(t)})).join(", "),")");if("ThisExpression"===t.callee.object.type)return s.push(r("this",t.callee.property.name)),"".concat(t.callee.property.name,"(").concat(t.arguments.map((function(t){return e(t)})).join(", "),")");if(t.callee.object.name){var f=r(t.callee.object.name,t.callee.property.name);return null===f?"".concat(t.callee.object.name,".").concat(t.callee.property.name,"(").concat(t.arguments.map((function(t){return e(t)})).join(", "),")"):(s.push(f),"".concat(t.callee.property.name,"(").concat(t.arguments.map((function(t){return e(t)})).join(", "),")"))}if("MemberExpression"===t.callee.object.type)return"".concat(e(t.callee.object),".").concat(t.callee.property.name,"(").concat(t.arguments.map((function(t){return e(t)})).join(", "),")");throw new Error("unknown ast.callee");case"ReturnStatement":return"return ".concat(e(t.argument));case"BinaryExpression":return"(".concat(e(t.left)).concat(t.operator).concat(e(t.right),")");case"UnaryExpression":return t.prefix?"".concat(t.operator," ").concat(e(t.argument)):"".concat(e(t.argument)," ").concat(t.operator);case"ExpressionStatement":return"".concat(e(t.expression));case"SequenceExpression":return"(".concat(e(t.expressions),")");case"ArrowFunctionExpression":return"(".concat(t.params.map(e).join(", "),") => ").concat(e(t.body));case"Literal":return t.raw;case"Identifier":return t.name;case"MemberExpression":return"ThisExpression"===t.object.type?i(t.property.name):t.computed?"".concat(e(t.object),"[").concat(e(t.property),"]"):e(t.object)+"."+e(t.property);case"ThisExpression":return"this";case"NewExpression":return"new ".concat(e(t.callee),"(").concat(t.arguments.map((function(t){return e(t)})).join(", "),")");case"ForStatement":return"for (".concat(e(t.init),";").concat(e(t.test),";").concat(e(t.update),") ").concat(e(t.body));case"AssignmentExpression":return"".concat(e(t.left)).concat(t.operator).concat(e(t.right));case"UpdateExpression":return"".concat(e(t.argument)).concat(t.operator);case"IfStatement":return"if (".concat(e(t.test),") ").concat(e(t.consequent));case"ThrowStatement":return"throw ".concat(e(t.argument));case"ObjectPattern":return t.properties.map(e).join(", ");case"ArrayPattern":return t.elements.map(e).join(", ");case"DebuggerStatement":return"debugger;";case"ConditionalExpression":return"".concat(e(t.test),"?").concat(e(t.consequent),":").concat(e(t.alternate));case"Property":if("init"===t.kind)return e(t.key)}throw new Error("unhandled ast.type of ".concat(t.type))}(o);if(s.length>0){for(var h=[],p=0;p<s.length;p++){var f=s[p];a[f]||(a[f]=!0),h.push(c.flattenFunctionToString(f,t)+"\n")}return h.join("")+l}return l},normalizeDeclarations:function(e){if("VariableDeclaration"!==e.type)throw new Error('Ast is not of type "VariableDeclaration"');for(var t=[],r=0;r<e.declarations.length;r++){var n=e.declarations[r];if(n.id&&"ObjectPattern"===n.id.type&&n.id.properties)for(var i=n.id.properties,a=0;a<i.length;a++){var o=i[a];if("ObjectPattern"===o.value.type&&o.value.properties)for(var s=0;s<o.value.properties.length;s++){var u=o.value.properties[s];if("Property"!==u.type)throw new Error("unexpected state");t.push({type:"VariableDeclarator",id:{type:"Identifier",name:u.key.name},init:{type:"MemberExpression",object:{type:"MemberExpression",object:n.init,property:{type:"Identifier",name:o.key.name},computed:!1},property:{type:"Identifier",name:u.key.name},computed:!1}})}else{if("Identifier"!==o.value.type)throw new Error("unexpected state");t.push({type:"VariableDeclarator",id:{type:"Identifier",name:o.value&&o.value.name?o.value.name:o.key.name},init:{type:"MemberExpression",object:n.init,property:{type:"Identifier",name:o.key.name},computed:!1}})}}else if(n.id&&"ArrayPattern"===n.id.type&&n.id.elements)for(var c=n.id.elements,l=0;l<c.length;l++){var h=c[l];if("Identifier"!==h.type)throw new Error("unexpected state");t.push({type:"VariableDeclarator",id:{type:"Identifier",name:h.name},init:{type:"MemberExpression",object:n.init,property:{type:"Literal",value:l,raw:l.toString(),start:h.start,end:h.end},computed:!0}})}else t.push(n)}return t},splitHTMLImageToRGB:function(e,t){var r=e.createKernel((function(e){return 255*e[this.thread.y][this.thread.x].r}),{output:[t.width,t.height],precision:"unsigned",argumentTypes:{a:"HTMLImage"}}),n=e.createKernel((function(e){return 255*e[this.thread.y][this.thread.x].g}),{output:[t.width,t.height],precision:"unsigned",argumentTypes:{a:"HTMLImage"}}),i=e.createKernel((function(e){return 255*e[this.thread.y][this.thread.x].b}),{output:[t.width,t.height],precision:"unsigned",argumentTypes:{a:"HTMLImage"}}),a=e.createKernel((function(e){return 255*e[this.thread.y][this.thread.x].a}),{output:[t.width,t.height],precision:"unsigned",argumentTypes:{a:"HTMLImage"}}),o=[r(t),n(t),i(t),a(t)];return o.rKernel=r,o.gKernel=n,o.bKernel=i,o.aKernel=a,o.gpu=e,o},splitRGBAToCanvases:function(e,t,r,n){var i=e.createKernel((function(e){var t=e[this.thread.y][this.thread.x];this.color(t.r/255,0,0,255)}),{output:[r,n],graphical:!0,argumentTypes:{v:"Array2D(4)"}});i(t);var a=e.createKernel((function(e){var t=e[this.thread.y][this.thread.x];this.color(0,t.g/255,0,255)}),{output:[r,n],graphical:!0,argumentTypes:{v:"Array2D(4)"}});a(t);var o=e.createKernel((function(e){var t=e[this.thread.y][this.thread.x];this.color(0,0,t.b/255,255)}),{output:[r,n],graphical:!0,argumentTypes:{v:"Array2D(4)"}});o(t);var s=e.createKernel((function(e){var t=e[this.thread.y][this.thread.x];this.color(255,255,255,t.a/255)}),{output:[r,n],graphical:!0,argumentTypes:{v:"Array2D(4)"}});return s(t),[i.canvas,a.canvas,o.canvas,s.canvas]}},l=c.getSystemEndianness();t.exports={utils:c}},{"./input":109,"./texture":112,acorn:1}]},{},[106])(106)},function(e,t,r){"use strict";r(144),t.__esModule=!0,t.buildCriterionLambda=t.CriterionBuilder=t.buildCriterion=t.CriterionType=void 0;var n,i=r(106);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}t.CriterionType=n,function(e){e.GREATER_THAN="GREATER_THAN",e.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",e.LESS_THAN="LESS_THAN",e.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",e.NOT_EQUAL="NOT_EQUAL",e.EQUAL="EQUAL"}(n||(t.CriterionType=n={}));var o=function(e,t){return{operator:e,value:t}};t.buildCriterion=o;var s=function(){function e(t){var r,n,i,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.trueString=null!==(n=null===(r=t.translationPackage.getMaybeFunctionTranslation("TRUE"))||void 0===r?void 0:r.toLowerCase())&&void 0!==n?n:"true",this.falseString=null!==(a=null===(i=t.translationPackage.getMaybeFunctionTranslation("FALSE"))||void 0===i?void 0:i.toLowerCase())&&void 0!==a?a:"false"}var t,r,i;return t=e,(r=[{key:"fromCellValue",value:function(e,t){if("string"==typeof e||"boolean"==typeof e||"number"==typeof e){var r=this.parseCriterion(e,t);if(void 0!==r)return{raw:e,lambda:c(r,t)}}}},{key:"parseCriterion",value:function(e,t){if("number"==typeof e||"boolean"==typeof e)return o(n.EQUAL,e);if("string"==typeof e){var r,i,a=u.exec(e);a?(i=function(e){switch(e){case">":return n.GREATER_THAN;case">=":return n.GREATER_THAN_OR_EQUAL;case"<":return n.LESS_THAN;case"<=":return n.LESS_THAN_OR_EQUAL;case"<>":return n.NOT_EQUAL;case"=":return n.EQUAL;default:return}}(a[1]),r=a[2]):(i=n.EQUAL,r=e);var s=t.coerceToMaybeNumber(r),c=r.toLowerCase()===this.trueString||r.toLowerCase()!==this.falseString&&void 0;if(void 0===i)return;if(""===r)return o(i,null);if(void 0!==s)return o(i,s);if(i===n.EQUAL||i===n.NOT_EQUAL)return o(i,null!=c?c:r)}}}])&&a(t.prototype,r),i&&a(t,i),e}();t.CriterionBuilder=s;var u=/([<>=]+)(.*)/,c=function(e,t){switch(e.operator){case n.GREATER_THAN:return"number"==typeof e.value?function(r){return"number"==typeof r&&t.floatCmp(r,e.value)>0}:function(e){return!1};case n.GREATER_THAN_OR_EQUAL:return"number"==typeof e.value?function(r){return"number"==typeof r&&t.floatCmp(r,e.value)>=0}:function(e){return!1};case n.LESS_THAN:return"number"==typeof e.value?function(r){return"number"==typeof r&&t.floatCmp(r,e.value)<0}:function(e){return!1};case n.LESS_THAN_OR_EQUAL:return"number"==typeof e.value?function(r){return"number"==typeof r&&t.floatCmp(r,e.value)<=0}:function(e){return!1};case n.EQUAL:return"number"==typeof e.value?function(r){if("number"==typeof r)return 0===t.floatCmp(r,e.value);if("string"==typeof r){if(""===r)return!1;var n=t.coerceToMaybeNumber(r);return void 0!==n&&0===t.floatCmp(n,e.value)}return!1}:"string"==typeof e.value?t.eqMatcherFunction(e.value):"boolean"==typeof e.value?function(t){return"boolean"==typeof t&&t===e.value}:function(e){return e===i.EmptyValue};case n.NOT_EQUAL:return"number"==typeof e.value?function(r){if("number"==typeof r)return 0!==t.floatCmp(r,e.value);if("string"==typeof r){if(""===r)return!0;var n=t.coerceToMaybeNumber(r);return void 0===n||0!==t.floatCmp(n,e.value)}return!0}:"string"==typeof e.value?t.neqMatcherFunction(e.value):"boolean"==typeof e.value?function(t){return"boolean"!=typeof t||t!==e.value}:function(e){return e!==i.EmptyValue}}};t.buildCriterionLambda=c},function(e,t,r){"use strict";r(1),r(63),r(64),r(109),r(288),r(110),r(65),r(75),r(84),r(89),r(207),r(243),r(92),r(96),r(114),r(98),r(124),r(104),t.__esModule=!0,t.FunctionRegistry=void 0,r(125);var n=r(226),i=r(256),a=r(314);function o(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||c(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=c(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function c(e,t){if(e){if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var p=function(){function e(t){var r=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.functions=new Map,this.volatileFunctions=new Set,this.structuralChangeFunctions=new Set,this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set,this.doesFunctionNeedArgumentToBeComputed=function(e){return r.functionsWhichDoesNotNeedArgumentsToBeComputed.has(e)},this.isFunctionVolatile=function(e){return r.volatileFunctions.has(e)},this.isFunctionDependentOnSheetStructureChange=function(e){return r.structuralChangeFunctions.has(e)},t.functionPlugins.length>0){this.instancePlugins=new Map;var n,i=u(t.functionPlugins);try{for(i.s();!(n=i.n()).done;){var a=n.value;e.loadPluginFunctions(a,this.instancePlugins)}}catch(e){i.e(e)}finally{i.f()}}else this.instancePlugins=new Map(e.plugins);var o,c=u(e.protectedFunctions());try{for(c.s();!(o=c.n()).done;){var l=s(o.value,2),h=l[0],p=l[1];e.loadFunctionUnprotected(p,h,this.instancePlugins)}}catch(e){c.e(e)}finally{c.f()}var f,d=u(this.instancePlugins.entries());try{for(d.s();!(f=d.n()).done;){var m=s(f.value,2),y=m[0],g=m[1];this.categorizeFunction(y,g.implementedFunctions[y])}}catch(e){d.e(e)}finally{d.f()}}var t,r,a;return t=e,r=[{key:"initializePlugins",value:function(e){var t,r=this,n=[],i=u(this.instancePlugins.entries());try{var a=function(){var i=s(t.value,2),a=i[0],o=i[1],u=n.find((function(e){return e instanceof o}));void 0===u&&(u=new o(e),n.push(u));var c=o.implementedFunctions[a].method;r.functions.set(a,[c,u])};for(i.s();!(t=i.n()).done;)a()}catch(e){i.e(e)}finally{i.f()}}},{key:"getFunctionPlugin",value:function(t){if(!e.functionIsProtected(t))return this.instancePlugins.get(t)}},{key:"getFunction",value:function(e){return this.functions.get(e)}},{key:"getPlugins",value:function(){var t,r=new Set,n=u(this.instancePlugins);try{for(n.s();!(t=n.n()).done;){var i=s(t.value,2),a=i[0],o=i[1];e.functionIsProtected(a)||r.add(o)}}catch(e){n.e(e)}finally{n.f()}return Array.from(r)}},{key:"getRegisteredFunctionIds",value:function(){return Array.from(this.functions.keys())}},{key:"categorizeFunction",value:function(e,t){t.isVolatile&&this.volatileFunctions.add(e),t.doesNotNeedArgumentsToBeComputed&&this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(e),t.isDependentOnSheetStructureChange&&this.structuralChangeFunctions.add(e)}}],a=[{key:"registerFunctionPlugin",value:function(e,t){this.loadPluginFunctions(e,this.plugins),void 0!==t&&this.loadTranslations(t)}},{key:"registerFunction",value:function(e,t,r){if(void 0===t.implementedFunctions[e])throw n.FunctionPluginValidationError.functionNotDeclaredInPlugin(e,t.name);this.loadPluginFunction(t,e,this.plugins),void 0!==r&&this.loadTranslations(r)}},{key:"unregisterFunction",value:function(e){if(this.functionIsProtected(e))throw n.ProtectedFunctionError.cannotUnregisterFunctionWithId(e);this.plugins.delete(e)}},{key:"unregisterFunctionPlugin",value:function(e){var t,r=u(this.protectedPlugins());try{for(r.s();!(t=r.n()).done;)if(t.value===e)throw n.ProtectedFunctionError.cannotUnregisterProtectedPlugin()}catch(e){r.e(e)}finally{r.f()}var i,a=u(this.plugins.entries());try{for(a.s();!(i=a.n()).done;){var o=s(i.value,2),c=o[0];o[1]===e&&this.plugins.delete(c)}}catch(e){a.e(e)}finally{a.f()}}},{key:"unregisterAll",value:function(){this.plugins.clear()}},{key:"getRegisteredFunctionIds",value:function(){return[].concat(o(Array.from(this.plugins.keys())),o(Array.from(this._protectedPlugins.keys())))}},{key:"getPlugins",value:function(){return Array.from(new Set(this.plugins.values()).values())}},{key:"getFunctionPlugin",value:function(e){return this.functionIsProtected(e)?void 0:this.plugins.get(e)}},{key:"loadTranslations",value:function(e){var t=new Set(i.HyperFormula.getRegisteredLanguagesCodes());Object.keys(e).forEach((function(r){t.has(r)&&i.HyperFormula.getLanguage(r).extendFunctions(e[r])}))}},{key:"loadPluginFunctions",value:function(e,t){var r=this;Object.keys(e.implementedFunctions).forEach((function(n){r.loadPluginFunction(e,n,t)}))}},{key:"loadPluginFunction",value:function(e,t,r){if(this.functionIsProtected(t))throw n.ProtectedFunctionError.cannotRegisterFunctionWithId(t);this.loadFunctionUnprotected(e,t,r)}},{key:"loadFunctionUnprotected",value:function(e,t,r){var i=e.implementedFunctions[t].method;if(!Object.prototype.hasOwnProperty.call(e.prototype,i))throw n.FunctionPluginValidationError.functionMethodNotFound(i,e.name);r.set(t,e)}},{key:"functionIsProtected",value:function(e){return this._protectedPlugins.has(e)}},{key:"protectedFunctions",value:regeneratorRuntime.mark((function e(){var t,r,n,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=u(this._protectedPlugins),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=10;break}if(n=s(r.value,2),i=n[0],void 0===(a=n[1])){e.next=8;break}return e.next=8,[i,a];case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"protectedPlugins",value:regeneratorRuntime.mark((function e(){var t,r,n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=u(this._protectedPlugins),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=10;break}if(n=s(r.value,2),void 0===(i=n[1])){e.next=8;break}return e.next=8,i;case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))}],r&&h(t.prototype,r),a&&h(t,a),e}();t.FunctionRegistry=p,p.plugins=new Map,p._protectedPlugins=new Map([["VERSION",a.VersionPlugin],["OFFSET",void 0]])},function(e,t,r){"use strict";r(1),r(63),r(64),r(109),r(75),r(84),r(207),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.VersionPlugin=void 0;var n=r(315),i=r(256);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h(e);if(t){var i=h(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return l(this,r)}}function l(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=new Map([["agpl-v3",1],["non-commercial-and-evaluation",2],["missing",3],["invalid",4],["expired",5]]),f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(l,e);var t,r,n,a=c(l);function l(){return o(this,l),a.apply(this,arguments)}return t=l,(r=[{key:"version",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("VERSION"),(function(){var e,t=r.config,n=t.licenseKeyValidityState,a=t.licenseKey;return p.has(a)?e=p.get(a):p.has(n)?e=p.get(n):"valid"===n&&(e=a.slice(-5)),"HyperFormula v".concat(i.HyperFormula.version,", ").concat(e)}))}}])&&s(t.prototype,r),n&&s(t,n),l}(n.FunctionPlugin);t.VersionPlugin=f,f.implementedFunctions={VERSION:{method:"version",parameters:[]}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(65),r(75),r(113),r(84),r(89),r(133),r(209),r(92),r(96),r(98),r(104),t.__esModule=!0,t.FunctionPlugin=t.ArgumentTypes=void 0;var n,i=r(132),a=r(106),o=r(213),s=r(138),u=r(261),c=r(246);function l(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=p(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||p(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){if(e){if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}t.ArgumentTypes=n,function(e){e.STRING="STRING",e.NUMBER="NUMBER",e.BOOLEAN="BOOLEAN",e.SCALAR="SCALAR",e.NOERROR="NOERROR",e.RANGE="RANGE",e.INTEGER="INTEGER",e.ANY="ANY"}(n||(t.ArgumentTypes=n={}));var m=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.coerceScalarToNumberOrError=function(e){return r.interpreter.arithmeticHelper.coerceScalarToNumberOrError(e)},this.runFunction=function(e,t,i,s){var u,c,l,p,f=i.parameters;p=i.expandRanges?r.listOfScalarValues(e,t):e.map((function(e){return[r.evaluateAst(e,t),!1]}));var d=[],m=void 0;if(void 0===i.repeatLastArgs&&f.length<p.length)return new a.CellError(a.ErrorType.NA,o.ErrorMessage.WrongArgNumber);if(void 0!==i.repeatLastArgs&&p.length>f.length&&(p.length-f.length)%i.repeatLastArgs!=0)return new a.CellError(a.ErrorType.NA,o.ErrorMessage.WrongArgNumber);for(var y=0,g=0;y<Math.max(p.length,f.length);y++,g++){g===f.length&&(g-=i.repeatLastArgs);var v=h(null!==(u=p[y])&&void 0!==u?u:[void 0,void 0],2),E=v[0],T=v[1],b=null!=E?E:null===(c=f[g])||void 0===c?void 0:c.defaultValue;if(void 0===b){if(!(null===(l=f[g])||void 0===l?void 0:l.optionalArg))return new a.CellError(a.ErrorType.NA,o.ErrorMessage.WrongArgNumber);d.push(void 0)}else{var x=void 0!==E?r.coerceToType(b,f[g]):b;void 0!==x?(x instanceof a.CellError&&f[g].argumentType!==n.SCALAR&&(m=null!=m?m:x),d.push(x)):T||(m=null!=m?m:new a.CellError(a.ErrorType.VALUE,o.ErrorMessage.WrongType))}}return null!=m?m:s.apply(void 0,d)},this.runFunctionWithReferenceArgument=function(e,t,n,u,c){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(){return new a.CellError(a.ErrorType.NA,o.ErrorMessage.CellRefExpected)};if(0===e.length)return u();if(e.length>1)return new a.CellError(a.ErrorType.NA,o.ErrorMessage.WrongArgNumber);var h,p=e[0];if(p.type===s.AstNodeType.CELL_REFERENCE)h=p.reference.toSimpleCellAddress(t);else if(p.type===s.AstNodeType.CELL_RANGE||p.type===s.AstNodeType.COLUMN_RANGE||p.type===s.AstNodeType.ROW_RANGE)try{h=i.AbsoluteCellRange.fromAst(p,t).start}catch(e){return new a.CellError(a.ErrorType.REF,o.ErrorMessage.CellRefExpected)}return void 0!==h?c(h):r.runFunction(e,t,n,l)},this.interpreter=t,this.dependencyGraph=t.dependencyGraph,this.columnSearch=t.columnSearch,this.config=t.config,this.serialization=t.serialization}var t,r,p;return t=e,(r=[{key:"evaluateAst",value:function(e,t){return this.interpreter.evaluateAst(e,t)}},{key:"listOfScalarValues",value:function(e,t){var r,n=[],i=l(e);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=this.evaluateAst(a,t);if(o instanceof c.SimpleRangeValue){var s,u=l(o.valuesFromTopLeftCorner());try{for(u.s();!(s=u.n()).done;){var h=s.value;n.push([h,!0])}}catch(e){u.e(e)}finally{u.f()}}else n.push([o,!1])}}catch(e){i.e(e)}finally{i.f()}return n}},{key:"coerceToType",value:function(e,t){if(e instanceof c.SimpleRangeValue)switch(t.argumentType){case n.RANGE:case n.ANY:return e;default:return}else switch(t.argumentType){case n.INTEGER:case n.NUMBER:var r=this.coerceScalarToNumberOrError(e);return"number"!=typeof r?r:void 0!==t.maxValue&&r>t.maxValue?new a.CellError(a.ErrorType.NUM,o.ErrorMessage.ValueLarge):void 0!==t.minValue&&r<t.minValue?new a.CellError(a.ErrorType.NUM,o.ErrorMessage.ValueSmall):void 0!==t.lessThan&&r>=t.lessThan?new a.CellError(a.ErrorType.NUM,o.ErrorMessage.ValueLarge):void 0!==t.greaterThan&&r<=t.greaterThan?new a.CellError(a.ErrorType.NUM,o.ErrorMessage.ValueSmall):t.argumentType!==n.INTEGER||Number.isInteger(r)?r:new a.CellError(a.ErrorType.NUM,o.ErrorMessage.IntegerExpected);case n.STRING:return(0,u.coerceScalarToString)(e);case n.BOOLEAN:return(0,u.coerceScalarToBoolean)(e);case n.SCALAR:case n.NOERROR:case n.ANY:return e;case n.RANGE:return e instanceof a.CellError?e:(0,u.coerceToRange)(e)}}},{key:"metadata",value:function(e){var t=this.constructor.implementedFunctions[e];if(void 0!==t)return t;throw new Error("No metadata for function ".concat(e,"."))}}])&&d(t.prototype,r),p&&d(t,p),e}();t.FunctionPlugin=m},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r(109),r(133),r(142),r(144),r(96),r(146),t.__esModule=!0,t.NumberLiteralHelper=void 0;
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */
var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t;var r="."===this.config.thousandSeparator?"\\".concat(this.config.thousandSeparator):this.config.thousandSeparator,n="."===this.config.decimalSeparator?"\\".concat(this.config.decimalSeparator):this.config.decimalSeparator;this.numberPattern=new RegExp("^([+-]?((".concat(n,"\\d+)|(\\d+(").concat(r,"\\d{3,})*(").concat(n,"\\d+)?)))$")),this.allThousandSeparatorsRegex=new RegExp("".concat(r),"g")}var t,r,i;return t=e,(r=[{key:"isNumber",value:function(e){return this.numberPattern.test(e)}},{key:"numericStringToNumber",value:function(e){var t=e.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,".");return Number(t)}}])&&n(t.prototype,r),i&&n(t,i),e}();t.NumberLiteralHelper=i},function(e,t,r){"use strict";r(1),r(63),r(64),r(65),r(75),r(113),r(84),r(89),r(92),r(96),r(98),r(104),t.__esModule=!0,t.Serialization=void 0;var n=r(106),i=r(252),a=r(107),o=r(138);function s(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dependencyGraph=t,this.unparser=r,this.config=n,this.exporter=i}var t,r,u;return t=e,(r=[{key:"getCellFormula",value:function(e){var t=this.dependencyGraph.getCell(e);if(t instanceof a.FormulaCellVertex){var r=t.getFormula(this.dependencyGraph.lazilyTransformingAstService);return this.unparser.unparse(r,e)}if(t instanceof a.MatrixVertex){var n=t.getFormula();if(n)return"{"+this.unparser.unparse(n,t.getAddress())+"}"}else if(t instanceof a.ParsingErrorVertex)return t.getFormula()}},{key:"getCellSerialized",value:function(e){var t=this.getCellFormula(e);if(void 0!==t)return t;var r=this.getCellValue(e);return r instanceof i.DetailedCellError?this.config.translationPackage.getErrorTranslation(r.type):r}},{key:"getCellValue",value:function(e){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(e))}},{key:"getSheetValues",value:function(e){var t=this;return this.genericSheetGetter(e,(function(e){return t.getCellValue(e)}))}},{key:"getSheetFormulas",value:function(e){var t=this;return this.genericSheetGetter(e,(function(e){return t.getCellFormula(e)}))}},{key:"genericSheetGetter",value:function(e,t){for(var r=this.dependencyGraph.getSheetHeight(e),i=this.dependencyGraph.getSheetWidth(e),a=new Array(r),o=0;o<r;o++){a[o]=new Array(i);for(var s=0;s<i;s++){var u=(0,n.simpleCellAddress)(e,s,o);a[o][s]=t(u)}for(var c=i-1;c>=0&&(null===a[o][c]||void 0===a[o][c]);c--)a[o].pop()}for(var l=r-1;l>=0&&0===a[l].length;l--)a.pop();return a}},{key:"genericAllSheetsGetter",value:function(e){var t,r={},n=s(this.dependencyGraph.sheetMapping.displayNames());try{for(n.s();!(t=n.n()).done;){var i=t.value,a=this.dependencyGraph.sheetMapping.fetch(i);r[i]=e(a)}}catch(e){n.e(e)}finally{n.f()}return r}},{key:"getSheetSerialized",value:function(e){var t=this;return this.genericSheetGetter(e,(function(e){return t.getCellSerialized(e)}))}},{key:"getAllSheetsValues",value:function(){var e=this;return this.genericAllSheetsGetter((function(t){return e.getSheetValues(t)}))}},{key:"getAllSheetsFormulas",value:function(){var e=this;return this.genericAllSheetsGetter((function(t){return e.getSheetFormulas(t)}))}},{key:"getAllSheetsSerialized",value:function(){var e=this;return this.genericAllSheetsGetter((function(t){return e.getSheetSerialized(t)}))}},{key:"getAllNamedExpressionsSerialized",value:function(){var e=this;return this.dependencyGraph.namedExpressions.getAllNamedExpressions().map((function(t){var r=void 0!==t.scope?e.dependencyGraph.sheetMapping.fetchDisplayName(t.scope):void 0;return{name:t.expression.displayName,expression:e.getCellSerialized(t.expression.address),scope:r,options:t.expression.options}}))}},{key:"withNewConfig",value:function(t,r){var n=new o.Unparser(t,(0,o.buildLexerConfig)(t),this.dependencyGraph.sheetMapping.fetchDisplayName,r);return new e(this.dependencyGraph,n,t,this.exporter)}}])&&c(t.prototype,r),u&&c(t,u),e}();t.Serialization=l},function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */
var n={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",VALUE:"#VALUE!"},functions:{ABS:"ABS",ACOS:"ACOS",ACOSH:"ACOSH",ACOT:"ACOT",ACOTH:"ACOTH",AND:"AND",ASIN:"ASIN",ASINH:"ASINH",ATAN2:"ATAN2",ATAN:"ATAN",ATANH:"ATANH",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CLEAN:"CLEAN",CODE:"CODE",COLUMN:"COLUMN",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COSH:"COSH",COT:"COT",COTH:"COTH",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",CSC:"CSC",CSCH:"CSCH",CUMIPMT:"CUMIPMT",CUMPRINC:"CUMPRINC",DATE:"DATE",DATEDIF:"DATEDIF",DATEVALUE:"DATEVALUE",DAY:"DAY",DAYS360:"DAYS360",DAYS:"DAYS",DB:"DB",DDB:"DDB",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",DOLLARDE:"DOLLARDE",DOLLARFR:"DOLLARFR",EDATE:"EDATE",EFFECT:"EFFECT",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXACT:"EXACT",EXP:"EXP",FALSE:"FALSE",FIND:"FIND",FORMULATEXT:"FORMULATEXT",FV:"FV",FVSCHEDULE:"FVSCHEDULE",HEX2BIN:"HEX2BIN",HEX2DEC:"HEX2DEC",HEX2OCT:"HEX2OCT",HLOOKUP:"HLOOKUP",HOUR:"HOUR",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",INDEX:"INDEX",INT:"INT",INTERVAL:"INTERVAL",IPMT:"IPMT",ISBINARY:"ISBINARY",ISBLANK:"ISBLANK",ISERR:"ISERR",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISFORMULA:"ISFORMULA",ISLOGICAL:"ISLOGICAL",ISNA:"ISNA",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISOWEEKNUM:"ISOWEEKNUM",ISPMT:"ISPMT",ISREF:"ISREF",ISTEXT:"ISTEXT",LEFT:"LEFT",LEN:"LEN",LN:"LN",LOG10:"LOG10",LOG:"LOG",LOWER:"LOWER",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MID:"MID",MIN:"MIN",MINA:"MINA",MINUTE:"MINUTE",MIRR:"MIRR",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NA:"NA",NETWORKDAYS:"NETWORKDAYS","NETWORKDAYS.INTL":"NETWORKDAYS.INTL",NOMINAL:"NOMINAL",NOT:"NOT",NOW:"NOW",NPER:"NPER",NPV:"NPV",OCT2BIN:"OCT2BIN",OCT2DEC:"OCT2DEC",OCT2HEX:"OCT2HEX",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",PMT:"PMT",PDURATION:"PDURATION",PRODUCT:"PRODUCT",POWER:"POWER",PPMT:"PPMT",PROPER:"PROPER",PV:"PV",RADIANS:"RADIANS",RAND:"RAND",RATE:"RATE",REPLACE:"REPLACE",REPT:"REPT",RIGHT:"RIGHT",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROW:"ROW",ROWS:"ROWS",RRI:"RRI",SEARCH:"SEARCH",SEC:"SEC",SECH:"SECH",SECOND:"SECOND",SHEET:"SHEET",SHEETS:"SHEETS",SIN:"SIN",SINH:"SINH",SLN:"SLN",SPLIT:"SPLIT",SQRT:"SQRT",STDEVA:"STDEVA","STDEV.P":"STDEV.P",STDEVPA:"STDEVPA","STDEV.S":"STDEV.S",SUBSTITUTE:"SUBSTITUTE",SUBTOTAL:"SUBTOTAL",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",SYD:"SYD",T:"T",TAN:"TAN",TANH:"TANH",TBILLEQ:"TBILLEQ",TBILLPRICE:"TBILLPRICE",TBILLYIELD:"TBILLYIELD",TEXT:"TEXT",TIME:"TIME",TIMEVALUE:"TIMEVALUE",TODAY:"TODAY",TRANSPOSE:"TRANSPOSE",TRIM:"TRIM",TRUE:"TRUE",TRUNC:"TRUNC",UNICHAR:"UNICHAR",UNICODE:"UNICODE",UPPER:"UPPER",VARA:"VARA","VAR.P":"VAR.P",VARPA:"VARPA","VAR.S":"VAR.S",VLOOKUP:"VLOOKUP",WEEKDAY:"WEEKDAY",WEEKNUM:"WEEKNUM",WORKDAY:"WORKDAY","WORKDAY.INTL":"WORKDAY.INTL",XNPV:"XNPV",XOR:"XOR",YEAR:"YEAR",YEARFRAC:"YEARFRAC","HF.ADD":"HF.ADD","HF.CONCAT":"HF.CONCAT","HF.DIVIDE":"HF.DIVIDE","HF.EQ":"HF.EQ","HF.GT":"HF.GT","HF.GTE":"HF.GTE","HF.LT":"HF.LT","HF.LTE":"HF.LTE","HF.MINUS":"HF.MINUS","HF.MULTIPLY":"HF.MULTIPLY","HF.NE":"HF.NE","HF.POW":"HF.POW","HF.UMINUS":"HF.UMINUS","HF.UNARY_PERCENT":"HF.UNARY_PERCENT","HF.UPLUS":"HF.UPLUS",VARP:"VARP",VAR:"VAR",STDEVP:"STDEVP",STDEV:"STDEV"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}};t.default=n},function(e,t,r){"use strict";t.__esModule=!0,t.SimpleArithmerticPlugin=t.LookupPlugin=t.TrigonometryPlugin=t.TextPlugin=t.SumprodPlugin=t.SumifPlugin=t.SqrtPlugin=t.RoundingPlugin=t.RandomPlugin=t.RadixConversionPlugin=t.RadiansPlugin=t.PowerPlugin=t.NumericAggregationPlugin=t.ModuloPlugin=t.MedianPlugin=t.MatrixPlugin=t.MathConstantsPlugin=t.LogarithmPlugin=t.IsOddPlugin=t.IsEvenPlugin=t.InformationPlugin=t.FormulaTextPlugin=t.FinancialPlugin=t.ExpPlugin=t.ErrorFunctionPlugin=t.DeltaPlugin=t.DegreesPlugin=t.DateTimePlugin=t.CountUniquePlugin=t.CountBlankPlugin=t.CorrelPlugin=t.CodePlugin=t.CharPlugin=t.BooleanPlugin=t.BitwiseLogicOperationsPlugin=t.BitShiftPlugin=t.AbsPlugin=void 0;var n=r(320);t.AbsPlugin=n.AbsPlugin;var i=r(321);t.BitShiftPlugin=i.BitShiftPlugin;var a=r(322);t.BitwiseLogicOperationsPlugin=a.BitwiseLogicOperationsPlugin;var o=r(323);t.BooleanPlugin=o.BooleanPlugin;var s=r(324);t.CharPlugin=s.CharPlugin;var u=r(327);t.CodePlugin=u.CodePlugin;var c=r(328);t.CorrelPlugin=c.CorrelPlugin;var l=r(329);t.CountBlankPlugin=l.CountBlankPlugin;var h=r(330);t.CountUniquePlugin=h.CountUniquePlugin;var p=r(331);t.DateTimePlugin=p.DateTimePlugin;var f=r(332);t.DegreesPlugin=f.DegreesPlugin;var d=r(333);t.DeltaPlugin=d.DeltaPlugin;var m=r(334);t.ErrorFunctionPlugin=m.ErrorFunctionPlugin;var y=r(335);t.ExpPlugin=y.ExpPlugin;var g=r(336);t.FinancialPlugin=g.FinancialPlugin;var v=r(337);t.FormulaTextPlugin=v.FormulaTextPlugin;var E=r(339);t.InformationPlugin=E.InformationPlugin;var T=r(340);t.IsEvenPlugin=T.IsEvenPlugin;var b=r(341);t.IsOddPlugin=b.IsOddPlugin;var x=r(342);t.LogarithmPlugin=x.LogarithmPlugin;var A=r(343);t.MathConstantsPlugin=A.MathConstantsPlugin;var S=r(344);t.MatrixPlugin=S.MatrixPlugin;var R=r(345);t.MedianPlugin=R.MedianPlugin;var w=r(346);t.ModuloPlugin=w.ModuloPlugin;var C=r(347);t.NumericAggregationPlugin=C.NumericAggregationPlugin;var O=r(348);t.PowerPlugin=O.PowerPlugin;var k=r(349);t.RadiansPlugin=k.RadiansPlugin;var N=r(350);t.RadixConversionPlugin=N.RadixConversionPlugin;var _=r(351);t.RandomPlugin=_.RandomPlugin;var I=r(352);t.RoundingPlugin=I.RoundingPlugin;var M=r(353);t.SqrtPlugin=M.SqrtPlugin;var P=r(354);t.SumifPlugin=P.SumifPlugin;var L=r(357);t.SumprodPlugin=L.SumprodPlugin;var F=r(358);t.TextPlugin=F.TextPlugin;var D=r(360);t.TrigonometryPlugin=D.TrigonometryPlugin;var U=r(369);t.LookupPlugin=U.LookupPlugin;var V=r(371);t.SimpleArithmerticPlugin=V.SimpleArithmerticPlugin},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.AbsPlugin=void 0;var n=r(315);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var i=l(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(c,e);var t,r,n,i=u(c);function c(){return a(this,c),i.apply(this,arguments)}return t=c,(r=[{key:"abs",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ABS"),Math.abs)}}])&&o(t.prototype,r),n&&o(t,n),c}(n.FunctionPlugin);t.AbsPlugin=h,h.implementedFunctions={ABS:{method:"abs",parameters:[{argumentType:n.ArgumentTypes.NUMBER}]}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.BitShiftPlugin=void 0;var n=r(106),i=r(213),a=r(315);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var i=p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(a,e);var t,r,n,i=l(a);function a(){return s(this,a),i.apply(this,arguments)}return t=a,(r=[{key:"bitlshift",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BITLSHIFT"),d)}},{key:"bitrshift",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BITRSHIFT"),m)}}])&&u(t.prototype,r),n&&u(t,n),a}(a.FunctionPlugin);function d(e,t){return t<0?m(e,-t):y(e*Math.pow(2,t))}function m(e,t){return t<0?d(e,-t):y(Math.floor(e/Math.pow(2,t)))}function y(e){return e>0xffffffffffff?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.BitshiftLong):e}t.BitShiftPlugin=f,f.implementedFunctions={BITLSHIFT:{method:"bitlshift",parameters:[{argumentType:a.ArgumentTypes.INTEGER,minValue:0},{argumentType:a.ArgumentTypes.INTEGER,minValue:-53,maxValue:53}]},BITRSHIFT:{method:"bitrshift",parameters:[{argumentType:a.ArgumentTypes.INTEGER,minValue:0},{argumentType:a.ArgumentTypes.INTEGER,minValue:-53,maxValue:53}]}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.BitwiseLogicOperationsPlugin=void 0;var n=r(315);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var i=l(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(c,e);var t,r,n,i=u(c);function c(){return a(this,c),i.apply(this,arguments)}return t=c,(r=[{key:"bitand",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BITAND"),(function(e,t){return e&t}))}},{key:"bitor",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BITOR"),(function(e,t){return e|t}))}},{key:"bitxor",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BITXOR"),(function(e,t){return e^t}))}}])&&o(t.prototype,r),n&&o(t,n),c}(n.FunctionPlugin);t.BitwiseLogicOperationsPlugin=h,h.implementedFunctions={BITAND:{method:"bitand",parameters:[{argumentType:n.ArgumentTypes.INTEGER,minValue:0},{argumentType:n.ArgumentTypes.INTEGER,minValue:0}]},BITOR:{method:"bitor",parameters:[{argumentType:n.ArgumentTypes.INTEGER,minValue:0},{argumentType:n.ArgumentTypes.INTEGER,minValue:0}]},BITXOR:{method:"bitxor",parameters:[{argumentType:n.ArgumentTypes.INTEGER,minValue:0},{argumentType:n.ArgumentTypes.INTEGER,minValue:0}]}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(110),r(75),r(206),r(91),r(92),r(94),r(96),r(98),r(124),r(104),t.__esModule=!0,t.BooleanPlugin=void 0;var n=r(106),i=r(213),a=r(315);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var i=p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(h,e);var t,r,a,o=l(h);function h(){return s(this,h),o.apply(this,arguments)}return t=h,(r=[{key:"literalTrue",value:function(e,t){return this.runFunction(e.args,t,this.metadata("TRUE"),(function(){return!0}))}},{key:"literalFalse",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FALSE"),(function(){return!1}))}},{key:"conditionalIf",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IF"),(function(e,t,r){return e?t:r}))}},{key:"and",value:function(e,t){return this.runFunction(e.args,t,this.metadata("AND"),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!t.some((function(e){return!e}))}))}},{key:"or",value:function(e,t){return this.runFunction(e.args,t,this.metadata("OR"),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.some((function(e){return e}))}))}},{key:"not",value:function(e,t){return this.runFunction(e.args,t,this.metadata("NOT"),(function(e){return!e}))}},{key:"xor",value:function(e,t){return this.runFunction(e.args,t,this.metadata("XOR"),(function(){for(var e=0,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.forEach((function(t){t&&e++})),e%2==1}))}},{key:"switch",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("SWITCH"),(function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),o=1;o<t;o++)a[o-1]=arguments[o];for(var s=a.length,u=0;u+1<s;u+=2)if(!(a[u]instanceof n.CellError)&&r.interpreter.arithmeticHelper.eq(e,a[u]))return a[u+1];return u<s?a[u]:new n.CellError(n.ErrorType.NA,i.ErrorMessage.NoDefault)}))}},{key:"iferror",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IFERROR"),(function(e,t){return e instanceof n.CellError?t:e}))}},{key:"ifna",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IFNA"),(function(e,t){return e instanceof n.CellError&&e.type===n.ErrorType.NA?t:e}))}},{key:"choose",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CHOOSE"),(function(e){return e>(arguments.length<=1?0:arguments.length-1)?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.Selector):e-1+1<1||arguments.length<=e-1+1?void 0:arguments[e-1+1]}))}}])&&u(t.prototype,r),a&&u(t,a),h}(a.FunctionPlugin);t.BooleanPlugin=f,f.implementedFunctions={TRUE:{method:"literalTrue",parameters:[]},FALSE:{method:"literalFalse",parameters:[]},IF:{method:"conditionalIf",parameters:[{argumentType:a.ArgumentTypes.BOOLEAN},{argumentType:a.ArgumentTypes.SCALAR},{argumentType:a.ArgumentTypes.SCALAR,defaultValue:!1}]},AND:{method:"and",parameters:[{argumentType:a.ArgumentTypes.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},OR:{method:"or",parameters:[{argumentType:a.ArgumentTypes.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},XOR:{method:"xor",parameters:[{argumentType:a.ArgumentTypes.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},NOT:{method:"not",parameters:[{argumentType:a.ArgumentTypes.BOOLEAN}]},SWITCH:{method:"switch",parameters:[{argumentType:a.ArgumentTypes.NOERROR},{argumentType:a.ArgumentTypes.SCALAR},{argumentType:a.ArgumentTypes.SCALAR}],repeatLastArgs:1},IFERROR:{method:"iferror",parameters:[{argumentType:a.ArgumentTypes.SCALAR},{argumentType:a.ArgumentTypes.SCALAR}]},IFNA:{method:"ifna",parameters:[{argumentType:a.ArgumentTypes.SCALAR},{argumentType:a.ArgumentTypes.SCALAR}]},CHOOSE:{method:"choose",parameters:[{argumentType:a.ArgumentTypes.INTEGER,minValue:1},{argumentType:a.ArgumentTypes.SCALAR}],repeatLastArgs:1}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(325),r(91),r(92),r(94),r(96),r(326),r(98),r(104),t.__esModule=!0,t.CharPlugin=void 0;var n=r(106),i=r(213),a=r(315);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var i=p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(h,e);var t,r,a,o=l(h);function h(){return s(this,h),o.apply(this,arguments)}return t=h,(r=[{key:"char",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),(function(e){return e<1||e>=256?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.CharacterCodeBounds):String.fromCharCode(Math.trunc(e))}))}},{key:"unichar",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),(function(e){return e<1||e>=1114112?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.CharacterCodeBounds):String.fromCodePoint(Math.trunc(e))}))}}])&&u(t.prototype,r),a&&u(t,a),h}(a.FunctionPlugin);t.CharPlugin=f,f.implementedFunctions={CHAR:{method:"char",parameters:[{argumentType:a.ArgumentTypes.NUMBER}]},UNICHAR:{method:"unichar",parameters:[{argumentType:a.ArgumentTypes.NUMBER}]}}},function(e,t,r){var n=r(2),i=Math.ceil,a=Math.floor;n({target:"Math",stat:!0},{trunc:function(e){return(e>0?a:i)(e)}})},function(e,t,r){var n=r(2),i=r(42),a=String.fromCharCode,o=String.fromCodePoint;n({target:"String",stat:!0,forced:!!o&&1!=o.length},{fromCodePoint:function(e){for(var t,r=[],n=arguments.length,o=0;n>o;){if(t=+arguments[o++],i(t,1114111)!==t)throw RangeError(t+" is not a valid code point");r.push(t<65536?a(t):a(55296+((t-=65536)>>10),t%1024+56320))}return r.join("")}})},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(91),r(92),r(94),r(96),r(303),r(98),r(104),t.__esModule=!0,t.CodePlugin=void 0;var n=r(106),i=r(213),a=r(315);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var i=p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(h,e);var t,r,a,o=l(h);function h(){return s(this,h),o.apply(this,arguments)}return t=h,(r=[{key:"code",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CODE"),(function(e){return 0===e.length?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.EmptyString):e.charCodeAt(0)}))}},{key:"unicode",value:function(e,t){return this.runFunction(e.args,t,this.metadata("UNICODE"),(function(e){var t;return null!==(t=e.codePointAt(0))&&void 0!==t?t:new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.EmptyString)}))}}])&&u(t.prototype,r),a&&u(t,a),h}(a.FunctionPlugin);t.CodePlugin=f,f.implementedFunctions={CODE:{method:"code",parameters:[{argumentType:a.ArgumentTypes.STRING}]},UNICODE:{method:"unicode",parameters:[{argumentType:a.ArgumentTypes.STRING}]}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.CorrelPlugin=void 0;var n=r(106),i=r(213),a=r(315);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var i=p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(h,e);var t,r,a,o=l(h);function h(){return s(this,h),o.apply(this,arguments)}return t=h,(r=[{key:"correl",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("CORREL"),(function(e,t){return e.numberOfElements()!==t.numberOfElements()?new n.CellError(n.ErrorType.NA,i.ErrorMessage.EqualLength):e.numberOfElements()<=1?new n.CellError(n.ErrorType.DIV_BY_ZERO,i.ErrorMessage.TwoValues):r.computePearson(e,t)}))}},{key:"computePearson",value:function(e,t){for(var r,i,a=e.iterateValuesFromTopLeftCorner(),o=t.iterateValuesFromTopLeftCorner(),s=0,u=0,c=0,l=0,h=0,p=0;r=a.next(),i=o.next(),!r.done&&!i.done;){var f=r.value,d=i.value;if(f instanceof n.CellError)return f;if(d instanceof n.CellError)return d;"number"==typeof f&&"number"==typeof d&&(s++,u+=f,c+=d,l+=f*f,h+=d*d,p+=f*d)}return(s*p-u*c)/(Math.sqrt(s*l-u*u)*Math.sqrt(s*h-c*c))}}])&&u(t.prototype,r),a&&u(t,a),h}(a.FunctionPlugin);t.CorrelPlugin=f,f.implementedFunctions={CORREL:{method:"correl",parameters:[{argumentType:a.ArgumentTypes.RANGE},{argumentType:a.ArgumentTypes.RANGE}]}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(110),r(75),r(91),r(92),r(94),r(96),r(98),r(124),r(104),t.__esModule=!0,t.CountBlankPlugin=void 0;var n=r(106),i=r(315);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h(e);if(t){var i=h(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return l(this,r)}}function l(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(l,e);var t,r,i,a=c(l);function l(){return o(this,l),a.apply(this,arguments)}return t=l,(r=[{key:"countblank",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COUNTBLANK"),(function(){for(var e=0,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return r.forEach((function(t){t===n.EmptyValue&&e++})),e}))}}])&&s(t.prototype,r),i&&s(t,i),l}(i.FunctionPlugin);t.CountBlankPlugin=p,p.implementedFunctions={COUNTBLANK:{method:"countblank",parameters:[{argumentType:i.ArgumentTypes.SCALAR}],repeatLastArgs:1,expandRanges:!0}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(91),r(92),r(94),r(96),r(114),r(98),r(104),t.__esModule=!0,t.CountUniquePlugin=void 0;var n=r(106),i=r(315);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h(e);if(t){var i=h(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return l(this,r)}}function l(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(l,e);var t,r,i,a=c(l);function l(){return o(this,l),a.apply(this,arguments)}return t=l,(r=[{key:"countunique",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COUNTUNIQUE"),(function(){for(var e=new Set,t=new Set,r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];for(var o=0,s=i;o<s.length;o++){var u=s[o];u instanceof n.CellError?t.add(u.type):""!==u&&e.add(u)}return e.size+t.size}))}}])&&s(t.prototype,r),i&&s(t,i),l}(i.FunctionPlugin);t.CountUniquePlugin=p,p.implementedFunctions={COUNTUNIQUE:{method:"countunique",parameters:[{argumentType:i.ArgumentTypes.SCALAR}],repeatLastArgs:1,expandRanges:!0}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(229),r(65),r(75),r(84),r(239),r(89),r(207),r(325),r(91),r(92),r(94),r(96),r(114),r(98),r(104),t.__esModule=!0,t.DateTimePlugin=void 0;var n=r(106),i=r(264),a=r(213),o=r(295),s=r(315);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||p(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=p(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||p(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){if(e){if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=E(e);if(t){var i=E(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return v(this,r)}}function v(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(p,e);var t,r,s,u=g(p);function p(){var e;return d(this,p),(e=u.apply(this,arguments)).isoweeknumCore=function(t){var r=Math.floor(e.interpreter.dateHelper.relativeNumberToAbsoluteNumber(t)),n=e.interpreter.dateHelper.numberToSimpleDate(t),i=e.interpreter.dateHelper.dateToNumber({year:n.year,month:1,day:1}),a=e.interpreter.dateHelper.relativeNumberToAbsoluteNumber(i),o=a+((4-a)%7+7)%7,s=Math.floor((r-1)/7)-Math.floor((o-1)/7)+1;return 0===s?e.isoweeknumCore(t-7)+1:s},e.days360Core=function(t,r,n){var a,o,s=e.interpreter.dateHelper.numberToSimpleDate(t),u=e.interpreter.dateHelper.numberToSimpleDate(r);if(n)a=(0,i.toBasisEU)(s),o=(0,i.toBasisEU)(u);else{var c=h(e.interpreter.dateHelper.toBasisUS(s,u),2);a=c[0],o=c[1]}return 360*(o.year-a.year)+30*(o.month-a.month)+o.day-a.day},e}return t=p,(r=[{key:"date",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("DATE"),(function(e,t,i){var o,s=Math.trunc(i),u=Math.trunc(t),c=Math.trunc(e);c<r.interpreter.dateHelper.getEpochYearZero()&&(c+=r.interpreter.dateHelper.getEpochYearZero());var l=Math.floor((u-1)/12),h={year:c+=l,month:u-=12*l,day:1};if(r.interpreter.dateHelper.isValidDate(h)){var p=r.interpreter.dateHelper.dateToNumber(h)+(s-1);return null!==(o=r.interpreter.dateHelper.getWithinBounds(p))&&void 0!==o?o:new n.CellError(n.ErrorType.NUM,a.ErrorMessage.DateBounds)}return new n.CellError(n.ErrorType.VALUE,a.ErrorMessage.InvalidDate)}))}},{key:"time",value:function(e,t){return this.runFunction(e.args,t,this.metadata("TIME"),(function(e,t,r){var o=(0,i.timeToNumber)({hours:Math.trunc(e),minutes:Math.trunc(t),seconds:Math.trunc(r)});return o<0?new n.CellError(n.ErrorType.NUM,a.ErrorMessage.NegativeTime):o%1}))}},{key:"eomonth",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("EOMONTH"),(function(e,t){var o,s=r.interpreter.dateHelper.numberToSimpleDate(e),u=r.interpreter.dateHelper.dateToNumber(r.interpreter.dateHelper.endOfMonth((0,i.offsetMonth)(s,t)));return null!==(o=r.interpreter.dateHelper.getWithinBounds(u))&&void 0!==o?o:new n.CellError(n.ErrorType.NUM,a.ErrorMessage.DateBounds)}))}},{key:"day",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("DAY"),(function(e){return r.interpreter.dateHelper.numberToSimpleDate(e).day}))}},{key:"days",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DAYS"),(function(e,t){return Math.trunc(e)-Math.trunc(t)}))}},{key:"month",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("MONTH"),(function(e){return r.interpreter.dateHelper.numberToSimpleDate(e).month}))}},{key:"year",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("YEAR"),(function(e){return r.interpreter.dateHelper.numberToSimpleDate(e).year}))}},{key:"hour",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HOUR"),(function(e){return(0,i.numberToSimpleTime)((0,i.roundToNearestSecond)(e)%1).hours}))}},{key:"minute",value:function(e,t){return this.runFunction(e.args,t,this.metadata("MINUTE"),(function(e){return(0,i.numberToSimpleTime)((0,i.roundToNearestSecond)(e)%1).minutes}))}},{key:"second",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SECOND"),(function(e){return(0,i.numberToSimpleTime)((0,i.roundToNearestSecond)(e)%1).seconds}))}},{key:"text",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("TEXT"),(function(e,t){return(0,o.format)(e,t,r.config,r.interpreter.dateHelper)}))}},{key:"weekday",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("WEEKDAY"),(function(e,t){var i=Math.floor(r.interpreter.dateHelper.relativeNumberToAbsoluteNumber(e));if(3===t)return(i-1)%7;var o=A.get(t);return void 0===o?new n.CellError(n.ErrorType.NUM,a.ErrorMessage.BadMode):(i-o)%7+1}))}},{key:"weeknum",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("WEEKNUM"),(function(e,t){var i=Math.floor(r.interpreter.dateHelper.relativeNumberToAbsoluteNumber(e)),o=r.interpreter.dateHelper.numberToSimpleDate(e),s=r.interpreter.dateHelper.dateToNumber({year:o.year,month:1,day:1}),u=r.interpreter.dateHelper.relativeNumberToAbsoluteNumber(s);if(21===t)return r.isoweeknumCore(e);var c=A.get(t);return void 0===c?new n.CellError(n.ErrorType.NUM,a.ErrorMessage.BadMode):Math.floor((i-c)/7)-Math.floor((u-c)/7)+1}))}},{key:"isoweeknum",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISOWEEKNUM"),this.isoweeknumCore)}},{key:"datevalue",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("DATEVALUE"),(function(e){var t=r.interpreter.dateHelper.parseDateTimeFromConfigFormats(e);return void 0===t?new n.CellError(n.ErrorType.VALUE,a.ErrorMessage.IncorrectDateTime):(0,i.instanceOfSimpleDate)(t)?((0,i.instanceOfSimpleTime)(t)?Math.trunc((0,i.timeToNumber)(t)):0)+r.interpreter.dateHelper.dateToNumber(t):0}))}},{key:"timevalue",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("TIMEVALUE"),(function(e){var t=r.interpreter.dateHelper.dateStringToDateNumber(e);return void 0===t?new n.CellError(n.ErrorType.VALUE,a.ErrorMessage.IncorrectDateTime):t%1}))}},{key:"now",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("NOW"),(function(){var e=new Date;return(0,i.timeToNumber)({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()})+r.interpreter.dateHelper.dateToNumber({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDay()})}))}},{key:"today",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("TODAY"),(function(){var e=new Date;return r.interpreter.dateHelper.dateToNumber({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDay()})}))}},{key:"edate",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("EDATE"),(function(e,t){var o,s=r.interpreter.dateHelper.numberToSimpleDate(e),u=(0,i.truncateDayInMonth)((0,i.offsetMonth)(s,t)),c=r.interpreter.dateHelper.dateToNumber(u);return null!==(o=r.interpreter.dateHelper.getWithinBounds(c))&&void 0!==o?o:new n.CellError(n.ErrorType.NUM,a.ErrorMessage.DateBounds)}))}},{key:"datedif",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("DATEDIF"),(function(e,t,i){if(e>t)return new n.CellError(n.ErrorType.NUM,a.ErrorMessage.StartEndDate);if("D"===i)return Math.floor(t)-Math.floor(e);var o=r.interpreter.dateHelper.numberToSimpleDate(e),s=r.interpreter.dateHelper.numberToSimpleDate(t);switch(i){case"M":return 12*(s.year-o.year)+(s.month-o.month)-(s.day<o.day?1:0);case"YM":return(s.month-o.month+12-(s.day<o.day?1:0))%12;case"Y":return s.month>o.month||s.month===o.month&&s.day>=o.day?s.year-o.year:s.year-o.year-1;case"MD":if(s.day>=o.day)return s.day-o.day;var u=1===s.month?12:s.month-1,c=1===s.month?s.year-1:s.year;return r.interpreter.dateHelper.daysInMonth(c,u)+s.day-o.day;case"YD":return s.month>o.month||s.month===o.month&&s.day>=o.day?Math.floor(t)-r.interpreter.dateHelper.dateToNumber({year:s.year,month:o.month,day:o.day}):Math.floor(t)-Math.floor(e)-365*(s.year-o.year-1)-r.interpreter.dateHelper.leapYearsCount(s.year-1)+r.interpreter.dateHelper.leapYearsCount(o.year);default:return new n.CellError(n.ErrorType.NUM,a.ErrorMessage.BadMode)}}))}},{key:"days360",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DAYS360"),this.days360Core)}},{key:"yearfrac",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("YEARFRAC"),(function(e,t,n){if((e=Math.trunc(e))>(t=Math.trunc(t))){var i=[t,e];e=i[0],t=i[1]}switch(n){case 0:return r.days360Core(e,t,!1)/360;case 1:return(t-e)/r.interpreter.dateHelper.yearLengthForBasis(r.interpreter.dateHelper.numberToSimpleDate(e),r.interpreter.dateHelper.numberToSimpleDate(t));case 2:return(t-e)/360;case 3:return(t-e)/365;case 4:return r.days360Core(e,t,!0)/360}throw new Error("Should not be reachable.")}))}},{key:"interval",value:function(e,t){return this.runFunction(e.args,t,this.metadata("INTERVAL"),(function(e){var t=(e=Math.trunc(e))%60,r=(e=Math.trunc(e/60))%60,n=(e=Math.trunc(e/60))%24,i=(e=Math.trunc(e/24))%30,a=(e=Math.trunc(e/30))%12,o=Math.trunc(e/12);return"P"+(o>0?o+"Y":"")+(a>0?a+"M":"")+(i>0?i+"D":"")+"T"+(n>0?n+"H":"")+(r>0?r+"M":"")+(t>0?t+"S":"")}))}},{key:"networkdays",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("NETWORKDAYS"),(function(e,t,n){return r.networkdayscore(e,t,1,n)}))}},{key:"networkdaysintl",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("NETWORKDAYS.INTL"),(function(e,t,n,i){return r.networkdayscore(e,t,n,i)}))}},{key:"workday",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("WORKDAY"),(function(e,t,n){return r.workdaycore(e,t,1,n)}))}},{key:"workdayintl",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("WORKDAY.INTL"),(function(e,t,n,i){return r.workdaycore(e,t,n,i)}))}},{key:"networkdayscore",value:function(e,t,r,i){var a=1;if((e=Math.trunc(e))>(t=Math.trunc(t))){var o=[t,e];e=o[0],t=o[1],a=-1}var s=x(r);if(s instanceof n.CellError)return s;var u=this.simpleRangeToFilteredHolidays(i,s);return u instanceof n.CellError?u:a*this.countWorkdays(e,t,s,u)}},{key:"workdaycore",value:function(e,t,r,i){e=Math.trunc(e),t=Math.trunc(t);var a=x(r);if(a instanceof n.CellError)return a;var o=this.simpleRangeToFilteredHolidays(i,a);if(o instanceof n.CellError)return o;if(t>0){for(var s=1;this.countWorkdays(e+1,e+s,a,o)<t;)s*=2;for(var u=1;u+1<s;){var c=Math.trunc((u+s)/2);this.countWorkdays(e+1,e+c,a,o)<t?u=c:s=c}return e+s}if(t<0){t*=-1;for(var l=1;this.countWorkdays(e-l,e-1,a,o)<t;)l*=2;for(var h=1;h+1<l;){var p=Math.trunc((h+l)/2);this.countWorkdays(e-p,e-1,a,o)<t?h=p:l=p}return e-l}return e}},{key:"countWorkdays",value:function(e,t,r,n){for(var i=Math.floor(this.interpreter.dateHelper.relativeNumberToAbsoluteNumber(t)),a=Math.floor(this.interpreter.dateHelper.relativeNumberToAbsoluteNumber(e)),o=0,s=0;s<7;s++)"0"===r.charAt(s)&&(o+=Math.floor((i+6-s)/7),o-=Math.floor((a-1+6-s)/7));return o-=b(t+1,n)-b(e,n)}},{key:"simpleRangeToFilteredHolidays",value:function(e,t){var r,i,o=this,s=null!==(r=null==e?void 0:e.valuesFromTopLeftCorner())&&void 0!==r?r:[],u=l(s);try{for(u.s();!(i=u.n()).done;){var h=i.value;if(h instanceof n.CellError)return h}}catch(e){u.e(e)}finally{u.f()}var p,f=[],d=l(s);try{for(d.s();!(p=d.n()).done;){var m=p.value;if(m!==n.EmptyValue){if("number"!=typeof m)return new n.CellError(n.ErrorType.VALUE,a.ErrorMessage.WrongType);f.push(Math.trunc(m))}}}catch(e){d.e(e)}finally{d.f()}return c(new Set(f)).sort((function(e,t){return e-t})).filter((function(e){var r=(o.interpreter.dateHelper.relativeNumberToAbsoluteNumber(e)-1)%7;return"0"===t.charAt(r)}))}}])&&m(t.prototype,r),s&&m(t,s),p}(s.FunctionPlugin);function b(e,t){if(0===t.length)return 0;if(e<=t[0])return 0;if(t[t.length-1]<e)return t.length;for(var r=0,n=t.length-1;r+1<n;){var i=Math.floor((n+r)/2);t[i]>=e?n=i:r=i}return n}function x(e){var t;return"number"!=typeof e&&"string"!=typeof e?new n.CellError(n.ErrorType.VALUE,a.ErrorMessage.WrongType):"string"==typeof e?7===e.length&&/^(0|1)*$/.test(e)&&"1111111"!==e?e:new n.CellError(n.ErrorType.NUM,a.ErrorMessage.WeekendString):null!==(t=S.get(e))&&void 0!==t?t:new n.CellError(n.ErrorType.NUM,a.ErrorMessage.BadMode)}t.DateTimePlugin=T,T.implementedFunctions={DATE:{method:"date",parameters:[{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.NUMBER}]},TIME:{method:"time",parameters:[{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.NUMBER}]},MONTH:{method:"month",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0}]},YEAR:{method:"year",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0}]},HOUR:{method:"hour",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0}]},MINUTE:{method:"minute",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0}]},SECOND:{method:"second",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0}]},TEXT:{method:"text",parameters:[{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.STRING}]},EOMONTH:{method:"eomonth",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.NUMBER}]},DAY:{method:"day",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0}]},DAYS:{method:"days",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.NUMBER,minValue:0}]},WEEKDAY:{method:"weekday",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.NUMBER,defaultValue:1}]},WEEKNUM:{method:"weeknum",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.NUMBER,defaultValue:1}]},ISOWEEKNUM:{method:"isoweeknum",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0}]},DATEVALUE:{method:"datevalue",parameters:[{argumentType:s.ArgumentTypes.STRING}]},TIMEVALUE:{method:"timevalue",parameters:[{argumentType:s.ArgumentTypes.STRING}]},NOW:{method:"now",parameters:[],isVolatile:!0},TODAY:{method:"today",parameters:[],isVolatile:!0},EDATE:{method:"edate",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.NUMBER}]},DAYS360:{method:"days360",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.BOOLEAN,defaultValue:!1}]},DATEDIF:{method:"datedif",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.STRING}]},YEARFRAC:{method:"yearfrac",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.INTEGER,defaultValue:0,minValue:0,maxValue:4}]},INTERVAL:{method:"interval",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0}]},NETWORKDAYS:{method:"networkdays",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.RANGE,optionalArg:!0}]},"NETWORKDAYS.INTL":{method:"networkdaysintl",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.NOERROR,defaultValue:1},{argumentType:s.ArgumentTypes.RANGE,optionalArg:!0}]},WORKDAY:{method:"workday",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.RANGE,optionalArg:!0}]},"WORKDAY.INTL":{method:"workdayintl",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.NOERROR,defaultValue:1},{argumentType:s.ArgumentTypes.RANGE,optionalArg:!0}]}};var A=new Map([[1,0],[2,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6],[17,0]]),S=new Map([[1,"0000011"],[2,"1000001"],[3,"1100000"],[4,"0110000"],[5,"0011000"],[6,"0001100"],[7,"0000110"],[11,"0000001"],[12,"1000000"],[13,"0100000"],[14,"0010000"],[15,"0001000"],[16,"0000100"],[17,"0000010"]])},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.DegreesPlugin=void 0;var n=r(315);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var i=l(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(c,e);var t,r,n,i=u(c);function c(){return a(this,c),i.apply(this,arguments)}return t=c,(r=[{key:"degrees",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DEGREES"),(function(e){return e*(180/Math.PI)}))}}])&&o(t.prototype,r),n&&o(t,n),c}(n.FunctionPlugin);t.DegreesPlugin=h,h.implementedFunctions={DEGREES:{method:"degrees",parameters:[{argumentType:n.ArgumentTypes.NUMBER}]}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.DeltaPlugin=void 0;var n=r(315);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var i=l(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(c,e);var t,r,n,i=u(c);function c(){return a(this,c),i.apply(this,arguments)}return t=c,(r=[{key:"delta",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DELTA"),(function(e,t){return e===t?1:0}))}}])&&o(t.prototype,r),n&&o(t,n),c}(n.FunctionPlugin);t.DeltaPlugin=h,h.implementedFunctions={DELTA:{method:"delta",parameters:[{argumentType:n.ArgumentTypes.NUMBER},{argumentType:n.ArgumentTypes.NUMBER,defaultValue:0}]}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(140),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.ErrorFunctionPlugin=void 0;var n=r(315);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var i=l(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(c,e);var t,r,n,i=u(c);function c(){return a(this,c),i.apply(this,arguments)}return t=c,(r=[{key:"erf",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ERF"),(function(e,t){return void 0===t?p(e):p(t)-p(e)}))}},{key:"erfc",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ERFC"),d)}}])&&o(t.prototype,r),n&&o(t,n),c}(n.FunctionPlugin);function p(e){return e>=0?f(e):-f(-e)}function f(e){var t=[.0705230784,.0422820123,.0092705272,.0001520143,.0002765672,430638e-10].reduce((function(t,r,n){return t+r*Math.pow(e,n+1)}),1);return 1-1/Math.pow(t,16)}function d(e){return 1-p(e)}t.ErrorFunctionPlugin=h,h.implementedFunctions={ERF:{method:"erf",parameters:[{argumentType:n.ArgumentTypes.NUMBER},{argumentType:n.ArgumentTypes.NUMBER,optionalArg:!0}]},ERFC:{method:"erfc",parameters:[{argumentType:n.ArgumentTypes.NUMBER}]}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.ExpPlugin=void 0;var n=r(315);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var i=l(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(c,e);var t,r,n,i=u(c);function c(){return a(this,c),i.apply(this,arguments)}return t=c,(r=[{key:"exp",value:function(e,t){return this.runFunction(e.args,t,this.metadata("EXP"),Math.exp)}}])&&o(t.prototype,r),n&&o(t,n),c}(n.FunctionPlugin);t.ExpPlugin=h,h.implementedFunctions={EXP:{method:"exp",parameters:[{argumentType:n.ArgumentTypes.NUMBER}]}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(65),r(75),r(84),r(89),r(325),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.FinancialPlugin=void 0;var n=r(106),i=r(213),a=r(315);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=d(e);if(t){var i=d(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(u,e);var t,r,a,o=p(u);function u(){return c(this,u),o.apply(this,arguments)}return t=u,(r=[{key:"pmt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("PMT"),y)}},{key:"ipmt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IPMT"),g)}},{key:"ppmt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("PPMT"),E)}},{key:"fv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FV"),v)}},{key:"cumipmt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CUMIPMT"),(function(e,t,r,a,o,s){if(a>o)return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.EndStartPeriod);for(var u=0,c=a;c<=o;c++)u+=g(e,c,t,r,0,s);return u}))}},{key:"cumprinc",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CUMPRINC"),(function(e,t,r,a,o,s){if(a>o)return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.EndStartPeriod);for(var u=0,c=a;c<=o;c++)u+=E(e,c,t,r,0,s);return u}))}},{key:"db",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DB"),(function(e,t,r,a,o){if(12===o&&a>r||a>r+1)return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.PeriodLong);if(t>=e)return 0;var s=Math.round(1e3*(1-Math.pow(t/e,1/r)))/1e3,u=e*s*o/12;if(1===a)return u;for(var c=u,l=0;l<a-2;l++)c+=(e-c)*s;return a===r+1?(e-c)*s*(12-o)/12:(e-c)*s}))}},{key:"ddb",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DDB"),(function(e,t,r,i,a){if(i>r)return new n.CellError(n.ErrorType.NUM);var o,s=a/r;s>=1?(s=1,o=1===i?e:0):o=e*Math.pow(1-s,i-1);var u=e*Math.pow(1-s,i);return Math.max(o-Math.max(t,u),0)}))}},{key:"dollarde",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARDE"),(function(e,t){if(t<1)return new n.CellError(n.ErrorType.DIV_BY_ZERO);for(t=Math.trunc(t);t>10;)t/=10;return Math.trunc(e)+10*(e-Math.trunc(e))/t}))}},{key:"dollarfr",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARFR"),(function(e,t){if(t<1)return new n.CellError(n.ErrorType.DIV_BY_ZERO);for(t=Math.trunc(t);t>10;)t/=10;return Math.trunc(e)+(e-Math.trunc(e))*t/10}))}},{key:"effect",value:function(e,t){return this.runFunction(e.args,t,this.metadata("EFFECT"),(function(e,t){return t=Math.trunc(t),Math.pow(1+e/t,t)-1}))}},{key:"ispmt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISPMT"),(function(e,t,r,i){return 0===r?new n.CellError(n.ErrorType.DIV_BY_ZERO):i*e*(t/r-1)}))}},{key:"nominal",value:function(e,t){return this.runFunction(e.args,t,this.metadata("NOMINAL"),(function(e,t){return t=Math.trunc(t),(Math.pow(e+1,1/t)-1)*t}))}},{key:"nper",value:function(e,t){return this.runFunction(e.args,t,this.metadata("NPER"),(function(e,t,r,i,a){return 0===e?0===t?new n.CellError(n.ErrorType.DIV_BY_ZERO):(-r-i)/t:(a&&(t*=1+e),Math.log((t-i*e)/(r*e+t))/Math.log(1+e))}))}},{key:"rate",value:function(e,t){return this.runFunction(e.args,t,this.metadata("RATE"),(function(e,t,r,i,a,o){if(o<=-1)return new n.CellError(n.ErrorType.VALUE);var s=o;a=a?1:0;for(var u=0;u<20;u++){if(s<=-1)return new n.CellError(n.ErrorType.NUM);var c=void 0;if(Math.abs(s)<1e-10)c=r*(1+e*s)+t*(1+s*a)*e+i;else{var l=Math.pow(1+s,e);c=r*l+t*(1/s+a)*(l-1)+i}if(Math.abs(c)<1e-10)return s;var h=void 0;if(Math.abs(s)<1e-10)h=r*e+t*a*e;else{var p=Math.pow(1+s,e),f=e*Math.pow(1+s,e-1);h=r*f+t*(1/s+a)*f+t*(-1/(s*s))*(p-1)}s-=c/h}return new n.CellError(n.ErrorType.NUM)}))}},{key:"pv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("PV"),(function(e,t,r,i,a){return a=a?1:0,-1===e?0===t?new n.CellError(n.ErrorType.NUM):new n.CellError(n.ErrorType.DIV_BY_ZERO):0===e?-r*t-i:((1-Math.pow(1+e,t))*r*(1+e*a)/e-i)/Math.pow(1+e,t)}))}},{key:"rri",value:function(e,t){return this.runFunction(e.args,t,this.metadata("RRI"),(function(e,t,r){return 0===t||r<0&&t>0||r>0&&t<0?new n.CellError(n.ErrorType.NUM):Math.pow(r/t,1/e)-1}))}},{key:"sln",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SLN"),(function(e,t,r){return 0===r?new n.CellError(n.ErrorType.DIV_BY_ZERO):(e-t)/r}))}},{key:"syd",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SYD"),(function(e,t,r,i){return i>r?new n.CellError(n.ErrorType.NUM):(e-t)*(r-i+1)*2/(r*(r+1))}))}},{key:"tbilleq",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("TBILLEQ"),(function(e,t,i){if((e=Math.round(e))>=(t=Math.round(t)))return new n.CellError(n.ErrorType.NUM);var a=r.interpreter.dateHelper.numberToSimpleDate(e),o=r.interpreter.dateHelper.numberToSimpleDate(t);if(o.year>a.year+1||o.year===a.year+1&&(o.month>a.month||o.month===a.month&&o.day>a.day))return new n.CellError(n.ErrorType.NUM);var s=360-i*(t-e);return 0===s?0:s<0?new n.CellError(n.ErrorType.NUM):365*i/s}))}},{key:"tbillprice",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("TBILLPRICE"),(function(e,t,i){if((e=Math.round(e))>=(t=Math.round(t)))return new n.CellError(n.ErrorType.NUM);var a=r.interpreter.dateHelper.numberToSimpleDate(e),o=r.interpreter.dateHelper.numberToSimpleDate(t);if(o.year>a.year+1||o.year===a.year+1&&(o.month>a.month||o.month===a.month&&o.day>a.day))return new n.CellError(n.ErrorType.NUM);var s=360-i*(t-e);return 0===s?0:s<0?new n.CellError(n.ErrorType.NUM):100*(1-i*(t-e)/360)}))}},{key:"tbillyield",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("TBILLYIELD"),(function(e,t,i){if((e=Math.round(e))>=(t=Math.round(t)))return new n.CellError(n.ErrorType.NUM);var a=r.interpreter.dateHelper.numberToSimpleDate(e),o=r.interpreter.dateHelper.numberToSimpleDate(t);return o.year>a.year+1||o.year===a.year+1&&(o.month>a.month||o.month===a.month&&o.day>a.day)?new n.CellError(n.ErrorType.NUM):360*(100-i)/(i*(t-e))}))}},{key:"fvschedule",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FVSCHEDULE"),(function(e,t){var r,a=t.valuesFromTopLeftCorner(),o=s(a);try{for(o.s();!(r=o.n()).done;){var u=r.value;if(u instanceof n.CellError)return u}}catch(e){o.e(e)}finally{o.f()}var c,l=s(a);try{for(l.s();!(c=l.n()).done;){var h=c.value;if("number"==typeof h)e*=1+h;else if(h!==n.EmptyValue)return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.NumberExpected)}}catch(e){l.e(e)}finally{l.f()}return e}))}},{key:"npv",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("NPV"),(function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),a=1;a<t;a++)i[a-1]=arguments[a];var o=r.interpreter.arithmeticHelper.coerceNumbersExpandRanges(i);return o instanceof n.CellError?o:T(e,o)}))}},{key:"mirr",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("MIRR"),(function(e,t,i){var a=r.interpreter.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());if(a instanceof n.CellError)return a;var o,u=!1,c=!1,l=[],h=[],p=s(a);try{for(p.s();!(o=p.n()).done;){var f=o.value;f>0?(u=!0,l.push(f),h.push(0)):f<0?(c=!0,h.push(f),l.push(0)):(h.push(0),l.push(0))}}catch(e){p.e(e)}finally{p.f()}if(!u||!c)return new n.CellError(n.ErrorType.DIV_BY_ZERO);var d=a.length,m=T(i,l);if(m instanceof n.CellError)return m;var y=T(t,h);return y instanceof n.CellError?y:Math.pow(-m*Math.pow(1+i,d)/y/(1+t),1/(d-1))-1}))}},{key:"pduration",value:function(e,t){return this.runFunction(e.args,t,this.metadata("PDURATION"),(function(e,t,r){return(Math.log(r)-Math.log(t))/Math.log(1+e)}))}},{key:"xnpv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("XNPV"),(function(e,t,r){var a,o=t.valuesFromTopLeftCorner(),u=s(o);try{for(u.s();!(a=u.n()).done;)if("number"!=typeof a.value)return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.NumberExpected)}catch(e){u.e(e)}finally{u.f()}var c,l=o,h=r.valuesFromTopLeftCorner(),p=s(h);try{for(p.s();!(c=p.n()).done;)if("number"!=typeof c.value)return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.NumberExpected)}catch(e){p.e(e)}finally{p.f()}var f=h;if(f.length!==l.length)return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.EqualLength);var d=f.length,m=0;if(f[0]<0)return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueSmall);for(var y=0;y<d;y++){if(f[y]=Math.floor(f[y]),f[y]<f[0])return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueSmall);m+=l[y]/Math.pow(1+e,(f[y]-f[0])/365)}return m}))}}])&&l(t.prototype,r),a&&l(t,a),u}(a.FunctionPlugin);function y(e,t,r,n,i){if(0===e)return(-r-n)/t;var a=Math.pow(1+e,t);return(n*e+r*e*a)*(i?1/(1+e):1)/(1-a)}function g(e,t,r,n,i,a){var o=y(e,r,n,i,a);return 1===t?e*(a?0:-n):e*(a?v(e,t-2,o,n,a)-o:v(e,t-1,o,n,a))}function v(e,t,r,n,i){if(0===e)return-n-r*t;var a=Math.pow(1+e,t);return r*(i?1+e:1)*(1-a)/e-n*a}function E(e,t,r,n,i,a){return y(e,r,n,i,a)-g(e,t,r,n,i,a)}function T(e,t){for(var r=0,i=t.length-1;i>=0;i--){if(r+=t[i],-1===e){if(0===r)continue;return new n.CellError(n.ErrorType.DIV_BY_ZERO)}r/=1+e}return r}t.FinancialPlugin=m,m.implementedFunctions={PMT:{method:"pmt",parameters:[{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER,defaultValue:0},{argumentType:a.ArgumentTypes.NUMBER,defaultValue:0}]},IPMT:{method:"ipmt",parameters:[{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER,defaultValue:0},{argumentType:a.ArgumentTypes.NUMBER,defaultValue:0}]},PPMT:{method:"ppmt",parameters:[{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER,defaultValue:0},{argumentType:a.ArgumentTypes.NUMBER,defaultValue:0}]},FV:{method:"fv",parameters:[{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER,defaultValue:0},{argumentType:a.ArgumentTypes.NUMBER,defaultValue:0}]},CUMIPMT:{method:"cumipmt",parameters:[{argumentType:a.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:a.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:a.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:a.ArgumentTypes.INTEGER,minValue:1},{argumentType:a.ArgumentTypes.INTEGER,minValue:1},{argumentType:a.ArgumentTypes.INTEGER,minValue:0,maxValue:1}]},CUMPRINC:{method:"cumprinc",parameters:[{argumentType:a.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:a.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:a.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:a.ArgumentTypes.INTEGER,minValue:1},{argumentType:a.ArgumentTypes.INTEGER,minValue:1},{argumentType:a.ArgumentTypes.INTEGER,minValue:0,maxValue:1}]},DB:{method:"db",parameters:[{argumentType:a.ArgumentTypes.NUMBER,minValue:0},{argumentType:a.ArgumentTypes.NUMBER,minValue:0},{argumentType:a.ArgumentTypes.INTEGER,minValue:0},{argumentType:a.ArgumentTypes.INTEGER,minValue:0},{argumentType:a.ArgumentTypes.INTEGER,minValue:1,maxValue:12,defaultValue:12}]},DDB:{method:"ddb",parameters:[{argumentType:a.ArgumentTypes.NUMBER,minValue:0},{argumentType:a.ArgumentTypes.NUMBER,minValue:0},{argumentType:a.ArgumentTypes.INTEGER,minValue:0},{argumentType:a.ArgumentTypes.NUMBER,minValue:0},{argumentType:a.ArgumentTypes.NUMBER,greaterThan:0,defaultValue:2}]},DOLLARDE:{method:"dollarde",parameters:[{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER,minValue:0}]},DOLLARFR:{method:"dollarfr",parameters:[{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER,minValue:0}]},EFFECT:{method:"effect",parameters:[{argumentType:a.ArgumentTypes.NUMBER,minValue:0},{argumentType:a.ArgumentTypes.NUMBER,minValue:1}]},ISPMT:{method:"ispmt",parameters:[{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER}]},NOMINAL:{method:"nominal",parameters:[{argumentType:a.ArgumentTypes.NUMBER,minValue:0},{argumentType:a.ArgumentTypes.NUMBER,minValue:1}]},NPER:{method:"nper",parameters:[{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER,defaultValue:0},{argumentType:a.ArgumentTypes.NUMBER,defaultValue:0}]},PV:{method:"pv",parameters:[{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER,defaultValue:0},{argumentType:a.ArgumentTypes.NUMBER,defaultValue:0}]},RATE:{method:"rate",parameters:[{argumentType:a.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER,defaultValue:0},{argumentType:a.ArgumentTypes.NUMBER,defaultValue:0},{argumentType:a.ArgumentTypes.NUMBER,defaultValue:.1}]},RRI:{method:"rri",parameters:[{argumentType:a.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER}]},SLN:{method:"sln",parameters:[{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER}]},SYD:{method:"syd",parameters:[{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:a.ArgumentTypes.NUMBER,greaterThan:0}]},TBILLEQ:{method:"tbilleq",parameters:[{argumentType:a.ArgumentTypes.NUMBER,minValue:0},{argumentType:a.ArgumentTypes.NUMBER,minValue:0},{argumentType:a.ArgumentTypes.NUMBER,greaterThan:0}]},TBILLPRICE:{method:"tbillprice",parameters:[{argumentType:a.ArgumentTypes.NUMBER,minValue:0},{argumentType:a.ArgumentTypes.NUMBER,minValue:0},{argumentType:a.ArgumentTypes.NUMBER,greaterThan:0}]},TBILLYIELD:{method:"tbillyield",parameters:[{argumentType:a.ArgumentTypes.NUMBER,minValue:0},{argumentType:a.ArgumentTypes.NUMBER,minValue:0},{argumentType:a.ArgumentTypes.NUMBER,greaterThan:0}]},FVSCHEDULE:{method:"fvschedule",parameters:[{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.RANGE}]},NPV:{method:"npv",parameters:[{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.ANY}],repeatLastArgs:1},MIRR:{method:"mirr",parameters:[{argumentType:a.ArgumentTypes.RANGE},{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER}]},PDURATION:{method:"pduration",parameters:[{argumentType:a.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:a.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:a.ArgumentTypes.NUMBER,greaterThan:0}]},XNPV:{method:"xnpv",parameters:[{argumentType:a.ArgumentTypes.NUMBER,greaterThan:-1},{argumentType:a.ArgumentTypes.RANGE},{argumentType:a.ArgumentTypes.RANGE}]}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.FormulaTextPlugin=void 0;var n=r(213),i=r(106),a=r(338),o=r(315);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f(e);if(t){var i=f(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(s,e);var t,r,a,o=h(s);function s(){return u(this,s),o.apply(this,arguments)}return t=s,(r=[{key:"formulatext",value:function(e,t){var r=this;return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("FORMULATEXT"),(function(){return new i.CellError(i.ErrorType.NA,n.ErrorMessage.WrongArgNumber)}),(function(e){var t;return null!==(t=r.serialization.getCellFormula(e))&&void 0!==t?t:new i.CellError(i.ErrorType.NA,n.ErrorMessage.Formula)}))}}])&&c(t.prototype,r),a&&c(t,a),s}(a.FunctionPlugin);t.FormulaTextPlugin=d,d.implementedFunctions={FORMULATEXT:{method:"formulatext",parameters:[{argumentType:o.ArgumentTypes.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,isDependentOnSheetStructureChange:!0}}},function(e,t,r){"use strict";t.__esModule=!0;var n=r(315);t.FunctionPlugin=n.FunctionPlugin},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(206),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.InformationPlugin=void 0;var n=r(106),i=r(107),a=r(213),o=r(138),s=r(315);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=d(e);if(t){var i=d(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(d,e);var t,r,u,f=p(d);function d(){return c(this,d),f.apply(this,arguments)}return t=d,(r=[{key:"isbinary",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISBINARY"),(function(e){return/^[01]{1,10}$/.test(e)}))}},{key:"iserr",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISERR"),(function(e){return e instanceof n.CellError&&e.type!==n.ErrorType.NA}))}},{key:"iserror",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISERROR"),(function(e){return e instanceof n.CellError}))}},{key:"isformula",value:function(e,t){var r=this;return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ISFORMULA"),(function(){return new n.CellError(n.ErrorType.NA,a.ErrorMessage.WrongArgNumber)}),(function(e){var t=r.dependencyGraph.addressMapping.getCell(e);return t instanceof i.FormulaCellVertex||t instanceof i.MatrixVertex&&t.isFormula()}))}},{key:"isblank",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISBLANK"),(function(e){return e===n.EmptyValue}))}},{key:"isna",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISNA"),(function(e){return e instanceof n.CellError&&e.type==n.ErrorType.NA}))}},{key:"isnumber",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISNUMBER"),(function(e){return"number"==typeof e}))}},{key:"islogical",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISLOGICAL"),(function(e){return"boolean"==typeof e}))}},{key:"isref",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISREF"),(function(e){return e instanceof n.CellError&&(e.type==n.ErrorType.REF||e.type==n.ErrorType.CYCLE)}))}},{key:"istext",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISTEXT"),(function(e){return"string"==typeof e}))}},{key:"isnontext",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISNONTEXT"),(function(e){return"string"!=typeof e}))}},{key:"column",value:function(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("COLUMN"),(function(){return t.col+1}),(function(e){return e.col+1}))}},{key:"columns",value:function(e,t){if(1!==e.args.length)return new n.CellError(n.ErrorType.NA,a.ErrorMessage.WrongArgNumber);if(e.args.some((function(e){return e.type===o.AstNodeType.EMPTY})))return new n.CellError(n.ErrorType.NUM,a.ErrorMessage.EmptyArg);var r=e.args[0];return r.type===o.AstNodeType.CELL_RANGE?r.end.col-r.start.col+1:new n.CellError(n.ErrorType.VALUE,a.ErrorMessage.CellRangeExpected)}},{key:"row",value:function(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ROW"),(function(){return t.row+1}),(function(e){return e.row+1}))}},{key:"rows",value:function(e,t){if(1!==e.args.length)return new n.CellError(n.ErrorType.NA,a.ErrorMessage.WrongArgNumber);if(e.args.some((function(e){return e.type===o.AstNodeType.EMPTY})))return new n.CellError(n.ErrorType.NUM,a.ErrorMessage.EmptyArg);var r=e.args[0];return r.type===o.AstNodeType.CELL_RANGE?r.end.row-r.start.row+1:new n.CellError(n.ErrorType.VALUE,a.ErrorMessage.CellRangeExpected)}},{key:"index",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("INDEX"),(function(e,t,i){var o;if(i<1||t<1)return new n.CellError(n.ErrorType.VALUE,a.ErrorMessage.LessThanOne);if(i>e.width()||t>e.height())return new n.CellError(n.ErrorType.NUM,a.ErrorMessage.ValueLarge);var s=e.range();if(void 0===s)return null!==(o=e.topLeftCornerValue())&&void 0!==o?o:new n.CellError(n.ErrorType.VALUE,a.ErrorMessage.CellRangeExpected);var u=s.getAddress(i-1,t-1);return r.dependencyGraph.getScalarValue(u)}))}},{key:"na",value:function(e,t){return new n.CellError(n.ErrorType.NA)}},{key:"sheet",value:function(e,t){var r=this;return this.runFunctionWithReferenceArgument(e.args,t,{parameters:[{argumentType:s.ArgumentTypes.STRING}]},(function(){return t.sheet+1}),(function(e){return e.sheet+1}),(function(e){var t=r.dependencyGraph.sheetMapping.get(e);return void 0!==t?t+1:new n.CellError(n.ErrorType.NA,a.ErrorMessage.SheetRef)}))}},{key:"sheets",value:function(e,t){var r=this;return this.runFunctionWithReferenceArgument(e.args,t,{parameters:[{argumentType:s.ArgumentTypes.STRING}]},(function(){return r.dependencyGraph.sheetMapping.numberOfSheets()}),(function(){return 1}),(function(){return new n.CellError(n.ErrorType.VALUE,a.ErrorMessage.CellRefExpected)}))}}])&&l(t.prototype,r),u&&l(t,u),d}(s.FunctionPlugin);t.InformationPlugin=m,m.implementedFunctions={COLUMN:{method:"column",parameters:[{argumentType:s.ArgumentTypes.NOERROR,optional:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0},COLUMNS:{method:"columns",isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0},ISBINARY:{method:"isbinary",parameters:[{argumentType:s.ArgumentTypes.STRING}]},ISERR:{method:"iserr",parameters:[{argumentType:s.ArgumentTypes.SCALAR}]},ISFORMULA:{method:"isformula",parameters:[{argumentType:s.ArgumentTypes.NOERROR}],doesNotNeedArgumentsToBeComputed:!0},ISNA:{method:"isna",parameters:[{argumentType:s.ArgumentTypes.SCALAR}]},ISREF:{method:"isref",parameters:[{argumentType:s.ArgumentTypes.SCALAR}]},ISERROR:{method:"iserror",parameters:[{argumentType:s.ArgumentTypes.SCALAR}]},ISBLANK:{method:"isblank",parameters:[{argumentType:s.ArgumentTypes.SCALAR}]},ISNUMBER:{method:"isnumber",parameters:[{argumentType:s.ArgumentTypes.SCALAR}]},ISLOGICAL:{method:"islogical",parameters:[{argumentType:s.ArgumentTypes.SCALAR}]},ISTEXT:{method:"istext",parameters:[{argumentType:s.ArgumentTypes.SCALAR}]},ISNONTEXT:{method:"isnontext",parameters:[{argumentType:s.ArgumentTypes.SCALAR}]},INDEX:{method:"index",parameters:[{argumentType:s.ArgumentTypes.RANGE},{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.NUMBER,defaultValue:1}]},NA:{method:"na"},ROW:{method:"row",parameters:[{argumentType:s.ArgumentTypes.NOERROR,optional:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0},ROWS:{method:"rows",isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0},SHEET:{method:"sheet",parameters:[{argumentType:s.ArgumentTypes.NOERROR}],doesNotNeedArgumentsToBeComputed:!0},SHEETS:{method:"sheets",parameters:[{argumentType:s.ArgumentTypes.NOERROR}],doesNotNeedArgumentsToBeComputed:!0}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.IsEvenPlugin=void 0;var n=r(315);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var i=l(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(c,e);var t,r,n,i=u(c);function c(){return a(this,c),i.apply(this,arguments)}return t=c,(r=[{key:"iseven",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISEVEN"),(function(e){return e%2==0}))}}])&&o(t.prototype,r),n&&o(t,n),c}(n.FunctionPlugin);t.IsEvenPlugin=h,h.implementedFunctions={ISEVEN:{method:"iseven",parameters:[{argumentType:n.ArgumentTypes.NUMBER}]}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.IsOddPlugin=void 0;var n=r(315);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var i=l(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(c,e);var t,r,n,i=u(c);function c(){return a(this,c),i.apply(this,arguments)}return t=c,(r=[{key:"isodd",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISODD"),(function(e){return e%2==1}))}}])&&o(t.prototype,r),n&&o(t,n),c}(n.FunctionPlugin);t.IsOddPlugin=h,h.implementedFunctions={ISODD:{method:"isodd",parameters:[{argumentType:n.ArgumentTypes.NUMBER}]}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(254),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.LogarithmPlugin=void 0;var n=r(315);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var i=l(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(c,e);var t,r,n,i=u(c);function c(){return a(this,c),i.apply(this,arguments)}return t=c,(r=[{key:"log10",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LOG10"),Math.log10)}},{key:"log",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LOG"),(function(e,t){return Math.log(e)/Math.log(t)}))}},{key:"ln",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LN"),Math.log)}}])&&o(t.prototype,r),n&&o(t,n),c}(n.FunctionPlugin);t.LogarithmPlugin=h,h.implementedFunctions={LOG10:{method:"log10",parameters:[{argumentType:n.ArgumentTypes.NUMBER}]},LOG:{method:"log",parameters:[{argumentType:n.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:n.ArgumentTypes.NUMBER,defaultValue:10,greaterThan:0}]},LN:{method:"ln",parameters:[{argumentType:n.ArgumentTypes.NUMBER}]}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(296),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.MathConstantsPlugin=t.PI=void 0;var n=r(315);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var i=l(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=parseFloat(Math.PI.toFixed(14));t.PI=h;var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(c,e);var t,r,n,i=u(c);function c(){return a(this,c),i.apply(this,arguments)}return t=c,(r=[{key:"pi",value:function(e,t){return this.runFunction(e.args,t,this.metadata("PI"),(function(){return h}))}}])&&o(t.prototype,r),n&&o(t,n),c}(n.FunctionPlugin);t.MathConstantsPlugin=p,p.implementedFunctions={PI:{method:"pi",parameters:[]}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(65),r(75),r(84),r(206),r(89),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.MatrixPlugin=void 0;var n=r(106),i=r(213),a=r(232),o=r(138),s=r(261),u=r(246);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return h(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g(e);if(t){var i=g(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return y(this,r)}}function y(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(y,e);var t,r,c,h=m(y);function y(){return p(this,y),h.apply(this,arguments)}return t=y,(r=[{key:"mmult",value:function(e,t){if(2!==e.args.length)return new n.CellError(n.ErrorType.NA,i.ErrorMessage.WrongArgNumber);if(e.args.some((function(e){return e.type===o.AstNodeType.EMPTY})))return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.EmptyArg);var r=l(e.args,2),c=r[0],h=r[1],p=(0,s.coerceToRangeNumbersOrError)(this.evaluateAst(c,t)),f=(0,s.coerceToRangeNumbersOrError)(this.evaluateAst(h,t));if(p instanceof n.CellError)return p;if(f instanceof n.CellError)return f;if(null===p||null===f)return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.NumberRange);var d=(0,a.matrixSizeForMultiplication)(p.size,f.size),m=this.interpreter.getGpuInstance().createKernel((function(e,t,r){for(var n=0,i=0;i<r;++i)n+=e[this.thread.y][i]*t[i][this.thread.x];return n})).setPrecision("unsigned").setOutput([d.width,d.height]);return u.SimpleRangeValue.onlyNumbersDataWithoutRange(m(p.rawNumbers(),f.rawNumbers(),p.width()),d)}},{key:"maxpool",value:function(e,t){var r=l(e.args,2),c=r[0],h=r[1],p=(0,s.coerceToRangeNumbersOrError)(this.evaluateAst(c,t)),f=h.value,d=f;if(e.args.some((function(e){return e.type===o.AstNodeType.EMPTY})))return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.EmptyArg);if(3===e.args.length){var m=e.args[2];if(m.type!==o.AstNodeType.NUMBER)return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.NumberExpected);d=m.value}if(p instanceof n.CellError)return p;if(null===p)return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.NumberRange);var y=(0,a.matrixSizeForPoolFunction)(p.size,f,d),g=this.interpreter.getGpuInstance().createKernel((function(e,t,r){for(var n=this.thread.x*r,i=this.thread.y*r,a=e[i][n],o=0;o<t;o++)for(var s=0;s<t;s++)a=Math.max(a,e[i+o][n+s]);return a})).setPrecision("unsigned").setOutput([y.width,y.height]);return u.SimpleRangeValue.onlyNumbersDataWithoutRange(g(p.rawNumbers(),f,d),y)}},{key:"medianpool",value:function(e,t){var r=l(e.args,2),c=r[0],h=r[1];if(e.args.some((function(e){return e.type===o.AstNodeType.EMPTY})))return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.EmptyArg);var p=(0,s.coerceToRangeNumbersOrError)(this.evaluateAst(c,t)),f=h.value,d=f;if(3===e.args.length){var m=e.args[2];if(m.type!==o.AstNodeType.NUMBER)return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.NumberExpected);d=m.value}if(p instanceof n.CellError)return p;if(null===p)return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.NumberRange);var y=(0,a.matrixSizeForPoolFunction)(p.size,f,d),g=this.interpreter.getGpuInstance().createKernel((function(e,t,r){for(var n=this.thread.x*r,i=this.thread.y*r,a=e[i][n],o=0;o<t;o++)for(var s=0;s<t;s++)a=Math.max(a,e[i+o][n+s]);for(var u=e[i][n],c=0;c<t;c++)for(var l=0;l<t;l++)u=Math.min(u,e[i+c][n+l]);for(var h=t*t,p=u,f=a,d=42,m=0;m<32;m++){for(var y=(p+f)/2,g=0,v=0;v<t;v++)for(var E=0;E<t;E++)e[i+v][n+E]>y&&g++;if(t%2==0){if(g===h/2){d=y;break}g>h/2?p=y:f=y}else{if(g===(h-1)/2){d=y;break}g>(h-1)/2?p=y:f=y}}return d})).setPrecision("unsigned").setOutput([y.width,y.height]);return u.SimpleRangeValue.onlyNumbersDataWithoutRange(g(p.rawNumbers(),f,d),y)}},{key:"transpose",value:function(e,t){if(1!==e.args.length)return new n.CellError(n.ErrorType.NA,i.ErrorMessage.WrongArgNumber);if(e.args.some((function(e){return e.type===o.AstNodeType.EMPTY})))return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.EmptyArg);var r=(0,s.coerceToRangeNumbersOrError)(this.evaluateAst(e.args[0],t));if(r instanceof n.CellError)return r;if(null===r)return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.NumberRange);for(var c=r.rawNumbers(),l=r.size,h=[],p=0;p<l.width;++p){h[p]=[];for(var f=0;f<l.height;++f)h[p][f]=c[f][p]}return u.SimpleRangeValue.onlyNumbersDataWithoutRange(h,(0,a.matrixSizeForTranspose)(l))}}])&&f(t.prototype,r),c&&f(t,c),y}(r(315).FunctionPlugin);t.MatrixPlugin=v,v.implementedFunctions={MMULT:{method:"mmult"},TRANSPOSE:{method:"transpose"},MAXPOOL:{method:"maxpool"},MEDIANPOOL:{method:"medianpool"}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(229),r(110),r(75),r(239),r(91),r(92),r(94),r(96),r(98),r(124),r(104),t.__esModule=!0,t.MedianPlugin=void 0;var n=r(106),i=r(213),a=r(138),o=r(315);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f(e);if(t){var i=f(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(p,e);var t,r,o,s=h(p);function p(){return u(this,p),s.apply(this,arguments)}return t=p,(r=[{key:"median",value:function(e,t){return this.runFunction(e.args,t,this.metadata("MEDIAN"),(function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];var s=r.filter((function(e){return"number"==typeof e}));return e.args.forEach((function(e){e.type===a.AstNodeType.EMPTY&&s.push(0)})),0===s.length?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.OneValue):(s.sort((function(e,t){return e-t})),s.length%2==0?(s[s.length/2-1]+s[s.length/2])/2:s[Math.floor(s.length/2)])}))}}])&&c(t.prototype,r),o&&c(t,o),p}(o.FunctionPlugin);t.MedianPlugin=d,d.implementedFunctions={MEDIAN:{method:"median",parameters:[{argumentType:o.ArgumentTypes.NOERROR}],repeatLastArgs:1,expandRanges:!0}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.ModuloPlugin=void 0;var n=r(106),i=r(315);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h(e);if(t){var i=h(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return l(this,r)}}function l(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(l,e);var t,r,i,a=c(l);function l(){return o(this,l),a.apply(this,arguments)}return t=l,(r=[{key:"mod",value:function(e,t){return this.runFunction(e.args,t,this.metadata("MOD"),(function(e,t){return 0===t?new n.CellError(n.ErrorType.DIV_BY_ZERO):e%t}))}}])&&s(t.prototype,r),i&&s(t,i),l}(i.FunctionPlugin);t.ModuloPlugin=p,p.implementedFunctions={MOD:{method:"mod",parameters:[{argumentType:i.ArgumentTypes.NUMBER},{argumentType:i.ArgumentTypes.NUMBER}]}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(229),r(65),r(75),r(113),r(140),r(84),r(89),r(133),r(136),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.NumericAggregationPlugin=void 0;var n,i=(n=r(126))&&n.__esModule?n:{default:n},a=r(132),o=r(106),s=r(213),u=r(138),c=r(261),l=r(246),h=r(315);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v(e);if(t){var i=v(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return g(this,r)}}function g(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function b(e,t,r){return t&&T(e.prototype,t),r&&T(e,r),e}function x(e){return e}function A(e){return"number"!=typeof e||Number.isFinite(e)?e:0}var S=function(){function e(t,r,n){E(this,e),this.sumsq=t,this.sum=r,this.count=n}return b(e,[{key:"compose",value:function(t){return new e(this.sumsq+t.sumsq,this.sum+t.sum,this.count+t.count)}},{key:"averageValue",value:function(){return this.count>0?this.sum/this.count:void 0}},{key:"varSValue",value:function(){return this.count>1?(this.sumsq-this.sum*this.sum/this.count)/(this.count-1):void 0}},{key:"varPValue",value:function(){return this.count>0?(this.sumsq-this.sum*this.sum/this.count)/this.count:void 0}}],[{key:"single",value:function(t){return new e(t*t,t,1)}}]),e}();S.empty=new S(0,0,0);var R=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(r,e);var t=y(r);function r(){var e;return E(this,r),(e=t.apply(this,arguments)).addWithEpsilon=function(t,r){return e.interpreter.arithmeticHelper.addWithEpsilon(t,r)},e}return b(r,[{key:"sum",value:function(e,t){return this.doSum(e.args,t)}},{key:"sumsq",value:function(e,t){return this.reduce(e.args,t,0,"SUMSQ",this.addWithEpsilon,(function(e){return e*e}),w)}},{key:"max",value:function(e,t){return this.doMax(e.args,t)}},{key:"maxa",value:function(e,t){return A(this.reduce(e.args,t,Number.NEGATIVE_INFINITY,"MAXA",(function(e,t){return Math.max(e,t)}),x,C))}},{key:"min",value:function(e,t){return this.doMin(e.args,t)}},{key:"mina",value:function(e,t){return A(this.reduce(e.args,t,Number.POSITIVE_INFINITY,"MINA",(function(e,t){return Math.min(e,t)}),x,C))}},{key:"count",value:function(e,t){return this.doCount(e.args,t)}},{key:"counta",value:function(e,t){return this.doCounta(e.args,t)}},{key:"average",value:function(e,t){return this.doAverage(e.args,t)}},{key:"averagea",value:function(e,t){var r,n=this.reduce(e.args,t,S.empty,"_AGGREGATE_A",(function(e,t){return e.compose(t)}),(function(e){return S.single(e)}),C);return n instanceof o.CellError?n:null!==(r=n.averageValue())&&void 0!==r?r:new o.CellError(o.ErrorType.DIV_BY_ZERO)}},{key:"vars",value:function(e,t){return this.doVarS(e.args,t)}},{key:"varp",value:function(e,t){return this.doVarP(e.args,t)}},{key:"vara",value:function(e,t){var r,n=this.reduceAggregateA(e.args,t);return n instanceof o.CellError?n:null!==(r=n.varSValue())&&void 0!==r?r:new o.CellError(o.ErrorType.DIV_BY_ZERO)}},{key:"varpa",value:function(e,t){var r,n=this.reduceAggregateA(e.args,t);return n instanceof o.CellError?n:null!==(r=n.varPValue())&&void 0!==r?r:new o.CellError(o.ErrorType.DIV_BY_ZERO)}},{key:"stdevs",value:function(e,t){return this.doStdevS(e.args,t)}},{key:"stdevp",value:function(e,t){return this.doStdevP(e.args,t)}},{key:"stdeva",value:function(e,t){var r=this.reduceAggregateA(e.args,t);if(r instanceof o.CellError)return r;var n=r.varSValue();return void 0===n?new o.CellError(o.ErrorType.DIV_BY_ZERO):Math.sqrt(n)}},{key:"stdevpa",value:function(e,t){var r=this.reduceAggregateA(e.args,t);if(r instanceof o.CellError)return r;var n=r.varPValue();return void 0===n?new o.CellError(o.ErrorType.DIV_BY_ZERO):Math.sqrt(n)}},{key:"product",value:function(e,t){return this.doProduct(e.args,t)}},{key:"subtotal",value:function(e,t){if(e.args.length<1)return new o.CellError(o.ErrorType.NA,s.ErrorMessage.WrongArgNumber);var r=this.coerceToType(this.evaluateAst(e.args[0],t),{argumentType:h.ArgumentTypes.NUMBER}),n=e.args.slice(1);switch(r){case 1:case 101:return this.doAverage(n,t);case 2:case 102:return this.doCount(n,t);case 3:case 103:return this.doCounta(n,t);case 4:case 104:return this.doMax(n,t);case 5:case 105:return this.doMin(n,t);case 6:case 106:return this.doProduct(n,t);case 7:case 107:return this.doStdevS(n,t);case 8:case 108:return this.doStdevP(n,t);case 9:case 109:return this.doSum(n,t);case 10:case 110:return this.doVarS(n,t);case 11:case 111:return this.doVarP(n,t);default:return new o.CellError(o.ErrorType.VALUE,s.ErrorMessage.BadMode)}}},{key:"reduceAggregate",value:function(e,t){return this.reduce(e,t,S.empty,"_AGGREGATE",(function(e,t){return e.compose(t)}),(function(e){return S.single(e)}),w)}},{key:"reduceAggregateA",value:function(e,t){return this.reduce(e,t,S.empty,"_AGGREGATE_A",(function(e,t){return e.compose(t)}),(function(e){return S.single(e)}),C)}},{key:"doAverage",value:function(e,t){var r,n=this.reduceAggregate(e,t);return n instanceof o.CellError?n:null!==(r=n.averageValue())&&void 0!==r?r:new o.CellError(o.ErrorType.DIV_BY_ZERO)}},{key:"doVarS",value:function(e,t){var r,n=this.reduceAggregate(e,t);return n instanceof o.CellError?n:null!==(r=n.varSValue())&&void 0!==r?r:new o.CellError(o.ErrorType.DIV_BY_ZERO)}},{key:"doVarP",value:function(e,t){var r,n=this.reduceAggregate(e,t);return n instanceof o.CellError?n:null!==(r=n.varPValue())&&void 0!==r?r:new o.CellError(o.ErrorType.DIV_BY_ZERO)}},{key:"doStdevS",value:function(e,t){var r=this.reduceAggregate(e,t);if(r instanceof o.CellError)return r;var n=r.varSValue();return void 0===n?new o.CellError(o.ErrorType.DIV_BY_ZERO):Math.sqrt(n)}},{key:"doStdevP",value:function(e,t){var r=this.reduceAggregate(e,t);if(r instanceof o.CellError)return r;var n=r.varPValue();return void 0===n?new o.CellError(o.ErrorType.DIV_BY_ZERO):Math.sqrt(n)}},{key:"doCount",value:function(e,t){return this.reduce(e,t,0,"COUNT",(function(e,t){return e+t}),x,(function(e){return"number"==typeof e?1:0}))}},{key:"doCounta",value:function(e,t){return this.reduce(e,t,0,"COUNTA",(function(e,t){return e+t}),x,(function(e){return e===o.EmptyValue?0:1}))}},{key:"doMax",value:function(e,t){return A(this.reduce(e,t,Number.NEGATIVE_INFINITY,"MAX",(function(e,t){return Math.max(e,t)}),x,w))}},{key:"doMin",value:function(e,t){return A(this.reduce(e,t,Number.POSITIVE_INFINITY,"MIN",(function(e,t){return Math.min(e,t)}),x,w))}},{key:"doSum",value:function(e,t){return this.reduce(e,t,0,"SUM",this.addWithEpsilon,x,w)}},{key:"doProduct",value:function(e,t){return this.reduce(e,t,1,"PRODUCT",(function(e,t){return e*t}),x,w)}},{key:"reduce",value:function(e,t,r,n,i,a,c){var h=this;return e.length<1?new o.CellError(o.ErrorType.NA,s.ErrorMessage.WrongArgNumber):e.reduce((function(e,r){if(e instanceof o.CellError)return e;if(r.type===u.AstNodeType.CELL_RANGE||r.type===u.AstNodeType.COLUMN_RANGE||r.type===u.AstNodeType.ROW_RANGE)return h.evaluateRange(r,t,e,n,i,a,c);var s;if((s=h.evaluateAst(r,t))instanceof l.SimpleRangeValue)return Array.from(s.valuesFromTopLeftCorner()).map(c).filter((function(e){return void 0!==e})).map((function(e){return e instanceof o.CellError?e:a(e)})).reduce((function(e,t){return e instanceof o.CellError?e:t instanceof o.CellError?t:i(e,t)}),e);if(r.type===u.AstNodeType.CELL_REFERENCE){if(void 0===(s=c(s)))return e}else if(s=h.coerceScalarToNumberOrError(s),void 0===(s=c(s)))return e;return s instanceof o.CellError?s:i(e,a(s))}),r)}},{key:"evaluateRange",value:function(e,t,r,n,u,c,l){var h;try{h=a.AbsoluteCellRange.fromAst(e,t)}catch(e){if(e.message===a.DIFFERENT_SHEETS_ERROR)return new o.CellError(o.ErrorType.REF,s.ErrorMessage.RangeManySheets);throw e}var p=h.start,f=h.end,d=this.dependencyGraph.getRange(p,f);i.default.ok(d,"Range does not exists in graph");var m=d.getFunctionValue(n);return m||(m=this.getRangeValues(n,h,c,l).reduce((function(e,t){return e instanceof o.CellError?e:t instanceof o.CellError?t:u(e,t)}),r),d.setFunctionValue(n,m)),m}},{key:"getRangeValues",value:function(e,t,r,n){var i,a=[],s=this.dependencyGraph.rangeMapping.findSmallerRange(t),u=s.smallerRangeVertex,c=s.restRange,l=this.dependencyGraph.getRange(t.start,t.end);if(u&&this.dependencyGraph.existsEdge(u,l)){var h=u.getFunctionValue(e);if(h)a.push(h);else{var p,d=f(u.range.addresses(this.dependencyGraph));try{for(d.s();!(p=d.n()).done;){var m=p.value,y=n(this.dependencyGraph.getScalarValue(m));y instanceof o.CellError?a.push(y):void 0!==y&&a.push(r(y))}}catch(e){d.e(e)}finally{d.f()}}i=c}else i=t;var g,v=f(i.addresses(this.dependencyGraph));try{for(v.s();!(g=v.n()).done;){var E=g.value,T=n(this.dependencyGraph.getScalarValue(E));T instanceof o.CellError?a.push(T):void 0!==T&&a.push(r(T))}}catch(e){v.e(e)}finally{v.f()}return a}}]),r}(h.FunctionPlugin);function w(e){return"number"==typeof e||e instanceof o.CellError?e:void 0}function C(e){return"boolean"==typeof e?(0,c.coerceBooleanToNumber)(e):"number"==typeof e||e instanceof o.CellError?e:"string"==typeof e?0:void 0}t.NumericAggregationPlugin=R,R.implementedFunctions={SUM:{method:"sum"},SUMSQ:{method:"sumsq"},MAX:{method:"max"},MIN:{method:"min"},MAXA:{method:"maxa"},MINA:{method:"mina"},COUNT:{method:"count"},COUNTA:{method:"counta"},AVERAGE:{method:"average"},AVERAGEA:{method:"averagea"},PRODUCT:{method:"product"},"VAR.S":{method:"vars"},VAR:{method:"vars"},"VAR.P":{method:"varp"},VARP:{method:"varp"},VARA:{method:"vara"},VARPA:{method:"varpa"},"STDEV.S":{method:"stdevs"},STDEV:{method:"stdevs"},"STDEV.P":{method:"stdevp"},STDEVP:{method:"stdevp"},STDEVA:{method:"stdeva"},STDEVPA:{method:"stdevpa"},SUBTOTAL:{method:"subtotal"}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.PowerPlugin=void 0;var n=r(315);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var i=l(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(c,e);var t,r,n,i=u(c);function c(){return a(this,c),i.apply(this,arguments)}return t=c,(r=[{key:"power",value:function(e,t){return this.runFunction(e.args,t,this.metadata("POWER"),Math.pow)}}])&&o(t.prototype,r),n&&o(t,n),c}(n.FunctionPlugin);t.PowerPlugin=h,h.implementedFunctions={POWER:{method:"power",parameters:[{argumentType:n.ArgumentTypes.NUMBER},{argumentType:n.ArgumentTypes.NUMBER}]}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.RadiansPlugin=void 0;var n=r(315);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var i=l(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(c,e);var t,r,n,i=u(c);function c(){return a(this,c),i.apply(this,arguments)}return t=c,(r=[{key:"radians",value:function(e,t){return this.runFunction(e.args,t,this.metadata("RADIANS"),(function(e){return e*(Math.PI/180)}))}}])&&o(t.prototype,r),n&&o(t,n),c}(n.FunctionPlugin);t.RadiansPlugin=h,h.implementedFunctions={RADIANS:{method:"radians",parameters:[{argumentType:n.ArgumentTypes.NUMBER}]}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(91),r(92),r(94),r(142),r(144),r(96),r(98),r(104),t.__esModule=!0,t.RadixConversionPlugin=void 0;var n=r(106),i=r(213),a=r(295),o=r(315);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f(e);if(t){var i=f(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(s,e);var t,r,a,o=h(s);function s(){return u(this,s),o.apply(this,arguments)}return t=s,(r=[{key:"dec2bin",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DEC2BIN"),(function(e,t){return y(e,2,t)}))}},{key:"dec2oct",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DEC2OCT"),(function(e,t){return y(e,8,t)}))}},{key:"dec2hex",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DEC2HEX"),(function(e,t){return y(e,16,t)}))}},{key:"bin2dec",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BIN2DEC"),(function(e){var t=m(e,2,10);return void 0===t?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotBinary):T(t,2)}))}},{key:"bin2oct",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BIN2OCT"),(function(e,t){var r=m(e,2,10);return void 0===r?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotBinary):y(T(r,2),8,t)}))}},{key:"bin2hex",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BIN2HEX"),(function(e,t){var r=m(e,2,10);return void 0===r?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotBinary):y(T(r,2),16,t)}))}},{key:"oct2dec",value:function(e,t){return this.runFunction(e.args,t,this.metadata("OCT2DEC"),(function(e){var t=m(e,8,10);return void 0===t?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotOctal):T(t,8)}))}},{key:"oct2bin",value:function(e,t){return this.runFunction(e.args,t,this.metadata("OCT2BIN"),(function(e,t){var r=m(e,8,10);return void 0===r?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotOctal):y(T(r,8),2,t)}))}},{key:"oct2hex",value:function(e,t){return this.runFunction(e.args,t,this.metadata("OCT2HEX"),(function(e,t){var r=m(e,8,10);return void 0===r?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotOctal):y(T(r,8),16,t)}))}},{key:"hex2dec",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HEX2DEC"),(function(e){var t=m(e,16,10);return void 0===t?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotHex):T(t,16)}))}},{key:"hex2bin",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HEX2BIN"),(function(e,t){var r=m(e,16,10);return void 0===r?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotHex):y(T(r,16),2,t)}))}},{key:"hex2oct",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HEX2OCT"),(function(e,t){var r=m(e,16,10);return void 0===r?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotHex):y(T(r,16),8,t)}))}},{key:"base",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BASE"),v)}},{key:"decimal",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DECIMAL"),(function(e,t){var r=m(e,t,255);return void 0===r?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotHex):parseInt(r,t)}))}}])&&c(t.prototype,r),a&&c(t,a),s}(o.FunctionPlugin);function m(e,t,r){var n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".substr(0,t),i=new RegExp("^[".concat(n,"]+$"));if(!(e.length>r)&&i.test(e))return e}function y(e,t,r){if(e>function(e){return-g(e)-1}(t))return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueBaseLarge);if(e<g(t))return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueBaseSmall);var o=E(e,t);return void 0===r||e<0?o:o.length>r?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueBaseLong):(0,a.padLeft)(o,r)}function g(e){return-Math.pow(e,10)/2}function v(e,t,r){var n=E(e,t);return void 0!==r&&r>n.length?(0,a.padLeft)(n,r):n}function E(e,t){return(e+(e<0?Math.pow(t,10):0)).toString(t).toUpperCase()}function T(e,t){var r=parseInt(e,t),n=Math.pow(t,10);return r>=n/2?r-n:r}t.RadixConversionPlugin=d,d.implementedFunctions={DEC2BIN:{method:"dec2bin",parameters:[{argumentType:o.ArgumentTypes.NUMBER},{argumentType:o.ArgumentTypes.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2OCT:{method:"dec2oct",parameters:[{argumentType:o.ArgumentTypes.NUMBER},{argumentType:o.ArgumentTypes.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2HEX:{method:"dec2hex",parameters:[{argumentType:o.ArgumentTypes.NUMBER},{argumentType:o.ArgumentTypes.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},BIN2DEC:{method:"bin2dec",parameters:[{argumentType:o.ArgumentTypes.STRING}]},BIN2OCT:{method:"bin2oct",parameters:[{argumentType:o.ArgumentTypes.STRING},{argumentType:o.ArgumentTypes.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},BIN2HEX:{method:"bin2hex",parameters:[{argumentType:o.ArgumentTypes.STRING},{argumentType:o.ArgumentTypes.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},OCT2DEC:{method:"oct2dec",parameters:[{argumentType:o.ArgumentTypes.STRING}]},OCT2BIN:{method:"oct2bin",parameters:[{argumentType:o.ArgumentTypes.STRING},{argumentType:o.ArgumentTypes.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},OCT2HEX:{method:"oct2hex",parameters:[{argumentType:o.ArgumentTypes.STRING},{argumentType:o.ArgumentTypes.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},HEX2DEC:{method:"hex2dec",parameters:[{argumentType:o.ArgumentTypes.STRING}]},HEX2BIN:{method:"hex2bin",parameters:[{argumentType:o.ArgumentTypes.STRING},{argumentType:o.ArgumentTypes.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},HEX2OCT:{method:"hex2oct",parameters:[{argumentType:o.ArgumentTypes.STRING},{argumentType:o.ArgumentTypes.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},DECIMAL:{method:"decimal",parameters:[{argumentType:o.ArgumentTypes.STRING},{argumentType:o.ArgumentTypes.NUMBER,minValue:2,maxValue:36}]},BASE:{method:"base",parameters:[{argumentType:o.ArgumentTypes.NUMBER,minValue:0},{argumentType:o.ArgumentTypes.NUMBER,minValue:2,maxValue:36},{argumentType:o.ArgumentTypes.NUMBER,optionalArg:!0,minValue:0,maxValue:255}]}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var i=c(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r(1),r(63),r(64),r(75),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.RandomPlugin=void 0;var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(c,e);var t,r,n,u=s(c);function c(){return i(this,c),u.apply(this,arguments)}return t=c,(r=[{key:"rand",value:function(e,t){return this.runFunction(e.args,t,this.metadata("RAND"),Math.random)}}])&&a(t.prototype,r),n&&a(t,n),c}(r(315).FunctionPlugin);t.RandomPlugin=l,l.implementedFunctions={RAND:{method:"rand",parameters:[],isVolatile:!0}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.findNextOddNumber=f,t.findNextEvenNumber=d,t.RoundingPlugin=void 0;var n=r(106),i=r(213),a=r(315);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var i=p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e){var t=Math.ceil(e);return t%2==1?t:t+1}function d(e){var t=Math.ceil(e);return t%2==0?t:t+1}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(h,e);var t,r,a,o=l(h);function h(){return s(this,h),o.apply(this,arguments)}return t=h,(r=[{key:"roundup",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(function(e,t){var r=Math.pow(10,t);return e<0?-Math.ceil(-e*r)/r:Math.ceil(e*r)/r}))}},{key:"rounddown",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(function(e,t){var r=Math.pow(10,t);return e<0?-Math.floor(-e*r)/r:Math.floor(e*r)/r}))}},{key:"round",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ROUND"),(function(e,t){var r=Math.pow(10,t);return e<0?-Math.round(-e*r)/r:Math.round(e*r)/r}))}},{key:"trunc",value:function(e,t){return this.rounddown(e,t)}},{key:"intFunc",value:function(e,t){return this.runFunction(e.args,t,this.metadata("INT"),(function(e){return e<0?-Math.floor(-e):Math.floor(e)}))}},{key:"even",value:function(e,t){return this.runFunction(e.args,t,this.metadata("EVEN"),(function(e){return e<0?-d(-e):d(e)}))}},{key:"odd",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ODD"),(function(e){return e<0?-f(-e):f(e)}))}},{key:"ceiling",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CEILING"),(function(t,r,a){return 0===r||0===t?0:t>0!=r>0&&e.args.length>1?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.DistinctSigns):(0===a&&(r=Math.abs(r)),Math.ceil(t/r)*r)}))}}])&&u(t.prototype,r),a&&u(t,a),h}(a.FunctionPlugin);t.RoundingPlugin=m,m.implementedFunctions={ROUNDUP:{method:"roundup",parameters:[{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER,defaultValue:0}]},ROUNDDOWN:{method:"rounddown",parameters:[{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER,defaultValue:0}]},ROUND:{method:"round",parameters:[{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER,defaultValue:0}]},TRUNC:{method:"trunc",parameters:[{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER,defaultValue:0}]},INT:{method:"intFunc",parameters:[{argumentType:a.ArgumentTypes.NUMBER}]},EVEN:{method:"even",parameters:[{argumentType:a.ArgumentTypes.NUMBER}]},ODD:{method:"odd",parameters:[{argumentType:a.ArgumentTypes.NUMBER}]},CEILING:{method:"ceiling",parameters:[{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER,defaultValue:1},{argumentType:a.ArgumentTypes.NUMBER,defaultValue:0}]}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.SqrtPlugin=void 0;var n=r(315);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var i=l(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(c,e);var t,r,n,i=u(c);function c(){return a(this,c),i.apply(this,arguments)}return t=c,(r=[{key:"sqrt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SQRT"),Math.sqrt)}}])&&o(t.prototype,r),n&&o(t,n),c}(n.FunctionPlugin);t.SqrtPlugin=h,h.implementedFunctions={SQRT:{method:"sqrt",parameters:[{argumentType:n.ArgumentTypes.NUMBER}]}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(109),r(65),r(75),r(200),r(113),r(84),r(89),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.SumifPlugin=void 0;var n=r(106),i=r(213),a=r(355),o=r(315);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h(e);if(t){var i=h(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return l(this,r)}}function l(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e,t,r){return t&&m(e.prototype,t),r&&m(e,r),e}var g=function(){function e(t,r){d(this,e),this.sum=t,this.count=r}return y(e,[{key:"compose",value:function(t){return new e(this.sum+t.sum,this.count+t.count)}},{key:"averageValue",value:function(){return this.count>0?this.sum/this.count:void 0}}],[{key:"single",value:function(t){return new e(t,1)}}]),e}();function v(e){var t=e.map((function(e){return"".concat(e.conditionRange.range().sheet,",").concat(e.conditionRange.range().start.col,",").concat(e.conditionRange.range().start.row)}));return["SUMIF"].concat(p(t)).join(",")}function E(e){var t=e.map((function(e){return"".concat(e.conditionRange.range().sheet,",").concat(e.conditionRange.range().start.col,",").concat(e.conditionRange.range().start.row)}));return["AVERAGEIF"].concat(p(t)).join(",")}function T(e){var t=e.map((function(e){return"".concat(e.conditionRange.range().sheet,",").concat(e.conditionRange.range().start.col,",").concat(e.conditionRange.range().start.row)}));return["COUNTIFS"].concat(p(t)).join(",")}g.empty=new g(0,0);var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(r,e);var t=c(r);function r(){return d(this,r),t.apply(this,arguments)}return y(r,[{key:"sumif",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("SUMIF"),(function(e,t,o){var s=r.interpreter.criterionBuilder.fromCellValue(t,r.interpreter.arithmeticHelper);return void 0===s?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.BadCriterion):(o=null!=o?o:e,new a.CriterionFunctionCompute(r.interpreter,v,0,(function(e,t){return r.interpreter.arithmeticHelper.nonstrictadd(e,t)}),(function(e){return e})).compute(o,[new a.Condition(e,s)]))}))}},{key:"sumifs",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("SUMIFS"),(function(e){for(var t=[],o=0;o<(arguments.length<=1?0:arguments.length-1);o+=2){var s=o+1<1||arguments.length<=o+1?void 0:arguments[o+1],u=r.interpreter.criterionBuilder.fromCellValue(o+1+1<1||arguments.length<=o+1+1?void 0:arguments[o+1+1],r.interpreter.arithmeticHelper);if(void 0===u)return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.BadCriterion);t.push(new a.Condition(s,u))}return new a.CriterionFunctionCompute(r.interpreter,v,0,(function(e,t){return r.interpreter.arithmeticHelper.nonstrictadd(e,t)}),(function(e){return e})).compute(e,t)}))}},{key:"averageif",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("AVERAGEIF"),(function(e,t,o){var s=r.interpreter.criterionBuilder.fromCellValue(t,r.interpreter.arithmeticHelper);if(void 0===s)return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.BadCriterion);o=null!=o?o:e;var u=new a.CriterionFunctionCompute(r.interpreter,E,g.empty,(function(e,t){return e.compose(t)}),(function(e){return"number"==typeof e?g.single(e):g.empty})).compute(o,[new a.Condition(e,s)]);return u instanceof n.CellError?u:u.averageValue()||new n.CellError(n.ErrorType.DIV_BY_ZERO)}))}},{key:"countif",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("COUNTIF"),(function(e,t){var o=r.interpreter.criterionBuilder.fromCellValue(t,r.interpreter.arithmeticHelper);return void 0===o?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.BadCriterion):new a.CriterionFunctionCompute(r.interpreter,(function(){return"COUNTIF"}),0,(function(e,t){return e+t}),(function(){return 1})).compute(e,[new a.Condition(e,o)])}))}},{key:"countifs",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("COUNTIFS"),(function(){for(var e=[],t=0;t<arguments.length;t+=2){var o=t<0||arguments.length<=t?void 0:arguments[t],s=r.interpreter.criterionBuilder.fromCellValue(t+1<0||arguments.length<=t+1?void 0:arguments[t+1],r.interpreter.arithmeticHelper);if(void 0===s)return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.BadCriterion);e.push(new a.Condition(o,s))}return new a.CriterionFunctionCompute(r.interpreter,T,0,(function(e,t){return e+t}),(function(){return 1})).compute(e[0].conditionRange,e)}))}}]),r}(o.FunctionPlugin);t.SumifPlugin=b,b.implementedFunctions={SUMIF:{method:"sumif",parameters:[{argumentType:o.ArgumentTypes.RANGE},{argumentType:o.ArgumentTypes.NOERROR},{argumentType:o.ArgumentTypes.RANGE,optionalArg:!0}]},COUNTIF:{method:"countif",parameters:[{argumentType:o.ArgumentTypes.RANGE},{argumentType:o.ArgumentTypes.NOERROR}]},AVERAGEIF:{method:"averageif",parameters:[{argumentType:o.ArgumentTypes.RANGE},{argumentType:o.ArgumentTypes.NOERROR},{argumentType:o.ArgumentTypes.RANGE,optionalArg:!0}]},SUMIFS:{method:"sumifs",parameters:[{argumentType:o.ArgumentTypes.RANGE},{argumentType:o.ArgumentTypes.RANGE},{argumentType:o.ArgumentTypes.NOERROR}],repeatLastArgs:2},COUNTIFS:{method:"countifs",parameters:[{argumentType:o.ArgumentTypes.RANGE},{argumentType:o.ArgumentTypes.NOERROR}],repeatLastArgs:2}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(300),r(110),r(65),r(75),r(200),r(113),r(84),r(89),r(207),r(92),r(96),r(98),r(124),r(104),t.__esModule=!0,t.Condition=t.CriterionFunctionCompute=void 0,r(125);var n=r(106),i=r(213),a=r(356),o=regeneratorRuntime.mark(m),s=regeneratorRuntime.mark(y);function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=l(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function l(e,t){if(e){if("string"==typeof e)return h(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(e,t):void 0}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var d=function(){function e(t,r,n,i,a){p(this,e),this.interpreter=t,this.cacheKey=r,this.reduceInitialValue=n,this.composeFunction=i,this.mapFunction=a,this.dependencyGraph=this.interpreter.dependencyGraph}var t,r,a;return t=e,(r=[{key:"compute",value:function(e,t){var r,a=this,o=c(t);try{for(o.s();!(r=o.n()).done;)if(!r.value.conditionRange.sameDimensionsAs(e))return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.EqualLength)}catch(e){o.e(e)}finally{o.f()}var s=this.tryToGetRangeVertexForRangeValue(e),u=t.map((function(e){return a.tryToGetRangeVertexForRangeValue(e.conditionRange)}));if(s&&u.every((function(e){return void 0!==e}))){var l=t.map((function(e){return e.criterionPackage.raw})).join(","),h=this.findAlreadyComputedValueInCache(s,this.cacheKey(t),l);if(h)return this.interpreter.stats.incrementCriterionFunctionFullCacheUsed(),h;var p=this.buildNewCriterionCache(this.cacheKey(t),t.map((function(e){return e.conditionRange.range()})),e.range());return p.has(l)||p.set(l,[this.evaluateRangeValue(e,t),t.map((function(e){return e.criterionPackage.lambda}))]),s.setCriterionFunctionValues(this.cacheKey(t),p),u.forEach((function(e){void 0!==e&&e.addDependentCacheRange(s)})),p.get(l)[0]}return this.evaluateRangeValue(e,t)}},{key:"tryToGetRangeVertexForRangeValue",value:function(e){var t=e.range();return void 0===t?void 0:this.dependencyGraph.getRange(t.start,t.end)}},{key:"reduceFunction",value:function(e){var t,r=this.reduceInitialValue,n=c(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;r=this.composeFunction(r,i)}}catch(e){n.e(e)}finally{n.f()}return r}},{key:"findAlreadyComputedValueInCache",value:function(e,t,r){return e.getCriterionFunctionValue(t,r)}},{key:"evaluateRangeValue",value:function(e,t){var r=t.map((function(e){return e.criterionPackage.lambda})),n=Array.from(e.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator](),i=y(r,t.map((function(e){return e.conditionRange.iterateValuesFromTopLeftCorner()})),n);return this.reduceFunction(i)}},{key:"buildNewCriterionCache",value:function(e,t,r){var i,a=this,o=this.dependencyGraph.getRange(r.start,r.end),s=function(e,t,r){if(r.end.row>r.start.row){var i=(0,n.simpleCellAddress)(r.end.sheet,r.end.col,r.end.row-1),a=e.getRange(r.start,i);if(void 0!==a)return{smallerRangeVertex:a,restValuesRange:r.withStart((0,n.simpleCellAddress)(r.start.sheet,r.start.col,r.end.row)),restConditionRanges:t.map((function(e){return e.withStart((0,n.simpleCellAddress)(e.start.sheet,e.start.col,e.end.row))}))}}return{smallerRangeVertex:null,restValuesRange:r,restConditionRanges:t}}(this.dependencyGraph,t,r),c=s.smallerRangeVertex,l=s.restConditionRanges,h=s.restValuesRange;i=c&&this.dependencyGraph.existsEdge(c,o)?c.getCriterionFunctionValues(e):new Map;var p=new Map;return i.forEach((function(e,t){var r=u(e,2),n=r[0],i=r[1],o=y(i,l.map((function(e){return m(a.dependencyGraph,e)})),Array.from(m(a.dependencyGraph,h)).map(a.mapFunction)[Symbol.iterator]()),s=a.composeFunction(n,a.reduceFunction(o));a.interpreter.stats.incrementCriterionFunctionPartialCacheUsed(),p.set(t,[s,i])})),p}}])&&f(t.prototype,r),a&&f(t,a),e}();function m(e,t){var r,n,i;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:r=c(t.addresses(e)),a.prev=1,r.s();case 3:if((n=r.n()).done){a.next=9;break}return i=n.value,a.next=7,e.getScalarValue(i);case 7:a.next=3;break;case 9:a.next=14;break;case 11:a.prev=11,a.t0=a.catch(1),r.e(a.t0);case 14:return a.prev=14,r.f(),a.finish(14);case 17:case"end":return a.stop()}}),o,null,[[1,11,14,17]])}function y(e,t,r){var n,i,o,l;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:n=c(r),s.prev=1,n.s();case 3:if((i=n.n()).done){s.next=15;break}if(o=i.value,(l=t.map((function(e){return(0,a.split)(e)}))).every((function(e){return Object.prototype.hasOwnProperty.call(e,"value")}))){s.next=8;break}return s.abrupt("return");case 8:if(!g(l.map((function(e){return e.value})),e).every((function(e){var t=u(e,2),r=t[0];return(0,t[1])(r)}))){s.next=12;break}return s.next=12,o;case 12:t=l.map((function(e){return e.rest}));case 13:s.next=3;break;case 15:s.next=20;break;case 17:s.prev=17,s.t0=s.catch(1),n.e(s.t0);case 20:return s.prev=20,n.f(),s.finish(20);case 23:case"end":return s.stop()}}),s,null,[[1,17,20,23]])}function g(e,t){for(var r=[],n=0;n<Math.min(e.length,t.length);n++)r.push([e[n],t[n]]);return r}t.CriterionFunctionCompute=d,t.Condition=function e(t,r){p(this,e),this.conditionRange=t,this.criterionPackage=r}},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(92),r(98),r(104),t.__esModule=!0,t.empty=i,t.split=function(e){var t=e[Symbol.iterator](),r=t.next(),n=r.done,a=r.value;return n?{rest:i()}:{value:a,rest:t}},t.first=function(e){var t=e[Symbol.iterator]().next(),r=t.done,n=t.value;if(!r)return n},r(125);var n=regeneratorRuntime.mark(i);
/**
 * @license
 * Copyright (c) 2020 Handsoncode. All rights reserved.
 */function i(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),n)}},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.SumprodPlugin=void 0;var n=r(106),i=r(213),a=r(315);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var i=p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(h,e);var t,r,a,o=l(h);function h(){return s(this,h),o.apply(this,arguments)}return t=h,(r=[{key:"sumproduct",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("SUMPRODUCT"),(function(e,t){if(e.numberOfElements()!==t.numberOfElements())return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.EqualLength);for(var a,o,s=0,u=e.iterateValuesFromTopLeftCorner(),c=t.iterateValuesFromTopLeftCorner();a=u.next(),o=c.next(),!a.done&&!o.done;){if(a.value instanceof n.CellError)return a.value;if(o.value instanceof n.CellError)return o.value;var l=r.coerceScalarToNumberOrError(a.value),h=r.coerceScalarToNumberOrError(o.value);"number"==typeof l&&"number"==typeof h&&(s+=l*h)}return s}))}}])&&u(t.prototype,r),a&&u(t,a),h}(a.FunctionPlugin);t.SumprodPlugin=f,f.implementedFunctions={SUMPRODUCT:{method:"sumproduct",parameters:[{argumentType:a.ArgumentTypes.RANGE},{argumentType:a.ArgumentTypes.RANGE}]}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(109),r(227),r(75),r(84),r(91),r(92),r(94),r(142),r(144),r(96),r(98),r(359),r(146),r(150),r(104),t.__esModule=!0,t.TextPlugin=void 0;var n=r(106),i=r(213),a=r(315);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var i=p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(h,e);var t,r,a,o=l(h);function h(){return s(this,h),o.apply(this,arguments)}return t=h,(r=[{key:"concatenate",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CONCATENATE"),(function(){var e;return(e="").concat.apply(e,arguments)}))}},{key:"split",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SPLIT"),(function(e,t){var r=e.split(" ");return t>=r.length||t<0?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.IndexBounds):r[t]}))}},{key:"len",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LEN"),(function(e){return e.length}))}},{key:"lower",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LOWER"),(function(e){return e.toLowerCase()}))}},{key:"trim",value:function(e,t){return this.runFunction(e.args,t,this.metadata("TRIM"),(function(e){return e.replace(/^ +| +$/g,"").replace(/ +/g," ")}))}},{key:"proper",value:function(e,t){return this.runFunction(e.args,t,this.metadata("PROPER"),(function(e){return e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()}))}))}},{key:"clean",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CLEAN"),(function(e){return e.replace(/[\u0000-\u001F]/g,"")}))}},{key:"exact",value:function(e,t){return this.runFunction(e.args,t,this.metadata("EXACT"),(function(e,t){return e===t}))}},{key:"rept",value:function(e,t){return this.runFunction(e.args,t,this.metadata("REPT"),(function(e,t){return t<0?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.NegativeCount):e.repeat(t)}))}},{key:"right",value:function(e,t){return this.runFunction(e.args,t,this.metadata("RIGHT"),(function(e,t){return t<0?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.NegativeLength):0===t?"":e.slice(-t)}))}},{key:"left",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LEFT"),(function(e,t){return t<0?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.NegativeLength):e.slice(0,t)}))}},{key:"mid",value:function(e,t){return this.runFunction(e.args,t,this.metadata("MID"),(function(e,t,r){return t<1?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.LessThanOne):r<0?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.NegativeLength):e.substring(t-1,t+r-1)}))}},{key:"replace",value:function(e,t){return this.runFunction(e.args,t,this.metadata("REPLACE"),(function(e,t,r,a){return t<1?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.LessThanOne):r<0?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.NegativeLength):e.substring(0,t-1)+a+e.substring(t+r-1)}))}},{key:"search",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("SEARCH"),(function(e,t,a){if(a<1||a>t.length)return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.LengthBounds);var o,s=t.substring(a-1).toLowerCase();return o=r.interpreter.arithmeticHelper.requiresRegex(e)?r.interpreter.arithmeticHelper.searchString(e,s):s.indexOf(e.toLowerCase()),(o+=a)>0?o:new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.PatternNotFound)}))}},{key:"substitute",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SUBSTITUTE"),(function(e,t,r,a){var o,s=new RegExp(t,"g");if(void 0===a)return e.replace(s,r);if(a<1)return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.LessThanOne);for(var u=0;null!==(o=s.exec(e));)if(a===++u)return e.substring(0,o.index)+r+e.substring(s.lastIndex);return e}))}},{key:"find",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FIND"),(function(e,t,r){if(r<1||r>t.length)return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.IndexBounds);var a=t.substring(r-1).indexOf(e)+r;return a>0?a:new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.PatternNotFound)}))}},{key:"t",value:function(e,t){return this.runFunction(e.args,t,this.metadata("T"),(function(e){return e instanceof n.CellError||"string"==typeof e?e:""}))}},{key:"upper",value:function(e,t){return this.runFunction(e.args,t,this.metadata("UPPER"),(function(e){return e.toUpperCase()}))}}])&&u(t.prototype,r),a&&u(t,a),h}(a.FunctionPlugin);t.TextPlugin=f,f.implementedFunctions={CONCATENATE:{method:"concatenate",parameters:[{argumentType:a.ArgumentTypes.STRING}],repeatLastArgs:1,expandRanges:!0},EXACT:{method:"exact",parameters:[{argumentType:a.ArgumentTypes.STRING},{argumentType:a.ArgumentTypes.STRING}]},SPLIT:{method:"split",parameters:[{argumentType:a.ArgumentTypes.STRING},{argumentType:a.ArgumentTypes.NUMBER}]},LEN:{method:"len",parameters:[{argumentType:a.ArgumentTypes.STRING}]},LOWER:{method:"lower",parameters:[{argumentType:a.ArgumentTypes.STRING}]},MID:{method:"mid",parameters:[{argumentType:a.ArgumentTypes.STRING},{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER}]},TRIM:{method:"trim",parameters:[{argumentType:a.ArgumentTypes.STRING}]},T:{method:"t",parameters:[{argumentType:a.ArgumentTypes.SCALAR}]},PROPER:{method:"proper",parameters:[{argumentType:a.ArgumentTypes.STRING}]},CLEAN:{method:"clean",parameters:[{argumentType:a.ArgumentTypes.STRING}]},REPT:{method:"rept",parameters:[{argumentType:a.ArgumentTypes.STRING},{argumentType:a.ArgumentTypes.NUMBER}]},RIGHT:{method:"right",parameters:[{argumentType:a.ArgumentTypes.STRING},{argumentType:a.ArgumentTypes.NUMBER,defaultValue:1}]},LEFT:{method:"left",parameters:[{argumentType:a.ArgumentTypes.STRING},{argumentType:a.ArgumentTypes.NUMBER,defaultValue:1}]},REPLACE:{method:"replace",parameters:[{argumentType:a.ArgumentTypes.STRING},{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.STRING}]},SEARCH:{method:"search",parameters:[{argumentType:a.ArgumentTypes.STRING},{argumentType:a.ArgumentTypes.STRING},{argumentType:a.ArgumentTypes.NUMBER,defaultValue:1}]},SUBSTITUTE:{method:"substitute",parameters:[{argumentType:a.ArgumentTypes.STRING},{argumentType:a.ArgumentTypes.STRING},{argumentType:a.ArgumentTypes.STRING},{argumentType:a.ArgumentTypes.NUMBER,optionalArg:!0}]},FIND:{method:"find",parameters:[{argumentType:a.ArgumentTypes.STRING},{argumentType:a.ArgumentTypes.STRING},{argumentType:a.ArgumentTypes.NUMBER,defaultValue:1}]},UPPER:{method:"upper",parameters:[{argumentType:a.ArgumentTypes.STRING}]}}},function(e,t,r){r(2)({target:"String",proto:!0},{repeat:r(298)})},function(e,t,r){"use strict";r(1),r(63),r(64),r(75),r(361),r(363),r(364),r(365),r(367),r(368),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.TrigonometryPlugin=void 0;var n=r(106),i=r(213),a=r(315),o=r(343);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f(e);if(t){var i=f(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(p,e);var t,r,a,s=h(p);function p(){return u(this,p),s.apply(this,arguments)}return t=p,(r=[{key:"acos",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ACOS"),Math.acos)}},{key:"asin",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ASIN"),Math.asin)}},{key:"cos",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COS"),Math.cos)}},{key:"sin",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SIN"),Math.sin)}},{key:"tan",value:function(e,t){return this.runFunction(e.args,t,this.metadata("TAN"),Math.tan)}},{key:"atan",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ATAN"),Math.atan)}},{key:"atan2",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ATAN2"),Math.atan2)}},{key:"cot",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COT"),(function(e){return 0===e?new n.CellError(n.ErrorType.DIV_BY_ZERO):1/Math.tan(e)}))}},{key:"acot",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ACOT"),(function(e){return 0===e?o.PI/2:Math.atan(1/e)}))}},{key:"sec",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SEC"),(function(e){return 1/Math.cos(e)}))}},{key:"csc",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CSC"),(function(e){return 0===e?new n.CellError(n.ErrorType.DIV_BY_ZERO):1/Math.sin(e)}))}},{key:"sinh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SINH"),Math.sinh)}},{key:"asinh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ASINH"),Math.asinh)}},{key:"cosh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COSH"),Math.cosh)}},{key:"acosh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ACOSH"),Math.acosh)}},{key:"tanh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("TANH"),Math.tanh)}},{key:"atanh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ATANH"),Math.atanh)}},{key:"coth",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COTH"),(function(e){return 0===e?new n.CellError(n.ErrorType.DIV_BY_ZERO):1/Math.tanh(e)}))}},{key:"acoth",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ACOTH"),(function(e){return 0===e?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NonZero):Math.atanh(1/e)}))}},{key:"sech",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SECH"),(function(e){return 1/Math.cosh(e)}))}},{key:"csch",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CSCH"),(function(e){return 0===e?new n.CellError(n.ErrorType.DIV_BY_ZERO):1/Math.sinh(e)}))}}])&&c(t.prototype,r),a&&c(t,a),p}(a.FunctionPlugin);t.TrigonometryPlugin=d,d.implementedFunctions={ACOS:{method:"acos",parameters:[{argumentType:a.ArgumentTypes.NUMBER}]},ASIN:{method:"asin",parameters:[{argumentType:a.ArgumentTypes.NUMBER}]},COS:{method:"cos",parameters:[{argumentType:a.ArgumentTypes.NUMBER}]},SIN:{method:"sin",parameters:[{argumentType:a.ArgumentTypes.NUMBER}]},TAN:{method:"tan",parameters:[{argumentType:a.ArgumentTypes.NUMBER}]},ATAN:{method:"atan",parameters:[{argumentType:a.ArgumentTypes.NUMBER}]},ATAN2:{method:"atan2",parameters:[{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER}]},COT:{method:"cot",parameters:[{argumentType:a.ArgumentTypes.NUMBER}]},SEC:{method:"sec",parameters:[{argumentType:a.ArgumentTypes.NUMBER}]},CSC:{method:"csc",parameters:[{argumentType:a.ArgumentTypes.NUMBER}]},SINH:{method:"sinh",parameters:[{argumentType:a.ArgumentTypes.NUMBER}]},COSH:{method:"cosh",parameters:[{argumentType:a.ArgumentTypes.NUMBER}]},TANH:{method:"tanh",parameters:[{argumentType:a.ArgumentTypes.NUMBER}]},COTH:{method:"coth",parameters:[{argumentType:a.ArgumentTypes.NUMBER}]},SECH:{method:"sech",parameters:[{argumentType:a.ArgumentTypes.NUMBER}]},CSCH:{method:"csch",parameters:[{argumentType:a.ArgumentTypes.NUMBER}]},ACOT:{method:"acot",parameters:[{argumentType:a.ArgumentTypes.NUMBER}]},ASINH:{method:"asinh",parameters:[{argumentType:a.ArgumentTypes.NUMBER}]},ACOSH:{method:"acosh",parameters:[{argumentType:a.ArgumentTypes.NUMBER}]},ATANH:{method:"atanh",parameters:[{argumentType:a.ArgumentTypes.NUMBER}]},ACOTH:{method:"acoth",parameters:[{argumentType:a.ArgumentTypes.NUMBER}]}}},function(e,t,r){var n=r(2),i=r(362),a=Math.acosh,o=Math.log,s=Math.sqrt,u=Math.LN2;n({target:"Math",stat:!0,forced:!a||710!=Math.floor(a(Number.MAX_VALUE))||a(1/0)!=1/0},{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?o(e)+u:i(e-1+s(e-1)*s(e+1))}})},function(e,t){var r=Math.log;e.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:r(1+e)}},function(e,t,r){var n=r(2),i=Math.asinh,a=Math.log,o=Math.sqrt;n({target:"Math",stat:!0,forced:!(i&&1/i(0)>0)},{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):a(t+o(t*t+1)):t}})},function(e,t,r){var n=r(2),i=Math.atanh,a=Math.log;n({target:"Math",stat:!0,forced:!(i&&1/i(-0)<0)},{atanh:function(e){return 0==(e=+e)?e:a((1+e)/(1-e))/2}})},function(e,t,r){var n=r(2),i=r(366),a=Math.cosh,o=Math.abs,s=Math.E;n({target:"Math",stat:!0,forced:!a||a(710)===1/0},{cosh:function(e){var t=i(o(e)-1)+1;return(t+1/(t*s*s))*(s/2)}})},function(e,t){var r=Math.expm1,n=Math.exp;e.exports=!r||r(10)>22025.465794806718||r(10)<22025.465794806718||-2e-17!=r(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:n(e)-1}:r},function(e,t,r){var n=r(2),i=r(7),a=r(366),o=Math.abs,s=Math.exp,u=Math.E;n({target:"Math",stat:!0,forced:i((function(){return-2e-17!=Math.sinh(-2e-17)}))},{sinh:function(e){return o(e=+e)<1?(a(e)-a(-e))/2:(s(e-1)-s(-e-1))*(u/2)}})},function(e,t,r){var n=r(2),i=r(366),a=Math.exp;n({target:"Math",stat:!0},{tanh:function(e){var t=i(e=+e),r=i(-e);return t==1/0?1:r==1/0?-1:(t-r)/(a(e)+a(-e))}})},function(e,t,r){"use strict";r(1),r(63),r(64),r(288),r(75),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.LookupPlugin=void 0;var n=r(132),i=r(106),a=r(213),o=r(219),s=r(246),u=r(315),c=r(370),l=r(261);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g(e);if(t){var i=g(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return y(this,r)}}function y(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(y,e);var t,r,u,h=m(y);function y(){var e;return p(this,y),(e=h.apply(this,arguments)).rowSearch=new c.RowSearchStrategy(e.config,e.dependencyGraph),e}return t=y,(r=[{key:"vlookup",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("VLOOKUP"),(function(e,t,n,o){var s=t.range();return void 0===s?new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.WrongType):n<1?new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.LessThanOne):n>s.width()?new i.CellError(i.ErrorType.REF,a.ErrorMessage.IndexLarge):r.doVlookup((0,l.zeroIfEmpty)(e),s,n-1,o)}))}},{key:"hlookup",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("HLOOKUP"),(function(e,t,n,o){var s=t.range();return void 0===s?new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.WrongType):n<1?new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.LessThanOne):n>s.height()?new i.CellError(i.ErrorType.REF,a.ErrorMessage.IndexLarge):r.doHlookup((0,l.zeroIfEmpty)(e),s,n-1,o)}))}},{key:"match",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("MATCH"),(function(e,t,n){var o=t.range();return void 0===o?new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.WrongType):r.doMatch((0,l.zeroIfEmpty)(e),o,n)}))}},{key:"doVlookup",value:function(e,t,r,u){this.dependencyGraph.stats.start(o.StatType.VLOOKUP);var c=n.AbsoluteCellRange.spanFrom(t.start,1,t.height()),l=this.searchInRange(e,c,u,this.columnSearch);if(this.dependencyGraph.stats.end(o.StatType.VLOOKUP),-1===l)return new i.CellError(i.ErrorType.NA,a.ErrorMessage.ValueNotFound);var h=(0,i.simpleCellAddress)(t.sheet,t.start.col+r,l),p=this.dependencyGraph.getCellValue(h);return p instanceof s.SimpleRangeValue?new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.WrongType):p}},{key:"doHlookup",value:function(e,t,r,o){var u=n.AbsoluteCellRange.spanFrom(t.start,t.width(),1),c=this.searchInRange(e,u,o,this.rowSearch);if(-1===c)return new i.CellError(i.ErrorType.NA,a.ErrorMessage.ValueNotFound);var l=(0,i.simpleCellAddress)(t.sheet,c,t.start.row+r),h=this.dependencyGraph.getCellValue(l);return h instanceof s.SimpleRangeValue?new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.WrongType):h}},{key:"doMatch",value:function(e,t,r){if(t.width()>1&&t.height()>1)return new i.CellError(i.ErrorType.NA);if(1===t.width()){var n=this.columnSearch.find(e,t,0!==r);return-1===n?new i.CellError(i.ErrorType.NA,a.ErrorMessage.ValueNotFound):n-t.start.row+1}var o=this.rowSearch.find(e,t,0!==r);return-1===o?new i.CellError(i.ErrorType.NA,a.ErrorMessage.ValueNotFound):o-t.start.col+1}},{key:"searchInRange",value:function(e,t,r,n){return!r&&"string"==typeof e&&this.interpreter.arithmeticHelper.requiresRegex(e)?n.advancedFind(this.interpreter.arithmeticHelper.eqMatcherFunction(e),t):n.find(e,t,r)}}])&&f(t.prototype,r),u&&f(t,u),y}(u.FunctionPlugin);t.LookupPlugin=v,v.implementedFunctions={VLOOKUP:{method:"vlookup",parameters:[{argumentType:u.ArgumentTypes.NOERROR},{argumentType:u.ArgumentTypes.RANGE},{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.BOOLEAN,defaultValue:!0}]},HLOOKUP:{method:"hlookup",parameters:[{argumentType:u.ArgumentTypes.NOERROR},{argumentType:u.ArgumentTypes.RANGE},{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.BOOLEAN,defaultValue:!0}]},MATCH:{method:"match",parameters:[{argumentType:u.ArgumentTypes.NOERROR},{argumentType:u.ArgumentTypes.RANGE},{argumentType:u.ArgumentTypes.NUMBER,defaultValue:1}]}}},function(e,t,r){"use strict";r(1),r(63),r(64),r(227),r(75),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.RowSearchStrategy=void 0;var n=r(285);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var i=c(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(c,e);var t,r,i,u=s(c);function c(e,t){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(r=u.call(this,t)).config=e,r.dependencyGraph=t,r}return t=c,(r=[{key:"find",value:function(e,t,r){if(t.width()<this.config.binarySearchThreshold||!r){var i=this.dependencyGraph.computeListOfValuesInRange(t).indexOf(e);return i<0?i:i+t.start.col}return(0,n.rangeLowerBound)(t,e,this.dependencyGraph,"col")}}])&&a(t.prototype,r),i&&a(t,i),c}(r(286).AdvancedFind);t.RowSearchStrategy=l},function(e,t,r){"use strict";r(1),r(63),r(64),r(109),r(75),r(91),r(92),r(94),r(96),r(98),r(104),t.__esModule=!0,t.SimpleArithmerticPlugin=void 0;var n=r(315);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var i=l(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(c,e);var t,r,n,i=u(c);function c(){return a(this,c),i.apply(this,arguments)}return t=c,(r=[{key:"add",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.ADD"),this.interpreter.arithmeticHelper.addWithEpsilon)}},{key:"concat",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.CONCAT"),this.interpreter.arithmeticHelper.concat)}},{key:"divide",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.DIVIDE"),this.interpreter.arithmeticHelper.divide)}},{key:"eq",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.EQ"),this.interpreter.arithmeticHelper.eq)}},{key:"gt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.GT"),this.interpreter.arithmeticHelper.gt)}},{key:"gte",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.GTE"),this.interpreter.arithmeticHelper.geq)}},{key:"lt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.LT"),this.interpreter.arithmeticHelper.lt)}},{key:"lte",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.LTE"),this.interpreter.arithmeticHelper.leq)}},{key:"minus",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.MINUS"),this.interpreter.arithmeticHelper.subtract)}},{key:"multiply",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.MULTIPLY"),this.interpreter.arithmeticHelper.multiply)}},{key:"ne",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.NE"),this.interpreter.arithmeticHelper.neq)}},{key:"pow",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.POW"),this.interpreter.arithmeticHelper.pow)}},{key:"uminus",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.UMINUS"),this.interpreter.arithmeticHelper.unaryMinus)}},{key:"upercent",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.UNARY_PERCENT"),this.interpreter.arithmeticHelper.unaryPercent)}},{key:"uplus",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.UPLUS"),this.interpreter.arithmeticHelper.unaryPlus)}}])&&o(t.prototype,r),n&&o(t,n),c}(n.FunctionPlugin);t.SimpleArithmerticPlugin=h,h.implementedFunctions={"HF.ADD":{method:"add",parameters:[{argumentType:n.ArgumentTypes.NUMBER},{argumentType:n.ArgumentTypes.NUMBER}]},"HF.CONCAT":{method:"concat",parameters:[{argumentType:n.ArgumentTypes.STRING},{argumentType:n.ArgumentTypes.STRING}]},"HF.DIVIDE":{method:"divide",parameters:[{argumentType:n.ArgumentTypes.NUMBER},{argumentType:n.ArgumentTypes.NUMBER}]},"HF.EQ":{method:"eq",parameters:[{argumentType:n.ArgumentTypes.NOERROR},{argumentType:n.ArgumentTypes.NOERROR}]},"HF.GT":{method:"gt",parameters:[{argumentType:n.ArgumentTypes.NOERROR},{argumentType:n.ArgumentTypes.NOERROR}]},"HF.GTE":{method:"gte",parameters:[{argumentType:n.ArgumentTypes.NOERROR},{argumentType:n.ArgumentTypes.NOERROR}]},"HF.LT":{method:"lt",parameters:[{argumentType:n.ArgumentTypes.NOERROR},{argumentType:n.ArgumentTypes.NOERROR}]},"HF.LTE":{method:"lte",parameters:[{argumentType:n.ArgumentTypes.NOERROR},{argumentType:n.ArgumentTypes.NOERROR}]},"HF.MINUS":{method:"minus",parameters:[{argumentType:n.ArgumentTypes.NUMBER},{argumentType:n.ArgumentTypes.NUMBER}]},"HF.MULTIPLY":{method:"multiply",parameters:[{argumentType:n.ArgumentTypes.NUMBER},{argumentType:n.ArgumentTypes.NUMBER}]},"HF.NE":{method:"ne",parameters:[{argumentType:n.ArgumentTypes.NOERROR},{argumentType:n.ArgumentTypes.NOERROR}]},"HF.POW":{method:"pow",parameters:[{argumentType:n.ArgumentTypes.NUMBER},{argumentType:n.ArgumentTypes.NUMBER}]},"HF.UMINUS":{method:"uminus",parameters:[{argumentType:n.ArgumentTypes.NUMBER}]},"HF.UNARY_PERCENT":{method:"upercent",parameters:[{argumentType:n.ArgumentTypes.NUMBER}]},"HF.UPLUS":{method:"uplus",parameters:[{argumentType:n.ArgumentTypes.NUMBER}]}}}]).default},"object"===d(t)&&"object"===d(e)?e.exports=m():(i=[],void 0===(a="function"==typeof(n=m)?n.apply(t,i):n)||(e.exports=a))}).call(this,r(122)(e))},492:function(e,t,r){"use strict";var n=r(339);r.n(n).a},498:function(e,t,r){"use strict";r.r(t);var n=r(373),i=r.n(n),a=r(488),o=r.n(a),s=r(489),u=r.n(s),c=i.a.buildEmpty().parser.getSerializedGastProductions(),l={data:function(){return{diagram:u.a.buildSyntaxDiagramsText(c)}},mounted:function(){o.a.initDiagramsBehavior()}},h=(r(491),r(492),r(42)),p=Object(h.a)(l,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("div",{staticClass:"diagram",domProps:{innerHTML:this._s(this.diagram)}})])}),[],!1,null,null,null);t.default=p.exports}}]);