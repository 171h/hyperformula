(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{346:function(e,t,r){},369:function(e,t,r){(function(e){var n,o,a,i=r(159).default,u;r(111),r(190),r(34),r(35),r(10),r(370),r(371),r(372),r(117),r(373),r(56),r(12),r(15),r(374),r(376),r(100),r(53),r(73),r(116),r(119),r(120),r(114),r(377),r(185),r(378),r(47),r(311),r(379),r(314),r(176),r(180),r(174),r(68),r(380),r(97),r(310),r(98),r(99),r(381),r(382),r(321),r(383),r(384),r(66),r(385),r(386),r(387),r(388),r(390),r(391),r(392),r(393),r(397),r(399),r(400),r(401),r(403),r(404),r(405),r(406),r(407),r(408),r(409),r(410),r(412),r(413),r(414),r(415),r(416),r(417),r(418),r(419),r(420),r(421),r(422),r(423),r(424),r(425),r(183),r(426),r(313),r(184),r(427),r(428),r(429),r(312),r(317),r(431),r(186),r(432),r(29),r(433),r(93),r(434),r(435),r(437),r(438),r(178),r(179),r(320),r(440),r(442),r(443),r(444),r(447),r(448),r(449),r(451),r(452),r(453),r(454),r(455),r(456),r(457),r(458),r(459),r(460),"undefined"!=typeof self&&self,
/*!
 * Copyright (c) HANDSONCODE sp. z o. o.
 * 
 * HYPERFORMULA is software distributed by HANDSONCODE sp. z o. o.,
 * a Polish corporation, based in Gdynia, Poland, at 96/98 Aleja Zwycięstwa,
 * registered with the National Court Register under number 538651,
 * EU tax ID number: PL5862294002, share capital: PLN 62,800.00.
 * 
 * This software is protected by applicable copyright laws, including
 * international treaties, and triple-licensed.
 * 
 * First, if your use involves only such purposes as education, research, study,
 * and personal use, testing and demonstration, you agree to be bound by
 * the terms included in the “non-commercial-license.pdf” file, available
 * in the main directory of this software repository.
 * 
 * Second, commercial purposes dictate more individual approach
 * and the terms of such use are subject to negotiations.
 * 
 * Third, at your option, your use of this Software – either commercial, non-commercial, or both –
 * may be subject to the GNU Affero General Public License
 * in such version as included in the “agpl-3.0.txt” file,
 * available in the main directory of this software repository.
 * 
 * HANDSONCODE PROVIDES THIS SOFTWARE ON AN “AS IS” BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND. IN NO EVENT
 * AND UNDER NO LEGAL THEORY, SHALL HANDSONCODE BE LIABLE
 * TO YOU FOR DAMAGES, INCLUDING ANY DIRECT, INDIRECT, SPECIAL,
 * INCIDENTAL, OR CONSEQUENTIAL DAMAGES OF ANY CHARACTER ARISING
 * FROM USE OR INABILITY TO USE THIS SOFTWARE.
 * 
 * Version: 0.6.0
 * Release date: 27/04/2021 (built at 27/04/2021 09:26:57)
 */
u=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===i(e)&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(53),r(63),r(67),r(68),r(77),r(87),r(93),r(94),r(95),r(97),r(99),r(108),t.__esModule=!0,t.default=void 0,r(109),r(110),r(111);var o=r(115);t.CellType=o.CellType,t.CellValueDetailedType=o.CellValueDetailedType,t.CellValueType=o.CellValueType,t.ErrorType=o.ErrorType;var a=r(254);t.DetailedCellError=a.DetailedCellError;var i=r(255),u=r(231);t.ConfigValueTooBigError=u.ConfigValueTooBigError,t.ConfigValueTooSmallError=u.ConfigValueTooSmallError,t.EvaluationSuspendedError=u.EvaluationSuspendedError,t.ExpectedOneOfValuesError=u.ExpectedOneOfValuesError,t.ExpectedValueOfTypeError=u.ExpectedValueOfTypeError,t.FunctionPluginValidationError=u.FunctionPluginValidationError,t.InvalidAddressError=u.InvalidAddressError,t.InvalidArgumentsError=u.InvalidArgumentsError,t.LanguageAlreadyRegisteredError=u.LanguageAlreadyRegisteredError,t.LanguageNotRegisteredError=u.LanguageNotRegisteredError,t.MatrixFormulasNotSupportedError=u.MatrixFormulasNotSupportedError,t.MissingTranslationError=u.MissingTranslationError,t.NamedExpressionDoesNotExistError=u.NamedExpressionDoesNotExistError,t.NamedExpressionNameIsAlreadyTakenError=u.NamedExpressionNameIsAlreadyTakenError,t.NamedExpressionNameIsInvalidError=u.NamedExpressionNameIsInvalidError,t.NoOperationToRedoError=u.NoOperationToRedoError,t.NoOperationToUndoError=u.NoOperationToUndoError,t.NoRelativeAddressesAllowedError=u.NoRelativeAddressesAllowedError,t.NoSheetWithIdError=u.NoSheetWithIdError,t.NoSheetWithNameError=u.NoSheetWithNameError,t.NotAFormulaError=u.NotAFormulaError,t.NothingToPasteError=u.NothingToPasteError,t.ProtectedFunctionTranslationError=u.ProtectedFunctionTranslationError,t.SheetNameAlreadyTakenError=u.SheetNameAlreadyTakenError,t.SheetSizeLimitExceededError=u.SheetSizeLimitExceededError,t.SourceLocationHasMatrixError=u.SourceLocationHasMatrixError,t.TargetLocationHasMatrixError=u.TargetLocationHasMatrixError,t.UnableToParseError=u.UnableToParseError;var s=r(291);t.ExportedCellChange=s.ExportedCellChange,t.ExportedNamedExpressionChange=s.ExportedNamedExpressionChange;var c=r(269);t.HyperFormula=c.HyperFormula;var l,f=(l=r(317))&&l.__esModule?l:{default:l},p=r(318);t.FunctionPlugin=p.FunctionPlugin;var h=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var t=d();if(t&&t.has(e))return t.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=o?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(r,a,i):r[a]=e[a]}return r.default=e,t&&t.set(e,r),r}(r(319));function d(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return d=function(){return e},e}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=T(e);if(t){var o=T(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return E(this,r)}}function E(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(r,e);var t=v(r);function r(){return y(this,r),t.apply(this,arguments)}return r}(c.HyperFormula);b.HyperFormula=c.HyperFormula,b.ErrorType=o.ErrorType,b.CellType=o.CellType,b.CellValueType=o.CellValueType,b.CellValueDetailedType=o.CellValueDetailedType,b.DetailedCellError=a.DetailedCellError,b.ExportedCellChange=s.ExportedCellChange,b.ExportedNamedExpressionChange=s.ExportedNamedExpressionChange,b.ConfigValueTooBigError=u.ConfigValueTooBigError,b.ConfigValueTooSmallError=u.ConfigValueTooSmallError,b.EvaluationSuspendedError=u.EvaluationSuspendedError,b.ExpectedOneOfValuesError=u.ExpectedOneOfValuesError,b.ExpectedValueOfTypeError=u.ExpectedValueOfTypeError,b.FunctionPlugin=p.FunctionPlugin,b.FunctionPluginValidationError=u.FunctionPluginValidationError,b.InvalidAddressError=u.InvalidAddressError,b.InvalidArgumentsError=u.InvalidArgumentsError,b.LanguageNotRegisteredError=u.LanguageNotRegisteredError,b.LanguageAlreadyRegisteredError=u.LanguageAlreadyRegisteredError,b.MatrixFormulasNotSupportedError=u.MatrixFormulasNotSupportedError,b.MissingTranslationError=u.MissingTranslationError,b.NamedExpressionDoesNotExistError=u.NamedExpressionDoesNotExistError,b.NamedExpressionNameIsAlreadyTakenError=u.NamedExpressionNameIsAlreadyTakenError,b.NamedExpressionNameIsInvalidError=u.NamedExpressionNameIsInvalidError,b.NoOperationToRedoError=u.NoOperationToRedoError,b.NoOperationToUndoError=u.NoOperationToUndoError,b.NoRelativeAddressesAllowedError=u.NoRelativeAddressesAllowedError,b.NoSheetWithIdError=u.NoSheetWithIdError,b.NoSheetWithNameError=u.NoSheetWithNameError,b.NotAFormulaError=u.NotAFormulaError,b.NothingToPasteError=u.NothingToPasteError,b.ProtectedFunctionTranslationError=u.ProtectedFunctionTranslationError,b.SheetNameAlreadyTakenError=u.SheetNameAlreadyTakenError,b.SheetSizeLimitExceededError=u.SheetSizeLimitExceededError,b.SourceLocationHasMatrixError=u.SourceLocationHasMatrixError,b.TargetLocationHasMatrixError=u.TargetLocationHasMatrixError,b.UnableToParseError=u.UnableToParseError;var R=i.Config.defaultConfig.language;c.HyperFormula.registerLanguage(R,f.default),c.HyperFormula.languages[f.default.langCode]=f.default;var A,S=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}(Object.getOwnPropertyNames(h));try{for(S.s();!(A=S.n()).done;){var N=A.value;N.startsWith("_")||c.HyperFormula.registerFunctionPlugin(h[N])}}catch(e){S.e(e)}finally{S.f()}var O=b;t.default=O},function(e,t,r){var n=r(2),o=r(36),a=r(47),i=r(22),u=r(15),s=r(48),c=r(52),l=r(7),f=o("Reflect","construct"),p=l((function(){function e(){}return!(f((function(){}),[],e)instanceof e)})),h=!l((function(){f((function(){}))})),d=p||h;n({target:"Reflect",stat:!0,forced:d,sham:d},{construct:function(e,t){a(e),i(t);var r=arguments.length<3?e:a(arguments[2]);if(h&&!p)return f(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return n.push.apply(n,t),new(c.apply(e,n))}var o=r.prototype,l=s(u(o)?o:Object.prototype),d=Function.apply.call(e,l,t);return u(d)?d:l}})},function(e,t,r){var n=r(3),o=r(5).f,a=r(20),u=r(23),s=r(24),c=r(34),l=r(46);e.exports=function(e,t){var r,f,p,h,d,m=e.target,y=e.global,g=e.stat;if(r=y?n:g?n[m]||s(m,{}):(n[m]||{}).prototype)for(f in t){if(h=t[f],p=e.noTargetGet?(d=o(r,f))&&d.value:r[f],!l(y?f:m+(g?".":"#")+f,e.forced)&&void 0!==p){if(i(h)===i(p))continue;c(h,p)}(e.sham||p&&p.sham)&&a(h,"sham",!0),u(r,f,h,e)}}},function(e,t,r){(function(t){var r=function(e){return e&&e.Math==Math&&e};e.exports=r("object"==("undefined"==typeof globalThis?"undefined":i(globalThis))&&globalThis)||r("object"==("undefined"==typeof window?"undefined":i(window))&&window)||r("object"==("undefined"==typeof self?"undefined":i(self))&&self)||r("object"==i(t)&&t)||function(){return this}()||Function("return this")()}).call(this,r(4))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"===("undefined"==typeof window?"undefined":i(window))&&(r=window)}e.exports=r},function(e,t,r){var n=r(6),o=r(8),a=r(9),i=r(10),u=r(14),s=r(16),c=r(18),l=Object.getOwnPropertyDescriptor;t.f=n?l:function(e,t){if(e=i(e),t=u(t,!0),c)try{return l(e,t)}catch(e){}if(s(e,t))return a(!o.f.call(e,t),e[t])}},function(e,t,r){var n=r(7);e.exports=!n((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,r){"use strict";var n={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,a=o&&!n.call({1:2},1);t.f=a?function(e){var t=o(this,e);return!!t&&t.enumerable}:n},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,r){var n=r(11),o=r(13);e.exports=function(e){return n(o(e))}},function(e,t,r){var n=r(7),o=r(12),a="".split;e.exports=n((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==o(e)?a.call(e,""):Object(e)}:Object},function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e}},function(e,t,r){var n=r(15);e.exports=function(e,t){if(!n(e))return e;var r,o;if(t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;if("function"==typeof(r=e.valueOf)&&!n(o=r.call(e)))return o;if(!t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e){return"object"===i(e)?null!==e:"function"==typeof e}},function(e,t,r){var n=r(17),o={}.hasOwnProperty;e.exports=function(e,t){return o.call(n(e),t)}},function(e,t,r){var n=r(13);e.exports=function(e){return Object(n(e))}},function(e,t,r){var n=r(6),o=r(7),a=r(19);e.exports=!n&&!o((function(){return 7!=Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a}))},function(e,t,r){var n=r(3),o=r(15),a=n.document,i=o(a)&&o(a.createElement);e.exports=function(e){return i?a.createElement(e):{}}},function(e,t,r){var n=r(6),o=r(21),a=r(9);e.exports=n?function(e,t,r){return o.f(e,t,a(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t,r){var n=r(6),o=r(18),a=r(22),i=r(14),u=Object.defineProperty;t.f=n?u:function(e,t,r){if(a(e),t=i(t,!0),a(r),o)try{return u(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(e[t]=r.value),e}},function(e,t,r){var n=r(15);e.exports=function(e){if(!n(e))throw TypeError(String(e)+" is not an object");return e}},function(e,t,r){var n=r(3),o=r(20),a=r(16),i=r(24),u=r(25),s=r(27),c=s.get,l=s.enforce,f=String(String).split("String");(e.exports=function(e,t,r,u){var s,c=!!u&&!!u.unsafe,p=!!u&&!!u.enumerable,h=!!u&&!!u.noTargetGet;"function"==typeof r&&("string"!=typeof t||a(r,"name")||o(r,"name",t),(s=l(r)).source||(s.source=f.join("string"==typeof t?t:""))),e!==n?(c?!h&&e[t]&&(p=!0):delete e[t],p?e[t]=r:o(e,t,r)):p?e[t]=r:i(t,r)})(Function.prototype,"toString",(function(){return"function"==typeof this&&c(this).source||u(this)}))},function(e,t,r){var n=r(3),o=r(20);e.exports=function(e,t){try{o(n,e,t)}catch(r){n[e]=t}return t}},function(e,t,r){var n=r(26),o=Function.toString;"function"!=typeof n.inspectSource&&(n.inspectSource=function(e){return o.call(e)}),e.exports=n.inspectSource},function(e,t,r){var n=r(3),o=r(24),a=n["__core-js_shared__"]||o("__core-js_shared__",{});e.exports=a},function(e,t,r){var n,o,a,i=r(28),u=r(3),s=r(15),c=r(20),l=r(16),f=r(26),p=r(29),h=r(33),d=u.WeakMap;if(i){var m=f.state||(f.state=new d),y=m.get,g=m.has,v=m.set;n=function(e,t){if(g.call(m,e))throw new TypeError("Object already initialized");return t.facade=e,v.call(m,e,t),t},o=function(e){return y.call(m,e)||{}},a=function(e){return g.call(m,e)}}else{var E=p("state");h[E]=!0,n=function(e,t){if(l(e,E))throw new TypeError("Object already initialized");return t.facade=e,c(e,E,t),t},o=function(e){return l(e,E)?e[E]:{}},a=function(e){return l(e,E)}}e.exports={set:n,get:o,has:a,enforce:function(e){return a(e)?o(e):n(e,{})},getterFor:function(e){return function(t){var r;if(!s(t)||(r=o(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return r}}}},function(e,t,r){var n=r(3),o=r(25),a=n.WeakMap;e.exports="function"==typeof a&&/native code/.test(o(a))},function(e,t,r){var n=r(30),o=r(32),a=n("keys");e.exports=function(e){return a[e]||(a[e]=o(e))}},function(e,t,r){var n=r(31),o=r(26);(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.11.0",mode:n?"pure":"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})},function(e,t){e.exports=!1},function(e,t){var r=0,n=Math.random();e.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++r+n).toString(36)}},function(e,t){e.exports={}},function(e,t,r){var n=r(16),o=r(35),a=r(5),i=r(21);e.exports=function(e,t){for(var r=o(t),u=i.f,s=a.f,c=0;c<r.length;c++){var l=r[c];n(e,l)||u(e,l,s(t,l))}}},function(e,t,r){var n=r(36),o=r(38),a=r(45),i=r(22);e.exports=n("Reflect","ownKeys")||function(e){var t=o.f(i(e)),r=a.f;return r?t.concat(r(e)):t}},function(e,t,r){var n=r(37),o=r(3),a=function(e){return"function"==typeof e?e:void 0};e.exports=function(e,t){return arguments.length<2?a(n[e])||a(o[e]):n[e]&&n[e][t]||o[e]&&o[e][t]}},function(e,t,r){var n=r(3);e.exports=n},function(e,t,r){var n=r(39),o=r(44).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,o)}},function(e,t,r){var n=r(16),o=r(10),a=r(40).indexOf,i=r(33);e.exports=function(e,t){var r,u=o(e),s=0,c=[];for(r in u)!n(i,r)&&n(u,r)&&c.push(r);for(;t.length>s;)n(u,r=t[s++])&&(~a(c,r)||c.push(r));return c}},function(e,t,r){var n=r(10),o=r(41),a=r(43),i=function(e){return function(t,r,i){var u,s=n(t),c=o(s.length),l=a(i,c);if(e&&r!=r){for(;c>l;)if((u=s[l++])!=u)return!0}else for(;c>l;l++)if((e||l in s)&&s[l]===r)return e||l||0;return!e&&-1}};e.exports={includes:i(!0),indexOf:i(!1)}},function(e,t,r){var n=r(42),o=Math.min;e.exports=function(e){return e>0?o(n(e),9007199254740991):0}},function(e,t){var r=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:r)(e)}},function(e,t,r){var n=r(42),o=Math.max,a=Math.min;e.exports=function(e,t){var r=n(e);return r<0?o(r+t,0):a(r,t)}},function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,r){var n=r(7),o=/#|\.prototype\./,a=function(e,t){var r=u[i(e)];return r==c||r!=s&&("function"==typeof t?n(t):!!t)},i=a.normalize=function(e){return String(e).replace(o,".").toLowerCase()},u=a.data={},s=a.NATIVE="N",c=a.POLYFILL="P";e.exports=a},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}},function(e,t,r){var n,o=r(22),a=r(49),i=r(44),u=r(33),s=r(51),c=r(19),l=r(29),f=l("IE_PROTO"),p=function(){},h=function(e){return"<script>"+e+"<\/script>"},d=function(){try{n=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e,t;d=n?function(e){e.write(h("")),e.close();var t=e.parentWindow.Object;return e=null,t}(n):((t=c("iframe")).style.display="none",s.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(h("document.F=Object")),e.close(),e.F);for(var r=i.length;r--;)delete d.prototype[i[r]];return d()};u[f]=!0,e.exports=Object.create||function(e,t){var r;return null!==e?(p.prototype=o(e),r=new p,p.prototype=null,r[f]=e):r=d(),void 0===t?r:a(r,t)}},function(e,t,r){var n=r(6),o=r(21),a=r(22),i=r(50);e.exports=n?Object.defineProperties:function(e,t){a(e);for(var r,n=i(t),u=n.length,s=0;u>s;)o.f(e,r=n[s++],t[r]);return e}},function(e,t,r){var n=r(39),o=r(44);e.exports=Object.keys||function(e){return n(e,o)}},function(e,t,r){var n=r(36);e.exports=n("document","documentElement")},function(e,t,r){"use strict";var n=r(47),o=r(15),a=[].slice,i={},u=function(e,t,r){if(!(t in i)){for(var n=[],o=0;o<t;o++)n[o]="a["+o+"]";i[t]=Function("C,a","return new C("+n.join(",")+")")}return i[t](e,r)};e.exports=Function.bind||function(e){var t=n(this),r=a.call(arguments,1),i=function(){var n=r.concat(a.call(arguments));return this instanceof i?u(t,n.length,n):t.apply(e,n)};return o(t.prototype)&&(i.prototype=t.prototype),i}},function(e,t,r){"use strict";var n=r(2),o=r(15),a=r(54),i=r(43),u=r(41),s=r(10),c=r(55),l=r(56),f=r(62)("slice"),p=l("species"),h=[].slice,d=Math.max;n({target:"Array",proto:!0,forced:!f},{slice:function(e,t){var r,n,l,f=s(this),m=u(f.length),y=i(e,m),g=i(void 0===t?m:t,m);if(a(f)&&("function"!=typeof(r=f.constructor)||r!==Array&&!a(r.prototype)?o(r)&&null===(r=r[p])&&(r=void 0):r=void 0,r===Array||void 0===r))return h.call(f,y,g);for(n=new(void 0===r?Array:r)(d(g-y,0)),l=0;y<g;y++,l++)y in f&&c(n,l,f[y]);return n.length=l,n}})},function(e,t,r){var n=r(12);e.exports=Array.isArray||function(e){return"Array"==n(e)}},function(e,t,r){"use strict";var n=r(14),o=r(21),a=r(9);e.exports=function(e,t,r){var i=n(t);i in e?o.f(e,i,a(0,r)):e[i]=r}},function(e,t,r){var n=r(3),o=r(30),a=r(16),i=r(32),u=r(57),s=r(61),c=o("wks"),l=n.Symbol,f=s?l:l&&l.withoutSetter||i;e.exports=function(e){return a(c,e)&&(u||"string"==typeof c[e])||(u&&a(l,e)?c[e]=l[e]:c[e]=f("Symbol."+e)),c[e]}},function(e,t,r){var n=r(58),o=r(59),a=r(7);e.exports=!!Object.getOwnPropertySymbols&&!a((function(){return!Symbol.sham&&(n?38===o:o>37&&o<41)}))},function(e,t,r){var n=r(12),o=r(3);e.exports="process"==n(o.process)},function(e,t,r){var n,o,a=r(3),i=r(60),u=a.process,s=u&&u.versions,c=s&&s.v8;c?o=(n=c.split("."))[0]+n[1]:i&&(!(n=i.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=i.match(/Chrome\/(\d+)/))&&(o=n[1]),e.exports=o&&+o},function(e,t,r){var n=r(36);e.exports=n("navigator","userAgent")||""},function(e,t,r){var n=r(57);e.exports=n&&!Symbol.sham&&"symbol"==i(Symbol.iterator)},function(e,t,r){var n=r(7),o=r(56),a=r(59),i=o("species");e.exports=function(e){return a>=51||!n((function(){var t=[];return(t.constructor={})[i]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},function(e,t,r){var n=r(64),o=r(23),a=r(65);n||o(Object.prototype,"toString",a,{unsafe:!0})},function(e,t,r){var n={};n[r(56)("toStringTag")]="z",e.exports="[object z]"===String(n)},function(e,t,r){"use strict";var n=r(64),o=r(66);e.exports=n?{}.toString:function(){return"[object "+o(this)+"]"}},function(e,t,r){var n=r(64),o=r(12),a=r(56)("toStringTag"),i="Arguments"==o(function(){return arguments}());e.exports=n?o:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),a))?r:i?o(t):"Object"==(n=o(t))&&"function"==typeof t.callee?"Arguments":n}},function(e,t,r){var n=r(6),o=r(21).f,a=Function.prototype,i=a.toString,u=/^\s*function ([^ (]*)/;n&&!("name"in a)&&o(a,"name",{configurable:!0,get:function(){try{return i.call(this).match(u)[1]}catch(e){return""}}})},function(e,t,r){var n=r(2),o=r(69);n({target:"Array",stat:!0,forced:!r(76)((function(e){Array.from(e)}))},{from:o})},function(e,t,r){"use strict";var n=r(70),o=r(17),a=r(71),i=r(73),u=r(41),s=r(55),c=r(75);e.exports=function(e){var t,r,l,f,p,h,d=o(e),m="function"==typeof this?this:Array,y=arguments.length,g=y>1?arguments[1]:void 0,v=void 0!==g,E=c(d),T=0;if(v&&(g=n(g,y>2?arguments[2]:void 0,2)),null==E||m==Array&&i(E))for(r=new m(t=u(d.length));t>T;T++)h=v?g(d[T],T):d[T],s(r,T,h);else for(p=(f=E.call(d)).next,r=new m;!(l=p.call(f)).done;T++)h=v?a(f,g,[l.value,T],!0):l.value,s(r,T,h);return r.length=T,r}},function(e,t,r){var n=r(47);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 0:return function(){return e.call(t)};case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)}}return function(){return e.apply(t,arguments)}}},function(e,t,r){var n=r(22),o=r(72);e.exports=function(e,t,r,a){try{return a?t(n(r)[0],r[1]):t(r)}catch(t){throw o(e),t}}},function(e,t,r){var n=r(22);e.exports=function(e){var t=e.return;if(void 0!==t)return n(t.call(e)).value}},function(e,t,r){var n=r(56),o=r(74),a=n("iterator"),i=Array.prototype;e.exports=function(e){return void 0!==e&&(o.Array===e||i[a]===e)}},function(e,t){e.exports={}},function(e,t,r){var n=r(66),o=r(74),a=r(56)("iterator");e.exports=function(e){if(null!=e)return e[a]||e["@@iterator"]||o[n(e)]}},function(e,t,r){var n=r(56)("iterator"),o=!1;try{var a=0,i={next:function(){return{done:!!a++}},return:function(){o=!0}};i[n]=function(){return this},Array.from(i,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!o)return!1;var r=!1;try{var a={};a[n]=function(){return{next:function(){return{done:r=!0}}}},e(a)}catch(e){}return r}},function(e,t,r){"use strict";var n=r(78).charAt,o=r(27),a=r(79),i=o.set,u=o.getterFor("String Iterator");a(String,"String",(function(e){i(this,{type:"String Iterator",string:String(e),index:0})}),(function(){var e,t=u(this),r=t.string,o=t.index;return o>=r.length?{value:void 0,done:!0}:(e=n(r,o),t.index+=e.length,{value:e,done:!1})}))},function(e,t,r){var n=r(42),o=r(13),a=function(e){return function(t,r){var a,i,u=String(o(t)),s=n(r),c=u.length;return s<0||s>=c?e?"":void 0:(a=u.charCodeAt(s))<55296||a>56319||s+1===c||(i=u.charCodeAt(s+1))<56320||i>57343?e?u.charAt(s):a:e?u.slice(s,s+2):i-56320+(a-55296<<10)+65536}};e.exports={codeAt:a(!1),charAt:a(!0)}},function(e,t,r){"use strict";var n=r(2),o=r(80),a=r(82),i=r(85),u=r(84),s=r(20),c=r(23),l=r(56),f=r(31),p=r(74),h=r(81),d=h.IteratorPrototype,m=h.BUGGY_SAFARI_ITERATORS,y=l("iterator"),g=function(){return this};e.exports=function(e,t,r,l,h,v,E){o(r,t,l);var T,b,R,A=function(e){if(e===h&&w)return w;if(!m&&e in O)return O[e];switch(e){case"keys":case"values":case"entries":return function(){return new r(this,e)}}return function(){return new r(this)}},S=t+" Iterator",N=!1,O=e.prototype,C=O[y]||O["@@iterator"]||h&&O[h],w=!m&&C||A(h),M="Array"==t&&O.entries||C;if(M&&(T=a(M.call(new e)),d!==Object.prototype&&T.next&&(f||a(T)===d||(i?i(T,d):"function"!=typeof T[y]&&s(T,y,g)),u(T,S,!0,!0),f&&(p[S]=g))),"values"==h&&C&&"values"!==C.name&&(N=!0,w=function(){return C.call(this)}),f&&!E||O[y]===w||s(O,y,w),p[t]=w,h)if(b={values:A("values"),keys:v?w:A("keys"),entries:A("entries")},E)for(R in b)(m||N||!(R in O))&&c(O,R,b[R]);else n({target:t,proto:!0,forced:m||N},b);return b}},function(e,t,r){"use strict";var n=r(81).IteratorPrototype,o=r(48),a=r(9),i=r(84),u=r(74),s=function(){return this};e.exports=function(e,t,r){var c=t+" Iterator";return e.prototype=o(n,{next:a(1,r)}),i(e,c,!1,!0),u[c]=s,e}},function(e,t,r){"use strict";var n,o,a,i=r(7),u=r(82),s=r(20),c=r(16),l=r(56),f=r(31),p=l("iterator"),h=!1;[].keys&&("next"in(a=[].keys())?(o=u(u(a)))!==Object.prototype&&(n=o):h=!0);var d=null==n||i((function(){var e={};return n[p].call(e)!==e}));d&&(n={}),f&&!d||c(n,p)||s(n,p,(function(){return this})),e.exports={IteratorPrototype:n,BUGGY_SAFARI_ITERATORS:h}},function(e,t,r){var n=r(16),o=r(17),a=r(29),i=r(83),u=a("IE_PROTO"),s=Object.prototype;e.exports=i?Object.getPrototypeOf:function(e){return e=o(e),n(e,u)?e[u]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?s:null}},function(e,t,r){var n=r(7);e.exports=!n((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},function(e,t,r){var n=r(21).f,o=r(16),a=r(56)("toStringTag");e.exports=function(e,t,r){e&&!o(e=r?e:e.prototype,a)&&n(e,a,{configurable:!0,value:t})}},function(e,t,r){var n=r(22),o=r(86);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(r,[]),t=r instanceof Array}catch(e){}return function(r,a){return n(r),o(a),t?e.call(r,a):r.__proto__=a,r}}():void 0)},function(e,t,r){var n=r(15);e.exports=function(e){if(!n(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype");return e}},function(e,t,r){"use strict";var n=r(2),o=r(3),a=r(36),u=r(31),s=r(6),c=r(57),l=r(61),f=r(7),p=r(16),h=r(54),d=r(15),m=r(22),y=r(17),g=r(10),v=r(14),E=r(9),T=r(48),b=r(50),R=r(38),A=r(88),S=r(45),N=r(5),O=r(21),C=r(8),w=r(20),M=r(23),I=r(30),x=r(29),k=r(33),_=r(32),P=r(56),L=r(89),F=r(90),U=r(84),V=r(27),D=r(91).forEach,j=x("hidden"),B=P("toPrimitive"),G=V.set,W=V.getterFor("Symbol"),H=Object.prototype,z=o.Symbol,Y=a("JSON","stringify"),X=N.f,K=O.f,q=A.f,Q=C.f,$=I("symbols"),Z=I("op-symbols"),J=I("string-to-symbol-registry"),ee=I("symbol-to-string-registry"),te=I("wks"),re=o.QObject,ne=!re||!re.prototype||!re.prototype.findChild,oe=s&&f((function(){return 7!=T(K({},"a",{get:function(){return K(this,"a",{value:7}).a}})).a}))?function(e,t,r){var n=X(H,t);n&&delete H[t],K(e,t,r),n&&e!==H&&K(H,t,n)}:K,ae=function(e,t){var r=$[e]=T(z.prototype);return G(r,{type:"Symbol",tag:e,description:t}),s||(r.description=t),r},ie=l?function(e){return"symbol"==i(e)}:function(e){return Object(e)instanceof z},ue=function(e,t,r){e===H&&ue(Z,t,r),m(e);var n=v(t,!0);return m(r),p($,n)?(r.enumerable?(p(e,j)&&e[j][n]&&(e[j][n]=!1),r=T(r,{enumerable:E(0,!1)})):(p(e,j)||K(e,j,E(1,{})),e[j][n]=!0),oe(e,n,r)):K(e,n,r)},se=function(e,t){m(e);var r=g(t),n=b(r).concat(pe(r));return D(n,(function(t){s&&!ce.call(r,t)||ue(e,t,r[t])})),e},ce=function(e){var t=v(e,!0),r=Q.call(this,t);return!(this===H&&p($,t)&&!p(Z,t))&&(!(r||!p(this,t)||!p($,t)||p(this,j)&&this[j][t])||r)},le=function(e,t){var r=g(e),n=v(t,!0);if(r!==H||!p($,n)||p(Z,n)){var o=X(r,n);return!o||!p($,n)||p(r,j)&&r[j][n]||(o.enumerable=!0),o}},fe=function(e){var t=q(g(e)),r=[];return D(t,(function(e){p($,e)||p(k,e)||r.push(e)})),r},pe=function(e){var t=e===H,r=q(t?Z:g(e)),n=[];return D(r,(function(e){!p($,e)||t&&!p(H,e)||n.push($[e])})),n};c||(M((z=function(){if(this instanceof z)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=_(e),r=function e(r){this===H&&e.call(Z,r),p(this,j)&&p(this[j],t)&&(this[j][t]=!1),oe(this,t,E(1,r))};return s&&ne&&oe(H,t,{configurable:!0,set:r}),ae(t,e)}).prototype,"toString",(function(){return W(this).tag})),M(z,"withoutSetter",(function(e){return ae(_(e),e)})),C.f=ce,O.f=ue,N.f=le,R.f=A.f=fe,S.f=pe,L.f=function(e){return ae(P(e),e)},s&&(K(z.prototype,"description",{configurable:!0,get:function(){return W(this).description}}),u||M(H,"propertyIsEnumerable",ce,{unsafe:!0}))),n({global:!0,wrap:!0,forced:!c,sham:!c},{Symbol:z}),D(b(te),(function(e){F(e)})),n({target:"Symbol",stat:!0,forced:!c},{for:function(e){var t=String(e);if(p(J,t))return J[t];var r=z(t);return J[t]=r,ee[r]=t,r},keyFor:function(e){if(!ie(e))throw TypeError(e+" is not a symbol");if(p(ee,e))return ee[e]},useSetter:function(){ne=!0},useSimple:function(){ne=!1}}),n({target:"Object",stat:!0,forced:!c,sham:!s},{create:function(e,t){return void 0===t?T(e):se(T(e),t)},defineProperty:ue,defineProperties:se,getOwnPropertyDescriptor:le}),n({target:"Object",stat:!0,forced:!c},{getOwnPropertyNames:fe,getOwnPropertySymbols:pe}),n({target:"Object",stat:!0,forced:f((function(){S.f(1)}))},{getOwnPropertySymbols:function(e){return S.f(y(e))}}),Y&&n({target:"JSON",stat:!0,forced:!c||f((function(){var e=z();return"[null]"!=Y([e])||"{}"!=Y({a:e})||"{}"!=Y(Object(e))}))},{stringify:function(e,t,r){for(var n,o=[e],a=1;arguments.length>a;)o.push(arguments[a++]);if(n=t,(d(t)||void 0!==e)&&!ie(e))return h(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!ie(t))return t}),o[1]=t,Y.apply(null,o)}}),z.prototype[B]||w(z.prototype,B,z.prototype.valueOf),U(z,"Symbol"),k[j]=!0},function(e,t,r){var n=r(10),o=r(38).f,a={}.toString,u="object"==("undefined"==typeof window?"undefined":i(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return u&&"[object Window]"==a.call(e)?function(e){try{return o(e)}catch(e){return u.slice()}}(e):o(n(e))}},function(e,t,r){var n=r(56);t.f=n},function(e,t,r){var n=r(37),o=r(16),a=r(89),i=r(21).f;e.exports=function(e){var t=n.Symbol||(n.Symbol={});o(t,e)||i(t,e,{value:a.f(e)})}},function(e,t,r){var n=r(70),o=r(11),a=r(17),i=r(41),u=r(92),s=[].push,c=function(e){var t=1==e,r=2==e,c=3==e,l=4==e,f=6==e,p=7==e,h=5==e||f;return function(d,m,y,g){for(var v,E,T=a(d),b=o(T),R=n(m,y,3),A=i(b.length),S=0,N=g||u,O=t?N(d,A):r||p?N(d,0):void 0;A>S;S++)if((h||S in b)&&(E=R(v=b[S],S,T),e))if(t)O[S]=E;else if(E)switch(e){case 3:return!0;case 5:return v;case 6:return S;case 2:s.call(O,v)}else switch(e){case 4:return!1;case 7:s.call(O,v)}return f?-1:c||l?l:O}};e.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6),filterOut:c(7)}},function(e,t,r){var n=r(15),o=r(54),a=r(56)("species");e.exports=function(e,t){var r;return o(e)&&("function"!=typeof(r=e.constructor)||r!==Array&&!o(r.prototype)?n(r)&&null===(r=r[a])&&(r=void 0):r=void 0),new(void 0===r?Array:r)(0===t?0:t)}},function(e,t,r){"use strict";var n=r(2),o=r(6),a=r(3),i=r(16),u=r(15),s=r(21).f,c=r(34),l=a.Symbol;if(o&&"function"==typeof l&&(!("description"in l.prototype)||void 0!==l().description)){var f={},p=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof p?new l(e):void 0===e?l():l(e);return""===e&&(f[t]=!0),t};c(p,l);var h=p.prototype=l.prototype;h.constructor=p;var d=h.toString,m="Symbol(test)"==String(l("test")),y=/^Symbol\((.*)\)[^)]+$/;s(h,"description",{configurable:!0,get:function(){var e=u(this)?this.valueOf():this,t=d.call(e);if(i(f,e))return"";var r=m?t.slice(7,-1):t.replace(y,"$1");return""===r?void 0:r}}),n({global:!0,forced:!0},{Symbol:p})}},function(e,t,r){r(90)("iterator")},function(e,t,r){"use strict";var n=r(10),o=r(96),a=r(74),i=r(27),u=r(79),s=i.set,c=i.getterFor("Array Iterator");e.exports=u(Array,"Array",(function(e,t){s(this,{type:"Array Iterator",target:n(e),index:0,kind:t})}),(function(){var e=c(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:t[n],done:!1}:{value:[n,t[n]],done:!1}}),"values"),a.Arguments=a.Array,o("keys"),o("values"),o("entries")},function(e,t,r){var n=r(56),o=r(48),a=r(21),i=n("unscopables"),u=Array.prototype;null==u[i]&&a.f(u,i,{configurable:!0,value:o(null)}),e.exports=function(e){u[i][e]=!0}},function(e,t,r){var n=r(3),o=r(98),a=r(95),i=r(20),u=r(56),s=u("iterator"),c=u("toStringTag"),l=a.values;for(var f in o){var p=n[f],h=p&&p.prototype;if(h){if(h[s]!==l)try{i(h,s,l)}catch(e){h[s]=l}if(h[c]||i(h,c,f),o[f])for(var d in a)if(h[d]!==a[d])try{i(h,d,a[d])}catch(e){h[d]=a[d]}}}},function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(e,t,r){"use strict";var n,o=r(3),a=r(100),i=r(101),u=r(103),s=r(107),c=r(15),l=r(27).enforce,f=r(28),p=!o.ActiveXObject&&"ActiveXObject"in o,h=Object.isExtensible,d=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},m=e.exports=u("WeakMap",d,s);if(f&&p){n=s.getConstructor(d,"WeakMap",!0),i.REQUIRED=!0;var y=m.prototype,g=y.delete,v=y.has,E=y.get,T=y.set;a(y,{delete:function(e){if(c(e)&&!h(e)){var t=l(this);return t.frozen||(t.frozen=new n),g.call(this,e)||t.frozen.delete(e)}return g.call(this,e)},has:function(e){if(c(e)&&!h(e)){var t=l(this);return t.frozen||(t.frozen=new n),v.call(this,e)||t.frozen.has(e)}return v.call(this,e)},get:function(e){if(c(e)&&!h(e)){var t=l(this);return t.frozen||(t.frozen=new n),v.call(this,e)?E.call(this,e):t.frozen.get(e)}return E.call(this,e)},set:function(e,t){if(c(e)&&!h(e)){var r=l(this);r.frozen||(r.frozen=new n),v.call(this,e)?T.call(this,e,t):r.frozen.set(e,t)}else T.call(this,e,t);return this}})}},function(e,t,r){var n=r(23);e.exports=function(e,t,r){for(var o in t)n(e,o,t[o],r);return e}},function(e,t,r){var n=r(33),o=r(15),a=r(16),u=r(21).f,s=r(32),c=r(102),l=s("meta"),f=0,p=Object.isExtensible||function(){return!0},h=function(e){u(e,l,{value:{objectID:"O"+ ++f,weakData:{}}})},d=e.exports={REQUIRED:!1,fastKey:function(e,t){if(!o(e))return"symbol"==i(e)?e:("string"==typeof e?"S":"P")+e;if(!a(e,l)){if(!p(e))return"F";if(!t)return"E";h(e)}return e[l].objectID},getWeakData:function(e,t){if(!a(e,l)){if(!p(e))return!0;if(!t)return!1;h(e)}return e[l].weakData},onFreeze:function(e){return c&&d.REQUIRED&&p(e)&&!a(e,l)&&h(e),e}};n[l]=!0},function(e,t,r){var n=r(7);e.exports=!n((function(){return Object.isExtensible(Object.preventExtensions({}))}))},function(e,t,r){"use strict";var n=r(2),o=r(3),a=r(46),i=r(23),u=r(101),s=r(104),c=r(105),l=r(15),f=r(7),p=r(76),h=r(84),d=r(106);e.exports=function(e,t,r){var m=-1!==e.indexOf("Map"),y=-1!==e.indexOf("Weak"),g=m?"set":"add",v=o[e],E=v&&v.prototype,T=v,b={},R=function(e){var t=E[e];i(E,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(y&&!l(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return y&&!l(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(y&&!l(e))&&t.call(this,0===e?0:e)}:function(e,r){return t.call(this,0===e?0:e,r),this})};if(a(e,"function"!=typeof v||!(y||E.forEach&&!f((function(){(new v).entries().next()})))))T=r.getConstructor(t,e,m,g),u.REQUIRED=!0;else if(a(e,!0)){var A=new T,S=A[g](y?{}:-0,1)!=A,N=f((function(){A.has(1)})),O=p((function(e){new v(e)})),C=!y&&f((function(){for(var e=new v,t=5;t--;)e[g](t,t);return!e.has(-0)}));O||((T=t((function(t,r){c(t,T,e);var n=d(new v,t,T);return null!=r&&s(r,n[g],{that:n,AS_ENTRIES:m}),n}))).prototype=E,E.constructor=T),(N||C)&&(R("delete"),R("has"),m&&R("get")),(C||S)&&R(g),y&&E.clear&&delete E.clear}return b[e]=T,n({global:!0,forced:T!=v},b),h(T,e),y||r.setStrong(T,e,m),T}},function(e,t,r){var n=r(22),o=r(73),a=r(41),u=r(70),s=r(75),c=r(72),l=function(e,t){this.stopped=e,this.result=t};e.exports=function(e,t,r){var f,p,h,d,m,y,g,v=r&&r.that,E=!(!r||!r.AS_ENTRIES),T=!(!r||!r.IS_ITERATOR),b=!(!r||!r.INTERRUPTED),R=u(t,v,1+E+b),A=function(e){return f&&c(f),new l(!0,e)},S=function(e){return E?(n(e),b?R(e[0],e[1],A):R(e[0],e[1])):b?R(e,A):R(e)};if(T)f=e;else{if("function"!=typeof(p=s(e)))throw TypeError("Target is not iterable");if(o(p)){for(h=0,d=a(e.length);d>h;h++)if((m=S(e[h]))&&m instanceof l)return m;return new l(!1)}f=p.call(e)}for(y=f.next;!(g=y.call(f)).done;){try{m=S(g.value)}catch(e){throw c(f),e}if("object"==i(m)&&m&&m instanceof l)return m}return new l(!1)}},function(e,t){e.exports=function(e,t,r){if(!(e instanceof t))throw TypeError("Incorrect "+(r?r+" ":"")+"invocation");return e}},function(e,t,r){var n=r(15),o=r(85);e.exports=function(e,t,r){var a,i;return o&&"function"==typeof(a=t.constructor)&&a!==r&&n(i=a.prototype)&&i!==r.prototype&&o(e,i),e}},function(e,t,r){"use strict";var n=r(100),o=r(101).getWeakData,a=r(22),i=r(15),u=r(105),s=r(104),c=r(91),l=r(16),f=r(27),p=f.set,h=f.getterFor,d=c.find,m=c.findIndex,y=0,g=function(e){return e.frozen||(e.frozen=new v)},v=function(){this.entries=[]},E=function(e,t){return d(e.entries,(function(e){return e[0]===t}))};v.prototype={get:function(e){var t=E(this,e);if(t)return t[1]},has:function(e){return!!E(this,e)},set:function(e,t){var r=E(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=m(this.entries,(function(t){return t[0]===e}));return~t&&this.entries.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,r,c){var f=e((function(e,n){u(e,f,t),p(e,{type:t,id:y++,frozen:void 0}),null!=n&&s(n,e[c],{that:e,AS_ENTRIES:r})})),d=h(t),m=function(e,t,r){var n=d(e),i=o(a(t),!0);return!0===i?g(n).set(t,r):i[n.id]=r,e};return n(f.prototype,{delete:function(e){var t=d(this);if(!i(e))return!1;var r=o(e);return!0===r?g(t).delete(e):r&&l(r,t.id)&&delete r[t.id]},has:function(e){var t=d(this);if(!i(e))return!1;var r=o(e);return!0===r?g(t).has(e):r&&l(r,t.id)}}),n(f.prototype,r?{get:function(e){var t=d(this);if(i(e)){var r=o(e);return!0===r?g(t).get(e):r?r[t.id]:void 0}},set:function(e,t){return m(this,e,t)}}:{add:function(e){return m(this,e,!0)}}),f}}},function(e,t,r){var n=r(2),o=r(7),a=r(10),i=r(5).f,u=r(6),s=o((function(){i(1)}));n({target:"Object",stat:!0,forced:!u||s,sham:!u},{getOwnPropertyDescriptor:function(e,t){return i(a(e),t)}})},function(e,t,r){var n=r(2),o=r(7),a=r(17),i=r(82),u=r(83);n({target:"Object",stat:!0,forced:o((function(){i(1)})),sham:!u},{getPrototypeOf:function(e){return i(a(e))}})},function(e,t,r){var n=r(2),o=r(7),a=r(88).f;n({target:"Object",stat:!0,forced:o((function(){return!Object.getOwnPropertyNames(1)}))},{getOwnPropertyNames:a})},function(e,t,r){"use strict";var n,o=r(2),a=r(5).f,i=r(41),u=r(112),s=r(13),c=r(114),l=r(31),f="".startsWith,p=Math.min,h=c("startsWith");o({target:"String",proto:!0,forced:!(!l&&!h&&(n=a(String.prototype,"startsWith"),n&&!n.writable)||h)},{startsWith:function(e){var t=String(s(this));u(e);var r=i(p(arguments.length>1?arguments[1]:void 0,t.length)),n=String(e);return f?f.call(t,n,r):t.slice(r,r+n.length)===n}})},function(e,t,r){var n=r(113);e.exports=function(e){if(n(e))throw TypeError("The method doesn't accept regular expressions");return e}},function(e,t,r){var n=r(15),o=r(12),a=r(56)("match");e.exports=function(e){var t;return n(e)&&(void 0!==(t=e[a])?!!t:"RegExp"==o(e))}},function(e,t,r){var n=r(56)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[n]=!1,"/./"[e](t)}catch(e){}}return!1}},function(e,t,r){"use strict";t.__esModule=!0,t.absoluteSheetReference=t.movedSimpleCellAddress=t.invalidSimpleCellAddress=t.simpleCellAddress=t.invalidSimpleColumnAddress=t.simpleColumnAddress=t.invalidSimpleRowAddress=t.simpleRowAddress=t.CellError=t.getCellValueFormat=t.getCellValueDetailedType=t.getCellValueType=t.CellValueTypeOrd=t.CellValueDetailedType=t.CellValueType=t.CellValueJustNumber=t.CellValueNoNumber=t.getCellType=t.CellType=t.ErrorType=void 0,r(116);var n,o,a,i,u=r(118),s=r(215),c=r(223),l=r(222);function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}t.ErrorType=n,function(e){e.DIV_BY_ZERO="DIV_BY_ZERO",e.NAME="NAME",e.VALUE="VALUE",e.NUM="NUM",e.NA="NA",e.CYCLE="CYCLE",e.REF="REF",e.LIC="LIC",e.ERROR="ERROR"}(n||(t.ErrorType=n={})),t.CellType=o,function(e){e.FORMULA="FORMULA",e.VALUE="VALUE",e.MATRIX="MATRIX",e.EMPTY="EMPTY"}(o||(t.CellType=o={})),t.getCellType=function(e){return e instanceof u.FormulaCellVertex||e instanceof u.ParsingErrorVertex?o.FORMULA:e instanceof u.ValueCellVertex||e instanceof u.MatrixVertex&&e.isNumeric()?o.VALUE:e instanceof u.MatrixVertex&&e.isFormula()?o.MATRIX:o.EMPTY},t.CellValueNoNumber=a,function(e){e.EMPTY="EMPTY",e.NUMBER="NUMBER",e.STRING="STRING",e.BOOLEAN="BOOLEAN",e.ERROR="ERROR"}(a||(t.CellValueNoNumber=a={})),t.CellValueJustNumber=i,function(e){e.NUMBER="NUMBER"}(i||(t.CellValueJustNumber=i={}));var p=Object.assign(Object.assign({},a),i);t.CellValueType=p;var h=Object.assign(Object.assign({},a),c.NumberType);t.CellValueDetailedType=h,t.CellValueTypeOrd=function(e){switch(e){case p.EMPTY:return 0;case p.NUMBER:return 1;case p.STRING:return 2;case p.BOOLEAN:return 3;case p.ERROR:return 4}throw new Error("Cell value not computed")};var d=function(e){if(e===c.EmptyValue)return p.EMPTY;if(e instanceof m||e instanceof l.SimpleRangeValue)return p.ERROR;if("string"==typeof e)return p.STRING;if((0,c.isExtendedNumber)(e))return p.NUMBER;if("boolean"==typeof e)return p.BOOLEAN;throw new Error("Cell value not computed")};t.getCellValueType=d,t.getCellValueDetailedType=function(e){return(0,c.isExtendedNumber)(e)?(0,c.getTypeOfExtendedNumber)(e):d(e)},t.getCellValueFormat=function(e){return(0,c.isExtendedNumber)(e)?(0,c.getFormatOfExtendedNumber)(e):void 0};var m=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=t,this.message=r,this.address=n}var t,r,o;return t=e,o=[{key:"parsingError",value:function(){return new e(n.ERROR,s.ErrorMessage.ParseError)}}],(r=[{key:"attachAddress",value:function(t){return void 0===this.address?new e(this.type,this.message,t):this}}])&&f(t.prototype,r),o&&f(t,o),e}();t.CellError=m,t.simpleRowAddress=function(e,t){return{sheet:e,row:t}},t.invalidSimpleRowAddress=function(e){return e.row<0},t.simpleColumnAddress=function(e,t){return{sheet:e,col:t}},t.invalidSimpleColumnAddress=function(e){return e.col<0};var y=function(e,t,r){return{sheet:e,col:t,row:r}};t.simpleCellAddress=y,t.invalidSimpleCellAddress=function(e){return e.col<0||e.row<0},t.movedSimpleCellAddress=function(e,t,r,n){return y(t,e.col+r,e.row+n)},t.absoluteSheetReference=function(e,t){return null===e.sheet?t.sheet:e.sheet}},function(e,t,r){var n=r(2),o=r(117);n({target:"Object",stat:!0,forced:Object.assign!==o},{assign:o})},function(e,t,r){"use strict";var n=r(6),o=r(7),a=r(50),i=r(45),u=r(8),s=r(17),c=r(11),l=Object.assign,f=Object.defineProperty;e.exports=!l||o((function(){if(n&&1!==l({b:1},l(f({},"a",{enumerable:!0,get:function(){f(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},r=Symbol();return e[r]=7,"abcdefghijklmnopqrst".split("").forEach((function(e){t[e]=e})),7!=l({},e)[r]||"abcdefghijklmnopqrst"!=a(l({},t)).join("")}))?function(e,t){for(var r=s(e),o=arguments.length,l=1,f=i.f,p=u.f;o>l;)for(var h,d=c(arguments[l++]),m=f?a(d).concat(f(d)):a(d),y=m.length,g=0;y>g;)h=m[g++],n&&!p.call(d,h)||(r[h]=d[h]);return r}:l},function(e,t,r){"use strict";t.__esModule=!0,t.DenseStrategy=t.SparseStrategy=t.RangeVertex=t.ParsingErrorVertex=t.ValueCellVertex=t.EmptyCellVertex=t.FormulaCellVertex=t.MatrixVertex=t.MatrixMapping=t.SheetMapping=t.RangeMapping=t.Graph=t.AddressMapping=t.DependencyGraph=void 0;var n=r(119);t.DependencyGraph=n.DependencyGraph;var o=r(228);t.AddressMapping=o.AddressMapping;var a=r(238);t.Graph=a.Graph;var i=r(241);t.RangeMapping=i.RangeMapping;var u=r(243);t.SheetMapping=u.SheetMapping;var s=r(240);t.MatrixMapping=s.MatrixMapping;var c=r(234);t.MatrixVertex=c.MatrixVertex;var l=r(233);t.FormulaCellVertex=l.FormulaCellVertex;var f=r(249);t.EmptyCellVertex=f.EmptyCellVertex;var p=r(250);t.ValueCellVertex=p.ValueCellVertex;var h=r(251);t.ParsingErrorVertex=h.ParsingErrorVertex;var d=r(237);t.RangeVertex=d.RangeVertex;var m=r(252);t.SparseStrategy=m.SparseStrategy;var y=r(253);t.DenseStrategy=y.DenseStrategy},function(e,t,r){"use strict";r(87),r(93),r(94),r(53),t.__esModule=!0,t.DependencyGraph=void 0,r(120),r(121),r(67),r(95),r(63),r(122),r(77),r(97),r(125),r(126),r(68);var n,o=(n=r(129))&&n.__esModule?n:{default:n},a=r(135),i=r(220),u=r(115),s=r(215),c=r(222),l=r(141),f=r(219),p=r(224),h=r(118),d=r(228),m=r(232),y=r(238),g=r(240),v=r(241),E=r(243),T=r(223);function b(e){return function(e){if(Array.isArray(e))return N(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||S(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=S(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||S(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){if(e){if("string"==typeof e)return N(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?N(e,t):void 0}}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function O(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var C=function(){function e(t,r,n,o,u,s,c,f){var p=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.addressMapping=t,this.rangeMapping=r,this.sheetMapping=n,this.matrixMapping=o,this.stats=u,this.lazilyTransformingAstService=s,this.functionRegistry=c,this.namedExpressions=f,this.dependencyQueryAddresses=function(e){if(e instanceof h.RangeVertex)return p.rangeDependencyQuery(e).map((function(e){var t=A(e,2),r=t[0];return t[1],r}));var t=p.formulaDependencyQuery(e);if(void 0!==t){var r=A(t,2),n=r[0];return r[1].map((function(e){return e instanceof l.NamedExpressionDependency?p.namedExpressions.namedExpressionOrPlaceholder(e.name,n.sheet).address:e}))}},this.dependencyQueryVertices=function(e){if(e instanceof h.RangeVertex)return p.rangeDependencyQuery(e).map((function(e){var t=A(e,2);return t[0],t[1]}));var t=p.formulaDependencyQuery(e);if(void 0!==t){var r=A(t,2),n=r[0];return r[1].map((function(e){if(e instanceof a.AbsoluteCellRange)return p.rangeMapping.fetchRange(e.start,e.end);if(e instanceof l.NamedExpressionDependency){var t=p.namedExpressions.namedExpressionOrPlaceholder(e.name,n.sheet);return p.addressMapping.fetchCell(t.address)}return p.addressMapping.fetchCell(e)}))}},this.rangeDependencyQuery=function(e){var t,r=[],n=p.rangeMapping.findSmallerRange(e.range),o=n.smallerRangeVertex,i=n.restRange;null!==o&&p.graph.adjacentNodes(o).has(e)?(t=i,r.push([new a.AbsoluteCellRange(o.start,o.end),o])):t=e.range;var u,s=R(t.addresses(p));try{for(s.s();!(u=s.n()).done;){var c=u.value,l=p.addressMapping.getCell(c);l instanceof h.EmptyCellVertex&&(l.address=c),null!==l&&r.push([c,l])}}catch(e){s.e(e)}finally{s.f()}return r},this.formulaDependencyQuery=function(e){var t,r;if(e instanceof h.FormulaCellVertex)r=e.getAddress(p.lazilyTransformingAstService),t=e.getFormula(p.lazilyTransformingAstService);else{if(!(e instanceof h.MatrixVertex&&e.isFormula()))return;r=e.getAddress(),t=e.getFormula()}var n=(0,l.collectDependencies)(t,p.functionRegistry);return[r,(0,i.absolutizeDependencies)(n,r)]},this.graph=new y.Graph(this.dependencyQueryVertices)}var t,r,n;return t=e,n=[{key:"buildEmpty",value:function(t,r,n,o,a){return new e(new d.AddressMapping(r.chooseAddressMappingPolicy),new v.RangeMapping,new E.SheetMapping(r.translationPackage),new g.MatrixMapping,a,t,n,o)}}],(r=[{key:"setFormulaToCell",value:function(e,t,r,n,o){var a=this.addressMapping.getCell(e);this.ensureThatVertexIsNonMatrixCellVertex(a);var i=new h.FormulaCellVertex(t,e,this.lazilyTransformingAstService.version());this.exchangeOrAddGraphNode(a,i),this.addressMapping.setCell(e,i),this.processCellDependencies(r,i),this.graph.markNodeAsSpecialRecentlyChanged(i),n&&this.markAsVolatile(i),o&&this.markAsDependentOnStructureChange(i),this.correctInfiniteRangesDependency(e)}},{key:"setParsingErrorToCell",value:function(e,t){var r=this.addressMapping.getCell(e);this.ensureThatVertexIsNonMatrixCellVertex(r),this.exchangeOrAddGraphNode(r,t),this.addressMapping.setCell(e,t),this.graph.markNodeAsSpecialRecentlyChanged(t),this.correctInfiniteRangesDependency(e)}},{key:"setValueToCell",value:function(e,t){var r=this.addressMapping.getCell(e);if(this.ensureThatVertexIsNonMatrixCellVertex(r),r instanceof h.ValueCellVertex)r.getValues().rawValue!==t.rawValue&&(r.setValues(t),this.graph.markNodeAsSpecialRecentlyChanged(r));else{var n=new h.ValueCellVertex(t.parsedValue,t.rawValue);this.exchangeOrAddGraphNode(r,n),this.addressMapping.setCell(e,n),this.graph.markNodeAsSpecialRecentlyChanged(n)}this.correctInfiniteRangesDependency(e)}},{key:"setCellEmpty",value:function(e){var t=this.addressMapping.getCell(e);if(null!==t)if(this.ensureThatVertexIsNonMatrixCellVertex(t),this.graph.adjacentNodes(t).size>0){var r=new h.EmptyCellVertex(e);this.exchangeGraphNode(t,r),0===this.graph.adjacentNodesCount(r)?(this.removeVertex(r),this.addressMapping.removeCell(e)):(this.graph.markNodeAsSpecialRecentlyChanged(r),this.addressMapping.setCell(e,r))}else this.removeVertex(t),this.addressMapping.removeCell(e)}},{key:"ensureThatVertexIsNonMatrixCellVertex",value:function(e){o.default.ok(!(e instanceof h.MatrixVertex),"Illegal operation")}},{key:"clearRecentlyChangedVertices",value:function(){this.graph.clearSpecialNodesRecentlyChanged()}},{key:"verticesToRecompute",value:function(){return new Set([].concat(b(this.graph.specialNodesRecentlyChanged),b(this.volatileVertices())))}},{key:"processCellDependencies",value:function(e,t){var r=this;e.forEach((function(e){if(e instanceof a.AbsoluteCellRange){var n=e,o=r.getRange(n.start,n.end);void 0===o&&(o=new h.RangeVertex(n),r.rangeMapping.setRange(o)),r.graph.addNode(o),n.isFinite()||r.graph.markNodeAsInfiniteRange(o);var i=r.rangeMapping.findSmallerRange(n),u=i.smallerRangeVertex,s=i.restRange;if(u){if(r.graph.addEdge(u,o),o.bruteForce){o.bruteForce=!1;var c,f=R(n.addresses(r));try{for(f.s();!(c=f.n()).done;){var p=c.value;r.graph.removeEdge(r.fetchCell(p),o)}}catch(e){f.e(e)}finally{f.f()}}}else o.bruteForce=!0;var d=r.matrixMapping.getMatrix(s);if(void 0!==d)r.graph.addEdge(d,o);else{var m,y=R(s.addresses(r));try{for(y.s();!(m=y.n()).done;){var g=m.value;r.graph.addEdge(r.fetchCellOrCreateEmpty(g),o)}}catch(e){y.e(e)}finally{y.f()}}r.graph.addEdge(o,t),n.isFinite()&&r.correctInfiniteRangesDependenciesByRangeVertex(o)}else if(e instanceof l.NamedExpressionDependency){var v=t.getAddress(r.lazilyTransformingAstService).sheet,E=r.fetchNamedExpressionVertex(e.name,v);r.graph.addEdge(E,t)}else r.graph.addEdge(r.fetchCellOrCreateEmpty(e),t)}))}},{key:"fetchNamedExpressionVertex",value:function(e,t){var r=this.namedExpressions.namedExpressionOrPlaceholder(e,t);return this.fetchCellOrCreateEmpty(r.address)}},{key:"exchangeNode",value:function(e,t){var r=this.fetchCellOrCreateEmpty(e),n=this.fetchCellOrCreateEmpty(t);this.addressMapping.removeCell(e),this.exchangeGraphNode(r,n)}},{key:"correctInfiniteRangesDependenciesByRangeVertex",value:function(e){var t,r=R(this.graph.infiniteRanges);try{for(r.s();!(t=r.n()).done;){var n=t.value,o=n,a=e.range.intersectionWith(o.range);if(null!==a){var i,u=R(a.addresses(this));try{for(u.s();!(i=u.n()).done;){var s=i.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(s),n)}}catch(e){u.e(e)}finally{u.f()}}}}catch(e){r.e(e)}finally{r.f()}}},{key:"correctInfiniteRangesDependency",value:function(e){var t,r=null,n=R(this.graph.infiniteRanges);try{for(n.s();!(t=n.n()).done;){var o=t.value;o.range.addressInRange(e)&&(r=r||this.fetchCellOrCreateEmpty(e),this.graph.addEdge(r,o))}}catch(e){n.e(e)}finally{n.f()}}},{key:"fetchCellOrCreateEmpty",value:function(e){var t=this.addressMapping.getCell(e);return t||(t=new h.EmptyCellVertex(e),this.graph.addNode(t),this.addressMapping.setCell(e,t)),t}},{key:"removeRows",value:function(e){var t=this;if(this.matrixMapping.isFormulaMatrixInRows(e))throw Error("It is not possible to remove row with matrix");this.stats.measure(p.StatType.ADJUSTING_GRAPH,(function(){var r,n=R(t.addressMapping.verticesFromRowsSpan(e));try{for(n.s();!(r=n.n()).done;){var o,a=r.value,i=R(t.graph.adjacentNodes(a));try{for(i.s();!(o=i.n()).done;){var u=o.value;t.graph.markNodeAsSpecialRecentlyChanged(u)}}catch(e){i.e(e)}finally{i.f()}a instanceof h.MatrixVertex||t.removeVertex(a)}}catch(e){n.e(e)}finally{n.f()}})),this.stats.measure(p.StatType.ADJUSTING_MATRIX_MAPPING,(function(){t.truncateMatricesAfterRemovingRows(e)})),this.stats.measure(p.StatType.ADJUSTING_ADDRESS_MAPPING,(function(){t.addressMapping.removeRows(e)})),this.stats.measure(p.StatType.ADJUSTING_RANGES,(function(){t.truncateRanges(e,(function(e){return e.row}))})),this.addStructuralNodesToChangeSet()}},{key:"removeSheet",value:function(e){var t,r=this,n=new Set,o=R(this.addressMapping.sheetEntries(e));try{for(o.s();!(t=o.n()).done;){var a=A(t.value,2),i=a[0],u=a[1];if(u instanceof h.MatrixVertex){if(n.has(u))continue;n.add(u)}var s,c=R(this.graph.adjacentNodes(u));try{for(c.s();!(s=c.n()).done;){var l=s.value;this.graph.markNodeAsSpecialRecentlyChanged(l)}}catch(e){c.e(e)}finally{c.f()}this.removeVertex(u),this.addressMapping.removeCell(i)}}catch(e){o.e(e)}finally{o.f()}this.stats.measure(p.StatType.ADJUSTING_MATRIX_MAPPING,(function(){var e,t=R(n.values());try{for(t.s();!(e=t.n()).done;){var o=e.value;r.matrixMapping.removeMatrix(o.getRange())}}catch(e){t.e(e)}finally{t.f()}})),this.stats.measure(p.StatType.ADJUSTING_RANGES,(function(){var t,n=R(r.rangeMapping.removeRangesInSheet(e));try{for(n.s();!(t=n.n()).done;){var o=t.value;r.removeVertex(o)}}catch(e){n.e(e)}finally{n.f()}r.stats.measure(p.StatType.ADJUSTING_ADDRESS_MAPPING,(function(){r.addressMapping.removeSheet(e)}))})),this.addStructuralNodesToChangeSet()}},{key:"clearSheet",value:function(e){var t,r=new Set,n=R(this.addressMapping.sheetEntries(e));try{for(n.s();!(t=n.n()).done;){var o=A(t.value,2),a=o[0],i=o[1];i instanceof h.MatrixVertex?r.add(i):this.setCellEmpty(a)}}catch(e){n.e(e)}finally{n.f()}var u,s=R(r.values());try{for(s.s();!(u=s.n()).done;){var c=u.value;this.setMatrixEmpty(c)}}catch(e){s.e(e)}finally{s.f()}this.addStructuralNodesToChangeSet()}},{key:"removeColumns",value:function(e){var t=this;if(this.matrixMapping.isFormulaMatrixInColumns(e))throw Error("It is not possible to remove column within matrix");this.stats.measure(p.StatType.ADJUSTING_GRAPH,(function(){var r,n=R(t.addressMapping.verticesFromColumnsSpan(e));try{for(n.s();!(r=n.n()).done;){var o,a=r.value,i=R(t.graph.adjacentNodes(a));try{for(i.s();!(o=i.n()).done;){var u=o.value;t.graph.markNodeAsSpecialRecentlyChanged(u)}}catch(e){i.e(e)}finally{i.f()}a instanceof h.MatrixVertex||t.removeVertex(a)}}catch(e){n.e(e)}finally{n.f()}})),this.stats.measure(p.StatType.ADJUSTING_MATRIX_MAPPING,(function(){t.truncateMatricesAfterRemovingColumns(e)})),this.stats.measure(p.StatType.ADJUSTING_ADDRESS_MAPPING,(function(){t.addressMapping.removeColumns(e)})),this.stats.measure(p.StatType.ADJUSTING_RANGES,(function(){t.truncateRanges(e,(function(e){return e.col}))})),this.addStructuralNodesToChangeSet()}},{key:"addRows",value:function(e){var t=this;this.stats.measure(p.StatType.ADJUSTING_ADDRESS_MAPPING,(function(){t.addressMapping.addRows(e.sheet,e.rowStart,e.numberOfRows)})),this.stats.measure(p.StatType.ADJUSTING_MATRIX_MAPPING,(function(){t.expandMatricesAfterAddingRows(e.sheet,e.rowStart,e.numberOfRows)})),this.stats.measure(p.StatType.ADJUSTING_RANGES,(function(){t.rangeMapping.moveAllRangesInSheetAfterRowByRows(e.sheet,e.rowStart,e.numberOfRows),t.fixRangesWhenAddingRows(e.sheet,e.rowStart,e.numberOfRows)}));var r,n=R(this.addressMapping.verticesFromRowsSpan(e));try{for(n.s();!(r=n.n()).done;){var o=r.value;this.graph.markNodeAsSpecialRecentlyChanged(o)}}catch(e){n.e(e)}finally{n.f()}this.addStructuralNodesToChangeSet()}},{key:"addColumns",value:function(e){var t=this;this.stats.measure(p.StatType.ADJUSTING_ADDRESS_MAPPING,(function(){t.addressMapping.addColumns(e.sheet,e.columnStart,e.numberOfColumns)})),this.stats.measure(p.StatType.ADJUSTING_MATRIX_MAPPING,(function(){t.expandMatricesAfterAddingColumns(e.sheet,e.columnStart,e.numberOfColumns)})),this.stats.measure(p.StatType.ADJUSTING_RANGES,(function(){t.rangeMapping.moveAllRangesInSheetAfterColumnByColumns(e.sheet,e.columnStart,e.numberOfColumns),t.fixRangesWhenAddingColumns(e.sheet,e.columnStart,e.numberOfColumns)}));var r,n=R(this.addressMapping.verticesFromColumnsSpan(e));try{for(n.s();!(r=n.n()).done;){var o=r.value;this.graph.markNodeAsSpecialRecentlyChanged(o)}}catch(e){n.e(e)}finally{n.f()}this.addStructuralNodesToChangeSet()}},{key:"ensureNoMatrixInRange",value:function(e){if(this.matrixMapping.isFormulaMatrixInRange(e))throw Error("It is not possible to move / replace cells with matrix")}},{key:"moveCells",value:function(e,t,r,n){var o,a=R(e.addressesWithDirection(t,r,this));try{for(a.s();!(o=a.n()).done;){var i=o.value,s=(0,u.simpleCellAddress)(n,i.col+t,i.row+r),c=this.addressMapping.getCell(i),l=this.addressMapping.getCell(s);if(this.addressMapping.removeCell(i),null!==c){this.graph.markNodeAsSpecialRecentlyChanged(c),this.addressMapping.setCell(s,c);var f,p=null,d=R(this.graph.adjacentNodes(c));try{for(d.s();!(f=d.n()).done;){var m=f.value;m instanceof h.RangeVertex&&!e.containsRange(m.range)&&(p=p||this.fetchCellOrCreateEmpty(i),this.graph.addEdge(p,m),this.graph.removeEdge(c,m))}}catch(e){d.e(e)}finally{d.f()}p&&(this.graph.markNodeAsSpecialRecentlyChanged(p),this.addressMapping.setCell(i,p))}if(null!==l){null===c&&this.addressMapping.removeCell(s);var y,g=R(this.graph.adjacentNodes(l));try{for(g.s();!(y=g.n()).done;){var v=y.value;c=null!=c?c:this.fetchCellOrCreateEmpty(s),this.graph.addEdge(c,v),this.graph.markNodeAsSpecialRecentlyChanged(c)}}catch(e){g.e(e)}finally{g.f()}this.removeVertex(l)}}}catch(e){a.e(e)}finally{a.f()}var E,T=R(this.rangeMapping.rangeVerticesContainedInRange(e));try{for(T.s();!(E=T.n()).done;){var b,A=E.value,S=R(this.graph.adjacentNodes(A));try{for(S.s();!(b=S.n()).done;){var N=b.value;if(N instanceof h.RangeVertex&&!e.containsRange(N.range)){this.graph.removeEdge(A,N);var O,C=R(A.range.addresses(this));try{for(C.s();!(O=C.n()).done;){var w=O.value,M=this.fetchCellOrCreateEmpty(w);this.graph.addEdge(M,N),this.addressMapping.setCell(w,M),this.graph.markNodeAsSpecialRecentlyChanged(M)}}catch(e){C.e(e)}finally{C.f()}}}}catch(e){S.e(e)}finally{S.f()}}}catch(e){T.e(e)}finally{T.f()}this.rangeMapping.moveRangesInsideSourceRange(e,t,r,n)}},{key:"disableNumericMatrices",value:function(){var e,t=R(this.matrixMapping.numericMatrices());try{for(t.s();!(e=t.n()).done;){var r=A(e.value,2),n=(r[0],r[1]);this.breakNumericMatrix(n)}}catch(e){t.e(e)}finally{t.f()}}},{key:"breakNumericMatricesInRange",value:function(e){var t,r=R(this.matrixMapping.numericMatricesInRange(e));try{for(r.s();!(t=r.n()).done;){var n=A(t.value,2),o=(n[0],n[1]);this.breakNumericMatrix(o)}}catch(e){r.e(e)}finally{r.f()}}},{key:"breakNumericMatrix",value:function(e){var t,r=a.AbsoluteCellRange.spanFrom(e.getAddress(),e.width,e.height),n=this.graph.adjacentNodes(e),o=R(r.addresses(this));try{for(o.s();!(t=o.n()).done;){var i=t.value,u=new h.ValueCellVertex(this.getCellValue(i),this.getRawValue(i));this.addVertex(i,u)}}catch(e){o.e(e)}finally{o.f()}var s,c=R(n.values());try{for(c.s();!(s=c.n()).done;){var l,f=s.value,p=R((0,m.collectAddressesDependentToMatrix)(this.functionRegistry,f,e,this.lazilyTransformingAstService,this));try{for(p.s();!(l=p.n()).done;){var d=l.value,y=this.fetchCell(d);this.graph.addEdge(y,f)}}catch(e){p.e(e)}finally{p.f()}}}catch(e){c.e(e)}finally{c.f()}this.removeVertex(e),this.matrixMapping.removeMatrix(e.getRange())}},{key:"setMatrixEmpty",value:function(e){var t,r=a.AbsoluteCellRange.spanFrom(e.getAddress(),e.width,e.height),n=this.graph.adjacentNodes(e),o=R(r.addresses(this));try{for(o.s();!(t=o.n()).done;){var i=t.value;this.addressMapping.removeCell(i)}}catch(e){o.e(e)}finally{o.f()}var u,s=R(n.values());try{for(s.s();!(u=s.n()).done;){var c,l=u.value,f=(0,m.collectAddressesDependentToMatrix)(this.functionRegistry,l,e,this.lazilyTransformingAstService,this),p=R(f);try{for(p.s();!(c=p.n()).done;){var h=c.value,d=this.fetchCellOrCreateEmpty(h);this.graph.addEdge(d,l)}}catch(e){p.e(e)}finally{p.f()}f.length>0&&this.graph.markNodeAsSpecialRecentlyChanged(l)}}catch(e){s.e(e)}finally{s.f()}this.removeVertex(e),this.matrixMapping.removeMatrix(e.getRange())}},{key:"addVertex",value:function(e,t){this.graph.addNode(t),this.setVertexAddress(e,t)}},{key:"addMatrixVertex",value:function(e,t){this.graph.addNode(t),this.setAddressMappingForMatrixVertex(t,e)}},{key:"addNewMatrixVertex",value:function(e){var t,r=a.AbsoluteCellRange.spanFrom(e.getAddress(),e.width,e.height),n=R(this.verticesFromRange(r));try{for(n.s();!(t=n.n()).done;)if(t.value instanceof h.MatrixVertex)throw Error("You cannot modify only part of an array")}catch(e){n.e(e)}finally{n.f()}this.setMatrix(r,e);var o,i=R(this.entriesFromRange(r));try{for(i.s();!(o=i.n()).done;){var u=A(o.value,2),s=u[0],c=u[1];c&&this.exchangeGraphNode(c,e),this.setVertexAddress(s,e)}}catch(e){i.e(e)}finally{i.f()}}},{key:"matrixFormulaNodes",value:regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=R(this.graph.nodes),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=10;break}if(!((n=r.value)instanceof h.MatrixVertex&&n.isFormula())){e.next=8;break}return e.next=8,n;case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.addressMapping.entriesFromRowsSpan(t),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.addressMapping.entriesFromColumnsSpan(t),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"existsVertex",value:function(e){return this.addressMapping.has(e)}},{key:"fetchCell",value:function(e){return this.addressMapping.fetchCell(e)}},{key:"getCell",value:function(e){return this.addressMapping.getCell(e)}},{key:"getCellValue",value:function(e){return this.addressMapping.getCellValue(e)}},{key:"getRawValue",value:function(e){return this.addressMapping.getRawValue(e)}},{key:"getScalarValue",value:function(e){var t=this.addressMapping.getCellValue(e);return t instanceof c.SimpleRangeValue?new u.CellError(u.ErrorType.VALUE,s.ErrorMessage.ScalarExpected):t}},{key:"setVertexAddress",value:function(e,t){this.addressMapping.setCell(e,t)}},{key:"existsEdge",value:function(e,t){return this.graph.existsEdge(e,t)}},{key:"getSheetId",value:function(e){return this.sheetMapping.fetch(e)}},{key:"getSheetName",value:function(e){return this.sheetMapping.fetchDisplayName(e)}},{key:"getSheetHeight",value:function(e){return this.addressMapping.getHeight(e)}},{key:"getSheetWidth",value:function(e){return this.addressMapping.getWidth(e)}},{key:"getMatrix",value:function(e){return this.matrixMapping.getMatrix(e)}},{key:"setMatrix",value:function(e,t){this.matrixMapping.setMatrix(e,t)}},{key:"getRange",value:function(e,t){return this.rangeMapping.getRange(e,t)}},{key:"topSortWithScc",value:function(){return this.graph.topSortWithScc()}},{key:"markAsVolatile",value:function(e){this.graph.markNodeAsSpecial(e)}},{key:"markAsDependentOnStructureChange",value:function(e){this.graph.markNodeAsChangingWithStructure(e)}},{key:"forceApplyPostponedTransformations",value:function(){var e,t=R(this.graph.nodes.values());try{for(t.s();!(e=t.n()).done;){var r=e.value;r instanceof h.FormulaCellVertex&&r.ensureRecentData(this.lazilyTransformingAstService)}}catch(e){t.e(e)}finally{t.f()}}},{key:"volatileVertices",value:function(){return this.graph.specialNodes}},{key:"destroy",value:function(){this.graph.destroy(),this.addressMapping.destroy(),this.rangeMapping.destroy(),this.sheetMapping.destroy(),this.matrixMapping.destroy()}},{key:"verticesFromRange",value:regeneratorRuntime.mark((function e(t){var r,n,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=R(t.addresses(this)),e.prev=1,r.s();case 3:if((n=r.n()).done){e.next=11;break}if(o=n.value,!(a=this.getCell(o))){e.next=9;break}return e.next=9,a;case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),r.e(e.t0);case 16:return e.prev=16,r.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[1,13,16,19]])}))},{key:"rawValuesFromRange",value:regeneratorRuntime.mark((function e(t){var r,n,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=R(t.addresses(this)),e.prev=1,r.s();case 3:if((n=r.n()).done){e.next=11;break}if(o=n.value,(a=this.getScalarValue(o))===T.EmptyValue){e.next=9;break}return e.next=9,[(0,T.getRawValue)(a),o];case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),r.e(e.t0);case 16:return e.prev=16,r.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[1,13,16,19]])}))},{key:"entriesFromRange",value:regeneratorRuntime.mark((function e(t){var r,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=R(t.addresses(this)),e.prev=1,r.s();case 3:if((n=r.n()).done){e.next=9;break}return o=n.value,e.next=7,[o,this.getCell(o)];case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),r.e(e.t0);case 14:return e.prev=14,r.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:"exchangeGraphNode",value:function(e,t){var r=this;this.graph.addNode(t);var n=this.graph.adjacentNodes(e);this.removeVertex(e),n.forEach((function(e){r.graph.hasNode(e)&&r.graph.addEdge(t,e)}))}},{key:"exchangeOrAddGraphNode",value:function(e,t){e?this.exchangeGraphNode(e,t):this.graph.addNode(t)}},{key:"computeListOfValuesInRange",value:function(e){var t,r=[],n=R(e.addresses(this));try{for(n.s();!(t=n.n()).done;){var o=t.value,a=this.getScalarValue(o);r.push(a)}}catch(e){n.e(e)}finally{n.f()}return r}},{key:"addStructuralNodesToChangeSet",value:function(){var e,t=R(this.graph.specialNodesStructuralChanges);try{for(t.s();!(e=t.n()).done;){var r=e.value;this.graph.markNodeAsSpecialRecentlyChanged(r)}}catch(e){t.e(e)}finally{t.f()}}},{key:"fixRangesWhenAddingRows",value:function(e,t,r){for(var n=0,o=Array.from(this.rangeMapping.rangesInSheet(e));n<o.length;n++){var i=o[n];if(i.range.includesRow(t+r))if(i.bruteForce){var s,c=R(i.range.rangeWithSameWidth(t,r).addresses(this));try{for(c.s();!(s=c.n()).done;){var l=s.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(l),i)}}catch(e){c.e(e)}finally{c.f()}}else{var f=i,p=this.rangeMapping.findSmallerRange(f.range);if(null!==p.smallerRangeVertex)continue;for(;null===p.smallerRangeVertex;){var d=new h.RangeVertex(a.AbsoluteCellRange.spanFrom(f.range.start,f.range.width(),f.range.height()-1));this.rangeMapping.setRange(d),this.graph.addNode(d);var m=new a.AbsoluteCellRange((0,u.simpleCellAddress)(f.range.start.sheet,f.range.start.col,f.range.end.row),f.range.end);this.addAllFromRange(m,f),this.graph.addEdge(d,f),f=d,p=this.rangeMapping.findSmallerRange(f.range)}this.graph.addEdge(p.smallerRangeVertex,f),this.addAllFromRange(p.restRange,f),this.graph.removeEdge(p.smallerRangeVertex,i)}}}},{key:"addAllFromRange",value:function(e,t){var r,n=R(e.addresses(this));try{for(n.s();!(r=n.n()).done;){var o=r.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(o),t)}}catch(e){n.e(e)}finally{n.f()}}},{key:"fixRangesWhenAddingColumns",value:function(e,t,r){var n,o=R(this.rangeMapping.rangesInSheet(e));try{for(o.s();!(n=o.n()).done;){var i=n.value;if(i.range.includesColumn(t+r)){var s,c=R((i.bruteForce?i.range.rangeWithSameHeight(t,r):a.AbsoluteCellRange.spanFrom((0,u.simpleCellAddress)(e,t,i.range.end.row),r,1)).addresses(this));try{for(c.s();!(s=c.n()).done;){var l=s.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(l),i)}}catch(e){c.e(e)}finally{c.f()}}}}catch(e){o.e(e)}finally{o.f()}}},{key:"setAddressMappingForMatrixVertex",value:function(e,t){if(this.setVertexAddress(t,e),e instanceof h.MatrixVertex){var r=a.AbsoluteCellRange.spanFrom(t,e.width,e.height);this.setMatrix(r,e);var n,o=R(r.addresses(this));try{for(o.s();!(n=o.n()).done;){var i=n.value;this.setVertexAddress(i,e)}}catch(e){o.e(e)}finally{o.f()}}}},{key:"truncateMatricesAfterRemovingRows",value:function(e){var t=this;this.matrixMapping.truncateMatricesByRows(e).forEach((function(e){t.removeVertex(e)}))}},{key:"truncateRanges",value:function(e,t){var r,n=this.rangeMapping.truncateRanges(e,t),o=n.verticesToRemove,a=R(n.verticesToMerge);try{for(a.s();!(r=a.n()).done;){var i=A(r.value,2),u=i[0],s=i[1];this.mergeRangeVertices(u,s)}}catch(e){a.e(e)}finally{a.f()}var c,l=R(o);try{for(l.s();!(c=l.n()).done;){var f=c.value;this.removeVertexAndCleanupDependencies(f)}}catch(e){l.e(e)}finally{l.f()}}},{key:"truncateMatricesAfterRemovingColumns",value:function(e){var t=this;this.matrixMapping.truncateMatricesByColumns(e).forEach((function(e){t.removeVertex(e)}))}},{key:"expandMatricesAfterAddingRows",value:function(e,t,r){var n,o=R(this.matrixMapping.numericMatricesInRows(f.RowsSpan.fromRowStartAndEnd(e,t,t)));try{for(o.s();!(n=o.n()).done;){var i=A(n.value,2)[1];i.addRows(e,t,r);var s,c=R(a.AbsoluteCellRange.spanFrom((0,u.simpleCellAddress)(e,i.getAddress().col,t),i.width,r).addresses(this));try{for(c.s();!(s=c.n()).done;){var l=s.value;this.addressMapping.setCell(l,i)}}catch(e){c.e(e)}finally{c.f()}}}catch(e){o.e(e)}finally{o.f()}}},{key:"expandMatricesAfterAddingColumns",value:function(e,t,r){var n,o=R(this.matrixMapping.numericMatricesInColumns(f.ColumnsSpan.fromColumnStartAndEnd(e,t,t)));try{for(o.s();!(n=o.n()).done;){var i=A(n.value,2)[1];i.addColumns(e,t,r);var s,c=R(a.AbsoluteCellRange.spanFrom((0,u.simpleCellAddress)(e,t,i.getAddress().row),r,i.height).addresses(this));try{for(c.s();!(s=c.n()).done;){var l=s.value;this.addressMapping.setCell(l,i)}}catch(e){c.e(e)}finally{c.f()}}}catch(e){o.e(e)}finally{o.f()}}},{key:"removeVertex",value:function(e){this.removeVertexAndCleanupDependencies(e),e instanceof h.RangeVertex&&this.rangeMapping.removeRange(e)}},{key:"mergeRangeVertices",value:function(e,t){var r=this,n=this.graph.adjacentNodes(t);this.removeVertexAndCleanupDependencies(t),this.graph.softRemoveEdge(e,t),n.forEach((function(t){r.graph.hasNode(t)&&r.graph.addEdge(e,t)}))}},{key:"removeVertexAndCleanupDependencies",value:function(e){for(var t=new Set(this.graph.removeNode(e));t.size>0;){var r=t.values().next().value;t.delete(r),this.graph.hasNode(r)&&0===this.graph.adjacentNodesCount(r)&&((r instanceof h.RangeVertex||r instanceof h.EmptyCellVertex)&&this.graph.removeNode(r).forEach((function(e){return t.add(e)})),r instanceof h.RangeVertex?this.rangeMapping.removeRange(r):r instanceof h.EmptyCellVertex&&this.addressMapping.removeCell(r.address))}}},{key:"getAdjacentNodesAddresses",value:function(e){var t=this,r=this.graph.adjacentNodes(e),n=[];return r.forEach((function(e){var r=e;r instanceof h.RangeVertex?n.push(new a.AbsoluteCellRange(r.start,r.end)):r instanceof h.FormulaCellVertex?n.push(r.getAddress(t.lazilyTransformingAstService)):n.push(r.getAddress())})),n}}])&&O(t.prototype,r),n&&O(t,n),e}();t.DependencyGraph=C},function(e,t,r){var n=function(e){"use strict";var t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",u=n.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var o=t&&t.prototype instanceof p?t:p,a=Object.create(o.prototype),i=new S(n||[]);return a._invoke=function(e,t,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return{value:void 0,done:!0}}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var u=b(i,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var s=l(e,t,r);if("normal"===s.type){if(n=r.done?"completed":"suspendedYield",s.arg===f)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n="completed",r.method="throw",r.arg=s.arg)}}}(e,r,i),a}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var f={};function p(){}function h(){}function d(){}var m={};m[o]=function(){return this};var y=Object.getPrototypeOf,g=y&&y(y(N([])));g&&g!==t&&r.call(g,o)&&(m=g);var v=d.prototype=p.prototype=Object.create(m);function E(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,t){var n;this._invoke=function(o,a){function u(){return new t((function(n,u){!function n(o,a,u,s){var c=l(e[o],e,a);if("throw"!==c.type){var f=c.arg,p=f.value;return p&&"object"===i(p)&&r.call(p,"__await")?t.resolve(p.__await).then((function(e){n("next",e,u,s)}),(function(e){n("throw",e,u,s)})):t.resolve(p).then((function(e){f.value=e,u(f)}),(function(e){return n("throw",e,u,s)}))}s(c.arg)}(o,a,n,u)}))}return n=n?n.then(u,u):u()}}function b(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return f;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var n=l(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,f;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function R(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(R,this),this.reset(!0)}function N(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:O}}function O(){return{value:void 0,done:!0}}return h.prototype=v.constructor=d,d.constructor=h,h.displayName=s(d,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,s(e,u,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},E(T.prototype),T.prototype[a]=function(){return this},e.AsyncIterator=T,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new T(c(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(v),s(v,u,"Generator"),v[o]=function(){return this},v.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=N,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return i.type="throw",i.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),s=r.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,f):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),A(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:N(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},e}(e.exports);try{regeneratorRuntime=n}catch(e){Function("r","regeneratorRuntime = r")(n)}},function(e,t,r){"use strict";var n=r(2),o=r(91).map;n({target:"Array",proto:!0,forced:!r(62)("map")},{map:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,r){"use strict";var n=r(103),o=r(123);e.exports=n("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),o)},function(e,t,r){"use strict";var n=r(21).f,o=r(48),a=r(100),i=r(70),u=r(105),s=r(104),c=r(79),l=r(124),f=r(6),p=r(101).fastKey,h=r(27),d=h.set,m=h.getterFor;e.exports={getConstructor:function(e,t,r,c){var l=e((function(e,n){u(e,l,t),d(e,{type:t,index:o(null),first:void 0,last:void 0,size:0}),f||(e.size=0),null!=n&&s(n,e[c],{that:e,AS_ENTRIES:r})})),h=m(t),y=function(e,t,r){var n,o,a=h(e),i=g(e,t);return i?i.value=r:(a.last=i={index:o=p(t,!0),key:t,value:r,previous:n=a.last,next:void 0,removed:!1},a.first||(a.first=i),n&&(n.next=i),f?a.size++:e.size++,"F"!==o&&(a.index[o]=i)),e},g=function(e,t){var r,n=h(e),o=p(t);if("F"!==o)return n.index[o];for(r=n.first;r;r=r.next)if(r.key==t)return r};return a(l.prototype,{clear:function(){for(var e=h(this),t=e.index,r=e.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete t[r.index],r=r.next;e.first=e.last=void 0,f?e.size=0:this.size=0},delete:function(e){var t=h(this),r=g(this,e);if(r){var n=r.next,o=r.previous;delete t.index[r.index],r.removed=!0,o&&(o.next=n),n&&(n.previous=o),t.first==r&&(t.first=n),t.last==r&&(t.last=o),f?t.size--:this.size--}return!!r},forEach:function(e){for(var t,r=h(this),n=i(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.next:r.first;)for(n(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!g(this,e)}}),a(l.prototype,r?{get:function(e){var t=g(this,e);return t&&t.value},set:function(e,t){return y(this,0===e?0:e,t)}}:{add:function(e){return y(this,e=0===e?0:e,e)}}),f&&n(l.prototype,"size",{get:function(){return h(this).size}}),l},setStrong:function(e,t,r){var n=t+" Iterator",o=m(t),a=m(n);c(e,t,(function(e,t){d(this,{type:n,target:e,state:o(e),kind:t,last:void 0})}),(function(){for(var e=a(this),t=e.kind,r=e.last;r&&r.removed;)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?"keys"==t?{value:r.key,done:!1}:"values"==t?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),r?"entries":"values",!r,!0),l(t)}}},function(e,t,r){"use strict";var n=r(36),o=r(21),a=r(56),i=r(6),u=a("species");e.exports=function(e){var t=n(e),r=o.f;i&&t&&!t[u]&&r(t,u,{configurable:!0,get:function(){return this}})}},function(e,t,r){"use strict";var n=r(2),o=r(7),a=r(54),i=r(15),u=r(17),s=r(41),c=r(55),l=r(92),f=r(62),p=r(56),h=r(59),d=p("isConcatSpreadable"),m=h>=51||!o((function(){var e=[];return e[d]=!1,e.concat()[0]!==e})),y=f("concat"),g=function(e){if(!i(e))return!1;var t=e[d];return void 0!==t?!!t:a(e)};n({target:"Array",proto:!0,forced:!m||!y},{concat:function(e){var t,r,n,o,a,i=u(this),f=l(i,0),p=0;for(t=-1,n=arguments.length;t<n;t++)if(g(a=-1===t?i:arguments[t])){if(p+(o=s(a.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(r=0;r<o;r++,p++)r in a&&c(f,p,a[r])}else{if(p>=9007199254740991)throw TypeError("Maximum allowed index exceeded");c(f,p++,a)}return f.length=p,f}})},function(e,t,r){var n=r(3),o=r(98),a=r(127),i=r(20);for(var u in o){var s=n[u],c=s&&s.prototype;if(c&&c.forEach!==a)try{i(c,"forEach",a)}catch(e){c.forEach=a}}},function(e,t,r){"use strict";var n=r(91).forEach,o=r(128)("forEach");e.exports=o?[].forEach:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}},function(e,t,r){"use strict";var n=r(7);e.exports=function(e,t){var r=[][e];return!!r&&n((function(){r.call(null,t||function(){throw 1},1)}))}},function(e,t,r){"use strict";(function(t){var n=r(130);
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function o(e,t){if(e===t)return 0;for(var r=e.length,n=t.length,o=0,a=Math.min(r,n);o<a;++o)if(e[o]!==t[o]){r=e[o],n=t[o];break}return r<n?-1:n<r?1:0}function a(e){return t.Buffer&&"function"==typeof t.Buffer.isBuffer?t.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}var u=r(131),s=Object.prototype.hasOwnProperty,c=Array.prototype.slice,l="foo"===function(){}.name;function f(e){return Object.prototype.toString.call(e)}function p(e){return!a(e)&&"function"==typeof t.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer)))}var h=e.exports=E,d=/\s*function\s+([^\(\s]*)\s*/;function m(e){if(u.isFunction(e)){if(l)return e.name;var t=e.toString().match(d);return t&&t[1]}}function y(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function g(e){if(l||!u.isFunction(e))return u.inspect(e);var t=m(e);return"[Function"+(t?": "+t:"")+"]"}function v(e,t,r,n,o){throw new h.AssertionError({message:r,actual:e,expected:t,operator:n,stackStartFunction:o})}function E(e,t){e||v(e,!0,t,"==",h.ok)}function T(e,t,r,n){if(e===t)return!0;if(a(e)&&a(t))return 0===o(e,t);if(u.isDate(e)&&u.isDate(t))return e.getTime()===t.getTime();if(u.isRegExp(e)&&u.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"===i(e)||null!==t&&"object"===i(t)){if(p(e)&&p(t)&&f(e)===f(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===o(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(a(e)!==a(t))return!1;var s=(n=n||{actual:[],expected:[]}).actual.indexOf(e);return-1!==s&&s===n.expected.indexOf(t)||(n.actual.push(e),n.expected.push(t),function(e,t,r,n){if(null==e||null==t)return!1;if(u.isPrimitive(e)||u.isPrimitive(t))return e===t;if(r&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var o=b(e),a=b(t);if(o&&!a||!o&&a)return!1;if(o)return e=c.call(e),t=c.call(t),T(e,t,r);var i,s,l=S(e),f=S(t);if(l.length!==f.length)return!1;for(l.sort(),f.sort(),s=l.length-1;s>=0;s--)if(l[s]!==f[s])return!1;for(s=l.length-1;s>=0;s--)if(i=l[s],!T(e[i],t[i],r,n))return!1;return!0}(e,t,r,n))}return r?e===t:e==t}function b(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function R(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(e){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function A(e,t,r,n){var o;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof r&&(n=r,r=null),o=function(e){var t;try{e()}catch(e){t=e}return t}(t),n=(r&&r.name?" ("+r.name+").":".")+(n?" "+n:"."),e&&!o&&v(o,r,"Missing expected exception"+n);var a="string"==typeof n,i=!e&&o&&!r;if((!e&&u.isError(o)&&a&&R(o,r)||i)&&v(o,r,"Got unwanted exception"+n),e&&o&&r&&!R(o,r)||!e&&o)throw o}h.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=function(e){return y(g(e.actual),128)+" "+e.operator+" "+y(g(e.expected),128)}(this),this.generatedMessage=!0);var t=e.stackStartFunction||v;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var r=new Error;if(r.stack){var n=r.stack,o=m(t),a=n.indexOf("\n"+o);if(a>=0){var i=n.indexOf("\n",a+1);n=n.substring(i+1)}this.stack=n}}},u.inherits(h.AssertionError,Error),h.fail=v,h.ok=E,h.equal=function(e,t,r){e!=t&&v(e,t,r,"==",h.equal)},h.notEqual=function(e,t,r){e==t&&v(e,t,r,"!=",h.notEqual)},h.deepEqual=function(e,t,r){T(e,t,!1)||v(e,t,r,"deepEqual",h.deepEqual)},h.deepStrictEqual=function(e,t,r){T(e,t,!0)||v(e,t,r,"deepStrictEqual",h.deepStrictEqual)},h.notDeepEqual=function(e,t,r){T(e,t,!1)&&v(e,t,r,"notDeepEqual",h.notDeepEqual)},h.notDeepStrictEqual=function e(t,r,n){T(t,r,!0)&&v(t,r,n,"notDeepStrictEqual",e)},h.strictEqual=function(e,t,r){e!==t&&v(e,t,r,"===",h.strictEqual)},h.notStrictEqual=function(e,t,r){e===t&&v(e,t,r,"!==",h.notStrictEqual)},h.throws=function(e,t,r){A(!0,e,t,r)},h.doesNotThrow=function(e,t,r){A(!1,e,t,r)},h.ifError=function(e){if(e)throw e},h.strict=n((function e(t,r){t||v(t,!0,r,"==",e)}),h,{equal:h.strictEqual,deepEqual:h.deepStrictEqual,notEqual:h.notStrictEqual,notDeepEqual:h.notDeepStrictEqual}),h.strict.strict=h.strict;var S=Object.keys||function(e){var t=[];for(var r in e)s.call(e,r)&&t.push(r);return t}}).call(this,r(4))},function(e,t,r){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var n=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function i(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var r,u,s=i(e),c=1;c<arguments.length;c++){for(var l in r=Object(arguments[c]))o.call(r,l)&&(s[l]=r[l]);if(n){u=n(r);for(var f=0;f<u.length;f++)a.call(r,u[f])&&(s[u[f]]=r[u[f]])}}return s}},function(e,t,r){(function(e){var n=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},o=/%[sdj%]/g;t.format=function(e){if(!v(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(s(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,a=n.length,i=String(e).replace(o,(function(e){if("%%"===e)return"%";if(r>=a)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}})),u=n[r];r<a;u=n[++r])y(u)||!b(u)?i+=" "+u:i+=" "+s(u);return i},t.deprecate=function(r,n){if(void 0!==e&&!0===e.noDeprecation)return r;if(void 0===e)return function(){return t.deprecate(r,n).apply(this,arguments)};var o=!1;return function(){if(!o){if(e.throwDeprecation)throw new Error(n);e.traceDeprecation?console.trace(n):console.error(n),o=!0}return r.apply(this,arguments)}};var a,u={};function s(e,r){var n={seen:[],stylize:l};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),m(r)?n.showHidden=r:r&&t._extend(n,r),E(n.showHidden)&&(n.showHidden=!1),E(n.depth)&&(n.depth=2),E(n.colors)&&(n.colors=!1),E(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=c),f(n,e,n.depth)}function c(e,t){var r=s.styles[t];return r?"["+s.colors[r][0]+"m"+e+"["+s.colors[r][1]+"m":e}function l(e,t){return e}function f(e,r,n){if(e.customInspect&&r&&S(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var o=r.inspect(n,e);return v(o)||(o=f(e,o,n)),o}var a=function(e,t){if(E(t))return e.stylize("undefined","undefined");if(v(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return g(t)?e.stylize(""+t,"number"):m(t)?e.stylize(""+t,"boolean"):y(t)?e.stylize("null","null"):void 0}(e,r);if(a)return a;var i=Object.keys(r),u=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(i);if(e.showHidden&&(i=Object.getOwnPropertyNames(r)),A(r)&&(i.indexOf("message")>=0||i.indexOf("description")>=0))return p(r);if(0===i.length){if(S(r)){var s=r.name?": "+r.name:"";return e.stylize("[Function"+s+"]","special")}if(T(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(R(r))return e.stylize(Date.prototype.toString.call(r),"date");if(A(r))return p(r)}var c,l="",b=!1,N=["{","}"];return d(r)&&(b=!0,N=["[","]"]),S(r)&&(l=" [Function"+(r.name?": "+r.name:"")+"]"),T(r)&&(l=" "+RegExp.prototype.toString.call(r)),R(r)&&(l=" "+Date.prototype.toUTCString.call(r)),A(r)&&(l=" "+p(r)),0!==i.length||b&&0!=r.length?n<0?T(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),c=b?function(e,t,r,n,o){for(var a=[],i=0,u=t.length;i<u;++i)M(t,String(i))?a.push(h(e,t,r,n,String(i),!0)):a.push("");return o.forEach((function(o){o.match(/^\d+$/)||a.push(h(e,t,r,n,o,!0))})),a}(e,r,n,u,i):i.map((function(t){return h(e,r,n,u,t,b)})),e.seen.pop(),function(e,t,r){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]:r[0]+t+" "+e.join(", ")+" "+r[1]}(c,l,N)):N[0]+l+N[1]}function p(e){return"["+Error.prototype.toString.call(e)+"]"}function h(e,t,r,n,o,a){var i,u,s;if((s=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?u=s.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):s.set&&(u=e.stylize("[Setter]","special")),M(n,o)||(i="["+o+"]"),u||(e.seen.indexOf(s.value)<0?(u=y(r)?f(e,s.value,null):f(e,s.value,r-1)).indexOf("\n")>-1&&(u=a?u.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+u.split("\n").map((function(e){return"   "+e})).join("\n")):u=e.stylize("[Circular]","special")),E(i)){if(a&&o.match(/^\d+$/))return u;(i=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(i=i.substr(1,i.length-2),i=e.stylize(i,"name")):(i=i.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),i=e.stylize(i,"string"))}return i+": "+u}function d(e){return Array.isArray(e)}function m(e){return"boolean"==typeof e}function y(e){return null===e}function g(e){return"number"==typeof e}function v(e){return"string"==typeof e}function E(e){return void 0===e}function T(e){return b(e)&&"[object RegExp]"===N(e)}function b(e){return"object"===i(e)&&null!==e}function R(e){return b(e)&&"[object Date]"===N(e)}function A(e){return b(e)&&("[object Error]"===N(e)||e instanceof Error)}function S(e){return"function"==typeof e}function N(e){return Object.prototype.toString.call(e)}function O(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(r){if(E(a)&&(a=e.env.NODE_DEBUG||""),r=r.toUpperCase(),!u[r])if(new RegExp("\\b"+r+"\\b","i").test(a)){var n=e.pid;u[r]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",r,n,e)}}else u[r]=function(){};return u[r]},t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=d,t.isBoolean=m,t.isNull=y,t.isNullOrUndefined=function(e){return null==e},t.isNumber=g,t.isString=v,t.isSymbol=function(e){return"symbol"===i(e)},t.isUndefined=E,t.isRegExp=T,t.isObject=b,t.isDate=R,t.isError=A,t.isFunction=S,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"===i(e)||void 0===e},t.isBuffer=r(133);var C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function w(){var e=new Date,t=[O(e.getHours()),O(e.getMinutes()),O(e.getSeconds())].join(":");return[e.getDate(),C[e.getMonth()],t].join(" ")}function M(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",w(),t.format.apply(t,arguments))},t.inherits=r(134),t._extend=function(e,t){if(!t||!b(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};var I="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function x(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(I&&e[I]){var t;if("function"!=typeof(t=e[I]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,I,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,r,n=new Promise((function(e,n){t=e,r=n})),o=[],a=0;a<arguments.length;a++)o.push(arguments[a]);o.push((function(e,n){e?r(e):t(n)}));try{e.apply(this,o)}catch(e){r(e)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),I&&Object.defineProperty(t,I,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,n(e))},t.promisify.custom=I,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function r(){for(var r=[],n=0;n<arguments.length;n++)r.push(arguments[n]);var o=r.pop();if("function"!=typeof o)throw new TypeError("The last argument must be of type Function");var a=this,i=function(){return o.apply(a,arguments)};t.apply(this,r).then((function(t){e.nextTick(i,null,t)}),(function(t){e.nextTick(x,t,i)}))}return Object.setPrototypeOf(r,Object.getPrototypeOf(t)),Object.defineProperties(r,n(t)),r}}).call(this,r(132))},function(e,t){var r,n,o=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function u(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{n="function"==typeof clearTimeout?clearTimeout:i}catch(e){n=i}}();var s,c=[],l=!1,f=-1;function p(){l&&s&&(l=!1,s.length?c=s.concat(c):f=-1,c.length&&h())}function h(){if(!l){var e=u(p);l=!0;for(var t=c.length;t;){for(s=c,c=[];++f<t;)s&&s[f].run();f=-1,t=c.length}s=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new d(e,t)),1!==c.length||l||u(h)},d.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t){e.exports=function(e){return e&&"object"===i(e)&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(109),r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.AbsoluteRowRange=t.AbsoluteColumnRange=t.AbsoluteCellRange=t.WRONG_RANGE_SIZE=t.DIFFERENT_SHEETS_ERROR=void 0,r(120),r(136),r(138),r(125);var o=r(115),a=r(141),i=r(219);function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return l(this,r)}}function l(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t,r){return t&&h(e.prototype,t),r&&h(e,r),e}var m="AbsoluteCellRange: Start and end are in different sheets";t.DIFFERENT_SHEETS_ERROR=m,t.WRONG_RANGE_SIZE="AbsoluteCellRange: Wrong range size";var y=function(){function e(t,r){if(p(this,e),t.sheet!==r.sheet)throw new Error(m);this.start=(0,o.simpleCellAddress)(t.sheet,t.col,t.row),this.end=(0,o.simpleCellAddress)(r.sheet,r.col,r.row)}return d(e,[{key:"sheet",get:function(){return this.start.sheet}},{key:"isFinite",value:function(){return Number.isFinite(this.size())}},{key:"doesOverlap",value:function(e){return!(this.start.sheet!=e.start.sheet||this.end.row<e.start.row||this.start.row>e.end.row||this.end.col<e.start.col||this.start.col>e.end.col)}},{key:"addressInRange",value:function(e){return this.sheet===e.sheet&&this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col}},{key:"columnInRange",value:function(e){return this.sheet===e.sheet&&this.start.col<=e.col&&this.end.col>=e.col}},{key:"rowInRange",value:function(e){return this.sheet===e.sheet&&this.start.row<=e.row&&this.end.row>=e.row}},{key:"containsRange",value:function(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}},{key:"intersectionWith",value:function(t){if(this.sheet!==t.start.sheet)return null;var r=Math.max(this.start.row,t.start.row),n=Math.min(this.end.row,t.end.row),a=Math.max(this.start.col,t.start.col),i=Math.min(this.end.col,t.end.col);return r>n||a>i?null:new e((0,o.simpleCellAddress)(this.sheet,a,r),(0,o.simpleCellAddress)(this.sheet,i,n))}},{key:"includesRow",value:function(e){return this.start.row<e&&this.end.row>=e}},{key:"includesColumn",value:function(e){return this.start.col<e&&this.end.col>=e}},{key:"shiftByRows",value:function(e){this.start.row+=e,this.end.row+=e}},{key:"expandByRows",value:function(e){this.end.row+=e}},{key:"shiftByColumns",value:function(e){this.start.col+=e,this.end.col+=e}},{key:"shifted",value:function(t,r){return e.spanFrom((0,o.simpleCellAddress)(this.sheet,this.start.col+t,this.start.row+r),this.width(),this.height())}},{key:"expandByColumns",value:function(e){this.end.col+=e}},{key:"moveToSheet",value:function(e){this.start.sheet=e,this.end.sheet=e}},{key:"removeSpan",value:function(e){e instanceof i.RowsSpan?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}},{key:"removeRows",value:function(e,t){if(!(e>this.end.row)){if(t<this.start.row){var r=t-e+1;return this.shiftByRows(-r)}e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(t,this.end.row)-e+1}}},{key:"removeColumns",value:function(e,t){if(!(e>this.end.col)){if(t<this.start.col){var r=t-e+1;return this.shiftByColumns(-r)}e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(t,this.end.col)-e+1}}},{key:"shouldBeRemoved",value:function(){return this.width()<=0||this.height()<=0}},{key:"rangeWithSameWidth",value:function(t,r){return e.spanFrom((0,o.simpleCellAddress)(this.sheet,this.start.col,t),this.width(),r)}},{key:"rangeWithSameHeight",value:function(t,r){return e.spanFrom((0,o.simpleCellAddress)(this.sheet,t,this.start.row),r,this.height())}},{key:"toString",value:function(){return"".concat(this.start.sheet,",").concat(this.start.col,",").concat(this.start.row,",").concat(this.end.col,",").concat(this.end.row)}},{key:"width",value:function(){return this.end.col-this.start.col+1}},{key:"height",value:function(){return this.end.row-this.start.row+1}},{key:"size",value:function(){return this.height()*this.width()}},{key:"arrayOfAddressesInRange",value:function(){for(var e=[],t=0;t<this.height();++t){e[t]=[];for(var r=0;r<this.width();++r){var n=(0,o.simpleCellAddress)(this.sheet,this.start.col+r,this.start.row+t);e[t].push(n)}}return e}},{key:"withStart",value:function(t){return new e(t,this.end)}},{key:"sameDimensionsAs",value:function(e){return this.width()===e.width()&&this.height()===e.height()}},{key:"addresses",value:regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.start.row;case 1:if(!(r<=this.effectiveEndRow(t))){e.next=12;break}n=this.start.col;case 3:if(!(n<=this.effectiveEndColumn(t))){e.next=9;break}return e.next=6,(0,o.simpleCellAddress)(this.start.sheet,n,r);case 6:n++,e.next=3;break;case 9:r++,e.next=1;break;case 12:case"end":return e.stop()}}),e,this)}))},{key:"addressesWithDirection",value:regeneratorRuntime.mark((function e(t,r,n){var a,i,u,s,c,l,f,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t>0)){e.next=30;break}if(!(r>0)){e.next=16;break}a=this.effectiveEndRow(n);case 3:if(!(a>=this.start.row)){e.next=14;break}i=this.effectiveEndColumn(n);case 5:if(!(i>=this.start.col)){e.next=11;break}return e.next=8,(0,o.simpleCellAddress)(this.start.sheet,i,a);case 8:i-=1,e.next=5;break;case 11:a-=1,e.next=3;break;case 14:e.next=28;break;case 16:u=this.start.row;case 17:if(!(u<=this.effectiveEndRow(n))){e.next=28;break}s=this.effectiveEndColumn(n);case 19:if(!(s>=this.start.col)){e.next=25;break}return e.next=22,(0,o.simpleCellAddress)(this.start.sheet,s,u);case 22:s-=1,e.next=19;break;case 25:u+=1,e.next=17;break;case 28:e.next=57;break;case 30:if(!(r>0)){e.next=45;break}c=this.effectiveEndRow(n);case 32:if(!(c>=this.start.row)){e.next=43;break}l=this.start.col;case 34:if(!(l<=this.effectiveEndColumn(n))){e.next=40;break}return e.next=37,(0,o.simpleCellAddress)(this.start.sheet,l,c);case 37:l+=1,e.next=34;break;case 40:c-=1,e.next=32;break;case 43:e.next=57;break;case 45:f=this.start.row;case 46:if(!(f<=this.effectiveEndRow(n))){e.next=57;break}p=this.start.col;case 48:if(!(p<=this.effectiveEndColumn(n))){e.next=54;break}return e.next=51,(0,o.simpleCellAddress)(this.start.sheet,p,f);case 51:p+=1,e.next=48;break;case 54:f+=1,e.next=46;break;case 57:case"end":return e.stop()}}),e,this)}))},{key:"getAddress",value:function(e,t){if(e<0||t<0||t>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return(0,o.simpleCellAddress)(this.start.sheet,this.start.col+e,this.start.row+t)}},{key:"exceedsSheetSizeLimits",value:function(e,t){return this.end.col>=e||this.end.row>=t}},{key:"effectiveEndColumn",value:function(e){return this.end.col}},{key:"effectiveEndRow",value:function(e){return this.end.row}}],[{key:"fromAst",value:function(t,r){return t.type===a.AstNodeType.CELL_RANGE?e.fromCellRange(t,r):t.type===a.AstNodeType.COLUMN_RANGE?g.fromColumnRange(t,r):v.fromRowRange(t,r)}},{key:"fromCellRange",value:function(t,r){return new e(new a.CellAddress(t.start.sheet,t.start.col,t.start.row,t.start.type).toSimpleCellAddress(r),new a.CellAddress(t.end.sheet,t.end.col,t.end.row,t.end.type).toSimpleCellAddress(r))}},{key:"spanFrom",value:function(t,r,n){if(!Number.isFinite(r)&&Number.isFinite(n))return new v(t.sheet,t.row,t.row+n-1);if(!Number.isFinite(n)&&Number.isFinite(r))return new g(t.sheet,t.col,t.col+r-1);if(Number.isFinite(n)&&Number.isFinite(r))return new e(t,(0,o.simpleCellAddress)(t.sheet,t.col+r-1,t.row+n-1));throw new Error("AbsoluteCellRange: Wrong range size")}},{key:"fromCoordinates",value:function(t,r,n,a,i){return new e((0,o.simpleCellAddress)(t,r,n),(0,o.simpleCellAddress)(t,a,i))}},{key:"singleRangeFromCellAddress",value:function(t,r){var n=t.toSimpleCellAddress(r);return new e(n,n)}}]),e}();t.AbsoluteCellRange=y;var g=function(e){u(r,e);var t=c(r);function r(e,n,a){return p(this,r),t.call(this,(0,o.simpleCellAddress)(e,n,0),(0,o.simpleCellAddress)(e,a,Number.POSITIVE_INFINITY))}return d(r,[{key:"shouldBeRemoved",value:function(){return this.width()<=0}},{key:"shiftByRows",value:function(e){}},{key:"expandByRows",value:function(e){}},{key:"shifted",value:function(e,t){return new r(this.sheet,this.start.col+e,this.end.col+e)}},{key:"removeRows",value:function(e,t){}},{key:"rangeWithSameHeight",value:function(e,t){return new r(this.sheet,e,e+t-1)}},{key:"exceedsSheetSizeLimits",value:function(e,t){return this.end.col>=e}},{key:"effectiveEndRow",value:function(e){return e.getSheetHeight(this.sheet)-1}}],[{key:"fromColumnRange",value:function(e,t){var n=e.start.toSimpleColumnAddress(t),o=e.end.toSimpleColumnAddress(t);if(n.sheet!==o.sheet)throw new Error(m);return new r(n.sheet,n.col,o.col)}}]),r}(y);t.AbsoluteColumnRange=g;var v=function(e){u(r,e);var t=c(r);function r(e,n,a){return p(this,r),t.call(this,(0,o.simpleCellAddress)(e,0,n),(0,o.simpleCellAddress)(e,Number.POSITIVE_INFINITY,a))}return d(r,[{key:"shouldBeRemoved",value:function(){return this.height()<=0}},{key:"shiftByColumns",value:function(e){}},{key:"expandByColumns",value:function(e){}},{key:"shifted",value:function(e,t){return new r(this.sheet,this.start.row+t,this.end.row+t)}},{key:"removeColumns",value:function(e,t){}},{key:"rangeWithSameWidth",value:function(e,t){return new r(this.sheet,e,e+t-1)}},{key:"exceedsSheetSizeLimits",value:function(e,t){return this.end.row>=t}},{key:"effectiveEndColumn",value:function(e){return e.getSheetWidth(this.sheet)-1}}],[{key:"fromRowRange",value:function(e,t){var n=e.start.toSimpleRowAddress(t),o=e.end.toSimpleRowAddress(t);if(n.sheet!==o.sheet)throw new Error(m);return new r(n.sheet,n.row,o.row)}}]),r}(y);t.AbsoluteRowRange=v},function(e,t,r){r(2)({target:"Number",stat:!0},{isFinite:r(137)})},function(e,t,r){var n=r(3).isFinite;e.exports=Number.isFinite||function(e){return"number"==typeof e&&n(e)}},function(e,t,r){"use strict";var n=r(6),o=r(3),a=r(46),i=r(23),u=r(16),s=r(12),c=r(106),l=r(14),f=r(7),p=r(48),h=r(38).f,d=r(5).f,m=r(21).f,y=r(139).trim,g=o.Number,v=g.prototype,E="Number"==s(p(v)),T=function(e){var t,r,n,o,a,i,u,s,c=l(e,!1);if("string"==typeof c&&c.length>2)if(43===(t=(c=y(c)).charCodeAt(0))||45===t){if(88===(r=c.charCodeAt(2))||120===r)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:n=2,o=49;break;case 79:case 111:n=8,o=55;break;default:return+c}for(i=(a=c.slice(2)).length,u=0;u<i;u++)if((s=a.charCodeAt(u))<48||s>o)return NaN;return parseInt(a,n)}return+c};if(a("Number",!g(" 0o1")||!g("0b1")||g("+0x1"))){for(var b,R=function(e){var t=arguments.length<1?0:e,r=this;return r instanceof R&&(E?f((function(){v.valueOf.call(r)})):"Number"!=s(r))?c(new g(T(t)),r,R):T(t)},A=n?h(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),S=0;A.length>S;S++)u(g,b=A[S])&&!u(R,b)&&m(R,b,d(g,b));R.prototype=v,v.constructor=R,i(o,"Number",R)}},function(e,t,r){var n=r(13),o="["+r(140)+"]",a=RegExp("^"+o+o+"*"),i=RegExp(o+o+"*$"),u=function(e){return function(t){var r=String(n(t));return 1&e&&(r=r.replace(a,"")),2&e&&(r=r.replace(i,"")),r}};e.exports={start:u(1),end:u(2),trim:u(3)}},function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},function(e,t,r){"use strict";t.__esModule=!0,t.NamedExpressionDependency=t.RowRangeDependency=t.ColumnRangeDependency=t.CellRangeDependency=t.AddressDependency=t.Unparser=t.buildCellErrorAst=t.buildParsingErrorAst=t.buildCellRangeAst=t.buildProcedureAst=t.ParsingErrorType=t.AstNodeType=t.FormulaLexer=t.buildLexerConfig=t.collectDependencies=t.ParserWithCaching=t.CellAddress=t.simpleCellAddressToString=t.simpleCellAddressFromString=t.cellAddressFromString=void 0;var n=r(142);t.cellAddressFromString=n.cellAddressFromString,t.simpleCellAddressFromString=n.simpleCellAddressFromString,t.simpleCellAddressToString=n.simpleCellAddressToString;var o=r(158);t.CellAddress=o.CellAddress;var a=r(205);t.ParserWithCaching=a.ParserWithCaching;var i=r(217);t.collectDependencies=i.collectDependencies;var u=r(160);t.buildLexerConfig=u.buildLexerConfig;var s=r(211);t.FormulaLexer=s.FormulaLexer;var c=r(207);t.AstNodeType=c.AstNodeType,t.ParsingErrorType=c.ParsingErrorType,t.buildProcedureAst=c.buildProcedureAst,t.buildCellRangeAst=c.buildCellRangeAst,t.buildParsingErrorAst=c.buildParsingErrorAst,t.buildCellErrorAst=c.buildCellErrorAst;var l=r(216);t.Unparser=l.Unparser;var f=r(218);t.AddressDependency=f.AddressDependency,t.CellRangeDependency=f.CellRangeDependency,t.ColumnRangeDependency=f.ColumnRangeDependency,t.RowRangeDependency=f.RowRangeDependency,t.NamedExpressionDependency=f.NamedExpressionDependency},function(e,t,r){"use strict";t.__esModule=!0,t.columnIndexToLabel=h,t.sheetIndexToString=d,t.simpleCellAddressToString=t.simpleCellAddressFromString=t.rowAddressFromString=t.columnAddressFromString=t.cellAddressFromString=void 0,r(143),r(146),r(148),r(138),r(125),r(149),r(151),r(156);var n=r(115),o=r(158),a=r(159),i=r(160),u=r(204),s=new RegExp("^(".concat(i.sheetNameRegexp,")?(\\$?)([A-Za-z]+)(\\$?)([0-9]+)$")),c=new RegExp("^(".concat(i.sheetNameRegexp,")?(\\$?)([A-Za-z]+)$")),l=new RegExp("^(".concat(i.sheetNameRegexp,")?(\\$?)([0-9]+)$")),f=new RegExp("^".concat(i.simpleSheetName,"$"));function p(e){return 1===e.length?e.toUpperCase().charCodeAt(0)-65:e.split("").reduce((function(e,t){return 26*e+(t.toUpperCase().charCodeAt(0)-64)}),0)-1}function h(e){for(var t="";e>=0;)t=String.fromCharCode(e%26+97)+t,e=Math.floor(e/26)-1;return t.toUpperCase()}function d(e,t){var r=t(e);if(void 0!==r)return f.test(r)?r:(r=r.replace(/'/g,"''"),"'".concat(r,"'"))}function m(e,t){var r,n=null!==(r=e[3])&&void 0!==r?r:e[2],o=null;if(!n||void 0!==(o=t(n=n.replace(/''/g,"'"))))return o}t.cellAddressFromString=function(e,t,r){var n=s.exec(t),a=p(n[6]),i=m(n,e);if(void 0!==i){var u=Number(n[8])-1;return"$"===n[5]&&"$"===n[7]?o.CellAddress.absolute(i,a,u):"$"===n[5]?o.CellAddress.absoluteCol(i,a,u-r.row):"$"===n[7]?o.CellAddress.absoluteRow(i,a-r.col,u):o.CellAddress.relative(i,a-r.col,u-r.row)}},t.columnAddressFromString=function(e,t,r){var n=c.exec(t),o=m(n,e);if(void 0!==o){var i=p(n[6]);return"$"===n[5]?a.ColumnAddress.absolute(o,i):a.ColumnAddress.relative(o,i-r.col)}},t.rowAddressFromString=function(e,t,r){var n=l.exec(t),o=m(n,e);if(void 0!==o){var a=Number(n[6])-1;return"$"===n[5]?u.RowAddress.absolute(o,a):u.RowAddress.relative(o,a-r.row)}},t.simpleCellAddressFromString=function(e,t,r){var o=s.exec(t),a=p(o[6]),i=m(o,e);if(void 0!==i){null===i&&(i=r);var u=Number(o[8])-1;return(0,n.simpleCellAddress)(i,a,u)}},t.simpleCellAddressToString=function(e,t,r){var n=h(t.col),o=d(t.sheet,e);if(void 0!==o)return r!==t.sheet?"".concat(o,"!").concat(n).concat(t.row+1):"".concat(n).concat(t.row+1)}},function(e,t,r){var n=r(6),o=r(3),a=r(46),i=r(106),u=r(21).f,s=r(38).f,c=r(113),l=r(144),f=r(145),p=r(23),h=r(7),d=r(27).enforce,m=r(124),y=r(56)("match"),g=o.RegExp,v=g.prototype,E=/a/g,T=/a/g,b=new g(E)!==E,R=f.UNSUPPORTED_Y;if(n&&a("RegExp",!b||R||h((function(){return T[y]=!1,g(E)!=E||g(T)==T||"/a/i"!=g(E,"i")})))){for(var A=function(e,t){var r,n=this instanceof A,o=c(e),a=void 0===t;if(!n&&o&&e.constructor===A&&a)return e;b?o&&!a&&(e=e.source):e instanceof A&&(a&&(t=l.call(e)),e=e.source),R&&(r=!!t&&t.indexOf("y")>-1)&&(t=t.replace(/y/g,""));var u=i(b?new g(e,t):g(e,t),n?this:v,A);return R&&r&&(d(u).sticky=!0),u},S=function(e){e in A||u(A,e,{configurable:!0,get:function(){return g[e]},set:function(t){g[e]=t}})},N=s(g),O=0;N.length>O;)S(N[O++]);v.constructor=A,A.prototype=v,p(o,"RegExp",A)}m("RegExp")},function(e,t,r){"use strict";var n=r(22);e.exports=function(){var e=n(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,r){"use strict";var n=r(7);function o(e,t){return RegExp(e,t)}t.UNSUPPORTED_Y=n((function(){var e=o("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),t.BROKEN_CARET=n((function(){var e=o("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},function(e,t,r){"use strict";var n=r(2),o=r(147);n({target:"RegExp",proto:!0,forced:/./.exec!==o},{exec:o})},function(e,t,r){"use strict";var n,o,a=r(144),i=r(145),u=r(30),s=RegExp.prototype.exec,c=u("native-string-replace",String.prototype.replace),l=s,f=(n=/a/,o=/b*/g,s.call(n,"a"),s.call(o,"a"),0!==n.lastIndex||0!==o.lastIndex),p=i.UNSUPPORTED_Y||i.BROKEN_CARET,h=void 0!==/()??/.exec("")[1];(f||h||p)&&(l=function(e){var t,r,n,o,i=this,u=p&&i.sticky,l=a.call(i),d=i.source,m=0,y=e;return u&&(-1===(l=l.replace("y","")).indexOf("g")&&(l+="g"),y=String(e).slice(i.lastIndex),i.lastIndex>0&&(!i.multiline||i.multiline&&"\n"!==e[i.lastIndex-1])&&(d="(?: "+d+")",y=" "+y,m++),r=new RegExp("^(?:"+d+")",l)),h&&(r=new RegExp("^"+d+"$(?!\\s)",l)),f&&(t=i.lastIndex),n=s.call(u?r:i,y),u?n?(n.input=n.input.slice(m),n[0]=n[0].slice(m),n.index=i.lastIndex,i.lastIndex+=n[0].length):i.lastIndex=0:f&&n&&(i.lastIndex=i.global?n.index+n[0].length:t),h&&n&&n.length>1&&c.call(n[0],r,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(n[o]=void 0)})),n}),e.exports=l},function(e,t,r){"use strict";var n=r(23),o=r(22),a=r(7),i=r(144),u=RegExp.prototype,s=u.toString,c=a((function(){return"/a/b"!=s.call({source:"a",flags:"b"})})),l="toString"!=s.name;(c||l)&&n(RegExp.prototype,"toString",(function(){var e=o(this),t=String(e.source),r=e.flags;return"/"+t+"/"+String(void 0===r&&e instanceof RegExp&&!("flags"in u)?i.call(e):r)}),{unsafe:!0})},function(e,t,r){"use strict";var n=r(2),o=r(150).left,a=r(128),i=r(59),u=r(58);n({target:"Array",proto:!0,forced:!a("reduce")||!u&&i>79&&i<83},{reduce:function(e){return o(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},function(e,t,r){var n=r(47),o=r(17),a=r(11),i=r(41),u=function(e){return function(t,r,u,s){n(r);var c=o(t),l=a(c),f=i(c.length),p=e?f-1:0,h=e?-1:1;if(u<2)for(;;){if(p in l){s=l[p],p+=h;break}if(p+=h,e?p<0:f<=p)throw TypeError("Reduce of empty array with no initial value")}for(;e?p>=0:f>p;p+=h)p in l&&(s=r(s,l[p],p,c));return s}};e.exports={left:u(!1),right:u(!0)}},function(e,t,r){"use strict";var n=r(152),o=r(113),a=r(22),i=r(13),u=r(153),s=r(154),c=r(41),l=r(155),f=r(147),p=r(145).UNSUPPORTED_Y,h=[].push,d=Math.min;n("split",2,(function(e,t,r){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,r){var n=String(i(this)),a=void 0===r?4294967295:r>>>0;if(0===a)return[];if(void 0===e)return[n];if(!o(e))return t.call(n,e,a);for(var u,s,c,l=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),d=0,m=new RegExp(e.source,p+"g");(u=f.call(m,n))&&!((s=m.lastIndex)>d&&(l.push(n.slice(d,u.index)),u.length>1&&u.index<n.length&&h.apply(l,u.slice(1)),c=u[0].length,d=s,l.length>=a));)m.lastIndex===u.index&&m.lastIndex++;return d===n.length?!c&&m.test("")||l.push(""):l.push(n.slice(d)),l.length>a?l.slice(0,a):l}:"0".split(void 0,0).length?function(e,r){return void 0===e&&0===r?[]:t.call(this,e,r)}:t,[function(t,r){var o=i(this),a=null==t?void 0:t[e];return void 0!==a?a.call(t,o,r):n.call(String(o),t,r)},function(e,o){var i=r(n,e,this,o,n!==t);if(i.done)return i.value;var f=a(e),h=String(this),m=u(f,RegExp),y=f.unicode,g=(f.ignoreCase?"i":"")+(f.multiline?"m":"")+(f.unicode?"u":"")+(p?"g":"y"),v=new m(p?"^(?:"+f.source+")":f,g),E=void 0===o?4294967295:o>>>0;if(0===E)return[];if(0===h.length)return null===l(v,h)?[h]:[];for(var T=0,b=0,R=[];b<h.length;){v.lastIndex=p?0:b;var A,S=l(v,p?h.slice(b):h);if(null===S||(A=d(c(v.lastIndex+(p?b:0)),h.length))===T)b=s(h,b,y);else{if(R.push(h.slice(T,b)),R.length===E)return R;for(var N=1;N<=S.length-1;N++)if(R.push(S[N]),R.length===E)return R;b=T=A}}return R.push(h.slice(T)),R}]}),p)},function(e,t,r){"use strict";r(146);var n=r(23),o=r(7),a=r(56),i=r(20),u=a("species"),s=!o((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),c="$0"==="a".replace(/./,"$0"),l=a("replace"),f=!!/./[l]&&""===/./[l]("a","$0"),p=!o((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return 2!==r.length||"a"!==r[0]||"b"!==r[1]}));e.exports=function(e,t,r,l){var h=a(e),d=!o((function(){var t={};return t[h]=function(){return 7},7!=""[e](t)})),m=d&&!o((function(){var t=!1,r=/a/;return"split"===e&&((r={}).constructor={},r.constructor[u]=function(){return r},r.flags="",r[h]=/./[h]),r.exec=function(){return t=!0,null},r[h](""),!t}));if(!d||!m||"replace"===e&&(!s||!c||f)||"split"===e&&!p){var y=/./[h],g=r(h,""[e],(function(e,t,r,n,o){return t.exec===RegExp.prototype.exec?d&&!o?{done:!0,value:y.call(t,r,n)}:{done:!0,value:e.call(r,t,n)}:{done:!1}}),{REPLACE_KEEPS_$0:c,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:f}),v=g[0],E=g[1];n(String.prototype,e,v),n(RegExp.prototype,h,2==t?function(e,t){return E.call(e,this,t)}:function(e){return E.call(e,this)})}l&&i(RegExp.prototype[h],"sham",!0)}},function(e,t,r){var n=r(22),o=r(47),a=r(56)("species");e.exports=function(e,t){var r,i=n(e).constructor;return void 0===i||null==(r=n(i)[a])?t:o(r)}},function(e,t,r){"use strict";var n=r(78).charAt;e.exports=function(e,t,r){return t+(r?n(e,t).length:1)}},function(e,t,r){var n=r(12),o=r(147);e.exports=function(e,t){var r=e.exec;if("function"==typeof r){var a=r.call(e,t);if("object"!==i(a))throw TypeError("RegExp exec method returned something other than an Object or null");return a}if("RegExp"!==n(e))throw TypeError("RegExp#exec called on incompatible receiver");return o.call(e,t)}},function(e,t,r){"use strict";var n=r(152),o=r(22),a=r(41),i=r(42),u=r(13),s=r(154),c=r(157),l=r(155),f=Math.max,p=Math.min;n("replace",2,(function(e,t,r,n){var h=n.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,d=n.REPLACE_KEEPS_$0,m=h?"$":"$0";return[function(r,n){var o=u(this),a=null==r?void 0:r[e];return void 0!==a?a.call(r,o,n):t.call(String(o),r,n)},function(e,n){if(!h&&d||"string"==typeof n&&-1===n.indexOf(m)){var u=r(t,e,this,n);if(u.done)return u.value}var y=o(e),g=String(this),v="function"==typeof n;v||(n=String(n));var E=y.global;if(E){var T=y.unicode;y.lastIndex=0}for(var b=[];;){var R=l(y,g);if(null===R)break;if(b.push(R),!E)break;""===String(R[0])&&(y.lastIndex=s(g,a(y.lastIndex),T))}for(var A,S="",N=0,O=0;O<b.length;O++){R=b[O];for(var C=String(R[0]),w=f(p(i(R.index),g.length),0),M=[],I=1;I<R.length;I++)M.push(void 0===(A=R[I])?A:String(A));var x=R.groups;if(v){var k=[C].concat(M,w,g);void 0!==x&&k.push(x);var _=String(n.apply(void 0,k))}else _=c(C,g,w,M,x,n);w>=N&&(S+=g.slice(N,w)+_,N=w+C.length)}return S+g.slice(N)}]}))},function(e,t,r){var n=r(17),o=Math.floor,a="".replace,i=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,r,s,c,l){var f=r+e.length,p=s.length,h=u;return void 0!==c&&(c=n(c),h=i),a.call(l,h,(function(n,a){var i;switch(a.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,r);case"'":return t.slice(f);case"<":i=c[a.slice(1,-1)];break;default:var u=+a;if(0===u)return n;if(u>p){var l=o(u/10);return 0===l?n:l<=p?void 0===s[l-1]?a.charAt(1):s[l-1]+a.charAt(1):n}i=s[u-1]}return void 0===i?"":i}))}},function(e,t,r){"use strict";t.__esModule=!0,t.CellAddress=t.CellReferenceType=void 0,r(125);var n,o=r(115),a=r(142);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}t.CellReferenceType=n,function(e){e.CELL_REFERENCE_RELATIVE="CELL_REFERENCE",e.CELL_REFERENCE_ABSOLUTE="CELL_REFERENCE_ABSOLUTE",e.CELL_REFERENCE_ABSOLUTE_COL="CELL_REFERENCE_ABSOLUTE_COL",e.CELL_REFERENCE_ABSOLUTE_ROW="CELL_REFERENCE_ABSOLUTE_ROW"}(n||(t.CellReferenceType=n={}));var u=function(){function e(t,r,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sheet=t,this.col=r,this.row=n,this.type=o}var t,r,u;return t=e,u=[{key:"relative",value:function(t,r,o){return new e(t,r,o,n.CELL_REFERENCE_RELATIVE)}},{key:"absolute",value:function(t,r,o){return new e(t,r,o,n.CELL_REFERENCE_ABSOLUTE)}},{key:"absoluteCol",value:function(t,r,o){return new e(t,r,o,n.CELL_REFERENCE_ABSOLUTE_COL)}},{key:"absoluteRow",value:function(t,r,o){return new e(t,r,o,n.CELL_REFERENCE_ABSOLUTE_ROW)}}],(r=[{key:"toSimpleCellAddress",value:function(e){var t=(0,o.absoluteSheetReference)(this,e);return this.type===n.CELL_REFERENCE_ABSOLUTE?(0,o.simpleCellAddress)(t,this.col,this.row):this.type===n.CELL_REFERENCE_ABSOLUTE_ROW?(0,o.simpleCellAddress)(t,e.col+this.col,this.row):this.type===n.CELL_REFERENCE_ABSOLUTE_COL?(0,o.simpleCellAddress)(t,this.col,e.row+this.row):(0,o.simpleCellAddress)(t,e.col+this.col,e.row+this.row)}},{key:"toSimpleColumnAddress",value:function(e){var t=(0,o.absoluteSheetReference)(this,e),r=this.col;return this.isColumnRelative()&&(r+=e.col),(0,o.simpleColumnAddress)(t,r)}},{key:"toSimpleRowAddress",value:function(e){var t=(0,o.absoluteSheetReference)(this,e),r=this.row;return this.isRowRelative()&&(r+=e.row),(0,o.simpleRowAddress)(t,r)}},{key:"isRowAbsolute",value:function(){return this.type===n.CELL_REFERENCE_ABSOLUTE||this.type===n.CELL_REFERENCE_ABSOLUTE_ROW}},{key:"isColumnAbsolute",value:function(){return this.type===n.CELL_REFERENCE_ABSOLUTE||this.type===n.CELL_REFERENCE_ABSOLUTE_COL}},{key:"isColumnRelative",value:function(){return this.type===n.CELL_REFERENCE_RELATIVE||this.type===n.CELL_REFERENCE_ABSOLUTE_ROW}},{key:"isRowRelative",value:function(){return this.type===n.CELL_REFERENCE_RELATIVE||this.type===n.CELL_REFERENCE_ABSOLUTE_COL}},{key:"isAbsolute",value:function(){return this.type===n.CELL_REFERENCE_ABSOLUTE&&null!==this.sheet}},{key:"shiftedByRows",value:function(t){return new e(this.sheet,this.col,this.row+t,this.type)}},{key:"shiftedByColumns",value:function(t){return new e(this.sheet,this.col+t,this.row,this.type)}},{key:"moved",value:function(t,r,n){return new e(null===this.sheet?null:t,this.col+r,this.row+n,this.type)}},{key:"withAbsoluteSheet",value:function(t){return new e(t,this.col,this.row,this.type)}},{key:"isInvalid",value:function(e){return(0,o.invalidSimpleCellAddress)(this.toSimpleCellAddress(e))}},{key:"shiftRelativeDimensions",value:function(t,r){var n=this.isColumnAbsolute()?this.col:this.col+t,o=this.isRowAbsolute()?this.row:this.row+r;return new e(this.sheet,n,o,this.type)}},{key:"shiftAbsoluteDimensions",value:function(t,r){var n=this.isColumnRelative()?this.col:this.col+t,o=this.isRowRelative()?this.row:this.row+r;return new e(this.sheet,n,o,this.type)}},{key:"hash",value:function(e){var t=e&&null!==this.sheet?"#".concat(this.sheet):"";switch(this.type){case n.CELL_REFERENCE_RELATIVE:return"".concat(t,"#").concat(this.row,"R").concat(this.col);case n.CELL_REFERENCE_ABSOLUTE:return"".concat(t,"#").concat(this.row,"A").concat(this.col);case n.CELL_REFERENCE_ABSOLUTE_COL:return"".concat(t,"#").concat(this.row,"AC").concat(this.col);case n.CELL_REFERENCE_ABSOLUTE_ROW:return"".concat(t,"#").concat(this.row,"AR").concat(this.col)}}},{key:"unparse",value:function(e){var t=this.toSimpleCellAddress(e);if(!(0,o.invalidSimpleCellAddress)(t)){var r=(0,a.columnIndexToLabel)(t.col),i=this.type===n.CELL_REFERENCE_ABSOLUTE||this.type===n.CELL_REFERENCE_ABSOLUTE_ROW?"$":"",u=this.type===n.CELL_REFERENCE_ABSOLUTE||this.type===n.CELL_REFERENCE_ABSOLUTE_COL?"$":"";return"".concat(u).concat(r).concat(i).concat(t.row+1)}}},{key:"exceedsSheetSizeLimits",value:function(e,t){return this.row>=t||this.col>=e}}])&&i(t.prototype,r),u&&i(t,u),e}();t.CellAddress=u},function(e,t,r){"use strict";t.__esModule=!0,t.ColumnAddress=t.ReferenceType=void 0,r(125);var n,o=r(115),a=r(142);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}t.ReferenceType=n,function(e){e.RELATIVE="RELATIVE",e.ABSOLUTE="ABSOLUTE"}(n||(t.ReferenceType=n={}));var u=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sheet=t,this.col=r,this.type=n}var t,r,u;return t=e,u=[{key:"absolute",value:function(t,r){return new e(t,r,n.ABSOLUTE)}},{key:"relative",value:function(t,r){return new e(t,r,n.RELATIVE)}}],(r=[{key:"isColumnAbsolute",value:function(){return this.type===n.ABSOLUTE}},{key:"isColumnRelative",value:function(){return this.type===n.RELATIVE}},{key:"isAbsolute",value:function(){return this.type===n.ABSOLUTE&&null!==this.sheet}},{key:"moved",value:function(t,r,n){return new e(null===this.sheet?null:t,this.col+r,this.type)}},{key:"shiftedByColumns",value:function(t){return new e(this.sheet,this.col+t,this.type)}},{key:"toSimpleColumnAddress",value:function(e){var t=(0,o.absoluteSheetReference)(this,e),r=this.col;return this.isColumnRelative()&&(r=e.col+this.col),(0,o.simpleColumnAddress)(t,r)}},{key:"shiftRelativeDimensions",value:function(t,r){var n=this.isColumnRelative()?this.col+t:this.col;return new e(this.sheet,n,this.type)}},{key:"shiftAbsoluteDimensions",value:function(t,r){var n=this.isColumnAbsolute()?this.col+t:this.col;return new e(this.sheet,n,this.type)}},{key:"withAbsoluteSheet",value:function(t){return new e(t,this.col,this.type)}},{key:"isInvalid",value:function(e){return this.toSimpleColumnAddress(e).col<0}},{key:"hash",value:function(e){var t=e&&null!==this.sheet?"#".concat(this.sheet):"";switch(this.type){case n.RELATIVE:return"".concat(t,"#COLR").concat(this.col);case n.ABSOLUTE:return"".concat(t,"#COLA").concat(this.col)}}},{key:"unparse",value:function(e){var t=this.toSimpleColumnAddress(e);if(!(0,o.invalidSimpleColumnAddress)(t)){var r=(0,a.columnIndexToLabel)(t.col),i=this.type===n.ABSOLUTE?"$":"";return"".concat(i).concat(r)}}},{key:"exceedsSheetSizeLimits",value:function(e){return this.col>=e}}])&&i(t.prototype,r),u&&i(t,u),e}();t.ColumnAddress=u},function(e,t,r){"use strict";t.__esModule=!0,t.buildLexerConfig=t.WhiteSpace=t.ErrorLiteral=t.StringLiteral=t.NamedExpression=t.ProcedureName=t.RParen=t.LParen=t.RangeSeparator=t.RowRange=t.ColumnRange=t.CellReference=t.sheetNameRegexp=t.quotedSheetName=t.simpleSheetName=t.ConcatenateOp=t.LessThanOrEqualOp=t.GreaterThanOrEqualOp=t.LessThanOp=t.GreaterThanOp=t.NotEqualOp=t.EqualsOp=t.BooleanOp=t.PercentOp=t.PowerOp=t.DivOp=t.TimesOp=t.MultiplicationOp=t.MinusOp=t.PlusOp=t.AdditionOp=void 0,r(143),r(146),r(148),r(125);var n=r(161),o=(0,n.createToken)({name:"AdditionOp",pattern:n.Lexer.NA});
/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */t.AdditionOp=o;var a=(0,n.createToken)({name:"PlusOp",pattern:/\+/,categories:o});t.PlusOp=a;var i=(0,n.createToken)({name:"MinusOp",pattern:/-/,categories:o});t.MinusOp=i;var u=(0,n.createToken)({name:"MultiplicationOp",pattern:n.Lexer.NA});t.MultiplicationOp=u;var s=(0,n.createToken)({name:"TimesOp",pattern:/\*/,categories:u});t.TimesOp=s;var c=(0,n.createToken)({name:"DivOp",pattern:/\//,categories:u});t.DivOp=c;var l=(0,n.createToken)({name:"PowerOp",pattern:/\^/});t.PowerOp=l;var f=(0,n.createToken)({name:"PercentOp",pattern:/%/});t.PercentOp=f;var p=(0,n.createToken)({name:"BooleanOp",pattern:n.Lexer.NA});t.BooleanOp=p;var h=(0,n.createToken)({name:"EqualsOp",pattern:/=/,categories:p});t.EqualsOp=h;var d=(0,n.createToken)({name:"NotEqualOp",pattern:/<>/,categories:p});t.NotEqualOp=d;var m=(0,n.createToken)({name:"GreaterThanOp",pattern:/>/,categories:p});t.GreaterThanOp=m;var y=(0,n.createToken)({name:"LessThanOp",pattern:/</,categories:p});t.LessThanOp=y;var g=(0,n.createToken)({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:p});t.GreaterThanOrEqualOp=g;var v=(0,n.createToken)({name:"LessThanOrEqualOp",pattern:/<=/,categories:p});t.LessThanOrEqualOp=v;var E=(0,n.createToken)({name:"ConcatenateOp",pattern:/&/});t.ConcatenateOp=E,t.simpleSheetName="[A-Za-z0-9_À-ʯ]+",t.quotedSheetName="'(((?!').|'')*)'";var T="(".concat("[A-Za-z0-9_À-ʯ]+","|").concat("'(((?!').|'')*)'",")!");t.sheetNameRegexp=T;var b=(0,n.createToken)({name:"CellReference",pattern:new RegExp("(".concat(T,")?\\$?[A-Za-z]+\\$?[0-9]+"))});t.CellReference=b;var R=(0,n.createToken)({name:"ColumnRange",pattern:new RegExp("(".concat(T,")?\\$?[A-Za-z]+:(").concat(T,")?\\$?[A-Za-z]+"))});t.ColumnRange=R;var A=(0,n.createToken)({name:"RowRange",pattern:new RegExp("(".concat(T,")?\\$?[0-9]+:(").concat(T,")?\\$?[0-9]+"))});t.RowRange=A;var S=(0,n.createToken)({name:"RangeSeparator",pattern:/:/});t.RangeSeparator=S;var N=(0,n.createToken)({name:"LParen",pattern:/\(/});t.LParen=N;var O=(0,n.createToken)({name:"RParen",pattern:/\)/});t.RParen=O;var C=(0,n.createToken)({name:"ProcedureName",pattern:/([A-Za-z\u00C0-\u02AF][A-Za-z0-9\u00C0-\u02AF._]*)\(/});t.ProcedureName=C;var w=(0,n.createToken)({name:"NamedExpression",pattern:/[A-Za-z\u00C0-\u02AF_][A-Za-z0-9\u00C0-\u02AF._]*/});t.NamedExpression=w;var M=(0,n.createToken)({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/});t.StringLiteral=M;var I=(0,n.createToken)({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/});t.ErrorLiteral=I;var x=(0,n.createToken)({name:"WhiteSpace",pattern:/[ \t\n\r]+/});t.WhiteSpace=x,t.buildLexerConfig=function(e){var t=e.translationPackage.getFunctionTranslation("OFFSET"),r=e.errorMapping,T=e.translationPackage.buildFunctionMapping(),k=(0,n.createToken)({name:"ArgSeparator",pattern:e.functionArgSeparator}),_=(0,n.createToken)({name:"NumberLiteral",pattern:new RegExp("(([".concat(e.decimalSeparator,"]\\d+)|(\\d+([").concat(e.decimalSeparator,"]\\d*)?))(e[+-]?\\d+)?"))}),P=(0,n.createToken)({name:"OffsetProcedureName",pattern:new RegExp(t,"i")});return{ArgSeparator:k,NumberLiteral:_,OffsetProcedureName:P,allTokens:[x,a,i,s,c,l,h,d,f,g,v,m,y,N,O,P,C,S,k,R,A,_,M,I,E,p,o,u,b,w],errorMapping:r,functionMapping:T,decimalSeparator:e.decimalSeparator,maxColumns:e.maxColumns,maxRows:e.maxRows}}},function(e,t,r){"use strict";r.r(t),r.d(t,"clearCache",(function(){return m}));var n=r(162);r.d(t,"VERSION",(function(){return n.VERSION}));var o=r(163);r.d(t,"Parser",(function(){return o.Parser})),r.d(t,"CstParser",(function(){return o.CstParser})),r.d(t,"EmbeddedActionsParser",(function(){return o.EmbeddedActionsParser})),r.d(t,"ParserDefinitionErrorType",(function(){return o.ParserDefinitionErrorType})),r.d(t,"EMPTY_ALT",(function(){return o.EMPTY_ALT}));var a=r(169);r.d(t,"Lexer",(function(){return a.Lexer})),r.d(t,"LexerDefinitionErrorType",(function(){return a.LexerDefinitionErrorType}));var i=r(168);r.d(t,"createToken",(function(){return i.createToken})),r.d(t,"createTokenInstance",(function(){return i.createTokenInstance})),r.d(t,"EOF",(function(){return i.EOF})),r.d(t,"tokenLabel",(function(){return i.tokenLabel})),r.d(t,"tokenMatcher",(function(){return i.tokenMatcher})),r.d(t,"tokenName",(function(){return i.tokenName}));var u=r(182);r.d(t,"defaultGrammarResolverErrorProvider",(function(){return u.defaultGrammarResolverErrorProvider})),r.d(t,"defaultGrammarValidatorErrorProvider",(function(){return u.defaultGrammarValidatorErrorProvider})),r.d(t,"defaultParserErrorProvider",(function(){return u.defaultParserErrorProvider}));var s=r(189);r.d(t,"EarlyExitException",(function(){return s.EarlyExitException})),r.d(t,"isRecognitionException",(function(){return s.isRecognitionException})),r.d(t,"MismatchedTokenException",(function(){return s.MismatchedTokenException})),r.d(t,"NotAllInputParsedException",(function(){return s.NotAllInputParsedException})),r.d(t,"NoViableAltException",(function(){return s.NoViableAltException}));var c=r(175);r.d(t,"defaultLexerErrorProvider",(function(){return c.defaultLexerErrorProvider}));var l=r(167);r.d(t,"Alternation",(function(){return l.Alternation})),r.d(t,"Flat",(function(){return l.Flat})),r.d(t,"NonTerminal",(function(){return l.NonTerminal})),r.d(t,"Option",(function(){return l.Option})),r.d(t,"Repetition",(function(){return l.Repetition})),r.d(t,"RepetitionMandatory",(function(){return l.RepetitionMandatory})),r.d(t,"RepetitionMandatoryWithSeparator",(function(){return l.RepetitionMandatoryWithSeparator})),r.d(t,"RepetitionWithSeparator",(function(){return l.RepetitionWithSeparator})),r.d(t,"Rule",(function(){return l.Rule})),r.d(t,"Terminal",(function(){return l.Terminal})),r.d(t,"serializeGrammar",(function(){return l.serializeGrammar})),r.d(t,"serializeProduction",(function(){return l.serializeProduction}));var f=r(178);r.d(t,"GAstVisitor",(function(){return f.GAstVisitor}));var p=r(186);r.d(t,"assignOccurrenceIndices",(function(){return p.assignOccurrenceIndices})),r.d(t,"resolveGrammar",(function(){return p.resolveGrammar})),r.d(t,"validateGrammar",(function(){return p.validateGrammar}));var h=r(201);r.d(t,"createSyntaxDiagramsCode",(function(){return h.createSyntaxDiagramsCode}));var d=r(202);function m(){console.warn("The clearCache function was 'soft' removed from the Chevrotain API.\n\t It performs no action other than printing this message.\n\t Please avoid using it as it will be completely removed in the future")}r.d(t,"generateParserFactory",(function(){return d.generateParserFactory})),r.d(t,"generateParserModule",(function(){return d.generateParserModule}))},function(e,t,r){"use strict";r.r(t),r.d(t,"VERSION",(function(){return n}));var n="6.5.0"},function(e,t,r){"use strict";r.r(t),r.d(t,"END_OF_FILE",(function(){return b})),r.d(t,"DEFAULT_PARSER_CONFIG",(function(){return A})),r.d(t,"DEFAULT_RULE_CONFIG",(function(){return S})),r.d(t,"ParserDefinitionErrorType",(function(){return R})),r.d(t,"EMPTY_ALT",(function(){return N})),r.d(t,"Parser",(function(){return O})),r.d(t,"CstParser",(function(){return C})),r.d(t,"EmbeddedActionsParser",(function(){return w}));var n,o=r(164),a=r(165),i=r(168),u=r(180),s=r(182),c=r(186),l=r(188),f=r(190),p=r(191),h=r(194),d=r(195),m=r(196),y=r(197),g=r(198),v=r(199),E=r(200),T=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),b=Object(i.createTokenInstance)(i.EOF,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(b);var R,A=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:s.defaultParserErrorProvider,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),S=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0});function N(e){return void 0===e&&(e=void 0),function(){return e}}!function(e){e[e.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",e[e.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",e[e.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",e[e.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",e[e.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",e[e.LEFT_RECURSION=5]="LEFT_RECURSION",e[e.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",e[e.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",e[e.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",e[e.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",e[e.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",e[e.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",e[e.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",e[e.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",e[e.TOO_MANY_ALTS=14]="TOO_MANY_ALTS"}(R||(R={}));var O=function(){function e(e,t){void 0===t&&(t=A),this.ignoredIssues=A.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1,this.initErrorHandler(t),this.initLexerAdapter(),this.initLooksAhead(t),this.initRecognizerEngine(e,t),this.initRecoverable(t),this.initTreeBuilder(t),this.initContentAssist(),this.initGastRecorder(t),this.initPerformanceTracer(t),Object(o.has)(t,"ignoredIssues")&&t.ignoredIssues!==A.ignoredIssues&&Object(o.PRINT_WARNING)("The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.\n\tPlease use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead."),this.ignoredIssues=Object(o.has)(t,"ignoredIssues")?t.ignoredIssues:A.ignoredIssues,this.skipValidations=Object(o.has)(t,"skipValidations")?t.skipValidations:A.skipValidations}return e.performSelfAnalysis=function(e){e.performSelfAnalysis()},e.prototype.performSelfAnalysis=function(){var t=this;this.TRACE_INIT("performSelfAnalysis",(function(){var r;t.selfAnalysisDone=!0;var n=t.className;t.TRACE_INIT("toFastProps",(function(){Object(o.toFastProperties)(t)})),t.TRACE_INIT("Grammar Recording",(function(){try{t.enableRecording(),Object(o.forEach)(t.definedRulesNames,(function(e){var r=t[e].originalGrammarAction,n=void 0;t.TRACE_INIT(e+" Rule",(function(){n=t.topLevelRuleRecord(e,r)})),t.gastProductionsCache[e]=n}))}finally{t.disableRecording()}}));var i=[];if(t.TRACE_INIT("Grammar Resolving",(function(){i=Object(c.resolveGrammar)({rules:Object(o.values)(t.gastProductionsCache)}),t.definitionErrors.push.apply(t.definitionErrors,i)})),t.TRACE_INIT("Grammar Validations",(function(){if(Object(o.isEmpty)(i)&&!1===t.skipValidations){var e=Object(c.validateGrammar)({rules:Object(o.values)(t.gastProductionsCache),maxLookahead:t.maxLookahead,tokenTypes:Object(o.values)(t.tokensMap),ignoredIssues:t.ignoredIssues,errMsgProvider:s.defaultGrammarValidatorErrorProvider,grammarName:n});t.definitionErrors.push.apply(t.definitionErrors,e)}})),Object(o.isEmpty)(t.definitionErrors)&&(t.recoveryEnabled&&t.TRACE_INIT("computeAllProdsFollows",(function(){var e=Object(a.computeAllProdsFollows)(Object(o.values)(t.gastProductionsCache));t.resyncFollows=e})),t.TRACE_INIT("ComputeLookaheadFunctions",(function(){t.preComputeLookaheadFunctions(Object(o.values)(t.gastProductionsCache))}))),t.TRACE_INIT("expandAllNestedRuleNames",(function(){var e=Object(u.expandAllNestedRuleNames)(Object(o.values)(t.gastProductionsCache),t.fullRuleNameToShort);t.allRuleNames=e.allRuleNames})),!e.DEFER_DEFINITION_ERRORS_HANDLING&&!Object(o.isEmpty)(t.definitionErrors))throw r=Object(o.map)(t.definitionErrors,(function(e){return e.message})),new Error("Parser Definition Errors detected:\n "+r.join("\n-------------------------------\n"))}))},e.DEFER_DEFINITION_ERRORS_HANDLING=!1,e}();Object(o.applyMixins)(O,[l.Recoverable,f.LooksAhead,p.TreeBuilder,h.LexerAdapter,m.RecognizerEngine,d.RecognizerApi,y.ErrorHandler,g.ContentAssist,v.GastRecorder,E.PerformanceTracer]);var C=function(e){function t(t,r){void 0===r&&(r=A);var n=Object(o.cloneObj)(r);return n.outputCst=!0,e.call(this,t,n)||this}return T(t,e),t}(O),w=function(e){function t(t,r){void 0===r&&(r=A);var n=Object(o.cloneObj)(r);return n.outputCst=!1,e.call(this,t,n)||this}return T(t,e),t}(O)},function(e,t,r){"use strict";function n(e){return e&&0===e.length}function o(e){return null==e?[]:Object.keys(e)}function a(e){for(var t=[],r=Object.keys(e),n=0;n<r.length;n++)t.push(e[r[n]]);return t}function u(e,t){for(var r=[],n=o(e),a=0;a<n.length;a++){var i=n[a];r.push(t.call(null,e[i],i))}return r}function s(e,t){for(var r=[],n=0;n<e.length;n++)r.push(t.call(null,e[n],n));return r}function c(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];Array.isArray(n)?t=t.concat(c(n)):t.push(n)}return t}function l(e){return n(e)?void 0:e[0]}function f(e){var t=e&&e.length;return t?e[t-1]:void 0}function p(e,t){if(Array.isArray(e))for(var r=0;r<e.length;r++)t.call(null,e[r],r);else{if(!_(e))throw Error("non exhaustive match");var n=o(e);for(r=0;r<n.length;r++){var a=n[r],i=e[a];t.call(null,i,a)}}}function h(e){return"string"==typeof e}function d(e){return void 0===e}function m(e){return e instanceof Function}function y(e,t){return void 0===t&&(t=1),e.slice(t,e.length)}function g(e,t){return void 0===t&&(t=1),e.slice(0,e.length-t)}function v(e,t){var r=[];if(Array.isArray(e))for(var n=0;n<e.length;n++){var o=e[n];t.call(null,o)&&r.push(o)}return r}function E(e,t){return v(e,(function(e){return!t(e)}))}function T(e,t){for(var r=Object.keys(e),n={},o=0;o<r.length;o++){var a=r[o],i=e[a];t(i)&&(n[a]=i)}return n}function b(e,t){return!!_(e)&&e.hasOwnProperty(t)}function R(e,t){return void 0!==N(e,(function(e){return e===t}))}function A(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r]);return t}function S(e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}function N(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(t.call(null,n))return n}}function O(e,t){for(var r=[],n=0;n<e.length;n++){var o=e[n];t.call(null,o)&&r.push(o)}return r}function C(e,t,r){for(var n=Array.isArray(e),i=n?e:a(e),u=n?[]:o(e),s=r,c=0;c<i.length;c++)s=t.call(null,s,i[c],n?c:u[c]);return s}function w(e){return E(e,(function(e){return null==e}))}function M(e,t){void 0===t&&(t=function(e){return e});var r=[];return C(e,(function(e,n){var o=t(n);return R(r,o)?e:(r.push(o),e.concat(n))}),[])}function I(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=[null],o=n.concat(t);return Function.bind.apply(e,o)}function x(e){return Array.isArray(e)}function k(e){return e instanceof RegExp}function _(e){return e instanceof Object}function P(e,t){for(var r=0;r<e.length;r++)if(!t(e[r],r))return!1;return!0}function L(e,t){return E(e,(function(e){return R(t,e)}))}function F(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return!0;return!1}function U(e,t){for(var r=0;r<e.length;r++)if(e[r]===t)return r;return-1}function V(e,t){var r=A(e);return r.sort((function(e,r){return t(e)-t(r)})),r}function D(e,t){if(e.length!==t.length)throw Error("can't zipObject with different number of keys and values!");for(var r={},n=0;n<e.length;n++)r[e[n]]=t[n];return r}function j(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0;n<t.length;n++)for(var a=t[n],i=o(a),u=0;u<i.length;u++){var s=i[u];e[s]=a[s]}return e}function B(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0;n<t.length;n++){var a=t[n];if(!d(a))for(var i=o(a),u=0;u<i.length;u++){var s=i[u];b(e,s)||(e[s]=a[s])}}return e}function G(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return B.apply(null,[{}].concat(e))}function W(e,t){var r={};return p(e,(function(e){var n=t(e),o=r[n];o?o.push(e):r[n]=[e]})),r}function H(e,t){for(var r=S(e),n=o(t),a=0;a<n.length;a++){var i=n[a],u=t[i];r[i]=u}return r}function z(){}function Y(e){return e}function X(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];t.push(void 0!==n?n:void 0)}return t}function K(e){console&&console.error&&console.error("Error: "+e)}function q(e){console&&console.warn&&console.warn("Warning: "+e)}function Q(){return"function"==typeof Map}function $(e,t){t.forEach((function(t){var r=t.prototype;Object.getOwnPropertyNames(r).forEach((function(n){if("constructor"!==n){var o=Object.getOwnPropertyDescriptor(r,n);o&&(o.get||o.set)?Object.defineProperty(e.prototype,n,o):e.prototype[n]=t.prototype[n]}}))}))}function Z(e){function t(){}t.prototype=e;var r=new t;function n(){return i(r.bar)}return n(),n(),e}function J(e){return e[e.length-1]}function ee(e){var t=(new Date).getTime(),r=e();return{time:(new Date).getTime()-t,value:r}}r.r(t),r.d(t,"isEmpty",(function(){return n})),r.d(t,"keys",(function(){return o})),r.d(t,"values",(function(){return a})),r.d(t,"mapValues",(function(){return u})),r.d(t,"map",(function(){return s})),r.d(t,"flatten",(function(){return c})),r.d(t,"first",(function(){return l})),r.d(t,"last",(function(){return f})),r.d(t,"forEach",(function(){return p})),r.d(t,"isString",(function(){return h})),r.d(t,"isUndefined",(function(){return d})),r.d(t,"isFunction",(function(){return m})),r.d(t,"drop",(function(){return y})),r.d(t,"dropRight",(function(){return g})),r.d(t,"filter",(function(){return v})),r.d(t,"reject",(function(){return E})),r.d(t,"pick",(function(){return T})),r.d(t,"has",(function(){return b})),r.d(t,"contains",(function(){return R})),r.d(t,"cloneArr",(function(){return A})),r.d(t,"cloneObj",(function(){return S})),r.d(t,"find",(function(){return N})),r.d(t,"findAll",(function(){return O})),r.d(t,"reduce",(function(){return C})),r.d(t,"compact",(function(){return w})),r.d(t,"uniq",(function(){return M})),r.d(t,"partial",(function(){return I})),r.d(t,"isArray",(function(){return x})),r.d(t,"isRegExp",(function(){return k})),r.d(t,"isObject",(function(){return _})),r.d(t,"every",(function(){return P})),r.d(t,"difference",(function(){return L})),r.d(t,"some",(function(){return F})),r.d(t,"indexOf",(function(){return U})),r.d(t,"sortBy",(function(){return V})),r.d(t,"zipObject",(function(){return D})),r.d(t,"assign",(function(){return j})),r.d(t,"assignNoOverwrite",(function(){return B})),r.d(t,"defaults",(function(){return G})),r.d(t,"groupBy",(function(){return W})),r.d(t,"merge",(function(){return H})),r.d(t,"NOOP",(function(){return z})),r.d(t,"IDENTITY",(function(){return Y})),r.d(t,"packArray",(function(){return X})),r.d(t,"PRINT_ERROR",(function(){return K})),r.d(t,"PRINT_WARNING",(function(){return q})),r.d(t,"isES2015MapSupported",(function(){return Q})),r.d(t,"applyMixins",(function(){return $})),r.d(t,"toFastProperties",(function(){return Z})),r.d(t,"peek",(function(){return J})),r.d(t,"timer",(function(){return ee}))},function(e,t,r){"use strict";r.r(t),r.d(t,"ResyncFollowsWalker",(function(){return l})),r.d(t,"computeAllProdsFollows",(function(){return f})),r.d(t,"buildBetweenProdsFollowPrefix",(function(){return p})),r.d(t,"buildInProdFollowPrefix",(function(){return h}));var n,o=r(166),a=r(176),i=r(164),u=r(179),s=r(167),c=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),l=function(e){function t(t){var r=e.call(this)||this;return r.topProd=t,r.follows={},r}return c(t,e),t.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},t.prototype.walkTerminal=function(e,t,r){},t.prototype.walkProdRef=function(e,t,r){var n=p(e.referencedRule,e.idx)+this.topProd.name,o=t.concat(r),i=new s.Flat({definition:o}),u=Object(a.first)(i);this.follows[n]=u},t}(o.RestWalker);function f(e){var t={};return Object(i.forEach)(e,(function(e){var r=new l(e).startWalking();Object(i.assign)(t,r)})),t}function p(e,t){return e.name+t+u.IN}function h(e){return e.terminalType.name+e.idx+u.IN}},function(e,t,r){"use strict";r.r(t),r.d(t,"RestWalker",(function(){return a}));var n=r(164),o=r(167),a=function(){function e(){}return e.prototype.walk=function(e,t){var r=this;void 0===t&&(t=[]),Object(n.forEach)(e.definition,(function(a,i){var u=Object(n.drop)(e.definition,i+1);if(a instanceof o.NonTerminal)r.walkProdRef(a,u,t);else if(a instanceof o.Terminal)r.walkTerminal(a,u,t);else if(a instanceof o.Flat)r.walkFlat(a,u,t);else if(a instanceof o.Option)r.walkOption(a,u,t);else if(a instanceof o.RepetitionMandatory)r.walkAtLeastOne(a,u,t);else if(a instanceof o.RepetitionMandatoryWithSeparator)r.walkAtLeastOneSep(a,u,t);else if(a instanceof o.RepetitionWithSeparator)r.walkManySep(a,u,t);else if(a instanceof o.Repetition)r.walkMany(a,u,t);else{if(!(a instanceof o.Alternation))throw Error("non exhaustive match");r.walkOr(a,u,t)}}))},e.prototype.walkTerminal=function(e,t,r){},e.prototype.walkProdRef=function(e,t,r){},e.prototype.walkFlat=function(e,t,r){var n=t.concat(r);this.walk(e,n)},e.prototype.walkOption=function(e,t,r){var n=t.concat(r);this.walk(e,n)},e.prototype.walkAtLeastOne=function(e,t,r){var n=[new o.Option({definition:e.definition})].concat(t,r);this.walk(e,n)},e.prototype.walkAtLeastOneSep=function(e,t,r){var n=i(e,t,r);this.walk(e,n)},e.prototype.walkMany=function(e,t,r){var n=[new o.Option({definition:e.definition})].concat(t,r);this.walk(e,n)},e.prototype.walkManySep=function(e,t,r){var n=i(e,t,r);this.walk(e,n)},e.prototype.walkOr=function(e,t,r){var a=this,i=t.concat(r);Object(n.forEach)(e.definition,(function(e){var t=new o.Flat({definition:[e]});a.walk(t,i)}))},e}();function i(e,t,r){return[new o.Option({definition:[new o.Terminal({terminalType:e.separator})].concat(e.definition)})].concat(t,r)}},function(e,t,r){"use strict";r.r(t),r.d(t,"AbstractProduction",(function(){return u})),r.d(t,"NonTerminal",(function(){return s})),r.d(t,"Rule",(function(){return c})),r.d(t,"Flat",(function(){return l})),r.d(t,"Option",(function(){return f})),r.d(t,"RepetitionMandatory",(function(){return p})),r.d(t,"RepetitionMandatoryWithSeparator",(function(){return h})),r.d(t,"Repetition",(function(){return d})),r.d(t,"RepetitionWithSeparator",(function(){return m})),r.d(t,"Alternation",(function(){return y})),r.d(t,"Terminal",(function(){return g})),r.d(t,"serializeGrammar",(function(){return v})),r.d(t,"serializeProduction",(function(){return E}));var n,o=r(164),a=r(168),i=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),u=function(){function e(e){this.definition=e}return e.prototype.accept=function(e){e.visit(this),Object(o.forEach)(this.definition,(function(t){t.accept(e)}))},e}(),s=function(e){function t(t){var r=e.call(this,[])||this;return r.idx=1,Object(o.assign)(r,Object(o.pick)(t,(function(e){return void 0!==e}))),r}return i(t,e),Object.defineProperty(t.prototype,"definition",{get:function(){return void 0!==this.referencedRule?this.referencedRule.definition:[]},set:function(e){},enumerable:!0,configurable:!0}),t.prototype.accept=function(e){e.visit(this)},t}(u),c=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.orgText="",Object(o.assign)(r,Object(o.pick)(t,(function(e){return void 0!==e}))),r}return i(t,e),t}(u),l=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.ignoreAmbiguities=!1,Object(o.assign)(r,Object(o.pick)(t,(function(e){return void 0!==e}))),r}return i(t,e),t}(u),f=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,Object(o.assign)(r,Object(o.pick)(t,(function(e){return void 0!==e}))),r}return i(t,e),t}(u),p=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,Object(o.assign)(r,Object(o.pick)(t,(function(e){return void 0!==e}))),r}return i(t,e),t}(u),h=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,Object(o.assign)(r,Object(o.pick)(t,(function(e){return void 0!==e}))),r}return i(t,e),t}(u),d=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,Object(o.assign)(r,Object(o.pick)(t,(function(e){return void 0!==e}))),r}return i(t,e),t}(u),m=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,Object(o.assign)(r,Object(o.pick)(t,(function(e){return void 0!==e}))),r}return i(t,e),t}(u),y=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,r.ignoreAmbiguities=!1,r.hasPredicates=!1,Object(o.assign)(r,Object(o.pick)(t,(function(e){return void 0!==e}))),r}return i(t,e),t}(u),g=function(){function e(e){this.idx=1,Object(o.assign)(this,Object(o.pick)(e,(function(e){return void 0!==e})))}return e.prototype.accept=function(e){e.visit(this)},e}();function v(e){return Object(o.map)(e,E)}function E(e){function t(e){return Object(o.map)(e,E)}if(e instanceof s)return{type:"NonTerminal",name:e.nonTerminalName,idx:e.idx};if(e instanceof l)return{type:"Flat",definition:t(e.definition)};if(e instanceof f)return{type:"Option",idx:e.idx,definition:t(e.definition)};if(e instanceof p)return{type:"RepetitionMandatory",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof h)return{type:"RepetitionMandatoryWithSeparator",name:e.name,idx:e.idx,separator:E(new g({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof m)return{type:"RepetitionWithSeparator",name:e.name,idx:e.idx,separator:E(new g({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof d)return{type:"Repetition",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof y)return{type:"Alternation",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof g){var r={type:"Terminal",name:e.terminalType.name,label:Object(a.tokenLabel)(e.terminalType),idx:e.idx},n=e.terminalType.PATTERN;return e.terminalType.PATTERN&&(r.pattern=Object(o.isRegExp)(n)?n.source:n),r}if(e instanceof c)return{type:"Rule",name:e.name,orgText:e.orgText,definition:t(e.definition)};throw Error("non exhaustive match")}},function(e,t,r){"use strict";r.r(t),r.d(t,"tokenLabel",(function(){return i})),r.d(t,"tokenName",(function(){return u})),r.d(t,"hasTokenLabel",(function(){return s})),r.d(t,"createToken",(function(){return c})),r.d(t,"EOF",(function(){return l})),r.d(t,"createTokenInstance",(function(){return f})),r.d(t,"tokenMatcher",(function(){return p}));var n=r(164),o=r(169),a=r(174);function i(e){return s(e)?e.LABEL:e.name}function u(e){return e.name}function s(e){return Object(n.isString)(e.LABEL)&&""!==e.LABEL}function c(e){return function(e){var t=e.pattern,r={};if(r.name=e.name,Object(n.isUndefined)(t)||(r.PATTERN=t),Object(n.has)(e,"parent"))throw"The parent property is no longer supported.\nSee: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.";return Object(n.has)(e,"categories")&&(r.CATEGORIES=e.categories),Object(a.augmentTokenTypes)([r]),Object(n.has)(e,"label")&&(r.LABEL=e.label),Object(n.has)(e,"group")&&(r.GROUP=e.group),Object(n.has)(e,"pop_mode")&&(r.POP_MODE=e.pop_mode),Object(n.has)(e,"push_mode")&&(r.PUSH_MODE=e.push_mode),Object(n.has)(e,"longer_alt")&&(r.LONGER_ALT=e.longer_alt),Object(n.has)(e,"line_breaks")&&(r.LINE_BREAKS=e.line_breaks),Object(n.has)(e,"start_chars_hint")&&(r.START_CHARS_HINT=e.start_chars_hint),r}(e)}var l=c({name:"EOF",pattern:o.Lexer.NA});function f(e,t,r,n,o,a,i,u){return{image:t,startOffset:r,endOffset:n,startLine:o,endLine:a,startColumn:i,endColumn:u,tokenTypeIdx:e.tokenTypeIdx,tokenType:e}}function p(e,t){return Object(a.tokenStructuredMatcher)(e,t)}Object(a.augmentTokenTypes)([l])},function(e,t,r){"use strict";r.r(t),r.d(t,"LexerDefinitionErrorType",(function(){return n})),r.d(t,"Lexer",(function(){return l}));var n,o=r(170),a=r(164),i=r(174),u=r(175),s=r(173);!function(e){e[e.MISSING_PATTERN=0]="MISSING_PATTERN",e[e.INVALID_PATTERN=1]="INVALID_PATTERN",e[e.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",e[e.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",e[e.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",e[e.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",e[e.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",e[e.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",e[e.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",e[e.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",e[e.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",e[e.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",e[e.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",e[e.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",e[e.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",e[e.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",e[e.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"}(n||(n={}));var c={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:["\n","\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:u.defaultLexerErrorProvider,traceInitPerf:!1,skipValidations:!1};Object.freeze(c);var l=function(){function e(e,t){var r=this;if(void 0===t&&(t=c),this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},"boolean"==typeof t)throw Error("The second argument to the Lexer constructor is now an ILexerConfig Object.\na boolean 2nd argument is no longer supported");this.config=Object(a.merge)(c,t);var n=this.config.traceInitPerf;!0===n?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):"number"==typeof n&&(this.traceInitMaxIdent=n,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",(function(){var n,u=!0;r.TRACE_INIT("Lexer Config handling",(function(){if(r.config.lineTerminatorsPattern===c.lineTerminatorsPattern)r.config.lineTerminatorsPattern=o.LineTerminatorOptimizedTester;else if(r.config.lineTerminatorCharacters===c.lineTerminatorCharacters)throw Error("Error: Missing <lineTerminatorCharacters> property on the Lexer config.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS");if(t.safeMode&&t.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');r.trackStartLines=/full|onlyStart/i.test(r.config.positionTracking),r.trackEndLines=/full/i.test(r.config.positionTracking),Object(a.isArray)(e)?((n={modes:{}}).modes[o.DEFAULT_MODE]=Object(a.cloneArr)(e),n[o.DEFAULT_MODE]=o.DEFAULT_MODE):(u=!1,n=Object(a.cloneObj)(e))})),!1===r.config.skipValidations&&(r.TRACE_INIT("performRuntimeChecks",(function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(Object(o.performRuntimeChecks)(n,r.trackStartLines,r.config.lineTerminatorCharacters))})),r.TRACE_INIT("performWarningRuntimeChecks",(function(){r.lexerDefinitionWarning=r.lexerDefinitionWarning.concat(Object(o.performWarningRuntimeChecks)(n,r.trackStartLines,r.config.lineTerminatorCharacters))}))),n.modes=n.modes?n.modes:{},Object(a.forEach)(n.modes,(function(e,t){n.modes[t]=Object(a.reject)(e,(function(e){return Object(a.isUndefined)(e)}))}));var l=Object(a.keys)(n.modes);if(Object(a.forEach)(n.modes,(function(e,n){r.TRACE_INIT("Mode: <"+n+"> processing",(function(){var u;r.modes.push(n),!1===r.config.skipValidations&&r.TRACE_INIT("validatePatterns",(function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(Object(o.validatePatterns)(e,l))})),Object(a.isEmpty)(r.lexerDefinitionErrors)&&(Object(i.augmentTokenTypes)(e),r.TRACE_INIT("analyzeTokenTypes",(function(){u=Object(o.analyzeTokenTypes)(e,{lineTerminatorCharacters:r.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode,tracer:r.TRACE_INIT.bind(r)})})),r.patternIdxToConfig[n]=u.patternIdxToConfig,r.charCodeToPatternIdxToConfig[n]=u.charCodeToPatternIdxToConfig,r.emptyGroups=Object(a.merge)(r.emptyGroups,u.emptyGroups),r.hasCustom=u.hasCustom||r.hasCustom,r.canModeBeOptimized[n]=u.canBeOptimized)}))})),r.defaultMode=n.defaultMode,!Object(a.isEmpty)(r.lexerDefinitionErrors)&&!r.config.deferDefinitionErrorsHandling){var f=Object(a.map)(r.lexerDefinitionErrors,(function(e){return e.message})).join("-----------------------\n");throw new Error("Errors detected in definition of Lexer:\n"+f)}Object(a.forEach)(r.lexerDefinitionWarning,(function(e){Object(a.PRINT_WARNING)(e.message)})),r.TRACE_INIT("Choosing sub-methods implementations",(function(){if(o.SUPPORT_STICKY?(r.chopInput=a.IDENTITY,r.match=r.matchWithTest):(r.updateLastIndex=a.NOOP,r.match=r.matchWithExec),u&&(r.handleModes=a.NOOP),!1===r.trackStartLines&&(r.computeNewColumn=a.IDENTITY),!1===r.trackEndLines&&(r.updateTokenEndLineColumnLocation=a.NOOP),/full/i.test(r.config.positionTracking))r.createTokenInstance=r.createFullToken;else if(/onlyStart/i.test(r.config.positionTracking))r.createTokenInstance=r.createStartOnlyToken;else{if(!/onlyOffset/i.test(r.config.positionTracking))throw Error('Invalid <positionTracking> config option: "'+r.config.positionTracking+'"');r.createTokenInstance=r.createOffsetOnlyToken}r.hasCustom?(r.addToken=r.addTokenUsingPush,r.handlePayload=r.handlePayloadWithCustom):(r.addToken=r.addTokenUsingMemberAccess,r.handlePayload=r.handlePayloadNoCustom)})),r.TRACE_INIT("Failed Optimization Warnings",(function(){var e=Object(a.reduce)(r.canModeBeOptimized,(function(e,t,r){return!1===t&&e.push(r),e}),[]);if(t.ensureOptimizations&&!Object(a.isEmpty)(e))throw Error("Lexer Modes: < "+e.join(", ")+' > cannot be optimized.\n\t Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.\n\t Or inspect the console log for details on how to resolve these issues.')})),r.TRACE_INIT("clearRegExpParserCache",(function(){Object(s.clearRegExpParserCache)()})),r.TRACE_INIT("toFastProperties",(function(){Object(a.toFastProperties)(r)}))}))}return e.prototype.tokenize=function(e,t){if(void 0===t&&(t=this.defaultMode),!Object(a.isEmpty)(this.lexerDefinitionErrors)){var r=Object(a.map)(this.lexerDefinitionErrors,(function(e){return e.message})).join("-----------------------\n");throw new Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+r)}return this.tokenizeInternal(e,t)},e.prototype.tokenizeInternal=function(e,t){var r,n,i,u,s,c,l,f,p,h,d,m,y,g,v=this,E=e,T=E.length,b=0,R=0,A=this.hasCustom?0:Math.floor(e.length/10),S=new Array(A),N=[],O=this.trackStartLines?1:void 0,C=this.trackStartLines?1:void 0,w=Object(o.cloneEmptyGroups)(this.emptyGroups),M=this.trackStartLines,I=this.config.lineTerminatorsPattern,x=0,k=[],_=[],P=[],L=[];Object.freeze(L);var F=void 0;function U(){return k}function V(e){var t=Object(o.charCodeToOptimizedIndex)(e),r=_[t];return void 0===r?L:r}var D,j=function(e){if(1===P.length&&void 0===e.tokenType.PUSH_MODE){var t=v.config.errorMessageProvider.buildUnableToPopLexerModeMessage(e);N.push({offset:e.startOffset,line:void 0!==e.startLine?e.startLine:void 0,column:void 0!==e.startColumn?e.startColumn:void 0,length:e.image.length,message:t})}else{P.pop();var r=Object(a.last)(P);k=v.patternIdxToConfig[r],_=v.charCodeToPatternIdxToConfig[r],x=k.length;var n=v.canModeBeOptimized[r]&&!1===v.config.safeMode;F=_&&n?V:U}};function B(e){P.push(e),_=this.charCodeToPatternIdxToConfig[e],k=this.patternIdxToConfig[e],x=k.length,x=k.length;var t=this.canModeBeOptimized[e]&&!1===this.config.safeMode;F=_&&t?V:U}for(B.call(this,t);b<T;){s=null;var G=E.charCodeAt(b),W=F(G),H=W.length;for(r=0;r<H;r++){var z=(D=W[r]).pattern;if(c=null,!1!==(te=D.short)?G===te&&(s=z):!0===D.isCustom?null!==(g=z.exec(E,b,S,w))?(s=g[0],void 0!==g.payload&&(c=g.payload)):s=null:(this.updateLastIndex(z,b),s=this.match(z,e,b)),null!==s){if(void 0!==(u=D.longerAlt)){var Y=k[u],X=Y.pattern;l=null,!0===Y.isCustom?null!==(g=X.exec(E,b,S,w))?(i=g[0],void 0!==g.payload&&(l=g.payload)):i=null:(this.updateLastIndex(X,b),i=this.match(X,e,b)),i&&i.length>s.length&&(s=i,c=l,D=Y)}break}}if(null!==s){if(f=s.length,void 0!==(p=D.group)&&(h=D.tokenTypeIdx,d=this.createTokenInstance(s,b,h,D.tokenType,O,C,f),this.handlePayload(d,c),!1===p?R=this.addToken(S,R,d):w[p].push(d)),e=this.chopInput(e,f),b+=f,C=this.computeNewColumn(C,f),!0===M&&!0===D.canLineTerminator){var K=0,q=void 0,Q=void 0;I.lastIndex=0;do{!0===(q=I.test(s))&&(Q=I.lastIndex-1,K++)}while(!0===q);0!==K&&(O+=K,C=f-Q,this.updateTokenEndLineColumnLocation(d,p,Q,K,O,C,f))}this.handleModes(D,j,B,d)}else{for(var $=b,Z=O,J=C,ee=!1;!ee&&b<T;)for(E.charCodeAt(b),e=this.chopInput(e,1),b++,n=0;n<x;n++){var te,re=k[n];if(z=re.pattern,!1!==(te=re.short)?E.charCodeAt(b)===te&&(ee=!0):!0===re.isCustom?ee=null!==z.exec(E,b,S,w):(this.updateLastIndex(z,b),ee=null!==z.exec(e)),!0===ee)break}m=b-$,y=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(E,$,m,Z,J),N.push({offset:$,line:Z,column:J,length:m,message:y})}}return this.hasCustom||(S.length=R),{tokens:S,groups:w,errors:N}},e.prototype.handleModes=function(e,t,r,n){if(!0===e.pop){var o=e.push;t(n),void 0!==o&&r.call(this,o)}else void 0!==e.push&&r.call(this,e.push)},e.prototype.chopInput=function(e,t){return e.substring(t)},e.prototype.updateLastIndex=function(e,t){e.lastIndex=t},e.prototype.updateTokenEndLineColumnLocation=function(e,t,r,n,o,a,i){var u,s;void 0!==t&&(s=(u=r===i-1)?-1:0,1===n&&!0===u||(e.endLine=o+s,e.endColumn=a-1-s))},e.prototype.computeNewColumn=function(e,t){return e+t},e.prototype.createTokenInstance=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return null},e.prototype.createOffsetOnlyToken=function(e,t,r,n){return{image:e,startOffset:t,tokenTypeIdx:r,tokenType:n}},e.prototype.createStartOnlyToken=function(e,t,r,n,o,a){return{image:e,startOffset:t,startLine:o,startColumn:a,tokenTypeIdx:r,tokenType:n}},e.prototype.createFullToken=function(e,t,r,n,o,a,i){return{image:e,startOffset:t,endOffset:t+i-1,startLine:o,endLine:o,startColumn:a,endColumn:a+i-1,tokenTypeIdx:r,tokenType:n}},e.prototype.addToken=function(e,t,r){return 666},e.prototype.addTokenUsingPush=function(e,t,r){return e.push(r),t},e.prototype.addTokenUsingMemberAccess=function(e,t,r){return e[t]=r,++t},e.prototype.handlePayload=function(e,t){},e.prototype.handlePayloadNoCustom=function(e,t){},e.prototype.handlePayloadWithCustom=function(e,t){null!==t&&(e.payload=t)},e.prototype.match=function(e,t,r){return null},e.prototype.matchWithTest=function(e,t,r){return!0===e.test(t)?t.substring(r,e.lastIndex):null},e.prototype.matchWithExec=function(e,t){var r=e.exec(t);return null!==r?r[0]:r},e.prototype.TRACE_INIT=function(e,t){if(!0===this.traceInitPerf){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--\x3e <"+e+">");var n=Object(a.timer)(t),o=n.time,i=n.value,u=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&u(r+"<-- <"+e+"> time: "+o+"ms"),this.traceInitIndent--,i}return t()},e.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",e.NA=/NOT_APPLICABLE/,e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"DEFAULT_MODE",(function(){return f})),r.d(t,"MODES",(function(){return p})),r.d(t,"SUPPORT_STICKY",(function(){return h})),r.d(t,"disableSticky",(function(){return d})),r.d(t,"enableSticky",(function(){return m})),r.d(t,"analyzeTokenTypes",(function(){return y})),r.d(t,"validatePatterns",(function(){return g})),r.d(t,"findMissingPatterns",(function(){return v})),r.d(t,"findInvalidPatterns",(function(){return E})),r.d(t,"findEndOfInputAnchor",(function(){return b})),r.d(t,"findEmptyMatchRegExps",(function(){return R})),r.d(t,"findStartOfInputAnchor",(function(){return S})),r.d(t,"findUnsupportedFlags",(function(){return N})),r.d(t,"findDuplicatePatterns",(function(){return O})),r.d(t,"findInvalidGroupType",(function(){return C})),r.d(t,"findModesThatDoNotExist",(function(){return w})),r.d(t,"findUnreachablePatterns",(function(){return M})),r.d(t,"addStartOfInput",(function(){return I})),r.d(t,"addStickyFlag",(function(){return x})),r.d(t,"performRuntimeChecks",(function(){return k})),r.d(t,"performWarningRuntimeChecks",(function(){return _})),r.d(t,"cloneEmptyGroups",(function(){return P})),r.d(t,"isCustomPattern",(function(){return L})),r.d(t,"isShortPattern",(function(){return F})),r.d(t,"LineTerminatorOptimizedTester",(function(){return U})),r.d(t,"buildLineBreakIssueMessage",(function(){return D})),r.d(t,"minOptimizationVal",(function(){return G})),r.d(t,"charCodeToOptimizedIndex",(function(){return W}));var n,o=r(171),a=r(169),i=r(164),u=r(172),s=r(173),c=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),l="PATTERN",f="defaultMode",p="modes",h="boolean"==typeof new RegExp("(?:)").sticky;function d(){h=!1}function m(){h=!0}function y(e,t){var r,n=(t=Object(i.defaults)(t,{useSticky:h,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r","\n"],tracer:function(e,t){return t()}})).tracer;n("initCharCodeToOptimizedIndexMap",(function(){!function(){if(Object(i.isEmpty)(H)){H=new Array(65536);for(var e=0;e<65536;e++)H[e]=e>255?255+~~(e/255):e}}()})),n("Reject Lexer.NA",(function(){r=Object(i.reject)(e,(function(e){return e[l]===a.Lexer.NA}))}));var o,s,c,f,p,d,m,y,g,v,E,T=!1;n("Transform Patterns",(function(){T=!1,o=Object(i.map)(r,(function(e){var r=e[l];if(Object(i.isRegExp)(r)){var n=r.source;return 1===n.length&&"^"!==n&&"$"!==n&&"."!==n?n:2!==n.length||"\\"!==n[0]||Object(i.contains)(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],n[1])?t.useSticky?x(r):I(r):n[1]}if(Object(i.isFunction)(r))return T=!0,{exec:r};if(Object(i.has)(r,"exec"))return T=!0,r;if("string"==typeof r){if(1===r.length)return r;var o=r.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),a=new RegExp(o);return t.useSticky?x(a):I(a)}throw Error("non exhaustive match")}))})),n("misc mapping",(function(){s=Object(i.map)(r,(function(e){return e.tokenTypeIdx})),c=Object(i.map)(r,(function(e){var t=e.GROUP;if(t!==a.Lexer.SKIPPED){if(Object(i.isString)(t))return t;if(Object(i.isUndefined)(t))return!1;throw Error("non exhaustive match")}})),f=Object(i.map)(r,(function(e){var t=e.LONGER_ALT;if(t)return Object(i.indexOf)(r,t)})),p=Object(i.map)(r,(function(e){return e.PUSH_MODE})),d=Object(i.map)(r,(function(e){return Object(i.has)(e,"POP_MODE")}))})),n("Line Terminator Handling",(function(){var e=j(t.lineTerminatorCharacters);m=Object(i.map)(r,(function(e){return!1})),"onlyOffset"!==t.positionTracking&&(m=Object(i.map)(r,(function(t){return Object(i.has)(t,"LINE_BREAKS")?t.LINE_BREAKS:!1===V(t,e)?Object(u.canMatchCharCode)(e,t.PATTERN):void 0})))})),n("Misc Mapping #2",(function(){y=Object(i.map)(r,L),g=Object(i.map)(o,F),v=Object(i.reduce)(r,(function(e,t){var r=t.GROUP;return Object(i.isString)(r)&&r!==a.Lexer.SKIPPED&&(e[r]=[]),e}),{}),E=Object(i.map)(o,(function(e,t){return{pattern:o[t],longerAlt:f[t],canLineTerminator:m[t],isCustom:y[t],short:g[t],group:c[t],push:p[t],pop:d[t],tokenTypeIdx:s[t],tokenType:r[t]}}))}));var b=!0,R=[];return t.safeMode||n("First Char Optimization",(function(){R=Object(i.reduce)(r,(function(e,r,n){if("string"==typeof r.PATTERN){var o=W(r.PATTERN.charCodeAt(0));B(e,o,E[n])}else if(Object(i.isArray)(r.START_CHARS_HINT)){var a;Object(i.forEach)(r.START_CHARS_HINT,(function(t){var r=W("string"==typeof t?t.charCodeAt(0):t);a!==r&&(a=r,B(e,r,E[n]))}))}else if(Object(i.isRegExp)(r.PATTERN))if(r.PATTERN.unicode)b=!1,t.ensureOptimizations&&Object(i.PRINT_ERROR)(u.failedOptimizationPrefixMsg+"\tUnable to analyze < "+r.PATTERN.toString()+" > pattern.\n\tThe regexp unicode flag is not currently supported by the regexp-to-ast library.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE");else{var s=Object(u.getOptimizedStartCodesIndices)(r.PATTERN,t.ensureOptimizations);Object(i.isEmpty)(s)&&(b=!1),Object(i.forEach)(s,(function(t){B(e,t,E[n])}))}else t.ensureOptimizations&&Object(i.PRINT_ERROR)(u.failedOptimizationPrefixMsg+"\tTokenType: <"+r.name+"> is using a custom token pattern without providing <start_chars_hint> parameter.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE"),b=!1;return e}),[])})),n("ArrayPacking",(function(){R=Object(i.packArray)(R)})),{emptyGroups:v,patternIdxToConfig:E,charCodeToPatternIdxToConfig:R,hasCustom:T,canBeOptimized:b}}function g(e,t){var r=[],n=v(e);r=r.concat(n.errors);var o=E(n.valid),a=o.valid;return r=(r=(r=(r=(r=r.concat(o.errors)).concat(function(e){var t=[],r=Object(i.filter)(e,(function(e){return Object(i.isRegExp)(e[l])}));return t=(t=(t=(t=(t=t.concat(b(r))).concat(S(r))).concat(N(r))).concat(O(r))).concat(R(r))}(a))).concat(C(a))).concat(w(a,t))).concat(M(a))}function v(e){var t=Object(i.filter)(e,(function(e){return!Object(i.has)(e,l)}));return{errors:Object(i.map)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- missing static 'PATTERN' property",type:a.LexerDefinitionErrorType.MISSING_PATTERN,tokenTypes:[e]}})),valid:Object(i.difference)(e,t)}}function E(e){var t=Object(i.filter)(e,(function(e){var t=e[l];return!(Object(i.isRegExp)(t)||Object(i.isFunction)(t)||Object(i.has)(t,"exec")||Object(i.isString)(t))}));return{errors:Object(i.map)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:a.LexerDefinitionErrorType.INVALID_PATTERN,tokenTypes:[e]}})),valid:Object(i.difference)(e,t)}}var T=/[^\\][\$]/;function b(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.found=!1,t}return c(t,e),t.prototype.visitEndAnchor=function(e){this.found=!0},t}(o.BaseRegExpVisitor),r=Object(i.filter)(e,(function(e){var r=e[l];try{var n=Object(s.getRegExpAst)(r),o=new t;return o.visit(n),o.found}catch(e){return T.test(r.source)}}));return Object(i.map)(r,(function(e){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain end of input anchor '$'\n\tSee sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:a.LexerDefinitionErrorType.EOI_ANCHOR_FOUND,tokenTypes:[e]}}))}function R(e){var t=Object(i.filter)(e,(function(e){return e[l].test("")}));return Object(i.map)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' must not match an empty string",type:a.LexerDefinitionErrorType.EMPTY_MATCH_PATTERN,tokenTypes:[e]}}))}var A=/[^\\[][\^]|^\^/;function S(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.found=!1,t}return c(t,e),t.prototype.visitStartAnchor=function(e){this.found=!0},t}(o.BaseRegExpVisitor),r=Object(i.filter)(e,(function(e){var r=e[l];try{var n=Object(s.getRegExpAst)(r),o=new t;return o.visit(n),o.found}catch(e){return A.test(r.source)}}));return Object(i.map)(r,(function(e){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain start of input anchor '^'\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:a.LexerDefinitionErrorType.SOI_ANCHOR_FOUND,tokenTypes:[e]}}))}function N(e){var t=Object(i.filter)(e,(function(e){var t=e[l];return t instanceof RegExp&&(t.multiline||t.global)}));return Object(i.map)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:a.LexerDefinitionErrorType.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[e]}}))}function O(e){var t=[],r=Object(i.map)(e,(function(r){return Object(i.reduce)(e,(function(e,n){return r.PATTERN.source!==n.PATTERN.source||Object(i.contains)(t,n)||n.PATTERN===a.Lexer.NA||(t.push(n),e.push(n)),e}),[])}));r=Object(i.compact)(r);var n=Object(i.filter)(r,(function(e){return e.length>1}));return Object(i.map)(n,(function(e){var t=Object(i.map)(e,(function(e){return e.name}));return{message:"The same RegExp pattern ->"+Object(i.first)(e).PATTERN+"<-has been used in all of the following Token Types: "+t.join(", ")+" <-",type:a.LexerDefinitionErrorType.DUPLICATE_PATTERNS_FOUND,tokenTypes:e}}))}function C(e){var t=Object(i.filter)(e,(function(e){if(!Object(i.has)(e,"GROUP"))return!1;var t=e.GROUP;return t!==a.Lexer.SKIPPED&&t!==a.Lexer.NA&&!Object(i.isString)(t)}));return Object(i.map)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:a.LexerDefinitionErrorType.INVALID_GROUP_TYPE_FOUND,tokenTypes:[e]}}))}function w(e,t){var r=Object(i.filter)(e,(function(e){return void 0!==e.PUSH_MODE&&!Object(i.contains)(t,e.PUSH_MODE)}));return Object(i.map)(r,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+e.PUSH_MODE+"<-which does not exist",type:a.LexerDefinitionErrorType.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[e]}}))}function M(e){var t=[],r=Object(i.reduce)(e,(function(e,t,r){var n,o=t.PATTERN;return o===a.Lexer.NA||(Object(i.isString)(o)?e.push({str:o,idx:r,tokenType:t}):Object(i.isRegExp)(o)&&(n=o,void 0===Object(i.find)([".","\\","[","]","|","^","$","(",")","?","*","+","{"],(function(e){return-1!==n.source.indexOf(e)})))&&e.push({str:o.source,idx:r,tokenType:t})),e}),[]);return Object(i.forEach)(e,(function(e,n){Object(i.forEach)(r,(function(r){var o=r.str,u=r.idx,s=r.tokenType;if(n<u&&function(e,t){if(Object(i.isRegExp)(t)){var r=t.exec(e);return null!==r&&0===r.index}if(Object(i.isFunction)(t))return t(e,0,[],{});if(Object(i.has)(t,"exec"))return t.exec(e,0,[],{});if("string"==typeof t)return t===e;throw Error("non exhaustive match")}(o,e.PATTERN)){var c="Token: ->"+s.name+"<- can never be matched.\nBecause it appears AFTER the Token Type ->"+e.name+"<-in the lexer's definition.\nSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE";t.push({message:c,type:a.LexerDefinitionErrorType.UNREACHABLE_PATTERN,tokenTypes:[e,s]})}}))})),t}function I(e){var t=e.ignoreCase?"i":"";return new RegExp("^(?:"+e.source+")",t)}function x(e){var t=e.ignoreCase?"iy":"y";return new RegExp(""+e.source,t)}function k(e,t,r){var n=[];return Object(i.has)(e,f)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+f+"> property in its definition\n",type:a.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),Object(i.has)(e,p)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+p+"> property in its definition\n",type:a.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),Object(i.has)(e,p)&&Object(i.has)(e,f)&&!Object(i.has)(e.modes,e.defaultMode)&&n.push({message:"A MultiMode Lexer cannot be initialized with a "+f+": <"+e.defaultMode+">which does not exist\n",type:a.LexerDefinitionErrorType.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),Object(i.has)(e,p)&&Object(i.forEach)(e.modes,(function(e,t){Object(i.forEach)(e,(function(e,r){Object(i.isUndefined)(e)&&n.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:<"+t+"> at index: <"+r+">\n",type:a.LexerDefinitionErrorType.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})}))})),n}function _(e,t,r){var n=[],o=!1,s=Object(i.compact)(Object(i.flatten)(Object(i.mapValues)(e.modes,(function(e){return e})))),c=Object(i.reject)(s,(function(e){return e[l]===a.Lexer.NA})),f=j(r);return t&&Object(i.forEach)(c,(function(e){var t=V(e,f);if(!1!==t){var r={message:D(e,t),type:t.issue,tokenType:e};n.push(r)}else Object(i.has)(e,"LINE_BREAKS")?!0===e.LINE_BREAKS&&(o=!0):Object(u.canMatchCharCode)(f,e.PATTERN)&&(o=!0)})),t&&!o&&n.push({message:"Warning: No LINE_BREAKS Found.\n\tThis Lexer has been defined to track line and column information,\n\tBut none of the Token Types can be identified as matching a line terminator.\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS \n\tfor details.",type:a.LexerDefinitionErrorType.NO_LINE_BREAKS_FLAGS}),n}function P(e){var t={},r=Object(i.keys)(e);return Object(i.forEach)(r,(function(r){var n=e[r];if(!Object(i.isArray)(n))throw Error("non exhaustive match");t[r]=[]})),t}function L(e){var t=e.PATTERN;if(Object(i.isRegExp)(t))return!1;if(Object(i.isFunction)(t))return!0;if(Object(i.has)(t,"exec"))return!0;if(Object(i.isString)(t))return!1;throw Error("non exhaustive match")}function F(e){return!(!Object(i.isString)(e)||1!==e.length)&&e.charCodeAt(0)}var U={test:function(e){for(var t=e.length,r=this.lastIndex;r<t;r++){var n=e.charCodeAt(r);if(10===n)return this.lastIndex=r+1,!0;if(13===n)return 10===e.charCodeAt(r+1)?this.lastIndex=r+2:this.lastIndex=r+1,!0}return!1},lastIndex:0};function V(e,t){if(Object(i.has)(e,"LINE_BREAKS"))return!1;if(Object(i.isRegExp)(e.PATTERN)){try{Object(u.canMatchCharCode)(t,e.PATTERN)}catch(e){return{issue:a.LexerDefinitionErrorType.IDENTIFY_TERMINATOR,errMsg:e.message}}return!1}if(Object(i.isString)(e.PATTERN))return!1;if(L(e))return{issue:a.LexerDefinitionErrorType.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}function D(e,t){if(t.issue===a.LexerDefinitionErrorType.IDENTIFY_TERMINATOR)return"Warning: unable to identify line terminator usage in pattern.\n\tThe problem is in the <"+e.name+"> Token Type\n\t Root cause: "+t.errMsg+".\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(t.issue===a.LexerDefinitionErrorType.CUSTOM_LINE_BREAK)return"Warning: A Custom Token Pattern should specify the <line_breaks> option.\n\tThe problem is in the <"+e.name+"> Token Type\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}function j(e){return Object(i.map)(e,(function(e){return Object(i.isString)(e)&&e.length>0?e.charCodeAt(0):e}))}function B(e,t,r){void 0===e[t]?e[t]=[r]:e[t].push(r)}var G=256;function W(e){return e<G?e:H[e]}var H=[]},function(e,t,r){var n,o,a;"undefined"!=typeof self&&self,o=[],void 0===(a="function"==typeof(n=function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(e){this.idx=e.idx,this.input=e.input,this.groupIdx=e.groupIdx},e.prototype.pattern=function(e){this.idx=0,this.input=e,this.groupIdx=0,this.consumeChar("/");var t=this.disjunction();this.consumeChar("/");for(var r={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":u(r,"global");break;case"i":u(r,"ignoreCase");break;case"m":u(r,"multiLine");break;case"u":u(r,"unicode");break;case"y":u(r,"sticky")}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:r,value:t}},e.prototype.disjunction=function(){var e=[];for(e.push(this.alternative());"|"===this.peekChar();)this.consumeChar("|"),e.push(this.alternative());return{type:"Disjunction",value:e}},e.prototype.alternative=function(){for(var e=[];this.isTerm();)e.push(this.term());return{type:"Alternative",value:e}},e.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},e.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":var e;switch(this.consumeChar("?"),this.popChar()){case"=":e="Lookahead";break;case"!":e="NegativeLookahead"}s(e);var t=this.disjunction();return this.consumeChar(")"),{type:e,value:t}}!function(){throw Error("Internal Error - Should never get here!")}()},e.prototype.quantifier=function(e){var t;switch(this.popChar()){case"*":t={atLeast:0,atMost:1/0};break;case"+":t={atLeast:1,atMost:1/0};break;case"?":t={atLeast:0,atMost:1};break;case"{":var r=this.integerIncludingZero();switch(this.popChar()){case"}":t={atLeast:r,atMost:r};break;case",":t=this.isDigit()?{atLeast:r,atMost:this.integerIncludingZero()}:{atLeast:r,atMost:1/0},this.consumeChar("}")}if(!0===e&&void 0===t)return;s(t)}if(!0!==e||void 0!==t)return s(t),"?"===this.peekChar(0)?(this.consumeChar("?"),t.greedy=!1):t.greedy=!0,t.type="Quantifier",t},e.prototype.atom=function(){var e;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group()}return void 0===e&&this.isPatternCharacter()&&(e=this.patternCharacter()),s(e),this.isQuantifier()&&(e.quantifier=this.quantifier()),e},e.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[a("\n"),a("\r"),a("\u2028"),a("\u2029")]}},e.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){return{type:"GroupBackReference",value:this.positiveInteger()}},e.prototype.characterClassEscape=function(){var e,t=!1;switch(this.popChar()){case"d":e=c;break;case"D":e=c,t=!0;break;case"s":e=f;break;case"S":e=f,t=!0;break;case"w":e=l;break;case"W":e=l,t=!0}return s(e),{type:"Set",value:e,complement:t}},e.prototype.controlEscapeAtom=function(){var e;switch(this.popChar()){case"f":e=a("\f");break;case"n":e=a("\n");break;case"r":e=a("\r");break;case"t":e=a("\t");break;case"v":e=a("\v")}return s(e),{type:"Character",value:e}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var e=this.popChar();if(!1===/[a-zA-Z]/.test(e))throw Error("Invalid ");return{type:"Character",value:e.toUpperCase().charCodeAt(0)-64}},e.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:a("\0")}},e.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){return{type:"Character",value:a(this.popChar())}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case"\n":case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:return{type:"Character",value:a(this.popChar())}}},e.prototype.characterClass=function(){var e=[],t=!1;for(this.consumeChar("["),"^"===this.peekChar(0)&&(this.consumeChar("^"),t=!0);this.isClassAtom();){var r=this.classAtom();if("Character"===r.type&&this.isRangeDash()){this.consumeChar("-");var n=this.classAtom();if("Character"===n.type){if(n.value<r.value)throw Error("Range out of order in character class");e.push({from:r.value,to:n.value})}else i(r.value,e),e.push(a("-")),i(n.value,e)}else i(r.value,e)}return this.consumeChar("]"),{type:"Set",complement:t,value:e}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case"\n":case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:a("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var e=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),e=!1;break;default:this.groupIdx++}var t=this.disjunction();this.consumeChar(")");var r={type:"Group",capturing:e,value:t};return e&&(r.idx=this.groupIdx),r},e.prototype.positiveInteger=function(){var e=this.popChar();if(!1===o.test(e))throw Error("Expecting a positive integer");for(;n.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)},e.prototype.integerIncludingZero=function(){var e=this.popChar();if(!1===n.test(e))throw Error("Expecting an integer");for(;n.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)},e.prototype.patternCharacter=function(){var e=this.popChar();switch(e){case"\n":case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:a(e)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},e.prototype.isRangeDash=function(){return"-"===this.peekChar()&&this.isClassAtom(1)},e.prototype.isDigit=function(){return n.test(this.peekChar(0))},e.prototype.isClassAtom=function(e){switch(void 0===e&&(e=0),this.peekChar(e)){case"]":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return"?"===this.peekChar(1)&&("="===this.peekChar(2)||"!"===this.peekChar(2));default:return!1}},e.prototype.isQuantifier=function(){var e=this.saveState();try{return void 0!==this.quantifier(!0)}catch(e){return!1}finally{this.restoreState(e)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.parseHexDigits=function(e){for(var t="",n=0;n<e;n++){var o=this.popChar();if(!1===r.test(o))throw Error("Expecting a HexDecimal digits");t+=o}return{type:"Character",value:parseInt(t,16)}},e.prototype.peekChar=function(e){return void 0===e&&(e=0),this.input[this.idx+e]},e.prototype.popChar=function(){var e=this.peekChar(0);return this.consumeChar(),e},e.prototype.consumeChar=function(e){if(void 0!==e&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var t,r=/[0-9a-fA-F]/,n=/[0-9]/,o=/[1-9]/;function a(e){return e.charCodeAt(0)}function i(e,t){void 0!==e.length?e.forEach((function(e){t.push(e)})):t.push(e)}function u(e,t){if(!0===e[t])throw"duplicate flag "+t;e[t]=!0}function s(e){if(void 0===e)throw Error("Internal Error - Should never get here!")}var c=[];for(t=a("0");t<=a("9");t++)c.push(t);var l=[a("_")].concat(c);for(t=a("a");t<=a("z");t++)l.push(t);for(t=a("A");t<=a("Z");t++)l.push(t);var f=[a(" "),a("\f"),a("\n"),a("\r"),a("\t"),a("\v"),a("\t"),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a("\u2028"),a("\u2029"),a(" "),a(" "),a("　"),a("\ufeff")];function p(){}return p.prototype.visitChildren=function(e){for(var t in e){var r=e[t];e.hasOwnProperty(t)&&(void 0!==r.type?this.visit(r):Array.isArray(r)&&r.forEach((function(e){this.visit(e)}),this))}},p.prototype.visit=function(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"StartAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.visitQuantifier(e)}this.visitChildren(e)},p.prototype.visitPattern=function(e){},p.prototype.visitFlags=function(e){},p.prototype.visitDisjunction=function(e){},p.prototype.visitAlternative=function(e){},p.prototype.visitStartAnchor=function(e){},p.prototype.visitEndAnchor=function(e){},p.prototype.visitWordBoundary=function(e){},p.prototype.visitNonWordBoundary=function(e){},p.prototype.visitLookahead=function(e){},p.prototype.visitNegativeLookahead=function(e){},p.prototype.visitCharacter=function(e){},p.prototype.visitSet=function(e){},p.prototype.visitGroup=function(e){},p.prototype.visitGroupBackReference=function(e){},p.prototype.visitQuantifier=function(e){},{RegExpParser:e,BaseRegExpVisitor:p,VERSION:"0.4.0"}})?n.apply(t,o):n)||(e.exports=a)},function(e,t,r){"use strict";r.r(t),r.d(t,"failedOptimizationPrefixMsg",(function(){return c})),r.d(t,"getOptimizedStartCodesIndices",(function(){return l})),r.d(t,"firstCharOptimizedIndices",(function(){return f})),r.d(t,"canMatchCharCode",(function(){return y}));var n,o=r(171),a=r(164),i=r(173),u=r(170),s=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),c='Unable to use "first char" lexer optimizations:\n';function l(e,t){void 0===t&&(t=!1);try{var r=Object(i.getRegExpAst)(e);return f(r.value,{},r.flags.ignoreCase)}catch(r){if("Complement Sets are not supported for first char optimization"===r.message)t&&Object(a.PRINT_WARNING)(c+"\tUnable to optimize: < "+e.toString()+" >\n\tComplement Sets cannot be automatically optimized.\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.");else{var n="";t&&(n="\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details."),Object(a.PRINT_ERROR)(c+"\n\tFailed parsing: < "+e.toString()+" >\n\tUsing the regexp-to-ast library version: "+o.VERSION+"\n\tPlease open an issue at: https://github.com/bd82/regexp-to-ast/issues"+n)}}return[]}function f(e,t,r){switch(e.type){case"Disjunction":for(var n=0;n<e.value.length;n++)f(e.value[n],t,r);break;case"Alternative":var o=e.value;for(n=0;n<o.length;n++){var i=o[n];switch(i.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var s=i;switch(s.type){case"Character":p(s.value,t,r);break;case"Set":if(!0===s.complement)throw Error("Complement Sets are not supported for first char optimization");Object(a.forEach)(s.value,(function(e){if("number"==typeof e)p(e,t,r);else{var n=e;if(!0===r)for(var o=n.from;o<=n.to;o++)p(o,t,r);else{for(o=n.from;o<=n.to&&o<u.minOptimizationVal;o++)p(o,t,r);if(n.to>=u.minOptimizationVal)for(var a=n.from>=u.minOptimizationVal?n.from:u.minOptimizationVal,i=n.to,s=Object(u.charCodeToOptimizedIndex)(a),c=Object(u.charCodeToOptimizedIndex)(i),l=s;l<=c;l++)t[l]=l}}}));break;case"Group":f(s.value,t,r);break;default:throw Error("Non Exhaustive Match")}var c=void 0!==s.quantifier&&0===s.quantifier.atLeast;if("Group"===s.type&&!1===d(s)||"Group"!==s.type&&!1===c)break}break;default:throw Error("non exhaustive match!")}return Object(a.values)(t)}function p(e,t,r){var n=Object(u.charCodeToOptimizedIndex)(e);t[n]=n,!0===r&&function(e,t){var r=String.fromCharCode(e),n=r.toUpperCase();if(n!==r){var o=Object(u.charCodeToOptimizedIndex)(n.charCodeAt(0));t[o]=o}else{var a=r.toLowerCase();a!==r&&(o=Object(u.charCodeToOptimizedIndex)(a.charCodeAt(0)),t[o]=o)}}(e,t)}function h(e,t){return Object(a.find)(e.value,(function(e){if("number"==typeof e)return Object(a.contains)(t,e);var r=e;return void 0!==Object(a.find)(t,(function(e){return r.from<=e&&e<=r.to}))}))}function d(e){return!(!e.quantifier||0!==e.quantifier.atLeast)||!!e.value&&(Object(a.isArray)(e.value)?Object(a.every)(e.value,d):d(e.value))}var m=function(e){function t(t){var r=e.call(this)||this;return r.targetCharCodes=t,r.found=!1,r}return s(t,e),t.prototype.visitChildren=function(t){if(!0!==this.found){switch(t.type){case"Lookahead":return void this.visitLookahead(t);case"NegativeLookahead":return void this.visitNegativeLookahead(t)}e.prototype.visitChildren.call(this,t)}},t.prototype.visitCharacter=function(e){Object(a.contains)(this.targetCharCodes,e.value)&&(this.found=!0)},t.prototype.visitSet=function(e){e.complement?void 0===h(e,this.targetCharCodes)&&(this.found=!0):void 0!==h(e,this.targetCharCodes)&&(this.found=!0)},t}(o.BaseRegExpVisitor);function y(e,t){if(t instanceof RegExp){var r=Object(i.getRegExpAst)(t),n=new m(e);return n.visit(r),n.found}return void 0!==Object(a.find)(t,(function(t){return Object(a.contains)(e,t.charCodeAt(0))}))}},function(e,t,r){"use strict";r.r(t),r.d(t,"getRegExpAst",(function(){return i})),r.d(t,"clearRegExpParserCache",(function(){return u}));var n=r(171),o={},a=new n.RegExpParser;function i(e){var t=e.toString();if(o.hasOwnProperty(t))return o[t];var r=a.pattern(t);return o[t]=r,r}function u(){o={}}},function(e,t,r){"use strict";r.r(t),r.d(t,"tokenStructuredMatcher",(function(){return o})),r.d(t,"tokenStructuredMatcherNoCategories",(function(){return a})),r.d(t,"tokenShortNameIdx",(function(){return i})),r.d(t,"tokenIdxToClass",(function(){return u})),r.d(t,"augmentTokenTypes",(function(){return s})),r.d(t,"expandCategories",(function(){return c})),r.d(t,"assignTokenDefaultProps",(function(){return l})),r.d(t,"assignCategoriesTokensProp",(function(){return f})),r.d(t,"assignCategoriesMapProp",(function(){return p})),r.d(t,"singleAssignCategoriesToksMap",(function(){return h})),r.d(t,"hasShortKeyProperty",(function(){return d})),r.d(t,"hasCategoriesProperty",(function(){return m})),r.d(t,"hasExtendingTokensTypesProperty",(function(){return y})),r.d(t,"hasExtendingTokensTypesMapProperty",(function(){return g})),r.d(t,"isTokenType",(function(){return v}));var n=r(164);function o(e,t){var r=e.tokenTypeIdx;return r===t.tokenTypeIdx||!0===t.isParent&&!0===t.categoryMatchesMap[r]}function a(e,t){return e.tokenTypeIdx===t.tokenTypeIdx}var i=1,u={};function s(e){var t=c(e);l(t),p(t),f(t),Object(n.forEach)(t,(function(e){e.isParent=e.categoryMatches.length>0}))}function c(e){for(var t=Object(n.cloneArr)(e),r=e,o=!0;o;){r=Object(n.compact)(Object(n.flatten)(Object(n.map)(r,(function(e){return e.CATEGORIES}))));var a=Object(n.difference)(r,t);t=t.concat(a),Object(n.isEmpty)(a)?o=!1:r=a}return t}function l(e){Object(n.forEach)(e,(function(e){d(e)||(u[i]=e,e.tokenTypeIdx=i++),m(e)&&!Object(n.isArray)(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),m(e)||(e.CATEGORIES=[]),y(e)||(e.categoryMatches=[]),g(e)||(e.categoryMatchesMap={})}))}function f(e){Object(n.forEach)(e,(function(e){e.categoryMatches=[],Object(n.forEach)(e.categoryMatchesMap,(function(t,r){e.categoryMatches.push(u[r].tokenTypeIdx)}))}))}function p(e){Object(n.forEach)(e,(function(e){h([],e)}))}function h(e,t){Object(n.forEach)(e,(function(e){t.categoryMatchesMap[e.tokenTypeIdx]=!0})),Object(n.forEach)(t.CATEGORIES,(function(r){var o=e.concat(t);Object(n.contains)(o,r)||h(o,r)}))}function d(e){return Object(n.has)(e,"tokenTypeIdx")}function m(e){return Object(n.has)(e,"CATEGORIES")}function y(e){return Object(n.has)(e,"categoryMatches")}function g(e){return Object(n.has)(e,"categoryMatchesMap")}function v(e){return Object(n.has)(e,"tokenTypeIdx")}},function(e,t,r){"use strict";r.r(t),r.d(t,"defaultLexerErrorProvider",(function(){return n}));var n={buildUnableToPopLexerModeMessage:function(e){return"Unable to pop Lexer Mode after encountering Token ->"+e.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(e,t,r,n,o){return"unexpected character: ->"+e.charAt(t)+"<- at offset: "+t+", skipped "+r+" characters."}}},function(e,t,r){"use strict";r.r(t),r.d(t,"first",(function(){return i})),r.d(t,"firstForSequence",(function(){return u})),r.d(t,"firstForBranching",(function(){return s})),r.d(t,"firstForTerminal",(function(){return c}));var n=r(164),o=r(167),a=r(177);function i(e){if(e instanceof o.NonTerminal)return i(e.referencedRule);if(e instanceof o.Terminal)return c(e);if(Object(a.isSequenceProd)(e))return u(e);if(Object(a.isBranchingProd)(e))return s(e);throw Error("non exhaustive match")}function u(e){for(var t,r=[],o=e.definition,u=0,s=o.length>u,c=!0;s&&c;)t=o[u],c=Object(a.isOptionalProd)(t),r=r.concat(i(t)),u+=1,s=o.length>u;return Object(n.uniq)(r)}function s(e){var t=Object(n.map)(e.definition,(function(e){return i(e)}));return Object(n.uniq)(Object(n.flatten)(t))}function c(e){return[e.terminalType]}},function(e,t,r){"use strict";r.r(t),r.d(t,"isSequenceProd",(function(){return s})),r.d(t,"isOptionalProd",(function(){return c})),r.d(t,"isBranchingProd",(function(){return l})),r.d(t,"getProductionDslName",(function(){return f})),r.d(t,"DslMethodsCollectorVisitor",(function(){return p})),r.d(t,"collectMethods",(function(){return d}));var n,o=r(164),a=r(167),i=r(178),u=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function s(e){return e instanceof a.Flat||e instanceof a.Option||e instanceof a.Repetition||e instanceof a.RepetitionMandatory||e instanceof a.RepetitionMandatoryWithSeparator||e instanceof a.RepetitionWithSeparator||e instanceof a.Terminal||e instanceof a.Rule}function c(e,t){return void 0===t&&(t=[]),!!(e instanceof a.Option||e instanceof a.Repetition||e instanceof a.RepetitionWithSeparator)||(e instanceof a.Alternation?Object(o.some)(e.definition,(function(e){return c(e,t)})):!(e instanceof a.NonTerminal&&Object(o.contains)(t,e))&&e instanceof a.AbstractProduction&&(e instanceof a.NonTerminal&&t.push(e),Object(o.every)(e.definition,(function(e){return c(e,t)}))))}function l(e){return e instanceof a.Alternation}function f(e){if(e instanceof a.NonTerminal)return"SUBRULE";if(e instanceof a.Option)return"OPTION";if(e instanceof a.Alternation)return"OR";if(e instanceof a.RepetitionMandatory)return"AT_LEAST_ONE";if(e instanceof a.RepetitionMandatoryWithSeparator)return"AT_LEAST_ONE_SEP";if(e instanceof a.RepetitionWithSeparator)return"MANY_SEP";if(e instanceof a.Repetition)return"MANY";if(e instanceof a.Terminal)return"CONSUME";throw Error("non exhaustive match")}var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.separator="-",t.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},t}return u(t,e),t.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},t.prototype.visitTerminal=function(e){var t=e.terminalType.name+this.separator+"Terminal";Object(o.has)(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},t.prototype.visitNonTerminal=function(e){var t=e.nonTerminalName+this.separator+"Terminal";Object(o.has)(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},t.prototype.visitOption=function(e){this.dslMethods.option.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.dslMethods.repetitionWithSeparator.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.dslMethods.repetitionMandatory.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)},t.prototype.visitRepetition=function(e){this.dslMethods.repetition.push(e)},t.prototype.visitAlternation=function(e){this.dslMethods.alternation.push(e)},t}(i.GAstVisitor),h=new p;function d(e){h.reset(),e.accept(h);var t=h.dslMethods;return h.reset(),t}},function(e,t,r){"use strict";r.r(t),r.d(t,"GAstVisitor",(function(){return o}));var n=r(167),o=function(){function e(){}return e.prototype.visit=function(e){var t=e;switch(t.constructor){case n.NonTerminal:return this.visitNonTerminal(t);case n.Flat:return this.visitFlat(t);case n.Option:return this.visitOption(t);case n.RepetitionMandatory:return this.visitRepetitionMandatory(t);case n.RepetitionMandatoryWithSeparator:return this.visitRepetitionMandatoryWithSeparator(t);case n.RepetitionWithSeparator:return this.visitRepetitionWithSeparator(t);case n.Repetition:return this.visitRepetition(t);case n.Alternation:return this.visitAlternation(t);case n.Terminal:return this.visitTerminal(t);case n.Rule:return this.visitRule(t);default:throw Error("non exhaustive match")}},e.prototype.visitNonTerminal=function(e){},e.prototype.visitFlat=function(e){},e.prototype.visitOption=function(e){},e.prototype.visitRepetition=function(e){},e.prototype.visitRepetitionMandatory=function(e){},e.prototype.visitRepetitionMandatoryWithSeparator=function(e){},e.prototype.visitRepetitionWithSeparator=function(e){},e.prototype.visitAlternation=function(e){},e.prototype.visitTerminal=function(e){},e.prototype.visitRule=function(e){},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"IN",(function(){return n}));var n="_~IN~_"},function(e,t,r){"use strict";r.r(t),r.d(t,"setNodeLocationOnlyOffset",(function(){return c})),r.d(t,"setNodeLocationFull",(function(){return l})),r.d(t,"addTerminalToCst",(function(){return f})),r.d(t,"addNoneTerminalToCst",(function(){return p})),r.d(t,"NamedDSLMethodsCollectorVisitor",(function(){return h})),r.d(t,"expandAllNestedRuleNames",(function(){return d}));var n,o=r(164),a=r(181),i=r(167),u=r(178),s=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function c(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.endOffset=t.endOffset):e.endOffset<t.endOffset==1&&(e.endOffset=t.endOffset)}function l(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.startColumn=t.startColumn,e.startLine=t.startLine,e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine):e.endOffset<t.endOffset==1&&(e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine)}function f(e,t,r){void 0===e.children[r]?e.children[r]=[t]:e.children[r].push(t)}function p(e,t,r){void 0===e.children[t]?e.children[t]=[r]:e.children[t].push(r)}var h=function(e){function t(t){var r=e.call(this)||this;return r.result=[],r.ruleIdx=t,r}return s(t,e),t.prototype.collectNamedDSLMethod=function(e,t,r){if(!Object(o.isUndefined)(e.name)){var n=void 0;if(e instanceof i.Option||e instanceof i.Repetition||e instanceof i.RepetitionMandatory||e instanceof i.Alternation)n=new t({definition:e.definition,idx:e.idx});else{if(!(e instanceof i.RepetitionMandatoryWithSeparator||e instanceof i.RepetitionWithSeparator))throw Error("non exhaustive match");n=new t({definition:e.definition,idx:e.idx,separator:e.separator})}var u=[n],s=Object(a.getKeyForAutomaticLookahead)(this.ruleIdx,r,e.idx);this.result.push({def:u,key:s,name:e.name,orgProd:e})}},t.prototype.visitOption=function(e){this.collectNamedDSLMethod(e,i.Option,a.OPTION_IDX)},t.prototype.visitRepetition=function(e){this.collectNamedDSLMethod(e,i.Repetition,a.MANY_IDX)},t.prototype.visitRepetitionMandatory=function(e){this.collectNamedDSLMethod(e,i.RepetitionMandatory,a.AT_LEAST_ONE_IDX)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.collectNamedDSLMethod(e,i.RepetitionMandatoryWithSeparator,a.AT_LEAST_ONE_SEP_IDX)},t.prototype.visitRepetitionWithSeparator=function(e){this.collectNamedDSLMethod(e,i.RepetitionWithSeparator,a.MANY_SEP_IDX)},t.prototype.visitAlternation=function(e){var t=this;this.collectNamedDSLMethod(e,i.Alternation,a.OR_IDX);var r=e.definition.length>1;Object(o.forEach)(e.definition,(function(n,u){if(!Object(o.isUndefined)(n.name)){var s=n.definition;s=r?[new i.Option({definition:n.definition})]:n.definition;var c=Object(a.getKeyForAltIndex)(t.ruleIdx,a.OR_IDX,e.idx,u);t.result.push({def:s,key:c,name:n.name,orgProd:n})}}))},t}(u.GAstVisitor);function d(e,t){var r={allRuleNames:[]};return Object(o.forEach)(e,(function(e){var n=t[e.name];r.allRuleNames.push(e.name);var a=new h(n);e.accept(a),Object(o.forEach)(a.result,(function(t){t.def,t.key;var n=t.name;r.allRuleNames.push(e.name+n)}))})),r}},function(e,t,r){"use strict";r.r(t),r.d(t,"BITS_FOR_METHOD_TYPE",(function(){return n})),r.d(t,"BITS_FOR_OCCURRENCE_IDX",(function(){return o})),r.d(t,"BITS_FOR_RULE_IDX",(function(){return a})),r.d(t,"BITS_FOR_ALT_IDX",(function(){return i})),r.d(t,"OR_IDX",(function(){return u})),r.d(t,"OPTION_IDX",(function(){return s})),r.d(t,"MANY_IDX",(function(){return c})),r.d(t,"AT_LEAST_ONE_IDX",(function(){return l})),r.d(t,"MANY_SEP_IDX",(function(){return f})),r.d(t,"AT_LEAST_ONE_SEP_IDX",(function(){return p})),r.d(t,"getKeyForAutomaticLookahead",(function(){return h})),r.d(t,"getKeyForAltIndex",(function(){return m}));var n=4,o=8,a=12,i=8,u=1<<o,s=2<<o,c=3<<o,l=4<<o,f=5<<o,p=6<<o;function h(e,t,r){return r|t|e}var d=32-i;function m(e,t,r,n){var o=n+1<<d;return h(e,t,r)|o}},function(e,t,r){"use strict";r.r(t),r.d(t,"defaultParserErrorProvider",(function(){return s})),r.d(t,"defaultGrammarResolverErrorProvider",(function(){return c})),r.d(t,"defaultGrammarValidatorErrorProvider",(function(){return l}));var n=r(168),o=r(164),a=r(167),i=r(177),u=r(183),s={buildMismatchTokenMessage:function(e){var t=e.expected,r=e.actual;return e.previous,e.ruleName,"Expecting "+(Object(n.hasTokenLabel)(t)?"--\x3e "+Object(n.tokenLabel)(t)+" <--":"token of type --\x3e "+t.name+" <--")+" but found --\x3e '"+r.image+"' <--"},buildNotAllInputParsedMessage:function(e){var t=e.firstRedundant;return e.ruleName,"Redundant input, expecting EOF but found: "+t.image},buildNoViableAltMessage:function(e){var t=e.expectedPathsPerAlt,r=e.actual,a=(e.previous,e.customUserDescription),i=(e.ruleName,"\nbut found: '"+Object(o.first)(r).image+"'");if(a)return"Expecting: "+a+i;var u=Object(o.reduce)(t,(function(e,t){return e.concat(t)}),[]),s=Object(o.map)(u,(function(e){return"["+Object(o.map)(e,(function(e){return Object(n.tokenLabel)(e)})).join(", ")+"]"}));return"Expecting: one of these possible Token sequences:\n"+Object(o.map)(s,(function(e,t){return"  "+(t+1)+". "+e})).join("\n")+i},buildEarlyExitMessage:function(e){var t=e.expectedIterationPaths,r=e.actual,a=e.customUserDescription,i=(e.ruleName,"\nbut found: '"+Object(o.first)(r).image+"'");return a?"Expecting: "+a+i:"Expecting: expecting at least one iteration which starts with one of these possible Token sequences::\n  <"+Object(o.map)(t,(function(e){return"["+Object(o.map)(e,(function(e){return Object(n.tokenLabel)(e)})).join(",")+"]"})).join(" ,")+">"+i}};Object.freeze(s);var c={buildRuleNotFoundError:function(e,t){return"Invalid grammar, reference to a rule which is not defined: ->"+t.nonTerminalName+"<-\ninside top level rule: ->"+e.name+"<-"}},l={buildDuplicateFoundError:function(e,t){var r,n=e.name,u=Object(o.first)(t),s=u.idx,c=Object(i.getProductionDslName)(u),l=(r=u)instanceof a.Terminal?r.terminalType.name:r instanceof a.NonTerminal?r.nonTerminalName:"",f="->"+c+(s>0?s:"")+"<- "+(l?"with argument: ->"+l+"<-":"")+"\n                  appears more than once ("+t.length+" times) in the top level rule: ->"+n+"<-.                  \n                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES \n                  ";return f=(f=f.replace(/[ \t]+/g," ")).replace(/\s\s+/g,"\n")},buildInvalidNestedRuleNameError:function(e,t){return"Invalid nested rule name: ->"+t.name+"<- inside rule: ->"+e.name+"<-\nit must match the pattern: ->"+u.validNestedRuleName.toString()+"<-.\nNote that this means a nested rule name must start with the '$'(dollar) sign."},buildDuplicateNestedRuleNameError:function(e,t){return"Duplicate nested rule name: ->"+Object(o.first)(t).name+"<- inside rule: ->"+e.name+"<-\nA nested name must be unique in the scope of a top level grammar rule."},buildNamespaceConflictError:function(e){return"Namespace conflict found in grammar.\nThe grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+e.name+">.\nTo resolve this make sure each Terminal and Non-Terminal names are unique\nThis is easy to accomplish by using the convention that Terminal names start with an uppercase letter\nand Non-Terminal names start with a lower case letter."},buildAlternationPrefixAmbiguityError:function(e){var t=Object(o.map)(e.prefixPath,(function(e){return Object(n.tokenLabel)(e)})).join(", "),r=0===e.alternation.idx?"":e.alternation.idx;return"Ambiguous alternatives: <"+e.ambiguityIndices.join(" ,")+"> due to common lookahead prefix\nin <OR"+r+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\nSee: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX\nFor Further details."},buildAlternationAmbiguityError:function(e){var t=Object(o.map)(e.prefixPath,(function(e){return Object(n.tokenLabel)(e)})).join(", "),r=0===e.alternation.idx?"":e.alternation.idx,a="Ambiguous Alternatives Detected: <"+e.ambiguityIndices.join(" ,")+"> in <OR"+r+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\n";return a+="See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES\nFor Further details."},buildEmptyRepetitionError:function(e){var t=Object(i.getProductionDslName)(e.repetition);return 0!==e.repetition.idx&&(t+=e.repetition.idx),"The repetition <"+t+"> within Rule <"+e.topLevelRule.name+"> can never consume any tokens.\nThis could lead to an infinite loop."},buildTokenNameError:function(e){return"Invalid Grammar Token name: ->"+e.tokenType.name+"<- it must match the pattern: ->"+e.expectedPattern.toString()+"<-"},buildEmptyAlternationError:function(e){return"Ambiguous empty alternative: <"+(e.emptyChoiceIdx+1)+"> in <OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\nOnly the last alternative may be an empty alternative."},buildTooManyAlternativesError:function(e){return"An Alternation cannot have more than 256 alternatives:\n<OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\n has "+(e.alternation.definition.length+1)+" alternatives."},buildLeftRecursionError:function(e){var t=e.topLevelRule.name;return"Left Recursion found in grammar.\nrule: <"+t+"> can be invoked from itself (directly or indirectly)\nwithout consuming any Tokens. The grammar path that causes this is: \n "+t+" --\x3e "+o.map(e.leftRecursionPath,(function(e){return e.name})).concat([t]).join(" --\x3e ")+"\n To fix this refactor your grammar to remove the left recursion.\nsee: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring."},buildInvalidRuleNameError:function(e){return"Invalid grammar rule name: ->"+e.topLevelRule.name+"<- it must match the pattern: ->"+e.expectedPattern.toString()+"<-"},buildDuplicateRuleNameError:function(e){return"Duplicate definition, rule: ->"+(e.topLevelRule instanceof a.Rule?e.topLevelRule.name:e.topLevelRule)+"<- is already defined in the grammar: ->"+e.grammarName+"<-"}}},function(e,t,r){"use strict";r.r(t),r.d(t,"validateGrammar",(function(){return h})),r.d(t,"identifyProductionForDuplicates",(function(){return d})),r.d(t,"OccurrenceValidationCollector",(function(){return y})),r.d(t,"validTermsPattern",(function(){return g})),r.d(t,"validNestedRuleName",(function(){return v})),r.d(t,"validateRuleName",(function(){return E})),r.d(t,"validateNestedRuleName",(function(){return T})),r.d(t,"validateTokenName",(function(){return b})),r.d(t,"validateRuleDoesNotAlreadyExist",(function(){return R})),r.d(t,"validateRuleIsOverridden",(function(){return A})),r.d(t,"validateNoLeftRecursion",(function(){return S})),r.d(t,"getFirstNoneTerminal",(function(){return N})),r.d(t,"validateEmptyOrAlternative",(function(){return C})),r.d(t,"validateAmbiguousAlternationAlternatives",(function(){return w})),r.d(t,"RepetionCollector",(function(){return M})),r.d(t,"validateTooManyAlts",(function(){return I})),r.d(t,"validateSomeNonEmptyLookaheadPath",(function(){return x})),r.d(t,"checkPrefixAlternativesAmbiguities",(function(){return k}));var n,o=r(164),a=r(163),i=r(177),u=r(184),s=r(180),c=r(185),l=r(167),f=r(178),p=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function h(e,t,r,n,u,c){var l=o.map(e,(function(e){return function(e,t){var r=new y;e.accept(r);var n=r.allProductions,u=o.groupBy(n,d),s=o.pick(u,(function(e){return e.length>1}));return o.map(o.values(s),(function(r){var n=o.first(r),u=t.buildDuplicateFoundError(e,r),s=Object(i.getProductionDslName)(n),c={message:u,type:a.ParserDefinitionErrorType.DUPLICATE_PRODUCTIONS,ruleName:e.name,dslName:s,occurrence:n.idx},l=m(n);return l&&(c.parameter=l),c}))}(e,u)})),f=o.map(e,(function(e){return S(e,e,u)})),p=[],h=[],g=[];Object(o.every)(f,o.isEmpty)&&(p=Object(o.map)(e,(function(e){return C(e,u)})),h=Object(o.map)(e,(function(e){return w(e,t,n,u)})),g=x(e,t,u));var v=function(e,t,r){var n=[],i=Object(o.map)(t,(function(e){return e.name}));return Object(o.forEach)(e,(function(e){var t=e.name;if(Object(o.contains)(i,t)){var u=r.buildNamespaceConflictError(e);n.push({message:u,type:a.ParserDefinitionErrorType.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:t})}})),n}(e,r,u),A=o.map(r,(function(e){return b(e,u)})),N=function(e,t){var r=[];return Object(o.forEach)(e,(function(e){var n=new s.NamedDSLMethodsCollectorVisitor("");e.accept(n);var a=Object(o.map)(n.result,(function(e){return e.orgProd}));r.push(Object(o.map)(a,(function(r){return T(e,r,t)})))})),Object(o.flatten)(r)}(e,u),O=function(e,t){var r=[];return Object(o.forEach)(e,(function(e){var n=new s.NamedDSLMethodsCollectorVisitor("");e.accept(n);var i=Object(o.groupBy)(n.result,(function(e){return e.name})),u=Object(o.pick)(i,(function(e){return e.length>1}));Object(o.forEach)(Object(o.values)(u),(function(n){var i=Object(o.map)(n,(function(e){return e.orgProd})),u=t.buildDuplicateNestedRuleNameError(e,i);r.push({message:u,type:a.ParserDefinitionErrorType.DUPLICATE_NESTED_NAME,ruleName:e.name})}))})),r}(e,u),M=Object(o.map)(e,(function(e){return I(e,u)})),k=Object(o.map)(e,(function(e){return E(e,u)})),_=Object(o.map)(e,(function(t){return R(t,e,c,u)}));return o.flatten(l.concat(A,N,O,g,f,p,h,v,M,k,_))}function d(e){return Object(i.getProductionDslName)(e)+"_#_"+e.idx+"_#_"+m(e)}function m(e){return e instanceof l.Terminal?e.terminalType.name:e instanceof l.NonTerminal?e.nonTerminalName:""}var y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allProductions=[],t}return p(t,e),t.prototype.visitNonTerminal=function(e){this.allProductions.push(e)},t.prototype.visitOption=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t.prototype.visitAlternation=function(e){this.allProductions.push(e)},t.prototype.visitTerminal=function(e){this.allProductions.push(e)},t}(f.GAstVisitor),g=/^[a-zA-Z_]\w*$/,v=new RegExp(g.source.replace("^","^\\$"));function E(e,t){var r=[],n=e.name;return n.match(g)||r.push({message:t.buildInvalidRuleNameError({topLevelRule:e,expectedPattern:g}),type:a.ParserDefinitionErrorType.INVALID_RULE_NAME,ruleName:n}),r}function T(e,t,r){var n,o=[];return t.name.match(v)||(n=r.buildInvalidNestedRuleNameError(e,t),o.push({message:n,type:a.ParserDefinitionErrorType.INVALID_NESTED_RULE_NAME,ruleName:e.name})),o}function b(e,t){var r=[];return e.name.match(g)||r.push({message:t.buildTokenNameError({tokenType:e,expectedPattern:g}),type:a.ParserDefinitionErrorType.INVALID_TOKEN_NAME}),r}function R(e,t,r,n){var i=[];if(Object(o.reduce)(t,(function(t,r){return r.name===e.name?t+1:t}),0)>1){var u=n.buildDuplicateRuleNameError({topLevelRule:e,grammarName:r});i.push({message:u,type:a.ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:e.name})}return i}function A(e,t,r){var n,i=[];return o.contains(t,e)||(n="Invalid rule override, rule: ->"+e+"<- cannot be overridden in the grammar: ->"+r+"<-as it is not defined in any of the super grammars ",i.push({message:n,type:a.ParserDefinitionErrorType.INVALID_RULE_OVERRIDE,ruleName:e})),i}function S(e,t,r,n){void 0===n&&(n=[]);var i=[],u=N(t.definition);if(o.isEmpty(u))return[];var s=e.name;o.contains(u,e)&&i.push({message:r.buildLeftRecursionError({topLevelRule:e,leftRecursionPath:n}),type:a.ParserDefinitionErrorType.LEFT_RECURSION,ruleName:s});var c=o.difference(u,n.concat([e])),l=o.map(c,(function(t){var a=o.cloneArr(n);return a.push(t),S(e,t,r,a)}));return i.concat(o.flatten(l))}function N(e){var t=[];if(o.isEmpty(e))return t;var r=o.first(e);if(r instanceof l.NonTerminal)t.push(r.referencedRule);else if(r instanceof l.Flat||r instanceof l.Option||r instanceof l.RepetitionMandatory||r instanceof l.RepetitionMandatoryWithSeparator||r instanceof l.RepetitionWithSeparator||r instanceof l.Repetition)t=t.concat(N(r.definition));else if(r instanceof l.Alternation)t=o.flatten(o.map(r.definition,(function(e){return N(e.definition)})));else if(!(r instanceof l.Terminal))throw Error("non exhaustive match");var n=Object(i.isOptionalProd)(r),a=e.length>1;if(n&&a){var u=o.drop(e);return t.concat(N(u))}return t}var O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.alternations=[],t}return p(t,e),t.prototype.visitAlternation=function(e){this.alternations.push(e)},t}(f.GAstVisitor);function C(e,t){var r=new O;e.accept(r);var n=r.alternations;return o.reduce(n,(function(r,n){var i=o.dropRight(n.definition),u=o.map(i,(function(r,i){var u=Object(c.nextPossibleTokensAfter)([r],[],null,1);return o.isEmpty(u)?{message:t.buildEmptyAlternationError({topLevelRule:e,alternation:n,emptyChoiceIdx:i}),type:a.ParserDefinitionErrorType.NONE_LAST_EMPTY_ALT,ruleName:e.name,occurrence:n.idx,alternative:i+1}:null}));return r.concat(o.compact(u))}),[])}function w(e,t,r,n){var s=new O;e.accept(s);var c=s.alternations,l=r[e.name];return l&&(c=Object(o.reject)(c,(function(e){return l[Object(i.getProductionDslName)(e)+(0===e.idx?"":e.idx)]}))),c=Object(o.reject)(c,(function(e){return!0===e.ignoreAmbiguities})),o.reduce(c,(function(r,i){var s=i.idx,c=i.maxLookahead||t,l=Object(u.getLookaheadPathsForOr)(s,e,c,i),f=function(e,t,r,n){var i=[],s=Object(o.reduce)(e,(function(r,n,a){return!0===t.definition[a].ignoreAmbiguities||Object(o.forEach)(n,(function(n){var s=[a];Object(o.forEach)(e,(function(e,r){a!==r&&Object(u.containsPath)(e,n)&&!0!==t.definition[r].ignoreAmbiguities&&s.push(r)})),s.length>1&&!Object(u.containsPath)(i,n)&&(i.push(n),r.push({alts:s,path:n}))})),r}),[]);return o.map(s,(function(e){var i=Object(o.map)(e.alts,(function(e){return e+1}));return{message:n.buildAlternationAmbiguityError({topLevelRule:r,alternation:t,ambiguityIndices:i,prefixPath:e.path}),type:a.ParserDefinitionErrorType.AMBIGUOUS_ALTS,ruleName:r.name,occurrence:t.idx,alternatives:[e.alts]}}))}(l,i,e,n),p=k(l,i,e,n);return r.concat(f,p)}),[])}var M=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allProductions=[],t}return p(t,e),t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t}(f.GAstVisitor);function I(e,t){var r=new O;e.accept(r);var n=r.alternations;return o.reduce(n,(function(r,n){return n.definition.length>255&&r.push({message:t.buildTooManyAlternativesError({topLevelRule:e,alternation:n}),type:a.ParserDefinitionErrorType.TOO_MANY_ALTS,ruleName:e.name,occurrence:n.idx}),r}),[])}function x(e,t,r){var n=[];return Object(o.forEach)(e,(function(e){var i=new M;e.accept(i);var s=i.allProductions;Object(o.forEach)(s,(function(i){var s=Object(u.getProdType)(i),c=i.maxLookahead||t,l=i.idx,f=Object(u.getLookaheadPathsForOptionalProd)(l,e,s,c)[0];if(Object(o.isEmpty)(Object(o.flatten)(f))){var p=r.buildEmptyRepetitionError({topLevelRule:e,repetition:i});n.push({message:p,type:a.ParserDefinitionErrorType.NO_NON_EMPTY_LOOKAHEAD,ruleName:e.name})}}))})),n}function k(e,t,r,n){var i=[],s=Object(o.reduce)(e,(function(e,t,r){var n=Object(o.map)(t,(function(e){return{idx:r,path:e}}));return e.concat(n)}),[]);return Object(o.forEach)(s,(function(e){if(!0!==t.definition[e.idx].ignoreAmbiguities){var c=e.idx,l=e.path,f=Object(o.findAll)(s,(function(e){return!0!==t.definition[e.idx].ignoreAmbiguities&&e.idx<c&&Object(u.isStrictPrefixOfPath)(e.path,l)})),p=Object(o.map)(f,(function(e){var o=[e.idx+1,c+1],i=0===t.idx?"":t.idx;return{message:n.buildAlternationPrefixAmbiguityError({topLevelRule:r,alternation:t,ambiguityIndices:o,prefixPath:e.path}),type:a.ParserDefinitionErrorType.AMBIGUOUS_PREFIX_ALTS,ruleName:r.name,occurrence:i,alternatives:o}}));i=i.concat(p)}})),i}},function(e,t,r){"use strict";r.r(t),r.d(t,"PROD_TYPE",(function(){return o})),r.d(t,"getProdType",(function(){return p})),r.d(t,"buildLookaheadFuncForOr",(function(){return h})),r.d(t,"buildLookaheadFuncForOptionalProd",(function(){return d})),r.d(t,"buildAlternativesLookAheadFunc",(function(){return m})),r.d(t,"buildSingleAlternativeLookaheadFunction",(function(){return y})),r.d(t,"lookAheadSequenceFromAlternatives",(function(){return R})),r.d(t,"getLookaheadPathsForOr",(function(){return A})),r.d(t,"getLookaheadPathsForOptionalProd",(function(){return S})),r.d(t,"containsPath",(function(){return N})),r.d(t,"isStrictPrefixOfPath",(function(){return O})),r.d(t,"areTokenCategoriesNotUsed",(function(){return C}));var n,o,a=r(164),i=r(185),u=r(166),s=r(174),c=r(167),l=r(178),f=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function p(e){if(e instanceof c.Option)return o.OPTION;if(e instanceof c.Repetition)return o.REPETITION;if(e instanceof c.RepetitionMandatory)return o.REPETITION_MANDATORY;if(e instanceof c.RepetitionMandatoryWithSeparator)return o.REPETITION_MANDATORY_WITH_SEPARATOR;if(e instanceof c.RepetitionWithSeparator)return o.REPETITION_WITH_SEPARATOR;if(e instanceof c.Alternation)return o.ALTERNATION;throw Error("non exhaustive match")}function h(e,t,r,n,o,a){var i=A(e,t,r);return a(i,n,C(i)?s.tokenStructuredMatcherNoCategories:s.tokenStructuredMatcher,o)}function d(e,t,r,n,o,a){var i=S(e,t,o,r),u=C(i)?s.tokenStructuredMatcherNoCategories:s.tokenStructuredMatcher;return a(i[0],u,n)}function m(e,t,r,n){var o=e.length,i=Object(a.every)(e,(function(e){return Object(a.every)(e,(function(e){return 1===e.length}))}));if(t)return function(t){for(var n=Object(a.map)(t,(function(e){return e.GATE})),i=0;i<o;i++){var u=e[i],s=u.length,c=n[i];if(void 0===c||!1!==c.call(this))e:for(var l=0;l<s;l++){for(var f=u[l],p=f.length,h=0;h<p;h++){var d=this.LA(h+1);if(!1===r(d,f[h]))continue e}return i}}};if(i&&!n){var u=Object(a.map)(e,(function(e){return Object(a.flatten)(e)})),s=Object(a.reduce)(u,(function(e,t,r){return Object(a.forEach)(t,(function(t){Object(a.has)(e,t.tokenTypeIdx)||(e[t.tokenTypeIdx]=r),Object(a.forEach)(t.categoryMatches,(function(t){Object(a.has)(e,t)||(e[t]=r)}))})),e}),[]);return function(){var e=this.LA(1);return s[e.tokenTypeIdx]}}return function(){for(var t=0;t<o;t++){var n=e[t],a=n.length;e:for(var i=0;i<a;i++){for(var u=n[i],s=u.length,c=0;c<s;c++){var l=this.LA(c+1);if(!1===r(l,u[c]))continue e}return t}}}}function y(e,t,r){var n=Object(a.every)(e,(function(e){return 1===e.length})),o=e.length;if(n&&!r){var i=Object(a.flatten)(e);if(1===i.length&&Object(a.isEmpty)(i[0].categoryMatches)){var u=i[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===u}}var s=Object(a.reduce)(i,(function(e,t,r){return e[t.tokenTypeIdx]=!0,Object(a.forEach)(t.categoryMatches,(function(t){e[t]=!0})),e}),[]);return function(){var e=this.LA(1);return!0===s[e.tokenTypeIdx]}}return function(){e:for(var r=0;r<o;r++){for(var n=e[r],a=n.length,i=0;i<a;i++){var u=this.LA(i+1);if(!1===t(u,n[i]))continue e}return!0}return!1}}!function(e){e[e.OPTION=0]="OPTION",e[e.REPETITION=1]="REPETITION",e[e.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",e[e.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",e[e.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",e[e.ALTERNATION=5]="ALTERNATION"}(o||(o={}));var g=function(e){function t(t,r,n){var o=e.call(this)||this;return o.topProd=t,o.targetOccurrence=r,o.targetProdType=n,o}return f(t,e),t.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},t.prototype.checkIsTarget=function(e,t,r,n){return e.idx===this.targetOccurrence&&this.targetProdType===t&&(this.restDef=r.concat(n),!0)},t.prototype.walkOption=function(t,r,n){this.checkIsTarget(t,o.OPTION,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkAtLeastOne=function(t,r,n){this.checkIsTarget(t,o.REPETITION_MANDATORY,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkAtLeastOneSep=function(t,r,n){this.checkIsTarget(t,o.REPETITION_MANDATORY_WITH_SEPARATOR,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkMany=function(t,r,n){this.checkIsTarget(t,o.REPETITION,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkManySep=function(t,r,n){this.checkIsTarget(t,o.REPETITION_WITH_SEPARATOR,r,n)||e.prototype.walkOption.call(this,t,r,n)},t}(u.RestWalker),v=function(e){function t(t,r,n){var o=e.call(this)||this;return o.targetOccurrence=t,o.targetProdType=r,o.targetRef=n,o.result=[],o}return f(t,e),t.prototype.checkIsTarget=function(e,t){e.idx!==this.targetOccurrence||this.targetProdType!==t||void 0!==this.targetRef&&e!==this.targetRef||(this.result=e.definition)},t.prototype.visitOption=function(e){this.checkIsTarget(e,o.OPTION)},t.prototype.visitRepetition=function(e){this.checkIsTarget(e,o.REPETITION)},t.prototype.visitRepetitionMandatory=function(e){this.checkIsTarget(e,o.REPETITION_MANDATORY)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.checkIsTarget(e,o.REPETITION_MANDATORY_WITH_SEPARATOR)},t.prototype.visitRepetitionWithSeparator=function(e){this.checkIsTarget(e,o.REPETITION_WITH_SEPARATOR)},t.prototype.visitAlternation=function(e){this.checkIsTarget(e,o.ALTERNATION)},t}(l.GAstVisitor);function E(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=[];return t}function T(e){for(var t=[""],r=0;r<e.length;r++){for(var n=e[r],o=[],a=0;a<t.length;a++){var i=t[a];o.push(i+"_"+n.tokenTypeIdx);for(var u=0;u<n.categoryMatches.length;u++){var s="_"+n.categoryMatches[u];o.push(i+s)}}t=o}return t}function b(e,t,r){for(var n=0;n<e.length;n++)if(n!==r)for(var o=e[n],a=0;a<t.length;a++)if(!0===o[t[a]])return!1;return!0}function R(e,t){for(var r=Object(a.map)(e,(function(e){return Object(i.possiblePathsFrom)([e],1)})),n=E(r.length),o=Object(a.map)(r,(function(e){var t={};return Object(a.forEach)(e,(function(e){var r=T(e.partialPath);Object(a.forEach)(r,(function(e){t[e]=!0}))})),t})),u=r,s=1;s<=t;s++){var c=u;u=E(c.length);for(var l=function(e){for(var r=c[e],l=0;l<r.length;l++){var f=r[l].partialPath,p=r[l].suffixDef,h=T(f);if(b(o,h,e)||Object(a.isEmpty)(p)||f.length===t){var d=n[e];if(!1===N(d,f)){d.push(f);for(var m=0;m<h.length;m++){var y=h[m];o[e][y]=!0}}}else{var g=Object(i.possiblePathsFrom)(p,s+1,f);u[e]=u[e].concat(g),Object(a.forEach)(g,(function(t){var r=T(t.partialPath);Object(a.forEach)(r,(function(t){o[e][t]=!0}))}))}}},f=0;f<c.length;f++)l(f)}return n}function A(e,t,r,n){var a=new v(e,o.ALTERNATION,n);return t.accept(a),R(a.result,r)}function S(e,t,r,n){var o=new v(e,r);t.accept(o);var a=o.result,i=new g(t,e,r).startWalking();return R([new c.Flat({definition:a}),new c.Flat({definition:i})],n)}function N(e,t){e:for(var r=0;r<e.length;r++){var n=e[r];if(n.length===t.length){for(var o=0;o<n.length;o++){var a=t[o],i=n[o];if(!1==(a===i||void 0!==i.categoryMatchesMap[a.tokenTypeIdx]))continue e}return!0}}return!1}function O(e,t){return e.length<t.length&&Object(a.every)(e,(function(e,r){var n=t[r];return e===n||n.categoryMatchesMap[e.tokenTypeIdx]}))}function C(e){return Object(a.every)(e,(function(e){return Object(a.every)(e,(function(e){return Object(a.every)(e,(function(e){return Object(a.isEmpty)(e.categoryMatches)}))}))}))}},function(e,t,r){"use strict";r.r(t),r.d(t,"AbstractNextPossibleTokensWalker",(function(){return c})),r.d(t,"NextAfterTokenWalker",(function(){return l})),r.d(t,"AbstractNextTerminalAfterProductionWalker",(function(){return f})),r.d(t,"NextTerminalAfterManyWalker",(function(){return p})),r.d(t,"NextTerminalAfterManySepWalker",(function(){return h})),r.d(t,"NextTerminalAfterAtLeastOneWalker",(function(){return d})),r.d(t,"NextTerminalAfterAtLeastOneSepWalker",(function(){return m})),r.d(t,"possiblePathsFrom",(function(){return y})),r.d(t,"nextPossibleTokensAfter",(function(){return g}));var n,o=r(166),a=r(164),i=r(176),u=r(167),s=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),c=function(e){function t(t,r){var n=e.call(this)||this;return n.topProd=t,n.path=r,n.possibleTokTypes=[],n.nextProductionName="",n.nextProductionOccurrence=0,n.found=!1,n.isAtEndOfPath=!1,n}return s(t,e),t.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=Object(a.cloneArr)(this.path.ruleStack).reverse(),this.occurrenceStack=Object(a.cloneArr)(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},t.prototype.walk=function(t,r){void 0===r&&(r=[]),this.found||e.prototype.walk.call(this,t,r)},t.prototype.walkProdRef=function(e,t,r){if(e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence){var n=t.concat(r);this.updateExpectedNext(),this.walk(e.referencedRule,n)}},t.prototype.updateExpectedNext=function(){Object(a.isEmpty)(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},t}(o.RestWalker),l=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.path=r,n.nextTerminalName="",n.nextTerminalOccurrence=0,n.nextTerminalName=n.path.lastTok.name,n.nextTerminalOccurrence=n.path.lastTokOccurrence,n}return s(t,e),t.prototype.walkTerminal=function(e,t,r){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){var n=t.concat(r),o=new u.Flat({definition:n});this.possibleTokTypes=Object(i.first)(o),this.found=!0}},t}(c),f=function(e){function t(t,r){var n=e.call(this)||this;return n.topRule=t,n.occurrence=r,n.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},n}return s(t,e),t.prototype.startWalking=function(){return this.walk(this.topRule),this.result},t}(o.RestWalker),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.walkMany=function(t,r,n){if(t.idx===this.occurrence){var o=Object(a.first)(r.concat(n));this.result.isEndOfRule=void 0===o,o instanceof u.Terminal&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else e.prototype.walkMany.call(this,t,r,n)},t}(f),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.walkManySep=function(t,r,n){if(t.idx===this.occurrence){var o=Object(a.first)(r.concat(n));this.result.isEndOfRule=void 0===o,o instanceof u.Terminal&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else e.prototype.walkManySep.call(this,t,r,n)},t}(f),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.walkAtLeastOne=function(t,r,n){if(t.idx===this.occurrence){var o=Object(a.first)(r.concat(n));this.result.isEndOfRule=void 0===o,o instanceof u.Terminal&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else e.prototype.walkAtLeastOne.call(this,t,r,n)},t}(f),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.walkAtLeastOneSep=function(t,r,n){if(t.idx===this.occurrence){var o=Object(a.first)(r.concat(n));this.result.isEndOfRule=void 0===o,o instanceof u.Terminal&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else e.prototype.walkAtLeastOneSep.call(this,t,r,n)},t}(f);function y(e,t,r){void 0===r&&(r=[]),r=Object(a.cloneArr)(r);var n=[],o=0;function i(i){var u=y(i.concat(Object(a.drop)(e,o+1)),t,r);return n.concat(u)}for(;r.length<t&&o<e.length;){var s=e[o];if(s instanceof u.Flat)return i(s.definition);if(s instanceof u.NonTerminal)return i(s.definition);if(s instanceof u.Option)n=i(s.definition);else{if(s instanceof u.RepetitionMandatory)return i(c=s.definition.concat([new u.Repetition({definition:s.definition})]));if(s instanceof u.RepetitionMandatoryWithSeparator)return i(c=[new u.Flat({definition:s.definition}),new u.Repetition({definition:[new u.Terminal({terminalType:s.separator})].concat(s.definition)})]);if(s instanceof u.RepetitionWithSeparator){var c=s.definition.concat([new u.Repetition({definition:[new u.Terminal({terminalType:s.separator})].concat(s.definition)})]);n=i(c)}else if(s instanceof u.Repetition)c=s.definition.concat([new u.Repetition({definition:s.definition})]),n=i(c);else{if(s instanceof u.Alternation)return Object(a.forEach)(s.definition,(function(e){n=i(e.definition)})),n;if(!(s instanceof u.Terminal))throw Error("non exhaustive match");r.push(s.terminalType)}}o++}return n.push({partialPath:r,suffixDef:Object(a.drop)(e,o)}),n}function g(e,t,r,n){var o=["EXIT_NONE_TERMINAL"],i=!1,s=t.length,c=s-n-1,l=[],f=[];for(f.push({idx:-1,def:e,ruleStack:[],occurrenceStack:[]});!Object(a.isEmpty)(f);){var p=f.pop();if("EXIT_ALTERNATIVE"!==p){var h=p.def,d=p.idx,m=p.ruleStack,y=p.occurrenceStack;if(!Object(a.isEmpty)(h)){var g=h[0];if("EXIT_NONE_TERMINAL"===g){var E={idx:d,def:Object(a.drop)(h),ruleStack:Object(a.dropRight)(m),occurrenceStack:Object(a.dropRight)(y)};f.push(E)}else if(g instanceof u.Terminal)if(d<s-1){var T=d+1;r(t[T],g.terminalType)&&(E={idx:T,def:Object(a.drop)(h),ruleStack:m,occurrenceStack:y},f.push(E))}else{if(d!==s-1)throw Error("non exhaustive match");l.push({nextTokenType:g.terminalType,nextTokenOccurrence:g.idx,ruleStack:m,occurrenceStack:y}),i=!0}else if(g instanceof u.NonTerminal){var b=Object(a.cloneArr)(m);b.push(g.nonTerminalName);var R=Object(a.cloneArr)(y);R.push(g.idx),E={idx:d,def:g.definition.concat(o,Object(a.drop)(h)),ruleStack:b,occurrenceStack:R},f.push(E)}else if(g instanceof u.Option){var A={idx:d,def:Object(a.drop)(h),ruleStack:m,occurrenceStack:y};f.push(A),f.push("EXIT_ALTERNATIVE");var S={idx:d,def:g.definition.concat(Object(a.drop)(h)),ruleStack:m,occurrenceStack:y};f.push(S)}else if(g instanceof u.RepetitionMandatory){var N=new u.Repetition({definition:g.definition,idx:g.idx});E={idx:d,def:g.definition.concat([N],Object(a.drop)(h)),ruleStack:m,occurrenceStack:y},f.push(E)}else if(g instanceof u.RepetitionMandatoryWithSeparator){var O=new u.Terminal({terminalType:g.separator});N=new u.Repetition({definition:[O].concat(g.definition),idx:g.idx}),E={idx:d,def:g.definition.concat([N],Object(a.drop)(h)),ruleStack:m,occurrenceStack:y},f.push(E)}else if(g instanceof u.RepetitionWithSeparator){A={idx:d,def:Object(a.drop)(h),ruleStack:m,occurrenceStack:y},f.push(A),f.push("EXIT_ALTERNATIVE"),O=new u.Terminal({terminalType:g.separator});var C=new u.Repetition({definition:[O].concat(g.definition),idx:g.idx});S={idx:d,def:g.definition.concat([C],Object(a.drop)(h)),ruleStack:m,occurrenceStack:y},f.push(S)}else if(g instanceof u.Repetition)A={idx:d,def:Object(a.drop)(h),ruleStack:m,occurrenceStack:y},f.push(A),f.push("EXIT_ALTERNATIVE"),C=new u.Repetition({definition:g.definition,idx:g.idx}),S={idx:d,def:g.definition.concat([C],Object(a.drop)(h)),ruleStack:m,occurrenceStack:y},f.push(S);else if(g instanceof u.Alternation)for(var w=g.definition.length-1;w>=0;w--){var M={idx:d,def:g.definition[w].definition.concat(Object(a.drop)(h)),ruleStack:m,occurrenceStack:y};f.push(M),f.push("EXIT_ALTERNATIVE")}else if(g instanceof u.Flat)f.push({idx:d,def:g.definition.concat(Object(a.drop)(h)),ruleStack:m,occurrenceStack:y});else{if(!(g instanceof u.Rule))throw Error("non exhaustive match");f.push(v(g,d,m,y))}}}else i&&Object(a.last)(f).idx<=c&&f.pop()}return l}function v(e,t,r,n){var o=Object(a.cloneArr)(r);o.push(e.name);var i=Object(a.cloneArr)(n);return i.push(1),{idx:t,def:e.definition,ruleStack:o,occurrenceStack:i}}},function(e,t,r){"use strict";r.r(t),r.d(t,"resolveGrammar",(function(){return s})),r.d(t,"validateGrammar",(function(){return c})),r.d(t,"assignOccurrenceIndices",(function(){return l}));var n=r(164),o=r(187),a=r(183),i=r(182),u=r(177);function s(e){e=Object(n.defaults)(e,{errMsgProvider:i.defaultGrammarResolverErrorProvider});var t={};return Object(n.forEach)(e.rules,(function(e){t[e.name]=e})),Object(o.resolveGrammar)(t,e.errMsgProvider)}function c(e){return e=Object(n.defaults)(e,{errMsgProvider:i.defaultGrammarValidatorErrorProvider,ignoredIssues:{}}),Object(a.validateGrammar)(e.rules,e.maxLookahead,e.tokenTypes,e.ignoredIssues,e.errMsgProvider,e.grammarName)}function l(e){Object(n.forEach)(e.rules,(function(e){var t=new u.DslMethodsCollectorVisitor;e.accept(t),Object(n.forEach)(t.dslMethods,(function(e){Object(n.forEach)(e,(function(e,t){e.idx=t+1}))}))}))}},function(e,t,r){"use strict";r.r(t),r.d(t,"resolveGrammar",(function(){return s})),r.d(t,"GastRefResolverVisitor",(function(){return c}));var n,o=r(163),a=r(164),i=r(178),u=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function s(e,t){var r=new c(e,t);return r.resolveRefs(),r.errors}var c=function(e){function t(t,r){var n=e.call(this)||this;return n.nameToTopRule=t,n.errMsgProvider=r,n.errors=[],n}return u(t,e),t.prototype.resolveRefs=function(){var e=this;Object(a.forEach)(Object(a.values)(this.nameToTopRule),(function(t){e.currTopLevel=t,t.accept(e)}))},t.prototype.visitNonTerminal=function(e){var t=this.nameToTopRule[e.nonTerminalName];if(t)e.referencedRule=t;else{var r=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:r,type:o.ParserDefinitionErrorType.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}},t}(i.GAstVisitor)},function(e,t,r){"use strict";r.r(t),r.d(t,"EOF_FOLLOW_KEY",(function(){return s})),r.d(t,"IN_RULE_RECOVERY_EXCEPTION",(function(){return c})),r.d(t,"InRuleRecoveryException",(function(){return l})),r.d(t,"Recoverable",(function(){return f})),r.d(t,"attemptInRepetitionRecovery",(function(){return p}));var n=r(168),o=r(164),a=r(189),i=r(179),u=r(163),s={},c="InRuleRecoveryException";function l(e){this.name=c,this.message=e}l.prototype=Error.prototype;var f=function(){function e(){}return e.prototype.initRecoverable=function(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=Object(o.has)(e,"recoveryEnabled")?e.recoveryEnabled:u.DEFAULT_PARSER_CONFIG.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=p)},e.prototype.getTokenToInsert=function(e){var t=Object(n.createTokenInstance)(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return t.isInsertedInRecovery=!0,t},e.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},e.prototype.tryInRepetitionRecovery=function(e,t,r,n){for(var i=this,u=this.findReSyncTokenType(),s=this.exportLexerState(),c=[],l=!1,f=this.LA(1),p=this.LA(1),h=function(){var e=i.LA(0),t=i.errorMessageProvider.buildMismatchTokenMessage({expected:n,actual:f,previous:e,ruleName:i.getCurrRuleFullName()}),r=new a.MismatchedTokenException(t,f,i.LA(0));r.resyncedTokens=Object(o.dropRight)(c),i.SAVE_ERROR(r)};!l;){if(this.tokenMatcher(p,n))return void h();if(r.call(this))return h(),void e.apply(this,t);this.tokenMatcher(p,u)?l=!0:(p=this.SKIP_TOKEN(),this.addToResyncTokens(p,c))}this.importLexerState(s)},e.prototype.shouldInRepetitionRecoveryBeTried=function(e,t,r){return!1!==r&&void 0!==e&&void 0!==t&&!this.tokenMatcher(this.LA(1),e)&&!this.isBackTracking()&&!this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t))},e.prototype.getFollowsForInRuleRecovery=function(e,t){var r=this.getCurrentGrammarPath(e,t);return this.getNextPossibleTokenTypes(r)},e.prototype.tryInRuleRecovery=function(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t))return this.getTokenToInsert(e);if(this.canRecoverWithSingleTokenDeletion(e)){var r=this.SKIP_TOKEN();return this.consumeToken(),r}throw new l("sad sad panda")},e.prototype.canPerformInRuleRecovery=function(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)},e.prototype.canRecoverWithSingleTokenInsertion=function(e,t){var r=this;if(!this.canTokenTypeBeInsertedInRecovery(e))return!1;if(Object(o.isEmpty)(t))return!1;var n=this.LA(1);return void 0!==Object(o.find)(t,(function(e){return r.tokenMatcher(n,e)}))},e.prototype.canRecoverWithSingleTokenDeletion=function(e){return this.tokenMatcher(this.LA(2),e)},e.prototype.isInCurrentRuleReSyncSet=function(e){var t=this.getCurrFollowKey(),r=this.getFollowSetFromFollowKey(t);return Object(o.contains)(r,e)},e.prototype.findReSyncTokenType=function(){for(var e=this.flattenFollowSet(),t=this.LA(1),r=2;;){var n=t.tokenType;if(Object(o.contains)(e,n))return n;t=this.LA(r),r++}},e.prototype.getCurrFollowKey=function(){if(1===this.RULE_STACK.length)return s;var e=this.getLastExplicitRuleShortName(),t=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(r)}},e.prototype.buildFullFollowKeyStack=function(){var e=this,t=this.RULE_STACK,r=this.RULE_OCCURRENCE_STACK;return Object(o.isEmpty)(this.LAST_EXPLICIT_RULE_STACK)||(t=Object(o.map)(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.RULE_STACK[t]})),r=Object(o.map)(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.RULE_OCCURRENCE_STACK[t]}))),Object(o.map)(t,(function(n,o){return 0===o?s:{ruleName:e.shortRuleNameToFullName(n),idxInCallingRule:r[o],inRule:e.shortRuleNameToFullName(t[o-1])}}))},e.prototype.flattenFollowSet=function(){var e=this,t=Object(o.map)(this.buildFullFollowKeyStack(),(function(t){return e.getFollowSetFromFollowKey(t)}));return Object(o.flatten)(t)},e.prototype.getFollowSetFromFollowKey=function(e){if(e===s)return[n.EOF];var t=e.ruleName+e.idxInCallingRule+i.IN+e.inRule;return this.resyncFollows[t]},e.prototype.addToResyncTokens=function(e,t){return this.tokenMatcher(e,n.EOF)||t.push(e),t},e.prototype.reSyncTo=function(e){for(var t=[],r=this.LA(1);!1===this.tokenMatcher(r,e);)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,t);return Object(o.dropRight)(t)},e.prototype.attemptInRepetitionRecovery=function(e,t,r,n,o,a,i){},e.prototype.getCurrentGrammarPath=function(e,t){return{ruleStack:this.getHumanReadableRuleStack(),occurrenceStack:Object(o.cloneArr)(this.RULE_OCCURRENCE_STACK),lastTok:e,lastTokOccurrence:t}},e.prototype.getHumanReadableRuleStack=function(){var e=this;return Object(o.isEmpty)(this.LAST_EXPLICIT_RULE_STACK)?Object(o.map)(this.RULE_STACK,(function(t){return e.shortRuleNameToFullName(t)})):Object(o.map)(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.shortRuleNameToFullName(e.RULE_STACK[t])}))},e}();function p(e,t,r,o,a,i,u){var s=this.getKeyForAutomaticLookahead(o,a),c=this.firstAfterRepMap[s];if(void 0===c){var l=this.getCurrRuleFullName();c=new i(this.getGAstProductions()[l],a).startWalking(),this.firstAfterRepMap[s]=c}var f=c.token,p=c.occurrence,h=c.isEndOfRule;1===this.RULE_STACK.length&&h&&void 0===f&&(f=n.EOF,p=1),this.shouldInRepetitionRecoveryBeTried(f,p,u)&&this.tryInRepetitionRecovery(e,t,r,f)}},function(e,t,r){"use strict";r.r(t),r.d(t,"isRecognitionException",(function(){return a})),r.d(t,"MismatchedTokenException",(function(){return i})),r.d(t,"NoViableAltException",(function(){return u})),r.d(t,"NotAllInputParsedException",(function(){return s})),r.d(t,"EarlyExitException",(function(){return c}));var n=r(164),o=["MismatchedTokenException","NoViableAltException","EarlyExitException","NotAllInputParsedException"];function a(e){return Object(n.contains)(o,e.name)}function i(e,t,r){this.name="MismatchedTokenException",this.message=e,this.token=t,this.previousToken=r,this.resyncedTokens=[]}function u(e,t,r){this.name="NoViableAltException",this.message=e,this.token=t,this.previousToken=r,this.resyncedTokens=[]}function s(e,t){this.name="NotAllInputParsedException",this.message=e,this.token=t,this.resyncedTokens=[]}function c(e,t,r){this.name="EarlyExitException",this.message=e,this.token=t,this.previousToken=r,this.resyncedTokens=[]}Object.freeze(o),i.prototype=Error.prototype,u.prototype=Error.prototype,s.prototype=Error.prototype,c.prototype=Error.prototype},function(e,t,r){"use strict";r.r(t),r.d(t,"LooksAhead",(function(){return s}));var n=r(184),o=r(164),a=r(163),i=r(181),u=r(177),s=function(){function e(){}return e.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=Object(o.has)(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:a.DEFAULT_PARSER_CONFIG.dynamicTokensEnabled,this.maxLookahead=Object(o.has)(e,"maxLookahead")?e.maxLookahead:a.DEFAULT_PARSER_CONFIG.maxLookahead,this.lookAheadFuncsCache=Object(o.isES2015MapSupported)()?new Map:[],Object(o.isES2015MapSupported)()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},e.prototype.preComputeLookaheadFunctions=function(e){var t=this;Object(o.forEach)(e,(function(e){t.TRACE_INIT(e.name+" Rule Lookahead",(function(){var r=Object(u.collectMethods)(e),a=r.alternation,s=r.repetition,c=r.option,l=r.repetitionMandatory,f=r.repetitionMandatoryWithSeparator,p=r.repetitionWithSeparator;Object(o.forEach)(a,(function(r){var o=0===r.idx?"":r.idx;t.TRACE_INIT(""+Object(u.getProductionDslName)(r)+o,(function(){var o=Object(n.buildLookaheadFuncForOr)(r.idx,e,r.maxLookahead||t.maxLookahead,r.hasPredicates,t.dynamicTokensEnabled,t.lookAheadBuilderForAlternatives),a=Object(i.getKeyForAutomaticLookahead)(t.fullRuleNameToShort[e.name],i.OR_IDX,r.idx);t.setLaFuncCache(a,o)}))})),Object(o.forEach)(s,(function(r){t.computeLookaheadFunc(e,r.idx,i.MANY_IDX,n.PROD_TYPE.REPETITION,r.maxLookahead,Object(u.getProductionDslName)(r))})),Object(o.forEach)(c,(function(r){t.computeLookaheadFunc(e,r.idx,i.OPTION_IDX,n.PROD_TYPE.OPTION,r.maxLookahead,Object(u.getProductionDslName)(r))})),Object(o.forEach)(l,(function(r){t.computeLookaheadFunc(e,r.idx,i.AT_LEAST_ONE_IDX,n.PROD_TYPE.REPETITION_MANDATORY,r.maxLookahead,Object(u.getProductionDslName)(r))})),Object(o.forEach)(f,(function(r){t.computeLookaheadFunc(e,r.idx,i.AT_LEAST_ONE_SEP_IDX,n.PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,r.maxLookahead,Object(u.getProductionDslName)(r))})),Object(o.forEach)(p,(function(r){t.computeLookaheadFunc(e,r.idx,i.MANY_SEP_IDX,n.PROD_TYPE.REPETITION_WITH_SEPARATOR,r.maxLookahead,Object(u.getProductionDslName)(r))}))}))}))},e.prototype.computeLookaheadFunc=function(e,t,r,o,a,u){var s=this;this.TRACE_INIT(""+u+(0===t?"":t),(function(){var u=Object(n.buildLookaheadFuncForOptionalProd)(t,e,a||s.maxLookahead,s.dynamicTokensEnabled,o,s.lookAheadBuilderForOptional),c=Object(i.getKeyForAutomaticLookahead)(s.fullRuleNameToShort[e.name],r,t);s.setLaFuncCache(c,u)}))},e.prototype.lookAheadBuilderForOptional=function(e,t,r){return Object(n.buildSingleAlternativeLookaheadFunction)(e,t,r)},e.prototype.lookAheadBuilderForAlternatives=function(e,t,r,o){return Object(n.buildAlternativesLookAheadFunc)(e,t,r,o)},e.prototype.getKeyForAutomaticLookahead=function(e,t){var r=this.getLastExplicitRuleShortName();return Object(i.getKeyForAutomaticLookahead)(r,e,t)},e.prototype.getLaFuncFromCache=function(e){},e.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},e.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},e.prototype.setLaFuncCache=function(e,t){},e.prototype.setLaFuncCacheUsingMap=function(e,t){this.lookAheadFuncsCache.set(e,t)},e.prototype.setLaFuncUsingObj=function(e,t){this.lookAheadFuncsCache[e]=t},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"TreeBuilder",(function(){return s}));var n=r(180),o=r(164),a=r(192),i=r(181),u=r(163),s=function(){function e(){}return e.prototype.initTreeBuilder=function(e){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=Object(o.has)(e,"outputCst")?e.outputCst:u.DEFAULT_PARSER_CONFIG.outputCst,this.nodeLocationTracking=Object(o.has)(e,"nodeLocationTracking")?e.nodeLocationTracking:u.DEFAULT_PARSER_CONFIG.nodeLocationTracking,this.outputCst)if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=n.setNodeLocationFull,this.setNodeLocationFromNode=n.setNodeLocationFull,this.cstPostRule=o.NOOP,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=o.NOOP,this.setNodeLocationFromNode=o.NOOP,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=n.setNodeLocationOnlyOffset,this.setNodeLocationFromNode=n.setNodeLocationOnlyOffset,this.cstPostRule=o.NOOP,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=o.NOOP,this.setNodeLocationFromNode=o.NOOP,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else{if(!/none/i.test(this.nodeLocationTracking))throw Error('Invalid <nodeLocationTracking> config option: "'+e.nodeLocationTracking+'"');this.setNodeLocationFromToken=o.NOOP,this.setNodeLocationFromNode=o.NOOP,this.cstPostRule=o.NOOP,this.setInitialNodeLocation=o.NOOP}else this.cstInvocationStateUpdate=o.NOOP,this.cstFinallyStateUpdate=o.NOOP,this.cstPostTerminal=o.NOOP,this.cstPostNonTerminal=o.NOOP,this.cstPostRule=o.NOOP,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst},e.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},e.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},e.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.setInitialNodeLocationFullRegular=function(e){var t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.cstNestedInvocationStateUpdate=function(e,t){var r={name:e,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+e,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},e.prototype.cstInvocationStateUpdate=function(e,t){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);var r={name:e,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},e.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},e.prototype.cstNestedFinallyStateUpdate=function(){var e=this.CST_STACK.pop();this.cstPostRule(e)},e.prototype.cstPostRuleFull=function(e){var t=this.LA(0),r=e.location;r.startOffset<=t.startOffset==1?(r.endOffset=t.endOffset,r.endLine=t.endLine,r.endColumn=t.endColumn):(r.startOffset=NaN,r.startLine=NaN,r.startColumn=NaN)},e.prototype.cstPostRuleOnlyOffset=function(e){var t=this.LA(0),r=e.location;r.startOffset<=t.startOffset==1?r.endOffset=t.endOffset:r.startOffset=NaN},e.prototype.cstPostTerminal=function(e,t){var r=this.CST_STACK[this.CST_STACK.length-1];Object(n.addTerminalToCst)(r,t,e),this.setNodeLocationFromToken(r.location,t)},e.prototype.cstPostNonTerminal=function(e,t){if(!0!==this.isBackTracking()){var r=this.CST_STACK[this.CST_STACK.length-1];Object(n.addNoneTerminalToCst)(r,t,e),this.setNodeLocationFromNode(r.location,e.location)}},e.prototype.getBaseCstVisitorConstructor=function(){if(Object(o.isUndefined)(this.baseCstVisitorConstructor)){var e=Object(a.createBaseSemanticVisitorConstructor)(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor},e.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(Object(o.isUndefined)(this.baseCstVisitorWithDefaultsConstructor)){var e=Object(a.createBaseVisitorConstructorWithDefaults)(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor},e.prototype.nestedRuleBeforeClause=function(e,t){var r;return void 0!==e.NAME?(r=e.NAME,this.nestedRuleInvocationStateUpdate(r,t),r):void 0},e.prototype.nestedAltBeforeClause=function(e,t,r,n){var o,a=this.getLastExplicitRuleShortName(),u=Object(i.getKeyForAltIndex)(a,r,t,n);return void 0!==e.NAME?(o=e.NAME,this.nestedRuleInvocationStateUpdate(o,u),{shortName:u,nestedName:o}):void 0},e.prototype.nestedRuleFinallyClause=function(e,t){var r=this.CST_STACK,o=r[r.length-1];this.nestedRuleFinallyStateUpdate();var a=r[r.length-1];Object(n.addNoneTerminalToCst)(a,t,o),this.setNodeLocationFromNode(a.location,o.location)},e.prototype.getLastExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[e]},e.prototype.getLastExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-1]},e.prototype.getPreviousExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[e]},e.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-2]},e.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[e]},e.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},e.prototype.nestedRuleInvocationStateUpdate=function(e,t){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(t),this.cstNestedInvocationStateUpdate(e,t)},e.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"defaultVisit",(function(){return u})),r.d(t,"createBaseSemanticVisitorConstructor",(function(){return s})),r.d(t,"createBaseVisitorConstructorWithDefaults",(function(){return c})),r.d(t,"CstVisitorDefinitionError",(function(){return n})),r.d(t,"validateVisitor",(function(){return l})),r.d(t,"validateMissingCstMethods",(function(){return f})),r.d(t,"validateRedundantMethods",(function(){return h}));var n,o=r(164),a=r(193),i=r(183);function u(e,t){for(var r=Object(o.keys)(e),n=r.length,a=0;a<n;a++)for(var i=e[r[a]],u=i.length,s=0;s<u;s++){var c=i[s];void 0===c.tokenTypeIdx&&(void 0!==c.fullName?this[c.fullName](c.children,t):this[c.name](c.children,t))}}function s(e,t){var r=function(){};return Object(a.defineNameProp)(r,e+"BaseSemantics"),(r.prototype={visit:function(e,t){if(Object(o.isArray)(e)&&(e=e[0]),!Object(o.isUndefined)(e))return void 0!==e.fullName?this[e.fullName](e.children,t):this[e.name](e.children,t)},validateVisitor:function(){var e=l(this,t);if(!Object(o.isEmpty)(e)){var r=Object(o.map)(e,(function(e){return e.msg}));throw Error("Errors Detected in CST Visitor <"+Object(a.functionName)(this.constructor)+">:\n\t"+r.join("\n\n").replace(/\n/g,"\n\t"))}}}).constructor=r,r._RULE_NAMES=t,r}function c(e,t,r){var n=function(){};Object(a.defineNameProp)(n,e+"BaseSemanticsWithDefaults");var i=Object.create(r.prototype);return Object(o.forEach)(t,(function(e){i[e]=u})),(n.prototype=i).constructor=n,n}function l(e,t){var r=f(e,t),n=h(e,t);return r.concat(n)}function f(e,t){var r=Object(o.map)(t,(function(t){if(!Object(o.isFunction)(e[t]))return{msg:"Missing visitor method: <"+t+"> on "+Object(a.functionName)(e.constructor)+" CST Visitor.",type:n.MISSING_METHOD,methodName:t}}));return Object(o.compact)(r)}!function(e){e[e.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",e[e.MISSING_METHOD=1]="MISSING_METHOD"}(n||(n={}));var p=["constructor","visit","validateVisitor"];function h(e,t){var r=[];for(var u in e)i.validTermsPattern.test(u)&&Object(o.isFunction)(e[u])&&!Object(o.contains)(p,u)&&!Object(o.contains)(t,u)&&r.push({msg:"Redundant visitor method: <"+u+"> on "+Object(a.functionName)(e.constructor)+" CST Visitor\nThere is no Grammar Rule corresponding to this method's name.\nFor utility methods on visitor classes use methods names that do not match /"+i.validTermsPattern.source+"/.",type:n.REDUNDANT_METHOD,methodName:u});return r}},function(e,t,r){"use strict";r.r(t),r.d(t,"classNameFromInstance",(function(){return o})),r.d(t,"functionName",(function(){return i})),r.d(t,"defineNameProp",(function(){return u}));var n=r(164);function o(e){return i(e.constructor)}var a=/^\s*function\s*(\S*)\s*\(/;function i(e){var t=e.name;return t||e.toString().match(a)[1]}function u(e,t){var r=Object.getOwnPropertyDescriptor(e,"name");return!(!Object(n.isUndefined)(r)&&!r.configurable||(Object.defineProperty(e,"name",{enumerable:!1,configurable:!0,writable:!1,value:t}),0))}},function(e,t,r){"use strict";r.r(t),r.d(t,"LexerAdapter",(function(){return o}));var n=r(163),o=function(){function e(){}return e.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(e.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(!0!==this.selfAnalysisDone)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!0,configurable:!0}),e.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):n.END_OF_FILE},e.prototype.LA=function(e){var t=this.currIdx+e;return t<0||this.tokVectorLength<=t?n.END_OF_FILE:this.tokVector[t]},e.prototype.consumeToken=function(){this.currIdx++},e.prototype.exportLexerState=function(){return this.currIdx},e.prototype.importLexerState=function(e){this.currIdx=e},e.prototype.resetLexerState=function(){this.currIdx=-1},e.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},e.prototype.getLexerPosition=function(){return this.exportLexerState()},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"RecognizerApi",(function(){return c}));var n=r(164),o=r(189),a=r(163),i=r(182),u=r(183),s=r(167),c=function(){function e(){}return e.prototype.ACTION=function(e){return e.call(this)},e.prototype.consume=function(e,t,r){return this.consumeInternal(t,e,r)},e.prototype.subrule=function(e,t,r){return this.subruleInternal(t,e,r)},e.prototype.option=function(e,t){return this.optionInternal(t,e)},e.prototype.or=function(e,t){return this.orInternal(t,e)},e.prototype.many=function(e,t){return this.manyInternal(e,t)},e.prototype.atLeastOne=function(e,t){return this.atLeastOneInternal(e,t)},e.prototype.CONSUME=function(e,t){return this.consumeInternal(e,0,t)},e.prototype.CONSUME1=function(e,t){return this.consumeInternal(e,1,t)},e.prototype.CONSUME2=function(e,t){return this.consumeInternal(e,2,t)},e.prototype.CONSUME3=function(e,t){return this.consumeInternal(e,3,t)},e.prototype.CONSUME4=function(e,t){return this.consumeInternal(e,4,t)},e.prototype.CONSUME5=function(e,t){return this.consumeInternal(e,5,t)},e.prototype.CONSUME6=function(e,t){return this.consumeInternal(e,6,t)},e.prototype.CONSUME7=function(e,t){return this.consumeInternal(e,7,t)},e.prototype.CONSUME8=function(e,t){return this.consumeInternal(e,8,t)},e.prototype.CONSUME9=function(e,t){return this.consumeInternal(e,9,t)},e.prototype.SUBRULE=function(e,t){return this.subruleInternal(e,0,t)},e.prototype.SUBRULE1=function(e,t){return this.subruleInternal(e,1,t)},e.prototype.SUBRULE2=function(e,t){return this.subruleInternal(e,2,t)},e.prototype.SUBRULE3=function(e,t){return this.subruleInternal(e,3,t)},e.prototype.SUBRULE4=function(e,t){return this.subruleInternal(e,4,t)},e.prototype.SUBRULE5=function(e,t){return this.subruleInternal(e,5,t)},e.prototype.SUBRULE6=function(e,t){return this.subruleInternal(e,6,t)},e.prototype.SUBRULE7=function(e,t){return this.subruleInternal(e,7,t)},e.prototype.SUBRULE8=function(e,t){return this.subruleInternal(e,8,t)},e.prototype.SUBRULE9=function(e,t){return this.subruleInternal(e,9,t)},e.prototype.OPTION=function(e){return this.optionInternal(e,0)},e.prototype.OPTION1=function(e){return this.optionInternal(e,1)},e.prototype.OPTION2=function(e){return this.optionInternal(e,2)},e.prototype.OPTION3=function(e){return this.optionInternal(e,3)},e.prototype.OPTION4=function(e){return this.optionInternal(e,4)},e.prototype.OPTION5=function(e){return this.optionInternal(e,5)},e.prototype.OPTION6=function(e){return this.optionInternal(e,6)},e.prototype.OPTION7=function(e){return this.optionInternal(e,7)},e.prototype.OPTION8=function(e){return this.optionInternal(e,8)},e.prototype.OPTION9=function(e){return this.optionInternal(e,9)},e.prototype.OR=function(e){return this.orInternal(e,0)},e.prototype.OR1=function(e){return this.orInternal(e,1)},e.prototype.OR2=function(e){return this.orInternal(e,2)},e.prototype.OR3=function(e){return this.orInternal(e,3)},e.prototype.OR4=function(e){return this.orInternal(e,4)},e.prototype.OR5=function(e){return this.orInternal(e,5)},e.prototype.OR6=function(e){return this.orInternal(e,6)},e.prototype.OR7=function(e){return this.orInternal(e,7)},e.prototype.OR8=function(e){return this.orInternal(e,8)},e.prototype.OR9=function(e){return this.orInternal(e,9)},e.prototype.MANY=function(e){this.manyInternal(0,e)},e.prototype.MANY1=function(e){this.manyInternal(1,e)},e.prototype.MANY2=function(e){this.manyInternal(2,e)},e.prototype.MANY3=function(e){this.manyInternal(3,e)},e.prototype.MANY4=function(e){this.manyInternal(4,e)},e.prototype.MANY5=function(e){this.manyInternal(5,e)},e.prototype.MANY6=function(e){this.manyInternal(6,e)},e.prototype.MANY7=function(e){this.manyInternal(7,e)},e.prototype.MANY8=function(e){this.manyInternal(8,e)},e.prototype.MANY9=function(e){this.manyInternal(9,e)},e.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},e.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},e.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},e.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},e.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},e.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},e.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},e.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},e.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},e.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},e.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},e.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},e.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},e.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},e.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},e.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},e.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},e.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},e.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},e.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},e.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},e.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},e.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},e.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},e.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},e.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},e.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},e.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},e.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},e.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},e.prototype.RULE=function(e,t,r){if(void 0===r&&(r=a.DEFAULT_RULE_CONFIG),Object(n.contains)(this.definedRulesNames,e)){var o={message:i.defaultGrammarValidatorErrorProvider.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),type:a.ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(o)}this.definedRulesNames.push(e);var u=this.defineRule(e,t,r);return this[e]=u,u},e.prototype.OVERRIDE_RULE=function(e,t,r){void 0===r&&(r=a.DEFAULT_RULE_CONFIG);var n=[];n=n.concat(Object(u.validateRuleIsOverridden)(e,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,n);var o=this.defineRule(e,t,r);return this[e]=o,o},e.prototype.BACKTRACK=function(e,t){return function(){this.isBackTrackingStack.push(1);var r=this.saveRecogState();try{return e.apply(this,t),!0}catch(e){if(Object(o.isRecognitionException)(e))return!1;throw e}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}},e.prototype.getGAstProductions=function(){return this.gastProductionsCache},e.prototype.getSerializedGastProductions=function(){return Object(s.serializeGrammar)(Object(n.values)(this.gastProductionsCache))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"RecognizerEngine",(function(){return h}));var n=r(164),o=r(181),a=r(189),i=r(184),u=r(185),s=r(163),c=r(188),l=r(168),f=r(174),p=r(193),h=function(){function e(){}return e.prototype.initRecognizerEngine=function(e,t){if(this.className=Object(p.classNameFromInstance)(this),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=f.tokenStructuredMatcherNoCategories,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},Object(n.has)(t,"serializedGrammar"))throw Error("The Parser's configuration can no longer contain a <serializedGrammar> property.\n\tSee: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0\n\tFor Further details.");if(Object(n.isArray)(e)){if(Object(n.isEmpty)(e))throw Error("A Token Vocabulary cannot be empty.\n\tNote that the first argument for the parser constructor\n\tis no longer a Token vector (since v4.0).");if("number"==typeof e[0].startOffset)throw Error("The Parser constructor no longer accepts a token vector as the first argument.\n\tSee: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0\n\tFor Further details.")}if(Object(n.isArray)(e))this.tokensMap=Object(n.reduce)(e,(function(e,t){return e[t.name]=t,e}),{});else if(Object(n.has)(e,"modes")&&Object(n.every)(Object(n.flatten)(Object(n.values)(e.modes)),f.isTokenType)){var r=Object(n.flatten)(Object(n.values)(e.modes)),o=Object(n.uniq)(r);this.tokensMap=Object(n.reduce)(o,(function(e,t){return e[t.name]=t,e}),{})}else{if(!Object(n.isObject)(e))throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap=Object(n.cloneObj)(e)}this.tokensMap.EOF=l.EOF;var a=Object(n.every)(Object(n.values)(e),(function(e){return Object(n.isEmpty)(e.categoryMatches)}));this.tokenMatcher=a?f.tokenStructuredMatcherNoCategories:f.tokenStructuredMatcher,Object(f.augmentTokenTypes)(Object(n.values)(this.tokensMap))},e.prototype.defineRule=function(e,t,r){if(this.selfAnalysisDone)throw Error("Grammar rule <"+e+"> may not be defined after the 'performSelfAnalysis' method has been called'\nMake sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.");var a,i=Object(n.has)(r,"resyncEnabled")?r.resyncEnabled:s.DEFAULT_RULE_CONFIG.resyncEnabled,u=Object(n.has)(r,"recoveryValueFunc")?r.recoveryValueFunc:s.DEFAULT_RULE_CONFIG.recoveryValueFunc,c=this.ruleShortNameIdx<<o.BITS_FOR_METHOD_TYPE+o.BITS_FOR_OCCURRENCE_IDX;function l(e){try{if(!0===this.outputCst){t.apply(this,e);var r=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(r),r}return t.apply(this,e)}catch(e){return this.invokeRuleCatch(e,i,u)}finally{this.ruleFinallyStateUpdate()}}return this.ruleShortNameIdx++,this.shortRuleNameToFull[c]=e,this.fullRuleNameToShort[e]=c,(a=function(t,r){return void 0===t&&(t=0),this.ruleInvocationStateUpdate(c,e,t),l.call(this,r)}).ruleName=e,a.originalGrammarAction=t,a},e.prototype.invokeRuleCatch=function(e,t,r){var n=1===this.RULE_STACK.length,o=t&&!this.isBackTracking()&&this.recoveryEnabled;if(Object(a.isRecognitionException)(e)){var i=e;if(o){var u,s=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(s))return i.resyncedTokens=this.reSyncTo(s),this.outputCst?((u=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,u):r();throw this.outputCst&&((u=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,i.partialCstResult=u),i}if(n)return this.moveToTerminatedState(),r();throw i}throw e},e.prototype.optionInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(o.OPTION_IDX,t),n=this.nestedRuleBeforeClause(e,r);try{return this.optionInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.optionInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(o.OPTION_IDX,t);return this.optionInternalLogic(e,t,r)},e.prototype.optionInternalLogic=function(e,t,r){var n,o,a=this,i=this.getLaFuncFromCache(r);if(void 0!==e.DEF){if(n=e.DEF,void 0!==(o=e.GATE)){var u=i;i=function(){return o.call(a)&&u.call(a)}}}else n=e;if(!0===i.call(this))return n.call(this)},e.prototype.atLeastOneInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(o.AT_LEAST_ONE_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{return this.atLeastOneInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.atLeastOneInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(o.AT_LEAST_ONE_IDX,e);this.atLeastOneInternalLogic(e,t,r)},e.prototype.atLeastOneInternalLogic=function(e,t,r){var n,a,s=this,c=this.getLaFuncFromCache(r);if(void 0!==t.DEF){if(n=t.DEF,void 0!==(a=t.GATE)){var l=c;c=function(){return a.call(s)&&l.call(s)}}}else n=t;if(!0!==c.call(this))throw this.raiseEarlyExitException(e,i.PROD_TYPE.REPETITION_MANDATORY,t.ERR_MSG);for(var f=this.doSingleRepetition(n);!0===c.call(this)&&!0===f;)f=this.doSingleRepetition(n);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],c,o.AT_LEAST_ONE_IDX,e,u.NextTerminalAfterAtLeastOneWalker)},e.prototype.atLeastOneSepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(o.AT_LEAST_ONE_SEP_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{this.atLeastOneSepFirstInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.atLeastOneSepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(o.AT_LEAST_ONE_SEP_IDX,e);this.atLeastOneSepFirstInternalLogic(e,t,r)},e.prototype.atLeastOneSepFirstInternalLogic=function(e,t,r){var n=this,a=t.DEF,s=t.SEP;if(!0!==this.getLaFuncFromCache(r).call(this))throw this.raiseEarlyExitException(e,i.PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG);a.call(this);for(var c=function(){return n.tokenMatcher(n.LA(1),s)};!0===this.tokenMatcher(this.LA(1),s);)this.CONSUME(s),a.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,s,c,a,u.NextTerminalAfterAtLeastOneSepWalker],c,o.AT_LEAST_ONE_SEP_IDX,e,u.NextTerminalAfterAtLeastOneSepWalker)},e.prototype.manyInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(o.MANY_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{return this.manyInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.manyInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(o.MANY_IDX,e);return this.manyInternalLogic(e,t,r)},e.prototype.manyInternalLogic=function(e,t,r){var n,a,i=this,s=this.getLaFuncFromCache(r);if(void 0!==t.DEF){if(n=t.DEF,void 0!==(a=t.GATE)){var c=s;s=function(){return a.call(i)&&c.call(i)}}}else n=t;for(var l=!0;!0===s.call(this)&&!0===l;)l=this.doSingleRepetition(n);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],s,o.MANY_IDX,e,u.NextTerminalAfterManyWalker,l)},e.prototype.manySepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(o.MANY_SEP_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{this.manySepFirstInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.manySepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(o.MANY_SEP_IDX,e);this.manySepFirstInternalLogic(e,t,r)},e.prototype.manySepFirstInternalLogic=function(e,t,r){var n=this,a=t.DEF,i=t.SEP;if(!0===this.getLaFuncFromCache(r).call(this)){a.call(this);for(var s=function(){return n.tokenMatcher(n.LA(1),i)};!0===this.tokenMatcher(this.LA(1),i);)this.CONSUME(i),a.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,i,s,a,u.NextTerminalAfterManySepWalker],s,o.MANY_SEP_IDX,e,u.NextTerminalAfterManySepWalker)}},e.prototype.repetitionSepSecondInternal=function(e,t,r,n,a){for(;r();)this.CONSUME(t),n.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,r,n,a],r,o.AT_LEAST_ONE_SEP_IDX,e,a)},e.prototype.doSingleRepetition=function(e){var t=this.getLexerPosition();return e.call(this),this.getLexerPosition()>t},e.prototype.orInternalNoCst=function(e,t){var r=Object(n.isArray)(e)?e:e.DEF,a=this.getKeyForAutomaticLookahead(o.OR_IDX,t),i=this.getLaFuncFromCache(a).call(this,r);if(void 0!==i)return r[i].ALT.call(this);this.raiseNoAltException(t,e.ERR_MSG)},e.prototype.orInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(o.OR_IDX,t),a=this.nestedRuleBeforeClause(e,r);try{var i=Object(n.isArray)(e)?e:e.DEF,u=this.getLaFuncFromCache(r).call(this,i);if(void 0!==u){var s=i[u],c=this.nestedAltBeforeClause(s,t,o.OR_IDX,u);try{return s.ALT.call(this)}finally{void 0!==c&&this.nestedRuleFinallyClause(c.shortName,c.nestedName)}}this.raiseNoAltException(t,e.ERR_MSG)}finally{void 0!==a&&this.nestedRuleFinallyClause(r,a)}},e.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),0===this.RULE_STACK.length&&!1===this.isAtEndOfInput()){var e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new a.NotAllInputParsedException(t,e))}},e.prototype.subruleInternal=function(e,t,r){var n;try{var o=void 0!==r?r.ARGS:void 0;return n=e.call(this,t,o),this.cstPostNonTerminal(n,void 0!==r&&void 0!==r.LABEL?r.LABEL:e.ruleName),n}catch(t){this.subruleInternalError(t,r,e.ruleName)}},e.prototype.subruleInternalError=function(e,t,r){throw Object(a.isRecognitionException)(e)&&void 0!==e.partialCstResult&&(this.cstPostNonTerminal(e.partialCstResult,void 0!==t&&void 0!==t.LABEL?t.LABEL:r),delete e.partialCstResult),e},e.prototype.consumeInternal=function(e,t,r){var n;try{var o=this.LA(1);!0===this.tokenMatcher(o,e)?(this.consumeToken(),n=o):this.consumeInternalError(e,o,r)}catch(r){n=this.consumeInternalRecovery(e,t,r)}return this.cstPostTerminal(void 0!==r&&void 0!==r.LABEL?r.LABEL:e.name,n),n},e.prototype.consumeInternalError=function(e,t,r){var n,o=this.LA(0);throw n=void 0!==r&&r.ERR_MSG?r.ERR_MSG:this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:o,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new a.MismatchedTokenException(n,t,o))},e.prototype.consumeInternalRecovery=function(e,t,r){if(!this.recoveryEnabled||"MismatchedTokenException"!==r.name||this.isBackTracking())throw r;var n=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,n)}catch(e){throw e.name===c.IN_RULE_RECOVERY_EXCEPTION?r:e}},e.prototype.saveRecogState=function(){var e=this.errors,t=Object(n.cloneArr)(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},e.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},e.prototype.ruleInvocationStateUpdate=function(e,t,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t,e)},e.prototype.isBackTracking=function(){return 0!==this.isBackTrackingStack.length},e.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},e.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},e.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),l.EOF)},e.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"ErrorHandler",(function(){return u}));var n=r(189),o=r(164),a=r(184),i=r(163),u=function(){function e(){}return e.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=Object(o.defaults)(e.errorMessageProvider,i.DEFAULT_PARSER_CONFIG.errorMessageProvider)},e.prototype.SAVE_ERROR=function(e){if(Object(n.isRecognitionException)(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:Object(o.cloneArr)(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(e.prototype,"errors",{get:function(){return Object(o.cloneArr)(this._errors)},set:function(e){this._errors=e},enumerable:!0,configurable:!0}),e.prototype.raiseEarlyExitException=function(e,t,r){for(var o=this.getCurrRuleFullName(),i=this.getGAstProductions()[o],u=Object(a.getLookaheadPathsForOptionalProd)(e,i,t,this.maxLookahead)[0],s=[],c=1;c<=this.maxLookahead;c++)s.push(this.LA(c));var l=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:u,actual:s,previous:this.LA(0),customUserDescription:r,ruleName:o});throw this.SAVE_ERROR(new n.EarlyExitException(l,this.LA(1),this.LA(0)))},e.prototype.raiseNoAltException=function(e,t){for(var r=this.getCurrRuleFullName(),o=this.getGAstProductions()[r],i=Object(a.getLookaheadPathsForOr)(e,o,this.maxLookahead),u=[],s=1;s<=this.maxLookahead;s++)u.push(this.LA(s));var c=this.LA(0),l=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:i,actual:u,previous:c,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new n.NoViableAltException(l,this.LA(1),c))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"ContentAssist",(function(){return a}));var n=r(185),o=r(164),a=function(){function e(){}return e.prototype.initContentAssist=function(){},e.prototype.computeContentAssist=function(e,t){var r=this.gastProductionsCache[e];if(Object(o.isUndefined)(r))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return Object(n.nextPossibleTokensAfter)([r],t,this.tokenMatcher,this.maxLookahead)},e.prototype.getNextPossibleTokenTypes=function(e){var t=Object(o.first)(e.ruleStack),r=this.getGAstProductions()[t];return new n.NextAfterTokenWalker(r,e).startWalking()},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"GastRecorder",(function(){return m}));var n=r(164),o=r(167),a=r(169),i=r(174),u=r(168),s=r(163),c=r(181),l={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(l);var f=Math.pow(2,c.BITS_FOR_OCCURRENCE_IDX)-1,p=Object(u.createToken)({name:"RECORDING_PHASE_TOKEN",pattern:a.Lexer.NA});Object(i.augmentTokenTypes)([p]);var h=Object(u.createTokenInstance)(p,"This IToken indicates the Parser is in Recording Phase\n\tSee: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details",-1,-1,-1,-1,-1,-1);Object.freeze(h);var d={name:"This CSTNode indicates the Parser is in Recording Phase\n\tSee: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details",children:{}},m=function(){function e(){}return e.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},e.prototype.enableRecording=function(){var e=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",(function(){for(var t=function(t){var r=t>0?t:"";e["CONSUME"+r]=function(e,r){return this.consumeInternalRecord(e,t,r)},e["SUBRULE"+r]=function(e,r){return this.subruleInternalRecord(e,t,r)},e["OPTION"+r]=function(e){return this.optionInternalRecord(e,t)},e["OR"+r]=function(e){return this.orInternalRecord(e,t)},e["MANY"+r]=function(e){this.manyInternalRecord(t,e)},e["MANY_SEP"+r]=function(e){this.manySepFirstInternalRecord(t,e)},e["AT_LEAST_ONE"+r]=function(e){this.atLeastOneInternalRecord(t,e)},e["AT_LEAST_ONE_SEP"+r]=function(e){this.atLeastOneSepFirstInternalRecord(t,e)}},r=0;r<10;r++)t(r);e.consume=function(e,t,r){return this.consumeInternalRecord(t,e,r)},e.subrule=function(e,t,r){return this.subruleInternalRecord(t,e,r)},e.option=function(e,t){return this.optionInternalRecord(t,e)},e.or=function(e,t){return this.orInternalRecord(t,e)},e.many=function(e,t){this.manyInternalRecord(e,t)},e.atLeastOne=function(e,t){this.atLeastOneInternalRecord(e,t)},e.ACTION=e.ACTION_RECORD,e.BACKTRACK=e.BACKTRACK_RECORD,e.LA=e.LA_RECORD}))},e.prototype.disableRecording=function(){var e=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",(function(){for(var t=0;t<10;t++){var r=t>0?t:"";delete e["CONSUME"+r],delete e["SUBRULE"+r],delete e["OPTION"+r],delete e["OR"+r],delete e["MANY"+r],delete e["MANY_SEP"+r],delete e["AT_LEAST_ONE"+r],delete e["AT_LEAST_ONE_SEP"+r]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA}))},e.prototype.ACTION_RECORD=function(e){},e.prototype.BACKTRACK_RECORD=function(e,t){return function(){return!0}},e.prototype.LA_RECORD=function(e){return s.END_OF_FILE},e.prototype.topLevelRuleRecord=function(e,t){try{var r=new o.Rule({definition:[],name:e});return r.name=e,this.recordingProdStack.push(r),t.call(this),this.recordingProdStack.pop(),r}catch(e){if(!0!==e.KNOWN_RECORDER_ERROR)try{e.message=e.message+'\n\t This error was thrown during the "grammar recording phase" For more info see:\n\thttps://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording'}catch(t){throw e}throw e}},e.prototype.optionInternalRecord=function(e,t){return y.call(this,o.Option,e,t)},e.prototype.atLeastOneInternalRecord=function(e,t){y.call(this,o.RepetitionMandatory,t,e)},e.prototype.atLeastOneSepFirstInternalRecord=function(e,t){y.call(this,o.RepetitionMandatoryWithSeparator,t,e,!0)},e.prototype.manyInternalRecord=function(e,t){y.call(this,o.Repetition,t,e)},e.prototype.manySepFirstInternalRecord=function(e,t){y.call(this,o.RepetitionWithSeparator,t,e,!0)},e.prototype.orInternalRecord=function(e,t){return g.call(this,e,t)},e.prototype.subruleInternalRecord=function(e,t,r){if(E(t),!e||!1===Object(n.has)(e,"ruleName")){var a=new Error("<SUBRULE"+v(t)+"> argument is invalid expecting a Parser method reference but got: <"+JSON.stringify(e)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw a.KNOWN_RECORDER_ERROR=!0,a}var i=Object(n.peek)(this.recordingProdStack),u=e.ruleName,s=new o.NonTerminal({idx:t,nonTerminalName:u,referencedRule:void 0});return i.definition.push(s),this.outputCst?d:l},e.prototype.consumeInternalRecord=function(e,t,r){if(E(t),!Object(i.hasShortKeyProperty)(e)){var a=new Error("<CONSUME"+v(t)+"> argument is invalid expecting a TokenType reference but got: <"+JSON.stringify(e)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw a.KNOWN_RECORDER_ERROR=!0,a}var u=Object(n.peek)(this.recordingProdStack),s=new o.Terminal({idx:t,terminalType:e});return u.definition.push(s),h},e}();function y(e,t,r,o){void 0===o&&(o=!1),E(r);var a=Object(n.peek)(this.recordingProdStack),i=Object(n.isFunction)(t)?t:t.DEF,u=new e({definition:[],idx:r});return Object(n.has)(t,"NAME")&&(u.name=t.NAME),o&&(u.separator=t.SEP),Object(n.has)(t,"MAX_LOOKAHEAD")&&(u.maxLookahead=t.MAX_LOOKAHEAD),this.recordingProdStack.push(u),i.call(this),a.definition.push(u),this.recordingProdStack.pop(),l}function g(e,t){var r=this;E(t);var a=Object(n.peek)(this.recordingProdStack),i=!1===Object(n.isArray)(e),u=!1===i?e:e.DEF,s=new o.Alternation({definition:[],idx:t,ignoreAmbiguities:i&&!0===e.IGNORE_AMBIGUITIES});Object(n.has)(e,"NAME")&&(s.name=e.NAME),Object(n.has)(e,"MAX_LOOKAHEAD")&&(s.maxLookahead=e.MAX_LOOKAHEAD);var c=Object(n.some)(u,(function(e){return Object(n.isFunction)(e.GATE)}));return s.hasPredicates=c,a.definition.push(s),Object(n.forEach)(u,(function(e){var t=new o.Flat({definition:[]});s.definition.push(t),Object(n.has)(e,"NAME")&&(t.name=e.NAME),Object(n.has)(e,"IGNORE_AMBIGUITIES")?t.ignoreAmbiguities=e.IGNORE_AMBIGUITIES:Object(n.has)(e,"GATE")&&(t.ignoreAmbiguities=!0),r.recordingProdStack.push(t),e.ALT.call(r),r.recordingProdStack.pop()})),l}function v(e){return 0===e?"":""+e}function E(e){if(e<0||e>f){var t=new Error("Invalid DSL Method idx value: <"+e+">\n\tIdx value must be a none negative value smaller than "+(f+1));throw t.KNOWN_RECORDER_ERROR=!0,t}}},function(e,t,r){"use strict";r.r(t),r.d(t,"PerformanceTracer",(function(){return a}));var n=r(164),o=r(163),a=function(){function e(){}return e.prototype.initPerformanceTracer=function(e){if(Object(n.has)(e,"traceInitPerf")){var t=e.traceInitPerf,r="number"==typeof t;this.traceInitMaxIdent=r?t:1/0,this.traceInitPerf=r?t>0:t}else this.traceInitMaxIdent=0,this.traceInitPerf=o.DEFAULT_PARSER_CONFIG.traceInitPerf;this.traceInitIndent=-1},e.prototype.TRACE_INIT=function(e,t){if(!0===this.traceInitPerf){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--\x3e <"+e+">");var o=Object(n.timer)(t),a=o.time,i=o.value,u=a>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&u(r+"<-- <"+e+"> time: "+a+"ms"),this.traceInitIndent--,i}return t()},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"createSyntaxDiagramsCode",(function(){return o}));var n=r(162);function o(e,t){var r=void 0===t?{}:t,o=r.resourceBase,a=void 0===o?"https://unpkg.com/chevrotain@"+n.VERSION+"/diagrams/":o,i=r.css;return"\n\x3c!-- This is a generated file --\x3e\n<!DOCTYPE html>\n<meta charset=\"utf-8\">\n<style>\n  body {\n    background-color: hsl(30, 20%, 95%)\n  }\n</style>\n\n\n<link rel='stylesheet' href='"+(void 0===i?"https://unpkg.com/chevrotain@"+n.VERSION+"/diagrams/diagrams.css":i)+"'>\n\n<script src='"+a+"vendor/railroad-diagrams.js'><\/script>\n<script src='"+a+"src/diagrams_builder.js'><\/script>\n<script src='"+a+"src/diagrams_behavior.js'><\/script>\n<script src='"+a+'src/main.js\'><\/script>\n\n<div id="diagrams" align="center"></div>    \n\n<script>\n    window.serializedGrammar = '+JSON.stringify(e,null,"  ")+';\n<\/script>\n\n<script>\n    var diagramsDiv = document.getElementById("diagrams");\n    main.drawDiagramsFromSerializedGrammar(serializedGrammar, diagramsDiv);\n<\/script>\n'}},function(e,t,r){"use strict";r.r(t),r.d(t,"generateParserFactory",(function(){return o})),r.d(t,"generateParserModule",(function(){return a}));var n=r(203);function o(e){var t=Object(n.genWrapperFunction)({name:e.name,rules:e.rules}),o=new Function("tokenVocabulary","config","chevrotain",t);return function(t){return o(e.tokenVocabulary,t,r(161))}}function a(e){return Object(n.genUmdModule)({name:e.name,rules:e.rules})}},function(e,t,r){"use strict";r.r(t),r.d(t,"genUmdModule",(function(){return i})),r.d(t,"genWrapperFunction",(function(){return u})),r.d(t,"genClass",(function(){return s})),r.d(t,"genAllRules",(function(){return c})),r.d(t,"genRule",(function(){return l})),r.d(t,"genTerminal",(function(){return f})),r.d(t,"genNonTerminal",(function(){return p})),r.d(t,"genAlternation",(function(){return h})),r.d(t,"genSingleAlt",(function(){return d}));var n=r(164),o=r(167),a="\n";function i(e){return"\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(['chevrotain'], factory);\n    } else if (typeof module === 'object' && module.exports) {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory(require('chevrotain'));\n    } else {\n        // Browser globals (root is window)\n        root.returnExports = factory(root.b);\n    }\n}(typeof self !== 'undefined' ? self : this, function (chevrotain) {\n\n"+s(e)+"\n    \nreturn {\n    "+e.name+": "+e.name+" \n}\n}));\n"}function u(e){return"    \n"+s(e)+"\nreturn new "+e.name+"(tokenVocabulary, config)    \n"}function s(e){return"\nfunction "+e.name+"(tokenVocabulary, config) {\n    // invoke super constructor\n    // No support for embedded actions currently, so we can 'hardcode'\n    // The use of CstParser.\n    chevrotain.CstParser.call(this, tokenVocabulary, config)\n\n    const $ = this\n\n    "+c(e.rules)+"\n\n    // very important to call this after all the rules have been defined.\n    // otherwise the parser may not work correctly as it will lack information\n    // derived during the self analysis phase.\n    this.performSelfAnalysis(this)\n}\n\n// inheritance as implemented in javascript in the previous decade... :(\n"+e.name+".prototype = Object.create(chevrotain.CstParser.prototype)\n"+e.name+".prototype.constructor = "+e.name+"    \n    "}function c(e){return Object(n.map)(e,(function(e){return l(e,1)})).join("\n")}function l(e,t){var r=v(t,'$.RULE("'+e.name+'", function() {')+a;return r+=g(e.definition,t+1),r+=v(t+1,"})")+a}function f(e,t){var r=e.terminalType.name;return v(t,"$.CONSUME"+e.idx+"(this.tokensMap."+r+")"+a)}function p(e,t){return v(t,"$.SUBRULE"+e.idx+"($."+e.nonTerminalName+")"+a)}function h(e,t){var r=v(t,"$.OR"+e.idx+"([")+a;return r+=Object(n.map)(e.definition,(function(e){return d(e,t+1)})).join(",\n"),r+=a+v(t,"])\n")}function d(e,t){var r=v(t,"{")+a;return e.name&&(r+=v(t+1,'NAME: "'+e.name+'",')+a),r+=v(t+1,"ALT: function() {")+a,r+=g(e.definition,t+1),r+=v(t+1,"}")+a,r+=v(t,"}")}function m(e,t,r){var n=v(r,"$."+(e+t.idx)+"(");return t.name||t.separator?(n+="{\n",t.name&&(n+=v(r+1,'NAME: "'+t.name+'"')+","+a),t.separator&&(n+=v(r+1,"SEP: this.tokensMap."+t.separator.name)+","+a),n+="DEF: "+y(t.definition,r+2)+a,n+=v(r,"}")+a):n+=y(t.definition,r+1),n+=v(r,")")+a}function y(e,t){var r="function() {\n";return r+=g(e,t),r+=v(t,"}")+a}function g(e,t){var r="";return Object(n.forEach)(e,(function(e){r+=function(e,t){if(e instanceof o.NonTerminal)return p(e,t);if(e instanceof o.Option)return m("OPTION",e,t);if(e instanceof o.RepetitionMandatory)return m("AT_LEAST_ONE",e,t);if(e instanceof o.RepetitionMandatoryWithSeparator)return m("AT_LEAST_ONE_SEP",e,t);if(e instanceof o.RepetitionWithSeparator)return m("MANY_SEP",e,t);if(e instanceof o.Repetition)return m("MANY",e,t);if(e instanceof o.Alternation)return h(e,t);if(e instanceof o.Terminal)return f(e,t);if(e instanceof o.Flat)return g(e.definition,t);throw Error("non exhaustive match")}(e,t+1)})),r}function v(e,t){return Array(4*e+1).join(" ")+t}},function(e,t,r){"use strict";t.__esModule=!0,t.RowAddress=void 0,r(125);var n=r(115),o=r(159);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sheet=t,this.row=r,this.type=n}var t,r,i;return t=e,i=[{key:"absolute",value:function(t,r){return new e(t,r,o.ReferenceType.ABSOLUTE)}},{key:"relative",value:function(t,r){return new e(t,r,o.ReferenceType.RELATIVE)}}],(r=[{key:"isRowAbsolute",value:function(){return this.type===o.ReferenceType.ABSOLUTE}},{key:"isRowRelative",value:function(){return this.type===o.ReferenceType.RELATIVE}},{key:"isAbsolute",value:function(){return this.type===o.ReferenceType.ABSOLUTE&&null!==this.sheet}},{key:"moved",value:function(t,r,n){return new e(null===this.sheet?null:t,this.row+n,this.type)}},{key:"shiftedByRows",value:function(t){return new e(this.sheet,this.row+t,this.type)}},{key:"toSimpleRowAddress",value:function(e){var t=(0,n.absoluteSheetReference)(this,e),r=this.row;return this.isRowRelative()&&(r=e.row+this.row),(0,n.simpleRowAddress)(t,r)}},{key:"shiftRelativeDimensions",value:function(t,r){var n=this.isRowRelative()?this.row+r:this.row;return new e(this.sheet,n,this.type)}},{key:"shiftAbsoluteDimensions",value:function(t,r){var n=this.isRowAbsolute()?this.row+r:this.row;return new e(this.sheet,n,this.type)}},{key:"withAbsoluteSheet",value:function(t){return new e(t,this.row,this.type)}},{key:"isInvalid",value:function(e){return this.toSimpleRowAddress(e).row<0}},{key:"hash",value:function(e){var t=e&&null!==this.sheet?"#".concat(this.sheet):"";switch(this.type){case o.ReferenceType.RELATIVE:return"".concat(t,"#ROWR").concat(this.row);case o.ReferenceType.ABSOLUTE:return"".concat(t,"#ROWA").concat(this.row)}}},{key:"unparse",value:function(e){var t=this.toSimpleRowAddress(e);if(!(0,n.invalidSimpleRowAddress)(t)){var r=this.type===o.ReferenceType.ABSOLUTE?"$":"";return"".concat(r).concat(t.row+1)}}},{key:"exceedsSheetSizeLimits",value:function(e){return this.row>=e}}])&&a(t.prototype,r),i&&a(t,i),e}();t.RowAddress=i},function(e,t,r){"use strict";r(87),r(93),r(63),r(94),r(95),r(77),r(97),r(67),r(68),t.__esModule=!0,t.bindWhitespacesToTokens=g,t.ParserWithCaching=void 0,r(121),r(116),r(125),r(53),r(146),r(151),r(206);var n=r(161),o=r(115),a=r(141),i=r(142),u=r(207),s=r(208),c=r(209),l=r(211),f=r(160),p=r(216);function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var y=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.functionRegistry=r,this.sheetMapping=n,this.statsCacheUsed=0,this.lexerConfig=(0,f.buildLexerConfig)(t),this.lexer=new l.FormulaLexer(this.lexerConfig),this.formulaParser=new l.FormulaParser(this.lexerConfig,this.sheetMapping),this.cache=new c.Cache(this.functionRegistry)}var t,r,d;return t=e,(r=[{key:"parse",value:function(e,t){var r=this.lexer.tokenizeFormula(e);if(r.errors.length>0){var n=r.errors.map((function(e){return{type:u.ParsingErrorType.LexingError,message:e.message}}));return{ast:(0,a.buildParsingErrorAst)(),errors:n,hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]}}var o=this.computeHashFromTokens(r.tokens,t),i=this.cache.get(o);if(i)++this.statsCacheUsed;else{var s=g(r.tokens),c=this.formulaParser.parseFromTokens(s,t);if(c.errors.length>0)return Object.assign(Object.assign({},c),{hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]});i=this.cache.set(o,c.ast)}var l=i;return{ast:l.ast,errors:[],hasVolatileFunction:l.hasVolatileFunction,hasStructuralChangeFunction:l.hasStructuralChangeFunction,dependencies:l.relativeDependencies}}},{key:"fetchCachedResultForAst",value:function(e){var t=this.computeHashFromAst(e);return this.fetchCachedResult(t)}},{key:"fetchCachedResult",value:function(e){var t=this.cache.get(e);if(null===t)throw new Error("There is no AST with such key in the cache");return{ast:t.ast,errors:[],hasVolatileFunction:t.hasVolatileFunction,hasStructuralChangeFunction:t.hasStructuralChangeFunction,dependencies:t.relativeDependencies}}},{key:"computeHashFromTokens",value:function(e,t){for(var r,o="",a=0;a<e.length;){var u=e[a];if((0,n.tokenMatcher)(u,f.CellReference)){var s=(0,i.cellAddressFromString)(this.sheetMapping,u.image,t);o=void 0===s?o.concat(u.image):o.concat(s.hash(!0))}else if((0,n.tokenMatcher)(u,f.ProcedureName)){var c=u.image.toUpperCase().slice(0,-1),l=null!==(r=this.lexerConfig.functionMapping[c])&&void 0!==r?r:c;o=o.concat(l,"(")}else if((0,n.tokenMatcher)(u,f.ColumnRange)){var p=h(u.image.split(":"),2),d=p[0],m=p[1],y=(0,i.columnAddressFromString)(this.sheetMapping,d,t),g=(0,i.columnAddressFromString)(this.sheetMapping,m,t);o=void 0===y||void 0===g?o.concat("!REF"):o.concat(y.hash(!0),":",g.hash(!0))}else if((0,n.tokenMatcher)(u,f.RowRange)){var v=h(u.image.split(":"),2),E=v[0],T=v[1],b=(0,i.rowAddressFromString)(this.sheetMapping,E,t),R=(0,i.rowAddressFromString)(this.sheetMapping,T,t);o=void 0===b||void 0===R?o.concat("!REF"):o.concat(b.hash(!0),":",R.hash(!0))}else o=o.concat(u.image);a++}return o}},{key:"rememberNewAst",value:function(e){var t=this.computeHashFromAst(e);return this.cache.maybeSetAndThenGet(t,e)}},{key:"computeHashFromAst",value:function(e){return"="+this.computeHashOfAstNode(e)}},{key:"destroy",value:function(){this.cache.destroy()}},{key:"computeHashOfAstNode",value:function(e){var t=this;switch(e.type){case a.AstNodeType.EMPTY:return e.leadingWhitespace||"";case a.AstNodeType.NUMBER:return(0,u.imageWithWhitespace)((0,p.formatNumber)(e.value,this.config.decimalSeparator),e.leadingWhitespace);case a.AstNodeType.STRING:return(0,u.imageWithWhitespace)('"'+e.value+'"',e.leadingWhitespace);case a.AstNodeType.NAMED_EXPRESSION:return(0,u.imageWithWhitespace)(e.expressionName,e.leadingWhitespace);case a.AstNodeType.FUNCTION_CALL:var r=e.args.map((function(e){return t.computeHashOfAstNode(e)})).join(this.config.functionArgSeparator),n=e.procedureName+"("+r+(0,u.imageWithWhitespace)(")",e.internalWhitespace);return(0,u.imageWithWhitespace)(n,e.leadingWhitespace);case a.AstNodeType.CELL_REFERENCE:return(0,u.imageWithWhitespace)(e.reference.hash(!0),e.leadingWhitespace);case a.AstNodeType.COLUMN_RANGE:case a.AstNodeType.ROW_RANGE:case a.AstNodeType.CELL_RANGE:var i=e.start.hash(e.sheetReferenceType!==u.RangeSheetReferenceType.RELATIVE),c=e.end.hash(e.sheetReferenceType===u.RangeSheetReferenceType.BOTH_ABSOLUTE);return(0,u.imageWithWhitespace)(i+":"+c,e.leadingWhitespace);case a.AstNodeType.MINUS_UNARY_OP:return(0,u.imageWithWhitespace)("-"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case a.AstNodeType.PLUS_UNARY_OP:return(0,u.imageWithWhitespace)("+"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case a.AstNodeType.PERCENT_OP:return this.computeHashOfAstNode(e.value)+(0,u.imageWithWhitespace)("%",e.leadingWhitespace);case a.AstNodeType.ERROR:var l=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:o.ErrorType.ERROR);return(0,u.imageWithWhitespace)(l,e.leadingWhitespace);case a.AstNodeType.ERROR_WITH_RAW_INPUT:return(0,u.imageWithWhitespace)(e.rawInput,e.leadingWhitespace);case a.AstNodeType.PARENTHESIS:var f="("+this.computeHashOfAstNode(e.expression)+(0,u.imageWithWhitespace)(")",e.internalWhitespace);return(0,u.imageWithWhitespace)(f,e.leadingWhitespace);default:return this.computeHashOfAstNode(e.left)+(0,u.imageWithWhitespace)(s.binaryOpTokenMap[e.type],e.leadingWhitespace)+this.computeHashOfAstNode(e.right)}}}])&&m(t.prototype,r),d&&m(t,d),e}();function g(e){var t=[],r=e[0];(0,n.tokenMatcher)(r,f.WhiteSpace)||t.push(r);for(var o=1;o<e.length;++o){var a=e[o];if(!(0,n.tokenMatcher)(a,f.WhiteSpace)){var i=e[o-1];(0,n.tokenMatcher)(i,f.WhiteSpace)&&(a.leadingWhitespace=i),t.push(a)}}return t}t.ParserWithCaching=y},function(e,t,r){"use strict";var n=r(2),o=r(11),a=r(10),i=r(128),u=[].join,s=o!=Object,c=i("join",",");n({target:"Array",proto:!0,forced:s||!c},{join:function(e){return u.call(a(this),void 0===e?",":e)}})},function(e,t,r){"use strict";t.__esModule=!0,t.imageWithWhitespace=function(e,t){return(null!=t?t:"")+e},t.buildParsingErrorAst=t.buildErrorWithRawInputAst=t.buildCellErrorAst=t.buildParenthesisAst=t.buildNamedExpressionAst=t.buildProcedureAst=t.buildPercentOpAst=t.buildPlusUnaryOpAst=t.buildMinusUnaryOpAst=t.buildPowerOpAst=t.buildDivOpAst=t.buildTimesOpAst=t.buildMinusOpAst=t.buildPlusOpAst=t.buildLessThanOrEqualOpAst=t.buildGreaterThanOrEqualOpAst=t.buildLessThanOpAst=t.buildGreaterThanOpAst=t.buildNotEqualOpAst=t.buildEqualsOpAst=t.buildConcatenateOpAst=t.buildRowRangeAst=t.buildColumnRangeAst=t.buildCellRangeAst=t.buildCellReferenceAst=t.buildStringAst=t.buildNumberAst=t.buildEmptyArgAst=t.RangeSheetReferenceType=t.AstNodeType=t.ParsingErrorType=t.parsingError=void 0,r(53);var n,o,a,i=r(115);
/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */function u(e,t,r){if(null!==e.sheet&&null===t.sheet||null===e.sheet&&null!==t.sheet)throw new Error("Start address inconsistent with end address");if(null===e.sheet&&r!==a.RELATIVE||null!==e.sheet&&r===a.RELATIVE)throw new Error("Sheet address inconsistent with sheet reference type")}t.parsingError=function(e,t){return{type:e,message:t}},t.ParsingErrorType=n,function(e){e.LexingError="LexingError",e.ParserError="ParsingError",e.StaticOffsetError="StaticOffsetError",e.StaticOffsetOutOfRangeError="StaticOffsetOutOfRangeError",e.RangeOffsetNotAllowed="RangeOffsetNotAllowed"}(n||(t.ParsingErrorType=n={})),t.AstNodeType=o,function(e){e.EMPTY="EMPTY",e.NUMBER="NUMBER",e.STRING="STRING",e.MINUS_UNARY_OP="MINUS_UNARY_OP",e.PLUS_UNARY_OP="PLUS_UNARY_OP",e.PERCENT_OP="PERCENT_OP",e.CONCATENATE_OP="CONCATENATE_OP",e.EQUALS_OP="EQUALS_OP",e.NOT_EQUAL_OP="NOT_EQUAL_OP",e.GREATER_THAN_OP="GREATER_THAN_OP",e.LESS_THAN_OP="LESS_THAN_OP",e.GREATER_THAN_OR_EQUAL_OP="GREATER_THAN_OR_EQUAL_OP",e.LESS_THAN_OR_EQUAL_OP="LESS_THAN_OR_EQUAL_OP",e.PLUS_OP="PLUS_OP",e.MINUS_OP="MINUS_OP",e.TIMES_OP="TIMES_OP",e.DIV_OP="DIV_OP",e.POWER_OP="POWER_OP",e.FUNCTION_CALL="FUNCTION_CALL",e.NAMED_EXPRESSION="NAMED_EXPRESSION",e.PARENTHESIS="PARENTHESES",e.CELL_REFERENCE="CELL_REFERENCE",e.CELL_RANGE="CELL_RANGE",e.COLUMN_RANGE="COLUMN_RANGE",e.ROW_RANGE="ROW_RANGE",e.ERROR="ERROR",e.ERROR_WITH_RAW_INPUT="ERROR_WITH_RAW_INPUT"}(o||(t.AstNodeType=o={})),t.RangeSheetReferenceType=a,function(e){e[e.RELATIVE=0]="RELATIVE",e[e.START_ABSOLUTE=1]="START_ABSOLUTE",e[e.BOTH_ABSOLUTE=2]="BOTH_ABSOLUTE"}(a||(t.RangeSheetReferenceType=a={})),t.buildEmptyArgAst=function(e){return{type:o.EMPTY,leadingWhitespace:null==e?void 0:e.image}},t.buildNumberAst=function(e,t){return{type:o.NUMBER,value:e,leadingWhitespace:null==t?void 0:t.image}},t.buildStringAst=function(e){var t;return{type:o.STRING,value:e.image.slice(1,-1),leadingWhitespace:null===(t=e.leadingWhitespace)||void 0===t?void 0:t.image}},t.buildCellReferenceAst=function(e,t){return{type:o.CELL_REFERENCE,reference:e,leadingWhitespace:null==t?void 0:t.image}},t.buildCellRangeAst=function(e,t,r,n){return u(e,t,r),{type:o.CELL_RANGE,start:e,end:t,sheetReferenceType:r,leadingWhitespace:n}},t.buildColumnRangeAst=function(e,t,r,n){return u(e,t,r),{type:o.COLUMN_RANGE,start:e,end:t,sheetReferenceType:r,leadingWhitespace:null==n?void 0:n.image}},t.buildRowRangeAst=function(e,t,r,n){return u(e,t,r),{type:o.ROW_RANGE,start:e,end:t,sheetReferenceType:r,leadingWhitespace:null==n?void 0:n.image}},t.buildConcatenateOpAst=function(e,t,r){return{type:o.CONCATENATE_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}},t.buildEqualsOpAst=function(e,t,r){return{type:o.EQUALS_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}},t.buildNotEqualOpAst=function(e,t,r){return{type:o.NOT_EQUAL_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}},t.buildGreaterThanOpAst=function(e,t,r){return{type:o.GREATER_THAN_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}},t.buildLessThanOpAst=function(e,t,r){return{type:o.LESS_THAN_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}},t.buildGreaterThanOrEqualOpAst=function(e,t,r){return{type:o.GREATER_THAN_OR_EQUAL_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}},t.buildLessThanOrEqualOpAst=function(e,t,r){return{type:o.LESS_THAN_OR_EQUAL_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}},t.buildPlusOpAst=function(e,t,r){return{type:o.PLUS_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}},t.buildMinusOpAst=function(e,t,r){return{type:o.MINUS_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}},t.buildTimesOpAst=function(e,t,r){return{type:o.TIMES_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}},t.buildDivOpAst=function(e,t,r){return{type:o.DIV_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}},t.buildPowerOpAst=function(e,t,r){return{type:o.POWER_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}},t.buildMinusUnaryOpAst=function(e,t){return{type:o.MINUS_UNARY_OP,value:e,leadingWhitespace:null==t?void 0:t.image}},t.buildPlusUnaryOpAst=function(e,t){return{type:o.PLUS_UNARY_OP,value:e,leadingWhitespace:null==t?void 0:t.image}},t.buildPercentOpAst=function(e,t){return{type:o.PERCENT_OP,value:e,leadingWhitespace:null==t?void 0:t.image}},t.buildProcedureAst=function(e,t,r,n){return{type:o.FUNCTION_CALL,procedureName:e,args:t,leadingWhitespace:null==r?void 0:r.image,internalWhitespace:null==n?void 0:n.image}},t.buildNamedExpressionAst=function(e,t){return{type:o.NAMED_EXPRESSION,expressionName:e,leadingWhitespace:null==t?void 0:t.image}},t.buildParenthesisAst=function(e,t,r){return{type:o.PARENTHESIS,expression:e,leadingWhitespace:null==t?void 0:t.image,internalWhitespace:null==r?void 0:r.image}},t.buildCellErrorAst=function(e,t){return{type:o.ERROR,error:e,leadingWhitespace:null==t?void 0:t.image}},t.buildErrorWithRawInputAst=function(e,t,r){return{type:o.ERROR_WITH_RAW_INPUT,error:t,rawInput:e,leadingWhitespace:null==r?void 0:r.image}},t.buildParsingErrorAst=function(){return{type:o.ERROR,error:i.CellError.parsingError()}}},function(e,t,r){"use strict";t.__esModule=!0,t.binaryOpTokenMap=void 0;var n,o=r(207);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i=(a(n={},o.AstNodeType.PLUS_OP,"+"),a(n,o.AstNodeType.MINUS_OP,"-"),a(n,o.AstNodeType.TIMES_OP,"*"),a(n,o.AstNodeType.DIV_OP,"/"),a(n,o.AstNodeType.CONCATENATE_OP,"&"),a(n,o.AstNodeType.POWER_OP,"^"),a(n,o.AstNodeType.EQUALS_OP,"="),a(n,o.AstNodeType.NOT_EQUAL_OP,"<>"),a(n,o.AstNodeType.GREATER_THAN_OP,">"),a(n,o.AstNodeType.GREATER_THAN_OR_EQUAL_OP,">="),a(n,o.AstNodeType.LESS_THAN_OP,"<"),a(n,o.AstNodeType.LESS_THAN_OR_EQUAL_OP,"<="),n);t.binaryOpTokenMap=i},function(e,t,r){"use strict";t.__esModule=!0,t.doesContainFunctions=t.Cache=void 0,r(95),r(210),r(63),r(77),r(97);var n=r(141);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.functionRegistry=t,this.cache=new Map}var t,r,a;return t=e,(r=[{key:"set",value:function(e,t){var r=function(e,t,r,n){return{ast:e,relativeDependencies:t,hasVolatileFunction:r,hasStructuralChangeFunction:n}}(t,(0,n.collectDependencies)(t,this.functionRegistry),i(t,this.functionRegistry.isFunctionVolatile),i(t,this.functionRegistry.isFunctionDependentOnSheetStructureChange));return this.cache.set(e,r),r}},{key:"get",value:function(e){return this.cache.get(e)||null}},{key:"maybeSetAndThenGet",value:function(e,t){var r=this.cache.get(e);return r?r.ast:(this.set(e,t),t)}},{key:"destroy",value:function(){this.cache.clear()}}])&&o(t.prototype,r),a&&o(t,a),e}();t.Cache=a;var i=function e(t,r){switch(t.type){case n.AstNodeType.EMPTY:case n.AstNodeType.NUMBER:case n.AstNodeType.STRING:case n.AstNodeType.ERROR:case n.AstNodeType.ERROR_WITH_RAW_INPUT:case n.AstNodeType.CELL_REFERENCE:case n.AstNodeType.CELL_RANGE:case n.AstNodeType.COLUMN_RANGE:case n.AstNodeType.ROW_RANGE:case n.AstNodeType.NAMED_EXPRESSION:return!1;case n.AstNodeType.PERCENT_OP:case n.AstNodeType.PLUS_UNARY_OP:case n.AstNodeType.MINUS_UNARY_OP:return e(t.value,r);case n.AstNodeType.CONCATENATE_OP:case n.AstNodeType.EQUALS_OP:case n.AstNodeType.NOT_EQUAL_OP:case n.AstNodeType.LESS_THAN_OP:case n.AstNodeType.GREATER_THAN_OP:case n.AstNodeType.LESS_THAN_OR_EQUAL_OP:case n.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case n.AstNodeType.MINUS_OP:case n.AstNodeType.PLUS_OP:case n.AstNodeType.TIMES_OP:case n.AstNodeType.DIV_OP:case n.AstNodeType.POWER_OP:return e(t.left,r)||e(t.right,r);case n.AstNodeType.PARENTHESIS:return e(t.expression,r);case n.AstNodeType.FUNCTION_CALL:return!!r(t.procedureName)||t.args.some((function(t){return e(t,r)}))}};t.doesContainFunctions=i},function(e,t,r){"use strict";var n=r(103),o=r(123);e.exports=n("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),o)},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(212),r(108),r(87),r(93),r(63),r(94),r(95),r(77),r(97),r(67),r(68),t.__esModule=!0,t.FormulaLexer=t.FormulaParser=void 0,r(53),r(146),r(151),r(125),r(156),r(138),r(121),r(213),r(109);var o=r(161),a=r(115),i=r(215),u=r(142),s=r(207),c=r(158),l=r(160);function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function m(e,t,r){return t&&d(e.prototype,t),r&&d(e,r),e}function y(e,t,r){return(y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=T(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=T(e);if(t){var o=T(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return E(this,r)}}function E(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(r,e);var t=v(r);function r(e,n){var i;return h(this,r),(i=t.call(this,e.allTokens,{outputCst:!1,maxLookahead:7})).formula=i.RULE("formula",(function(){return i.CONSUME(l.EqualsOp),i.SUBRULE(i.booleanExpression)})),i.booleanExpression=i.RULE("booleanExpression",(function(){var e=i.SUBRULE(i.concatenateExpression);return i.MANY((function(){var t=i.CONSUME(l.BooleanOp),r=i.SUBRULE2(i.concatenateExpression);(0,o.tokenMatcher)(t,l.EqualsOp)?e=(0,s.buildEqualsOpAst)(e,r,t.leadingWhitespace):(0,o.tokenMatcher)(t,l.NotEqualOp)?e=(0,s.buildNotEqualOpAst)(e,r,t.leadingWhitespace):(0,o.tokenMatcher)(t,l.GreaterThanOp)?e=(0,s.buildGreaterThanOpAst)(e,r,t.leadingWhitespace):(0,o.tokenMatcher)(t,l.LessThanOp)?e=(0,s.buildLessThanOpAst)(e,r,t.leadingWhitespace):(0,o.tokenMatcher)(t,l.GreaterThanOrEqualOp)?e=(0,s.buildGreaterThanOrEqualOpAst)(e,r,t.leadingWhitespace):(0,o.tokenMatcher)(t,l.LessThanOrEqualOp)?e=(0,s.buildLessThanOrEqualOpAst)(e,r,t.leadingWhitespace):i.ACTION((function(){throw Error("Operator not supported")}))})),e})),i.booleanExpressionOrEmpty=i.RULE("booleanExpressionOrEmpty",(function(){return i.OR([{ALT:function(){return i.SUBRULE(i.booleanExpression)}},{ALT:(0,o.EMPTY_ALT)((0,s.buildEmptyArgAst)())}])})),i.concatenateExpression=i.RULE("concatenateExpression",(function(){var e=i.SUBRULE(i.additionExpression);return i.MANY((function(){var t=i.CONSUME(l.ConcatenateOp),r=i.SUBRULE2(i.additionExpression);e=(0,s.buildConcatenateOpAst)(e,r,t.leadingWhitespace)})),e})),i.additionExpression=i.RULE("additionExpression",(function(){var e=i.SUBRULE(i.multiplicationExpression);return i.MANY((function(){var t=i.CONSUME(l.AdditionOp),r=i.SUBRULE2(i.multiplicationExpression);(0,o.tokenMatcher)(t,l.PlusOp)?e=(0,s.buildPlusOpAst)(e,r,t.leadingWhitespace):(0,o.tokenMatcher)(t,l.MinusOp)?e=(0,s.buildMinusOpAst)(e,r,t.leadingWhitespace):i.ACTION((function(){throw Error("Operator not supported")}))})),e})),i.multiplicationExpression=i.RULE("multiplicationExpression",(function(){var e=i.SUBRULE(i.powerExpression);return i.MANY((function(){var t=i.CONSUME(l.MultiplicationOp),r=i.SUBRULE2(i.powerExpression);(0,o.tokenMatcher)(t,l.TimesOp)?e=(0,s.buildTimesOpAst)(e,r,t.leadingWhitespace):(0,o.tokenMatcher)(t,l.DivOp)?e=(0,s.buildDivOpAst)(e,r,t.leadingWhitespace):i.ACTION((function(){throw Error("Operator not supported")}))})),e})),i.powerExpression=i.RULE("powerExpression",(function(){var e=i.SUBRULE(i.atomicExpression);return i.MANY((function(){var t=i.CONSUME(l.PowerOp),r=i.SUBRULE2(i.atomicExpression);(0,o.tokenMatcher)(t,l.PowerOp)?e=(0,s.buildPowerOpAst)(e,r,t.leadingWhitespace):i.ACTION((function(){throw Error("Operator not supported")}))})),e})),i.atomicExpression=i.RULE("atomicExpression",(function(){return i.OR([{ALT:function(){var e=i.CONSUME(l.AdditionOp),t=i.SUBRULE(i.atomicExpression);return(0,o.tokenMatcher)(e,l.PlusOp)?(0,s.buildPlusUnaryOpAst)(t,e.leadingWhitespace):(0,o.tokenMatcher)(e,l.MinusOp)?(0,s.buildMinusUnaryOpAst)(t,e.leadingWhitespace):(i.customParsingError=(0,s.parsingError)(s.ParsingErrorType.ParserError,"Mismatched token type"),i.customParsingError)}},{ALT:function(){return i.SUBRULE2(i.rightUnaryOpAtomicExpression)}}])})),i.rightUnaryOpAtomicExpression=i.RULE("rightUnaryOpAtomicExpression",(function(){var e=i.SUBRULE(i.positiveAtomicExpression),t=i.OPTION((function(){return i.CONSUME(l.PercentOp)}));return t?(0,s.buildPercentOpAst)(e,t.leadingWhitespace):e})),i.positiveAtomicExpression=i.RULE("positiveAtomicExpression",(function(){return i.OR(i.atomicExpCache||(i.atomicExpCache=[{ALT:function(){return i.SUBRULE(i.parenthesisExpression)}},{ALT:function(){return i.SUBRULE(i.cellRangeExpression)}},{ALT:function(){return i.SUBRULE(i.columnRangeExpression)}},{ALT:function(){return i.SUBRULE(i.rowRangeExpression)}},{ALT:function(){return i.SUBRULE(i.offsetExpression)}},{ALT:function(){return i.SUBRULE(i.cellReference)}},{ALT:function(){return i.SUBRULE(i.procedureExpression)}},{ALT:function(){return i.SUBRULE(i.namedExpressionExpression)}},{ALT:function(){var e=i.CONSUME(i.lexerConfig.NumberLiteral);return(0,s.buildNumberAst)(i.numericStringToNumber(e.image),e.leadingWhitespace)}},{ALT:function(){var e=i.CONSUME(l.StringLiteral);return(0,s.buildStringAst)(e)}},{ALT:function(){var e=i.CONSUME(l.ErrorLiteral),t=e.image.toUpperCase(),r=i.lexerConfig.errorMapping[t];return r?(0,s.buildCellErrorAst)(new a.CellError(r),e.leadingWhitespace):i.parsingError(s.ParsingErrorType.ParserError,"Unknown error literal")}}]))})),i.procedureExpression=i.RULE("procedureExpression",(function(){var e,t=i.CONSUME(l.ProcedureName),r=t.image.toUpperCase().slice(0,-1),n=null!==(e=i.lexerConfig.functionMapping[r])&&void 0!==e?e:r,o=[],a=i.SUBRULE(i.booleanExpressionOrEmpty);i.MANY((function(){var e,t=i.CONSUME(i.lexerConfig.ArgSeparator);a.type===s.AstNodeType.EMPTY&&(a.leadingWhitespace=null===(e=t.leadingWhitespace)||void 0===e?void 0:e.image),o.push(a),a=i.SUBRULE2(i.booleanExpressionOrEmpty)})),o.push(a),1===o.length&&o[0].type===s.AstNodeType.EMPTY&&(o.length=0);var u=i.CONSUME(l.RParen);return(0,s.buildProcedureAst)(n,o,t.leadingWhitespace,u.leadingWhitespace)})),i.namedExpressionExpression=i.RULE("namedExpressionExpression",(function(){var e=i.CONSUME(l.NamedExpression);return(0,s.buildNamedExpressionAst)(e.image,e.leadingWhitespace)})),i.offsetExpression=i.RULE("offsetExpression",(function(){var e,t=i.SUBRULE(i.offsetProcedureExpression);return i.OPTION((function(){i.CONSUME(l.RangeSeparator),e=t.type===s.AstNodeType.CELL_RANGE?i.parsingError(s.ParsingErrorType.RangeOffsetNotAllowed,"Range offset not allowed here"):i.SUBRULE(i.endOfRangeWithOffsetStartExpression,{ARGS:[t]})})),void 0!==e?e:t})),i.offsetProcedureExpression=i.RULE("offsetProcedureExpression",(function(){var e=[];return i.CONSUME(i.lexerConfig.OffsetProcedureName),i.CONSUME(l.LParen),i.MANY_SEP({SEP:i.lexerConfig.ArgSeparator,DEF:function(){e.push(i.SUBRULE(i.booleanExpression))}}),i.CONSUME(l.RParen),i.handleOffsetHeuristic(e)})),i.cellRangeExpression=i.RULE("cellRangeExpression",(function(){var e=i.CONSUME(l.CellReference);return i.CONSUME2(l.RangeSeparator),i.SUBRULE(i.endOfRangeExpression,{ARGS:[e]})})),i.columnRangeExpression=i.RULE("columnRangeExpression",(function(){var e=i.CONSUME(l.ColumnRange),t=f(e.image.split(":"),2),r=t[0],n=t[1],o=i.ACTION((function(){return(0,u.columnAddressFromString)(i.sheetMapping,r,i.formulaAddress)})),c=i.ACTION((function(){return(0,u.columnAddressFromString)(i.sheetMapping,n,i.formulaAddress)}));if(void 0===o||void 0===c)return(0,s.buildCellErrorAst)(new a.CellError(a.ErrorType.REF));if(o.exceedsSheetSizeLimits(i.lexerConfig.maxColumns)||c.exceedsSheetSizeLimits(i.lexerConfig.maxColumns))return(0,s.buildErrorWithRawInputAst)(e.image,new a.CellError(a.ErrorType.NAME),e.leadingWhitespace);if(null===o.sheet&&null!==c.sheet)return i.parsingError(s.ParsingErrorType.ParserError,"Malformed range expression");var p=i.rangeSheetReferenceType(o.sheet,c.sheet);return null!==o.sheet&&null===c.sheet&&(c=c.withAbsoluteSheet(o.sheet)),(0,s.buildColumnRangeAst)(o,c,p,e.leadingWhitespace)})),i.rowRangeExpression=i.RULE("rowRangeExpression",(function(){var e=i.CONSUME(l.RowRange),t=f(e.image.split(":"),2),r=t[0],n=t[1],o=i.ACTION((function(){return(0,u.rowAddressFromString)(i.sheetMapping,r,i.formulaAddress)})),c=i.ACTION((function(){return(0,u.rowAddressFromString)(i.sheetMapping,n,i.formulaAddress)}));if(void 0===o||void 0===c)return(0,s.buildCellErrorAst)(new a.CellError(a.ErrorType.REF));if(o.exceedsSheetSizeLimits(i.lexerConfig.maxRows)||c.exceedsSheetSizeLimits(i.lexerConfig.maxRows))return(0,s.buildErrorWithRawInputAst)(e.image,new a.CellError(a.ErrorType.NAME),e.leadingWhitespace);if(null===o.sheet&&null!==c.sheet)return i.parsingError(s.ParsingErrorType.ParserError,"Malformed range expression");var p=i.rangeSheetReferenceType(o.sheet,c.sheet);return null!==o.sheet&&null===c.sheet&&(c=c.withAbsoluteSheet(o.sheet)),(0,s.buildRowRangeAst)(o,c,p,e.leadingWhitespace)})),i.cellReference=i.RULE("cellReference",(function(){var e=i.CONSUME(l.CellReference),t=i.ACTION((function(){return(0,u.cellAddressFromString)(i.sheetMapping,e.image,i.formulaAddress)}));return void 0===t?(0,s.buildErrorWithRawInputAst)(e.image,new a.CellError(a.ErrorType.REF),e.leadingWhitespace):t.exceedsSheetSizeLimits(i.lexerConfig.maxColumns,i.lexerConfig.maxRows)?(0,s.buildErrorWithRawInputAst)(e.image,new a.CellError(a.ErrorType.NAME),e.leadingWhitespace):(0,s.buildCellReferenceAst)(t,e.leadingWhitespace)})),i.endOfRangeExpression=i.RULE("endOfRangeExpression",(function(e){return i.OR([{ALT:function(){return i.SUBRULE(i.endRangeReference,{ARGS:[e]})}},{ALT:function(){var t,r=i.SUBRULE(i.offsetProcedureExpression),n=i.ACTION((function(){return(0,u.cellAddressFromString)(i.sheetMapping,e.image,i.formulaAddress)}));if(void 0===n)return(0,s.buildCellErrorAst)(new a.CellError(a.ErrorType.REF));if(r.type===s.AstNodeType.CELL_REFERENCE){var o=r.reference,c=s.RangeSheetReferenceType.RELATIVE;return null!==n.sheet&&(c=s.RangeSheetReferenceType.START_ABSOLUTE,o=o.withAbsoluteSheet(n.sheet)),(0,s.buildCellRangeAst)(n,o,c,null===(t=e.leadingWhitespace)||void 0===t?void 0:t.image)}return i.parsingError(s.ParsingErrorType.RangeOffsetNotAllowed,"Range offset not allowed here")}}])})),i.endOfRangeWithOffsetStartExpression=i.RULE("endOfRangeWithOffsetStartExpression",(function(e){return i.OR([{ALT:function(){return i.SUBRULE(i.endRangeWithOffsetStartReference,{ARGS:[e]})}},{ALT:function(){var t=i.SUBRULE(i.offsetProcedureExpression);if(t.type===s.AstNodeType.CELL_REFERENCE){var r=t.reference,n=s.RangeSheetReferenceType.RELATIVE;return null!==e.reference.sheet&&(n=s.RangeSheetReferenceType.START_ABSOLUTE,r=r.withAbsoluteSheet(e.reference.sheet)),(0,s.buildCellRangeAst)(e.reference,r,n,e.leadingWhitespace)}return i.parsingError(s.ParsingErrorType.RangeOffsetNotAllowed,"Range offset not allowed here")}}])})),i.endRangeReference=i.RULE("endRangeReference",(function(e){var t,r=i.CONSUME(l.CellReference),n=i.ACTION((function(){return(0,u.cellAddressFromString)(i.sheetMapping,e.image,i.formulaAddress)})),o=i.ACTION((function(){return(0,u.cellAddressFromString)(i.sheetMapping,r.image,i.formulaAddress)}));return void 0===n||void 0===o?i.ACTION((function(){return(0,s.buildErrorWithRawInputAst)("".concat(e.image,":").concat(r.image),new a.CellError(a.ErrorType.REF),e.leadingWhitespace)})):n.exceedsSheetSizeLimits(i.lexerConfig.maxColumns,i.lexerConfig.maxRows)||o.exceedsSheetSizeLimits(i.lexerConfig.maxColumns,i.lexerConfig.maxRows)?i.ACTION((function(){return(0,s.buildErrorWithRawInputAst)("".concat(e.image,":").concat(r.image),new a.CellError(a.ErrorType.NAME),e.leadingWhitespace)})):i.buildCellRange(n,o,null===(t=e.leadingWhitespace)||void 0===t?void 0:t.image)})),i.endRangeWithOffsetStartReference=i.RULE("endRangeWithOffsetStartReference",(function(e){var t=i.CONSUME(l.CellReference),r=i.ACTION((function(){return(0,u.cellAddressFromString)(i.sheetMapping,t.image,i.formulaAddress)}));return void 0===r?i.ACTION((function(){return(0,s.buildCellErrorAst)(new a.CellError(a.ErrorType.REF))})):i.buildCellRange(e.reference,r,e.leadingWhitespace)})),i.parenthesisExpression=i.RULE("parenthesisExpression",(function(){var e=i.CONSUME(l.LParen),t=i.SUBRULE(i.booleanExpression),r=i.CONSUME(l.RParen);return(0,s.buildParenthesisAst)(t,e.leadingWhitespace,r.leadingWhitespace)})),i.numericStringToNumber=function(e){var t=e.replace(i.lexerConfig.decimalSeparator,".");return Number(t)},i.lexerConfig=e,i.sheetMapping=n,i.formulaAddress=(0,a.simpleCellAddress)(0,0,0),i.performSelfAnalysis(),i}return m(r,[{key:"parseFromTokens",value:function(e,t){this.input=e;var r=this.formulaWithContext(t),n=[];return this.customParsingError&&n.push(this.customParsingError),(n=n.concat(this.errors.map((function(e){return{type:s.ParsingErrorType.ParserError,message:e.message}})))).length>0&&(r=(0,s.buildParsingErrorAst)()),{ast:r,errors:n}}},{key:"formulaWithContext",value:function(e){return this.formulaAddress=e,this.formula()}},{key:"reset",value:function(){y(T(r.prototype),"reset",this).call(this),this.customParsingError=void 0}},{key:"buildCellRange",value:function(e,t,r){if(null===e.sheet&&null!==t.sheet)return this.parsingError(s.ParsingErrorType.ParserError,"Malformed range expression");var n=this.rangeSheetReferenceType(e.sheet,t.sheet);return null!==e.sheet&&null===t.sheet&&(t=t.withAbsoluteSheet(e.sheet)),(0,s.buildCellRangeAst)(e,t,n,r)}},{key:"handleOffsetHeuristic",value:function(e){var t=e[0];if(t.type!==s.AstNodeType.CELL_REFERENCE)return this.parsingError(s.ParsingErrorType.StaticOffsetError,"First argument to OFFSET is not a reference");var r,n=e[1];if(n.type===s.AstNodeType.NUMBER&&Number.isInteger(n.value))r=n.value;else if(n.type===s.AstNodeType.PLUS_UNARY_OP&&n.value.type===s.AstNodeType.NUMBER&&Number.isInteger(n.value.value))r=n.value.value;else{if(n.type!==s.AstNodeType.MINUS_UNARY_OP||n.value.type!==s.AstNodeType.NUMBER||!Number.isInteger(n.value.value))return this.parsingError(s.ParsingErrorType.StaticOffsetError,"Second argument to OFFSET is not a static number");r=-n.value.value}var o,u=e[2];if(u.type===s.AstNodeType.NUMBER&&Number.isInteger(u.value))o=u.value;else if(u.type===s.AstNodeType.PLUS_UNARY_OP&&u.value.type===s.AstNodeType.NUMBER&&Number.isInteger(u.value.value))o=u.value.value;else{if(u.type!==s.AstNodeType.MINUS_UNARY_OP||u.value.type!==s.AstNodeType.NUMBER||!Number.isInteger(u.value.value))return this.parsingError(s.ParsingErrorType.StaticOffsetError,"Third argument to OFFSET is not a static number");o=-u.value.value}var l,f=e[3];if(void 0===f)l=1;else{if(f.type!==s.AstNodeType.NUMBER)return this.parsingError(s.ParsingErrorType.StaticOffsetError,"Fourth argument to OFFSET is not a static number");if((l=f.value)<1)return this.parsingError(s.ParsingErrorType.StaticOffsetError,"Fourth argument to OFFSET is too small number");if(!Number.isInteger(l))return this.parsingError(s.ParsingErrorType.StaticOffsetError,"Fourth argument to OFFSET is not integer")}var p,h=e[4];if(void 0===h)p=1;else{if(h.type!==s.AstNodeType.NUMBER)return this.parsingError(s.ParsingErrorType.StaticOffsetError,"Fifth argument to OFFSET is not a static number");if((p=h.value)<1)return this.parsingError(s.ParsingErrorType.StaticOffsetError,"Fifth argument to OFFSET is too small number");if(!Number.isInteger(p))return this.parsingError(s.ParsingErrorType.StaticOffsetError,"Fifth argument to OFFSET is not integer")}var d=new c.CellAddress(null,t.reference.col+o,t.reference.row+r,t.reference.type),m=d.col,y=d.row;if(t.reference.type!==c.CellReferenceType.CELL_REFERENCE_RELATIVE&&t.reference.type!==c.CellReferenceType.CELL_REFERENCE_ABSOLUTE_COL||(y+=this.formulaAddress.row),t.reference.type!==c.CellReferenceType.CELL_REFERENCE_RELATIVE&&t.reference.type!==c.CellReferenceType.CELL_REFERENCE_ABSOLUTE_ROW||(m+=this.formulaAddress.col),m<0||y<0)return(0,s.buildCellErrorAst)(new a.CellError(a.ErrorType.REF,i.ErrorMessage.OutOfSheet));if(1===p&&1===l)return(0,s.buildCellReferenceAst)(d);var g=new c.CellAddress(null,d.col+p-1,d.row+l-1,d.type);return(0,s.buildCellRangeAst)(d,g,s.RangeSheetReferenceType.RELATIVE)}},{key:"parsingError",value:function(e,t){return this.customParsingError=(0,s.parsingError)(e,t),(0,s.buildParsingErrorAst)()}},{key:"rangeSheetReferenceType",value:function(e,t){return null===e?s.RangeSheetReferenceType.RELATIVE:null===t?s.RangeSheetReferenceType.START_ABSOLUTE:s.RangeSheetReferenceType.BOTH_ABSOLUTE}}]),r}(o.EmbeddedActionsParser);t.FormulaParser=b;var R=function(){function e(t){h(this,e),this.lexerConfig=t,this.lexer=new o.Lexer(t.allTokens,{ensureOptimizations:!0})}return m(e,[{key:"tokenizeFormula",value:function(e){var t=this.lexer.tokenize(e),r=t.tokens;return r=this.trimTrailingWhitespaces(r),r=this.skipWhitespacesInsideRanges(r),r=this.skipWhitespacesBeforeArgSeparators(r),t.tokens=r,t}},{key:"skipWhitespacesInsideRanges",value:function(e){return this.filterTokensByNeighbors(e,(function(e,t,r){return((0,o.tokenMatcher)(e,l.CellReference)||(0,o.tokenMatcher)(e,l.RangeSeparator))&&(0,o.tokenMatcher)(t,l.WhiteSpace)&&((0,o.tokenMatcher)(r,l.CellReference)||(0,o.tokenMatcher)(r,l.RangeSeparator))}))}},{key:"skipWhitespacesBeforeArgSeparators",value:function(e){var t=this;return this.filterTokensByNeighbors(e,(function(e,r,n){return!(0,o.tokenMatcher)(e,t.lexerConfig.ArgSeparator)&&(0,o.tokenMatcher)(r,l.WhiteSpace)&&(0,o.tokenMatcher)(n,t.lexerConfig.ArgSeparator)}))}},{key:"filterTokensByNeighbors",value:function(e,t){if(e.length<3)return e;for(var r=0,n=[e[r++]];r<e.length-1;)t(e[r-1],e[r],e[r+1])||n.push(e[r]),++r;return n.push(e[r]),n}},{key:"trimTrailingWhitespaces",value:function(e){return e.length>0&&(0,o.tokenMatcher)(e[e.length-1],l.WhiteSpace)&&e.pop(),e}}]),e}();t.FormulaLexer=R},function(e,t,r){var n=r(2),o=r(15),a=r(22),i=r(16),u=r(5),s=r(82);n({target:"Reflect",stat:!0},{get:function e(t,r){var n,c,l=arguments.length<3?t:arguments[2];return a(t)===l?t[r]:(n=u.f(t,r))?i(n,"value")?n.value:void 0===n.get?void 0:n.get.call(l):o(c=s(t))?e(c,r,l):void 0}})},function(e,t,r){r(2)({target:"Number",stat:!0},{isInteger:r(214)})},function(e,t,r){var n=r(15),o=Math.floor;e.exports=function(e){return!n(e)&&isFinite(e)&&o(e)===e}},function(e,t,r){"use strict";t.__esModule=!0,t.ErrorMessage=void 0;
/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */
var n=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)};t.ErrorMessage=n,n.DistinctSigns="Distinct signs.",n.WrongArgNumber="Wrong number of arguments.",n.EmptyArg="Empty function argument.",n.MatrixDimensions="Matrix dimensions are not compatible.",n.ValueSmall="Value too small.",n.ValueLarge="Value too large.",n.BadCriterion="Incorrect criterion.",n.RangeManySheets="Range spans more than one sheet.",n.CellRangeExpected="Cell range expected.",n.ScalarExpected="Cell range not allowed.",n.NumberCoercion="Value cannot be coerced to number.",n.NumberExpected="Number argument expected.",n.IntegerExpected="Value needs to be an integer.",n.BadMode="Mode not recognized.",n.DateBounds="Date outside of bounds.",n.OutOfSheet="Resulting reference is out of the sheet.",n.WrongType="Wrong type of argument.",n.NaN="NaN or infinite value encountered.",n.EqualLength="Ranges need to be of equal length.",n.Negative="Value cannot be negative.",n.NotBinary="String does not represent a binary number.",n.NotOctal="String does not represent an octal number.",n.NotHex="String does not represent a hexadecimal number.",n.EndStartPeriod="End period needs to be at least start period.",n.CellRefExpected="Cell reference expected.",n.BadRef="Address is not correct.",n.NumberRange="Number-only range expected.",n.ValueNotFound="Value not found.",n.ValueBaseLarge="Value in base too large.",n.ValueBaseSmall="Value in base too small.",n.ValueBaseLong="Value in base too long.",n.NegativeLength="Length cannot be negative.",n.PatternNotFound="Pattern not found.",n.MatrixParams="Matrix function parameters are not compatible.",n.OneValue="Needs at least one value.",n.TwoValues="Range needs to contain at least two elements.",n.ThreeValues="Range needs to contain at least three elements.",n.IndexBounds="Index out of bounds.",n.IndexLarge="Index too large.",n.Formula="Expected formula.",n.NegativeCount="Count cannot be negative.",n.ParseError="Parsing error.",n.SheetRef="Sheet does not exist.",n.MatrixFunction="Matrix function not recognized.",n.PeriodLong="Period number cannot exceed life length.",n.InvalidDate="Invalid date.",n.BitshiftLong="Result of bitshift is too long.",n.EmptyString="Empty-string argument not allowed.",n.LengthBounds="Length out of bounds.",n.NegativeTime="Time cannot be negative.",n.NoDefault="No default option.",n.Selector="Selector cannot exceed the number of arguments.",n.StartEndDate="Start date needs to be earlier than end date.",n.IncorrectDateTime="String does not represent correct DateTime.",n.CharacterCodeBounds="Character code out of bounds.",n.NonZero="Argument cannot be 0.",n.LessThanOne="Argument cannot be less than 1.",n.WeekendString="Incorrect weekend bitmask string.",n.InvalidRoman="Invalid roman numeral.",n.WrongOrder="Wrong order of values.",n.ComplexNumberExpected="Complex number expected.",n.ShouldBeIorJ="Should be 'i' or 'j'.",n.FunctionName=function(e){return"Function name ".concat(e," not recognized.")},n.NamedExpressionName=function(e){return"Named expression ".concat(e," not recognized.")},n.LicenseKey=function(e){return"License key is ".concat(e,".")}},function(e,t,r){"use strict";t.__esModule=!0,t.formatNumber=l,t.Unparser=void 0,r(206),r(121),r(125),r(63),r(148),r(146),r(156);var n=r(115),o=r(0),a=r(142),i=r(207),u=r(208);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=function(){function e(t,r,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.lexerConfig=r,this.sheetMappingFn=n,this.namedExpressions=o}var t,r,c;return t=e,(r=[{key:"unparse",value:function(e,t){return"="+this.unparseAst(e,t)}},{key:"unparseAst",value:function(e,t){var r,o,a=this;switch(e.type){case i.AstNodeType.EMPTY:return(0,i.imageWithWhitespace)("",e.leadingWhitespace);case i.AstNodeType.NUMBER:return(0,i.imageWithWhitespace)(l(e.value,this.config.decimalSeparator),e.leadingWhitespace);case i.AstNodeType.STRING:return(0,i.imageWithWhitespace)('"'+e.value+'"',e.leadingWhitespace);case i.AstNodeType.FUNCTION_CALL:var s=e.args.map((function(e){return void 0!==e?a.unparseAst(e,t):""})).join(this.config.functionArgSeparator),c=(this.config.translationPackage.isFunctionTranslated(e.procedureName)?this.config.translationPackage.getFunctionTranslation(e.procedureName):e.procedureName)+"("+s+(0,i.imageWithWhitespace)(")",e.internalWhitespace);return(0,i.imageWithWhitespace)(c,e.leadingWhitespace);case i.AstNodeType.NAMED_EXPRESSION:var f=null===(r=this.namedExpressions.nearestNamedExpression(e.expressionName,t.sheet))||void 0===r?void 0:r.displayName;return(0,i.imageWithWhitespace)(f||e.expressionName,e.leadingWhitespace);case i.AstNodeType.CELL_REFERENCE:var p;return p=null!==e.reference.sheet?this.unparseSheetName(e.reference.sheet)+"!":"",p+=null!==(o=e.reference.unparse(t))&&void 0!==o?o:this.config.translationPackage.getErrorTranslation(n.ErrorType.REF),(0,i.imageWithWhitespace)(p,e.leadingWhitespace);case i.AstNodeType.COLUMN_RANGE:case i.AstNodeType.ROW_RANGE:case i.AstNodeType.CELL_RANGE:return(0,i.imageWithWhitespace)(this.formatRange(e,t),e.leadingWhitespace);case i.AstNodeType.PLUS_UNARY_OP:var h=this.unparseAst(e.value,t);return(0,i.imageWithWhitespace)("+",e.leadingWhitespace)+h;case i.AstNodeType.MINUS_UNARY_OP:var d=this.unparseAst(e.value,t);return(0,i.imageWithWhitespace)("-",e.leadingWhitespace)+d;case i.AstNodeType.PERCENT_OP:return this.unparseAst(e.value,t)+(0,i.imageWithWhitespace)("%",e.leadingWhitespace);case i.AstNodeType.ERROR:var m=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:n.ErrorType.ERROR);return(0,i.imageWithWhitespace)(m,e.leadingWhitespace);case i.AstNodeType.ERROR_WITH_RAW_INPUT:return(0,i.imageWithWhitespace)(e.rawInput,e.leadingWhitespace);case i.AstNodeType.PARENTHESIS:var y="("+this.unparseAst(e.expression,t)+(0,i.imageWithWhitespace)(")",e.internalWhitespace);return(0,i.imageWithWhitespace)(y,e.leadingWhitespace);default:var g=this.unparseAst(e.left,t),v=this.unparseAst(e.right,t);return g+(0,i.imageWithWhitespace)(u.binaryOpTokenMap[e.type],e.leadingWhitespace)+v}}},{key:"unparseSheetName",value:function(e){var t=(0,a.sheetIndexToString)(e,this.sheetMappingFn);if(void 0===t)throw new o.NoSheetWithIdError(e);return t}},{key:"formatRange",value:function(e,t){var r="",o="";null!==e.start.sheet&&e.sheetReferenceType!==i.RangeSheetReferenceType.RELATIVE&&(r=this.unparseSheetName(e.start.sheet)+"!"),null!==e.end.sheet&&e.sheetReferenceType===i.RangeSheetReferenceType.BOTH_ABSOLUTE&&(o=this.unparseSheetName(e.end.sheet)+"!");var a=e.start.unparse(t),u=e.end.unparse(t);return void 0===a||void 0===u?this.config.translationPackage.getErrorTranslation(n.ErrorType.REF):"".concat(r).concat(a,":").concat(o).concat(u)}}])&&s(t.prototype,r),c&&s(t,c),e}();function l(e,t){return e.toString().replace(".",t)}t.Unparser=c},function(e,t,r){"use strict";t.__esModule=!0,t.collectDependencies=void 0,r(126);var n=r(141);
/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */t.collectDependencies=function(e,t){var r=new Array;return function e(t,r,o,a){switch(t.type){case n.AstNodeType.EMPTY:case n.AstNodeType.NUMBER:case n.AstNodeType.STRING:case n.AstNodeType.ERROR:return;case n.AstNodeType.NAMED_EXPRESSION:return void(a&&o.push(new n.NamedExpressionDependency(t.expressionName)));case n.AstNodeType.CELL_REFERENCE:return void(a&&o.push(new n.AddressDependency(t.reference)));case n.AstNodeType.CELL_RANGE:return void(a&&t.start.sheet===t.end.sheet&&o.push(new n.CellRangeDependency(t.start,t.end)));case n.AstNodeType.COLUMN_RANGE:return void(a&&t.start.sheet===t.end.sheet&&o.push(new n.ColumnRangeDependency(t.start,t.end)));case n.AstNodeType.ROW_RANGE:return void(a&&t.start.sheet===t.end.sheet&&o.push(new n.RowRangeDependency(t.start,t.end)));case n.AstNodeType.PERCENT_OP:case n.AstNodeType.PLUS_UNARY_OP:case n.AstNodeType.MINUS_UNARY_OP:return void e(t.value,r,o,!0);case n.AstNodeType.CONCATENATE_OP:case n.AstNodeType.EQUALS_OP:case n.AstNodeType.NOT_EQUAL_OP:case n.AstNodeType.LESS_THAN_OP:case n.AstNodeType.GREATER_THAN_OP:case n.AstNodeType.LESS_THAN_OR_EQUAL_OP:case n.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case n.AstNodeType.MINUS_OP:case n.AstNodeType.PLUS_OP:case n.AstNodeType.TIMES_OP:case n.AstNodeType.DIV_OP:case n.AstNodeType.POWER_OP:return e(t.left,r,o,!0),void e(t.right,r,o,!0);case n.AstNodeType.PARENTHESIS:return void e(t.expression,r,o,a);case n.AstNodeType.FUNCTION_CALL:var i=!r.doesFunctionNeedArgumentToBeComputed(t.procedureName);return void t.args.forEach((function(t){return e(t,r,o,i)}))}}(e,t,r,!0),r}},function(e,t,r){"use strict";t.__esModule=!0,t.NamedExpressionDependency=t.RowRangeDependency=t.ColumnRangeDependency=t.CellRangeDependency=t.AddressDependency=void 0,r(67);var n=r(135);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}var u=function(){function e(t){o(this,e),this.dependency=t}return i(e,[{key:"absolutize",value:function(e){return this.dependency.toSimpleCellAddress(e)}}]),e}();t.AddressDependency=u;var s=function(){function e(t,r){o(this,e),this.start=t,this.end=r}return i(e,[{key:"absolutize",value:function(e){return new n.AbsoluteCellRange(this.start.toSimpleCellAddress(e),this.end.toSimpleCellAddress(e))}}]),e}();t.CellRangeDependency=s;var c=function(){function e(t,r){o(this,e),this.start=t,this.end=r}return i(e,[{key:"absolutize",value:function(e){var t=this.start.toSimpleColumnAddress(e),r=this.end.toSimpleColumnAddress(e);return new n.AbsoluteColumnRange(t.sheet,t.col,r.col)}}]),e}();t.ColumnRangeDependency=c;var l=function(){function e(t,r){o(this,e),this.start=t,this.end=r}return i(e,[{key:"absolutize",value:function(e){var t=this.start.toSimpleRowAddress(e),r=this.end.toSimpleRowAddress(e);return new n.AbsoluteRowRange(t.sheet,t.row,r.row)}}]),e}();t.RowRangeDependency=l;var f=function(){function e(t){o(this,e),this.name=t}return i(e,[{key:"absolutize",value:function(e){return this}}]),e}();t.NamedExpressionDependency=f},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}
/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */t.__esModule=!0,t.ColumnsSpan=t.RowsSpan=void 0,r(120);var i=function(){function e(t,r,o){if(n(this,e),this.sheet=t,this.rowStart=r,this.rowEnd=o,r<0)throw Error("Starting row cant be less than 0");if(o<r)throw Error("Row span cant end before start")}return a(e,[{key:"numberOfRows",get:function(){return this.rowEnd-this.rowStart+1}},{key:"rows",value:regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.rowStart;case 1:if(!(t<=this.rowEnd)){e.next=7;break}return e.next=4,t;case 4:++t,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))},{key:"intersect",value:function(t){if(this.sheet!==t.sheet)throw Error("Can't intersect spans from different sheets");var r=Math.max(this.rowStart,t.rowStart),n=Math.min(this.rowEnd,t.rowEnd);return r>n?null:new e(this.sheet,r,n)}},{key:"firstRow",value:function(){return new e(this.sheet,this.rowStart,this.rowStart)}},{key:"start",get:function(){return this.rowStart}},{key:"end",get:function(){return this.rowEnd}}],[{key:"fromNumberOfRows",value:function(t,r,n){return new e(t,r,r+n-1)}},{key:"fromRowStartAndEnd",value:function(t,r,n){return new e(t,r,n)}}]),e}();t.RowsSpan=i;var u=function(){function e(t,r,o){if(n(this,e),this.sheet=t,this.columnStart=r,this.columnEnd=o,r<0)throw Error("Starting column cant be less than 0");if(o<r)throw Error("Column span cant end before start")}return a(e,[{key:"numberOfColumns",get:function(){return this.columnEnd-this.columnStart+1}},{key:"columns",value:regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.columnStart;case 1:if(!(t<=this.columnEnd)){e.next=7;break}return e.next=4,t;case 4:++t,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))},{key:"intersect",value:function(t){if(this.sheet!==t.sheet)throw Error("Can't intersect spans from different sheets");var r=Math.max(this.columnStart,t.columnStart),n=Math.min(this.columnEnd,t.columnEnd);return r>n?null:new e(this.sheet,r,n)}},{key:"firstColumn",value:function(){return new e(this.sheet,this.columnStart,this.columnStart)}},{key:"start",get:function(){return this.columnStart}},{key:"end",get:function(){return this.columnEnd}}],[{key:"fromNumberOfColumns",value:function(t,r,n){return new e(t,r,r+n-1)}},{key:"fromColumnStartAndEnd",value:function(t,r,n){return new e(t,r,n)}}]),e}();t.ColumnsSpan=u},function(e,t,r){"use strict";t.__esModule=!0,t.filterDependenciesOutOfScope=t.absolutizeDependencies=void 0,r(121),r(221);var n=r(115),o=r(141),a=r(135);t.absolutizeDependencies=function(e,t){return e.map((function(e){return e.absolutize(t)}))},t.filterDependenciesOutOfScope=function(e){return e.filter((function(e){return e instanceof o.NamedExpressionDependency||(e instanceof a.AbsoluteCellRange?!((0,n.invalidSimpleCellAddress)(e.start)||(0,n.invalidSimpleCellAddress)(e.end)):!(0,n.invalidSimpleCellAddress)(e))}))}},function(e,t,r){"use strict";var n=r(2),o=r(91).filter;n({target:"Array",proto:!0,forced:!r(62)("filter")},{filter:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,r){"use strict";r(53),r(63),r(67),r(68),r(87),r(93),r(94),t.__esModule=!0,t.SimpleRangeValue=t.OnlyRangeData=t.ArrayData=void 0,r(77),r(95),r(97),r(120);var n=r(115),o=r(215),a=r(223);function i(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=s(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}function s(e,t){if(e){if("string"==typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t,r){return t&&f(e.prototype,t),r&&f(e,r),e}var h=function(){function e(t,r,n){l(this,e),this.size=t,this.data=r,this._hasOnlyNumbers=n}return p(e,[{key:"range",value:function(){}},{key:"hasOnlyNumbers",value:function(){return this._hasOnlyNumbers}},{key:"topLeftCorner",value:function(){if(this.size.height>0&&this.size.width>0)return this.data[0][0]}},{key:"valuesFromTopLeftCorner",value:function(){for(var e=[],t=0;t<this.size.height;t++)for(var r=0;r<this.size.width;r++)e.push(this.data[t][r]);return e}},{key:"iterateValuesFromTopLeftCorner",value:regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:if(!(t<this.size.height)){e.next=12;break}r=0;case 3:if(!(r<this.size.width)){e.next=9;break}return e.next=6,this.data[t][r];case 6:r++,e.next=3;break;case 9:t++,e.next=1;break;case 12:case"end":return e.stop()}}),e,this)}))},{key:"raw",value:function(){return this.data}},{key:"rawNumbers",value:function(){if(this.hasOnlyNumbers())return this.data;throw new Error("Data is not only numbers")}}]),e}();t.ArrayData=h;var d=function(){function e(t,r,n){l(this,e),this.size=t,this._range=r,this.dependencyGraph=n}return p(e,[{key:"raw",value:function(){return this.ensureThatComputed(),this.data}},{key:"rawNumbers",value:function(){if(this.hasOnlyNumbers())return this.data;throw new Error("Data is not only numbers")}},{key:"hasOnlyNumbers",value:function(){if(this.ensureThatComputed(),void 0===this._hasOnlyNumbers){var e,t=u(this.iterateValuesFromTopLeftCorner());try{for(t.s();!(e=t.n()).done;)if("number"!=typeof e.value){this._hasOnlyNumbers=!1;break}}catch(e){t.e(e)}finally{t.f()}this._hasOnlyNumbers=!0}return this._hasOnlyNumbers}},{key:"topLeftCorner",value:function(){if(void 0!==this.data&&this.size.height>0&&this.size.width>0)return this.data[0][0]}},{key:"range",value:function(){return this._range}},{key:"valuesFromTopLeftCorner",value:function(){this.ensureThatComputed();for(var e=[],t=0;t<this.data.length;t++)for(var r=0;r<this.data[0].length;r++)e.push(this.data[t][r]);return e}},{key:"iterateValuesFromTopLeftCorner",value:regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.ensureThatComputed(),t=0;case 2:if(!(t<this.data.length)){e.next=13;break}r=0;case 4:if(!(r<this.data[0].length)){e.next=10;break}return e.next=7,this.data[t][r];case 7:r++,e.next=4;break;case 10:t++,e.next=2;break;case 13:case"end":return e.stop()}}),e,this)}))},{key:"ensureThatComputed",value:function(){void 0===this.data&&(this.data=this.computeDataFromDependencyGraph())}},{key:"computeDataFromDependencyGraph",value:function(){var e,t=[],r=0,s=[],c=u(this._range.addresses(this.dependencyGraph));try{for(c.s();!(e=c.n()).done;){var l=e.value,f=this.dependencyGraph.getCellValue(l);f instanceof m?s.push(new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.ScalarExpected)):(0,a.isExtendedNumber)(f)?s.push(f):(s.push(f),this._hasOnlyNumbers=!1),++r%this.size.width==0&&(r=0,t.push(i(s)),s=[])}}catch(e){c.e(e)}finally{c.f()}return t}}]),e}();t.OnlyRangeData=d;var m=function(){function e(t,r){l(this,e),this.data=t,this._range=r}return p(e,[{key:"size",get:function(){return this.data.size}},{key:"width",value:function(){return this.data.size.width}},{key:"height",value:function(){return this.data.size.height}},{key:"raw",value:function(){return this.data.raw()}},{key:"topLeftCornerValue",value:function(){return this.data.topLeftCorner()}},{key:"valuesFromTopLeftCorner",value:function(){return this.data.valuesFromTopLeftCorner()}},{key:"iterateValuesFromTopLeftCorner",value:regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.data.iterateValuesFromTopLeftCorner(),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"numberOfElements",value:function(){return this.data.size.width*this.data.size.height}},{key:"hasOnlyNumbers",value:function(){return this.data.hasOnlyNumbers()}},{key:"rawNumbers",value:function(){return this.data.rawNumbers()}},{key:"range",value:function(){var e;return null!==(e=this._range)&&void 0!==e?e:this.data.range()}},{key:"sameDimensionsAs",value:function(e){return this.width()===e.width()&&this.height()===e.height()}}],[{key:"onlyNumbersDataWithRange",value:function(t,r,n){return new e(new h(r,t,!0),n)}},{key:"onlyNumbersDataWithoutRange",value:function(t,r){return new e(new h(r,t,!0))}},{key:"onlyRange",value:function(t,r){return new e(new d({width:t.width(),height:t.height()},t,r))}},{key:"fromScalar",value:function(t){var r=(0,a.isExtendedNumber)(t);return new e(new h({width:1,height:1},[[t]],r))}}]),e}();t.SimpleRangeValue=m},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=s(e);if(t){var o=s(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return u(this,r)}}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),e}
/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */r(109),r(1),r(94),r(95),r(77),r(97),t.__esModule=!0,t.getRawValue=function(e){return e instanceof h?e.val:e},t.cloneNumber=function(e,t){if("number"==typeof e)return t;var r=e.fromNumber(t);return r.format=e.format,r},t.isExtendedNumber=function(e){return"number"==typeof e||e instanceof h},t.getTypeOfExtendedNumber=function(e){return e instanceof h?e.getDetailedType():v.NUMBER_RAW},t.getFormatOfExtendedNumber=function(e){return e instanceof h?e.format:void 0},t.getTypeFormatOfExtendedNumber=function(e){return e instanceof h?{type:e.getDetailedType(),format:e.format}:{type:v.NUMBER_RAW}},t.NumberType=t.PercentNumber=t.DateTimeNumber=t.TimeNumber=t.CurrencyNumber=t.DateNumber=t.RichNumber=t.EmptyValue=void 0,r(87),r(93),r(63);var p=Symbol("Empty value");t.EmptyValue=p;var h=function(){function e(t,r){c(this,e),this.val=t,this.format=r}return f(e,[{key:"fromNumber",value:function(e){return new this.constructor(e)}}]),e}();t.RichNumber=h;var d=function(e){o(r,e);var t=i(r);function r(){return c(this,r),t.apply(this,arguments)}return f(r,[{key:"getDetailedType",value:function(){return v.NUMBER_DATE}}]),r}(h);t.DateNumber=d;var m=function(e){o(r,e);var t=i(r);function r(){return c(this,r),t.apply(this,arguments)}return f(r,[{key:"getDetailedType",value:function(){return v.NUMBER_CURRENCY}}]),r}(h);t.CurrencyNumber=m;var y=function(e){o(r,e);var t=i(r);function r(){return c(this,r),t.apply(this,arguments)}return f(r,[{key:"getDetailedType",value:function(){return v.NUMBER_TIME}}]),r}(h);t.TimeNumber=y;var g=function(e){o(r,e);var t=i(r);function r(){return c(this,r),t.apply(this,arguments)}return f(r,[{key:"getDetailedType",value:function(){return v.NUMBER_DATETIME}}]),r}(h);t.DateTimeNumber=g;var v,E=function(e){o(r,e);var t=i(r);function r(){return c(this,r),t.apply(this,arguments)}return f(r,[{key:"getDetailedType",value:function(){return v.NUMBER_PERCENT}}]),r}(h);t.PercentNumber=E,t.NumberType=v,function(e){e.NUMBER_RAW="NUMBER_RAW",e.NUMBER_DATE="NUMBER_DATE",e.NUMBER_TIME="NUMBER_TIME",e.NUMBER_DATETIME="NUMBER_DATETIME",e.NUMBER_CURRENCY="NUMBER_CURRENCY",e.NUMBER_PERCENT="NUMBER_PERCENT"}(v||(t.NumberType=v={}))},function(e,t,r){"use strict";t.__esModule=!0,t.StatType=t.Statistics=t.EmptyStatistics=void 0;var n=r(225);t.EmptyStatistics=n.EmptyStatistics;var o=r(226);t.Statistics=o.Statistics;var a=r(227);t.StatType=a.StatType},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var o=c(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return s(this,r)}}function s(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.EmptyStatistics=void 0,r(109);var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(c,e);var t,r,n,s=u(c);function c(){return o(this,c),s.apply(this,arguments)}return t=c,(r=[{key:"incrementCriterionFunctionFullCacheUsed",value:function(){}},{key:"incrementCriterionFunctionPartialCacheUsed",value:function(){}},{key:"start",value:function(e){}},{key:"end",value:function(e){}}])&&a(t.prototype,r),n&&a(t,n),c}(r(226).Statistics);t.EmptyStatistics=l},function(e,t,r){"use strict";t.__esModule=!0,t.Statistics=void 0,r(95),r(210),r(63),r(77),r(97);var n=r(227);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.stats=new Map([[n.StatType.CRITERION_FUNCTION_FULL_CACHE_USED,0],[n.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]),this.startTimes=new Map}var t,r,a;return t=e,(r=[{key:"incrementCriterionFunctionFullCacheUsed",value:function(){var e=(this.stats.get(n.StatType.CRITERION_FUNCTION_FULL_CACHE_USED)||0)+1;this.stats.set(n.StatType.CRITERION_FUNCTION_FULL_CACHE_USED,e)}},{key:"incrementCriterionFunctionPartialCacheUsed",value:function(){var e=(this.stats.get(n.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED)||0)+1;this.stats.set(n.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED,e)}},{key:"reset",value:function(){this.stats.clear(),this.startTimes.clear(),this.stats.set(n.StatType.CRITERION_FUNCTION_FULL_CACHE_USED,0),this.stats.set(n.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}},{key:"start",value:function(e){if(this.startTimes.get(e))throw Error("Statistics ".concat(e," already started"));this.startTimes.set(e,Date.now())}},{key:"end",value:function(e){var t=Date.now(),r=this.startTimes.get(e);if(!r)throw Error("Statistics ".concat(e," not started"));var n=this.stats.get(e)||0;n+=t-r,this.stats.set(e,n),this.startTimes.delete(e)}},{key:"measure",value:function(e,t){this.start(e);var r=t();return this.end(e),r}},{key:"snapshot",value:function(){return new Map(this.stats)}},{key:"destroy",value:function(){this.stats.clear(),this.startTimes.clear()}}])&&o(t.prototype,r),a&&o(t,a),e}();t.Statistics=a},function(e,t,r){"use strict";
/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */
var n;t.__esModule=!0,t.StatType=void 0,t.StatType=n,function(e){e.BUILD_ENGINE_TOTAL="BUILD_ENGINE_TOTAL",e.PARSER="PARSER",e.GRAPH_BUILD="GRAPH_BUILD",e.TOP_SORT="TOP_SORT",e.MATRIX_DETECTION="MATRIX_DETECTION",e.BUILD_COLUMN_INDEX="BUILD_COLUMN_INDEX",e.EVALUATION="EVALUATION",e.VLOOKUP="VLOOKUP",e.TRANSFORM_ASTS="TRANSFORM_ASTS",e.TRANSFORM_ASTS_POSTPONED="TRANSFORM_ASTS_POSTPONED",e.ADJUSTING_ADDRESS_MAPPING="ADJUSTING_ADDRESS_MAPPING",e.ADJUSTING_MATRIX_MAPPING="ADJUSTING_MATRIX_MAPPING",e.ADJUSTING_RANGES="ADJUSTING_RANGES",e.ADJUSTING_GRAPH="ADJUSTING_GRAPH",e.CRITERION_FUNCTION_FULL_CACHE_USED="CRITERION_FUNCTION_FULL_CACHE_USED",e.CRITERION_FUNCTION_PARTIAL_CACHE_USED="CRITERION_FUNCTION_PARTIAL_CACHE_USED"}(n||(t.StatType=n={}))},function(e,t,r){"use strict";r(53),r(67),r(68),r(87),r(93),r(94),t.__esModule=!0,t.AddressMapping=void 0,r(120),r(95),r(210),r(63),r(77),r(97),r(229);var n=r(223),o=r(118),a=r(231);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=s(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}function s(e,t){if(e){if("string"==typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.policy=t,this.mapping=new Map}var t,r,s;return t=e,(r=[{key:"getCell",value:function(e){var t=this.mapping.get(e.sheet);if(!t)throw new a.NoSheetWithIdError(e.sheet);return t.getCell(e)}},{key:"fetchCell",value:function(e){var t=this.mapping.get(e.sheet);if(!t)throw new a.NoSheetWithIdError(e.sheet);var r=t.getCell(e);if(!r)throw Error("Vertex for address missing in AddressMapping");return r}},{key:"strategyFor",value:function(e){var t=this.mapping.get(e);if(!t)throw new a.NoSheetWithIdError(e);return t}},{key:"addSheet",value:function(e,t){if(this.mapping.has(e))throw Error("Sheet already added");this.mapping.set(e,t)}},{key:"autoAddSheet",value:function(e,t,r){var n=r.height,o=r.width,a=r.fill,i=this.policy.call(a);this.addSheet(e,new i(o,n))}},{key:"getCellValue",value:function(e){var t=this.getCell(e);return null===t?n.EmptyValue:t instanceof o.MatrixVertex?t.getMatrixCellValue(e):t.getCellValue()}},{key:"getRawValue",value:function(e){var t=this.getCell(e);return t instanceof o.ValueCellVertex?t.getValues().rawValue:t instanceof o.MatrixVertex?t.getMatrixCellRawValue(e):null}},{key:"setCell",value:function(e,t){var r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized");r.setCell(e,t)}},{key:"removeCell",value:function(e){var t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet not initialized");t.removeCell(e)}},{key:"has",value:function(e){var t=this.mapping.get(e.sheet);return!!t&&t.has(e)}},{key:"getHeight",value:function(e){var t=this.mapping.get(e);if(!t)throw new a.NoSheetWithIdError(e);return t.getHeight()}},{key:"getWidth",value:function(e){var t=this.mapping.get(e);if(!t)throw new a.NoSheetWithIdError(e);return t.getWidth()}},{key:"addRows",value:function(e,t,r){var n=this.mapping.get(e);if(!n)throw Error("Sheet does not exist");n.addRows(t,r)}},{key:"removeRows",value:function(e){var t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet does not exist");t.removeRows(e)}},{key:"removeSheet",value:function(e){this.mapping.delete(e)}},{key:"addColumns",value:function(e,t,r){var n=this.mapping.get(e);if(!n)throw Error("Sheet does not exist");n.addColumns(t,r)}},{key:"removeColumns",value:function(e){var t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet does not exist");t.removeColumns(e)}},{key:"verticesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.mapping.get(t.sheet).verticesFromRowsSpan(t),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"verticesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.mapping.get(t.sheet).verticesFromColumnsSpan(t),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.mapping.get(t.sheet).entriesFromRowsSpan(t),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.mapping.get(t.sheet).entriesFromColumnsSpan(t),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"entries",value:regeneratorRuntime.mark((function e(){var t,r,n,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=u(this.mapping.entries()),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=8;break}return n=i(r.value,2),o=n[0],a=n[1],e.delegateYield(a.getEntries(o),"t0",6);case 6:e.next=3;break;case 8:e.next=13;break;case 10:e.prev=10,e.t1=e.catch(1),t.e(e.t1);case 13:return e.prev=13,t.f(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[1,10,13,16]])}))},{key:"sheetEntries",value:regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.mapping.get(t))){e.next=5;break}return e.delegateYield(r.getEntries(t),"t0",3);case 3:e.next=6;break;case 5:throw new Error("Sheet does not exists");case 6:case"end":return e.stop()}}),e,this)}))},{key:"destroy",value:function(){this.mapping.clear()}}])&&l(t.prototype,r),s&&l(t,s),e}();t.AddressMapping=f},function(e,t,r){var n=r(2),o=r(230),a=r(96);n({target:"Array",proto:!0},{fill:o}),a("fill")},function(e,t,r){"use strict";var n=r(17),o=r(43),a=r(41);e.exports=function(e){for(var t=n(this),r=a(t.length),i=arguments.length,u=o(i>1?arguments[1]:void 0,r),s=i>2?arguments[2]:void 0,c=void 0===s?r:o(s,r);c>u;)t[u++]=e;return t}},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function s(e){var t=p();return function(){var r,n=d(e);if(t){var o=d(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){var t="function"==typeof Map?new Map:void 0;return(l=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return f(e,arguments,d(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),h(n,e)})(e)}function f(e,t,r){return(f=p()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&h(o,r.prototype),o}).apply(null,arguments)}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}
/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */r(1),r(95),r(210),r(77),r(97),r(87),r(93),r(94),t.__esModule=!0,t.AliasAlreadyExisting=t.NoRelativeAddressesAllowedError=t.MatrixFormulasNotSupportedError=t.TargetLocationHasMatrixError=t.SourceLocationHasMatrixError=t.ProtectedFunctionError=t.FunctionPluginValidationError=t.LanguageAlreadyRegisteredError=t.LanguageNotRegisteredError=t.ProtectedFunctionTranslationError=t.MissingTranslationError=t.EvaluationSuspendedError=t.ExpectedOneOfValuesError=t.ConfigValueTooBigError=t.ConfigValueTooSmallError=t.ConfigValueEmpty=t.ExpectedValueOfTypeError=t.UnableToParseError=t.NothingToPasteError=t.NoOperationToRedoError=t.NoOperationToUndoError=t.NamedExpressionDoesNotExistError=t.NamedExpressionNameIsInvalidError=t.NamedExpressionNameIsAlreadyTakenError=t.InvalidArgumentsError=t.InvalidAddressError=t.NotAFormulaError=t.SheetSizeLimitExceededError=t.SheetNameAlreadyTakenError=t.NoSheetWithNameError=t.NoSheetWithIdError=void 0,r(125),r(63),r(148),r(143),r(146),r(109);var m=function(e){u(r,e);var t=s(r);function r(e){return i(this,r),t.call(this,"There's no sheet with id = ".concat(e))}return r}(l(Error));t.NoSheetWithIdError=m;var y=function(e){u(r,e);var t=s(r);function r(e){return i(this,r),t.call(this,"There's no sheet with name '".concat(e,"'"))}return r}(l(Error));t.NoSheetWithNameError=y;var g=function(e){u(r,e);var t=s(r);function r(e){return i(this,r),t.call(this,"Sheet with name ".concat(e," already exists"))}return r}(l(Error));t.SheetNameAlreadyTakenError=g;var v=function(e){u(r,e);var t=s(r);function r(){return i(this,r),t.call(this,"Sheet size limit exceeded")}return r}(l(Error));t.SheetSizeLimitExceededError=v;var E=function(e){u(r,e);var t=s(r);function r(){return i(this,r),t.call(this,"This is not a formula")}return r}(l(Error));t.NotAFormulaError=E;var T=function(e){u(r,e);var t=s(r);function r(e){return i(this,r),t.call(this,"Address (row = ".concat(e.row,", col = ").concat(e.col,") is invalid"))}return r}(l(Error));t.InvalidAddressError=T;var b=function(e){u(r,e);var t=s(r);function r(e){return i(this,r),t.call(this,"Invalid arguments, expected ".concat(e))}return r}(l(Error));t.InvalidArgumentsError=b;var R=function(e){u(r,e);var t=s(r);function r(e){return i(this,r),t.call(this,"Name of Named Expression '".concat(e,"' is already present"))}return r}(l(Error));t.NamedExpressionNameIsAlreadyTakenError=R;var A=function(e){u(r,e);var t=s(r);function r(e){return i(this,r),t.call(this,"Name of Named Expression '".concat(e,"' is invalid"))}return r}(l(Error));t.NamedExpressionNameIsInvalidError=A;var S=function(e){u(r,e);var t=s(r);function r(e){return i(this,r),t.call(this,"Named Expression '".concat(e,"' does not exist"))}return r}(l(Error));t.NamedExpressionDoesNotExistError=S;var N=function(e){u(r,e);var t=s(r);function r(){return i(this,r),t.call(this,"There is no operation to undo")}return r}(l(Error));t.NoOperationToUndoError=N;var O=function(e){u(r,e);var t=s(r);function r(){return i(this,r),t.call(this,"There is no operation to redo")}return r}(l(Error));t.NoOperationToRedoError=O;var C=function(e){u(r,e);var t=s(r);function r(){return i(this,r),t.call(this,"There is nothing to paste")}return r}(l(Error));function w(e,t){switch(a(t)){case"function":case"symbol":return t.toString();case"bigint":return"BigInt("+t.toString()+")";default:return t instanceof RegExp?"RegExp("+t.toString()+")":t}}t.NothingToPasteError=C;var M=function(e){u(r,e);var t=s(r);function r(e){return i(this,r),t.call(this,"Unable to parse value: ".concat(JSON.stringify(e,w,4)))}return r}(l(Error));t.UnableToParseError=M;var I=function(e){u(r,e);var t=s(r);function r(e,n){return i(this,r),t.call(this,"Expected value of type: ".concat(e," for config parameter: ").concat(n))}return r}(l(Error));t.ExpectedValueOfTypeError=I;var x=function(e){u(r,e);var t=s(r);function r(e){return i(this,r),t.call(this,"Config parameter ".concat(e," cannot be empty."))}return r}(l(Error));t.ConfigValueEmpty=x;var k=function(e){u(r,e);var t=s(r);function r(e,n){return i(this,r),t.call(this,"Config parameter ".concat(e," should be at least ").concat(n))}return r}(l(Error));t.ConfigValueTooSmallError=k;var _=function(e){u(r,e);var t=s(r);function r(e,n){return i(this,r),t.call(this,"Config parameter ".concat(e," should be at most ").concat(n))}return r}(l(Error));t.ConfigValueTooBigError=_;var P=function(e){u(r,e);var t=s(r);function r(e,n){return i(this,r),t.call(this,"Expected one of ".concat(e," for config parameter: ").concat(n))}return r}(l(Error));t.ExpectedOneOfValuesError=P;var L=function(e){u(r,e);var t=s(r);function r(){return i(this,r),t.call(this,"Computations are suspended")}return r}(l(Error));t.EvaluationSuspendedError=L;var F=function(e){u(r,e);var t=s(r);function r(e){return i(this,r),t.call(this,"Translation for ".concat(e," is missing in the translation package you're using."))}return r}(l(Error));t.MissingTranslationError=F;var U=function(e){u(r,e);var t=s(r);function r(e){return i(this,r),t.call(this,"Cannot register translation for function with id: ".concat(e))}return r}(l(Error));t.ProtectedFunctionTranslationError=U;var V=function(e){u(r,e);var t=s(r);function r(){return i(this,r),t.call(this,"Language not registered.")}return r}(l(Error));t.LanguageNotRegisteredError=V;var D=function(e){u(r,e);var t=s(r);function r(){return i(this,r),t.call(this,"Language already registered.")}return r}(l(Error));t.LanguageAlreadyRegisteredError=D;var j=function(e){u(r,e);var t=s(r);function r(){return i(this,r),t.apply(this,arguments)}return o(r,null,[{key:"functionNotDeclaredInPlugin",value:function(e,t){return new r("Function with id ".concat(e," not declared in plugin ").concat(t))}},{key:"functionMethodNotFound",value:function(e,t){return new r("Function method ".concat(e," not found in plugin ").concat(t))}}]),r}(l(Error));t.FunctionPluginValidationError=j;var B=function(e){u(r,e);var t=s(r);function r(){return i(this,r),t.apply(this,arguments)}return o(r,null,[{key:"cannotRegisterFunctionWithId",value:function(e){return new r("Cannot register function with id ".concat(e))}},{key:"cannotUnregisterFunctionWithId",value:function(e){return new r("Cannot unregister function with id ".concat(e))}},{key:"cannotUnregisterProtectedPlugin",value:function(){return new r("Cannot unregister protected plugin")}}]),r}(l(Error));t.ProtectedFunctionError=B;var G=function(e){u(r,e);var t=s(r);function r(){return i(this,r),t.call(this,"Cannot perform this operation, source location has a matrix inside.")}return r}(l(Error));t.SourceLocationHasMatrixError=G;var W=function(e){u(r,e);var t=s(r);function r(){return i(this,r),t.call(this,"Cannot perform this operation, target location has a matrix inside.")}return r}(l(Error));t.TargetLocationHasMatrixError=W;var H=function(e){u(r,e);var t=s(r);function r(){return i(this,r),t.call(this,"Matrix formulas are not supported in named expressions.")}return r}(l(Error));t.MatrixFormulasNotSupportedError=H;var z=function(e){u(r,e);var t=s(r);function r(){return i(this,r),t.call(this,"Relative addresses not allowed in named expressions.")}return r}(l(Error));t.NoRelativeAddressesAllowedError=z;var Y=function(e){u(r,e);var t=s(r);function r(e,n){return i(this,r),t.call(this,"Alias id ".concat(e," in plugin ").concat(n," already defined as a function or alias."))}return r}(l(Error));t.AliasAlreadyExisting=Y},function(e,t,r){"use strict";t.__esModule=!0,t.collectAddressesDependentToMatrix=void 0,r(68),r(77),r(221),r(121);var n=r(141),o=r(233),a=r(234),i=r(237);t.collectAddressesDependentToMatrix=function(e,t,r,u,s){var c,l,f=r.getRange();if(t instanceof i.RangeVertex){var p=t.range.intersectionWith(f);return null!==p?Array.from(p.addresses(s)):[]}if(t instanceof o.FormulaCellVertex)c=t.getFormula(u),l=t.getAddress(u);else{if(!(t instanceof a.MatrixVertex&&t.isFormula()))return[];c=t.getFormula(),l=t.getAddress()}return(0,n.collectDependencies)(c,e).filter((function(e){return e instanceof n.AddressDependency})).map((function(e){return e.dependency.toSimpleCellAddress(l)})).filter((function(e){return f.addressInRange(e)}))}},function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r(87),r(93),r(63),r(94),r(95),r(77),r(97),r(53),r(67),r(68),t.__esModule=!0,t.FormulaCellVertex=void 0;
/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */
var i=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.formula=t,this.cellAddress=r,this.version=n,this.formula=t,this.cellAddress=r,this.cachedCellValue=null}var t,r,o;return t=e,(r=[{key:"getFormula",value:function(e){return this.ensureRecentData(e),this.formula}},{key:"ensureRecentData",value:function(e){if(this.version!=e.version()){var t=n(e.applyTransformations(this.formula,this.address,this.version),3),r=t[0],o=t[1],a=t[2];this.formula=r,this.cellAddress=o,this.version=a}}},{key:"getAddress",value:function(e){return this.ensureRecentData(e),this.cellAddress}},{key:"address",get:function(){return this.cellAddress}},{key:"setCellValue",value:function(e){this.cachedCellValue=e}},{key:"getCellValue",value:function(){if(null!==this.cachedCellValue)return this.cachedCellValue;throw Error("Value of the formula cell is not computed.")}},{key:"valueOrNull",value:function(){return this.cachedCellValue}},{key:"isComputed",value:function(){return null!==this.cachedCellValue}}])&&a(t.prototype,r),o&&a(t,o),e}();t.FormulaCellVertex=i},function(e,t,r){"use strict";t.__esModule=!0,t.MatrixVertex=void 0;var n=r(135),o=r(115),a=r(235),i=r(219);function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(t,r,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cellAddress=t,this.formula=o||null,this.matrix=new a.NotComputedMatrix(new a.MatrixSize(r,n))}var t,r,s;return t=e,s=[{key:"fromRange",value:function(t,r){return new e(t.start,t.width(),t.height(),r)}}],(r=[{key:"width",get:function(){return this.matrix.width()}},{key:"height",get:function(){return this.matrix.height()}},{key:"sheet",get:function(){return this.cellAddress.sheet}},{key:"setCellValue",value:function(e){this.matrix=e}},{key:"setErrorValue",value:function(e){this.matrix=new a.ErroredMatrix(e,this.matrix.size)}},{key:"getCellValue",value:function(){if(this.matrix instanceof a.NotComputedMatrix)throw Error("Matrix not computed yet.");return this.matrix}},{key:"getMatrixCellValue",value:function(e){var t=e.col-this.cellAddress.col,r=e.row-this.cellAddress.row;return this.matrix.get(t,r)}},{key:"getMatrixCellRawValue",value:function(e){var t=this.getMatrixCellValue(e);return t instanceof o.CellError?void 0:t}},{key:"setMatrixCellValue",value:function(e,t){var r=e.col-this.cellAddress.col,n=e.row-this.cellAddress.row;this.matrix instanceof a.Matrix&&this.matrix.set(r,n,t)}},{key:"getRange",value:function(){return n.AbsoluteCellRange.spanFrom(this.cellAddress,this.width,this.height)}},{key:"getAddress",value:function(){return this.cellAddress}},{key:"setAddress",value:function(e){this.cellAddress=e}},{key:"getFormula",value:function(){return this.formula}},{key:"setFormula",value:function(e){this.formula=e}},{key:"isFormula",value:function(){return null!==this.formula}},{key:"isNumeric",value:function(){return null===this.formula}},{key:"spansThroughSheetRows",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;return this.cellAddress.sheet===e&&this.cellAddress.row<=r&&t<this.cellAddress.row+this.height}},{key:"spansThroughSheetColumn",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;return this.cellAddress.sheet===e&&this.cellAddress.col<=r&&t<this.cellAddress.col+this.width}},{key:"addRows",value:function(e,t,r){this.matrix instanceof a.Matrix&&this.matrix.addRows(t-this.getAddress().row,r)}},{key:"addColumns",value:function(e,t,r){this.matrix instanceof a.Matrix&&this.matrix.addColumns(t-this.getAddress().col,r)}},{key:"removeRows",value:function(e){if(this.matrix instanceof a.Matrix){var t=this.rowsFromMatrix().intersect(e);this.matrix.removeRows(t.rowStart-this.getAddress().row,t.rowEnd-this.getAddress().row)}}},{key:"removeColumns",value:function(e){if(this.matrix instanceof a.Matrix){var t=this.columnsFromMatrix().intersect(e);this.matrix.removeColumns(t.columnStart-this.getAddress().col,t.columnEnd-this.getAddress().col)}}},{key:"isComputed",value:function(){return!(this.matrix instanceof a.NotComputedMatrix)}},{key:"columnsFromMatrix",value:function(){return i.ColumnsSpan.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}},{key:"rowsFromMatrix",value:function(){return i.RowsSpan.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}}])&&u(t.prototype,r),s&&u(t,s),e}();t.MatrixVertex=s},function(e,t,r){"use strict";r(87),r(93),r(63),r(94),r(95),r(77),r(97),r(68),r(53),r(67),t.__esModule=!0,t.matrixSizeForTranspose=d,t.matrixSizeForMultiplication=m,t.matrixSizeForPoolFunction=y,t.checkMatrixSize=function e(t,r){if(t.type!==i.AstNodeType.FUNCTION_CALL){if(t.type===i.AstNodeType.CELL_RANGE){var u=n.AbsoluteCellRange.fromCellRange(t,r);return{width:u.width(),height:u.height()}}return t.type===i.AstNodeType.NUMBER||t.type===i.AstNodeType.CELL_REFERENCE?{width:1,height:1}:new o.CellError(o.ErrorType.VALUE)}switch(t.procedureName){case"MMULT":if(2!==t.args.length)return new o.CellError(o.ErrorType.NA,a.ErrorMessage.WrongArgNumber);if(t.args.some((function(e){return e.type===i.AstNodeType.EMPTY})))return new o.CellError(o.ErrorType.NUM,a.ErrorMessage.EmptyArg);var s=e(t.args[0],r),c=e(t.args[1],r);return s instanceof o.CellError?s:c instanceof o.CellError?c:s.width!==c.height?new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.MatrixDimensions):m(s,c);case"MEDIANPOOL":case"MAXPOOL":if(t.args.length<2||t.args.length>3)return new o.CellError(o.ErrorType.NA,a.ErrorMessage.WrongArgNumber);if(t.args.some((function(e){return e.type===i.AstNodeType.EMPTY})))return new o.CellError(o.ErrorType.NUM,a.ErrorMessage.EmptyArg);var l=e(t.args[0],r),f=t.args[1];if(l instanceof o.CellError)return l;if(f.type!==i.AstNodeType.NUMBER)return new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.NumberExpected);var p=f.value,h=f.value;if(3===t.args.length){var g=t.args[2];if(g.type!==i.AstNodeType.NUMBER)return new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.MatrixParams);h=g.value}return p>l.width||p>l.height||h>p||(l.width-p)%h!=0||(l.height-p)%h!=0?new o.CellError(o.ErrorType.VALUE):y(l,p,h);case"TRANSPOSE":if(1!==t.args.length)return new o.CellError(o.ErrorType.NA,a.ErrorMessage.WrongArgNumber);if(t.args[0].type===i.AstNodeType.EMPTY)return new o.CellError(o.ErrorType.NUM,a.ErrorMessage.EmptyArg);var v=e(t.args[0],r);return v instanceof o.CellError?v:d(v);default:return new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.MatrixFunction)}},t.ErroredMatrix=t.Matrix=t.NotComputedMatrix=t.MatrixSize=void 0,r(120),r(236),r(125),r(229);var n=r(135),o=r(115),a=r(215),i=r(141);function u(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),e}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var h=function e(t,r){if(p(this,e),this.width=t,this.height=r,t<=0||r<=0)throw Error("Incorrect matrix size")};function d(e){return new h(e.height,e.width)}function m(e,t){return new h(t.width,e.height)}function y(e,t,r){return new h(1+(e.width-t)/r,1+(e.height-t)/r)}t.MatrixSize=h;var g=function(){function e(t){p(this,e),this.size=t}return f(e,[{key:"width",value:function(){return this.size.width}},{key:"height",value:function(){return this.size.height}},{key:"get",value:function(e,t){throw Error("Matrix not computed yet.")}}]),e}();t.NotComputedMatrix=g;var v=function(){function e(t){p(this,e),this.size=new h(t.length>0?t[0].length:0,t.length),this.matrix=t}return f(e,[{key:"addRows",value:function(e,t){var r;(r=this.matrix).splice.apply(r,[e,0].concat(u(this.zeroArrays(t,this.width())))),this.size.height+=t}},{key:"addColumns",value:function(e,t){for(var r=0;r<this.height();r++){var n;(n=this.matrix[r]).splice.apply(n,[e,0].concat(u(new Array(t).fill(0))))}this.size.width+=t}},{key:"removeRows",value:function(e,t){if(this.outOfBound(0,e)||this.outOfBound(0,t))throw Error("Matrix index out of bound");var r=t-e+1;this.matrix.splice(e,r),this.size.height-=r}},{key:"removeColumns",value:function(e,t){if(this.outOfBound(e,0)||this.outOfBound(t,0))throw Error("Matrix index out of bound");var r,n=t-e+1,o=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=s(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}(this.matrix);try{for(o.s();!(r=o.n()).done;)r.value.splice(e,n)}catch(e){o.e(e)}finally{o.f()}this.size.width-=n}},{key:"zeroArrays",value:function(e,t){for(var r=[],n=0;n<e;++n)r.push(new Array(t).fill(0));return r}},{key:"get",value:function(e,t){if(this.outOfBound(e,t))throw Error("Matrix index out of bound");return this.matrix[t][e]}},{key:"set",value:function(e,t,r){if(this.outOfBound(e,t))throw Error("Matrix index out of bound");this.matrix[t][e]=r}},{key:"width",value:function(){return this.size.width}},{key:"height",value:function(){return this.size.height}},{key:"raw",value:function(){return this.matrix}},{key:"generateValues",value:regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0;case 1:if(!(r<this.size.height)){e.next=12;break}n=0;case 3:if(!(n<this.size.width)){e.next=9;break}return e.next=6,[this.matrix[r][n],(0,o.simpleCellAddress)(t.sheet,t.col+n,t.row+r)];case 6:++n,e.next=3;break;case 9:++r,e.next=1;break;case 12:case"end":return e.stop()}}),e,this)}))},{key:"outOfBound",value:function(e,t){return e<0||t<0||t>this.size.height-1||e>this.size.width-1}}]),e}();t.Matrix=v;var E=function(){function e(t,r){p(this,e),this.error=t,this.size=r}return f(e,[{key:"get",value:function(e,t){return this.error}},{key:"width",value:function(){return this.size.width}},{key:"height",value:function(){return this.size.height}}]),e}();t.ErroredMatrix=E},function(e,t,r){"use strict";var n=r(2),o=r(43),a=r(42),i=r(41),u=r(17),s=r(92),c=r(55),l=r(62)("splice"),f=Math.max,p=Math.min;n({target:"Array",proto:!0,forced:!l},{splice:function(e,t){var r,n,l,h,d,m,y=u(this),g=i(y.length),v=o(e,g),E=arguments.length;if(0===E?r=n=0:1===E?(r=0,n=g-v):(r=E-2,n=p(f(a(t),0),g-v)),g+r-n>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(l=s(y,n),h=0;h<n;h++)(d=v+h)in y&&c(l,h,y[d]);if(l.length=n,r<n){for(h=v;h<g-n;h++)m=h+r,(d=h+n)in y?y[m]=y[d]:delete y[m];for(h=g;h>g-n+r;h--)delete y[h-1]}else if(r>n)for(h=g-n;h>v;h--)m=h+r-1,(d=h+n-1)in y?y[m]=y[d]:delete y[m];for(h=0;h<r;h++)y[h+v]=arguments[h+2];return y.length=g-n+r,l}})},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}t.__esModule=!0,t.RangeVertex=void 0,r(95),r(210),r(63),r(77),r(97),r(122),r(126);
/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */
var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.range=t,this.functionCache=new Map,this.criterionFunctionCache=new Map,this.dependentCacheRanges=new Set,this.bruteForce=!1}var t,r,o;return t=e,(r=[{key:"start",get:function(){return this.range.start}},{key:"end",get:function(){return this.range.end}},{key:"sheet",get:function(){return this.range.start.sheet}},{key:"getFunctionValue",value:function(e){return this.functionCache.get(e)||null}},{key:"setFunctionValue",value:function(e,t){this.functionCache.set(e,t)}},{key:"getCriterionFunctionValue",value:function(e,t){var r=this.getCriterionFunctionValues(e).get(t);return r?r[0]:null}},{key:"getCriterionFunctionValues",value:function(e){return this.criterionFunctionCache.get(e)||new Map}},{key:"setCriterionFunctionValues",value:function(e,t){this.criterionFunctionCache.set(e,t)}},{key:"addDependentCacheRange",value:function(e){e!==this&&this.dependentCacheRanges.add(e)}},{key:"clearCache",value:function(){this.functionCache.clear(),this.criterionFunctionCache.clear(),this.dependentCacheRanges.forEach((function(e){return e.criterionFunctionCache.clear()})),this.dependentCacheRanges.clear()}},{key:"getStart",value:function(){return this.start}},{key:"getEnd",value:function(){return this.end}}])&&n(t.prototype,r),o&&n(t,o),e}();t.RangeVertex=o},function(e,t,r){"use strict";function n(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return u=e.done,e},e:function(e){s=!0,i=e},f:function(){try{u||null==r.return||r.return()}finally{if(s)throw i}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}
/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */
var i;r(53),r(67),r(87),r(93),r(94),t.__esModule=!0,t.Graph=void 0,r(95),r(63),r(122),r(77),r(97),r(210),r(126),r(68),r(239),function(e){e[e.ON_STACK=0]="ON_STACK",e[e.PROCESSED=1]="PROCESSED",e[e.POPPED=2]="POPPED"}(i||(i={}));var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dependencyQuery=t,this.nodes=new Set,this.specialNodes=new Set,this.specialNodesStructuralChanges=new Set,this.specialNodesRecentlyChanged=new Set,this.infiniteRanges=new Set,this.edges=new Map}var t,r,o;return t=e,(r=[{key:"addNode",value:function(e){this.nodes.add(e),this.edges.has(e)||this.edges.set(e,new Set)}},{key:"addEdge",value:function(e,t){if(!this.nodes.has(e))throw new Error("Unknown node ".concat(e));if(!this.nodes.has(t))throw new Error("Unknown node ".concat(t));this.edges.get(e).add(t)}},{key:"removeEdge",value:function(e,t){if(!this.existsEdge(e,t))throw new Error("Edge does not exist");this.edges.get(e).delete(t)}},{key:"softRemoveEdge",value:function(e,t){var r;null===(r=this.edges.get(e))||void 0===r||r.delete(t)}},{key:"removeIncomingEdges",value:function(e){this.edges.forEach((function(t){t.delete(e)}))}},{key:"adjacentNodes",value:function(e){return this.edges.get(e)}},{key:"adjacentNodesCount",value:function(e){return this.adjacentNodes(e).size}},{key:"hasNode",value:function(e){return this.nodes.has(e)}},{key:"nodesCount",value:function(){return this.nodes.size}},{key:"edgesCount",value:function(){var e=0;return this.edges.forEach((function(t){return e+=t.size})),e}},{key:"removeNode",value:function(e){var t,r=n(this.adjacentNodes(e).values());try{for(r.s();!(t=r.n()).done;){var o=t.value;this.markNodeAsSpecialRecentlyChanged(o)}}catch(e){r.e(e)}finally{r.f()}return this.edges.delete(e),this.nodes.delete(e),this.specialNodes.delete(e),this.specialNodesRecentlyChanged.delete(e),this.specialNodesStructuralChanges.delete(e),this.infiniteRanges.delete(e),this.removeDependencies(e)}},{key:"markNodeAsSpecial",value:function(e){this.specialNodes.add(e)}},{key:"markNodeAsSpecialRecentlyChanged",value:function(e){this.nodes.has(e)&&this.specialNodesRecentlyChanged.add(e)}},{key:"markNodeAsChangingWithStructure",value:function(e){this.specialNodesStructuralChanges.add(e)}},{key:"clearSpecialNodesRecentlyChanged",value:function(){this.specialNodesRecentlyChanged.clear()}},{key:"markNodeAsInfiniteRange",value:function(e){this.infiniteRanges.add(e)}},{key:"existsEdge",value:function(e,t){var r,n;return null!==(n=null===(r=this.edges.get(e))||void 0===r?void 0:r.has(t))&&void 0!==n&&n}},{key:"topSortWithScc",value:function(){return this.getTopSortedWithSccSubgraphFrom(Array.from(this.nodes),(function(e){return!0}),(function(e){}))}},{key:"getTopSortedWithSccSubgraphFrom",value:function(e,t,r){var n=this,o=new Map,a=new Map,u=new Map,s=new Set,c=new Map,l=[],f=0,p=new Set;e.reverse(),e.forEach((function(e){if(void 0===c.get(e)){var t=[e],r=[];c.set(e,i.ON_STACK);for(var h=function(){var e=t[t.length-1];switch(c.get(e)){case i.ON_STACK:o.set(e,f),a.set(e,f),r.push(e),f++,n.adjacentNodes(e).forEach((function(r){void 0===o.get(r)&&(t.push(r),u.set(r,e),c.set(r,i.ON_STACK))})),c.set(e,i.PROCESSED);break;case i.PROCESSED:var h;if(h=o.get(e),n.adjacentNodes(e).forEach((function(t){s.has(t)||(h=u.get(t)===e?Math.min(h,a.get(t)):Math.min(h,o.get(t)))})),a.set(e,h),h===o.get(e)){var d=[];do{d.push(r[r.length-1]),r.pop()}while(d[d.length-1]!==e);d.forEach((function(e){s.add(e)})),l.push.apply(l,d),d.length>1&&d.forEach((function(e){p.add(e)}))}t.pop(),c.set(e,i.POPPED);break;case i.POPPED:t.pop()}};t.length>0;)h()}}));var h=new Set(e),d=[],m=[];return l.reverse(),l.forEach((function(e){p.has(e)||n.adjacentNodes(e).has(e)?(m.push(e),r(e),n.adjacentNodes(e).forEach((function(e){return h.add(e)}))):(d.push(e),h.has(e)&&t(e)&&n.adjacentNodes(e).forEach((function(e){return h.add(e)})))})),{sorted:d,cycled:m}}},{key:"getDependencies",value:function(e){var t=[];return this.edges.forEach((function(r,n){r.has(e)&&t.push(n)})),t}},{key:"destroy",value:function(){this.edges.clear(),this.nodes.clear(),this.specialNodes.clear(),this.specialNodesStructuralChanges.clear(),this.clearSpecialNodesRecentlyChanged()}},{key:"removeDependencies",value:function(e){var t=this.dependencyQuery(e);if(!t)return[];var r,o=n(t);try{for(o.s();!(r=o.n()).done;){var a=r.value;this.softRemoveEdge(a,e)}}catch(e){o.e(e)}finally{o.f()}return t}}])&&a(t.prototype,r),o&&a(t,o),e}();t.Graph=u},function(e,t,r){"use strict";var n=r(2),o=r(54),a=[].reverse,i=[1,2];n({target:"Array",proto:!0,forced:String(i)===String(i.reverse())},{reverse:function(){return o(this)&&(this.length=this.length),a.call(this)}})},function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=a(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return u=e.done,e},e:function(e){s=!0,i=e},f:function(){try{u||null==r.return||r.return()}finally{if(s)throw i}}}}function a(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r(53),r(67),r(68),r(87),r(93),r(94),t.__esModule=!0,t.MatrixMapping=void 0,r(120),r(95),r(210),r(63),r(77),r(97),r(148);
/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */
var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.matrixMapping=new Map}var t,r,a;return t=e,(r=[{key:"getMatrix",value:function(e){return this.matrixMapping.get(e.toString())}},{key:"setMatrix",value:function(e,t){this.matrixMapping.set(e.toString(),t)}},{key:"removeMatrix",value:function(e){this.matrixMapping.delete(e.toString())}},{key:"isFormulaMatrixInRow",value:function(e,t){var r,n=o(this.matrixMapping.values());try{for(n.s();!(r=n.n()).done;){var a=r.value;if(a.spansThroughSheetRows(e,t)&&a.isFormula())return!0}}catch(e){n.e(e)}finally{n.f()}return!1}},{key:"isFormulaMatrixInRows",value:function(e){var t,r=o(e.rows());try{for(r.s();!(t=r.n()).done;){var n=t.value;if(this.isFormulaMatrixInRow(e.sheet,n))return!0}}catch(e){r.e(e)}finally{r.f()}return!1}},{key:"isFormulaMatrixInColumn",value:function(e,t){var r,n=o(this.matrixMapping.values());try{for(n.s();!(r=n.n()).done;){var a=r.value;if(a.spansThroughSheetColumn(e,t)&&a.isFormula())return!0}}catch(e){n.e(e)}finally{n.f()}return!1}},{key:"isFormulaMatrixInColumns",value:function(e){var t,r=o(e.columns());try{for(r.s();!(t=r.n()).done;){var n=t.value;if(this.isFormulaMatrixInColumn(e.sheet,n))return!0}}catch(e){r.e(e)}finally{r.f()}return!1}},{key:"isFormulaMatrixInRange",value:function(e){var t,r=o(this.matrixMapping.values());try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n.isFormula()&&n.getRange().doesOverlap(e))return!0}}catch(e){r.e(e)}finally{r.f()}return!1}},{key:"isFormulaMatrixAtAddress",value:function(e){var t,r=o(this.matrixMapping.values());try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n.getRange().addressInRange(e)&&n.isFormula())return!0}}catch(e){r.e(e)}finally{r.f()}return!1}},{key:"numericMatrices",value:regeneratorRuntime.mark((function e(){var t,r,a,i,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=o(this.matrixMapping.entries()),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=10;break}if(a=n(r.value,2),i=a[0],(u=a[1]).isFormula()){e.next=8;break}return e.next=8,[i,u];case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"numericMatricesInRows",value:regeneratorRuntime.mark((function e(t){var r,a,i,u,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=o(this.matrixMapping.entries()),e.prev=1,r.s();case 3:if((a=r.n()).done){e.next=10;break}if(i=n(a.value,2),u=i[0],!(s=i[1]).spansThroughSheetRows(t.sheet,t.rowStart,t.rowEnd)||s.isFormula()){e.next=8;break}return e.next=8,[u,s];case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"numericMatricesInColumns",value:regeneratorRuntime.mark((function e(t){var r,a,i,u,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=o(this.matrixMapping.entries()),e.prev=1,r.s();case 3:if((a=r.n()).done){e.next=10;break}if(i=n(a.value,2),u=i[0],!(s=i[1]).spansThroughSheetColumn(t.sheet,t.columnStart,t.columnEnd)||s.isFormula()){e.next=8;break}return e.next=8,[u,s];case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"numericMatricesInRange",value:regeneratorRuntime.mark((function e(t){var r,a,i,u,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=o(this.matrixMapping.entries()),e.prev=1,r.s();case 3:if((a=r.n()).done){e.next=10;break}if(i=n(a.value,2),u=i[0],!(s=i[1]).getRange().doesOverlap(t)){e.next=8;break}return e.next=8,[u,s];case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"truncateMatricesByRows",value:function(e){var t,r=Array(),a=o(this.numericMatricesInRows(e));try{for(a.s();!(t=a.n()).done;){var i=n(t.value,2),u=i[0],s=i[1];s.removeRows(e),0===s.height&&(this.removeMatrix(u),r.push(s))}}catch(e){a.e(e)}finally{a.f()}return r}},{key:"truncateMatricesByColumns",value:function(e){var t,r=Array(),a=o(this.numericMatricesInColumns(e));try{for(a.s();!(t=a.n()).done;){var i=n(t.value,2),u=i[0],s=i[1];s.removeColumns(e),0===s.width&&(this.removeMatrix(u),r.push(s))}}catch(e){a.e(e)}finally{a.f()}return r}},{key:"destroy",value:function(){this.matrixMapping.clear()}}])&&u(t.prototype,r),a&&u(t,a),e}();t.MatrixMapping=s},function(e,t,r){"use strict";r(53),r(67),r(68),t.__esModule=!0,t.RangeMapping=void 0,r(120),r(95),r(210),r(63),r(77),r(97),r(242),r(94),r(87),r(93),r(136),r(138),r(126),r(125);var n=r(135),o=r(115);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=u(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function u(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rangeMapping=new Map}var t,r,u;return t=e,(r=[{key:"getMappingSize",value:function(e){var t,r;return null!==(r=null===(t=this.rangeMapping.get(e))||void 0===t?void 0:t.size)&&void 0!==r?r:0}},{key:"setRange",value:function(e){var t=this.rangeMapping.get(e.getStart().sheet);void 0===t&&(t=new Map,this.rangeMapping.set(e.getStart().sheet,t));var r=f(e.getStart(),e.getEnd());t.set(r,e)}},{key:"removeRange",value:function(e){var t=e.getStart().sheet,r=this.rangeMapping.get(t);if(void 0!==r){var n=f(e.getStart(),e.getEnd());r.delete(n),0===r.size&&this.rangeMapping.delete(t)}}},{key:"getRange",value:function(e,t){var r=this.rangeMapping.get(e.sheet),n=f(e,t);return null==r?void 0:r.get(n)}},{key:"fetchRange",value:function(e,t){var r=this.getRange(e,t);if(!r)throw Error("Range does not exist");return r}},{key:"truncateRanges",value:function(e,t){var r,n=Array(),o=Array(),u=e.sheet,s=i(this.entriesFromSheet(e.sheet));try{for(s.s();!(r=s.n()).done;){var c=a(r.value,2),l=c[0],f=c[1],d=f.range;e.start<=t(f.range.end)&&(d.removeSpan(e),d.shouldBeRemoved()?(this.removeByKey(u,l),n.push(f)):o.push([l,f]))}}catch(e){s.e(e)}finally{s.f()}var m=[];o.sort((function(e,r){return h(e[1],r[1],t)}));for(var y=0,g=o;y<g.length;y++){var v=a(g[y],2),E=v[0],T=v[1],b=p(T.range);if(b!==E){var R=this.getByKey(u,b);this.removeByKey(u,E),void 0!==R&&T!=R?m.push([R,T]):this.setRange(T)}}return{verticesToRemove:n,verticesToMerge:m}}},{key:"moveAllRangesInSheetAfterRowByRows",value:function(e,t,r){this.updateVerticesFromSheet(e,(function(e,n){return t<=n.start.row?(n.range.shiftByRows(r),n):t>n.start.row&&t<=n.end.row?(n.range.expandByRows(r),n):void 0}))}},{key:"moveAllRangesInSheetAfterColumnByColumns",value:function(e,t,r){this.updateVerticesFromSheet(e,(function(e,n){return t<=n.start.col?(n.range.shiftByColumns(r),n):t>n.start.col&&t<=n.end.col?(n.range.expandByColumns(r),n):void 0}))}},{key:"moveRangesInsideSourceRange",value:function(e,t,r,n){this.updateVerticesFromSheet(e.sheet,(function(o,a){return e.containsRange(a.range)?(a.range.shiftByColumns(t),a.range.shiftByRows(r),a.range.moveToSheet(n),a):void 0}))}},{key:"removeRangesInSheet",value:function(e){if(this.rangeMapping.has(e)){var t=this.rangeMapping.get(e).values();return this.rangeMapping.delete(e),t}return[][Symbol.iterator]()}},{key:"rangesInSheet",value:regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.rangeMapping.get(t)){e.next=3;break}return e.abrupt("return");case 3:return e.delegateYield(r.values(),"t0",4);case 4:case"end":return e.stop()}}),e,this)}))},{key:"rangeVerticesContainedInRange",value:regeneratorRuntime.mark((function e(t){var r,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=i(this.rangesInSheet(t.sheet)),e.prev=1,r.s();case 3:if((n=r.n()).done){e.next=10;break}if(o=n.value,!t.containsRange(o.range)){e.next=8;break}return e.next=8,o;case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"findSmallerRange",value:function(e){if(e.height()>1&&Number.isFinite(e.height())){var t=(0,o.simpleCellAddress)(e.end.sheet,e.end.col,e.end.row-1),r=this.getRange(e.start,t);if(void 0!==r)return{smallerRangeVertex:r,restRange:new n.AbsoluteCellRange((0,o.simpleCellAddress)(e.start.sheet,e.start.col,e.end.row),e.end)}}return{smallerRangeVertex:null,restRange:e}}},{key:"destroy",value:function(){this.rangeMapping.clear()}},{key:"entriesFromSheet",value:regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.rangeMapping.get(t)){e.next=3;break}return e.abrupt("return");case 3:return e.delegateYield(r.entries(),"t0",4);case 4:case"end":return e.stop()}}),e,this)}))},{key:"removeByKey",value:function(e,t){this.rangeMapping.get(e).delete(t)}},{key:"getByKey",value:function(e,t){var r;return null===(r=this.rangeMapping.get(e))||void 0===r?void 0:r.get(t)}},{key:"updateVerticesFromSheet",value:function(e,t){var r,n=this,o=Array(),u=i(this.entriesFromSheet(e));try{for(u.s();!(r=u.n()).done;){var s=a(r.value,2),c=s[0],l=t(c,s[1]);void 0!==l&&(this.removeByKey(e,c),o.push(l))}}catch(e){u.e(e)}finally{u.f()}o.forEach((function(e){n.setRange(e)}))}}])&&c(t.prototype,r),u&&c(t,u),e}();function f(e,t){return"".concat(e.col,",").concat(e.row,",").concat(t.col,",").concat(t.row)}function p(e){return f(e.start,e.end)}t.RangeMapping=l;var h=function(e,t,r){var n=r(e.range.start),o=r(e.range.start);return n===o?r(e.range.end)-r(t.range.end):n-o}},function(e,t,r){"use strict";var n=r(2),o=r(47),a=r(17),i=r(7),u=r(128),s=[],c=s.sort,l=i((function(){s.sort(void 0)})),f=i((function(){s.sort(null)})),p=u("sort");n({target:"Array",proto:!0,forced:l||!f||!p},{sort:function(e){return void 0===e?c.call(a(this)):c.call(a(this),o(e))}})},function(e,t,r){"use strict";r(53),r(67),r(87),r(93),r(94),t.__esModule=!0,t.SheetMapping=void 0,r(120),r(95),r(210),r(63),r(77),r(97),r(125),r(121),r(68);var n=r(244),o=r(231);function a(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return u=e.done,e},e:function(e){s=!0,a=e},f:function(){try{u||null==r.return||r.return()}finally{if(s)throw a}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t,r){return t&&s(e.prototype,t),r&&s(e,r),e}function l(e){return e.toLowerCase()}var f=function(){function e(t,r){u(this,e),this.id=t,this.displayName=r}return c(e,[{key:"canonicalName",get:function(){return l(this.displayName)}}]),e}(),p=function(){function e(t){var r=this;u(this,e),this.languages=t,this.mappingFromCanonicalName=new Map,this.mappingFromId=new Map,this.lastSheetId=-1,this.fetch=function(e){var t=r.mappingFromCanonicalName.get(l(e));if(void 0===t)throw new o.NoSheetWithNameError(e);return t.id},this.get=function(e){var t=r.mappingFromCanonicalName.get(l(e));return t?t.id:void 0},this.fetchDisplayName=function(e){return r.fetchSheetById(e).displayName},this.sheetNamePrefix=t.getUITranslation(n.UIElement.NEW_SHEET_PREFIX)}return c(e,[{key:"addSheet",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"".concat(this.sheetNamePrefix).concat(this.lastSheetId+2),t=l(e);if(this.mappingFromCanonicalName.has(t))throw new o.SheetNameAlreadyTakenError(e);this.lastSheetId++;var r=new f(this.lastSheetId,e);return this.store(r),r.id}},{key:"removeSheet",value:function(e){var t=this.fetchSheetById(e);e==this.lastSheetId&&--this.lastSheetId,this.mappingFromCanonicalName.delete(t.canonicalName),this.mappingFromId.delete(t.id)}},{key:"getDisplayName",value:function(e){var t=this.mappingFromId.get(e);return t?t.displayName:void 0}},{key:"getDisplayNameByName",value:function(e){var t=this.mappingFromCanonicalName.get(l(e));return t?t.displayName:void 0}},{key:"displayNames",value:regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=a(this.mappingFromCanonicalName.values()),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=9;break}return n=r.value,e.next=7,n.displayName;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:"numberOfSheets",value:function(){return this.mappingFromCanonicalName.size}},{key:"hasSheetWithId",value:function(e){return this.mappingFromId.has(e)}},{key:"hasSheetWithName",value:function(e){return this.mappingFromCanonicalName.has(l(e))}},{key:"renameSheet",value:function(e,t){var r=this.fetchSheetById(e),n=r.displayName;if(n!==t){var a=this.mappingFromCanonicalName.get(l(t));if(a&&a.id!==r.id)throw new o.SheetNameAlreadyTakenError(t);var i=r.canonicalName;return this.mappingFromCanonicalName.delete(i),r.displayName=t,this.store(r),n}}},{key:"destroy",value:function(){this.mappingFromCanonicalName.clear(),this.mappingFromId.clear()}},{key:"sheetNames",value:function(){return Array.from(this.mappingFromId.values()).map((function(e){return e.displayName}))}},{key:"store",value:function(e){this.mappingFromId.set(e.id,e),this.mappingFromCanonicalName.set(e.canonicalName,e)}},{key:"fetchSheetById",value:function(e){var t=this.mappingFromId.get(e);if(void 0===t)throw new o.NoSheetWithIdError(e);return t}}]),e}();t.SheetMapping=p},function(e,t,r){"use strict";t.__esModule=!0,t.UIElement=void 0;var n,o=r(245);t.buildTranslationPackage=o.buildTranslationPackage,t.TranslationPackage=o.TranslationPackage,t.UIElement=n,function(e){e.NEW_SHEET_PREFIX="NEW_SHEET_PREFIX"}(n||(t.UIElement=n={}))},function(e,t,r){"use strict";r(53),r(67),r(68),r(87),r(93),r(94),t.__esModule=!0,t.buildTranslationPackage=function(e){return new c(Object.assign({},e.functions),Object.assign({},e.errors),Object.assign({},e.ui))},t.TranslationPackage=void 0,r(116),r(149),r(246),r(247),r(95),r(63),r(122),r(77),r(97),r(110);var n=r(115),o=r(231),a=r(244);function i(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.functions=t,this.errors=r,this.ui=n,this._protectedTranslations={VERSION:"VERSION"},this.checkUI(),this.checkErrors(),this.checkFunctionTranslations(this.functions),Object.assign(this.functions,this._protectedTranslations)}var t,r,u;return t=e,(r=[{key:"extendFunctions",value:function(e){this.checkFunctionTranslations(e),Object.assign(this.functions,e)}},{key:"buildFunctionMapping",value:function(){var e=this;return Object.keys(this.functions).reduce((function(t,r){return t[e.functions[r]]=r,t}),{})}},{key:"buildErrorMapping",value:function(){var e=this;return Object.keys(this.errors).reduce((function(t,r){return t[e.errors[r]]=r,t}),{})}},{key:"isFunctionTranslated",value:function(e){return void 0!==this.functions[e]}},{key:"getFunctionTranslations",value:function(e){var t,r=[],n=i(e);try{for(n.s();!(t=n.n()).done;){var o=t.value;this.isFunctionTranslated(o)&&r.push(this.functions[o])}}catch(e){n.e(e)}finally{n.f()}return r}},{key:"getFunctionTranslation",value:function(e){var t=this.functions[e];if(void 0===t)throw new o.MissingTranslationError("functions.".concat(e));return t}},{key:"getMaybeFunctionTranslation",value:function(e){return this.functions[e]}},{key:"getErrorTranslation",value:function(e){if(e===n.ErrorType.LIC)return"#".concat(n.ErrorType.LIC,"!");var t=this.errors[e];if(void 0===t)throw new o.MissingTranslationError("errors.".concat(e));return t}},{key:"getUITranslation",value:function(e){var t=this.ui[e];if(void 0===t)throw new o.MissingTranslationError("ui.".concat(e));return t}},{key:"checkUI",value:function(){for(var e=0,t=Object.values(a.UIElement);e<t.length;e++){var r=t[e];if(!(r in this.ui))throw new o.MissingTranslationError("ui.".concat(r))}}},{key:"checkErrors",value:function(){for(var e=0,t=Object.values(n.ErrorType);e<t.length;e++){var r=t[e];if(!(r in this.errors)&&r!==n.ErrorType.LIC)throw new o.MissingTranslationError("errors.".concat(r))}}},{key:"checkFunctionTranslations",value:function(e){var t,r=new Set(Object.getOwnPropertyNames(e)),n=i(Object.getOwnPropertyNames(this._protectedTranslations));try{for(n.s();!(t=n.n()).done;){var a=t.value;if(r.has(a))throw new o.ProtectedFunctionTranslationError(a)}}catch(e){n.e(e)}finally{n.f()}}}])&&s(t.prototype,r),u&&s(t,u),e}();t.TranslationPackage=c},function(e,t,r){var n=r(2),o=r(17),a=r(50);n({target:"Object",stat:!0,forced:r(7)((function(){a(1)}))},{keys:function(e){return a(o(e))}})},function(e,t,r){var n=r(2),o=r(248).values;n({target:"Object",stat:!0},{values:function(e){return o(e)}})},function(e,t,r){var n=r(6),o=r(50),a=r(10),i=r(8).f,u=function(e){return function(t){for(var r,u=a(t),s=o(u),c=s.length,l=0,f=[];c>l;)r=s[l++],n&&!i.call(u,r)||f.push(e?[r,u[r]]:u[r]);return f}};e.exports={entries:u(!0),values:u(!1)}},function(e,t,r){"use strict";t.__esModule=!0,t.EmptyCellVertex=void 0;var n=r(223);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.address=t}var t,r,a;return t=e,(r=[{key:"getCellValue",value:function(){return n.EmptyValue}}])&&o(t.prototype,r),a&&o(t,a),e}();t.EmptyCellVertex=a},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}t.__esModule=!0,t.ValueCellVertex=void 0;
/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */
var o=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parsedValue=t,this.rawValue=r}var t,r,o;return t=e,(r=[{key:"getValues",value:function(){return{parsedValue:this.parsedValue,rawValue:this.rawValue}}},{key:"setValues",value:function(e){this.parsedValue=e.parsedValue,this.rawValue=e.rawValue}},{key:"getCellValue",value:function(){return this.parsedValue}},{key:"setCellValue",value:function(e){throw"SetCellValue is deprecated for ValueCellVertex"}}])&&n(t.prototype,r),o&&n(t,o),e}();t.ValueCellVertex=o},function(e,t,r){"use strict";t.__esModule=!0,t.ParsingErrorVertex=void 0;var n=r(115);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.errors=t,this.rawInput=r}var t,r,a;return t=e,(r=[{key:"getCellValue",value:function(){return n.CellError.parsingError()}},{key:"getFormula",value:function(){return this.rawInput}}])&&o(t.prototype,r),a&&o(t,a),e}();t.ParsingErrorVertex=a},function(e,t,r){"use strict";r(53),r(67),r(68),r(87),r(93),r(94),t.__esModule=!0,t.SparseStrategy=void 0,r(120),r(95),r(210),r(63),r(77),r(97),r(126);var n=r(115);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||i(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=i(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return u=e.done,e},e:function(e){s=!0,a=e},f:function(){try{u||null==r.return||r.return()}finally{if(s)throw a}}}}function i(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.width=t,this.height=r,this.mapping=new Map}var t,r,i;return t=e,(r=[{key:"getCell",value:function(e){var t=this.mapping.get(e.col);return t&&t.get(e.row)||null}},{key:"setCell",value:function(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);var r=this.mapping.get(e.col);r||(r=new Map,this.mapping.set(e.col,r)),r.set(e.row,t)}},{key:"has",value:function(e){var t=this.mapping.get(e.col);return!!t&&!!t.get(e.row)}},{key:"getHeight",value:function(){return this.height}},{key:"getWidth",value:function(){return this.width}},{key:"removeCell",value:function(e){var t=this.mapping.get(e.col);t&&t.delete(e.row)}},{key:"addRows",value:function(e,t){this.mapping.forEach((function(r){var n=new Map;r.forEach((function(o,a){a>=e&&(n.set(a+t,o),r.delete(a))})),n.forEach((function(e,t){r.set(t,e)}))})),this.height+=t}},{key:"addColumns",value:function(e,t){var r=this,n=new Map;this.mapping.forEach((function(o,a){a>=e&&(n.set(a+t,o),r.mapping.delete(a))})),n.forEach((function(e,t){r.mapping.set(t,e)})),this.width+=t}},{key:"removeRows",value:function(e){this.mapping.forEach((function(t){var r=new Map;t.forEach((function(n,o){o>=e.rowStart&&(t.delete(o),o>e.rowEnd&&r.set(o-e.numberOfRows,n))})),r.forEach((function(e,r){t.set(r,e)}))}));var t=Math.min(this.height-1,e.rowEnd),r=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-r)}},{key:"removeColumns",value:function(e){var t=this,r=new Map;this.mapping.forEach((function(n,o){o>=e.columnStart&&(t.mapping.delete(o),o>e.columnEnd&&r.set(o-e.numberOfColumns,n))})),r.forEach((function(e,r){t.mapping.set(r,e)}));var n=Math.min(this.width-1,e.columnEnd),o=Math.max(0,n-e.columnStart+1);this.width=Math.max(0,this.width-o)}},{key:"getEntries",value:regeneratorRuntime.mark((function e(t){var r,i,u,s,c,l,f,p,h,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=a(this.mapping),e.prev=1,r.s();case 3:if((i=r.n()).done){e.next=24;break}u=o(i.value,2),s=u[0],c=u[1],l=a(c),e.prev=6,l.s();case 8:if((f=l.n()).done){e.next=14;break}return p=o(f.value,2),h=p[0],d=p[1],e.next=12,[(0,n.simpleCellAddress)(t,s,h),d];case 12:e.next=8;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(6),l.e(e.t0);case 19:return e.prev=19,l.f(),e.finish(19);case 22:e.next=3;break;case 24:e.next=29;break;case 26:e.prev=26,e.t1=e.catch(1),r.e(e.t1);case 29:return e.prev=29,r.f(),e.finish(29);case 32:case"end":return e.stop()}}),e,this,[[1,26,29,32],[6,16,19,22]])}))},{key:"verticesFromColumn",value:regeneratorRuntime.mark((function e(t){var r,n,i,u,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.mapping.get(t)){e.next=3;break}return e.abrupt("return");case 3:n=a(r),e.prev=4,n.s();case 6:if((i=n.n()).done){e.next=12;break}return(u=o(i.value,2))[0],s=u[1],e.next=10,s;case 10:e.next=6;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),n.e(e.t0);case 17:return e.prev=17,n.f(),e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[4,14,17,20]])}))},{key:"verticesFromRow",value:regeneratorRuntime.mark((function e(t){var r,n,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=a(this.mapping.values()),e.prev=1,r.s();case 3:if((n=r.n()).done){e.next=11;break}if(o=n.value,!(i=o.get(t))){e.next=9;break}return e.next=9,i;case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),r.e(e.t0);case 16:return e.prev=16,r.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[1,13,16,19]])}))},{key:"verticesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){var r,n,i,u,s,c,l,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=a(t.columns()),e.prev=1,r.s();case 3:if((n=r.n()).done){e.next=27;break}if(i=n.value,u=this.mapping.get(i)){e.next=8;break}return e.abrupt("continue",25);case 8:s=a(u),e.prev=9,s.s();case 11:if((c=s.n()).done){e.next=17;break}return(l=o(c.value,2))[0],f=l[1],e.next=15,f;case 15:e.next=11;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(9),s.e(e.t0);case 22:return e.prev=22,s.f(),e.finish(22);case 25:e.next=3;break;case 27:e.next=32;break;case 29:e.prev=29,e.t1=e.catch(1),r.e(e.t1);case 32:return e.prev=32,r.f(),e.finish(32);case 35:case"end":return e.stop()}}),e,this,[[1,29,32,35],[9,19,22,25]])}))},{key:"verticesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){var r,n,o,i,u,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=a(this.mapping.values()),e.prev=1,r.s();case 3:if((n=r.n()).done){e.next=26;break}o=n.value,i=a(t.rows()),e.prev=6,i.s();case 8:if((u=i.n()).done){e.next=16;break}if(s=u.value,!(c=o.get(s))){e.next=14;break}return e.next=14,c;case 14:e.next=8;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),i.e(e.t0);case 21:return e.prev=21,i.f(),e.finish(21);case 24:e.next=3;break;case 26:e.next=31;break;case 28:e.prev=28,e.t1=e.catch(1),r.e(e.t1);case 31:return e.prev=31,r.f(),e.finish(31);case 34:case"end":return e.stop()}}),e,this,[[1,28,31,34],[6,18,21,24]])}))},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){var r,i,u,s,c,l,f,p,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=a(this.mapping.entries()),e.prev=1,r.s();case 3:if((i=r.n()).done){e.next=26;break}u=o(i.value,2),s=u[0],c=u[1],l=a(t.rows()),e.prev=6,l.s();case 8:if((f=l.n()).done){e.next=16;break}if(p=f.value,!(h=c.get(p))){e.next=14;break}return e.next=14,[(0,n.simpleCellAddress)(t.sheet,s,p),h];case 14:e.next=8;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),l.e(e.t0);case 21:return e.prev=21,l.f(),e.finish(21);case 24:e.next=3;break;case 26:e.next=31;break;case 28:e.prev=28,e.t1=e.catch(1),r.e(e.t1);case 31:return e.prev=31,r.f(),e.finish(31);case 34:case"end":return e.stop()}}),e,this,[[1,28,31,34],[6,18,21,24]])}))},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){var r,i,u,s,c,l,f,p,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=a(t.columns()),e.prev=1,r.s();case 3:if((i=r.n()).done){e.next=26;break}if(u=i.value,!(s=this.mapping.get(u))){e.next=24;break}c=a(s.entries()),e.prev=8,c.s();case 10:if((l=c.n()).done){e.next=16;break}return f=o(l.value,2),p=f[0],h=f[1],e.next=14,[(0,n.simpleCellAddress)(t.sheet,u,p),h];case 14:e.next=10;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(8),c.e(e.t0);case 21:return e.prev=21,c.f(),e.finish(21);case 24:e.next=3;break;case 26:e.next=31;break;case 28:e.prev=28,e.t1=e.catch(1),r.e(e.t1);case 31:return e.prev=31,r.f(),e.finish(31);case 34:case"end":return e.stop()}}),e,this,[[1,28,31,34],[8,18,21,24]])}))},{key:"vertices",value:regeneratorRuntime.mark((function e(){var t,r,n,i,u,s,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=a(this.mapping),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=25;break}(n=o(r.value,2))[0],i=n[1],u=a(i),e.prev=6,u.s();case 8:if((s=u.n()).done){e.next=15;break}if((c=o(s.value,2))[0],!(l=c[1])){e.next=13;break}return e.next=13,l;case 13:e.next=8;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(6),u.e(e.t0);case 20:return e.prev=20,u.f(),e.finish(20);case 23:e.next=3;break;case 25:e.next=30;break;case 27:e.prev=27,e.t1=e.catch(1),t.e(e.t1);case 30:return e.prev=30,t.f(),e.finish(30);case 33:case"end":return e.stop()}}),e,this,[[1,27,30,33],[6,17,20,23]])}))}])&&s(t.prototype,r),i&&s(t,i),e}();t.SparseStrategy=c},function(e,t,r){"use strict";r(87),r(93),r(63),r(94),r(95),r(77),r(97),r(68),r(53),r(67),t.__esModule=!0,t.DenseStrategy=void 0,r(120),r(236),r(125);var n=r(115);function o(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var u=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.width=t,this.height=r,this.mapping=new Array(r);for(var n=0;n<r;n++)this.mapping[n]=new Array(t)}var t,r,a;return t=e,(r=[{key:"getCell",value:function(e){return this.getCellVertex(e.col,e.row)}},{key:"setCell",value:function(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1),this.mapping[e.row]||(this.mapping[e.row]=new Array(this.width)),this.mapping[e.row][e.col]=t}},{key:"has",value:function(e){var t=this.mapping[e.row];return!!t&&!!t[e.col]}},{key:"getHeight",value:function(){return this.height}},{key:"getWidth",value:function(){return this.width}},{key:"removeCell",value:function(e){void 0!==this.mapping[e.row]&&delete this.mapping[e.row][e.col]}},{key:"addRows",value:function(e,t){for(var r,n=[],o=0;o<t;o++)n.push(new Array(this.width));(r=this.mapping).splice.apply(r,[e,0].concat(n)),this.height+=t}},{key:"addColumns",value:function(e,t){for(var r=0;r<this.height;r++){var n;(n=this.mapping[r]).splice.apply(n,[e,0].concat(o(new Array(t))))}this.width+=t}},{key:"removeRows",value:function(e){this.mapping.splice(e.rowStart,e.numberOfRows);var t=Math.min(this.height-1,e.rowEnd),r=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-r)}},{key:"removeColumns",value:function(e){for(var t=0;t<this.height;t++)this.mapping[t].splice(e.columnStart,e.numberOfColumns);var r=Math.min(this.width-1,e.columnEnd),n=Math.max(0,r-e.columnStart+1);this.width=Math.max(0,this.width-n)}},{key:"getEntries",value:regeneratorRuntime.mark((function e(t){var r,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0;case 1:if(!(r<this.height)){e.next=14;break}o=0;case 3:if(!(o<this.width)){e.next=11;break}if(!(a=this.getCellVertex(o,r))){e.next=8;break}return e.next=8,[(0,n.simpleCellAddress)(t,o,r),a];case 8:++o,e.next=3;break;case 11:++r,e.next=1;break;case 14:case"end":return e.stop()}}),e,this)}))},{key:"verticesFromColumn",value:regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0;case 1:if(!(r<this.height)){e.next=9;break}if(!(n=this.getCellVertex(t,r))){e.next=6;break}return e.next=6,n;case 6:++r,e.next=1;break;case 9:case"end":return e.stop()}}),e,this)}))},{key:"verticesFromRow",value:regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0;case 1:if(!(r<this.width)){e.next=9;break}if(!(n=this.getCellVertex(r,t))){e.next=6;break}return e.next=6,n;case 6:++r,e.next=1;break;case 9:case"end":return e.stop()}}),e,this)}))},{key:"verticesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){var r,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.columnStart;case 1:if(!(r<=t.columnEnd)){e.next=14;break}n=0;case 3:if(!(n<this.height)){e.next=11;break}if(!(o=this.getCellVertex(r,n))){e.next=8;break}return e.next=8,o;case 8:++n,e.next=3;break;case 11:++r,e.next=1;break;case 14:case"end":return e.stop()}}),e,this)}))},{key:"verticesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){var r,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0;case 1:if(!(r<this.width)){e.next=14;break}n=t.rowStart;case 3:if(!(n<=t.rowEnd)){e.next=11;break}if(!(o=this.getCellVertex(r,n))){e.next=8;break}return e.next=8,o;case 8:++n,e.next=3;break;case 11:++r,e.next=1;break;case 14:case"end":return e.stop()}}),e,this)}))},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){var r,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0;case 1:if(!(r<this.width)){e.next=14;break}o=t.rowStart;case 3:if(!(o<=t.rowEnd)){e.next=11;break}if(!(a=this.getCellVertex(r,o))){e.next=8;break}return e.next=8,[(0,n.simpleCellAddress)(t.sheet,r,o),a];case 8:++o,e.next=3;break;case 11:++r,e.next=1;break;case 14:case"end":return e.stop()}}),e,this)}))},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){var r,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0;case 1:if(!(r<this.height)){e.next=14;break}o=t.columnStart;case 3:if(!(o<=t.columnEnd)){e.next=11;break}if(!(a=this.getCellVertex(o,r))){e.next=8;break}return e.next=8,[(0,n.simpleCellAddress)(t.sheet,o,r),a];case 8:++o,e.next=3;break;case 11:++r,e.next=1;break;case 14:case"end":return e.stop()}}),e,this)}))},{key:"vertices",value:regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:if(!(t<this.height)){e.next=14;break}r=0;case 3:if(!(r<this.width)){e.next=11;break}if(!(n=this.getCellVertex(r,t))){e.next=8;break}return e.next=8,n;case 8:++r,e.next=3;break;case 11:++t,e.next=1;break;case 14:case"end":return e.stop()}}),e,this)}))},{key:"getCellVertex",value:function(e,t){return this.mapping[t]&&this.mapping[t][e]||null}}])&&i(t.prototype,r),a&&i(t,a),e}();t.DenseStrategy=u},function(e,t,r){"use strict";t.__esModule=!0,t.DetailedCellError=void 0,t.DetailedCellError=function e(t,r,n){var o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}
/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */(this,e),this.value=r,this.address=n,this.type=t.type,this.message=null!==(o=t.message)&&void 0!==o?o:""}},function(e,t,r){"use strict";r(87),r(93),r(94),r(53),r(68),t.__esModule=!0,t.Config=void 0,r(126),r(116),r(125),r(256),r(257),r(206),r(121),r(95),r(210),r(63),r(77),r(97),r(67),r(242),r(99);var n=r(258),o=r(262),a=r(263),i=r(231),u=r(264),s=r(269),c=r(311);function l(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}
/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */
var m,y=function(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r},g=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},v=["gpu","cpu","dev"],E=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.accentSensitive,n=t.caseSensitive,a=t.caseFirst,u=t.chooseAddressMappingPolicy,l=t.dateFormats,f=t.timeFormats,p=t.functionArgSeparator,d=t.decimalSeparator,g=t.thousandSeparator,E=t.language,T=t.licenseKey,b=t.functionPlugins,R=t.gpujs,A=t.gpuMode,S=t.ignorePunctuation,N=t.leapYear1900,O=t.localeLang,C=t.smartRounding,w=t.matrixDetection,M=t.matrixDetectionThreshold,I=t.evaluateNullToZero,x=t.nullYear,k=t.parseDateTime,_=t.stringifyDateTime,P=t.stringifyDuration,L=t.precisionEpsilon,F=t.precisionRounding,U=t.useColumnIndex,V=t.binarySearchThreshold,D=t.nullDate,j=t.useStats,B=t.undoLimit,G=t.useRegularExpressions,W=t.useWildcards,H=t.matchWholeCell,z=t.maxRows,Y=t.maxColumns,X=t.currencySymbol;h(this,e),m.set(this,void 0),this.accentSensitive=this.valueFromParam(r,"boolean","accentSensitive"),this.caseSensitive=this.valueFromParam(n,"boolean","caseSensitive"),this.caseFirst=this.valueFromParam(a,["upper","lower","false"],"caseFirst"),this.ignorePunctuation=this.valueFromParam(S,"boolean","ignorePunctuation"),this.chooseAddressMappingPolicy=null!=u?u:e.defaultConfig.chooseAddressMappingPolicy,this.dateFormats=this.valueFromParamCheck(l,Array.isArray,"array","dateFormats"),this.timeFormats=this.valueFromParamCheck(f,Array.isArray,"array","timeFormats"),this.functionArgSeparator=this.valueFromParam(p,"string","functionArgSeparator"),this.decimalSeparator=this.valueFromParam(d,[".",","],"decimalSeparator"),this.language=this.valueFromParam(E,"string","language"),this.licenseKey=this.valueFromParam(T,"string","licenseKey"),y(this,m,(0,c.checkLicenseKeyValidity)(this.licenseKey)),this.thousandSeparator=this.valueFromParam(g,["",","," ","."],"thousandSeparator"),this.localeLang=this.valueFromParam(O,"string","localeLang"),this.functionPlugins=null!=b?b:e.defaultConfig.functionPlugins,this.gpujs=null!=R?R:e.defaultConfig.gpujs,this.gpuMode=this.valueFromParam(A,v,"gpuMode"),this.smartRounding=this.valueFromParam(C,"boolean","smartRounding"),this.matrixDetection=this.valueFromParam(w,"boolean","matrixDetection"),this.matrixDetectionThreshold=this.valueFromParam(M,"number","matrixDetectionThreshold"),this.validateNumberToBeAtLeast(this.matrixDetectionThreshold,"matrixDetectionThreshold",1),this.evaluateNullToZero=this.valueFromParam(I,"boolean","evaluateNullToZero"),this.nullYear=this.valueFromParam(x,"number","nullYear"),this.validateNumberToBeAtLeast(this.nullYear,"nullYear",0),this.validateNumberToBeAtMost(this.nullYear,"nullYear",100),this.precisionRounding=this.valueFromParam(F,"number","precisionRounding"),this.validateNumberToBeAtLeast(this.precisionRounding,"precisionRounding",0),this.precisionEpsilon=this.valueFromParam(L,"number","precisionEpsilon"),this.validateNumberToBeAtLeast(this.precisionEpsilon,"precisionEpsilon",0),this.useColumnIndex=this.valueFromParam(U,"boolean","useColumnIndex"),this.useStats=this.valueFromParam(j,"boolean","useStats"),this.binarySearchThreshold=this.valueFromParam(V,"number","binarySearchThreshold"),this.validateNumberToBeAtLeast(this.binarySearchThreshold,"binarySearchThreshold",1),this.parseDateTime=this.valueFromParam(k,"function","parseDateTime"),this.stringifyDateTime=this.valueFromParam(_,"function","stringifyDateTime"),this.stringifyDuration=this.valueFromParam(P,"function","stringifyDuration"),this.translationPackage=s.HyperFormula.getLanguage(this.language),this.errorMapping=this.translationPackage.buildErrorMapping(),this.nullDate=this.valueFromParamCheck(D,o.instanceOfSimpleDate,"IDate","nullDate"),this.leapYear1900=this.valueFromParam(N,"boolean","leapYear1900"),this.undoLimit=this.valueFromParam(B,"number","undoLimit"),this.useRegularExpressions=this.valueFromParam(G,"boolean","useRegularExpressions"),this.useWildcards=this.valueFromParam(W,"boolean","useWildcards"),this.matchWholeCell=this.valueFromParam(H,"boolean","matchWholeCell"),this.validateNumberToBeAtLeast(this.undoLimit,"undoLimit",0),this.maxRows=this.valueFromParam(z,"number","maxRows"),this.validateNumberToBeAtLeast(this.maxRows,"maxRows",1),this.maxColumns=this.valueFromParam(Y,"number","maxColumns"),this.currencySymbol=this.valueFromParamCheck(X,Array.isArray,"array","currencySymbol"),this.currencySymbol.forEach((function(e){if("string"!=typeof e)throw new i.ExpectedValueOfTypeError("string[]","currencySymbol");if(""===e)throw new i.ConfigValueEmpty("currencySymbol")})),this.validateNumberToBeAtLeast(this.maxColumns,"maxColumns",1),this.checkIfParametersNotInConflict({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"})}var t,r,n;return t=e,(r=[{key:"licenseKeyValidityState",get:function(){return g(this,m)}},{key:"getConfig",value:function(){return this}},{key:"mergeConfig",value:function(t){return new e(Object.assign({},this.getConfig(),t))}},{key:"warnDeprecatedIfUsed",value:function(e,t,r,n){void 0!==e&&console.warn("".concat(t," option is deprecated since ").concat(r,", please use ").concat(n))}},{key:"valueFromParam",value:function(t,r,n){if(void 0===t)return e.defaultConfig[n];if("string"==typeof r){if(p(t)===r)return t;throw new i.ExpectedValueOfTypeError(r,n)}if(r.includes(t))return t;throw new i.ExpectedOneOfValuesError(r.map((function(e){return"'"+e+"'"})).join(" "),n)}},{key:"valueFromParamCheck",value:function(t,r,n,o){if(r(t))return t;if(void 0===t)return e.defaultConfig[o];throw new i.ExpectedValueOfTypeError(n,o)}},{key:"checkIfParametersNotInConflict",value:function(){for(var e=new Map,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];r.forEach((function(t){var r=e.get(t.value)||[];r.push(t.name),e.set(t.value,r)}));var o,a=[],i=l(e.values());try{for(i.s();!(o=i.n()).done;){var u=o.value;u.length>1&&a.push(u)}}catch(e){i.e(e)}finally{i.f()}if(a.length>0){a.forEach((function(e){return e.sort()}));var s=a.map((function(e){return"[".concat(e,"]")})).join("; ");throw new Error("Config initialization failed. Parameters in conflict: ".concat(s))}}},{key:"validateNumberToBeAtLeast",value:function(e,t,r){if(e<r)throw new i.ConfigValueTooSmallError(t,r)}},{key:"validateNumberToBeAtMost",value:function(e,t,r){if(e>r)throw new i.ConfigValueTooBigError(t,r)}}])&&d(t.prototype,r),n&&d(t,n),e}();t.Config=E,m=new WeakMap,E.defaultConfig={accentSensitive:!1,caseSensitive:!1,caseFirst:"lower",ignorePunctuation:!1,chooseAddressMappingPolicy:new a.AlwaysDense,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],functionArgSeparator:",",decimalSeparator:".",thousandSeparator:"",language:"enGB",licenseKey:"",functionPlugins:[],gpujs:void 0,gpuMode:"gpu",leapYear1900:!1,smartRounding:!0,localeLang:"en",matrixDetection:!0,matrixDetectionThreshold:100,evaluateNullToZero:!1,nullYear:30,parseDateTime:n.defaultParseToDateTime,stringifyDateTime:u.defaultStringifyDateTime,stringifyDuration:u.defaultStringifyDuration,precisionEpsilon:1e-13,precisionRounding:14,useColumnIndex:!1,useStats:!1,binarySearchThreshold:20,nullDate:{year:1899,month:12,day:30},undoLimit:20,useRegularExpressions:!1,useWildcards:!0,matchWholeCell:!0,maxRows:4e4,maxColumns:18278,currencySymbol:["$"]}},function(e,t,r){"use strict";var n=r(2),o=r(40).includes,a=r(96);n({target:"Array",proto:!0},{includes:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),a("includes")},function(e,t,r){"use strict";var n=r(2),o=r(112),a=r(13);n({target:"String",proto:!0,forced:!r(114)("includes")},{includes:function(e){return!!~String(a(this)).indexOf(o(e),arguments.length>1?arguments[1]:void 0)}})},function(e,t,r){"use strict";t.__esModule=!0,t.defaultParseToDateTime=
/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */
function(e,t,r){var n=(e=e.replace(/\s\s+/g," ").trim().toLowerCase()).substring(e.length-2);"am"===n||"pm"===n?e=e.substring(0,e.length-2).trim():"a"===(n=e.substring(e.length-1))||"p"===n?e=e.substring(0,e.length-1).trim():n=void 0;var i=e.split(/[ /.-]/g);i.length>=2&&i[i.length-2].includes(":")&&(i[i.length-2]=i[i.length-2]+"."+i[i.length-1],i.pop());var u=i[i.length-1].split(":");if(void 0!==n&&u.push(n),1===i.length)return o(u,r);if(1===u.length)return a(i,t);var s=a(i.slice(0,i.length-1),t),c=o(u,r);return void 0===s||void 0===c?void 0:Object.assign(Object.assign({},s),c)},t.secondsExtendedRegexp=void 0,r(259),r(146),r(156),r(151),r(256),r(257),r(53),r(116),r(261),r(138);var n=/^ss\.(s+|0+)$/;function o(e,t){if(void 0!==t){(t=t.toLowerCase()).endsWith("am/pm")?t=t.substring(0,t.length-5).trim():t.endsWith("a/p")&&(t=t.substring(0,t.length-3).trim());var r=t.split(":"),o=void 0;"am"===e[e.length-1]||"a"===e[e.length-1]?(o=!1,e.pop()):"pm"!==e[e.length-1]&&"p"!==e[e.length-1]||(o=!0,e.pop());var a=0;if(r.length>=1&&n.test(r[r.length-1])&&(a=r[r.length-1].length-3,r[r.length-1]="ss"),e.length===r.length){var i=r.indexOf("hh"),u=r.indexOf("mm"),s=r.indexOf("ss"),c=-1!==i?e[i]:"0";if(/^\d+$/.test(c)){var l=Number(c);if(void 0!==o){if(l<0||l>12)return;l%=12,o&&(l+=12)}var f=-1!==u?e[u]:"0";if(/^\d+$/.test(f)){var p=Number(f),h=-1!==s?e[s]:"0";if(/^\d+(\.\d+)?$/.test(h)){var d=Number(h);return{hours:l,minutes:p,seconds:d=Math.round(d*Math.pow(10,a))/Math.pow(10,a)}}}}}}}function a(e,t){if(void 0!==t){var r=t.toLowerCase().split(/[ /.-]/g);if(e.length===r.length){var n=r.indexOf("mm"),o=r.indexOf("dd"),a=r.indexOf("yyyy"),i=r.indexOf("yy");if(n in e&&o in e&&(a in e||i in e)&&(!(a in e)||!(i in e))){var u;if(a in e){var s=e[a];if(!/^\d+$/.test(s))return;if((u=Number(s))<1e3||u>9999)return}else{var c=e[i];if(!/^\d+$/.test(c))return;if((u=Number(c))<0||u>99)return}var l=e[n];if(/^\d+$/.test(l)){var f=Number(l),p=e[o];if(/^\d+$/.test(p))return{year:u,month:f,day:Number(p)}}}}}}t.secondsExtendedRegexp=n},function(e,t,r){"use strict";var n=r(2),o=r(139).trim;n({target:"String",proto:!0,forced:r(260)("trim")},{trim:function(){return o(this)}})},function(e,t,r){var n=r(7),o=r(140);e.exports=function(e){return n((function(){return!!o[e]()||"​᠎"!="​᠎"[e]()||o[e].name!==e}))}},function(e,t,r){"use strict";var n,o=r(2),a=r(5).f,i=r(41),u=r(112),s=r(13),c=r(114),l=r(31),f="".endsWith,p=Math.min,h=c("endsWith");o({target:"String",proto:!0,forced:!(!l&&!h&&(n=a(String.prototype,"endsWith"),n&&!n.writable)||h)},{endsWith:function(e){var t=String(s(this));u(e);var r=arguments.length>1?arguments[1]:void 0,n=i(t.length),o=void 0===r?n:p(i(r),n),a=String(e);return f?f.call(t,a,o):t.slice(o-a.length,o)===a}})},function(e,t,r){"use strict";r(53),r(67),r(68),t.__esModule=!0,t.instanceOfSimpleDate=l,t.instanceOfSimpleTime=f,t.offsetMonth=function(e,t){var r=12*e.year+e.month-1+t;return{year:Math.floor(r/12),month:r%12+1,day:e.day}},t.truncateDayInMonth=function(e){return{year:e.year,month:e.month,day:Math.min(e.day,s[e.month-1])}},t.roundToNearestSecond=function(e){return Math.round(3600*e*24)/86400},t.numberToSimpleTime=d,t.timeToNumber=m,t.toBasisEU=function(e){return{year:e.year,month:e.month,day:Math.min(30,e.day)}},t.DateTimeHelper=t.maxDate=void 0,r(116),r(87),r(93),r(63),r(94),r(95),r(77),r(97);var n=r(223);function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return u=e.done,e},e:function(e){s=!0,i=e},f:function(){try{u||null==r.return||r.return()}finally{if(s)throw i}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s=[31,28,31,30,31,30,31,31,30,31,30,31],c=[0,31,59,90,120,151,181,212,243,273,304,334];function l(e){return!(!e||"object"!==u(e)&&"function"!=typeof e)&&"year"in e&&"number"==typeof e.year&&"month"in e&&"number"==typeof e.month&&"day"in e&&"number"==typeof e.day}function f(e){return!(!e||"object"!==u(e)&&"function"!=typeof e)&&"hours"in e&&"number"==typeof e.hours&&"minutes"in e&&"number"==typeof e.minutes&&"seconds"in e&&"number"==typeof e.seconds}var p={year:9999,month:12,day:31};t.maxDate=p;var h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.minDateAboluteValue=this.dateToNumberFromZero(t.nullDate),this.maxDateValue=this.dateToNumber(p),this.leapYear1900=t.leapYear1900,!this.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})?this.epochYearZero=this.numberToSimpleDate(2).year:this.epochYearZero=this.numberToSimpleDate(1).year,this.parseDateTime=t.parseDateTime}var t,r,a;return t=e,(r=[{key:"getWithinBounds",value:function(e){return e<=this.maxDateValue&&e>=0?e:void 0}},{key:"dateStringToDateNumber",value:function(e){var t=this.parseDateTimeFromConfigFormats(e),r=t.dateTime,o=t.dateFormat,a=void 0===o?"":o,i=t.timeFormat,u=void 0===i?"":i;if(void 0!==r)return f(r)?l(r)?new n.DateTimeNumber(m(r)+this.dateToNumber(r),a+" "+u):new n.TimeNumber(m(r),u):l(r)?new n.DateNumber(this.dateToNumber(r),a):0}},{key:"parseSingleFormat",value:function(e,t,r){var n=this.parseDateTime(e,t,r);if(!l(n)||(n.year>=0&&n.year<100&&(n.year<this.getNullYear()?n.year+=2e3:n.year+=1900),this.isValidDate(n)))return n}},{key:"parseDateTimeFromConfigFormats",value:function(e){return this.parseDateTimeFromFormats(e,this.config.dateFormats,this.config.timeFormats)}},{key:"parseDateTimeFromFormats",value:function(e,t,r){var n,a=0===t.length?[void 0]:t,i=0===r.length?[void 0]:r,u=o(a);try{for(u.s();!(n=u.n()).done;){var s,c=n.value,l=o(i);try{for(l.s();!(s=l.n()).done;){var f=s.value,p=this.parseSingleFormat(e,c,f);if(void 0!==p)return{dateTime:p,timeFormat:f,dateFormat:c}}}catch(e){l.e(e)}finally{l.f()}}}catch(e){u.e(e)}finally{u.f()}return{}}},{key:"getNullYear",value:function(){return this.config.nullYear}},{key:"getEpochYearZero",value:function(){return this.epochYearZero}},{key:"isValidDate",value:function(e){return!(isNaN(e.year)||isNaN(e.month)||isNaN(e.day)||e.day!==Math.round(e.day)||e.month!==Math.round(e.month)||e.year!==Math.round(e.year)||e.year<1582||e.month<1||e.month>12||e.day<1||!(this.isLeapYear(e.year)&&2===e.month?e.day<=29:e.day<=s[e.month-1]))}},{key:"dateToNumber",value:function(e){return this.dateToNumberFromZero(e)-this.minDateAboluteValue}},{key:"relativeNumberToAbsoluteNumber",value:function(e){return e+this.minDateAboluteValue-(this.leapYear1900?1:0)}},{key:"numberToSimpleDate",value:function(e){var t=Math.floor(e)+this.minDateAboluteValue,r=Math.floor(t/365.2425);this.dateToNumberFromZero({year:r+1,month:1,day:1})<=t?r++:this.dateToNumberFromZero({year:r-1,month:1,day:1})>t&&r--;var n=t-this.dateToNumberFromZero({year:r,month:1,day:1}),o=function(e){var t=0;return c[t+6]<=e&&(t+=6),c[t+3]<=e&&(t+=3),c[t+2]<=e?t+=2:c[t+1]<=e&&(t+=1),t}(n-(this.isLeapYear(r)&&n>=59?1:0));return{year:r,month:o+1,day:n-c[o]-(this.isLeapYear(r)&&o>1?1:0)+1}}},{key:"numberToSimpleDateTime",value:function(e){return Object.assign(Object.assign({},this.numberToSimpleDate(Math.floor(e))),d(e%1))}},{key:"leapYearsCount",value:function(e){return Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+(this.config.leapYear1900&&e>=1900?1:0)}},{key:"countLeapDays",value:function(e){return e.month>2||2===e.month&&e.day>=29?this.leapYearsCount(e.year):this.leapYearsCount(e.year-1)}},{key:"dateToNumberFromZero",value:function(e){return 365*e.year+c[e.month-1]+e.day-1+(e.month<=2?this.leapYearsCount(e.year-1):this.leapYearsCount(e.year))}},{key:"isLeapYear",value:function(e){return!(e%4)&&(!!(e%100)||!(e%400)||1900===e&&this.config.leapYear1900)}},{key:"daysInMonth",value:function(e,t){return this.isLeapYear(e)&&2===t?29:s[t-1]}},{key:"endOfMonth",value:function(e){return{year:e.year,month:e.month,day:this.daysInMonth(e.year,e.month)}}},{key:"toBasisUS",value:function(e,t){return 31===e.day&&(e.day=30),30===e.day&&31===t.day&&(t.day=30),2===e.month&&e.day===this.daysInMonth(e.year,e.month)&&(e.day=30,2===t.month&&t.day===this.daysInMonth(t.year,t.month)&&(t.day=30)),[e,t]}},{key:"yearLengthForBasis",value:function(e,t){return e.year!==t.year?e.year+1!==t.year||e.month<t.month||e.month===t.month&&e.day<t.day?(this.leapYearsCount(t.year)-this.leapYearsCount(e.year-1))/(t.year-e.year+1)+365:this.countLeapDays(t)!==this.countLeapDays({year:e.year,month:e.month,day:e.day-1})?366:365:this.isLeapYear(e.year)?366:365}}])&&i(t.prototype,r),a&&i(t,a),e}();function d(e){e=Math.round(24*e*60*60*1e5)/864e7,e*=24;var t=Math.floor(e);e-=t,e*=60;var r=Math.floor(e);return e-=r,e*=60,{hours:t,minutes:r,seconds:Math.round(1e5*e)/1e5}}function m(e){return((e.seconds/60+e.minutes)/60+e.hours)/24}t.DateTimeHelper=h},function(e,t,r){"use strict";t.__esModule=!0,t.AlwaysDense=t.AlwaysSparse=t.DenseSparseChooseBasedOnThreshold=void 0;var n=r(253),o=r(252);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}var s=function(){function e(t){a(this,e),this.threshold=t}return u(e,[{key:"call",value:function(e){return e>this.threshold?n.DenseStrategy:o.SparseStrategy}}]),e}();t.DenseSparseChooseBasedOnThreshold=s;var c=function(){function e(){a(this,e)}return u(e,[{key:"call",value:function(){return o.SparseStrategy}}]),e}();t.AlwaysSparse=c;var l=function(){function e(){a(this,e)}return u(e,[{key:"call",value:function(){return n.DenseStrategy}}]),e}();t.AlwaysDense=l},function(e,t,r){"use strict";r(53),r(67),r(68),r(77),r(87),r(93),r(94),r(95),r(97),t.__esModule=!0,t.format=function(e,t,r,n){var i=r.stringifyDateTime(n.numberToSimpleDateTime(e),t);if(void 0!==i)return i;var u=r.stringifyDuration((0,o.numberToSimpleTime)(e),t);if(void 0!==u)return u;var s=(0,a.parseForNumberFormat)(t);return void 0!==s?function(e,t){for(var r="",n=0;n<e.length;++n){var o=e[n];if(o.type!==a.TokenType.FREE_TEXT){var i=o.value.split("."),u=i[0],s=i[1]||"",p=i[1]?".":"",h=Number(t.toFixed(s.length)).toString().split("."),d=h[0]||"",m=h[1]||"";if(u.length>d.length){var y=f(u.substr(0,u.length-d.length),"0");d=c(d,y+d.length)}var g=f(s.substr(m.length,s.length-m.length),"0");m=l(m,g+m.length),r+=d+p+m}else r+=o.value}return r}(s.tokens,e):t},t.padLeft=c,t.padRight=l,t.defaultStringifyDuration=function(e,t){var r=(0,a.parseForDateTimeFormat)(t);if(void 0!==r){var o,i=r.tokens,s="",l=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=u(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}(i);try{for(l.s();!(o=l.n()).done;){var f=o.value;if(f.type!==a.TokenType.FREE_TEXT)if(n.secondsExtendedRegexp.test(f.value)){var p=f.value.length-3;s+=(e.seconds<10?"0":"")+Math.round(e.seconds*Math.pow(10,p))/Math.pow(10,p)}else switch(f.value.toLowerCase()){case"h":case"hh":s+=c(e.hours,f.value.length),e.hours=0;break;case"[hh]":s+=c(e.hours,f.value.length-2),e.hours=0;break;case"m":case"mm":s+=c(e.minutes,f.value.length),e.minutes=0;break;case"[mm]":s+=c(e.minutes+60*e.hours,f.value.length-2),e.minutes=0,e.hours=0;break;case"s":case"ss":s+=c(e.seconds,f.value.length);break;default:return}else s+=f.value}}catch(e){l.e(e)}finally{l.f()}return s}},t.defaultStringifyDateTime=function(e,t){var r=(0,a.parseForDateTimeFormat)(t);if(void 0!==r){for(var o=r.tokens,u="",s=!1,l=o.some((function(e){return e.type===a.TokenType.FORMAT&&("a/p"===e.value||"A/P"===e.value||"am/pm"===e.value||"AM/PM"===e.value)})),f=0;f<o.length;f++){var p=o[f];if(p.type!==a.TokenType.FREE_TEXT)if(n.secondsExtendedRegexp.test(p.value)){var h=p.value.length-3;u+=(e.seconds<10?"0":"")+Math.round(e.seconds*Math.pow(10,h))/Math.pow(10,h)}else switch(p.value.toLowerCase()){case"h":case"hh":s=!0,u+=c(l?(e.hours+11)%12+1:e.hours,p.value.length);break;case"d":case"dd":u+=c(e.day,p.value.length);break;case"s":case"ss":u+=c(Math.round(e.seconds),p.value.length);break;case"m":case"mm":f+1<o.length&&o[f+1].value.startsWith(":")&&(s=!0),u+=c(s?e.minutes:e.month,p.value.length),s=!0;break;case"yy":u+=c(e.year%100,p.value.length);break;case"yyyy":u+=e.year;break;case"am/pm":case"a/p":var d=i(p.value.split("/"),2),m=d[0],y=d[1];u+=e.hours<12?m:y;break;default:return}else u+=p.value}return u}},r(146),r(151),r(63),r(148),r(138),r(265),r(111);var n=r(258),o=r(262),a=r(268);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t){for(var r=e+"";r.length<t;)r="0"+r;return r}function l(e,t){for(var r=e+"";r.length<t;)r+="0";return r}function f(e,t){return e.split(t).length-1}},function(e,t,r){"use strict";var n=r(2),o=r(42),a=r(266),i=r(267),u=r(7),s=1..toFixed,c=Math.floor,l=function e(t,r,n){return 0===r?n:r%2==1?e(t,r-1,n*t):e(t*t,r/2,n)},f=function(e,t,r){for(var n=-1,o=r;++n<6;)o+=t*e[n],e[n]=o%1e7,o=c(o/1e7)},p=function(e,t){for(var r=6,n=0;--r>=0;)n+=e[r],e[r]=c(n/t),n=n%t*1e7},h=function(e){for(var t=6,r="";--t>=0;)if(""!==r||0===t||0!==e[t]){var n=String(e[t]);r=""===r?n:r+i.call("0",7-n.length)+n}return r};n({target:"Number",proto:!0,forced:s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!u((function(){s.call({})}))},{toFixed:function(e){var t,r,n,u,s=a(this),c=o(e),d=[0,0,0,0,0,0],m="",y="0";if(c<0||c>20)throw RangeError("Incorrect fraction digits");if(s!=s)return"NaN";if(s<=-1e21||s>=1e21)return String(s);if(s<0&&(m="-",s=-s),s>1e-21)if(r=(t=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t}(s*l(2,69,1))-69)<0?s*l(2,-t,1):s/l(2,t,1),r*=4503599627370496,(t=52-t)>0){for(f(d,0,r),n=c;n>=7;)f(d,1e7,0),n-=7;for(f(d,l(10,n,1),0),n=t-1;n>=23;)p(d,1<<23),n-=23;p(d,1<<n),f(d,1,1),p(d,2),y=h(d)}else f(d,0,r),f(d,1<<-t,0),y=h(d)+i.call("0",c);return y=c>0?m+((u=y.length)<=c?"0."+i.call("0",c-u)+y:y.slice(0,u-c)+"."+y.slice(u-c)):m+y}})},function(e,t,r){var n=r(12);e.exports=function(e){if("number"!=typeof e&&"Number"!=n(e))throw TypeError("Incorrect invocation");return+e}},function(e,t,r){"use strict";var n=r(42),o=r(13);e.exports=function(e){var t=String(o(this)),r="",a=n(e);if(a<0||a==1/0)throw RangeError("Wrong number of repetitions");for(;a>0;(a>>>=1)&&(t+=t))1&a&&(r+=t);return r}},function(e,t,r){"use strict";t.__esModule=!0,t.formatToken=u,t.parseForDateTimeFormat=c,t.parseForNumberFormat=l,t.parse=function(e){var t,r;return null!==(r=null!==(t=c(e))&&void 0!==t?t:l(e))&&void 0!==r?r:{type:o.STRING,tokens:[{type:n.FREE_TEXT,value:e}]}},t.isEscapeToken=f,t.FormatExpressionType=t.TokenType=void 0,r(146),r(111);
/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */
var n,o,a=/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g,i=/(\\.|[#0]+(\.[#0]*)?)/g;function u(e,t){return{type:e,value:t}}function s(e,t){for(var r=[],o=0,a=0;a<e.length;++a){var i=e[a];if(i.index!==o){var s=t.substr(o,i.index-o);r.push(u(n.FREE_TEXT,s))}i[0].startsWith("\\")?r.push(u(n.FREE_TEXT,i[0])):r.push(u(n.FORMAT,i[0])),o=i.index+i[0].length}var c=e[e.length-1];if(c.index+c[0].length<t.length){var l=t.substr(c.index+c[0].length,t.length);r.push(u(n.FREE_TEXT,l))}return r}function c(e){var t=function(e){a.lastIndex=0;var t,r=[];do{null!==(t=a.exec(e))&&r.push(t)}while(t);return r}(e);return t.every((function(e){return f(e)}))?void 0:{type:o.DATE,tokens:s(t,e)}}function l(e){var t=function(e){i.lastIndex=0;var t=i.exec(e);return null!==t?[t]:[]}(e);return t.every((function(e){return f(e)}))?void 0:{type:o.NUMBER,tokens:s(t,e)}}function f(e){return e[0].startsWith("\\")}t.TokenType=n,function(e){e.FORMAT="FORMAT",e.FREE_TEXT="FREE_TEXT"}(n||(t.TokenType=n={})),t.FormatExpressionType=o,function(e){e.DATE="DATE",e.NUMBER="NUMBER",e.STRING="STRING"}(o||(t.FormatExpressionType=o={}))},function(e,t,r){"use strict";r(87),r(93),r(94),r(53),t.__esModule=!0,t.HyperFormula=void 0,r(126),r(67),r(125),r(121),r(68),r(77),r(95),r(63),r(97),r(210);var n=r(135),o=r(115),a=r(270),i=r(262),u=r(244),s=r(273),c=r(231),l=r(141),f=r(288),p=r(290),h=r(306);function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||y(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||y(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){if(e){if("string"==typeof e)return g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?g(e,t):void 0}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var E=function(){function e(t,r,n,o,a,i,u,s,c,l,p,h,d,m){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._config=t,this._stats=r,this._dependencyGraph=n,this._columnSearch=o,this._parser=a,this._unparser=i,this._cellContentParser=u,this._evaluator=s,this._lazilyTransformingAstService=c,this._crudOperations=l,this._exporter=p,this._namedExpressions=h,this._serialization=d,this._functionRegistry=m,this._emitter=new f.Emitter,this._evaluationSuspended=!1}var t,r,y;return t=e,y=[{key:"buildFromEngineState",value:function(t){return new e(t.config,t.stats,t.dependencyGraph,t.columnSearch,t.parser,t.unparser,t.cellContentParser,t.evaluator,t.lazilyTransformingAstService,t.crudOperations,t.exporter,t.namedExpressions,t.serialization,t.functionRegistry)}},{key:"buildFromArray",value:function(e,t){return this.buildFromEngineState(p.BuildEngineFactory.buildFromSheet(e,t))}},{key:"buildFromSheets",value:function(e,t){return this.buildFromEngineState(p.BuildEngineFactory.buildFromSheets(e,t))}},{key:"buildEmpty",value:function(e){return this.buildFromEngineState(p.BuildEngineFactory.buildEmpty(e))}},{key:"getLanguage",value:function(e){var t=this.registeredLanguages.get(e);if(void 0===t)throw new c.LanguageNotRegisteredError;return t}},{key:"registerLanguage",value:function(e,t){if(this.registeredLanguages.has(e))throw new c.LanguageAlreadyRegisteredError;this.registeredLanguages.set(e,(0,u.buildTranslationPackage)(t))}},{key:"unregisterLanguage",value:function(e){if(!this.registeredLanguages.has(e))throw new c.LanguageNotRegisteredError;this.registeredLanguages.delete(e)}},{key:"getRegisteredLanguagesCodes",value:function(){return Array.from(this.registeredLanguages.keys())}},{key:"registerFunctionPlugin",value:function(e,t){h.FunctionRegistry.registerFunctionPlugin(e,t)}},{key:"unregisterFunctionPlugin",value:function(e){h.FunctionRegistry.unregisterFunctionPlugin(e)}},{key:"registerFunction",value:function(e,t,r){h.FunctionRegistry.registerFunction(e,t,r)}},{key:"unregisterFunction",value:function(e){h.FunctionRegistry.unregisterFunction(e)}},{key:"unregisterAllFunctions",value:function(){h.FunctionRegistry.unregisterAll()}},{key:"getRegisteredFunctionNames",value:function(e){var t=h.FunctionRegistry.getRegisteredFunctionIds();return this.getLanguage(e).getFunctionTranslations(t)}},{key:"getFunctionPlugin",value:function(e){return h.FunctionRegistry.getFunctionPlugin(e)}},{key:"getAllFunctionPlugins",value:function(){return h.FunctionRegistry.getPlugins()}}],(r=[{key:"graph",get:function(){return this.dependencyGraph.graph}},{key:"rangeMapping",get:function(){return this.dependencyGraph.rangeMapping}},{key:"matrixMapping",get:function(){return this.dependencyGraph.matrixMapping}},{key:"sheetMapping",get:function(){return this.dependencyGraph.sheetMapping}},{key:"addressMapping",get:function(){return this.dependencyGraph.addressMapping}},{key:"dependencyGraph",get:function(){return this._dependencyGraph}},{key:"evaluator",get:function(){return this._evaluator}},{key:"columnSearch",get:function(){return this._columnSearch}},{key:"lazilyTransformingAstService",get:function(){return this._lazilyTransformingAstService}},{key:"licenseKeyValidityState",get:function(){return this._config.licenseKeyValidityState}},{key:"getCellValue",value:function(e){return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e)}},{key:"ensureEvaluationIsNotSuspended",value:function(){if(this._evaluationSuspended)throw new c.EvaluationSuspendedError}},{key:"getCellFormula",value:function(e){return this._serialization.getCellFormula(e)}},{key:"getCellSerialized",value:function(e){return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e)}},{key:"getSheetValues",value:function(e){return this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}},{key:"getSheetFormulas",value:function(e){return this._serialization.getSheetFormulas(e)}},{key:"getSheetSerialized",value:function(e){return this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}},{key:"getAllSheetsDimensions",value:function(){var e=this;return this._serialization.genericAllSheetsGetter((function(t){return e.getSheetDimensions(t)}))}},{key:"getSheetDimensions",value:function(e){return{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}},{key:"getAllSheetsValues",value:function(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}},{key:"getAllSheetsFormulas",value:function(){return this._serialization.getAllSheetsFormulas()}},{key:"getAllSheetsSerialized",value:function(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}},{key:"updateConfig",value:function(e){var t=this,r=this._config.mergeConfig(e),n=this._config.mergeConfig({language:e.language}),o=this._serialization.withNewConfig(n,this._namedExpressions).getAllSheetsSerialized(),a=this._serialization.getAllNamedExpressionsSerialized(),i=p.BuildEngineFactory.rebuildWithConfig(r,o,this._stats);this._config=i.config,this._stats=i.stats,this._dependencyGraph=i.dependencyGraph,this._columnSearch=i.columnSearch,this._parser=i.parser,this._unparser=i.unparser,this._cellContentParser=i.cellContentParser,this._evaluator=i.evaluator,this._lazilyTransformingAstService=i.lazilyTransformingAstService,this._crudOperations=i.crudOperations,this._exporter=i.exporter,this._namedExpressions=i.namedExpressions,this._serialization=i.serialization,this._functionRegistry=i.functionRegistry,a.forEach((function(e){t.addNamedExpression(e.name,e.expression,e.scope,e.options)}))}},{key:"getConfig",value:function(){return this._config.getConfig()}},{key:"rebuildAndRecalculate",value:function(){this.updateConfig({})}},{key:"getStats",value:function(){return this._stats.snapshot()}},{key:"undo",value:function(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}},{key:"redo",value:function(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isThereSomethingToUndo",value:function(){return this._crudOperations.isThereSomethingToUndo()}},{key:"isThereSomethingToRedo",value:function(){return this._crudOperations.isThereSomethingToRedo()}},{key:"isItPossibleToSetCellContents",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;try{this._crudOperations.ensureRangeInSizeLimits(n.AbsoluteCellRange.spanFrom(e,t,r));for(var o=0;o<t;o++)for(var a=0;a<r;a++)this._crudOperations.ensureItIsPossibleToChangeContent({col:e.col+o,row:e.row+a,sheet:e.sheet})}catch(e){return!1}return!0}},{key:"setCellContents",value:function(e,t){return this._crudOperations.setCellContents(e,t),this.recomputeIfDependencyGraphNeedsIt()}},{key:"swapRowIndexes",value:function(e,t){return this._crudOperations.setRowOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToSwapRowIndexes",value:function(e,t){try{return this._crudOperations.validateSwapRowIndexes(e,t),this._crudOperations.testRowOrderForMatrices(e,t),!0}catch(e){return!1}}},{key:"setRowOrder",value:function(e,t){var r=this._crudOperations.mappingFromOrder(e,t,"row");return this.swapRowIndexes(e,r)}},{key:"isItPossibleToSetRowOrder",value:function(e,t){try{var r=this._crudOperations.mappingFromOrder(e,t,"row");return this._crudOperations.validateSwapRowIndexes(e,r),this._crudOperations.testRowOrderForMatrices(e,r),!0}catch(e){return!1}}},{key:"swapColumnIndexes",value:function(e,t){return this._crudOperations.setColumnOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToSwapColumnIndexes",value:function(e,t){try{return this._crudOperations.validateSwapColumnIndexes(e,t),this._crudOperations.testColumnOrderForMatrices(e,t),!0}catch(e){return!1}}},{key:"setColumnOrder",value:function(e,t){var r=this._crudOperations.mappingFromOrder(e,t,"column");return this.swapColumnIndexes(e,r)}},{key:"isItPossibleToSetColumnOrder",value:function(e,t){try{var r=this._crudOperations.mappingFromOrder(e,t,"column");return this._crudOperations.validateSwapColumnIndexes(e,r),this._crudOperations.testColumnOrderForMatrices(e,r),!0}catch(e){return!1}}},{key:"isItPossibleToAddRows",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=(0,s.normalizeAddedIndexes)(r);try{var a;return(a=this._crudOperations).ensureItIsPossibleToAddRows.apply(a,[e].concat(m(o))),!0}catch(e){return!1}}},{key:"addRows",value:function(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return(t=this._crudOperations).addRows.apply(t,[e].concat(n)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToRemoveRows",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=(0,s.normalizeRemovedIndexes)(r);try{var a;return(a=this._crudOperations).ensureItIsPossibleToRemoveRows.apply(a,[e].concat(m(o))),!0}catch(e){return!1}}},{key:"removeRows",value:function(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return(t=this._crudOperations).removeRows.apply(t,[e].concat(n)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToAddColumns",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=(0,s.normalizeAddedIndexes)(r);try{var a;return(a=this._crudOperations).ensureItIsPossibleToAddColumns.apply(a,[e].concat(m(o))),!0}catch(e){return!1}}},{key:"addColumns",value:function(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return(t=this._crudOperations).addColumns.apply(t,[e].concat(n)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToRemoveColumns",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=(0,s.normalizeRemovedIndexes)(r);try{var a;return(a=this._crudOperations).ensureItIsPossibleToRemoveColumns.apply(a,[e].concat(m(o))),!0}catch(e){return!1}}},{key:"removeColumns",value:function(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return(t=this._crudOperations).removeColumns.apply(t,[e].concat(n)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToMoveCells",value:function(e,t,r,n){try{return this._crudOperations.operations.ensureItIsPossibleToMoveCells(e,t,r,n),!0}catch(e){return!1}}},{key:"moveCells",value:function(e,t,r,n){return this._crudOperations.moveCells(e,t,r,n),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToMoveRows",value:function(e,t,r,n){try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,t,r,n),!0}catch(e){return!1}}},{key:"moveRows",value:function(e,t,r,n){return this._crudOperations.moveRows(e,t,r,n),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToMoveColumns",value:function(e,t,r,n){try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,t,r,n),!0}catch(e){return!1}}},{key:"moveColumns",value:function(e,t,r,n){return this._crudOperations.moveColumns(e,t,r,n),this.recomputeIfDependencyGraphNeedsIt()}},{key:"copy",value:function(e,t,r){return this._crudOperations.copy(e,t,r),this.getRangeValues(e,t,r)}},{key:"cut",value:function(e,t,r){return this._crudOperations.cut(e,t,r),this.getRangeValues(e,t,r)}},{key:"paste",value:function(e){return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isClipboardEmpty",value:function(){return this._crudOperations.isClipboardEmpty()}},{key:"clearClipboard",value:function(){this._crudOperations.clearClipboard()}},{key:"clearRedoStack",value:function(){this._crudOperations.undoRedo.clearRedoStack()}},{key:"clearUndoStack",value:function(){this._crudOperations.undoRedo.clearUndoStack()}},{key:"getRangeValues",value:function(e,t,r){var o=this;return n.AbsoluteCellRange.spanFrom(e,t,r).arrayOfAddressesInRange().map((function(e){return e.map((function(e){return o.getCellValue(e)}))}))}},{key:"getRangeFormulas",value:function(e,t,r){var o=this;return n.AbsoluteCellRange.spanFrom(e,t,r).arrayOfAddressesInRange().map((function(e){return e.map((function(e){return o.getCellFormula(e)}))}))}},{key:"getRangeSerialized",value:function(e,t,r){var o=this;return n.AbsoluteCellRange.spanFrom(e,t,r).arrayOfAddressesInRange().map((function(e){return e.map((function(e){return o.getCellSerialized(e)}))}))}},{key:"isItPossibleToAddSheet",value:function(e){try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch(e){return!1}}},{key:"addSheet",value:function(e){var t=this._crudOperations.addSheet(e);return this._emitter.emit(f.Events.SheetAdded,t),t}},{key:"isItPossibleToRemoveSheet",value:function(e){try{return this._crudOperations.ensureSheetExists(e),!0}catch(e){return!1}}},{key:"removeSheet",value:function(e){var t=this.sheetMapping.getDisplayNameByName(e);this._crudOperations.removeSheet(e);var r=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(f.Events.SheetRemoved,t,r),r}},{key:"isItPossibleToClearSheet",value:function(e){try{return this._crudOperations.ensureSheetExists(e),!0}catch(e){return!1}}},{key:"clearSheet",value:function(e){return this._crudOperations.ensureSheetExists(e),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToReplaceSheetContent",value:function(e,t){try{this._crudOperations.ensureSheetExists(e);var r=this.sheetMapping.fetch(e);return this._crudOperations.ensureItIsPossibleToChangeSheetContents(r,t),!0}catch(e){return!1}}},{key:"setSheetContent",value:function(e,t){return this._crudOperations.setSheetContent(e,t),this.recomputeIfDependencyGraphNeedsIt()}},{key:"simpleCellAddressFromString",value:function(e,t){return(0,l.simpleCellAddressFromString)(this.sheetMapping.get,e,t)}},{key:"simpleCellAddressToString",value:function(e,t){return(0,l.simpleCellAddressToString)(this.sheetMapping.fetchDisplayName,e,t)}},{key:"getCellDependents",value:function(e){var t;if(e instanceof n.AbsoluteCellRange){if(void 0===(t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end)))return[]}else if(null===(t=this._dependencyGraph.addressMapping.getCell(e)))return[];return this._dependencyGraph.getAdjacentNodesAddresses(t)}},{key:"getCellPrecedents",value:function(e){var t,r;if(e instanceof n.AbsoluteCellRange){if(void 0===(r=this._dependencyGraph.rangeMapping.getRange(e.start,e.end)))return[]}else if(null===(r=this._dependencyGraph.addressMapping.getCell(e)))return[];return null!==(t=this._dependencyGraph.dependencyQueryAddresses(r))&&void 0!==t?t:[]}},{key:"getSheetName",value:function(e){return this.sheetMapping.getDisplayName(e)}},{key:"getSheetNames",value:function(){return this.sheetMapping.sheetNames()}},{key:"getSheetId",value:function(e){return this.sheetMapping.get(e)}},{key:"doesSheetExist",value:function(e){return this.sheetMapping.hasSheetWithName(e)}},{key:"getCellType",value:function(e){var t=this.dependencyGraph.getCell(e);return(0,o.getCellType)(t)}},{key:"doesCellHaveSimpleValue",value:function(e){return this.getCellType(e)===o.CellType.VALUE}},{key:"doesCellHaveFormula",value:function(e){return this.getCellType(e)===o.CellType.FORMULA}},{key:"isCellEmpty",value:function(e){return this.getCellType(e)===o.CellType.EMPTY}},{key:"isCellPartOfMatrix",value:function(e){return this.getCellType(e)===o.CellType.MATRIX}},{key:"getCellValueType",value:function(e){this.ensureEvaluationIsNotSuspended();var t=this.dependencyGraph.getCellValue(e);return(0,o.getCellValueType)(t)}},{key:"getCellValueDetailedType",value:function(e){this.ensureEvaluationIsNotSuspended();var t=this.dependencyGraph.getCellValue(e);return(0,o.getCellValueDetailedType)(t)}},{key:"getCellValueFormat",value:function(e){this.ensureEvaluationIsNotSuspended();var t=this.dependencyGraph.getCellValue(e);return(0,o.getCellValueFormat)(t)}},{key:"countSheets",value:function(){return this.sheetMapping.numberOfSheets()}},{key:"isItPossibleToRenameSheet",value:function(e,t){try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,t),!0}catch(e){return!1}}},{key:"renameSheet",value:function(e,t){var r=this._crudOperations.renameSheet(e,t);void 0!==r&&this._emitter.emit(f.Events.SheetRenamed,r,t)}},{key:"batch",value:function(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(e){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),e}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}},{key:"suspendEvaluation",value:function(){this._evaluationSuspended=!0,this._emitter.emit(f.Events.EvaluationSuspended)}},{key:"resumeEvaluation",value:function(){this._evaluationSuspended=!1;var e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(f.Events.EvaluationResumed,e),e}},{key:"isEvaluationSuspended",value:function(){return this._evaluationSuspended}},{key:"isItPossibleToAddNamedExpression",value:function(e,t,r){try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,t,r),!0}catch(e){return!1}}},{key:"addNamedExpression",value:function(e,t,r,n){this._crudOperations.addNamedExpression(e,t,r,n);var o=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(f.Events.NamedExpressionAdded,e,o),o}},{key:"getNamedExpressionValue",value:function(e,t){this.ensureEvaluationIsNotSuspended();var r=this._crudOperations.scopeId(t),n=this._namedExpressions.namedExpressionForScope(e,r);return n?this._serialization.getCellValue(n.address):void 0}},{key:"getNamedExpressionFormula",value:function(e,t){var r=this._crudOperations.scopeId(t),n=this._namedExpressions.namedExpressionForScope(e,r);return void 0===n?void 0:this._serialization.getCellFormula(n.address)}},{key:"getNamedExpression",value:function(e,t){var r=this._crudOperations.scopeId(t),n=this._namedExpressions.namedExpressionForScope(e,r);if(void 0!==n)return{name:e,scope:t,expression:this._serialization.getCellFormula(n.address),options:n.options}}},{key:"isItPossibleToChangeNamedExpression",value:function(e,t,r){try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,t,r),!0}catch(e){return!1}}},{key:"changeNamedExpression",value:function(e,t,r,n){return this._crudOperations.changeNamedExpressionExpression(e,r,t,n),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToRemoveNamedExpression",value:function(e,t){try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,t),!0}catch(e){return!1}}},{key:"removeNamedExpression",value:function(e,t){var r=this._crudOperations.removeNamedExpression(e,t);if(r){var n=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(f.Events.NamedExpressionRemoved,r.displayName,n),n}return[]}},{key:"listNamedExpressions",value:function(e){var t=this._crudOperations.scopeId(e);return this._namedExpressions.getAllNamedExpressionsNamesInScope(t)}},{key:"normalizeFormula",value:function(e){var t=d(this.extractTemporaryFormula(e),2),r=t[0],n=t[1];if(void 0===r)throw new c.NotAFormulaError;return this._unparser.unparse(r,n)}},{key:"calculateFormula",value:function(e,t){this._crudOperations.ensureSheetExists(t);var r=this.sheetMapping.fetch(t),n=d(this.extractTemporaryFormula(e,r),3),o=n[0],a=n[1],i=n[2];if(void 0===o)throw new c.NotAFormulaError;var u=this.evaluator.runAndForget(o,a,i);return this._exporter.exportValue(u)}},{key:"validateFormula",value:function(e){var t=d(this.extractTemporaryFormula(e),1)[0];return void 0!==t&&!(t.type===l.AstNodeType.ERROR&&!t.error)}},{key:"getRegisteredFunctionNames",value:function(){return e.getLanguage(this._config.language).getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}},{key:"getFunctionPlugin",value:function(e){return this._functionRegistry.getFunctionPlugin(e)}},{key:"getAllFunctionPlugins",value:function(){return this._functionRegistry.getPlugins()}},{key:"numberToDateTime",value:function(e){return this._evaluator.dateHelper.numberToSimpleDateTime(e)}},{key:"numberToDate",value:function(e){return this._evaluator.dateHelper.numberToSimpleDate(e)}},{key:"numberToTime",value:function(e){return(0,i.numberToSimpleTime)(e)}},{key:"extractTemporaryFormula",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=this._cellContentParser.parse(e),n={sheet:t,col:0,row:0};if(!(r instanceof a.CellContent.Formula))return[void 0,n,[]];var o=this._parser.parse(r.formula,n),i=o.ast,u=o.errors,s=o.dependencies;return u.length>0?[void 0,n,[]]:[i,n,s]}},{key:"on",value:function(e,t){this._emitter.on(e,t)}},{key:"once",value:function(e,t){this._emitter.once(e,t)}},{key:"off",value:function(e,t){this._emitter.off(e,t)}},{key:"destroy",value:function(){this.dependencyGraph.destroy(),this.columnSearch.destroy(),this.evaluator.destroy(),this._parser.destroy(),this._lazilyTransformingAstService.destroy(),this._stats.destroy(),this._crudOperations.clearClipboard()}},{key:"recomputeIfDependencyGraphNeedsIt",value:function(){if(this._evaluationSuspended)return[];var e=this._crudOperations.getAndClearContentChanges(),t=Array.from(this.dependencyGraph.verticesToRecompute());this.dependencyGraph.clearRecentlyChangedVertices(),t.length>0&&e.addAll(this.evaluator.partialRun(t));var r=e.exportChanges(this._exporter);return e.isEmpty()||this._emitter.emit(f.Events.ValuesUpdated,r),r}}])&&v(t.prototype,r),y&&v(t,y),e}();t.HyperFormula=E,E.version="0.6.0",E.buildDate="27/04/2021 09:26:57",E.releaseDate="27/04/2021",E.languages={},E.registeredLanguages=new Map},function(e,t,r){"use strict";r(63),r(67),r(68),r(77),r(87),r(93),r(94),r(95),r(97),t.__esModule=!0,t.isFormula=d,t.isBoolean=m,t.isMatrix=y,t.isError=g,t.CellContentParser=t.CellContent=void 0,r(111),r(261),r(53),r(259);var n,o=r(115),a=r(231),i=r(271),u=r(223);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){if(e){if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t,r){return t&&f(e.prototype,t),r&&f(e,r),e}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e){return e.startsWith("=")}function m(e){var t=e.toLowerCase();return"true"===t||"false"===t}function y(e){return"string"==typeof e&&e.length>1&&e.startsWith("{")&&e.endsWith("}")}function g(e,t){var r=e.toUpperCase();return/#[A-Za-z0-9\/]+[?!]?/.test(r)&&Object.prototype.hasOwnProperty.call(t,r)}t.CellContent=n,function(e){e.Number=function e(t){h(this,e),this.value=t,this.value=(0,u.cloneNumber)(this.value,(0,i.fixNegativeZero)((0,u.getRawValue)(this.value)))},e.String=function e(t){h(this,e),this.value=t},e.Boolean=function e(t){h(this,e),this.value=t};var t=function(){function e(){h(this,e)}return p(e,null,[{key:"getSingletonInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();e.Empty=t,e.Formula=function e(t){h(this,e),this.formula=t};var r=function(){function e(t){h(this,e),this.formula=t}return p(e,[{key:"formulaWithBraces",value:function(){return"{"+this.formula+"}"}}]),e}();e.MatrixFormula=r,e.Error=function e(t){h(this,e),this.value=new o.CellError(t)}}(n||(t.CellContent=n={}));var v=function(){function e(t,r,n){h(this,e),this.config=t,this.dateHelper=r,this.numberLiteralsHelper=n}return p(e,[{key:"currencyMatcher",value:function(e){var t,r=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=c(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}(this.config.currencySymbol);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(e.startsWith(n))return[n,e.slice(n.length)];if(e.endsWith(n))return[n,e.slice(0,e.length-n.length)]}}catch(e){r.e(e)}finally{r.f()}}},{key:"parse",value:function(e){if(null==e)return n.Empty.getSingletonInstance();if("number"==typeof e)return(0,i.isNumberOverflow)(e)?new n.Error(o.ErrorType.NUM):new n.Number(e);if("boolean"==typeof e)return new n.Boolean(e);if(e instanceof Date)return new n.Number(new u.DateNumber(this.dateHelper.dateToNumber({day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()}),"Date()"));if("string"==typeof e){if(m(e))return new n.Boolean("true"===e.toLowerCase());if(y(e))return new n.MatrixFormula(e.substr(1,e.length-2));if(d(e))return new n.Formula(e);if(g(e,this.config.errorMapping))return new n.Error(this.config.errorMapping[e.toUpperCase()]);var t,r=e.trim(),c=0;if(r.endsWith("%"))c=1,r=r.slice(0,r.length-1);else{var l=this.currencyMatcher(r);if(void 0!==l){c=2;var f=s(l,2);t=f[0],r=f[1]}}var p,h=this.numberLiteralsHelper.numericStringToMaybeNumber(r);if(void 0!==h)return p=1===c?new u.PercentNumber(h/100):2===c?new u.CurrencyNumber(h,t):h,new n.Number(p);var v=this.dateHelper.dateStringToDateNumber(r);return void 0!==v?new n.Number(v):new n.String(e.startsWith("'")?e.slice(1):e)}throw new a.UnableToParseError(e)}}]),e}();t.CellContentParser=v},function(e,t,r){"use strict";r(53),r(67),r(68),r(77),r(87),r(93),r(94),r(95),r(97),t.__esModule=!0,t.coerceComplexToString=function(e,t){var r,a,i=(a=2,function(e){if(Array.isArray(e))return e}(r=e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(r,a)||l(r,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=i[0],s=i[1];if(!isFinite(u)||!isFinite(s))return new n.CellError(n.ErrorType.NUM,o.ErrorMessage.NaN);if(t=null!=t?t:"i",0===s)return"".concat(u);var c="".concat(-1===s||1===s?"":Math.abs(s)).concat(t);return 0===u?"".concat(s<0?"-":"").concat(c):"".concat(u).concat(s<0?"-":"+").concat(c)},t.coerceToRange=function(e){return e instanceof u.SimpleRangeValue?e:u.SimpleRangeValue.fromScalar(e)},t.coerceToRangeNumbersOrError=function(e){return e instanceof u.SimpleRangeValue&&e.hasOnlyNumbers()||e instanceof n.CellError?e:(0,i.isExtendedNumber)(e)?u.SimpleRangeValue.fromScalar(e):null},t.coerceBooleanToNumber=m,t.coerceEmptyToValue=y,t.coerceScalarToBoolean=function(e){if(e instanceof n.CellError||"boolean"==typeof e)return e;if(e===i.EmptyValue)return!1;if((0,i.isExtendedNumber)(e))return 0!==(0,i.getRawValue)(e);var t=e.toUpperCase();return"TRUE"===t||"FALSE"!==t&&""!==t&&void 0},t.coerceScalarToString=function(e){return e instanceof n.CellError||"string"==typeof e?e:e===i.EmptyValue?"":(0,i.isExtendedNumber)(e)?(0,i.getRawValue)(e).toString():e?"TRUE":"FALSE"},t.zeroIfEmpty=function(e){return e===i.EmptyValue?0:e},t.numberCmp=g,t.isNumberOverflow=function(e){return isNaN(e)||e===1/0||e===-1/0},t.fixNegativeZero=function(e){return 0===e?0:e},t.forceNormalizeString=function(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")},t.ArithmeticHelper=void 0,r(125),r(146),r(143),r(148),r(156),r(259),r(138),r(63),r(256);var n=r(115),o=r(215),a=r(272),i=r(223),u=r(222);function s(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=l(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}function l(e,t){if(e){if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var h=/^\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij]))\s*(([+-])\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij])))?$/,d=function(){function e(t,r,u){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.dateTimeHelper=r,this.numberLiteralsHelper=u,this.lt=function(e,t){return s.compare(e,t)<0},this.leq=function(e,t){return s.compare(e,t)<=0},this.gt=function(e,t){return s.compare(e,t)>0},this.geq=function(e,t){return s.compare(e,t)>=0},this.eq=function(e,t){return 0===s.compare(e,t)},this.neq=function(e,t){return 0!==s.compare(e,t)},this.pow=function(e,t){return Math.pow((0,i.getRawValue)(e),(0,i.getRawValue)(t))},this.addWithEpsilonRaw=function(e,t){var r=e+t;return Math.abs(r)<s.actualEps*Math.abs(e)?0:r},this.addWithEpsilon=function(e,t){var r=S(e,t);return s.ExtendedNumberFactory(s.addWithEpsilonRaw((0,i.getRawValue)(e),(0,i.getRawValue)(t)),r)},this.unaryMinus=function(e){return(0,i.cloneNumber)(e,-(0,i.getRawValue)(e))},this.unaryPlus=function(e){return e},this.unaryPercent=function(e){return new i.PercentNumber((0,i.getRawValue)(e)/100)},this.concat=function(e,t){return e.concat(t)},this.nonstrictadd=function(e,t){return e instanceof n.CellError?e:t instanceof n.CellError?t:"number"==typeof e?"number"==typeof t?s.addWithEpsilonRaw(e,t):e:"number"==typeof t?t:0},this.subtract=function(e,t){var r=S(e,t),n=(0,i.getRawValue)(e),o=n-(0,i.getRawValue)(t);return Math.abs(o)<s.actualEps*Math.abs(n)&&(o=0),s.ExtendedNumberFactory(o,r)},this.divide=function(e,t){var r=(0,i.getRawValue)(e),o=(0,i.getRawValue)(t);if(0===o)return new n.CellError(n.ErrorType.DIV_BY_ZERO);var a=N(e,t);return s.ExtendedNumberFactory(r/o,a)},this.multiply=function(e,t){var r=N(e,t);return s.ExtendedNumberFactory((0,i.getRawValue)(e)*(0,i.getRawValue)(t),r)},this.manyToExactComplex=function(e){var t,r=[],o=c(e);try{for(o.s();!(t=o.n()).done;){var a=t.value;if(a instanceof n.CellError)return a;if((0,i.isExtendedNumber)(a)||"string"==typeof a){var u=s.coerceScalarToComplex(a);u instanceof n.CellError||r.push(u)}}}catch(e){o.e(e)}finally{o.f()}return r},this.coerceNumbersExactRanges=function(e){return s.manyToNumbers(e,s.manyToExactNumbers)},this.coerceNumbersCoerceRangesDropNulls=function(e){return s.manyToNumbers(e,s.manyToCoercedNumbersDropNulls)},this.manyToExactNumbers=function(e){var t,r=[],o=c(e);try{for(o.s();!(t=o.n()).done;){var a=t.value;if(a instanceof n.CellError)return a;(0,i.isExtendedNumber)(a)&&r.push((0,i.getRawValue)(a))}}catch(e){o.e(e)}finally{o.f()}return r},this.manyToOnlyNumbersDropNulls=function(e){var t,r=[],a=c(e);try{for(a.s();!(t=a.n()).done;){var u=t.value;if(u instanceof n.CellError)return u;if(u!==i.EmptyValue){if(!(0,i.isExtendedNumber)(u))return new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.NumberExpected);r.push((0,i.getRawValue)(u))}}}catch(e){a.e(e)}finally{a.f()}return r},this.manyToCoercedNumbersDropNulls=function(e){var t,r=[],o=c(e);try{for(o.s();!(t=o.n()).done;){var a=t.value;if(a instanceof n.CellError)return a;if(a!==i.EmptyValue){var u=s.coerceScalarToNumberOrError(a);(0,i.isExtendedNumber)(u)&&r.push((0,i.getRawValue)(u))}}}catch(e){o.e(e)}finally{o.f()}return r},this.collator=(0,a.collatorFromConfig)(t),this.actualEps=t.smartRounding?t.precisionEpsilon:0}var t,r,l;return t=e,(r=[{key:"eqMatcherFunction",value:function(e){var t=this,r=this.buildRegex(e);return function(e){return"string"==typeof e&&r.test(t.normalizeString(e))}}},{key:"neqMatcherFunction",value:function(e){var t=this,r=this.buildRegex(e);return function(e){return!("string"==typeof e&&r.test(t.normalizeString(e)))}}},{key:"searchString",value:function(e,t){var r,n=this.buildRegex(e,!1).exec(t);return null!==(r=null==n?void 0:n.index)&&void 0!==r?r:-1}},{key:"requiresRegex",value:function(e){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(var t=0;t<e.length;t++){var r=e.charAt(t);if(v(r)||this.config.useRegularExpressions&&T(r))return!0}return!1}},{key:"buildRegex",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e=this.normalizeString(e);var n=this.config.useWildcards,o=this.config.useRegularExpressions;if(o)try{RegExp(e)}catch(e){o=!1,n=!1}return t=o?A(e,this.config.caseSensitive):n?b(e,this.config.caseSensitive):R(e,this.config.caseSensitive),this.config.matchWholeCell&&r?RegExp("^("+t+")$"):RegExp(t)}},{key:"normalizeString",value:function(e){return this.config.caseSensitive||(e=e.toLowerCase()),this.config.accentSensitive||(e=e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")),e}},{key:"compare",value:function(e,t){if("string"==typeof e||"string"==typeof t){var r="string"==typeof e?this.dateTimeHelper.dateStringToDateNumber(e):e,o="string"==typeof t?this.dateTimeHelper.dateStringToDateNumber(t):t;if((0,i.isExtendedNumber)(r)&&(0,i.isExtendedNumber)(o))return this.floatCmp(r,o)}return e===i.EmptyValue?e=y(t):t===i.EmptyValue&&(t=y(e)),"string"==typeof e&&"string"==typeof t?this.stringCmp(e,t):"boolean"==typeof e&&"boolean"==typeof t?g(m(e),m(t)):(0,i.isExtendedNumber)(e)&&(0,i.isExtendedNumber)(t)?this.floatCmp(e,t):e===i.EmptyValue&&t===i.EmptyValue?0:g((0,n.CellValueTypeOrd)((0,n.getCellValueType)(e)),(0,n.CellValueTypeOrd)((0,n.getCellValueType)(t)))}},{key:"floatCmp",value:function(e,t){var r=(0,i.getRawValue)(e),n=(0,i.getRawValue)(t),o=1+this.actualEps;return n>=0&&r*o>=n&&r<=n*o||n<=0&&r*o<=n&&r>=n*o?0:r>n?1:-1}},{key:"stringCmp",value:function(e,t){return this.collator.compare(e,t)}},{key:"coerceScalarToNumberOrError",value:function(e){var t;return e instanceof n.CellError?e:null!==(t=this.coerceToMaybeNumber(e))&&void 0!==t?t:new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.NumberCoercion)}},{key:"coerceToMaybeNumber",value:function(e){var t;return null!==(t=this.coerceNonDateScalarToMaybeNumber(e))&&void 0!==t?t:"string"==typeof e?this.dateTimeHelper.dateStringToDateNumber(e):void 0}},{key:"coerceNonDateScalarToMaybeNumber",value:function(e){return e===i.EmptyValue?0:"string"==typeof e?""===e?0:this.numberLiteralsHelper.numericStringToMaybeNumber(e.trim()):(0,i.isExtendedNumber)(e)?e:"boolean"==typeof e?Number(e):void 0}},{key:"coerceComplexExactRanges",value:function(e){var t,r=[],o=c(e);try{for(o.s();!(t=o.n()).done;){var a=t.value;if(a instanceof u.SimpleRangeValue)r.push(a);else if(a!==i.EmptyValue){var l=this.coerceScalarToComplex(a);if(l instanceof n.CellError)return l;r.push(l)}}}catch(e){o.e(e)}finally{o.f()}for(var f=[],p=0,h=r;p<h.length;p++){var d=h[p];if(d instanceof u.SimpleRangeValue){var m=this.manyToExactComplex(d.valuesFromTopLeftCorner());if(m instanceof n.CellError)return m;f.push.apply(f,s(m))}else f.push(d)}return f}},{key:"manyToNumbers",value:function(e,t){var r,o=[],a=c(e);try{for(a.s();!(r=a.n()).done;){var l=r.value;if(l instanceof u.SimpleRangeValue)o.push(l);else{var f=(0,i.getRawValue)(this.coerceScalarToNumberOrError(l));if(f instanceof n.CellError)return f;o.push(f)}}}catch(e){a.e(e)}finally{a.f()}for(var p=[],h=0,d=o;h<d.length;h++){var m=d[h];if(m instanceof u.SimpleRangeValue){var y=t(m.valuesFromTopLeftCorner());if(y instanceof n.CellError)return y;p.push.apply(p,s(y))}else p.push(m)}return p}},{key:"coerceScalarToComplex",value:function(e){return e instanceof n.CellError?e:e===i.EmptyValue?[0,0]:(0,i.isExtendedNumber)(e)?[(0,i.getRawValue)(e),0]:"string"==typeof e?this.coerceStringToComplex(e):new n.CellError(n.ErrorType.NUM,o.ErrorMessage.ComplexNumberExpected)}},{key:"coerceStringToComplex",value:function(e){var t,r,a=h.exec(e);return null===a?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.ComplexNumberExpected):(t=void 0!==a[6]?"-"===a[1]?[0,-1]:[0,1]:this.parseComplexToken(a[1]+a[3],a[5]))instanceof n.CellError||void 0===a[8]?t:(r=void 0!==a[14]?"-"===a[9]?[0,-1]:[0,1]:this.parseComplexToken(a[9]+a[11],a[13]))instanceof n.CellError?r:""!==a[5]||""===a[13]?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.ComplexNumberExpected):"+"===a[8]?[t[0]+r[0],t[1]+r[1]]:[t[0]-r[0],t[1]-r[1]]}},{key:"parseComplexToken",value:function(e,t){var r=(0,i.getRawValue)(this.coerceNonDateScalarToMaybeNumber(e));return void 0===r?new n.CellError(n.ErrorType.NUM,o.ErrorMessage.ComplexNumberExpected):""===t?[r,0]:[0,r]}},{key:"ExtendedNumberFactory",value:function(e,t){var r=t.type,n=t.format;switch(r){case i.NumberType.NUMBER_RAW:return e;case i.NumberType.NUMBER_CURRENCY:return new i.CurrencyNumber(e,null!=n?n:this.config.currencySymbol[0]);case i.NumberType.NUMBER_DATE:return new i.DateNumber(e,n);case i.NumberType.NUMBER_DATETIME:return new i.DateTimeNumber(e,n);case i.NumberType.NUMBER_TIME:return new i.TimeNumber(e,n);case i.NumberType.NUMBER_PERCENT:return new i.PercentNumber(e,n)}}}])&&p(t.prototype,r),l&&p(t,l),e}();function m(e){return Number(e)}function y(e){return"string"==typeof e?"":(0,i.isExtendedNumber)(e)?0:"boolean"!=typeof e&&i.EmptyValue}function g(e,t){var r=(0,i.getRawValue)(e),n=(0,i.getRawValue)(t);return r>n?1:r<n?-1:0}function v(e){return["*","?"].includes(e)}t.ArithmeticHelper=d;var E=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function T(e){return E.includes(e)}function b(e,t){for(var r="",n=0;n<e.length;n++){var o=e.charAt(n);if("~"===o){if(n==e.length-1){r+="~";continue}var a=e.charAt(n+1);v(a)||T(a)?(r+="\\"+a,n++):(r+=a,n++)}else v(o)?r+="."+o:T(o)?r+="\\"+o:r+=t?o:o.toLowerCase()}return r}function R(e,t){for(var r="",n=0;n<e.length;n++){var o=e.charAt(n);v(o)||T(o)?r+="\\"+o:r+=t?o:o.toLowerCase()}return r}function A(e,t){for(var r="",n=0;n<e.length;n++){var o=e.charAt(n);v(o)||T(o)?r+=o:r+=t?o:o.toLowerCase()}return r}function S(e,t){var r=(0,i.getTypeFormatOfExtendedNumber)(e),n=r.type,o=r.format,a=(0,i.getTypeFormatOfExtendedNumber)(t),u=a.type,s=a.format;if(n===i.NumberType.NUMBER_RAW)return{type:u,format:s};if(u===i.NumberType.NUMBER_RAW)return{type:n,format:o};if(!(n!==i.NumberType.NUMBER_DATETIME&&n!==i.NumberType.NUMBER_DATE||u!==i.NumberType.NUMBER_DATETIME&&u!==i.NumberType.NUMBER_DATE))return{type:i.NumberType.NUMBER_RAW};if(n===i.NumberType.NUMBER_TIME){if(u===i.NumberType.NUMBER_DATE)return{type:i.NumberType.NUMBER_DATETIME,format:s+" "+o};if(u===i.NumberType.NUMBER_DATETIME)return{type:i.NumberType.NUMBER_DATETIME,format:s}}if(u===i.NumberType.NUMBER_TIME){if(n===i.NumberType.NUMBER_DATE)return{type:i.NumberType.NUMBER_DATETIME,format:o+" "+s};if(n===i.NumberType.NUMBER_DATETIME)return{type:i.NumberType.NUMBER_DATETIME,format:o}}return{type:n,format:o}}function N(e,t){var r=(0,i.getTypeFormatOfExtendedNumber)(e),n=r.type,o=r.format,a=(0,i.getTypeFormatOfExtendedNumber)(t),u=a.type,s=a.format;return n===i.NumberType.NUMBER_PERCENT&&(n=i.NumberType.NUMBER_RAW,o=void 0),u===i.NumberType.NUMBER_PERCENT&&(u=i.NumberType.NUMBER_RAW,s=void 0),n===i.NumberType.NUMBER_RAW?{type:u,format:s}:u===i.NumberType.NUMBER_RAW?{type:n,format:o}:{type:i.NumberType.NUMBER_RAW}}},function(e,t,r){"use strict";t.__esModule=!0,t.collatorFromConfig=
/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */
function(e){var t=e.caseSensitive?e.accentSensitive?"variant":"case":e.accentSensitive?"accent":"base",r=e.caseFirst,n=e.ignorePunctuation;return new Intl.Collator(e.localeLang,{sensitivity:t,caseFirst:r,ignorePunctuation:n})}},function(e,t,r){"use strict";r(53),r(68),r(77),r(87),r(93),r(94),t.__esModule=!0,t.normalizeRemovedIndexes=V,t.normalizeAddedIndexes=D,t.Operations=t.RemoveColumnsCommand=t.AddColumnsCommand=t.AddRowsCommand=t.RemoveRowsCommand=void 0,r(121),r(138),r(95),r(63),r(97),r(125),r(116),r(67),r(242),r(149),r(213);var n=r(223),o=r(274),a=r(115),i=r(135),u=r(220),s=r(270),c=r(275),l=r(118),f=r(276),p=r(278),h=r(279),d=r(280),m=r(281),y=r(282),g=r(231),v=r(283),E=r(285),T=r(141),b=r(286),R=r(219),A=r(224),S=r(287);function N(e){return function(e){if(Array.isArray(e))return M(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||w(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||w(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=w(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}function w(e,t){if(e){if("string"==typeof e)return M(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?M(e,t):void 0}}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function k(e,t,r){return t&&x(e.prototype,t),r&&x(e,r),e}var _=function(){function e(t,r){I(this,e),this.sheet=t,this.indexes=r}return k(e,[{key:"normalizedIndexes",value:function(){return V(this.indexes)}},{key:"rowsSpans",value:function(){var e=this;return this.normalizedIndexes().map((function(t){return R.RowsSpan.fromNumberOfRows(e.sheet,t[0],t[1])}))}}]),e}();t.RemoveRowsCommand=_;var P=function(){function e(t,r){I(this,e),this.sheet=t,this.indexes=r}return k(e,[{key:"normalizedIndexes",value:function(){return D(this.indexes)}},{key:"rowsSpans",value:function(){var e=this;return this.normalizedIndexes().map((function(t){return R.RowsSpan.fromNumberOfRows(e.sheet,t[0],t[1])}))}}]),e}();t.AddRowsCommand=P;var L=function(){function e(t,r){I(this,e),this.sheet=t,this.indexes=r}return k(e,[{key:"normalizedIndexes",value:function(){return D(this.indexes)}},{key:"columnsSpans",value:function(){var e=this;return this.normalizedIndexes().map((function(t){return R.ColumnsSpan.fromNumberOfColumns(e.sheet,t[0],t[1])}))}}]),e}();t.AddColumnsCommand=L;var F=function(){function e(t,r){I(this,e),this.sheet=t,this.indexes=r}return k(e,[{key:"normalizedIndexes",value:function(){return V(this.indexes)}},{key:"columnsSpans",value:function(){var e=this;return this.normalizedIndexes().map((function(t){return R.ColumnsSpan.fromNumberOfColumns(e.sheet,t[0],t[1])}))}}]),e}();t.RemoveColumnsCommand=F;var U=function(){function e(t,r,n,o,a,i,u,s){I(this,e),this.dependencyGraph=t,this.columnSearch=r,this.cellContentParser=n,this.parser=o,this.stats=a,this.lazilyTransformingAstService=i,this.namedExpressions=u,this.config=s,this.changes=c.ContentChanges.empty(),this.allocateNamedExpressionAddressSpace()}return k(e,[{key:"removeRows",value:function(e){var t,r=[],n=C(e.rowsSpans());try{for(n.s();!(t=n.n()).done;){var o=t.value,a=this.doRemoveRows(o);a&&r.push(a)}}catch(e){n.e(e)}finally{n.f()}return r}},{key:"addRows",value:function(e){var t,r=C(e.rowsSpans());try{for(r.s();!(t=r.n()).done;){var n=t.value;this.doAddRows(n)}}catch(e){r.e(e)}finally{r.f()}}},{key:"addColumns",value:function(e){var t,r=C(e.columnsSpans());try{for(r.s();!(t=r.n()).done;){var n=t.value;this.doAddColumns(n)}}catch(e){r.e(e)}finally{r.f()}}},{key:"removeColumns",value:function(e){var t,r=[],n=C(e.columnsSpans());try{for(n.s();!(t=n.n()).done;){var o=t.value,a=this.doRemoveColumns(o);a&&r.push(a)}}catch(e){n.e(e)}finally{n.f()}return r}},{key:"removeSheet",value:function(e){var t,r=this,n=this.sheetMapping.fetch(e);this.dependencyGraph.removeSheet(n),this.stats.measure(A.StatType.TRANSFORM_ASTS,(function(){var e=new y.RemoveSheetTransformer(n);e.performEagerTransformations(r.dependencyGraph,r.parser),t=r.lazilyTransformingAstService.addTransformation(e)})),this.sheetMapping.removeSheet(n),this.columnSearch.removeSheet(n);var o=this.namedExpressions.getAllNamedExpressionsForScope(n).map((function(e){return r.removeNamedExpression(e.normalizeExpressionName(),n)}));return{version:t,scopedNamedExpressions:o}}},{key:"clearSheet",value:function(e){this.dependencyGraph.clearSheet(e),this.columnSearch.removeSheet(e)}},{key:"addSheet",value:function(e){var t=this.sheetMapping.addSheet(e),r=[];return this.dependencyGraph.addressMapping.autoAddSheet(t,r,(0,b.findBoundaries)(r)),this.sheetMapping.fetchDisplayName(t)}},{key:"renameSheet",value:function(e,t){return this.sheetMapping.renameSheet(e,t)}},{key:"moveRows",value:function(e,t,r,n){var o=R.RowsSpan.fromNumberOfRows(e,n,r);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddRows(o),n<t&&(t+=r);var i=(0,a.simpleCellAddress)(e,0,t),u=(0,a.simpleCellAddress)(e,0,n);this.moveCells(i,Number.POSITIVE_INFINITY,r,u);var s=R.RowsSpan.fromNumberOfRows(e,t,r);return this.doRemoveRows(s),this.lazilyTransformingAstService.commitCombinedMode()}},{key:"moveColumns",value:function(e,t,r,n){var o=R.ColumnsSpan.fromNumberOfColumns(e,n,r);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddColumns(o),n<t&&(t+=r);var i=(0,a.simpleCellAddress)(e,t,0),u=(0,a.simpleCellAddress)(e,n,0);this.moveCells(i,r,Number.POSITIVE_INFINITY,u);var s=R.ColumnsSpan.fromNumberOfColumns(e,t,r);return this.doRemoveColumns(s),this.lazilyTransformingAstService.commitCombinedMode()}},{key:"moveCells",value:function(e,t,r,n){var o=this;this.ensureItIsPossibleToMoveCells(e,t,r,n);var a=i.AbsoluteCellRange.spanFrom(e,t,r),u=i.AbsoluteCellRange.spanFrom(n,t,r);this.dependencyGraph.breakNumericMatricesInRange(a),this.dependencyGraph.breakNumericMatricesInRange(u);var s=n.col-e.col,c=n.row-e.row,l=n.sheet,f=this.getRangeClipboardCells(u),p=this.dependencyGraph.rawValuesFromRange(u);this.columnSearch.removeValues(p);var d,m=this.dependencyGraph.rawValuesFromRange(a);this.columnSearch.moveValues(m,s,c,l),this.stats.measure(A.StatType.TRANSFORM_ASTS,(function(){var e=new h.MoveCellsTransformer(a,s,c,l);e.performEagerTransformations(o.dependencyGraph,o.parser),d=o.lazilyTransformingAstService.addTransformation(e)})),this.dependencyGraph.moveCells(a,s,c,l);var y=this.updateNamedExpressionsForMovedCells(e,t,r,n);return{version:d,overwrittenCellsData:f,addedGlobalNamedExpressions:y}}},{key:"setRowOrder",value:function(e,t){var r,n=this,o=[],a=[],u=C(t);try{var s=function(){var t=O(r.value,2),u=t[0],s=t[1];if(u!==s){var c=i.AbsoluteCellRange.spanFrom({sheet:e,col:0,row:u},1/0,1);n.dependencyGraph.breakNumericMatricesInRange(c);var l=n.getRangeClipboardCells(c);a=a.concat(l),o.push(l.map((function(e){var t=O(e,2),r=t[0],n=r.sheet,o=r.col,a=t[1];return[{sheet:n,col:o,row:s},a]})))}};for(u.s();!(r=u.n()).done;)s()}catch(e){u.e(e)}finally{u.f()}return o.forEach((function(t){return n.restoreClipboardCells(e,t.values())})),a}},{key:"setColumnOrder",value:function(e,t){var r,n=this,o=[],a=[],u=C(t);try{var s=function(){var t=O(r.value,2),u=t[0],s=t[1];if(u!==s){var c=i.AbsoluteCellRange.spanFrom({sheet:e,col:u,row:0},1,1/0);n.dependencyGraph.breakNumericMatricesInRange(c);var l=n.getRangeClipboardCells(c);a=a.concat(l),o.push(l.map((function(e){var t=O(e,2),r=t[0],n=r.sheet,o=(r.col,r.row),a=t[1];return[{sheet:n,col:s,row:o},a]})))}};for(u.s();!(r=u.n()).done;)s()}catch(e){u.e(e)}finally{u.f()}return o.forEach((function(t){return n.restoreClipboardCells(e,t.values())})),a}},{key:"addNamedExpression",value:function(e,t,r,n){this.storeNamedExpressionInCell(this.namedExpressions.lookupNextAddress(e,r),t);var o=this.namedExpressions.addNamedExpression(e,r,n);this.adjustNamedExpressionEdges(o,e,r)}},{key:"restoreNamedExpression",value:function(e,t,r){var n=e.displayName;this.restoreCell(e.address,t);var o=this.namedExpressions.restoreNamedExpression(e,r);this.adjustNamedExpressionEdges(o,n,r)}},{key:"changeNamedExpressionExpression",value:function(e,t,r,n){var o=this.namedExpressions.namedExpressionForScope(e,r);if(!o)throw new g.NamedExpressionDoesNotExistError(e);var a=o.copy();o.options=n;var i=this.getClipboardCell(o.address);return this.storeNamedExpressionInCell(o.address,t),[a,i]}},{key:"removeNamedExpression",value:function(e,t){var r=this.namedExpressions.namedExpressionForScope(e,t);if(!r)throw new g.NamedExpressionDoesNotExistError(e);this.namedExpressions.remove(r.displayName,t);var n=this.getClipboardCell(r.address);if(void 0!==t){var o=this.namedExpressions.workbookNamedExpressionOrPlaceholder(e);this.dependencyGraph.exchangeNode(r.address,o.address)}else this.dependencyGraph.setCellEmpty(r.address);return[r,n]}},{key:"ensureItIsPossibleToMoveCells",value:function(e,t,r,n){if((0,a.invalidSimpleCellAddress)(e)||!(j(t)&&j(r)||function(e,t,r){return 0===e.row&&j(t)&&r===Number.POSITIVE_INFINITY||0===e.col&&j(r)&&t===Number.POSITIVE_INFINITY}(e,t,r))||(0,a.invalidSimpleCellAddress)(n)||!this.sheetMapping.hasSheetWithId(e.sheet)||!this.sheetMapping.hasSheetWithId(n.sheet))throw new g.InvalidArgumentsError("a valid range of cells to move.");var o=i.AbsoluteCellRange.spanFrom(e,t,r),u=i.AbsoluteCellRange.spanFrom(n,t,r);if(u.exceedsSheetSizeLimits(this.config.maxColumns,this.config.maxRows))throw new g.SheetSizeLimitExceededError;if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRange(o))throw new g.SourceLocationHasMatrixError;if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRange(u))throw new g.TargetLocationHasMatrixError}},{key:"restoreClipboardCells",value:function(e,t){var r,n=[],a=C(t);try{for(a.s();!(r=a.n()).done;){var i=O(r.value,2),u=i[0],s=i[1];if(this.restoreCell(u,s),s.type===o.ClipboardCellType.FORMULA){var c=this.parser.fetchCachedResult(s.hash).dependencies;n.push.apply(n,N(this.updateNamedExpressionsForTargetAddress(e,u,c)))}}}catch(e){a.e(e)}finally{a.f()}return n}},{key:"restoreCell",value:function(e,t){switch(t.type){case o.ClipboardCellType.VALUE:this.setValueToCell(t,e);break;case o.ClipboardCellType.FORMULA:this.setFormulaToCellFromCache(t.hash,e);break;case o.ClipboardCellType.EMPTY:this.setCellEmpty(e);break;case o.ClipboardCellType.PARSING_ERROR:this.setParsingErrorToCell(t.rawInput,t.errors,e)}}},{key:"doRemoveRows",value:function(e){var t=this;if(!this.rowEffectivelyNotInSheet(e.rowStart,e.sheet)){var r,n,o=[],a=C(this.dependencyGraph.entriesFromRowsSpan(e));try{for(a.s();!(r=a.n()).done;){var i=O(r.value,1)[0];o.push({address:i,cellType:this.getClipboardCell(i)})}}catch(e){a.e(e)}finally{a.f()}return this.dependencyGraph.removeRows(e),this.stats.measure(A.StatType.TRANSFORM_ASTS,(function(){var r=new m.RemoveRowsTransformer(e);r.performEagerTransformations(t.dependencyGraph,t.parser),n=t.lazilyTransformingAstService.addTransformation(r)})),{version:n,removedCells:o,rowFrom:e.rowStart,rowCount:e.numberOfRows}}}},{key:"doRemoveColumns",value:function(e){var t=this;if(!this.columnEffectivelyNotInSheet(e.columnStart,e.sheet)){var r,n,o=[],a=C(this.dependencyGraph.entriesFromColumnsSpan(e));try{for(a.s();!(r=a.n()).done;){var i=O(r.value,1)[0];o.push({address:i,cellType:this.getClipboardCell(i)})}}catch(e){a.e(e)}finally{a.f()}return this.dependencyGraph.removeColumns(e),this.columnSearch.removeColumns(e),this.stats.measure(A.StatType.TRANSFORM_ASTS,(function(){var r=new d.RemoveColumnsTransformer(e);r.performEagerTransformations(t.dependencyGraph,t.parser),n=t.lazilyTransformingAstService.addTransformation(r)})),{version:n,removedCells:o,columnFrom:e.columnStart,columnCount:e.numberOfColumns}}}},{key:"doAddRows",value:function(e){var t=this;this.rowEffectivelyNotInSheet(e.rowStart,e.sheet)||(this.dependencyGraph.addRows(e),this.stats.measure(A.StatType.TRANSFORM_ASTS,(function(){var r=new p.AddRowsTransformer(e);r.performEagerTransformations(t.dependencyGraph,t.parser),t.lazilyTransformingAstService.addTransformation(r)})))}},{key:"doAddColumns",value:function(e){var t=this;this.columnEffectivelyNotInSheet(e.columnStart,e.sheet)||(this.dependencyGraph.addColumns(e),this.columnSearch.addColumns(e),this.stats.measure(A.StatType.TRANSFORM_ASTS,(function(){var r=new f.AddColumnsTransformer(e);r.performEagerTransformations(t.dependencyGraph,t.parser),t.lazilyTransformingAstService.addTransformation(r)})))}},{key:"getClipboardCell",value:function(e){var t=this.dependencyGraph.getCell(e);if(null===t||t instanceof l.EmptyCellVertex)return{type:o.ClipboardCellType.EMPTY};if(t instanceof l.ValueCellVertex)return Object.assign({type:o.ClipboardCellType.VALUE},t.getValues());if(t instanceof l.MatrixVertex)return{type:o.ClipboardCellType.VALUE,parsedValue:t.getMatrixCellValue(e),rawValue:t.getMatrixCellRawValue(e)};if(t instanceof l.FormulaCellVertex)return{type:o.ClipboardCellType.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))};if(t instanceof l.ParsingErrorVertex)return{type:o.ClipboardCellType.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors};throw Error("Trying to copy unsupported type")}},{key:"getSheetClipboardCells",value:function(e){for(var t=this.dependencyGraph.getSheetHeight(e),r=this.dependencyGraph.getSheetWidth(e),n=new Array(t),o=0;o<t;o++){n[o]=new Array(r);for(var i=0;i<r;i++){var u=(0,a.simpleCellAddress)(e,i,o);n[o][i]=this.getClipboardCell(u)}}return n}},{key:"getRangeClipboardCells",value:function(e){var t,r=[],n=C(e.addresses(this.dependencyGraph));try{for(n.s();!(t=n.n()).done;){var o=t.value;r.push([o,this.getClipboardCell(o)])}}catch(e){n.e(e)}finally{n.f()}return r}},{key:"setCellContent",value:function(e,t){var r=this.cellContentParser.parse(t),o=this.dependencyGraph.getCell(e);if(!(o instanceof l.MatrixVertex)||o.isFormula()||r instanceof s.CellContent.Number||(this.dependencyGraph.breakNumericMatrix(o),o=this.dependencyGraph.getCell(e)),o instanceof l.MatrixVertex&&!o.isFormula()&&r instanceof s.CellContent.Number){var a=r.value,i=this.dependencyGraph.getCellValue(e);this.dependencyGraph.graph.markNodeAsSpecialRecentlyChanged(o),o.setMatrixCellValue(e,(0,n.getRawValue)(a)),this.columnSearch.change((0,n.getRawValue)(i),(0,n.getRawValue)(a),e),this.changes.addChange(a,e)}else if(!(o instanceof l.MatrixVertex)&&r instanceof s.CellContent.MatrixFormula){var c=this.parser.parse(r.formula,e),f=c.ast,p=c.errors,h=c.dependencies;if(p.length>0)this.dependencyGraph.setParsingErrorToCell(e,new l.ParsingErrorVertex(p,r.formulaWithBraces()));else{var d=(0,v.buildMatrixVertex)(f,e);if(d instanceof l.ValueCellVertex)throw Error("What if new matrix vertex is not properly constructed?");this.dependencyGraph.addNewMatrixVertex(d),this.dependencyGraph.processCellDependencies((0,u.absolutizeDependencies)(h,e),d),this.dependencyGraph.graph.markNodeAsSpecialRecentlyChanged(d)}}else{if(o instanceof l.MatrixVertex)throw new Error("Illegal operation");if(r instanceof s.CellContent.Formula){var m=this.parser.parse(r.formula,e),y=m.ast,g=m.errors,E=m.hasVolatileFunction,T=m.hasStructuralChangeFunction,b=m.dependencies;g.length>0?this.dependencyGraph.setParsingErrorToCell(e,new l.ParsingErrorVertex(g,r.formula)):this.dependencyGraph.setFormulaToCell(e,y,(0,u.absolutizeDependencies)(b,e),E,T)}else if(r instanceof s.CellContent.Empty)this.setCellEmpty(e);else{if(r instanceof s.CellContent.MatrixFormula)throw new Error("Cant happen");this.setValueToCell({parsedValue:r.value,rawValue:t},e)}}}},{key:"setSheetContent",value:function(e,t){this.clearSheet(e);for(var r=0;r<t.length;r++)for(var n=0;n<t[r].length;n++){var o=(0,a.simpleCellAddress)(e,n,r);this.setCellContent(o,t[r][n])}}},{key:"setValueToCell",value:function(e,t){var r=this.dependencyGraph.getCellValue(t);this.dependencyGraph.setValueToCell(t,e),this.columnSearch.change((0,n.getRawValue)(r),(0,n.getRawValue)(e.parsedValue),t),this.changes.addChange(e.parsedValue,t)}},{key:"setCellEmpty",value:function(e){var t=this.dependencyGraph.getCellValue(e);this.columnSearch.remove((0,n.getRawValue)(t),e),this.changes.addChange(n.EmptyValue,e),this.dependencyGraph.setCellEmpty(e)}},{key:"setFormulaToCellFromCache",value:function(e,t){var r=this.parser.fetchCachedResult(e),n=r.ast,o=r.hasVolatileFunction,a=r.hasStructuralChangeFunction,i=r.dependencies,s=(0,u.absolutizeDependencies)(i,t),c=O(new S.CleanOutOfScopeDependenciesTransformer(t.sheet).transformSingleAst(n,t),1)[0];this.parser.rememberNewAst(c);var l=(0,u.filterDependenciesOutOfScope)(s);this.dependencyGraph.setFormulaToCell(t,c,l,o,a)}},{key:"setParsingErrorToCell",value:function(e,t,r){this.dependencyGraph.setParsingErrorToCell(r,new l.ParsingErrorVertex(t,e))}},{key:"rowEffectivelyNotInSheet",value:function(e,t){return e>=this.dependencyGraph.addressMapping.getHeight(t)}},{key:"getAndClearContentChanges",value:function(){var e=this.changes;return this.changes=c.ContentChanges.empty(),e}},{key:"forceApplyPostponedTransformations",value:function(){this.dependencyGraph.forceApplyPostponedTransformations()}},{key:"sheetMapping",get:function(){return this.dependencyGraph.sheetMapping}},{key:"columnEffectivelyNotInSheet",value:function(e,t){return e>=this.dependencyGraph.addressMapping.getWidth(t)}},{key:"adjustNamedExpressionEdges",value:function(e,t,r){if(void 0!==r){var n,o=this.dependencyGraph.fetchCellOrCreateEmpty(e.address),a=this.namedExpressions.workbookNamedExpressionOrPlaceholder(t),i=this.dependencyGraph.fetchCellOrCreateEmpty(a.address),s=C(this.dependencyGraph.graph.adjacentNodes(i));try{for(s.s();!(n=s.n()).done;){var c=n.value;if(c instanceof l.FormulaCellVertex&&c.cellAddress.sheet===r){var f,p=c.getFormula(this.lazilyTransformingAstService),h=c.getAddress(this.lazilyTransformingAstService),d=this.parser.fetchCachedResultForAst(p).dependencies,m=C((0,u.absolutizeDependencies)(d,h));try{for(m.s();!(f=m.n()).done;){var y=f.value;y instanceof T.NamedExpressionDependency&&y.name.toLowerCase()===e.displayName.toLowerCase()&&(this.dependencyGraph.graph.removeEdge(i,c),this.dependencyGraph.graph.addEdge(o,c))}}catch(e){m.e(e)}finally{m.f()}}}}catch(e){s.e(e)}finally{s.f()}}}},{key:"storeNamedExpressionInCell",value:function(e,t){var r=this.cellContentParser.parse(t);if(r instanceof s.CellContent.MatrixFormula)throw new Error("Matrix formulas are not supported");if(r instanceof s.CellContent.Formula){var n=this.parser.parse(r.formula,(0,a.simpleCellAddress)(-1,0,0));if((0,E.doesContainRelativeReferences)(n.ast))throw new g.NoRelativeAddressesAllowedError;var o=n.ast,i=n.hasVolatileFunction,c=n.hasStructuralChangeFunction,l=n.dependencies;this.dependencyGraph.setFormulaToCell(e,o,(0,u.absolutizeDependencies)(l,e),i,c)}else r instanceof s.CellContent.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:r.value,rawValue:t},e)}},{key:"updateNamedExpressionsForMovedCells",value:function(e,t,r,n){if(e.sheet===n.sheet)return[];var o,a=[],u=C(i.AbsoluteCellRange.spanFrom(n,t,r).addresses(this.dependencyGraph));try{for(u.s();!(o=u.n()).done;){var s=o.value,c=this.addressMapping.fetchCell(s);if(c instanceof l.FormulaCellVertex&&s.sheet!==e.sheet){var f=c.getFormula(this.lazilyTransformingAstService),p=this.parser.fetchCachedResultForAst(f).dependencies;a.push.apply(a,N(this.updateNamedExpressionsForTargetAddress(e.sheet,s,p)))}}}catch(e){u.e(e)}finally{u.f()}return a}},{key:"updateNamedExpressionsForTargetAddress",value:function(e,t,r){if(e===t.sheet)return[];var n,o=[],a=this.addressMapping.fetchCell(t),i=C((0,u.absolutizeDependencies)(r,t));try{for(i.s();!(n=i.n()).done;){var s=n.value;if(s instanceof T.NamedExpressionDependency){var c=s.name,l=this.dependencyGraph.fetchNamedExpressionVertex(c,e),f=this.namedExpressions.isExpressionInScope(c,t.sheet)?this.dependencyGraph.fetchNamedExpressionVertex(c,t.sheet):this.copyOrFetchGlobalNamedExpressionVertex(c,l,o);f!==l&&(this.dependencyGraph.graph.softRemoveEdge(l,a),this.dependencyGraph.graph.addEdge(f,a))}}}catch(e){i.e(e)}finally{i.f()}return o}},{key:"allocateNamedExpressionAddressSpace",value:function(){this.dependencyGraph.addressMapping.addSheet(-1,new l.SparseStrategy(0,0))}},{key:"copyOrFetchGlobalNamedExpressionVertex",value:function(e,t,r){var n=this.namedExpressions.namedExpressionForScope(e);if(void 0===n)if(n=this.namedExpressions.addNamedExpression(e),r.push(n.normalizeExpressionName()),t instanceof l.FormulaCellVertex){var o=this.parser.fetchCachedResultForAst(t.getFormula(this.lazilyTransformingAstService)),a=o.ast,i=o.hasVolatileFunction,s=o.hasStructuralChangeFunction,c=o.dependencies;this.dependencyGraph.setFormulaToCell(n.address,a,(0,u.absolutizeDependencies)(c,n.address),i,s)}else t instanceof l.EmptyCellVertex?this.setCellEmpty(n.address):t instanceof l.ValueCellVertex&&this.setValueToCell(t.getValues(),n.address);return this.dependencyGraph.fetchCellOrCreateEmpty(n.address)}},{key:"addressMapping",get:function(){return this.dependencyGraph.addressMapping}}]),e}();function V(e){if(e.length<=1)return e;for(var t=N(e).sort((function(e,t){return O(e,1)[0]-O(t,1)[0]})),r=t.reduce((function(e,t){var r=O(t,2),n=r[0],o=r[1],a=e[e.length-1],i=a[0]+a[1];return n<=i?a[1]+=Math.max(0,o-(i-n)):e.push([n,o]),e}),[t[0]]),n=0,o=0;o<r.length;++o)r[o][0]-=n,n+=r[o][1];return r}function D(e){if(e.length<=1)return e;for(var t=N(e).sort((function(e,t){return O(e,1)[0]-O(t,1)[0]})),r=t.reduce((function(e,t){var r=O(t,2),n=r[0],o=r[1],a=e[e.length-1];return n===a[0]?a[1]=Math.max(a[1],o):e.push([n,o]),e}),[t[0]]),n=0,o=0;o<r.length;++o)r[o][0]+=n,n+=r[o][1];return r}function j(e){return Number.isInteger(e)&&e>0}t.Operations=U},function(e,t,r){"use strict";t.__esModule=!0,t.ClipboardOperations=t.ClipboardCellType=void 0,r(120);var n,o,a=r(135),i=r(115),u=r(231);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),e}!function(e){e[e.COPY=0]="COPY",e[e.CUT=1]="CUT"}(n||(n={})),t.ClipboardCellType=o,function(e){e[e.VALUE=0]="VALUE",e[e.EMPTY=1]="EMPTY",e[e.FORMULA=2]="FORMULA",e[e.PARSING_ERROR=3]="PARSING_ERROR"}(o||(t.ClipboardCellType=o={}));var f=function(){function e(t,r,n,o,a){s(this,e),this.sourceLeftCorner=t,this.width=r,this.height=n,this.type=o,this.content=a}return l(e,[{key:"getContent",value:regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.content){e.next=4;break}return e.abrupt("return");case 4:r=0;case 5:if(!(r<this.height)){e.next=16;break}n=0;case 7:if(!(n<this.width)){e.next=13;break}return e.next=10,[(0,i.simpleCellAddress)(t.sheet,t.col+n,t.row+r),this.content[r][n]];case 10:++n,e.next=7;break;case 13:++r,e.next=5;break;case 16:case"end":return e.stop()}}),e,this)}))}]),e}(),p=function(){function e(t,r,n,o,a){s(this,e),this.dependencyGraph=t,this.operations=r,this.parser=n,this.lazilyTransformingAstService=o,this.config=a}return l(e,[{key:"cut",value:function(e,t,r){this.clipboard=new f(e,t,r,n.CUT)}},{key:"copy",value:function(e,t,r){for(var o=[],a=0;a<r;++a){o[a]=[];for(var u=0;u<t;++u){var s=this.operations.getClipboardCell((0,i.simpleCellAddress)(e.sheet,e.col+u,e.row+a));o[a].push(s)}}this.clipboard=new f(e,t,r,n.COPY,o)}},{key:"abortCut",value:function(){this.clipboard&&this.clipboard.type===n.CUT&&this.clear()}},{key:"clear",value:function(){this.clipboard=void 0}},{key:"ensureItIsPossibleToCopyPaste",value:function(e){if(void 0!==this.clipboard){if((0,i.invalidSimpleCellAddress)(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new u.InvalidArgumentsError("a valid target address.");var t=a.AbsoluteCellRange.spanFrom(e,this.clipboard.width,this.clipboard.height);if(t.exceedsSheetSizeLimits(this.config.maxColumns,this.config.maxRows))throw new u.SheetSizeLimitExceededError;if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRange(t))throw new Error("It is not possible to paste onto matrix")}}},{key:"isCutClipboard",value:function(){return void 0!==this.clipboard&&this.clipboard.type===n.CUT}},{key:"isCopyClipboard",value:function(){return void 0!==this.clipboard&&this.clipboard.type===n.COPY}}]),e}();t.ClipboardOperations=p},function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r(87),r(93),r(63),r(94),r(95),r(77),r(97),r(68),r(53),r(67),t.__esModule=!0,t.ContentChanges=void 0,r(126);
/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */
var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.changes=[]}var t,r,i;return t=e,i=[{key:"empty",value:function(){return new e}}],(r=[{key:"addAll",value:function(e){var t;return(t=this.changes).push.apply(t,o(e.changes)),this}},{key:"addMatrixChange",value:function(e,t){var r,o=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=a(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return u=e.done,e},e:function(e){s=!0,i=e},f:function(){try{u||null==r.return||r.return()}finally{if(s)throw i}}}}(e.generateValues(t));try{for(o.s();!(r=o.n()).done;){var i=n(r.value,2),u=i[0],s=i[1];this.addSingleCellValue(u,s)}}catch(e){o.e(e)}finally{o.f()}}},{key:"addChange",value:function(e,t){this.addSingleCellValue(e,t)}},{key:"add",value:function(){var e;(e=this.changes).push.apply(e,arguments)}},{key:"exportChanges",value:function(e){var t=this,r=[];return this.changes.forEach((function(n,o){r[o]=e.exportChange(t.changes[o])})),r}},{key:"getChanges",value:function(){return this.changes}},{key:"isEmpty",value:function(){return this.changes===[]}},{key:"addSingleCellValue",value:function(e,t){this.add({sheet:t.sheet,col:t.col,row:t.row,value:e})}}])&&u(t.prototype,r),i&&u(t,i),e}();t.ContentChanges=s},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.AddColumnsTransformer=void 0,r(116),r(109);var o=r(115);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var o=c(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return s(this,r)}}function s(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(c,e);var t,r,n,s=u(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=s.call(this)).columnsSpan=e,t}return t=c,(r=[{key:"sheet",get:function(){return this.columnsSpan.sheet}},{key:"isIrreversible",value:function(){return!1}},{key:"transformRowRangeAst",value:function(e,t){return e}},{key:"transformCellRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformRowRange",value:function(e,t,r){throw Error("Not implemented")}},{key:"transformColumnRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformCellAddress",value:function(e,t){var r=(0,o.absoluteSheetReference)(e,t);if(r!==this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return!1;var n=e.toSimpleColumnAddress(t);return r===this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet?this.columnsSpan.columnStart<=n.col&&e.shiftedByColumns(this.columnsSpan.numberOfColumns):t.sheet===this.columnsSpan.sheet&&r!==this.columnsSpan.sheet?!e.isColumnAbsolute()&&!(t.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(-this.columnsSpan.numberOfColumns):e.isColumnAbsolute()?!(e.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(this.columnsSpan.numberOfColumns):e.toSimpleColumnAddress(t).col<this.columnsSpan.columnStart?!(t.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(-this.columnsSpan.numberOfColumns):t.col<this.columnsSpan.columnStart&&e.shiftedByColumns(this.columnsSpan.numberOfColumns)}},{key:"fixNodeAddress",value:function(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col+this.columnsSpan.numberOfColumns}):e}},{key:"transformRange",value:function(e,t,r){var n=this.transformCellAddress(e,r),a=this.transformCellAddress(t,r);return n===o.ErrorType.REF||a===o.ErrorType.REF?o.ErrorType.REF:!(!n&&!a)&&[n||e,a||t]}}])&&a(t.prototype,r),n&&a(t,n),c}(r(277).Transformer);t.AddColumnsTransformer=l},function(e,t,r){"use strict";r(53),r(63),r(67),r(68),r(77),r(87),r(93),r(94),r(95),r(97),t.__esModule=!0,t.Transformer=void 0,r(116),r(121);var n=r(115),o=r(141);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||i(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,u;return t=e,(r=[{key:"performEagerTransformations",value:function(e,t){var r,n=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=i(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return u=e.done,e},e:function(e){s=!0,a=e},f:function(){try{u||null==r.return||r.return()}finally{if(s)throw a}}}}(e.matrixFormulaNodes());try{for(n.s();!(r=n.n()).done;){var o=r.value,u=a(this.transformSingleAst(o.getFormula(),o.getAddress()),2),s=u[0],c=u[1],l=t.rememberNewAst(s);o.setFormula(l),o.setAddress(c)}}catch(e){n.e(e)}finally{n.f()}}},{key:"transformSingleAst",value:function(e,t){return[this.transformAst(e,t),this.fixNodeAddress(t)]}},{key:"transformAst",value:function(e,t){var r=this;switch(e.type){case o.AstNodeType.CELL_REFERENCE:return this.transformCellReferenceAst(e,t);case o.AstNodeType.CELL_RANGE:return this.transformCellRangeAst(e,t);case o.AstNodeType.COLUMN_RANGE:return this.transformColumnRangeAst(e,t);case o.AstNodeType.ROW_RANGE:return this.transformRowRangeAst(e,t);case o.AstNodeType.EMPTY:case o.AstNodeType.ERROR:case o.AstNodeType.NUMBER:case o.AstNodeType.NAMED_EXPRESSION:case o.AstNodeType.ERROR_WITH_RAW_INPUT:case o.AstNodeType.STRING:return e;case o.AstNodeType.PERCENT_OP:case o.AstNodeType.MINUS_UNARY_OP:case o.AstNodeType.PLUS_UNARY_OP:return Object.assign(Object.assign({},e),{type:e.type,value:this.transformAst(e.value,t)});case o.AstNodeType.FUNCTION_CALL:return Object.assign(Object.assign({},e),{type:e.type,procedureName:e.procedureName,args:e.args.map((function(e){return r.transformAst(e,t)}))});case o.AstNodeType.PARENTHESIS:return Object.assign(Object.assign({},e),{type:e.type,expression:this.transformAst(e.expression,t)});default:return Object.assign(Object.assign({},e),{type:e.type,left:this.transformAst(e.left,t),right:this.transformAst(e.right,t)})}}},{key:"transformCellReferenceAst",value:function(e,t){var r=this.transformCellAddress(e.reference,t);return r instanceof o.CellAddress?Object.assign(Object.assign({},e),{reference:r}):r===n.ErrorType.REF?(0,o.buildCellErrorAst)(new n.CellError(n.ErrorType.REF)):e}},{key:"transformCellRangeAst",value:function(e,t){var r=this.transformCellRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===n.ErrorType.REF?(0,o.buildCellErrorAst)(new n.CellError(n.ErrorType.REF)):e}},{key:"transformColumnRangeAst",value:function(e,t){var r=this.transformColumnRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===n.ErrorType.REF?(0,o.buildCellErrorAst)(new n.CellError(n.ErrorType.REF)):e}},{key:"transformRowRangeAst",value:function(e,t){var r=this.transformRowRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===n.ErrorType.REF?(0,o.buildCellErrorAst)(new n.CellError(n.ErrorType.REF)):e}}])&&s(t.prototype,r),u&&s(t,u),e}();t.Transformer=c},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.AddRowsTransformer=void 0,r(116),r(109);var o=r(115);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var o=c(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return s(this,r)}}function s(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(c,e);var t,r,n,s=u(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=s.call(this)).rowsSpan=e,t}return t=c,(r=[{key:"sheet",get:function(){return this.rowsSpan.sheet}},{key:"isIrreversible",value:function(){return!1}},{key:"transformColumnRangeAst",value:function(e,t){return e}},{key:"transformCellRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformRowRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformColumnRange",value:function(e,t,r){throw Error("Not implemented")}},{key:"transformCellAddress",value:function(e,t){var r=(0,o.absoluteSheetReference)(e,t);if(r!==this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet)return!1;var n=e.toSimpleRowAddress(t);return r===this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet?this.rowsSpan.rowStart<=n.row&&e.shiftedByRows(this.rowsSpan.numberOfRows):t.sheet===this.rowsSpan.sheet&&r!==this.rowsSpan.sheet?!e.isRowAbsolute()&&!(t.row<this.rowsSpan.rowStart)&&e.shiftedByRows(-this.rowsSpan.numberOfRows):e.isRowAbsolute()?!(e.row<this.rowsSpan.rowStart)&&e.shiftedByRows(this.rowsSpan.numberOfRows):n.row<this.rowsSpan.rowStart?!(t.row<this.rowsSpan.rowStart)&&e.shiftedByRows(-this.rowsSpan.numberOfRows):t.row<this.rowsSpan.rowStart&&e.shiftedByRows(this.rowsSpan.numberOfRows)}},{key:"fixNodeAddress",value:function(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row+this.rowsSpan.numberOfRows}):e}},{key:"transformRange",value:function(e,t,r){var n=this.transformCellAddress(e,r),a=this.transformCellAddress(t,r);return n===o.ErrorType.REF||a===o.ErrorType.REF?o.ErrorType.REF:!(!n&&!a)&&[n||e,a||t]}}])&&a(t.prototype,r),n&&a(t,n),c}(r(277).Transformer);t.AddRowsTransformer=l},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.MoveCellsTransformer=void 0,r(109);var o=r(277),a=r(141),i=r(115),u=r(204);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),e}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m(e);if(t){var o=m(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d(this,r)}}function d(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=function(e){f(r,e);var t=h(r);function r(e,n,o,a){var i;return s(this,r),(i=t.call(this)).sourceRange=e,i.toRight=n,i.toBottom=o,i.toSheet=a,i.dependentFormulaTransformer=new g(e,n,o,a),i}return l(r,[{key:"isIrreversible",value:function(){return!0}},{key:"sheet",get:function(){return this.sourceRange.sheet}},{key:"transformSingleAst",value:function(e,t){return this.sourceRange.addressInRange(t)?[this.transformAst(e,t),this.fixNodeAddress(t)]:this.dependentFormulaTransformer.transformSingleAst(e,t)}},{key:"fixNodeAddress",value:function(e){return(0,i.simpleCellAddress)(this.toSheet,e.col+this.toRight,e.row+this.toBottom)}},{key:"transformCellAddress",value:function(e,t){return this.transformAddress(e,t)}},{key:"transformCellRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformColumnRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformRowRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformAddress",value:function(e,t){var r=this.sourceRange;if(e instanceof a.CellAddress){var n=e.toSimpleCellAddress(t);if(r.addressInRange(n))return e.shiftAbsoluteDimensions(this.toRight,this.toBottom)}return e.shiftRelativeDimensions(-this.toRight,-this.toBottom)}},{key:"transformRange",value:function(e,t,r){var n=this.sourceRange;if(e instanceof a.CellAddress&&t instanceof a.CellAddress){var o=e.toSimpleCellAddress(r),i=t.toSimpleCellAddress(r);if(n.addressInRange(o)&&n.addressInRange(i))return[e.shiftAbsoluteDimensions(this.toRight,this.toBottom),t.shiftAbsoluteDimensions(this.toRight,this.toBottom)]}return[e.shiftRelativeDimensions(-this.toRight,-this.toBottom),t.shiftRelativeDimensions(-this.toRight,-this.toBottom)]}}]),r}(o.Transformer);t.MoveCellsTransformer=y;var g=function(e){f(r,e);var t=h(r);function r(e,n,o,a){var i;return s(this,r),(i=t.call(this)).sourceRange=e,i.toRight=n,i.toBottom=o,i.toSheet=a,i}return l(r,[{key:"sheet",get:function(){return this.sourceRange.sheet}},{key:"isIrreversible",value:function(){return!0}},{key:"fixNodeAddress",value:function(e){return e}},{key:"transformCellAddress",value:function(e,t){return!!this.shouldMove(e,t)&&e.moved(this.toSheet,this.toRight,this.toBottom)}},{key:"shouldMove",value:function(e,t){return e instanceof a.CellAddress?this.sourceRange.addressInRange(e.toSimpleCellAddress(t)):e instanceof u.RowAddress?this.sourceRange.rowInRange(e.toSimpleRowAddress(t))&&!this.sourceRange.isFinite():this.sourceRange.columnInRange(e.toSimpleColumnAddress(t))&&!this.sourceRange.isFinite()}},{key:"transformCellRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformColumnRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformRowRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformRange",value:function(e,t,r){var n=this.transformCellAddress(e,r),o=this.transformCellAddress(t,r);return!(!n||!o)&&[n,o]}}]),r}(o.Transformer)},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.RemoveColumnsTransformer=void 0,r(116),r(109);var o=r(115);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var o=c(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return s(this,r)}}function s(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(c,e);var t,r,n,s=u(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=s.call(this)).columnsSpan=e,t}return t=c,(r=[{key:"isIrreversible",value:function(){return!0}},{key:"sheet",get:function(){return this.columnsSpan.sheet}},{key:"transformRowRangeAst",value:function(e,t){return e}},{key:"transformCellRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformRowRange",value:function(e,t,r){throw Error("Not implemented")}},{key:"transformColumnRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformCellAddress",value:function(e,t){var r=(0,o.absoluteSheetReference)(e,t);if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet!==r)return!1;if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet===r){var n=e.toSimpleColumnAddress(t);if(n.col<this.columnsSpan.columnStart)return!1;if(n.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet!==r){if(e.isColumnAbsolute())return!1;if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet===r)if(e.isColumnAbsolute()){if(e.col<this.columnsSpan.columnStart)return!1;if(e.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else{var a=e.toSimpleColumnAddress(t);if(a.col<this.columnsSpan.columnStart){if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}else if(a.col>this.columnsSpan.columnEnd){if(t.col<this.columnsSpan.columnStart)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(t.col>this.columnsSpan.columnEnd)return!1}}return o.ErrorType.REF}},{key:"fixNodeAddress",value:function(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col-this.columnsSpan.numberOfColumns}):e}},{key:"transformRange",value:function(e,t,r){var n=(0,o.absoluteSheetReference)(e,r),a=e,i=t;if(this.columnsSpan.sheet===n){var u=e.toSimpleColumnAddress(r),s=t.toSimpleColumnAddress(r);if(this.columnsSpan.columnStart<=u.col&&this.columnsSpan.columnEnd>=s.col)return o.ErrorType.REF;u.col>=this.columnsSpan.columnStart&&u.col<=this.columnsSpan.columnEnd&&(a=e.shiftedByColumns(this.columnsSpan.columnEnd-u.col+1)),s.col>=this.columnsSpan.columnStart&&s.col<=this.columnsSpan.columnEnd&&(i=t.shiftedByColumns(-(s.col-this.columnsSpan.columnStart+1)))}var c=this.transformCellAddress(a,r),l=this.transformCellAddress(i,r);if(!1===c&&!1===l)return[a,i];if(c===o.ErrorType.REF||l===o.ErrorType.REF)throw Error("Cannot happen");return[c||a,l||i]}}])&&a(t.prototype,r),n&&a(t,n),c}(r(277).Transformer);t.RemoveColumnsTransformer=l},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.RemoveRowsTransformer=void 0,r(116),r(109);var o=r(115);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var o=c(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return s(this,r)}}function s(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(c,e);var t,r,n,s=u(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=s.call(this)).rowsSpan=e,t}return t=c,(r=[{key:"sheet",get:function(){return this.rowsSpan.sheet}},{key:"isIrreversible",value:function(){return!0}},{key:"transformColumnRangeAst",value:function(e,t){return e}},{key:"transformCellAddress",value:function(e,t){var r=(0,o.absoluteSheetReference)(e,t);if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet!==r)return!1;if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet===r){var n=e.toSimpleRowAddress(t);if(n.row<this.rowsSpan.rowStart)return!1;if(n.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet!==r){if(e.isRowAbsolute())return!1;if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet===r)if(e.isRowAbsolute()){if(e.row<this.rowsSpan.rowStart)return!1;if(e.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}else{var a=e.toSimpleRowAddress(t);if(a.row<this.rowsSpan.rowStart){if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}else if(a.row>this.rowsSpan.rowEnd){if(t.row<this.rowsSpan.rowStart)return e.shiftedByRows(-this.rowsSpan.numberOfRows);if(t.row>this.rowsSpan.rowEnd)return!1}}return o.ErrorType.REF}},{key:"transformCellRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformRowRange",value:function(e,t,r){return this.transformRange(e,t,r)}},{key:"transformColumnRange",value:function(e,t,r){throw Error("Not implemented")}},{key:"fixNodeAddress",value:function(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row-this.rowsSpan.numberOfRows}):e}},{key:"transformRange",value:function(e,t,r){var n=(0,o.absoluteSheetReference)(e,r),a=e,i=t;if(this.rowsSpan.sheet===n){var u=e.toSimpleRowAddress(r),s=t.toSimpleRowAddress(r);if(this.rowsSpan.rowStart<=u.row&&this.rowsSpan.rowEnd>=s.row)return o.ErrorType.REF;u.row>=this.rowsSpan.rowStart&&u.row<=this.rowsSpan.rowEnd&&(a=e.shiftedByRows(this.rowsSpan.rowEnd-u.row+1)),s.row>=this.rowsSpan.rowStart&&s.row<=this.rowsSpan.rowEnd&&(i=t.shiftedByRows(-(s.row-this.rowsSpan.rowStart+1)))}var c=this.transformCellAddress(a,r),l=this.transformCellAddress(i,r);if(!1===c&&!1===l)return[a,i];if(c===o.ErrorType.REF||l===o.ErrorType.REF)throw Error("Cannot happen");return[c||a,l||i]}}])&&a(t.prototype,r),n&&a(t,n),c}(r(277).Transformer);t.RemoveRowsTransformer=l},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(53),r(63),r(67),r(68),r(77),r(87),r(93),r(94),r(95),r(97),t.__esModule=!0,t.RemoveSheetTransformer=void 0,r(109);var o=r(277),a=r(115);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h(e);if(t){var o=h(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(s,e);var t,r,n,o=f(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=o.call(this)).sheet=e,t}return t=s,(r=[{key:"isIrreversible",value:function(){return!0}},{key:"performEagerTransformations",value:function(e,t){var r,n=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=u(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}(e.matrixFormulaNodes());try{for(n.s();!(r=n.n()).done;){var o=r.value,a=i(this.transformSingleAst(o.getFormula(),o.getAddress()),1)[0];o.setFormula(a)}}catch(e){n.e(e)}finally{n.f()}}},{key:"fixNodeAddress",value:function(e){return e}},{key:"transformCellAddress",value:function(e,t){return this.transformAddress(e)}},{key:"transformCellRange",value:function(e,t,r){return this.transformAddress(e)}},{key:"transformColumnRange",value:function(e,t,r){return this.transformAddress(e)}},{key:"transformRowRange",value:function(e,t,r){return this.transformAddress(e)}},{key:"transformAddress",value:function(e){return e.sheet===this.sheet&&a.ErrorType.REF}}])&&c(t.prototype,r),n&&c(t,n),s}(o.Transformer);t.RemoveSheetTransformer=d},function(e,t,r){"use strict";r(53),r(67),r(68),r(87),r(93),r(94),t.__esModule=!0,t.buildMatrixVertex=E,t.MatrixDetectionStrategy=t.SimpleStrategy=t.GraphBuilder=void 0,r(126),r(95),r(210),r(63),r(77),r(97),r(239),r(138);var n=r(220),o=r(115),a=r(270),i=r(223),u=r(118),s=r(284),c=r(235),l=r(224);function f(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function m(e,t,r){return t&&d(e.prototype,t),r&&d(e,r),e}var y=function(){function e(t,r,n,o,a,i){h(this,e),this.dependencyGraph=t,this.columnSearch=r,this.parser=n,this.cellContentParser=o,this.config=a,this.stats=i,this.config.matrixDetection?this.buildStrategy=new v(this.dependencyGraph,this.columnSearch,this.parser,this.stats,a.matrixDetectionThreshold,this.cellContentParser):this.buildStrategy=new g(this.dependencyGraph,this.columnSearch,this.parser,this.stats,this.cellContentParser)}return m(e,[{key:"buildGraph",value:function(e){var t=this.buildStrategy.run(e);this.processDependencies(t)}},{key:"processDependencies",value:function(e){var t=this;e.forEach((function(e,r){t.dependencyGraph.processCellDependencies(e,r)}))}}]),e}();t.GraphBuilder=y;var g=function(){function e(t,r,n,o,a){h(this,e),this.dependencyGraph=t,this.columnIndex=r,this.parser=n,this.stats=o,this.cellContentParser=a}return m(e,[{key:"run",value:function(e){var t=this,r=new Map;for(var s in e)for(var c=this.dependencyGraph.getSheetId(s),f=e[s],p=0;p<f.length;++p)for(var h=f[p],d=function(e){var s=h[e],f=(0,o.simpleCellAddress)(c,e,p),d=t.cellContentParser.parse(s);if(d instanceof a.CellContent.MatrixFormula){if(t.dependencyGraph.existsVertex(f))return"continue";var m=t.stats.measure(l.StatType.PARSER,(function(){return t.parser.parse(d.formula,f)}));if(m.errors.length>0){var y=new u.ParsingErrorVertex(m.errors,d.formulaWithBraces());t.dependencyGraph.addVertex(f,y)}else{var g=E(m.ast,f);r.set(g,(0,n.absolutizeDependencies)(m.dependencies,f)),t.dependencyGraph.addMatrixVertex(f,g)}}else if(d instanceof a.CellContent.Formula){var v=t.stats.measure(l.StatType.PARSER,(function(){return t.parser.parse(d.formula,f)}));if(v.errors.length>0){var T=new u.ParsingErrorVertex(v.errors,d.formula);t.dependencyGraph.addVertex(f,T)}else{var b=new u.FormulaCellVertex(v.ast,f,0);r.set(b,(0,n.absolutizeDependencies)(v.dependencies,f)),t.dependencyGraph.addVertex(f,b),v.hasVolatileFunction&&t.dependencyGraph.markAsVolatile(b),v.hasStructuralChangeFunction&&t.dependencyGraph.markAsDependentOnStructureChange(b)}}else if(d instanceof a.CellContent.Empty);else{var R=new u.ValueCellVertex(d.value,s);t.columnIndex.add((0,i.getRawValue)(d.value),f),t.dependencyGraph.addVertex(f,R)}},m=0;m<h.length;++m)d(m);return r}}]),e}();t.SimpleStrategy=g;var v=function(){function e(t,r,n,o,a,i){h(this,e),this.dependencyGraph=t,this.columnSearch=r,this.parser=n,this.stats=o,this.threshold=a,this.cellContentParser=i}return m(e,[{key:"run",value:function(e){var t=this,r=new Map,i=new s.GraphBuilderMatrixHeuristic(this.dependencyGraph,this.columnSearch,this.threshold,this.cellContentParser);for(var c in e){var p=this.dependencyGraph.getSheetId(c),h=e[c];i.addSheet(p,{width:this.dependencyGraph.getSheetWidth(p),height:this.dependencyGraph.getSheetHeight(p)});for(var d=0;d<h.length;++d)for(var m=h[d],y=function(e){var s=m[e],c=(0,o.simpleCellAddress)(p,e,d),f=t.cellContentParser.parse(s);if(f instanceof a.CellContent.MatrixFormula){if(t.dependencyGraph.existsVertex(c))return"continue";var h=t.stats.measure(l.StatType.PARSER,(function(){return t.parser.parse(f.formula,c)}));if(h.errors.length>0){var y=new u.ParsingErrorVertex(h.errors,f.formulaWithBraces());t.dependencyGraph.addVertex(c,y)}else{var g=E(h.ast,c);r.set(g,(0,n.absolutizeDependencies)(h.dependencies,c)),t.dependencyGraph.addMatrixVertex(c,g)}}else if(f instanceof a.CellContent.Formula){var v=t.stats.measure(l.StatType.PARSER,(function(){return t.parser.parse(f.formula,c)}));if(v.errors.length>0){var T=new u.ParsingErrorVertex(v.errors,f.formula);t.dependencyGraph.addVertex(c,T)}else{var b=new u.FormulaCellVertex(v.ast,c,0);r.set(b,(0,n.absolutizeDependencies)(v.dependencies,c)),t.dependencyGraph.addVertex(c,b)}}else if(f instanceof a.CellContent.Empty);else if(f instanceof a.CellContent.Number)i.add(c);else{var R=new u.ValueCellVertex(f.value,s);t.columnSearch.add(f.value,c),t.dependencyGraph.addVertex(c,R)}},g=0;g<m.length;++g)y(g)}this.stats.start(l.StatType.MATRIX_DETECTION);for(var v=i.run(e),T=v.length-1;T>=0;--T){var b=v[T];b.cells.reverse();var R,A=f(b.cells);try{for(A.s();!(R=A.n()).done;){var S=R.value,N=e[this.dependencyGraph.getSheetName(S.sheet)][S.row][S.col],O=new u.ValueCellVertex(Number(N),N);this.columnSearch.add(Number(N),S),this.dependencyGraph.addVertex(S,O)}}catch(e){A.e(e)}finally{A.f()}}return this.stats.end(l.StatType.MATRIX_DETECTION),r}}]),e}();function E(e,t){var r=(0,c.checkMatrixSize)(e,t);return r instanceof o.CellError?new u.ValueCellVertex(r,void 0):new u.MatrixVertex(t,r.width,r.height,e)}t.MatrixDetectionStrategy=v},function(e,t,r){"use strict";r(53),r(67),r(68),r(87),r(93),r(94),t.__esModule=!0,t.findMatrices=m,t.GraphBuilderMatrixHeuristic=t.Array2d=void 0,r(95),r(210),r(63),r(77),r(97),r(126);var n=r(135),o=r(115),a=r(270),i=r(118),u=r(235);function s(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t,r){return t&&f(e.prototype,t),r&&f(e,r),e}var h=function(){function e(t){l(this,e),this._size=t,this.array=new Array(t.height);for(var r=0;r<t.height;++r)this.array[r]=new Array(t.width)}return p(e,[{key:"set",value:function(e,t,r){this.array[t][e]=r}},{key:"get",value:function(e,t){var r=this.array[t];return r&&r[e]||null}},{key:"size",value:function(){return this._size}}],[{key:"fromArray",value:function(t){for(var r=new u.MatrixSize(t[0].length,t.length),n=new e(r),o=0;o<r.height;++o)for(var a=0;a<r.width;++a)n.set(a,o,t[o][a]);return n}}]),e}();t.Array2d=h;var d=function(){function e(t,r,n,o){l(this,e),this.dependencyGraph=t,this.columnSearch=r,this.threshold=n,this.cellContentParser=o,this.mapping=new Map}return p(e,[{key:"addSheet",value:function(e,t){this.mapping.set(e,new h(t))}},{key:"add",value:function(e){if(!this.mapping.has(e.sheet))throw Error("Sheet with id: ".concat(e.sheet," does not exists"));this.mapping.get(e.sheet).set(e.col,e.row,!0)}},{key:"run",value:function(e){var t=this,r=[];return this.findMatrices().forEach((function(n){if(!n.isMatrix||n.range.size()<t.threshold)r.push(n);else{var o=n.range,a=i.MatrixVertex.fromRange(o),u=e[t.dependencyGraph.getSheetName(o.start.sheet)],s=t.matrixFromPlainValues(o,u);a.setCellValue(s),t.dependencyGraph.addMatrixVertex(a.getAddress(),a),t.columnSearch.add(s,a.getAddress())}})),this.mapping.clear(),r}},{key:"matrixFromPlainValues",value:function(e,t){for(var r=new Array(e.height()),n=0;n<e.height();++n)r[n]=new Array(e.width());var o,i=s(e.addresses(this.dependencyGraph));try{for(i.s();!(o=i.n()).done;){var c=o.value,l=t[c.row][c.col],f=this.cellContentParser.parse(l);if(!(f instanceof a.CellContent.Number))throw new Error("Range contains not numeric values");r[c.row-e.start.row][c.col-e.start.col]=f.value}}catch(e){i.e(e)}finally{i.f()}return new u.Matrix(r)}},{key:"findMatrices",value:function(){var e=[];return this.mapping.forEach((function(t,r){var n,o=s(m(r,t));try{for(o.s();!(n=o.n()).done;){var a=n.value;e.push(a)}}catch(e){o.e(e)}finally{o.f()}})),e}}]),e}();function m(e,t){for(var r=t.size(),a=new Map,i=new h(r),u=0,s=r.height-1;s>=0;--s)for(var c=r.width-1;c>=0;--c){var l=t.get(c,s),f=[t.get(c+1,s),i.get(c+1,s)],p=f[0],d=f[1],m=[t.get(c,s+1),i.get(c,s+1)],g=m[0],v=m[1],E=[t.get(c+1,s+1),i.get(c+1,s+1)],T=E[0],b=E[1];if(l)if(l!==p&&d===v)i.set(c,s,++u),a.set(u,y(n.AbsoluteCellRange.fromCoordinates(e,c,s,c,s),!0,[(0,o.simpleCellAddress)(e,c,s)])),a.has(d)&&(a.get(d).isMatrix=!1);else if(l!==T)if(p===l&&p===g)a.has(d)&&(a.get(d).isMatrix=!1),a.has(v)&&(a.get(v).isMatrix=!1),i.set(c,s,++u),a.set(u,y(n.AbsoluteCellRange.fromCoordinates(e,c,s,c,s),!0,[(0,o.simpleCellAddress)(e,c,s)]));else if(p!==l&&g===l)if(a.has(v)&&a.get(v).isMatrix){i.set(c,s,v);var R=a.get(v);R.cells.push((0,o.simpleCellAddress)(e,c,s)),a.set(v,y(R.range.withStart((0,o.simpleCellAddress)(e,c,s)),!0,R.cells))}else i.set(c,s,++u),a.set(u,y(n.AbsoluteCellRange.fromCoordinates(e,c,s,c,s),!0,[(0,o.simpleCellAddress)(e,c,s)]));else if(p===l&&g!==l){i.set(c,s,d);var A=a.get(d);A.cells.push((0,o.simpleCellAddress)(e,c,s)),a.set(d,y(A.range.withStart((0,o.simpleCellAddress)(e,c,s)),!0,A.cells))}else i.set(c,s,++u),a.set(u,y(n.AbsoluteCellRange.fromCoordinates(e,c,s,c,s),!0,[(0,o.simpleCellAddress)(e,c,s)]));else if(l===T&&b===d&&b===v){i.set(c,s,d);var S=a.get(d);S.cells.push((0,o.simpleCellAddress)(e,c,s)),a.set(d,y(S.range.withStart((0,o.simpleCellAddress)(e,c,s)),!0,S.cells))}else l===T&&(i.set(c,s,++u),a.set(u,y(n.AbsoluteCellRange.fromCoordinates(e,c,s,c,s),!0,[(0,o.simpleCellAddress)(e,c,s)])));else i.set(c,s,0),d===v&&a.has(d)&&(a.get(d).isMatrix=!1)}return a.values()}function y(e,t,r){return{isMatrix:t,range:e,cells:r}}t.GraphBuilderMatrixHeuristic=d},function(e,t,r){"use strict";t.__esModule=!0,t.doesContainRelativeReferences=t.NamedExpressions=t.InternalNamedExpression=void 0,r(95),r(210),r(63),r(77),r(97),r(221),r(68),r(121),r(126);var n=r(115),o=r(141);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}var s=function(){function e(t,r,n,o){a(this,e),this.displayName=t,this.address=r,this.added=n,this.options=o}return u(e,[{key:"normalizeExpressionName",value:function(){return this.displayName.toLowerCase()}},{key:"copy",value:function(){return new e(this.displayName,this.address,this.added,this.options)}}]),e}();t.InternalNamedExpression=s;var c=function(){function e(){a(this,e),this.mapping=new Map}return u(e,[{key:"has",value:function(e){return this.mapping.has(this.normalizeExpressionName(e))}},{key:"isNameAvailable",value:function(e){var t=this.normalizeExpressionName(e),r=this.mapping.get(t);return!(r&&r.added)}},{key:"add",value:function(e){this.mapping.set(e.normalizeExpressionName(),e)}},{key:"get",value:function(e){return this.mapping.get(this.normalizeExpressionName(e))}},{key:"getExisting",value:function(e){var t=this.mapping.get(this.normalizeExpressionName(e));return t&&t.added?t:void 0}},{key:"remove",value:function(e){var t=this.normalizeExpressionName(e),r=this.mapping.get(t);r&&(r.added=!1)}},{key:"getAllNamedExpressions",value:function(){return Array.from(this.mapping.values()).filter((function(e){return e.added}))}},{key:"normalizeExpressionName",value:function(e){return e.toLowerCase()}}]),e}(),l=function(){function e(){a(this,e),this.mapping=new Map}return u(e,[{key:"add",value:function(e){this.mapping.set(this.normalizeExpressionName(e.displayName),e)}},{key:"get",value:function(e){return this.mapping.get(this.normalizeExpressionName(e))}},{key:"has",value:function(e){return this.mapping.has(this.normalizeExpressionName(e))}},{key:"getAllNamedExpressions",value:function(){return Array.from(this.mapping.values()).filter((function(e){return e.added}))}},{key:"normalizeExpressionName",value:function(e){return e.toLowerCase()}},{key:"isNameAvailable",value:function(e){var t=this.normalizeExpressionName(e);return!this.mapping.has(t)}},{key:"remove",value:function(e){var t=this.normalizeExpressionName(e);this.mapping.get(t)&&this.mapping.delete(t)}}]),e}(),f=function(){function e(){a(this,e),this.nextNamedExpressionRow=0,this.workbookStore=new c,this.worksheetStores=new Map,this.addressCache=new Map}return u(e,[{key:"isNameAvailable",value:function(e,t){var r,n;return void 0===t?this.workbookStore.isNameAvailable(e):null===(n=null===(r=this.worksheetStore(t))||void 0===r?void 0:r.isNameAvailable(e))||void 0===n||n}},{key:"namedExpressionInAddress",value:function(e){var t=this.addressCache.get(e);return t&&t.added?t:void 0}},{key:"namedExpressionForScope",value:function(e,t){var r;return void 0===t?this.workbookStore.getExisting(e):null===(r=this.worksheetStore(t))||void 0===r?void 0:r.get(e)}},{key:"nearestNamedExpression",value:function(e,t){var r,n;return null!==(n=null===(r=this.worksheetStore(t))||void 0===r?void 0:r.get(e))&&void 0!==n?n:this.workbookStore.getExisting(e)}},{key:"isExpressionInScope",value:function(e,t){var r,n;return null!==(n=null===(r=this.worksheetStore(t))||void 0===r?void 0:r.has(e))&&void 0!==n&&n}},{key:"isNameValid",value:function(e){return!/^[A-Za-z]+[0-9]+$/.test(e)&&/^[A-Za-z\u00C0-\u02AF_][A-Za-z0-9\u00C0-\u02AF._]*$/.test(e)}},{key:"addNamedExpression",value:function(e,t,r){var n=void 0===t?this.workbookStore:this.worksheetStoreOrCreate(t),o=n.get(e);return o?(o.added=!0,o.displayName=e,o.options=r):(o=new s(e,this.nextAddress(),!0,r),n.add(o)),this.addressCache.set(o.address.row,o),o}},{key:"restoreNamedExpression",value:function(e,t){var r=void 0===t?this.workbookStore:this.worksheetStoreOrCreate(t);return e.added=!0,r.add(e),this.addressCache.set(e.address.row,e),e}},{key:"worksheetStoreOrCreate",value:function(e){var t=this.worksheetStores.get(e);return t||(t=new l,this.worksheetStores.set(e,t)),t}},{key:"worksheetStore",value:function(e){return this.worksheetStores.get(e)}},{key:"namedExpressionOrPlaceholder",value:function(e,t){var r;return null!==(r=this.worksheetStoreOrCreate(t).get(e))&&void 0!==r?r:this.workbookNamedExpressionOrPlaceholder(e)}},{key:"workbookNamedExpressionOrPlaceholder",value:function(e){var t=this.workbookStore.get(e);return void 0===t&&(t=new s(e,this.nextAddress(),!1),this.workbookStore.add(t)),t}},{key:"remove",value:function(e,t){var r,n=null==(r=void 0===t?this.workbookStore:this.worksheetStore(t))?void 0:r.get(e);if(void 0===r||void 0===n||!n.added)throw"Named expression does not exist";r.remove(e),r instanceof l&&0===r.mapping.size&&this.worksheetStores.delete(t),this.addressCache.delete(n.address.row)}},{key:"getAllNamedExpressionsNamesInScope",value:function(e){return this.getAllNamedExpressions().filter((function(t){return t.scope===e})).map((function(e){return e.expression.displayName}))}},{key:"getAllNamedExpressionsNames",value:function(){return this.getAllNamedExpressions().map((function(e){return e.expression.displayName}))}},{key:"getAllNamedExpressions",value:function(){var e=[];return this.workbookStore.getAllNamedExpressions().forEach((function(t){e.push({expression:t,scope:void 0})})),this.worksheetStores.forEach((function(t,r){t.getAllNamedExpressions().forEach((function(t){e.push({expression:t,scope:r})}))})),e}},{key:"getAllNamedExpressionsForScope",value:function(e){var t,r;return void 0===e?this.workbookStore.getAllNamedExpressions():null!==(r=null===(t=this.worksheetStores.get(e))||void 0===t?void 0:t.getAllNamedExpressions())&&void 0!==r?r:[]}},{key:"nextAddress",value:function(){return(0,n.simpleCellAddress)(e.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}},{key:"lookupNextAddress",value:function(t,r){if(void 0===r){var o=this.workbookStore.get(t);if(o)return o.address}return(0,n.simpleCellAddress)(e.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow)}}]),e}();t.NamedExpressions=f,f.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1,t.doesContainRelativeReferences=function e(t){switch(t.type){case o.AstNodeType.EMPTY:case o.AstNodeType.NUMBER:case o.AstNodeType.STRING:case o.AstNodeType.ERROR:case o.AstNodeType.ERROR_WITH_RAW_INPUT:return!1;case o.AstNodeType.CELL_REFERENCE:return!t.reference.isAbsolute();case o.AstNodeType.CELL_RANGE:case o.AstNodeType.COLUMN_RANGE:case o.AstNodeType.ROW_RANGE:return!t.start.isAbsolute();case o.AstNodeType.NAMED_EXPRESSION:return!1;case o.AstNodeType.PERCENT_OP:case o.AstNodeType.PLUS_UNARY_OP:case o.AstNodeType.MINUS_UNARY_OP:return e(t.value);case o.AstNodeType.CONCATENATE_OP:case o.AstNodeType.EQUALS_OP:case o.AstNodeType.NOT_EQUAL_OP:case o.AstNodeType.LESS_THAN_OP:case o.AstNodeType.GREATER_THAN_OP:case o.AstNodeType.LESS_THAN_OR_EQUAL_OP:case o.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case o.AstNodeType.MINUS_OP:case o.AstNodeType.PLUS_OP:case o.AstNodeType.TIMES_OP:case o.AstNodeType.DIV_OP:case o.AstNodeType.POWER_OP:return e(t.left)||e(t.right);case o.AstNodeType.PARENTHESIS:return e(t.expression);case o.AstNodeType.FUNCTION_CALL:return t.args.some((function(t){return e(t)}))}}},function(e,t,r){"use strict";t.__esModule=!0,t.validateAsSheet=
/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */
function(e){if(!Array.isArray(e))throw new n.InvalidArgumentsError("an array of arrays.");for(var t=0;t<e.length;t++)if(!Array.isArray(e[t]))throw new n.InvalidArgumentsError("an array of arrays.")},t.findBoundaries=function(e){for(var t=0,r=0,n=0,o=0;o<e.length;o++){for(var a=0,i=0;i<e[o].length;i++){var u=e[o][i];null!=u&&(a=i+1,++n)}t=Math.max(t,a),a>0&&(r=o+1)}var s=t*r;return{height:r,width:t,fill:0===s?0:n/s}};var n=r(231)},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.CleanOutOfScopeDependenciesTransformer=void 0,r(109);var o=r(277),a=r(115);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var o=l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(c,e);var t,r,n,o=s(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=o.call(this)).sheet=e,t}return t=c,(r=[{key:"isIrreversible",value:function(){return!0}},{key:"fixNodeAddress",value:function(e){return e}},{key:"transformCellAddress",value:function(e,t){return!!e.isInvalid(t)&&a.ErrorType.REF}},{key:"transformCellRange",value:function(e,t,r){return!(!e.isInvalid(r)&&!t.isInvalid(r))&&a.ErrorType.REF}},{key:"transformColumnRange",value:function(e,t,r){return!(!e.isInvalid(r)&&!t.isInvalid(r))&&a.ErrorType.REF}},{key:"transformRowRange",value:function(e,t,r){return!(!e.isInvalid(r)&&!t.isInvalid(r))&&a.ErrorType.REF}}])&&i(t.prototype,r),n&&i(t,n),c}(o.Transformer);t.CleanOutOfScopeDependenciesTransformer=f},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(212),r(108),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.Emitter=t.Events=void 0,r(125),r(109);var o,a=r(289);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var o=p(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}t.Events=o,function(e){e.SheetAdded="sheetAdded",e.SheetRemoved="sheetRemoved",e.SheetRenamed="sheetRenamed",e.NamedExpressionAdded="namedExpressionAdded",e.NamedExpressionRemoved="namedExpressionRemoved",e.ValuesUpdated="valuesUpdated",e.EvaluationSuspended="evaluationSuspended",e.EvaluationResumed="evaluationResumed"}(o||(t.Events=o={}));var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(a,e);var t,r,n,o=l(a);function a(){return i(this,a),o.apply(this,arguments)}return t=a,(r=[{key:"emit",value:function(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return(t=s(p(a.prototype),"emit",this)).call.apply(t,[this,e].concat(n)),this}}])&&u(t.prototype,r),n&&u(t,n),a}(a.TinyEmitter);t.Emitter=h},function(e,t){function r(){}r.prototype={on:function(e,t,r){var n=this.e||(this.e={});return(n[e]||(n[e]=[])).push({fn:t,ctx:r}),this},once:function(e,t,r){var n=this;function o(){n.off(e,o),t.apply(r,arguments)}return o._=t,this.on(e,o,r)},emit:function(e){for(var t=[].slice.call(arguments,1),r=((this.e||(this.e={}))[e]||[]).slice(),n=0,o=r.length;n<o;n++)r[n].fn.apply(r[n].ctx,t);return this},off:function(e,t){var r=this.e||(this.e={}),n=r[e],o=[];if(n&&t)for(var a=0,i=n.length;a<i;a++)n[a].fn!==t&&n[a].fn._!==t&&o.push(n[a]);return o.length?r[e]=o:delete r[e],this}},e.exports=r,e.exports.TinyEmitter=r},function(e,t,r){"use strict";t.__esModule=!0,t.BuildEngineFactory=void 0;var n=r(291),o=r(293),a=r(270),i=r(295),u=r(255),s=r(262),c=r(301),l=r(118),f=r(303),p=r(283),h=r(244),d=r(285),m=r(309),y=r(141),g=r(310),v=r(224),E=r(231),T=r(286),b=r(306);function R(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var A=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,A;return t=e,A=[{key:"buildEngine",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.useStats?new v.Statistics:new v.EmptyStatistics;r.start(v.StatType.BUILD_ENGINE_TOTAL);var u=new d.NamedExpressions,h=new b.FunctionRegistry(e),R=new o.LazilyTransformingAstService(r),A=l.DependencyGraph.buildEmpty(R,e,h,u,r),S=(0,i.buildColumnSearchStrategy)(A,e,r),N=A.sheetMapping,O=A.addressMapping;for(var C in t)if(Object.prototype.hasOwnProperty.call(t,C)){var w=t[C];(0,T.validateAsSheet)(w);var M=(0,T.findBoundaries)(w);if(M.height>e.maxRows||M.width>e.maxColumns)throw new E.SheetSizeLimitExceededError;var I=N.addSheet(C);O.autoAddSheet(I,w,M)}var x=new y.ParserWithCaching(e,h,N.get),k=new y.Unparser(e,(0,y.buildLexerConfig)(e),N.fetchDisplayName,u),_=new s.DateTimeHelper(e),P=new m.NumberLiteralHelper(e),L=new a.CellContentParser(e,_,P),F=new c.CrudOperations(e,r,A,S,x,L,R,u);r.measure(v.StatType.GRAPH_BUILD,(function(){new p.GraphBuilder(A,S,x,L,e,r).buildGraph(t)})),R.undoRedo=F.undoRedo,R.parser=x;var U=new n.Exporter(e,u,N.fetchDisplayName),V=new g.Serialization(A,k,e,U),D=new f.Evaluator(A,S,e,r,_,P,h,u,V);return D.run(),r.end(v.StatType.BUILD_ENGINE_TOTAL),{config:e,stats:r,dependencyGraph:A,columnSearch:S,parser:x,unparser:k,cellContentParser:L,evaluator:D,lazilyTransformingAstService:R,crudOperations:F,exporter:U,namedExpressions:u,serialization:V,functionRegistry:h}}},{key:"buildFromSheets",value:function(e,t){var r=new u.Config(t);return this.buildEngine(r,e)}},{key:"buildFromSheet",value:function(e,t){var r,n,o,a=new u.Config(t),i=a.translationPackage.getUITranslation(h.UIElement.NEW_SHEET_PREFIX)+"1";return this.buildEngine(a,(o=e,(n=i)in(r={})?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r))}},{key:"buildEmpty",value:function(e){return this.buildEngine(new u.Config(e))}},{key:"rebuildWithConfig",value:function(e,t,r){return this.buildEngine(e,t,r)}}],(r=null)&&R(t.prototype,r),A&&R(t,A),e}();t.BuildEngineFactory=A},function(e,t,r){"use strict";t.__esModule=!0,t.Exporter=t.ExportedNamedExpressionChange=t.ExportedCellChange=void 0,r(67),r(292);var n=r(115),o=r(254),a=r(215),i=r(223),u=r(222),s=r(285),c=r(142);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t,r){return t&&f(e.prototype,t),r&&f(e,r),e}var h=function(){function e(t,r){l(this,e),this.address=t,this.newValue=r}return p(e,[{key:"col",get:function(){return this.address.col}},{key:"row",get:function(){return this.address.row}},{key:"sheet",get:function(){return this.address.sheet}},{key:"value",get:function(){return this.newValue}}]),e}();t.ExportedCellChange=h;var d=function e(t,r){l(this,e),this.name=t,this.newValue=r};t.ExportedNamedExpressionChange=d;var m=function(){function e(t,r,n){l(this,e),this.config=t,this.namedExpressions=r,this.sheetIndexMapping=n}return p(e,[{key:"exportChange",value:function(e){if(e.sheet===s.NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS){var t=this.namedExpressions.namedExpressionInAddress(e.row);if(!t)throw"Missing named expression";return new d(t.displayName,this.exportValue(e.value))}return new h((0,n.simpleCellAddress)(e.sheet,e.col,e.row),this.exportValue(e.value))}},{key:"exportValue",value:function(e){return e instanceof u.SimpleRangeValue?this.detailedError(new n.CellError(n.ErrorType.VALUE,a.ErrorMessage.ScalarExpected)):this.config.smartRounding&&(0,i.isExtendedNumber)(e)?this.cellValueRounding((0,i.getRawValue)(e)):e instanceof n.CellError?this.detailedError(e):e===i.EmptyValue?null:(0,i.getRawValue)(e)}},{key:"detailedError",value:function(e){var t,r=void 0,n=e.address;return void 0!==n&&(r=n.sheet===s.NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS?null===(t=this.namedExpressions.namedExpressionInAddress(n.row))||void 0===t?void 0:t.displayName:(0,c.simpleCellAddressToString)(this.sheetIndexMapping,n,-1)),new o.DetailedCellError(e,this.config.translationPackage.getErrorTranslation(e.type),r)}},{key:"cellValueRounding",value:function(e){if(0===e)return e;var t=Math.floor(Math.log10(Math.abs(e))),r=Math.pow(10,this.config.precisionRounding-t);return e<0?-Math.round(-e*r)/r:Math.round(e*r)/r}}]),e}();t.Exporter=m},function(e,t,r){var n=r(2),o=Math.log,a=Math.LOG10E;n({target:"Math",stat:!0},{log10:function(e){return o(e)*a}})},function(e,t,r){"use strict";r(87),r(93),r(63),r(94),r(95),r(77),r(97),r(53),r(67),r(68),t.__esModule=!0,t.LazilyTransformingAstService=void 0,r(120);var n=r(224),o=r(294);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.stats=t,this.transformations=[]}var t,r,i;return t=e,(r=[{key:"version",value:function(){return this.transformations.length}},{key:"addTransformation",value:function(e){return void 0!==this.combinedTransformer?this.combinedTransformer.add(e):this.transformations.push(e),this.version()}},{key:"beginCombinedMode",value:function(e){this.combinedTransformer=new o.CombinedTransformer(e)}},{key:"commitCombinedMode",value:function(){if(void 0===this.combinedTransformer)throw"Combined mode wasn't started";return this.transformations.push(this.combinedTransformer),this.combinedTransformer=void 0,this.version()}},{key:"applyTransformations",value:function(e,t,r){this.stats.start(n.StatType.TRANSFORM_ASTS_POSTPONED);for(var o=r;o<this.transformations.length;o++){var i=this.transformations[o];i.isIrreversible()&&(this.undoRedo.storeDataForVersion(o,t,this.parser.computeHashFromAst(e)),this.parser.rememberNewAst(e));var u=a(i.transformSingleAst(e,t),2);e=u[0],t=u[1]}var s=this.parser.rememberNewAst(e);return this.stats.end(n.StatType.TRANSFORM_ASTS_POSTPONED),[s,t,this.transformations.length]}},{key:"getTransformationsFrom",value:regeneratorRuntime.mark((function e(t,r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t;case 1:if(!(n<this.transformations.length)){e.next=9;break}if(o=this.transformations[n],r&&!r(o)){e.next=6;break}return e.next=6,o;case 6:n++,e.next=1;break;case 9:case"end":return e.stop()}}),e,this)}))},{key:"destroy",value:function(){this.parser=void 0,this.transformations=[]}}])&&u(t.prototype,r),i&&u(t,i),e}();t.LazilyTransformingAstService=s},function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r(87),r(93),r(63),r(94),r(95),r(77),r(97),r(53),r(67),r(68),t.__esModule=!0,t.CombinedTransformer=void 0,r(126);
/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */
var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sheet=t,this.transformations=[]}var t,r,o;return t=e,(r=[{key:"add",value:function(e){this.transformations.push(e)}},{key:"performEagerTransformations",value:function(e,t){this.transformations.forEach((function(r){return r.performEagerTransformations(e,t)}))}},{key:"transformSingleAst",value:function(e,t){var r=e,o=t;return this.transformations.forEach((function(e){var t=n(e.transformSingleAst(r,o),2);r=t[0],o=t[1]})),[r,o]}},{key:"isIrreversible",value:function(){return!0}}])&&a(t.prototype,r),o&&a(t,o),e}();t.CombinedTransformer=i},function(e,t,r){"use strict";t.__esModule=!0,t.buildColumnSearchStrategy=
/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */
function(e,t,r){return t.useColumnIndex?new o.ColumnIndex(e,t,r):new n.ColumnBinarySearch(e,t)};var n=r(296),o=r(299)},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.ColumnBinarySearch=void 0,r(121),r(109);var o=r(271),a=r(297),i=r(223);function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return l(this,r)}}function l(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(f,e);var t,r,n,l=c(f);function f(e,t){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(r=l.call(this,e)).dependencyGraph=e,r.config=t,r}return t=f,(r=[{key:"add",value:function(e,t){}},{key:"remove",value:function(e,t){}},{key:"change",value:function(e,t,r){}},{key:"addColumns",value:function(e){}},{key:"removeColumns",value:function(e){}},{key:"removeSheet",value:function(e){}},{key:"moveValues",value:function(e,t,r,n){}},{key:"removeValues",value:function(e){}},{key:"destroy",value:function(){}},{key:"find",value:function(e,t,r){if("string"==typeof e&&(e=(0,o.forceNormalizeString)(e)),t.height()<this.config.binarySearchThreshold||!r){var n=this.dependencyGraph.computeListOfValuesInRange(t).map(i.getRawValue).map((function(e){return"string"==typeof e?(0,o.forceNormalizeString)(e):e})).indexOf(e);return n<0?n:n+t.start.row}return(0,a.rangeLowerBound)(t,e,this.dependencyGraph,"row")}}])&&u(t.prototype,r),n&&u(t,n),f}(r(298).AdvancedFind);t.ColumnBinarySearch=p},function(e,t,r){"use strict";t.__esModule=!0,t.rangeLowerBound=function(e,t,r,a){var u;u="col"===a?e.effectiveEndColumn(r):e.effectiveEndRow(r);var s=e.start[a];return i("row"===a?function(t){return(0,o.getRawValue)(r.getCellValue((0,n.simpleCellAddress)(e.sheet,e.start.col,t)))}:function(t){return(0,o.getRawValue)(r.getCellValue((0,n.simpleCellAddress)(e.sheet,t,e.start.row)))},t,s,u)},t.lowerBound=i,t.compare=u,r(87),r(93),r(63),r(94),r(95),r(77),r(97);var n=r(115),o=r(223);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t,r,n){for(;r<=n;){var o=Math.floor((r+n)/2),a=u(t,e(o));if(a>0)r=o+1;else if(a<0)n=o-1;else{if(r==o)return o;n=o}}return n}function u(e,t){return a(e)===a(t)?e===o.EmptyValue?0:e<t?-1:e>t?1:0:e===o.EmptyValue?-1:t===o.EmptyValue?1:t instanceof n.CellError||"number"==typeof e&&"string"==typeof t||"number"==typeof e&&"boolean"==typeof t?-1:"string"==typeof e&&"number"==typeof t?1:"string"==typeof e&&"boolean"==typeof t?-1:1}},function(e,t,r){"use strict";t.__esModule=!0,t.AdvancedFind=void 0;var n=r(223);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dependencyGraph=t}var t,r,a;return t=e,(r=[{key:"advancedFind",value:function(e,t){for(var r=this.dependencyGraph.computeListOfValuesInRange(t),o=0;o<r.length;o++)if(e((0,n.getRawValue)(r[o])))return o+t.start.col;return-1}}])&&o(t.prototype,r),a&&o(t,a),e}();t.AdvancedFind=a},function(e,t,r){"use strict";r(53),r(67),r(68),r(87),r(93),r(94),t.__esModule=!0,t.upperBound=v,t.lowerBound=E,t.ColumnIndex=void 0,r(95),r(210),r(63),r(77),r(97),r(300),r(236),r(125);var n=r(115),o=r(278),a=r(281),i=r(271),u=r(222),s=r(235),c=r(224),l=r(296);function f(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||d(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=d(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}function d(e,t){if(e){if("string"==typeof e)return m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var g=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dependencyGraph=t,this.config=r,this.stats=n,this.index=new Map,this.transformingService=this.dependencyGraph.lazilyTransformingAstService,this.binarySearchStrategy=new l.ColumnBinarySearch(t,r)}var t,r,d;return t=e,(r=[{key:"add",value:function(e,t){if(e instanceof s.Matrix){var r,o=h(e.generateValues(t));try{for(o.s();!(r=o.n()).done;){var a=p(r.value,2),i=a[0],c=a[1];this.addSingleCellValue(i,c)}}catch(e){o.e(e)}finally{o.f()}}else e instanceof n.CellError||e instanceof u.SimpleRangeValue||this.addSingleCellValue(e,t)}},{key:"remove",value:function(e,t){if(e)if(e instanceof s.Matrix){var r,n=h(e.generateValues(t));try{for(n.s();!(r=n.n()).done;){var o=p(r.value,2),a=o[0],i=o[1];this.removeSingleValue(a,i)}}catch(e){n.e(e)}finally{n.f()}}else this.removeSingleValue(e,t)}},{key:"change",value:function(e,t,r){e!==t&&(this.remove(e,r),this.add(t,r))}},{key:"moveValues",value:function(e,t,r,o){var a,i=h(e);try{for(i.s();!(a=i.n()).done;){var u=p(a.value,2),s=u[0],c=u[1],l=(0,n.movedSimpleCellAddress)(c,o,t,r);this.remove(s,c),this.add(s,l)}}catch(e){i.e(e)}finally{i.f()}}},{key:"removeValues",value:function(e){var t,r=h(e);try{for(r.s();!(t=r.n()).done;){var n=p(t.value,2),o=n[0],a=n[1];this.remove(o,a)}}catch(e){r.e(e)}finally{r.f()}}},{key:"find",value:function(e,t,r){this.ensureRecentData(t.sheet,t.start.col,e);var n=this.getColumnMap(t.sheet,t.start.col);if(!n)return-1;"string"==typeof e&&(e=(0,i.forceNormalizeString)(e));var o=n.get(e);if(!o)return this.binarySearchStrategy.find(e,t,r);var a=v(o.index,t.start.row),u=o.index[a];return u<=t.end.row?u:this.binarySearchStrategy.find(e,t,r)}},{key:"advancedFind",value:function(e,t){return this.binarySearchStrategy.advancedFind(e,t)}},{key:"addColumns",value:function(e){var t=this.index.get(e.sheet);t&&t.splice.apply(t,[e.columnStart,0].concat(f(Array(e.numberOfColumns))))}},{key:"removeColumns",value:function(e){var t=this.index.get(e.sheet);t&&t.splice(e.columnStart,e.numberOfColumns)}},{key:"removeSheet",value:function(e){this.index.delete(e)}},{key:"getColumnMap",value:function(e,t){this.index.has(e)||this.index.set(e,[]);var r=this.index.get(e),n=r[t];return n||(n=new Map,r[t]=n),n}},{key:"getValueIndex",value:function(e,t,r){var n=this.getColumnMap(e,t),o=this.getColumnMap(e,t).get(r);return o||(o={version:this.transformingService.version(),index:[]},n.set(r,o)),o}},{key:"ensureRecentData",value:function(e,t,r){var n=this.getValueIndex(e,t,r),i=this.transformingService.version();if(n.version!==i){var u,s=h(this.transformingService.getTransformationsFrom(n.version,(function(t){return t.sheet===e&&(t instanceof o.AddRowsTransformer||t instanceof a.RemoveRowsTransformer)})));try{for(s.s();!(u=s.n()).done;){var c=u.value;c instanceof o.AddRowsTransformer?this.addRows(t,c.rowsSpan,r):c instanceof a.RemoveRowsTransformer&&this.removeRows(t,c.rowsSpan,r)}}catch(e){s.e(e)}finally{s.f()}n.version=i}}},{key:"destroy",value:function(){this.index.clear()}},{key:"addSingleCellValue",value:function(e,t){var r=this;this.stats.measure(c.StatType.BUILD_COLUMN_INDEX,(function(){r.ensureRecentData(t.sheet,t.col,e),"string"==typeof e&&(e=(0,i.forceNormalizeString)(e));var n=r.getValueIndex(t.sheet,t.col,e);r.addValue(n,t.row)}))}},{key:"removeSingleValue",value:function(e,t){var r=this;this.stats.measure(c.StatType.BUILD_COLUMN_INDEX,(function(){r.ensureRecentData(t.sheet,t.col,e);var n=r.getColumnMap(t.sheet,t.col);"string"==typeof e&&(e=(0,i.forceNormalizeString)(e));var o=n.get(e);if(o){var a=v(o.index,t.row);o.index.splice(a,1),0===o.index.length&&n.delete(e),0===n.size&&delete r.index.get(t.sheet)[t.col]}}))}},{key:"addRows",value:function(e,t,r){var n=this.getValueIndex(t.sheet,e,r);this.shiftRows(n,t.rowStart,t.numberOfRows)}},{key:"removeRows",value:function(e,t,r){var n=this.getValueIndex(t.sheet,e,r);this.removeRowsFromValues(n,t),this.shiftRows(n,t.rowEnd+1,-t.numberOfRows)}},{key:"addValue",value:function(e,t){var r=E(e.index,t);e.index[r]!==t&&(r===e.index.length-1?e.index.push(t):e.index.splice(r+1,0,t))}},{key:"removeRowsFromValues",value:function(e,t){var r=v(e.index,t.rowStart),n=E(e.index,t.rowEnd);e.index[r]<=t.rowEnd&&e.index.splice(r,n-r+1)}},{key:"shiftRows",value:function(e,t,r){for(var n=v(e.index,t);n<e.index.length;++n)e.index[n]+=r}}])&&y(t.prototype,r),d&&y(t,d),e}();function v(e,t){for(var r=0,n=e.length-1;r<=n;){var o=Math.floor((r+n)/2);if(t>e[o])r=o+1;else{if(!(t<e[o]))return o;n=o-1}}return r}function E(e,t){for(var r=0,n=e.length-1;r<=n;){var o=Math.floor((r+n)/2);if(t>e[o])r=o+1;else{if(!(t<e[o]))return o;n=o-1}}return n}t.ColumnIndex=g},function(e,t,r){"use strict";var n=r(2),o=r(91).find,a=r(96),i=!0;"find"in[]&&Array(1).find((function(){i=!1})),n({target:"Array",proto:!0,forced:i},{find:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),a("find")},function(e,t,r){"use strict";r(53),r(63),r(67),r(68),r(77),r(87),r(93),r(94),r(95),r(97),t.__esModule=!0,t.CrudOperations=void 0,r(125),r(242),r(121),r(149),r(213),r(138);var n=r(135),o=r(115),a=r(270),i=r(274),u=r(273),s=r(285),c=r(231),l=r(219),f=r(302),p=r(286);function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||m(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=m(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}function m(e,t){if(e){if("string"==typeof e)return y(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(e,t):void 0}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var v=function(){function e(t,r,n,o,a,s,c,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.stats=r,this.dependencyGraph=n,this.columnSearch=o,this.parser=a,this.cellContentParser=s,this.lazilyTransformingAstService=c,this.namedExpressions=l,this.operations=new u.Operations(this.dependencyGraph,this.columnSearch,this.cellContentParser,this.parser,this.stats,this.lazilyTransformingAstService,this.namedExpressions,this.config),this.clipboardOperations=new i.ClipboardOperations(this.dependencyGraph,this.operations,this.parser,this.lazilyTransformingAstService,this.config),this.undoRedo=new f.UndoRedo(this.config,this.operations)}var t,r,m;return t=e,(r=[{key:"addRows",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=new u.AddRowsCommand(e,r);this.ensureItIsPossibleToAddRows.apply(this,[e].concat(r)),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addRows(o),this.undoRedo.saveOperation(new f.AddRowsUndoEntry(o))}},{key:"removeRows",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=new u.RemoveRowsCommand(e,r);this.ensureItIsPossibleToRemoveRows.apply(this,[e].concat(r)),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var a=this.operations.removeRows(o);this.undoRedo.saveOperation(new f.RemoveRowsUndoEntry(o,a))}},{key:"addColumns",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=new u.AddColumnsCommand(e,r);this.ensureItIsPossibleToAddColumns.apply(this,[e].concat(r)),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addColumns(o),this.undoRedo.saveOperation(new f.AddColumnsUndoEntry(o))}},{key:"removeColumns",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=new u.RemoveColumnsCommand(e,r);this.ensureItIsPossibleToRemoveColumns.apply(this,[e].concat(r)),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var a=this.operations.removeColumns(o);this.undoRedo.saveOperation(new f.RemoveColumnsUndoEntry(o,a))}},{key:"moveCells",value:function(e,t,r,n){this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var o=this.operations.moveCells(e,t,r,n),a=o.version,i=o.overwrittenCellsData,u=o.addedGlobalNamedExpressions;this.undoRedo.saveOperation(new f.MoveCellsUndoEntry(e,t,r,n,i,u,a))}},{key:"moveRows",value:function(e,t,r,n){this.ensureItIsPossibleToMoveRows(e,t,r,n),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var o=this.operations.moveRows(e,t,r,n);this.undoRedo.saveOperation(new f.MoveRowsUndoEntry(e,t,r,n,o))}},{key:"moveColumns",value:function(e,t,r,n){this.ensureItIsPossibleToMoveColumns(e,t,r,n),this.undoRedo.clearRedoStack();var o=this.operations.moveColumns(e,t,r,n);this.undoRedo.saveOperation(new f.MoveColumnsUndoEntry(e,t,r,n,o))}},{key:"cut",value:function(e,t,r){this.clipboardOperations.cut(e,t,r)}},{key:"ensureItIsPossibleToCopy",value:function(e,t,r){if(!E(t))throw new c.InvalidArgumentsError("width to be positive integer.");if(!E(r))throw new c.InvalidArgumentsError("height to be positive integer.")}},{key:"copy",value:function(e,t,r){this.ensureItIsPossibleToCopy(e,t,r),this.clipboardOperations.copy(e,t,r)}},{key:"paste",value:function(e){var t=this.clipboardOperations.clipboard;if(void 0===t)throw new c.NothingToPasteError;if(this.clipboardOperations.isCutClipboard())this.moveCells(t.sourceLeftCorner,t.width,t.height,e);else if(this.clipboardOperations.isCopyClipboard()){this.clipboardOperations.ensureItIsPossibleToCopyPaste(e);var r=n.AbsoluteCellRange.spanFrom(e,t.width,t.height),o=this.operations.getRangeClipboardCells(r);this.undoRedo.clearRedoStack(),this.dependencyGraph.breakNumericMatricesInRange(r);var a=this.operations.restoreClipboardCells(t.sourceLeftCorner.sheet,t.getContent(e));this.undoRedo.saveOperation(new f.PasteUndoEntry(e,o,t.content,a))}}},{key:"beginUndoRedoBatchMode",value:function(){this.undoRedo.beginBatchMode()}},{key:"commitUndoRedoBatchMode",value:function(){this.undoRedo.commitBatchMode()}},{key:"isClipboardEmpty",value:function(){return void 0===this.clipboardOperations.clipboard}},{key:"clearClipboard",value:function(){this.clipboardOperations.clear()}},{key:"addSheet",value:function(e){e&&this.ensureItIsPossibleToAddSheet(e),this.undoRedo.clearRedoStack();var t=this.operations.addSheet(e);return this.undoRedo.saveOperation(new f.AddSheetUndoEntry(t)),t}},{key:"removeSheet",value:function(e){this.ensureSheetExists(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var t=this.sheetMapping.fetch(e),r=this.sheetMapping.fetchDisplayName(t),n=this.operations.getSheetClipboardCells(t),o=this.operations.removeSheet(e),a=o.version,i=o.scopedNamedExpressions;this.undoRedo.saveOperation(new f.RemoveSheetUndoEntry(r,t,n,i,a))}},{key:"renameSheet",value:function(e,t){this.ensureItIsPossibleToRenameSheet(e,t);var r=this.operations.renameSheet(e,t);return void 0!==r&&(this.undoRedo.clearRedoStack(),this.undoRedo.saveOperation(new f.RenameSheetUndoEntry(e,r,t))),r}},{key:"clearSheet",value:function(e){this.ensureSheetExists(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var t=this.sheetMapping.fetch(e),r=this.operations.getSheetClipboardCells(t);this.operations.clearSheet(t),this.undoRedo.saveOperation(new f.ClearSheetUndoEntry(t,r))}},{key:"setCellContents",value:function(e,t){if(t instanceof Array)for(var r=0;r<t.length;r++){if(!(t[r]instanceof Array))throw new c.InvalidArgumentsError("an array of arrays or a raw cell value.");for(var n=0;n<t[r].length;n++)if((0,a.isMatrix)(t[r][n]))throw new Error("Cant change matrices in batch operation")}else t=[[t]];this.ensureItIsPossibleToChangeCellContents(e,t),this.undoRedo.clearRedoStack();for(var o=[],i=0;i<t.length;i++)for(var u=0;u<t[i].length;u++){var s={sheet:e.sheet,row:e.row+i,col:e.col+u};this.clipboardOperations.abortCut();var l=this.operations.getClipboardCell(s);this.operations.setCellContent(s,t[i][u]),o.push({address:s,newContent:t[i][u],oldContent:l})}this.undoRedo.saveOperation(new f.SetCellContentsUndoEntry(o))}},{key:"setSheetContent",value:function(e,t){this.ensureSheetExists(e);var r=this.sheetMapping.fetch(e);this.ensureItIsPossibleToChangeSheetContents(r,t),(0,p.validateAsSheet)(t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var n=this.operations.getSheetClipboardCells(r);this.operations.setSheetContent(r,t),this.undoRedo.saveOperation(new f.SetSheetContentUndoEntry(r,n,t))}},{key:"setRowOrder",value:function(e,t){this.validateSwapRowIndexes(e,t),this.testRowOrderForMatrices(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var r=this.operations.setRowOrder(e,t);this.undoRedo.saveOperation(new f.SetRowOrderUndoEntry(e,t,r))}},{key:"validateSwapRowIndexes",value:function(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new c.NoSheetWithIdError(e);this.validateRowOrColumnMapping(e,t,"row")}},{key:"testColumnOrderForMatrices",value:function(e,t){var r,o=d(t);try{for(o.s();!(r=o.n()).done;){var a=h(r.value,2),i=a[0];if(i!==a[1]){var u=n.AbsoluteCellRange.spanFrom({sheet:e,col:i,row:0},1,1/0);if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRange(u))throw new c.SourceLocationHasMatrixError}}}catch(e){o.e(e)}finally{o.f()}}},{key:"setColumnOrder",value:function(e,t){this.validateSwapColumnIndexes(e,t),this.testColumnOrderForMatrices(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var r=this.operations.setColumnOrder(e,t);this.undoRedo.saveOperation(new f.SetColumnOrderUndoEntry(e,t,r))}},{key:"validateSwapColumnIndexes",value:function(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new c.NoSheetWithIdError(e);this.validateRowOrColumnMapping(e,t,"column")}},{key:"testRowOrderForMatrices",value:function(e,t){var r,o=d(t);try{for(o.s();!(r=o.n()).done;){var a=h(r.value,2),i=a[0];if(i!==a[1]){var u=n.AbsoluteCellRange.spanFrom({sheet:e,col:0,row:i},1/0,1);if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRange(u))throw new c.SourceLocationHasMatrixError}}}catch(e){o.e(e)}finally{o.f()}}},{key:"mappingFromOrder",value:function(e,t,r){if(!this.sheetMapping.hasSheetWithId(e))throw new c.NoSheetWithIdError(e);var n="row"===r?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e);if(t.length!==n)throw new c.InvalidArgumentsError("number of ".concat(r,"s provided to be sheet ").concat("row"===r?"height":"width","."));for(var o=[],a=0;a<n;a++)t[a]!==a&&o.push([a,t[a]]);return o}},{key:"validateRowOrColumnMapping",value:function(e,t,r){for(var n="row"===r?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e),o=t.map((function(e){var t=h(e,2),r=t[0];return t[1],r})).sort((function(e,t){return e-t})),a=t.map((function(e){var t=h(e,2);return t[0],t[1]})).sort((function(e,t){return e-t})),i=0;i<o.length;i++){if(!T(o[i])||o[i]>=n)throw new c.InvalidArgumentsError("".concat(r," numbers to be nonnegative integers and less than sheet ").concat("row"===r?"height":"width","."));if(o[i]===o[i+1])throw new c.InvalidArgumentsError("source ".concat(r," numbers to be unique."));if(o[i]!==a[i])throw new c.InvalidArgumentsError("target ".concat(r," numbers to be permutation of source ").concat(r," numbers."))}}},{key:"undo",value:function(){if(this.undoRedo.isUndoStackEmpty())throw new c.NoOperationToUndoError;this.clipboardOperations.abortCut(),this.undoRedo.undo()}},{key:"redo",value:function(){if(this.undoRedo.isRedoStackEmpty())throw new c.NoOperationToRedoError;this.clipboardOperations.abortCut(),this.undoRedo.redo()}},{key:"addNamedExpression",value:function(e,t,r,n){var o=this.scopeId(r);this.ensureNamedExpressionNameIsValid(e,o),this.operations.addNamedExpression(e,t,o,n),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new f.AddNamedExpressionUndoEntry(e,t,o,n))}},{key:"changeNamedExpressionExpression",value:function(e,t,r,n){var o=this.scopeId(t),a=h(this.operations.changeNamedExpressionExpression(e,r,o,n),2),i=a[0],u=a[1];this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new f.ChangeNamedExpressionUndoEntry(i,r,u,o,n))}},{key:"removeNamedExpression",value:function(e,t){var r=this.scopeId(t),n=h(this.operations.removeNamedExpression(e,r),2),o=n[0],a=n[1];return this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new f.RemoveNamedExpressionUndoEntry(o,a,r)),o}},{key:"ensureItIsPossibleToAddNamedExpression",value:function(e,t,r){var n=this.scopeId(r);this.ensureNamedExpressionNameIsValid(e,n),this.ensureNamedExpressionIsValid(t)}},{key:"ensureItIsPossibleToChangeNamedExpression",value:function(e,t,r){var n=this.scopeId(r);if(void 0===this.namedExpressions.namedExpressionForScope(e,n))throw new c.NamedExpressionDoesNotExistError(e);this.ensureNamedExpressionIsValid(t)}},{key:"isItPossibleToRemoveNamedExpression",value:function(e,t){var r=this.scopeId(t);if(void 0===this.namedExpressions.namedExpressionForScope(e,r))throw new c.NamedExpressionDoesNotExistError(e)}},{key:"ensureItIsPossibleToAddRows",value:function(e){if(!this.sheetMapping.hasSheetWithId(e))throw new c.NoSheetWithIdError(e);for(var t=this.dependencyGraph.getSheetHeight(e),r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];var a=n.map((function(e){return e[1]})).reduce((function(e,t){return e+t}),0);if(t+a>this.config.maxRows)throw new c.SheetSizeLimitExceededError;for(var i=0,u=n;i<u.length;i++){var s=h(u[i],2),l=s[0],f=s[1];if(!T(l)||!E(f))throw new c.InvalidArgumentsError("row number to be nonnegative and number of rows to add to be positive.");if(E(l)&&this.dependencyGraph.matrixMapping.isFormulaMatrixInRow(e,l-1)&&this.dependencyGraph.matrixMapping.isFormulaMatrixInRow(e,l))throw new c.TargetLocationHasMatrixError}}},{key:"ensureItIsPossibleToRemoveRows",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(var o=0,a=r;o<a.length;o++){var i=h(a[o],2),u=i[0],s=i[1],f=u+s-1;if(!T(u)||!T(f))throw new c.InvalidArgumentsError("starting and ending row to be nonnegative.");if(f<u)throw new c.InvalidArgumentsError("starting row to be smaller than the ending row.");var p=l.RowsSpan.fromRowStartAndEnd(e,u,f);if(!this.sheetMapping.hasSheetWithId(e))throw new c.NoSheetWithIdError(e);if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRows(p))throw new c.SourceLocationHasMatrixError}}},{key:"ensureItIsPossibleToAddColumns",value:function(e){if(!this.sheetMapping.hasSheetWithId(e))throw new c.NoSheetWithIdError(e);for(var t=this.dependencyGraph.getSheetWidth(e),r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];var a=n.map((function(e){return e[1]})).reduce((function(e,t){return e+t}),0);if(t+a>this.config.maxColumns)throw new c.SheetSizeLimitExceededError;for(var i=0,u=n;i<u.length;i++){var s=h(u[i],2),l=s[0],f=s[1];if(!T(l)||!E(f))throw new c.InvalidArgumentsError("column number to be nonnegative and number of columns to add to be positive.");if(E(l)&&this.dependencyGraph.matrixMapping.isFormulaMatrixInColumn(e,l-1)&&this.dependencyGraph.matrixMapping.isFormulaMatrixInColumn(e,l))throw new c.TargetLocationHasMatrixError}}},{key:"ensureItIsPossibleToRemoveColumns",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(var o=0,a=r;o<a.length;o++){var i=h(a[o],2),u=i[0],s=i[1],f=u+s-1;if(!T(u)||!T(f))throw new c.InvalidArgumentsError("starting and ending column to be nonnegative.");if(f<u)throw new c.InvalidArgumentsError("starting column to be smaller than the ending column.");var p=l.ColumnsSpan.fromColumnStartAndEnd(e,u,f);if(!this.sheetMapping.hasSheetWithId(e))throw new c.NoSheetWithIdError(e);if(this.dependencyGraph.matrixMapping.isFormulaMatrixInColumns(p))throw new c.SourceLocationHasMatrixError}}},{key:"ensureItIsPossibleToMoveRows",value:function(e,t,r,a){this.ensureItIsPossibleToAddRows(e,[a,r]);var i=(0,o.simpleCellAddress)(e,0,t),u=(0,o.simpleCellAddress)(e,0,a);if(!this.sheetMapping.hasSheetWithId(e)||(0,o.invalidSimpleCellAddress)(i)||(0,o.invalidSimpleCellAddress)(u)||!E(r)||a<=t+r&&a>=t)throw new c.InvalidArgumentsError("a valid range of rows to move.");var s=this.dependencyGraph.getSheetWidth(e),l=n.AbsoluteCellRange.spanFrom(i,s,r);if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRange(l))throw new c.SourceLocationHasMatrixError}},{key:"ensureItIsPossibleToMoveColumns",value:function(e,t,r,a){this.ensureItIsPossibleToAddColumns(e,[a,r]);var i=(0,o.simpleCellAddress)(e,t,0),u=(0,o.simpleCellAddress)(e,a,0);if(!this.sheetMapping.hasSheetWithId(e)||(0,o.invalidSimpleCellAddress)(i)||(0,o.invalidSimpleCellAddress)(u)||!E(r)||a<=t+r&&a>=t)throw new c.InvalidArgumentsError("a valid range of columns to move.");var s=this.dependencyGraph.getSheetHeight(e),l=n.AbsoluteCellRange.spanFrom(i,r,s);if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRange(l))throw new c.SourceLocationHasMatrixError}},{key:"ensureItIsPossibleToAddSheet",value:function(e){if(this.sheetMapping.hasSheetWithName(e))throw new c.SheetNameAlreadyTakenError(e)}},{key:"ensureItIsPossibleToRenameSheet",value:function(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new c.NoSheetWithIdError(e);var r=this.sheetMapping.get(t);if(void 0!==r&&r!==e)throw new c.SheetNameAlreadyTakenError(t)}},{key:"ensureItIsPossibleToChangeContent",value:function(e){if((0,o.invalidSimpleCellAddress)(e))throw new c.InvalidAddressError(e);if(!this.sheetMapping.hasSheetWithId(e.sheet))throw new c.NoSheetWithIdError(e.sheet);if(this.dependencyGraph.matrixMapping.isFormulaMatrixAtAddress(e))throw new c.SourceLocationHasMatrixError}},{key:"ensureItIsPossibleToChangeCellContents",value:function(e,t){var r=(0,p.findBoundaries)(t),o=n.AbsoluteCellRange.spanFrom(e,r.width,r.height);this.ensureRangeInSizeLimits(o);var a,i=d(o.addresses(this.dependencyGraph));try{for(i.s();!(a=i.n()).done;){var u=a.value;this.ensureItIsPossibleToChangeContent(u)}}catch(e){i.e(e)}finally{i.f()}}},{key:"ensureItIsPossibleToChangeSheetContents",value:function(e,t){var r=(0,p.findBoundaries)(t),a=n.AbsoluteCellRange.spanFrom((0,o.simpleCellAddress)(e,0,0),r.width,r.height);this.ensureRangeInSizeLimits(a)}},{key:"ensureRangeInSizeLimits",value:function(e){if(e.exceedsSheetSizeLimits(this.config.maxColumns,this.config.maxRows))throw new c.SheetSizeLimitExceededError}},{key:"isThereSomethingToUndo",value:function(){return!this.undoRedo.isUndoStackEmpty()}},{key:"isThereSomethingToRedo",value:function(){return!this.undoRedo.isRedoStackEmpty()}},{key:"getAndClearContentChanges",value:function(){return this.operations.getAndClearContentChanges()}},{key:"ensureSheetExists",value:function(e){if(!this.sheetMapping.hasSheetWithName(e))throw new c.NoSheetWithNameError(e)}},{key:"scopeId",value:function(e){if(void 0!==e)return this.ensureSheetExists(e),this.sheetMapping.fetch(e)}},{key:"sheetMapping",get:function(){return this.dependencyGraph.sheetMapping}},{key:"ensureNamedExpressionNameIsValid",value:function(e,t){if(!this.namedExpressions.isNameValid(e))throw new c.NamedExpressionNameIsInvalidError(e);if(!this.namedExpressions.isNameAvailable(e,t))throw new c.NamedExpressionNameIsAlreadyTakenError(e)}},{key:"ensureNamedExpressionIsValid",value:function(e){var t=this.cellContentParser.parse(e);if(t instanceof a.CellContent.MatrixFormula)throw new c.MatrixFormulasNotSupportedError;if(t instanceof a.CellContent.Formula){var r=this.parser.parse(t.formula,(0,o.simpleCellAddress)(-1,0,0));if((0,s.doesContainRelativeReferences)(r.ast))throw new c.NoRelativeAddressesAllowedError}}}])&&g(t.prototype,r),m&&g(t,m),e}();function E(e){return Number.isInteger(e)&&e>0}function T(e){return Number.isInteger(e)&&e>=0}t.CrudOperations=v},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(109),r(1),r(53),r(68),r(87),r(93),r(94),t.__esModule=!0,t.UndoRedo=t.BatchUndoEntry=t.ChangeNamedExpressionUndoEntry=t.RemoveNamedExpressionUndoEntry=t.AddNamedExpressionUndoEntry=t.PasteUndoEntry=t.SetCellContentsUndoEntry=t.ClearSheetUndoEntry=t.RenameSheetUndoEntry=t.RemoveSheetUndoEntry=t.AddSheetUndoEntry=t.RemoveColumnsUndoEntry=t.AddColumnsUndoEntry=t.MoveColumnsUndoEntry=t.MoveRowsUndoEntry=t.SetSheetContentUndoEntry=t.SetColumnOrderUndoEntry=t.SetRowOrderUndoEntry=t.AddRowsUndoEntry=t.MoveCellsUndoEntry=t.RemoveRowsUndoEntry=t.BaseUndoEntry=void 0,r(120),r(67),r(95),r(210),r(63),r(77),r(97),r(236);var o=r(115),a=r(273);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=s(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}function s(e,t){if(e){if("string"==typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),e}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y(e);if(t){var o=y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return m(this,r)}}function m(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var v=function e(){g(this,e)};t.BaseUndoEntry=v;var E=function(e){p(r,e);var t=d(r);function r(e,n){var o;return g(this,r),(o=t.call(this)).command=e,o.rowsRemovals=n,o}return f(r,[{key:"doUndo",value:function(e){e.undoRemoveRows(this)}},{key:"doRedo",value:function(e){e.redoRemoveRows(this)}}]),r}(v);t.RemoveRowsUndoEntry=E;var T=function(e){p(r,e);var t=d(r);function r(e,n,o,a,i,u,s){var c;return g(this,r),(c=t.call(this)).sourceLeftCorner=e,c.width=n,c.height=o,c.destinationLeftCorner=a,c.overwrittenCellsData=i,c.addedGlobalNamedExpressions=u,c.version=s,c}return f(r,[{key:"doUndo",value:function(e){e.undoMoveCells(this)}},{key:"doRedo",value:function(e){e.redoMoveCells(this)}}]),r}(v);t.MoveCellsUndoEntry=T;var b=function(e){p(r,e);var t=d(r);function r(e){var n;return g(this,r),(n=t.call(this)).command=e,n}return f(r,[{key:"doUndo",value:function(e){e.undoAddRows(this)}},{key:"doRedo",value:function(e){e.redoAddRows(this)}}]),r}(v);t.AddRowsUndoEntry=b;var R=function(e){p(r,e);var t=d(r);function r(e,n,o){var a;return g(this,r),(a=t.call(this)).sheetId=e,a.rowMapping=n,a.oldContent=o,a}return f(r,[{key:"doUndo",value:function(e){e.undoSetRowOrder(this)}},{key:"doRedo",value:function(e){e.redoSetRowOrder(this)}}]),r}(v);t.SetRowOrderUndoEntry=R;var A=function(e){p(r,e);var t=d(r);function r(e,n,o){var a;return g(this,r),(a=t.call(this)).sheetId=e,a.columnMapping=n,a.oldContent=o,a}return f(r,[{key:"doUndo",value:function(e){e.undoSetColumnOrder(this)}},{key:"doRedo",value:function(e){e.redoSetColumnOrder(this)}}]),r}(v);t.SetColumnOrderUndoEntry=A;var S=function(e){p(r,e);var t=d(r);function r(e,n,o){var a;return g(this,r),(a=t.call(this)).sheetId=e,a.oldSheetContent=n,a.newSheetContent=o,a}return f(r,[{key:"doUndo",value:function(e){e.undoSetSheetContent(this)}},{key:"doRedo",value:function(e){e.redoSetSheetContent(this)}}]),r}(v);t.SetSheetContentUndoEntry=S;var N=function(e){p(r,e);var t=d(r);function r(e,n,o,a,i){var u;return g(this,r),(u=t.call(this)).sheet=e,u.startRow=n,u.numberOfRows=o,u.targetRow=a,u.version=i,u.undoStart=u.startRow<u.targetRow?u.targetRow-u.numberOfRows:u.targetRow,u.undoEnd=u.startRow>u.targetRow?u.startRow+u.numberOfRows:u.startRow,u}return f(r,[{key:"doUndo",value:function(e){e.undoMoveRows(this)}},{key:"doRedo",value:function(e){e.redoMoveRows(this)}}]),r}(v);t.MoveRowsUndoEntry=N;var O=function(e){p(r,e);var t=d(r);function r(e,n,o,a,i){var u;return g(this,r),(u=t.call(this)).sheet=e,u.startColumn=n,u.numberOfColumns=o,u.targetColumn=a,u.version=i,u.undoStart=u.startColumn<u.targetColumn?u.targetColumn-u.numberOfColumns:u.targetColumn,u.undoEnd=u.startColumn>u.targetColumn?u.startColumn+u.numberOfColumns:u.startColumn,u}return f(r,[{key:"doUndo",value:function(e){e.undoMoveColumns(this)}},{key:"doRedo",value:function(e){e.redoMoveColumns(this)}}]),r}(v);t.MoveColumnsUndoEntry=O;var C=function(e){p(r,e);var t=d(r);function r(e){var n;return g(this,r),(n=t.call(this)).command=e,n}return f(r,[{key:"doUndo",value:function(e){e.undoAddColumns(this)}},{key:"doRedo",value:function(e){e.redoAddColumns(this)}}]),r}(v);t.AddColumnsUndoEntry=C;var w=function(e){p(r,e);var t=d(r);function r(e,n){var o;return g(this,r),(o=t.call(this)).command=e,o.columnsRemovals=n,o}return f(r,[{key:"doUndo",value:function(e){e.undoRemoveColumns(this)}},{key:"doRedo",value:function(e){e.redoRemoveColumns(this)}}]),r}(v);t.RemoveColumnsUndoEntry=w;var M=function(e){p(r,e);var t=d(r);function r(e){var n;return g(this,r),(n=t.call(this)).sheetName=e,n}return f(r,[{key:"doUndo",value:function(e){e.undoAddSheet(this)}},{key:"doRedo",value:function(e){e.redoAddSheet(this)}}]),r}(v);t.AddSheetUndoEntry=M;var I=function(e){p(r,e);var t=d(r);function r(e,n,o,a,i){var u;return g(this,r),(u=t.call(this)).sheetName=e,u.sheetId=n,u.oldSheetContent=o,u.scopedNamedExpressions=a,u.version=i,u}return f(r,[{key:"doUndo",value:function(e){e.undoRemoveSheet(this)}},{key:"doRedo",value:function(e){e.redoRemoveSheet(this)}}]),r}(v);t.RemoveSheetUndoEntry=I;var x=function(e){p(r,e);var t=d(r);function r(e,n,o){var a;return g(this,r),(a=t.call(this)).sheetId=e,a.oldName=n,a.newName=o,a}return f(r,[{key:"doUndo",value:function(e){e.undoRenameSheet(this)}},{key:"doRedo",value:function(e){e.redoRenameSheet(this)}}]),r}(v);t.RenameSheetUndoEntry=x;var k=function(e){p(r,e);var t=d(r);function r(e,n){var o;return g(this,r),(o=t.call(this)).sheetId=e,o.oldSheetContent=n,o}return f(r,[{key:"doUndo",value:function(e){e.undoClearSheet(this)}},{key:"doRedo",value:function(e){e.redoClearSheet(this)}}]),r}(v);t.ClearSheetUndoEntry=k;var _=function(e){p(r,e);var t=d(r);function r(e){var n;return g(this,r),(n=t.call(this)).cellContents=e,n}return f(r,[{key:"doUndo",value:function(e){e.undoSetCellContents(this)}},{key:"doRedo",value:function(e){e.redoSetCellContents(this)}}]),r}(v);t.SetCellContentsUndoEntry=_;var P=function(e){p(r,e);var t=d(r);function r(e,n,o,a){var i;return g(this,r),(i=t.call(this)).targetLeftCorner=e,i.oldContent=n,i.newContent=o,i.addedGlobalNamedExpressions=a,i}return f(r,[{key:"doUndo",value:function(e){e.undoPaste(this)}},{key:"doRedo",value:function(e){e.redoPaste(this)}}]),r}(v);t.PasteUndoEntry=P;var L=function(e){p(r,e);var t=d(r);function r(e,n,o,a){var i;return g(this,r),(i=t.call(this)).name=e,i.newContent=n,i.scope=o,i.options=a,i}return f(r,[{key:"doUndo",value:function(e){e.undoAddNamedExpression(this)}},{key:"doRedo",value:function(e){e.redoAddNamedExpression(this)}}]),r}(v);t.AddNamedExpressionUndoEntry=L;var F=function(e){p(r,e);var t=d(r);function r(e,n,o){var a;return g(this,r),(a=t.call(this)).namedExpression=e,a.content=n,a.scope=o,a}return f(r,[{key:"doUndo",value:function(e){e.undoRemoveNamedExpression(this)}},{key:"doRedo",value:function(e){e.redoRemoveNamedExpression(this)}}]),r}(v);t.RemoveNamedExpressionUndoEntry=F;var U=function(e){p(r,e);var t=d(r);function r(e,n,o,a,i){var u;return g(this,r),(u=t.call(this)).namedExpression=e,u.newContent=n,u.oldContent=o,u.scope=a,u.options=i,u}return f(r,[{key:"doUndo",value:function(e){e.undoChangeNamedExpression(this)}},{key:"doRedo",value:function(e){e.redoChangeNamedExpression(this)}}]),r}(v);t.ChangeNamedExpressionUndoEntry=U;var V=function(e){p(r,e);var t=d(r);function r(){var e;return g(this,r),(e=t.apply(this,arguments)).operations=[],e}return f(r,[{key:"add",value:function(e){this.operations.push(e)}},{key:"reversedOperations",value:regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.operations.length-1;case 1:if(!(t>=0)){e.next=7;break}return e.next=4,this.operations[t];case 4:t--,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))},{key:"doUndo",value:function(e){e.undoBatch(this)}},{key:"doRedo",value:function(e){e.redoBatch(this)}}]),r}(v);t.BatchUndoEntry=V;var D=function(){function e(t,r){g(this,e),this.operations=r,this.undoStack=[],this.redoStack=[],this.oldData=new Map,this.undoLimit=t.undoLimit}return f(e,[{key:"saveOperation",value:function(e){void 0!==this.batchUndoEntry?this.batchUndoEntry.add(e):this.addUndoEntry(e)}},{key:"beginBatchMode",value:function(){this.batchUndoEntry=new V}},{key:"addUndoEntry",value:function(e){this.undoStack.push(e),this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}},{key:"commitBatchMode",value:function(){if(void 0===this.batchUndoEntry)throw"Batch mode wasn't started";this.addUndoEntry(this.batchUndoEntry),this.batchUndoEntry=void 0}},{key:"storeDataForVersion",value:function(e,t,r){this.oldData.has(e)||this.oldData.set(e,[]),this.oldData.get(e).push([t,r])}},{key:"clearRedoStack",value:function(){this.redoStack=[]}},{key:"clearUndoStack",value:function(){this.undoStack=[]}},{key:"isUndoStackEmpty",value:function(){return 0===this.undoStack.length}},{key:"isRedoStackEmpty",value:function(){return 0===this.redoStack.length}},{key:"undo",value:function(){var e=this.undoStack.pop();if(!e)throw"Attempted to undo without operation on stack";this.undoEntry(e),this.redoStack.push(e)}},{key:"undoEntry",value:function(e){e.doUndo(this)}},{key:"undoBatch",value:function(e){var t,r=u(e.reversedOperations());try{for(r.s();!(t=r.n()).done;){var n=t.value;this.undoEntry(n)}}catch(e){r.e(e)}finally{r.f()}}},{key:"undoRemoveRows",value:function(e){this.operations.forceApplyPostponedTransformations();for(var t=e.command.sheet,r=e.rowsRemovals,n=r.length-1;n>=0;--n){var o=r[n];this.operations.addRows(new a.AddRowsCommand(t,[[o.rowFrom,o.rowCount]]));var i,s=u(o.removedCells);try{for(s.s();!(i=s.n()).done;){var c=i.value,l=c.address,f=c.cellType;this.operations.restoreCell(l,f)}}catch(e){s.e(e)}finally{s.f()}this.restoreOldDataFromVersion(o.version-1)}}},{key:"undoRemoveColumns",value:function(e){this.operations.forceApplyPostponedTransformations();for(var t=e.command.sheet,r=e.columnsRemovals,n=r.length-1;n>=0;--n){var o=r[n];this.operations.addColumns(new a.AddColumnsCommand(t,[[o.columnFrom,o.columnCount]]));var i,s=u(o.removedCells);try{for(s.s();!(i=s.n()).done;){var c=i.value,l=c.address,f=c.cellType;this.operations.restoreCell(l,f)}}catch(e){s.e(e)}finally{s.f()}this.restoreOldDataFromVersion(o.version-1)}}},{key:"undoAddRows",value:function(e){for(var t=e.command.rowsSpans(),r=t.length-1;r>=0;--r){var n=t[r];this.operations.removeRows(new a.RemoveRowsCommand(e.command.sheet,[[n.rowStart,n.numberOfRows]]))}}},{key:"undoAddColumns",value:function(e){for(var t=e.command.columnsSpans(),r=t.length-1;r>=0;--r){var n=t[r];this.operations.removeColumns(new a.RemoveColumnsCommand(e.command.sheet,[[n.columnStart,n.numberOfColumns]]))}}},{key:"undoSetCellContents",value:function(e){var t,r=u(e.cellContents);try{for(r.s();!(t=r.n()).done;){var n=t.value;this.operations.restoreCell(n.address,n.oldContent)}}catch(e){r.e(e)}finally{r.f()}}},{key:"undoPaste",value:function(e){this.restoreOperationOldContent(e.oldContent);var t,r=u(e.addedGlobalNamedExpressions);try{for(r.s();!(t=r.n()).done;){var n=t.value;this.operations.removeNamedExpression(n)}}catch(e){r.e(e)}finally{r.f()}}},{key:"undoMoveRows",value:function(e){var t=e.sheet;this.operations.moveRows(t,e.undoStart,e.numberOfRows,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}},{key:"undoMoveColumns",value:function(e){var t=e.sheet;this.operations.moveColumns(t,e.undoStart,e.numberOfColumns,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}},{key:"undoMoveCells",value:function(e){this.operations.forceApplyPostponedTransformations(),this.operations.moveCells(e.destinationLeftCorner,e.width,e.height,e.sourceLeftCorner),this.restoreOperationOldContent(e.overwrittenCellsData),this.restoreOldDataFromVersion(e.version-1);var t,r=u(e.addedGlobalNamedExpressions);try{for(r.s();!(t=r.n()).done;){var n=t.value;this.operations.removeNamedExpression(n)}}catch(e){r.e(e)}finally{r.f()}}},{key:"undoAddSheet",value:function(e){var t=e.sheetName;this.operations.removeSheet(t)}},{key:"undoRemoveSheet",value:function(e){this.operations.forceApplyPostponedTransformations();var t=e.oldSheetContent,r=e.sheetId;this.operations.addSheet(e.sheetName);for(var n=0;n<t.length;n++)for(var a=t[n],s=0;s<a.length;s++){var c=a[s],l=(0,o.simpleCellAddress)(r,s,n);this.operations.restoreCell(l,c)}var f,p=u(e.scopedNamedExpressions);try{for(p.s();!(f=p.n()).done;){var h=i(f.value,2),d=h[0],m=h[1];this.operations.restoreNamedExpression(d,m,r)}}catch(e){p.e(e)}finally{p.f()}this.restoreOldDataFromVersion(e.version-1)}},{key:"undoRenameSheet",value:function(e){this.operations.renameSheet(e.sheetId,e.oldName)}},{key:"undoClearSheet",value:function(e){for(var t=e.oldSheetContent,r=e.sheetId,n=0;n<t.length;n++)for(var a=t[n],i=0;i<a.length;i++){var u=a[i],s=(0,o.simpleCellAddress)(r,i,n);this.operations.restoreCell(s,u)}}},{key:"undoSetSheetContent",value:function(e){var t=e.oldSheetContent,r=e.sheetId;this.operations.clearSheet(r);for(var n=0;n<t.length;n++)for(var a=t[n],i=0;i<a.length;i++){var u=a[i],s=(0,o.simpleCellAddress)(r,i,n);this.operations.restoreCell(s,u)}}},{key:"undoAddNamedExpression",value:function(e){this.operations.removeNamedExpression(e.name,e.scope)}},{key:"undoRemoveNamedExpression",value:function(e){this.operations.restoreNamedExpression(e.namedExpression,e.content,e.scope)}},{key:"undoChangeNamedExpression",value:function(e){this.operations.restoreNamedExpression(e.namedExpression,e.oldContent,e.scope)}},{key:"undoSetRowOrder",value:function(e){this.restoreOperationOldContent(e.oldContent)}},{key:"undoSetColumnOrder",value:function(e){this.restoreOperationOldContent(e.oldContent)}},{key:"restoreOperationOldContent",value:function(e){var t,r=u(e);try{for(r.s();!(t=r.n()).done;){var n=i(t.value,2),o=n[0],a=n[1];this.operations.restoreCell(o,a)}}catch(e){r.e(e)}finally{r.f()}}},{key:"redo",value:function(){var e=this.redoStack.pop();if(!e)throw"Attempted to redo without operation on stack";this.redoEntry(e),this.undoStack.push(e)}},{key:"redoEntry",value:function(e){e.doRedo(this)}},{key:"redoBatch",value:function(e){var t,r=u(e.operations);try{for(r.s();!(t=r.n()).done;){var n=t.value;this.redoEntry(n)}}catch(e){r.e(e)}finally{r.f()}}},{key:"redoRemoveRows",value:function(e){this.operations.removeRows(e.command)}},{key:"redoMoveCells",value:function(e){this.operations.moveCells(e.sourceLeftCorner,e.width,e.height,e.destinationLeftCorner)}},{key:"redoRemoveColumns",value:function(e){this.operations.removeColumns(e.command)}},{key:"redoPaste",value:function(e){for(var t=e.targetLeftCorner,r=e.newContent,n=r.length,a=r[0].length,i=0;i<n;++i)for(var u=0;u<a;++u){var s=(0,o.simpleCellAddress)(t.sheet,t.col+u,t.row+i);this.operations.restoreCell(s,r[i][u])}}},{key:"redoSetCellContents",value:function(e){var t,r=u(e.cellContents);try{for(r.s();!(t=r.n()).done;){var n=t.value;this.operations.setCellContent(n.address,n.newContent)}}catch(e){r.e(e)}finally{r.f()}}},{key:"redoAddRows",value:function(e){this.operations.addRows(e.command)}},{key:"redoAddColumns",value:function(e){this.operations.addColumns(e.command)}},{key:"redoRemoveSheet",value:function(e){this.operations.removeSheet(e.sheetName)}},{key:"redoAddSheet",value:function(e){this.operations.addSheet(e.sheetName)}},{key:"redoRenameSheet",value:function(e){this.operations.renameSheet(e.sheetId,e.newName)}},{key:"redoMoveRows",value:function(e){this.operations.moveRows(e.sheet,e.startRow,e.numberOfRows,e.targetRow)}},{key:"redoMoveColumns",value:function(e){this.operations.moveColumns(e.sheet,e.startColumn,e.numberOfColumns,e.targetColumn)}},{key:"redoClearSheet",value:function(e){this.operations.clearSheet(e.sheetId)}},{key:"redoSetSheetContent",value:function(e){var t=e.sheetId,r=e.newSheetContent;this.operations.setSheetContent(t,r)}},{key:"redoAddNamedExpression",value:function(e){this.operations.addNamedExpression(e.name,e.newContent,e.scope,e.options)}},{key:"redoRemoveNamedExpression",value:function(e){this.operations.removeNamedExpression(e.namedExpression.displayName,e.scope)}},{key:"redoChangeNamedExpression",value:function(e){this.operations.changeNamedExpressionExpression(e.namedExpression.displayName,e.newContent,e.scope,e.options)}},{key:"redoSetRowOrder",value:function(e){this.operations.setRowOrder(e.sheetId,e.rowMapping)}},{key:"redoSetColumnOrder",value:function(e){this.operations.setColumnOrder(e.sheetId,e.columnMapping)}},{key:"restoreOldDataFromVersion",value:function(e){var t,r=u(this.oldData.get(e)||[]);try{for(r.s();!(t=r.n()).done;){var n=i(t.value,2),o=n[0],a=n[1];this.operations.setFormulaToCellFromCache(a,o)}}catch(e){r.e(e)}finally{r.f()}}}]),e}();t.UndoRedo=D},function(e,t,r){"use strict";r(53),r(63),r(67),r(68),r(77),r(87),r(93),r(94),r(95),r(97),t.__esModule=!0,t.Evaluator=void 0,r(126);var n=r(135),o=r(220),a=r(115),i=r(222),u=r(275),s=r(118),c=r(215),l=r(304),f=r(223),p=r(235),h=r(224);function d(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var g=function(){function e(t,r,n,o,a,i,u,s,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dependencyGraph=t,this.columnSearch=r,this.config=n,this.stats=o,this.dateHelper=a,this.numberLiteralsHelper=i,this.functionRegistry=u,this.namedExpressions=s,this.serialization=c,this.interpreter=new l.Interpreter(this.dependencyGraph,this.columnSearch,this.config,this.stats,this.dateHelper,this.numberLiteralsHelper,this.functionRegistry,this.namedExpressions,this.serialization)}var t,r,m;return t=e,(r=[{key:"run",value:function(){var e=this;this.stats.start(h.StatType.TOP_SORT);var t=this.dependencyGraph.topSortWithScc(),r=t.sorted,n=t.cycled;this.stats.end(h.StatType.TOP_SORT),this.stats.measure(h.StatType.EVALUATION,(function(){e.recomputeFormulas(n,r)}))}},{key:"partialRun",value:function(e){var t=this,r=new u.ContentChanges;return this.stats.measure(h.StatType.EVALUATION,(function(){t.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(e,(function(e){if(e instanceof s.FormulaCellVertex){var n=e.getAddress(t.dependencyGraph.lazilyTransformingAstService),o=e.getFormula(t.dependencyGraph.lazilyTransformingAstService),a=e.isComputed()?e.getCellValue():null,u=t.evaluateAstToCellValue(o,n);return e.setCellValue(u),u!==a&&(r.addChange(u,n),t.columnSearch.change((0,f.getRawValue)(a),(0,f.getRawValue)(u),n),!0)}if(e instanceof s.MatrixVertex&&e.isFormula()){var c=e.getAddress(),l=e.getFormula(),h=e.isComputed()?e.getCellValue():null,d=t.evaluateAstToRangeValue(l,c);if(d instanceof i.SimpleRangeValue){var m=new p.Matrix(d.rawNumbers());e.setCellValue(m),r.addMatrixChange(m,c),t.columnSearch.change(h,m,c)}else e.setErrorValue(d),r.addChange(d,c),t.columnSearch.change(h,d,c);return!0}return!(e instanceof s.RangeVertex&&(e.clearCache(),0))}),(function(e){if(e instanceof s.RangeVertex)e.clearCache();else if(e instanceof s.FormulaCellVertex){var n=e.getAddress(t.dependencyGraph.lazilyTransformingAstService);t.columnSearch.remove((0,f.getRawValue)(e.valueOrNull()),n);var o=new a.CellError(a.ErrorType.CYCLE,void 0,e.address);e.setCellValue(o),r.addChange(o,e.address)}}))})),r}},{key:"destroy",value:function(){this.interpreter.destroy()}},{key:"runAndForget",value:function(e,t,r){var a,i=this,u=[],c=d((0,o.absolutizeDependencies)(r,t));try{for(c.s();!(a=c.n()).done;){var l=a.value;if(l instanceof n.AbsoluteCellRange){var f=l;if(void 0===this.dependencyGraph.getRange(f.start,f.end)){var p=new s.RangeVertex(f);this.dependencyGraph.rangeMapping.setRange(p),u.push(p)}}}}catch(e){c.e(e)}finally{c.f()}var h=this.evaluateAstToCellValue(e,t);return u.forEach((function(e){i.dependencyGraph.rangeMapping.removeRange(e)})),h}},{key:"recomputeFormulas",value:function(e,t){var r=this;e.forEach((function(e){e instanceof s.FormulaCellVertex&&e.setCellValue(new a.CellError(a.ErrorType.CYCLE,void 0,e.address))})),t.forEach((function(e){if(e instanceof s.FormulaCellVertex){var t=e.getAddress(r.dependencyGraph.lazilyTransformingAstService),n=e.getFormula(r.dependencyGraph.lazilyTransformingAstService),o=r.evaluateAstToCellValue(n,t);e.setCellValue(o),r.columnSearch.add((0,f.getRawValue)(o),t)}else if(e instanceof s.MatrixVertex&&e.isFormula()){var a=e.getAddress(),u=e.getFormula(),c=r.evaluateAstToRangeValue(u,a);if(c instanceof i.SimpleRangeValue){var l=new p.Matrix(c.rawNumbers());e.setCellValue(l),r.columnSearch.add(l,a)}else e.setErrorValue(c),r.columnSearch.add(c,a)}else e instanceof s.RangeVertex&&e.clearCache()}))}},{key:"evaluateAstToCellValue",value:function(e,t){var r=this.interpreter.evaluateAst(e,t);return r instanceof i.SimpleRangeValue?r:r===f.EmptyValue&&this.config.evaluateNullToZero?0:r}},{key:"evaluateAstToRangeValue",value:function(e,t){var r=this.interpreter.evaluateAst(e,t);return r instanceof a.CellError||r instanceof i.SimpleRangeValue&&r.hasOnlyNumbers()?r:new a.CellError(a.ErrorType.VALUE,c.ErrorMessage.CellRangeExpected)}}])&&y(t.prototype,r),m&&y(t,m),e}();t.Evaluator=g},function(e,t,r){"use strict";r(87),r(93),r(63),r(94),r(95),r(77),r(97),r(53),r(67),r(68),t.__esModule=!0,t.Interpreter=void 0,r(125);var n=r(135),o=r(115),a=r(215),i=r(235),u=r(207),s=r(271),c=r(305),l=r(306),f=r(223),p=r(222);function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var y=function(){function e(t,r,n,o,a,i,u,l,f){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dependencyGraph=t,this.columnSearch=r,this.config=n,this.stats=o,this.dateHelper=a,this.numberLiteralsHelper=i,this.functionRegistry=u,this.namedExpressions=l,this.serialization=f,this.functionRegistry.initializePlugins(this),this.arithmeticHelper=new s.ArithmeticHelper(n,a,i),this.criterionBuilder=new c.CriterionBuilder(n)}var t,r,d;return t=e,(r=[{key:"evaluateAst",value:function(e,t){var r=this.evaluateAstWithoutPostprocessing(e,t);if((0,f.isExtendedNumber)(r)){if((0,s.isNumberOverflow)((0,f.getRawValue)(r)))return new o.CellError(o.ErrorType.NUM,a.ErrorMessage.NaN);r=(0,f.cloneNumber)(r,(0,s.fixNegativeZero)((0,f.getRawValue)(r)))}return function(e,t){return e instanceof o.CellError?e.attachAddress(t):e}(r,t)}},{key:"evaluateAstWithoutPostprocessing",value:function(e,t){var r,c,d,m,y,T,b,R,A,S,N,O;switch(e.type){case u.AstNodeType.EMPTY:return f.EmptyValue;case u.AstNodeType.CELL_REFERENCE:var C=e.reference.toSimpleCellAddress(t);return(0,o.invalidSimpleCellAddress)(C)?new o.CellError(o.ErrorType.REF,a.ErrorMessage.BadRef):this.dependencyGraph.getCellValue(C);case u.AstNodeType.NUMBER:case u.AstNodeType.STRING:return e.value;case u.AstNodeType.CONCATENATE_OP:var w=this.evaluateAst(e.left,t),M=this.evaluateAst(e.right,t);return null!==(r=g(w,M))&&void 0!==r?r:E(this.arithmeticHelper.concat,(0,s.coerceScalarToString)(w),(0,s.coerceScalarToString)(M));case u.AstNodeType.EQUALS_OP:var I=this.evaluateAst(e.left,t),x=this.evaluateAst(e.right,t);return null!==(c=g(I,x))&&void 0!==c?c:this.arithmeticHelper.eq(I,x);case u.AstNodeType.NOT_EQUAL_OP:var k=this.evaluateAst(e.left,t),_=this.evaluateAst(e.right,t);return null!==(d=g(k,_))&&void 0!==d?d:this.arithmeticHelper.neq(k,_);case u.AstNodeType.GREATER_THAN_OP:var P=this.evaluateAst(e.left,t),L=this.evaluateAst(e.right,t);return null!==(m=g(P,L))&&void 0!==m?m:this.arithmeticHelper.gt(P,L);case u.AstNodeType.LESS_THAN_OP:var F=this.evaluateAst(e.left,t),U=this.evaluateAst(e.right,t);return null!==(y=g(F,U))&&void 0!==y?y:this.arithmeticHelper.lt(F,U);case u.AstNodeType.GREATER_THAN_OR_EQUAL_OP:var V=this.evaluateAst(e.left,t),D=this.evaluateAst(e.right,t);return null!==(T=g(V,D))&&void 0!==T?T:this.arithmeticHelper.geq(V,D);case u.AstNodeType.LESS_THAN_OR_EQUAL_OP:var j=this.evaluateAst(e.left,t),B=this.evaluateAst(e.right,t);return null!==(b=g(j,B))&&void 0!==b?b:this.arithmeticHelper.leq(j,B);case u.AstNodeType.PLUS_OP:var G=this.evaluateAst(e.left,t),W=this.evaluateAst(e.right,t);return null!==(R=g(G,W))&&void 0!==R?R:E(this.arithmeticHelper.addWithEpsilon,this.arithmeticHelper.coerceScalarToNumberOrError(G),this.arithmeticHelper.coerceScalarToNumberOrError(W));case u.AstNodeType.MINUS_OP:var H=this.evaluateAst(e.left,t),z=this.evaluateAst(e.right,t);return null!==(A=g(H,z))&&void 0!==A?A:E(this.arithmeticHelper.subtract,this.arithmeticHelper.coerceScalarToNumberOrError(H),this.arithmeticHelper.coerceScalarToNumberOrError(z));case u.AstNodeType.TIMES_OP:var Y=this.evaluateAst(e.left,t),X=this.evaluateAst(e.right,t);return null!==(S=g(Y,X))&&void 0!==S?S:E(this.arithmeticHelper.multiply,this.arithmeticHelper.coerceScalarToNumberOrError(Y),this.arithmeticHelper.coerceScalarToNumberOrError(X));case u.AstNodeType.POWER_OP:var K=this.evaluateAst(e.left,t),q=this.evaluateAst(e.right,t);return null!==(N=g(K,q))&&void 0!==N?N:E(this.arithmeticHelper.pow,this.arithmeticHelper.coerceScalarToNumberOrError(K),this.arithmeticHelper.coerceScalarToNumberOrError(q));case u.AstNodeType.DIV_OP:var Q=this.evaluateAst(e.left,t),$=this.evaluateAst(e.right,t);return null!==(O=g(Q,$))&&void 0!==O?O:E(this.arithmeticHelper.divide,this.arithmeticHelper.coerceScalarToNumberOrError(Q),this.arithmeticHelper.coerceScalarToNumberOrError($));case u.AstNodeType.PLUS_UNARY_OP:var Z=this.evaluateAst(e.value,t);return Z instanceof p.SimpleRangeValue?new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.ScalarExpected):(0,f.isExtendedNumber)(Z)?this.arithmeticHelper.unaryPlus(Z):Z;case u.AstNodeType.MINUS_UNARY_OP:var J=this.evaluateAst(e.value,t);return J instanceof p.SimpleRangeValue?new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.ScalarExpected):v(this.arithmeticHelper.unaryMinus,this.arithmeticHelper.coerceScalarToNumberOrError(J));case u.AstNodeType.PERCENT_OP:var ee=this.evaluateAst(e.value,t);return ee instanceof p.SimpleRangeValue?new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.ScalarExpected):v(this.arithmeticHelper.unaryPercent,this.arithmeticHelper.coerceScalarToNumberOrError(ee));case u.AstNodeType.FUNCTION_CALL:if("valid"!==this.config.licenseKeyValidityState&&!l.FunctionRegistry.functionIsProtected(e.procedureName))return new o.CellError(o.ErrorType.LIC,a.ErrorMessage.LicenseKey(this.config.licenseKeyValidityState));var te=this.functionRegistry.getFunction(e.procedureName);if(te&&this.config.translationPackage.isFunctionTranslated(e.procedureName)){var re=h(te,2),ne=re[0];return re[1][ne](e,t)}return new o.CellError(o.ErrorType.NAME,a.ErrorMessage.FunctionName(e.procedureName));case u.AstNodeType.NAMED_EXPRESSION:var oe=this.namedExpressions.nearestNamedExpression(e.expressionName,t.sheet);return oe?this.dependencyGraph.getCellValue(oe.address):new o.CellError(o.ErrorType.NAME,a.ErrorMessage.NamedExpressionName(e.expressionName));case u.AstNodeType.CELL_RANGE:if(!this.rangeSpansOneSheet(e))return new o.CellError(o.ErrorType.REF,a.ErrorMessage.RangeManySheets);var ae=n.AbsoluteCellRange.fromCellRange(e,t),ie=this.dependencyGraph.getMatrix(ae);if(ie){var ue=ie.matrix;if(ue instanceof i.NotComputedMatrix)throw new Error("Matrix should be already computed");if(ue instanceof o.CellError)return ue;if(ue instanceof i.Matrix)return p.SimpleRangeValue.onlyNumbersDataWithRange(ue.raw(),ue.size,ae);throw new Error("Unknown matrix")}return p.SimpleRangeValue.onlyRange(ae,this.dependencyGraph);case u.AstNodeType.COLUMN_RANGE:if(!this.rangeSpansOneSheet(e))return new o.CellError(o.ErrorType.REF,a.ErrorMessage.RangeManySheets);var se=n.AbsoluteColumnRange.fromColumnRange(e,t);return p.SimpleRangeValue.onlyRange(se,this.dependencyGraph);case u.AstNodeType.ROW_RANGE:if(!this.rangeSpansOneSheet(e))return new o.CellError(o.ErrorType.REF,a.ErrorMessage.RangeManySheets);var ce=n.AbsoluteRowRange.fromRowRange(e,t);return p.SimpleRangeValue.onlyRange(ce,this.dependencyGraph);case u.AstNodeType.PARENTHESIS:return this.evaluateAst(e.expression,t);case u.AstNodeType.ERROR_WITH_RAW_INPUT:case u.AstNodeType.ERROR:return e.error}}},{key:"getGpuInstance",value:function(){var e=this.config.gpuMode,t=this.config.gpujs;if(void 0===t)throw Error("Cannot instantiate GPU.js. Constructor not provided.");return this.gpu||(this.gpu=new t({mode:e})),this.gpu}},{key:"destroy",value:function(){this.gpu&&this.gpu.destroy()}},{key:"rangeSpansOneSheet",value:function(e){return e.start.sheet===e.end.sheet}}])&&m(t.prototype,r),d&&m(t,d),e}();function g(e,t){return e instanceof o.CellError?e:e instanceof p.SimpleRangeValue?new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.ScalarExpected):t instanceof o.CellError?t:t instanceof p.SimpleRangeValue?new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.ScalarExpected):void 0}function v(e,t){return t instanceof o.CellError?t:e(t)}function E(e,t,r){return t instanceof o.CellError?t:r instanceof o.CellError?r:e(t,r)}t.Interpreter=y},function(e,t,r){"use strict";t.__esModule=!0,t.buildCriterionLambda=t.CriterionBuilder=t.buildCriterion=t.CriterionType=void 0,r(146);var n,o=r(223);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}t.CriterionType=n,function(e){e.GREATER_THAN="GREATER_THAN",e.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",e.LESS_THAN="LESS_THAN",e.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",e.NOT_EQUAL="NOT_EQUAL",e.EQUAL="EQUAL"}(n||(t.CriterionType=n={}));var i=function(e,t){return{operator:e,value:t}};t.buildCriterion=i;var u=function(){function e(t){var r,n,o,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.trueString=null!==(n=null===(r=t.translationPackage.getMaybeFunctionTranslation("TRUE"))||void 0===r?void 0:r.toLowerCase())&&void 0!==n?n:"true",this.falseString=null!==(a=null===(o=t.translationPackage.getMaybeFunctionTranslation("FALSE"))||void 0===o?void 0:o.toLowerCase())&&void 0!==a?a:"false"}var t,r,u;return t=e,(r=[{key:"fromCellValue",value:function(e,t){if("string"==typeof e||"boolean"==typeof e||"number"==typeof e){var r=this.parseCriterion(e,t);if(void 0!==r)return{raw:e,lambda:c(r,t)}}}},{key:"parseCriterion",value:function(e,t){if("number"==typeof e||"boolean"==typeof e)return i(n.EQUAL,e);if("string"==typeof e){var r,a,u=s.exec(e);u?(a=function(e){switch(e){case">":return n.GREATER_THAN;case">=":return n.GREATER_THAN_OR_EQUAL;case"<":return n.LESS_THAN;case"<=":return n.LESS_THAN_OR_EQUAL;case"<>":return n.NOT_EQUAL;case"=":return n.EQUAL;default:return}}(u[1]),r=u[2]):(a=n.EQUAL,r=e);var c=t.coerceToMaybeNumber(r),l=r.toLowerCase()===this.trueString||r.toLowerCase()!==this.falseString&&void 0;if(void 0===a)return;if(""===r)return i(a,null);if(void 0!==c)return i(a,(0,o.getRawValue)(c));if(a===n.EQUAL||a===n.NOT_EQUAL)return i(a,null!=l?l:r)}}}])&&a(t.prototype,r),u&&a(t,u),e}();t.CriterionBuilder=u;var s=/([<>=]+)(.*)/,c=function(e,t){switch(e.operator){case n.GREATER_THAN:return"number"==typeof e.value?function(r){return"number"==typeof r&&t.floatCmp(r,e.value)>0}:function(e){return!1};case n.GREATER_THAN_OR_EQUAL:return"number"==typeof e.value?function(r){return"number"==typeof r&&t.floatCmp(r,e.value)>=0}:function(e){return!1};case n.LESS_THAN:return"number"==typeof e.value?function(r){return"number"==typeof r&&t.floatCmp(r,e.value)<0}:function(e){return!1};case n.LESS_THAN_OR_EQUAL:return"number"==typeof e.value?function(r){return"number"==typeof r&&t.floatCmp(r,e.value)<=0}:function(e){return!1};case n.EQUAL:return"number"==typeof e.value?function(r){if("number"==typeof r)return 0===t.floatCmp(r,e.value);if("string"==typeof r){if(""===r)return!1;var n=t.coerceToMaybeNumber(r);return void 0!==n&&0===t.floatCmp(n,e.value)}return!1}:"string"==typeof e.value?t.eqMatcherFunction(e.value):"boolean"==typeof e.value?function(t){return"boolean"==typeof t&&t===e.value}:function(e){return e===o.EmptyValue};case n.NOT_EQUAL:return"number"==typeof e.value?function(r){if("number"==typeof r)return 0!==t.floatCmp(r,e.value);if("string"==typeof r){if(""===r)return!0;var n=t.coerceToMaybeNumber(r);return void 0===n||0!==t.floatCmp(n,e.value)}return!0}:"string"==typeof e.value?t.neqMatcherFunction(e.value):"boolean"==typeof e.value?function(t){return"boolean"!=typeof t||t!==e.value}:function(e){return e!==o.EmptyValue}}};t.buildCriterionLambda=c},function(e,t,r){"use strict";r(53),r(87),r(93),r(94),t.__esModule=!0,t.FunctionRegistry=void 0,r(120),r(67),r(95),r(210),r(63),r(77),r(97),r(122),r(300),r(68),r(125),r(126),r(246);var n=r(231),o=r(269),a=r(307);function i(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||c(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=c(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}function c(e,t){if(e){if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t){var r,o=t.implementedFunctions[e],a=null===(r=t.aliases)||void 0===r?void 0:r[e];if(void 0!==a){if(void 0!==o)throw new n.AliasAlreadyExisting(e,t.name);o=t.implementedFunctions[a]}if(void 0===o)throw n.FunctionPluginValidationError.functionNotDeclaredInPlugin(e,t.name);return o}var h=function(){function e(t){var r=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.functions=new Map,this.volatileFunctions=new Set,this.structuralChangeFunctions=new Set,this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set,this.doesFunctionNeedArgumentToBeComputed=function(e){return r.functionsWhichDoesNotNeedArgumentsToBeComputed.has(e)},this.isFunctionVolatile=function(e){return r.volatileFunctions.has(e)},this.isFunctionDependentOnSheetStructureChange=function(e){return r.structuralChangeFunctions.has(e)},t.functionPlugins.length>0){this.instancePlugins=new Map;var n,o=s(t.functionPlugins);try{for(o.s();!(n=o.n()).done;){var a=n.value;e.loadPluginFunctions(a,this.instancePlugins)}}catch(e){o.e(e)}finally{o.f()}}else this.instancePlugins=new Map(e.plugins);var i,c=s(e.protectedFunctions());try{for(c.s();!(i=c.n()).done;){var l=u(i.value,2),f=l[0],h=l[1];e.loadFunctionUnprotected(h,f,this.instancePlugins)}}catch(e){c.e(e)}finally{c.f()}var d,m=s(this.instancePlugins.entries());try{for(m.s();!(d=m.n()).done;){var y=u(d.value,2),g=y[0],v=y[1];this.categorizeFunction(g,p(g,v))}}catch(e){m.e(e)}finally{m.f()}}var t,r,a;return t=e,r=[{key:"initializePlugins",value:function(e){var t,r=this,n=[],o=s(this.instancePlugins.entries());try{var a=function(){var o=u(t.value,2),a=o[0],i=o[1],s=n.find((function(e){return e instanceof i}));void 0===s&&(s=new i(e),n.push(s));var c=p(a,i).method;r.functions.set(a,[c,s])};for(o.s();!(t=o.n()).done;)a()}catch(e){o.e(e)}finally{o.f()}}},{key:"getFunctionPlugin",value:function(t){if(!e.functionIsProtected(t))return this.instancePlugins.get(t)}},{key:"getFunction",value:function(e){return this.functions.get(e)}},{key:"getPlugins",value:function(){var t,r=new Set,n=s(this.instancePlugins);try{for(n.s();!(t=n.n()).done;){var o=u(t.value,2),a=o[0],i=o[1];e.functionIsProtected(a)||r.add(i)}}catch(e){n.e(e)}finally{n.f()}return Array.from(r)}},{key:"getRegisteredFunctionIds",value:function(){return Array.from(this.functions.keys())}},{key:"categorizeFunction",value:function(e,t){t.isVolatile&&this.volatileFunctions.add(e),t.doesNotNeedArgumentsToBeComputed&&this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(e),t.isDependentOnSheetStructureChange&&this.structuralChangeFunctions.add(e)}}],a=[{key:"registerFunctionPlugin",value:function(e,t){this.loadPluginFunctions(e,this.plugins),void 0!==t&&this.loadTranslations(t)}},{key:"registerFunction",value:function(e,t,r){this.loadPluginFunction(t,e,this.plugins),void 0!==r&&this.loadTranslations(r)}},{key:"unregisterFunction",value:function(e){if(this.functionIsProtected(e))throw n.ProtectedFunctionError.cannotUnregisterFunctionWithId(e);this.plugins.delete(e)}},{key:"unregisterFunctionPlugin",value:function(e){var t,r=s(this.protectedPlugins());try{for(r.s();!(t=r.n()).done;)if(t.value===e)throw n.ProtectedFunctionError.cannotUnregisterProtectedPlugin()}catch(e){r.e(e)}finally{r.f()}var o,a=s(this.plugins.entries());try{for(a.s();!(o=a.n()).done;){var i=u(o.value,2),c=i[0];i[1]===e&&this.plugins.delete(c)}}catch(e){a.e(e)}finally{a.f()}}},{key:"unregisterAll",value:function(){this.plugins.clear()}},{key:"getRegisteredFunctionIds",value:function(){return[].concat(i(Array.from(this.plugins.keys())),i(Array.from(this._protectedPlugins.keys())))}},{key:"getPlugins",value:function(){return Array.from(new Set(this.plugins.values()).values())}},{key:"getFunctionPlugin",value:function(e){return this.functionIsProtected(e)?void 0:this.plugins.get(e)}},{key:"loadTranslations",value:function(e){var t=new Set(o.HyperFormula.getRegisteredLanguagesCodes());Object.keys(e).forEach((function(r){t.has(r)&&o.HyperFormula.getLanguage(r).extendFunctions(e[r])}))}},{key:"loadPluginFunctions",value:function(e,t){var r=this;Object.keys(e.implementedFunctions).forEach((function(n){r.loadPluginFunction(e,n,t)})),void 0!==e.aliases&&Object.keys(e.aliases).forEach((function(n){r.loadPluginFunction(e,n,t)}))}},{key:"loadPluginFunction",value:function(e,t,r){if(this.functionIsProtected(t))throw n.ProtectedFunctionError.cannotRegisterFunctionWithId(t);this.loadFunctionUnprotected(e,t,r)}},{key:"loadFunctionUnprotected",value:function(e,t,r){var o=p(t,e).method;if(!Object.prototype.hasOwnProperty.call(e.prototype,o))throw n.FunctionPluginValidationError.functionMethodNotFound(o,e.name);r.set(t,e)}},{key:"functionIsProtected",value:function(e){return this._protectedPlugins.has(e)}},{key:"protectedFunctions",value:regeneratorRuntime.mark((function e(){var t,r,n,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=s(this._protectedPlugins),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=10;break}if(n=u(r.value,2),o=n[0],void 0===(a=n[1])){e.next=8;break}return e.next=8,[o,a];case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"protectedPlugins",value:regeneratorRuntime.mark((function e(){var t,r,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=s(this._protectedPlugins),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=10;break}if(n=u(r.value,2),void 0===(o=n[1])){e.next=8;break}return e.next=8,o;case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))}],r&&f(t.prototype,r),a&&f(t,a),e}();t.FunctionRegistry=h,h.plugins=new Map,h._protectedPlugins=new Map([["VERSION",a.VersionPlugin],["OFFSET",void 0]])},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(109),r(1),r(87),r(93),r(94),t.__esModule=!0,t.VersionPlugin=void 0,r(95),r(210),r(63),r(77),r(97),r(53),r(125);var o=r(269),a=r(308);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return l(this,r)}}function l(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=new Map([["agpl-v3",1],["non-commercial-and-evaluation",2],["missing",3],["invalid",4],["expired",5]]),h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(l,e);var t,r,n,a=c(l);function l(){return i(this,l),a.apply(this,arguments)}return t=l,(r=[{key:"version",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("VERSION"),(function(){var e,t=r.config,n=t.licenseKeyValidityState,a=t.licenseKey;return p.has(a)?e=p.get(a):p.has(n)?e=p.get(n):"valid"===n&&(e=a.slice(-5)),"HyperFormula v".concat(o.HyperFormula.version,", ").concat(e)}))}}])&&u(t.prototype,r),n&&u(t,n),l}(a.FunctionPlugin);t.VersionPlugin=h,h.implementedFunctions={VERSION:{method:"version",parameters:[]}}},function(e,t,r){"use strict";r(87),r(93),r(63),r(94),r(95),r(77),r(97),r(53),r(67),r(68),t.__esModule=!0,t.FunctionPlugin=t.ArgumentTypes=void 0,r(121),r(213),r(138);var n,o=r(135),a=r(115),i=r(215),u=r(141),s=r(271),c=r(223),l=r(222);function f(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=h(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||h(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){if(e){if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}t.ArgumentTypes=n,function(e){e.STRING="STRING",e.NUMBER="NUMBER",e.BOOLEAN="BOOLEAN",e.SCALAR="SCALAR",e.NOERROR="NOERROR",e.RANGE="RANGE",e.INTEGER="INTEGER",e.COMPLEX="COMPLEX",e.ANY="ANY"}(n||(t.ArgumentTypes=n={}));var y=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.coerceScalarToNumberOrError=function(e){return r.interpreter.arithmeticHelper.coerceScalarToNumberOrError(e)},this.runFunction=function(e,t,n,o){return r.runFunctionTemplate(e,t,n,o)},this.runMatrixFunction=function(e,t,n,o){return r.runFunctionTemplate(e,t,n,o)},this.runFunctionTemplate=function(e,t,o,u){var s,c,l,f,h=o.parameters;f=o.expandRanges?r.listOfScalarValues(e,t):e.map((function(e){return[r.evaluateAst(e,t),!1]}));var d=[],m=void 0;if(void 0===o.repeatLastArgs&&h.length<f.length)return new a.CellError(a.ErrorType.NA,i.ErrorMessage.WrongArgNumber);if(void 0!==o.repeatLastArgs&&f.length>h.length&&(f.length-h.length)%o.repeatLastArgs!=0)return new a.CellError(a.ErrorType.NA,i.ErrorMessage.WrongArgNumber);for(var y=0,g=0;y<Math.max(f.length,h.length);y++,g++){g===h.length&&(g-=o.repeatLastArgs);var v=p(null!==(s=f[y])&&void 0!==s?s:[void 0,void 0],2),E=v[0],T=v[1],b=null!=E?E:null===(c=h[g])||void 0===c?void 0:c.defaultValue;if(void 0===b){if(!(null===(l=h[g])||void 0===l?void 0:l.optionalArg))return new a.CellError(a.ErrorType.NA,i.ErrorMessage.WrongArgNumber);d.push(void 0)}else{var R=void 0!==E?r.coerceToType(b,h[g]):b;void 0!==R?(R instanceof a.CellError&&h[g].argumentType!==n.SCALAR&&(m=null!=m?m:R),d.push(R)):T||(m=null!=m?m:new a.CellError(a.ErrorType.VALUE,i.ErrorMessage.WrongType))}}return null!=m?m:r.returnNumberWrapper(u.apply(void 0,d),o.returnNumberType)},this.runFunctionWithReferenceArgument=function(e,t,n,s,c){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(){return new a.CellError(a.ErrorType.NA,i.ErrorMessage.CellRefExpected)};if(0===e.length)return r.returnNumberWrapper(s(),n.returnNumberType);if(e.length>1)return new a.CellError(a.ErrorType.NA,i.ErrorMessage.WrongArgNumber);for(var f,p=e[0];p.type===u.AstNodeType.PARENTHESIS;)p=p.expression;if(p.type===u.AstNodeType.CELL_REFERENCE)f=p.reference.toSimpleCellAddress(t);else if(p.type===u.AstNodeType.CELL_RANGE||p.type===u.AstNodeType.COLUMN_RANGE||p.type===u.AstNodeType.ROW_RANGE)try{f=o.AbsoluteCellRange.fromAst(p,t).start}catch(e){return new a.CellError(a.ErrorType.REF,i.ErrorMessage.CellRefExpected)}return void 0!==f?r.returnNumberWrapper(c(f),n.returnNumberType):r.runFunction(e,t,n,l)},this.interpreter=t,this.dependencyGraph=t.dependencyGraph,this.columnSearch=t.columnSearch,this.config=t.config,this.serialization=t.serialization}var t,r,h;return t=e,(r=[{key:"evaluateAst",value:function(e,t){return this.interpreter.evaluateAst(e,t)}},{key:"listOfScalarValues",value:function(e,t){var r,n=[],o=f(e);try{for(o.s();!(r=o.n()).done;){var a=r.value,i=this.evaluateAst(a,t);if(i instanceof l.SimpleRangeValue){var u,s=f(i.valuesFromTopLeftCorner());try{for(s.s();!(u=s.n()).done;){var c=u.value;n.push([c,!0])}}catch(e){s.e(e)}finally{s.f()}}else n.push([i,!1])}}catch(e){o.e(e)}finally{o.f()}return n}},{key:"coerceToType",value:function(e,t){var r;if(e instanceof l.SimpleRangeValue)switch(t.argumentType){case n.RANGE:case n.ANY:r=e;break;default:return}else switch(t.argumentType){case n.INTEGER:case n.NUMBER:var o=this.coerceScalarToNumberOrError(e);if(!(0,c.isExtendedNumber)(o)){r=o;break}var u=(0,c.getRawValue)(o);if(void 0!==t.maxValue&&u>t.maxValue)return new a.CellError(a.ErrorType.NUM,i.ErrorMessage.ValueLarge);if(void 0!==t.minValue&&u<t.minValue)return new a.CellError(a.ErrorType.NUM,i.ErrorMessage.ValueSmall);if(void 0!==t.lessThan&&u>=t.lessThan)return new a.CellError(a.ErrorType.NUM,i.ErrorMessage.ValueLarge);if(void 0!==t.greaterThan&&u<=t.greaterThan)return new a.CellError(a.ErrorType.NUM,i.ErrorMessage.ValueSmall);if(t.argumentType===n.INTEGER&&!Number.isInteger(u))return new a.CellError(a.ErrorType.NUM,i.ErrorMessage.IntegerExpected);r=o;break;case n.STRING:r=(0,s.coerceScalarToString)(e);break;case n.BOOLEAN:r=(0,s.coerceScalarToBoolean)(e);break;case n.SCALAR:case n.NOERROR:case n.ANY:r=e;break;case n.RANGE:if(e instanceof a.CellError)return e;r=(0,s.coerceToRange)((0,c.getRawValue)(e));break;case n.COMPLEX:return this.interpreter.arithmeticHelper.coerceScalarToComplex((0,c.getRawValue)(e))}return t.passSubtype||void 0===r?r:(0,c.getRawValue)(r)}},{key:"metadata",value:function(e){var t=this.constructor.implementedFunctions[e];if(void 0!==t)return t;throw new Error("No metadata for function ".concat(e,"."))}},{key:"returnNumberWrapper",value:function(e,t,r){return void 0!==t&&(0,c.isExtendedNumber)(e)?this.interpreter.arithmeticHelper.ExtendedNumberFactory((0,c.getRawValue)(e),{type:t,format:r}):e}}])&&m(t.prototype,r),h&&m(t,h),e}();t.FunctionPlugin=y},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}t.__esModule=!0,t.NumberLiteralHelper=void 0,r(143),r(146),r(148),r(125),r(156),r(138);
/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */
var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t;var r="."===this.config.thousandSeparator?"\\".concat(this.config.thousandSeparator):this.config.thousandSeparator,n="."===this.config.decimalSeparator?"\\".concat(this.config.decimalSeparator):this.config.decimalSeparator;this.numberPattern=new RegExp("^([+-]?((".concat(n,"\\d+)|(\\d+(").concat(r,"\\d{3,})*(").concat(n,"\\d*)?)))(e[+-]?\\d+)?$")),this.allThousandSeparatorsRegex=new RegExp("".concat(r),"g")}var t,r,o;return t=e,(r=[{key:"numericStringToMaybeNumber",value:function(e){if(this.numberPattern.test(e)){var t=this.numericStringToNumber(e);if(isNaN(t))return;return t}}},{key:"isNumber",value:function(e){return!!this.numberPattern.test(e)&&!isNaN(this.numericStringToNumber(e))}},{key:"numericStringToNumber",value:function(e){var t=e.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,".");return Number(t)}}])&&n(t.prototype,r),o&&n(t,o),e}();t.NumberLiteralHelper=o},function(e,t,r){"use strict";r(53),r(63),r(67),r(68),r(77),r(87),r(93),r(94),r(95),r(97),t.__esModule=!0,t.Serialization=void 0,r(121);var n=r(115),o=r(118),a=r(141);function i(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=function(){function e(t,r,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dependencyGraph=t,this.unparser=r,this.config=n,this.exporter=o}var t,r,u;return t=e,(r=[{key:"getCellFormula",value:function(e){var t=this.dependencyGraph.getCell(e);if(t instanceof o.FormulaCellVertex){var r=t.getFormula(this.dependencyGraph.lazilyTransformingAstService);return this.unparser.unparse(r,e)}if(t instanceof o.MatrixVertex){var n=t.getFormula();if(n)return"{"+this.unparser.unparse(n,t.getAddress())+"}"}else if(t instanceof o.ParsingErrorVertex)return t.getFormula()}},{key:"getCellSerialized",value:function(e){var t=this.getCellFormula(e);return void 0!==t?t:this.getRawValue(e)}},{key:"getCellValue",value:function(e){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(e))}},{key:"getRawValue",value:function(e){return this.dependencyGraph.getRawValue(e)}},{key:"getSheetValues",value:function(e){var t=this;return this.genericSheetGetter(e,(function(e){return t.getCellValue(e)}))}},{key:"getSheetFormulas",value:function(e){var t=this;return this.genericSheetGetter(e,(function(e){return t.getCellFormula(e)}))}},{key:"genericSheetGetter",value:function(e,t){for(var r=this.dependencyGraph.getSheetHeight(e),o=this.dependencyGraph.getSheetWidth(e),a=new Array(r),i=0;i<r;i++){a[i]=new Array(o);for(var u=0;u<o;u++){var s=(0,n.simpleCellAddress)(e,u,i);a[i][u]=t(s)}for(var c=o-1;c>=0&&(null===a[i][c]||void 0===a[i][c]);c--)a[i].pop()}for(var l=r-1;l>=0&&0===a[l].length;l--)a.pop();return a}},{key:"genericAllSheetsGetter",value:function(e){var t,r={},n=i(this.dependencyGraph.sheetMapping.displayNames());try{for(n.s();!(t=n.n()).done;){var o=t.value,a=this.dependencyGraph.sheetMapping.fetch(o);r[o]=e(a)}}catch(e){n.e(e)}finally{n.f()}return r}},{key:"getSheetSerialized",value:function(e){var t=this;return this.genericSheetGetter(e,(function(e){return t.getCellSerialized(e)}))}},{key:"getAllSheetsValues",value:function(){var e=this;return this.genericAllSheetsGetter((function(t){return e.getSheetValues(t)}))}},{key:"getAllSheetsFormulas",value:function(){var e=this;return this.genericAllSheetsGetter((function(t){return e.getSheetFormulas(t)}))}},{key:"getAllSheetsSerialized",value:function(){var e=this;return this.genericAllSheetsGetter((function(t){return e.getSheetSerialized(t)}))}},{key:"getAllNamedExpressionsSerialized",value:function(){var e=this;return this.dependencyGraph.namedExpressions.getAllNamedExpressions().map((function(t){var r=void 0!==t.scope?e.dependencyGraph.sheetMapping.fetchDisplayName(t.scope):void 0;return{name:t.expression.displayName,expression:e.getCellSerialized(t.expression.address),scope:r,options:t.expression.options}}))}},{key:"withNewConfig",value:function(t,r){var n=new a.Unparser(t,(0,a.buildLexerConfig)(t),this.dependencyGraph.sheetMapping.fetchDisplayName,r);return new e(this.dependencyGraph,n,t,this.exporter)}}])&&s(t.prototype,r),u&&s(t,u),e}();t.Serialization=c},function(e,t,r){"use strict";r(87),r(93),r(63),r(94),r(95),r(77),r(97),r(53),r(67),r(68),t.__esModule=!0,t.checkLicenseKeyValidity=function(e){var t,r,u={template:"missing",vars:{}};if("non-commercial-and-evaluation"===e||"agpl-v3"===e||"internal-use-in-handsontable"===e)u.template="valid";else if("string"==typeof e&&(0,n.checkKeySchema)(e)){var s="27/04/2021".split("/"),c=(r=3,function(e){if(Array.isArray(e))return e}(t=s)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(t,r)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=c[0],f=c[1],p=c[2],h=Math.floor(new Date("".concat(f,"/").concat(l,"/").concat(p)).getTime()/864e5),d=(0,n.extractTime)(e);u.vars.keyValidityDate=function(e){var t=["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()],r=e.getDate(),n=e.getFullYear();return"".concat(t," ").concat(r,", ").concat(n)}(new Date(864e5*(d+1))),u.template=h>d?"expired":"valid"}else""!==e&&(u.template="invalid");return i||"valid"===u.template||(console.warn(a[u.template](u.vars)),i=!0),u.template},r(146),r(151),r(125);var n=r(312);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var a={invalid:function(){return"The license key for HyperFormula is invalid."},expired:function(e){var t=e.keyValidityDate;return"The license key for HyperFormula expired"+" on ".concat(t,", and is not valid for the installed version.")},missing:function(){return"The license key for HyperFormula is missing."}},i=!1},function(e,t,r){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r(87),r(93),r(63),r(94),r(95),r(77),r(97),r(53),r(67),r(68),t.__esModule=!0,t.extractTime=function(e){return 25===u(e)[o]?a(s(u(e),a("12"),c("F")))/(a(s(u(e),c("C"),c("Y")>>4))||1+(~~![][o]<<3)):0},t.checkKeySchema=function(e){if((e=(e+"").replace(/\-/g,""))[o]!==c("Z"))return!1;var t=0;return[[0,c("G")+1],[c("H"),c("H")-1],[c("G")+c("H"),c("G")]].reduce((function(r,o,u){var c,l,f=(l=2,function(e){if(Array.isArray(e))return e}
/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */(c=o)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(c,l)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(c,l)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),p=f[0],h=f[1];return r|=(i("".concat(i(a(s.apply(void 0,[e].concat([t+p-(0===u?0:2),h+(u?2:0)])))+(a(s.apply(void 0,[e].concat([t+p+h,2])))+[]).padStart(2,"0"))))%97||2)>>1,t+=2,r}),c("A"))===[]+1>>1},r(146),r(156),r(313),r(149),r(125),r(314);var o="length",a=function(e){return parseInt(e,16)},i=function(e){return parseInt(e,10)},u=function(e){return(e+"").replace(/\-/g,"")},s=function(e,t,r){return e.substr(t,r)},c=function(e){return e.codePointAt(0)-65}},function(e,t,r){"use strict";var n=r(2),o=r(78).codeAt;n({target:"String",proto:!0},{codePointAt:function(e){return o(this,e)}})},function(e,t,r){"use strict";var n=r(2),o=r(315).start;n({target:"String",proto:!0,forced:r(316)},{padStart:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,r){var n=r(41),o=r(267),a=r(13),i=Math.ceil,u=function(e){return function(t,r,u){var s,c,l=String(a(t)),f=l.length,p=void 0===u?" ":String(u),h=n(r);return h<=f||""==p?l:(s=h-f,(c=o.call(p,i(s/p.length))).length>s&&(c=c.slice(0,s)),e?l+c:c+l)}};e.exports={start:u(!1),end:u(!0)}},function(e,t,r){var n=r(60);e.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(n)},function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;
/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */
var n={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",VALUE:"#VALUE!"},functions:{ABS:"ABS",ACOS:"ACOS",ACOSH:"ACOSH",ACOT:"ACOT",ACOTH:"ACOTH",AND:"AND",ARABIC:"ARABIC",ASIN:"ASIN",ASINH:"ASINH",ATAN2:"ATAN2",ATAN:"ATAN",ATANH:"ATANH",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CLEAN:"CLEAN",CODE:"CODE",COLUMN:"COLUMN",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COSH:"COSH",COT:"COT",COTH:"COTH",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",CSC:"CSC",CSCH:"CSCH",CUMIPMT:"CUMIPMT",CUMPRINC:"CUMPRINC",DATE:"DATE",DATEDIF:"DATEDIF",DATEVALUE:"DATEVALUE",DAY:"DAY",DAYS360:"DAYS360",DAYS:"DAYS",DB:"DB",DDB:"DDB",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",DOLLARDE:"DOLLARDE",DOLLARFR:"DOLLARFR",EDATE:"EDATE",EFFECT:"EFFECT",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXACT:"EXACT",EXP:"EXP",FALSE:"FALSE",FIND:"FIND",FORMULATEXT:"FORMULATEXT",FV:"FV",FVSCHEDULE:"FVSCHEDULE",HEX2BIN:"HEX2BIN",HEX2DEC:"HEX2DEC",HEX2OCT:"HEX2OCT",HLOOKUP:"HLOOKUP",HOUR:"HOUR",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",INDEX:"INDEX",INT:"INT",INTERVAL:"INTERVAL",IPMT:"IPMT",ISBINARY:"ISBINARY",ISBLANK:"ISBLANK",ISERR:"ISERR",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISFORMULA:"ISFORMULA",ISLOGICAL:"ISLOGICAL",ISNA:"ISNA",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISOWEEKNUM:"ISOWEEKNUM",ISPMT:"ISPMT",ISREF:"ISREF",ISTEXT:"ISTEXT",LEFT:"LEFT",LEN:"LEN",LN:"LN",LOG10:"LOG10",LOG:"LOG",LOWER:"LOWER",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MID:"MID",MIN:"MIN",MINA:"MINA",MINUTE:"MINUTE",MIRR:"MIRR",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NA:"NA",NETWORKDAYS:"NETWORKDAYS","NETWORKDAYS.INTL":"NETWORKDAYS.INTL",NOMINAL:"NOMINAL",NOT:"NOT",NOW:"NOW",NPER:"NPER",NPV:"NPV",OCT2BIN:"OCT2BIN",OCT2DEC:"OCT2DEC",OCT2HEX:"OCT2HEX",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",PMT:"PMT",PDURATION:"PDURATION",PRODUCT:"PRODUCT",POWER:"POWER",PPMT:"PPMT",PROPER:"PROPER",PV:"PV",RADIANS:"RADIANS",RAND:"RAND",RATE:"RATE",REPLACE:"REPLACE",REPT:"REPT",RIGHT:"RIGHT",ROMAN:"ROMAN",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROW:"ROW",ROWS:"ROWS",RRI:"RRI",SEARCH:"SEARCH",SEC:"SEC",SECH:"SECH",SECOND:"SECOND",SHEET:"SHEET",SHEETS:"SHEETS",SIN:"SIN",SINH:"SINH",SLN:"SLN",SPLIT:"SPLIT",SQRT:"SQRT",STDEVA:"STDEVA","STDEV.P":"STDEV.P",STDEVPA:"STDEVPA","STDEV.S":"STDEV.S",SUBSTITUTE:"SUBSTITUTE",SUBTOTAL:"SUBTOTAL",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",SYD:"SYD",T:"T",TAN:"TAN",TANH:"TANH",TBILLEQ:"TBILLEQ",TBILLPRICE:"TBILLPRICE",TBILLYIELD:"TBILLYIELD",TEXT:"TEXT",TIME:"TIME",TIMEVALUE:"TIMEVALUE",TODAY:"TODAY",TRANSPOSE:"TRANSPOSE",TRIM:"TRIM",TRUE:"TRUE",TRUNC:"TRUNC",UNICHAR:"UNICHAR",UNICODE:"UNICODE",UPPER:"UPPER",VARA:"VARA","VAR.P":"VAR.P",VARPA:"VARPA","VAR.S":"VAR.S",VLOOKUP:"VLOOKUP",WEEKDAY:"WEEKDAY",WEEKNUM:"WEEKNUM",WORKDAY:"WORKDAY","WORKDAY.INTL":"WORKDAY.INTL",XNPV:"XNPV",XOR:"XOR",YEAR:"YEAR",YEARFRAC:"YEARFRAC","HF.ADD":"HF.ADD","HF.CONCAT":"HF.CONCAT","HF.DIVIDE":"HF.DIVIDE","HF.EQ":"HF.EQ","HF.GT":"HF.GT","HF.GTE":"HF.GTE","HF.LT":"HF.LT","HF.LTE":"HF.LTE","HF.MINUS":"HF.MINUS","HF.MULTIPLY":"HF.MULTIPLY","HF.NE":"HF.NE","HF.POW":"HF.POW","HF.UMINUS":"HF.UMINUS","HF.UNARY_PERCENT":"HF.UNARY_PERCENT","HF.UPLUS":"HF.UPLUS",VARP:"VARP",VAR:"VAR",STDEVP:"STDEVP",STDEV:"STDEV","EXPON.DIST":"EXPON.DIST",FISHER:"FISHER",FISHERINV:"FISHERINV",GAMMA:"GAMMA","GAMMA.DIST":"GAMMA.DIST",GAMMALN:"GAMMALN","GAMMALN.PRECISE":"GAMMALN.PRECISE","GAMMA.INV":"GAMMA.INV",GAUSS:"GAUSS",FACT:"FACT",FACTDOUBLE:"FACTDOUBLE",COMBIN:"COMBIN",COMBINA:"COMBINA",GCD:"GCD",LCM:"LCM",MROUND:"MROUND",MULTINOMIAL:"MULTINOMIAL",QUOTIENT:"QUOTIENT",RANDBETWEEN:"RANDBETWEEN",SERIESSUM:"SERIESSUM",SIGN:"SIGN",SQRTPI:"SQRTPI",SUMX2MY2:"SUMX2MY2",SUMX2PY2:"SUMX2PY2",SUMXMY2:"SUMXMY2",EXPONDIST:"EXPONDIST",GAMMADIST:"GAMMADIST",GAMMAINV:"GAMMAINV","BETA.DIST":"BETA.DIST",BETADIST:"BETADIST","BETA.INV":"BETA.INV",BETAINV:"BETAINV","BINOM.DIST":"BINOM.DIST",BINOMDIST:"BINOMDIST","BINOM.INV":"BINOM.INV",BESSELI:"BESSELI",BESSELJ:"BESSELJ",BESSELK:"BESSELK",BESSELY:"BESSELY","CHISQ.DIST":"CHISQ.DIST","CHISQ.DIST.RT":"CHISQ.DIST.RT","CHISQ.INV":"CHISQ.INV","CHISQ.INV.RT":"CHISQ.INV.RT",CHIDIST:"CHIDIST",CHIINV:"CHIINV","F.DIST":"F.DIST","F.DIST.RT":"F.DIST.RT","F.INV":"F.INV","F.INV.RT":"F.INV.RT",FDIST:"FDIST",FINV:"FINV",WEIBULL:"WEIBULL","WEIBULL.DIST":"WEIBULL.DIST",POISSON:"POISSON","POISSON.DIST":"POISSON.DIST","HYPGEOM.DIST":"HYPGEOM.DIST",HYPGEOMDIST:"HYPGEOMDIST","T.DIST":"T.DIST","T.DIST.2T":"T.DIST.2T","T.DIST.RT":"T.DIST.RT","T.INV":"T.INV","T.INV.2T":"T.INV.2T",TDIST:"TDIST",TINV:"TINV",LOGINV:"LOGINV","LOGNORM.DIST":"LOGNORM.DIST","LOGNORM.INV":"LOGNORM.INV",LOGNORMDIST:"LOGNORMDIST","NORM.DIST":"NORM.DIST","NORM.INV":"NORM.INV","NORM.S.DIST":"NORM.S.DIST","NORM.S.INV":"NORM.S.INV",NORMDIST:"NORMDIST",NORMINV:"NORMINV",NORMSDIST:"NORMSDIST",NORMSINV:"NORMSINV",PHI:"PHI","NEGBINOM.DIST":"NEGBINOM.DIST",NEGBINOMDIST:"NEGBINOMDIST",COMPLEX:"COMPLEX",IMABS:"IMABS",IMAGINARY:"IMAGINARY",IMARGUMENT:"IMARGUMENT",IMCONJUGATE:"IMCONJUGATE",IMCOS:"IMCOS",IMCOSH:"IMCOSH",IMCOT:"IMCOT",IMCSC:"IMCSC",IMCSCH:"IMCSCH",IMDIV:"IMDIV",IMEXP:"IMEXP",IMLN:"IMLN",IMLOG10:"IMLOG10",IMLOG2:"IMLOG2",IMPOWER:"IMPOWER",IMPRODUCT:"IMPRODUCT",IMREAL:"IMREAL",IMSEC:"IMSEC",IMSECH:"IMSECH",IMSIN:"IMSIN",IMSINH:"IMSINH",IMSQRT:"IMSQRT",IMSUB:"IMSUB",IMSUM:"IMSUM",IMTAN:"IMTAN",LARGE:"LARGE",SMALL:"SMALL",AVEDEV:"AVEDEV",CONFIDENCE:"CONFIDENCE","CONFIDENCE.NORM":"CONFIDENCE.NORM","CONFIDENCE.T":"CONFIDENCE.T",DEVSQ:"DEVSQ",GEOMEAN:"GEOMEAN",HARMEAN:"HARMEAN",CRITBINOM:"CRITBINOM","COVARIANCE.P":"COVARIANCE.P","COVARIANCE.S":"COVARIANCE.S",COVAR:"COVAR",PEARSON:"PEARSON",RSQ:"RSQ",STANDARDIZE:"STANDARDIZE","Z.TEST":"Z.TEST",ZTEST:"ZTEST","F.TEST":"F.TEST",FTEST:"FTEST",STEYX:"STEYX",SLOPE:"SLOPE","CHISQ.TEST":"CHISQ.TEST",CHITEST:"CHITEST","T.TEST":"T.TEST",TTEST:"TTEST",SKEW:"SKEW","SKEW.P":"SKEW.P",WEIBULLDIST:"WEIBULLDIST",VARS:"VARS",TINV2T:"TINV2T",TDISTRT:"TDISTRT",TDIST2T:"TDIST2T",STDEVS:"STDEVS",FINVRT:"FINVRT",FDISTRT:"FDISTRT",CHIDISTRT:"CHIDISTRT",CHIINVRT:"CHIINVRT",COVARIANCEP:"COVARIANCEP",COVARIANCES:"COVARIANCES",LOGNORMINV:"LOGNORMINV",POISSONDIST:"POISSONDIST",SKEWP:"SKEWP","CEILING.MATH":"CEILING.MATH",FLOOR:"FLOOR","FLOOR.MATH":"FLOOR.MATH","CEILING.PRECISE":"CEILING.PRECISE","FLOOR.PRECISE":"FLOOR.PRECISE","ISO.CEILING":"ISO.CEILING"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}};t.default=n},function(e,t,r){"use strict";t.__esModule=!0;var n=r(308);t.FunctionPlugin=n.FunctionPlugin},function(e,t,r){"use strict";t.__esModule=!0,t.StatisticalAggregationPlugin=t.ComplexPlugin=t.MathPlugin=t.StatisticalPlugin=t.SimpleArithmerticPlugin=t.RomanPlugin=t.LookupPlugin=t.TrigonometryPlugin=t.TextPlugin=t.SumprodPlugin=t.SumifPlugin=t.SqrtPlugin=t.RoundingPlugin=t.RandomPlugin=t.RadixConversionPlugin=t.RadiansPlugin=t.PowerPlugin=t.NumericAggregationPlugin=t.ModuloPlugin=t.MedianPlugin=t.MatrixPlugin=t.MathConstantsPlugin=t.LogarithmPlugin=t.IsOddPlugin=t.IsEvenPlugin=t.InformationPlugin=t.FormulaTextPlugin=t.FinancialPlugin=t.ExpPlugin=t.DeltaPlugin=t.DegreesPlugin=t.DateTimePlugin=t.CountUniquePlugin=t.CountBlankPlugin=t.CodePlugin=t.CharPlugin=t.BooleanPlugin=t.BitwiseLogicOperationsPlugin=t.BitShiftPlugin=t.AbsPlugin=void 0;var n=r(320);t.AbsPlugin=n.AbsPlugin;var o=r(321);t.BitShiftPlugin=o.BitShiftPlugin;var a=r(322);t.BitwiseLogicOperationsPlugin=a.BitwiseLogicOperationsPlugin;var i=r(323);t.BooleanPlugin=i.BooleanPlugin;var u=r(324);t.CharPlugin=u.CharPlugin;var s=r(327);t.CodePlugin=s.CodePlugin;var c=r(328);t.CountBlankPlugin=c.CountBlankPlugin;var l=r(329);t.CountUniquePlugin=l.CountUniquePlugin;var f=r(330);t.DateTimePlugin=f.DateTimePlugin;var p=r(331);t.DegreesPlugin=p.DegreesPlugin;var h=r(332);t.DeltaPlugin=h.DeltaPlugin;var d=r(333);t.ExpPlugin=d.ExpPlugin;var m=r(334);t.FinancialPlugin=m.FinancialPlugin;var y=r(335);t.FormulaTextPlugin=y.FormulaTextPlugin;var g=r(336);t.InformationPlugin=g.InformationPlugin;var v=r(337);t.IsEvenPlugin=v.IsEvenPlugin;var E=r(338);t.IsOddPlugin=E.IsOddPlugin;var T=r(339);t.LogarithmPlugin=T.LogarithmPlugin;var b=r(340);t.MathConstantsPlugin=b.MathConstantsPlugin;var R=r(341);t.MatrixPlugin=R.MatrixPlugin;var A=r(342);t.MedianPlugin=A.MedianPlugin;var S=r(343);t.ModuloPlugin=S.ModuloPlugin;var N=r(344);t.NumericAggregationPlugin=N.NumericAggregationPlugin;var O=r(345);t.PowerPlugin=O.PowerPlugin;var C=r(346);t.RadiansPlugin=C.RadiansPlugin;var w=r(347);t.RadixConversionPlugin=w.RadixConversionPlugin;var M=r(348);t.RandomPlugin=M.RandomPlugin;var I=r(349);t.RoundingPlugin=I.RoundingPlugin;var x=r(350);t.SqrtPlugin=x.SqrtPlugin;var k=r(351);t.SumifPlugin=k.SumifPlugin;var _=r(354);t.SumprodPlugin=_.SumprodPlugin;var P=r(355);t.TextPlugin=P.TextPlugin;var L=r(357);t.TrigonometryPlugin=L.TrigonometryPlugin;var F=r(366);t.LookupPlugin=F.LookupPlugin;var U=r(368);t.RomanPlugin=U.RomanPlugin;var V=r(369);t.SimpleArithmerticPlugin=V.SimpleArithmerticPlugin;var D=r(370);t.StatisticalPlugin=D.StatisticalPlugin;var j=r(373);t.MathPlugin=j.MathPlugin;var B=r(375);t.ComplexPlugin=B.ComplexPlugin;var G=r(376);t.StatisticalAggregationPlugin=G.StatisticalAggregationPlugin},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.AbsPlugin=void 0,r(109);var o=r(308);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var o=l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(c,e);var t,r,n,o=s(c);function c(){return a(this,c),o.apply(this,arguments)}return t=c,(r=[{key:"abs",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ABS"),Math.abs)}}])&&i(t.prototype,r),n&&i(t,n),c}(o.FunctionPlugin);t.AbsPlugin=f,f.implementedFunctions={ABS:{method:"abs",parameters:[{argumentType:o.ArgumentTypes.NUMBER}]}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.BitShiftPlugin=void 0,r(109);var o=r(115),a=r(215),i=r(308);function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var o=p(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(a,e);var t,r,n,o=l(a);function a(){return u(this,a),o.apply(this,arguments)}return t=a,(r=[{key:"bitlshift",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BITLSHIFT"),d)}},{key:"bitrshift",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BITRSHIFT"),m)}}])&&s(t.prototype,r),n&&s(t,n),a}(i.FunctionPlugin);function d(e,t){return t<0?m(e,-t):y(e*Math.pow(2,t))}function m(e,t){return t<0?d(e,-t):y(Math.floor(e/Math.pow(2,t)))}function y(e){return e>0xffffffffffff?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.BitshiftLong):e}t.BitShiftPlugin=h,h.implementedFunctions={BITLSHIFT:{method:"bitlshift",parameters:[{argumentType:i.ArgumentTypes.INTEGER,minValue:0},{argumentType:i.ArgumentTypes.INTEGER,minValue:-53,maxValue:53}]},BITRSHIFT:{method:"bitrshift",parameters:[{argumentType:i.ArgumentTypes.INTEGER,minValue:0},{argumentType:i.ArgumentTypes.INTEGER,minValue:-53,maxValue:53}]}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.BitwiseLogicOperationsPlugin=void 0,r(109);var o=r(308);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var o=l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(c,e);var t,r,n,o=s(c);function c(){return a(this,c),o.apply(this,arguments)}return t=c,(r=[{key:"bitand",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BITAND"),(function(e,t){return e&t}))}},{key:"bitor",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BITOR"),(function(e,t){return e|t}))}},{key:"bitxor",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BITXOR"),(function(e,t){return e^t}))}}])&&i(t.prototype,r),n&&i(t,n),c}(o.FunctionPlugin);t.BitwiseLogicOperationsPlugin=f,f.implementedFunctions={BITAND:{method:"bitand",parameters:[{argumentType:o.ArgumentTypes.INTEGER,minValue:0},{argumentType:o.ArgumentTypes.INTEGER,minValue:0}]},BITOR:{method:"bitor",parameters:[{argumentType:o.ArgumentTypes.INTEGER,minValue:0},{argumentType:o.ArgumentTypes.INTEGER,minValue:0}]},BITXOR:{method:"bitxor",parameters:[{argumentType:o.ArgumentTypes.INTEGER,minValue:0},{argumentType:o.ArgumentTypes.INTEGER,minValue:0}]}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.BooleanPlugin=void 0,r(126),r(109);var o=r(115),a=r(215),i=r(308);function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var o=p(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(f,e);var t,r,n,i=l(f);function f(){return u(this,f),i.apply(this,arguments)}return t=f,(r=[{key:"literalTrue",value:function(e,t){return this.runFunction(e.args,t,this.metadata("TRUE"),(function(){return!0}))}},{key:"literalFalse",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FALSE"),(function(){return!1}))}},{key:"conditionalIf",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IF"),(function(e,t,r){return e?t:r}))}},{key:"and",value:function(e,t){return this.runFunction(e.args,t,this.metadata("AND"),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!t.some((function(e){return!e}))}))}},{key:"or",value:function(e,t){return this.runFunction(e.args,t,this.metadata("OR"),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.some((function(e){return e}))}))}},{key:"not",value:function(e,t){return this.runFunction(e.args,t,this.metadata("NOT"),(function(e){return!e}))}},{key:"xor",value:function(e,t){return this.runFunction(e.args,t,this.metadata("XOR"),(function(){for(var e=0,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.forEach((function(t){t&&e++})),e%2==1}))}},{key:"switch",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("SWITCH"),(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(var u=n.length,s=0;s+1<u;s+=2)if(!(n[s]instanceof o.CellError)&&r.interpreter.arithmeticHelper.eq(e,n[s]))return n[s+1];return s<u?n[s]:new o.CellError(o.ErrorType.NA,a.ErrorMessage.NoDefault)}))}},{key:"iferror",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IFERROR"),(function(e,t){return e instanceof o.CellError?t:e}))}},{key:"ifna",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IFNA"),(function(e,t){return e instanceof o.CellError&&e.type===o.ErrorType.NA?t:e}))}},{key:"choose",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CHOOSE"),(function(e){return e>(arguments.length<=1?0:arguments.length-1)?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.Selector):e-1+1<1||arguments.length<=e-1+1?void 0:arguments[e-1+1]}))}}])&&s(t.prototype,r),n&&s(t,n),f}(i.FunctionPlugin);t.BooleanPlugin=h,h.implementedFunctions={TRUE:{method:"literalTrue",parameters:[]},FALSE:{method:"literalFalse",parameters:[]},IF:{method:"conditionalIf",parameters:[{argumentType:i.ArgumentTypes.BOOLEAN},{argumentType:i.ArgumentTypes.SCALAR,passSubtype:!0},{argumentType:i.ArgumentTypes.SCALAR,defaultValue:!1,passSubtype:!0}]},AND:{method:"and",parameters:[{argumentType:i.ArgumentTypes.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},OR:{method:"or",parameters:[{argumentType:i.ArgumentTypes.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},XOR:{method:"xor",parameters:[{argumentType:i.ArgumentTypes.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},NOT:{method:"not",parameters:[{argumentType:i.ArgumentTypes.BOOLEAN}]},SWITCH:{method:"switch",parameters:[{argumentType:i.ArgumentTypes.NOERROR,passSubtype:!0},{argumentType:i.ArgumentTypes.SCALAR,passSubtype:!0},{argumentType:i.ArgumentTypes.SCALAR,passSubtype:!0}],repeatLastArgs:1},IFERROR:{method:"iferror",parameters:[{argumentType:i.ArgumentTypes.SCALAR,passSubtype:!0},{argumentType:i.ArgumentTypes.SCALAR,passSubtype:!0}]},IFNA:{method:"ifna",parameters:[{argumentType:i.ArgumentTypes.SCALAR,passSubtype:!0},{argumentType:i.ArgumentTypes.SCALAR,passSubtype:!0}]},CHOOSE:{method:"choose",parameters:[{argumentType:i.ArgumentTypes.INTEGER,minValue:1},{argumentType:i.ArgumentTypes.SCALAR,passSubtype:!0}],repeatLastArgs:1}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.CharPlugin=void 0,r(325),r(326),r(109);var o=r(115),a=r(215),i=r(308);function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var o=p(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(f,e);var t,r,n,i=l(f);function f(){return u(this,f),i.apply(this,arguments)}return t=f,(r=[{key:"char",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),(function(e){return e<1||e>=256?new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.CharacterCodeBounds):String.fromCharCode(Math.trunc(e))}))}},{key:"unichar",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),(function(e){return e<1||e>=1114112?new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.CharacterCodeBounds):String.fromCodePoint(Math.trunc(e))}))}}])&&s(t.prototype,r),n&&s(t,n),f}(i.FunctionPlugin);t.CharPlugin=h,h.implementedFunctions={CHAR:{method:"char",parameters:[{argumentType:i.ArgumentTypes.NUMBER}]},UNICHAR:{method:"unichar",parameters:[{argumentType:i.ArgumentTypes.NUMBER}]}}},function(e,t,r){var n=r(2),o=Math.ceil,a=Math.floor;n({target:"Math",stat:!0},{trunc:function(e){return(e>0?a:o)(e)}})},function(e,t,r){var n=r(2),o=r(43),a=String.fromCharCode,i=String.fromCodePoint;n({target:"String",stat:!0,forced:!!i&&1!=i.length},{fromCodePoint:function(e){for(var t,r=[],n=arguments.length,i=0;n>i;){if(t=+arguments[i++],o(t,1114111)!==t)throw RangeError(t+" is not a valid code point");r.push(t<65536?a(t):a(55296+((t-=65536)>>10),t%1024+56320))}return r.join("")}})},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.CodePlugin=void 0,r(313),r(109);var o=r(115),a=r(215),i=r(308);function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var o=p(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(f,e);var t,r,n,i=l(f);function f(){return u(this,f),i.apply(this,arguments)}return t=f,(r=[{key:"code",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CODE"),(function(e){return 0===e.length?new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.EmptyString):e.charCodeAt(0)}))}},{key:"unicode",value:function(e,t){return this.runFunction(e.args,t,this.metadata("UNICODE"),(function(e){var t;return null!==(t=e.codePointAt(0))&&void 0!==t?t:new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.EmptyString)}))}}])&&s(t.prototype,r),n&&s(t,n),f}(i.FunctionPlugin);t.CodePlugin=h,h.implementedFunctions={CODE:{method:"code",parameters:[{argumentType:i.ArgumentTypes.STRING}]},UNICODE:{method:"unicode",parameters:[{argumentType:i.ArgumentTypes.STRING}]}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.CountBlankPlugin=void 0,r(126),r(109);var o=r(223),a=r(308);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return l(this,r)}}function l(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(l,e);var t,r,n,a=c(l);function l(){return i(this,l),a.apply(this,arguments)}return t=l,(r=[{key:"countblank",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COUNTBLANK"),(function(){for(var e=0,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.forEach((function(t){t===o.EmptyValue&&e++})),e}))}}])&&u(t.prototype,r),n&&u(t,n),l}(a.FunctionPlugin);t.CountBlankPlugin=p,p.implementedFunctions={COUNTBLANK:{method:"countblank",parameters:[{argumentType:a.ArgumentTypes.SCALAR}],repeatLastArgs:1,expandRanges:!0}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(94),t.__esModule=!0,t.CountUniquePlugin=void 0,r(95),r(63),r(122),r(77),r(97),r(109);var o=r(115),a=r(308);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return l(this,r)}}function l(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(l,e);var t,r,n,a=c(l);function l(){return i(this,l),a.apply(this,arguments)}return t=l,(r=[{key:"countunique",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COUNTUNIQUE"),(function(){for(var e=new Set,t=new Set,r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];for(var i=0,u=n;i<u.length;i++){var s=u[i];s instanceof o.CellError?t.add(s.type):""!==s&&e.add(s)}return e.size+t.size}))}}])&&u(t.prototype,r),n&&u(t,n),l}(a.FunctionPlugin);t.CountUniquePlugin=p,p.implementedFunctions={COUNTUNIQUE:{method:"countunique",parameters:[{argumentType:a.ArgumentTypes.SCALAR}],repeatLastArgs:1,expandRanges:!0}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(94),r(53),r(67),r(68),t.__esModule=!0,t.DateTimePlugin=void 0,r(325),r(221),r(242),r(95),r(63),r(122),r(77),r(97),r(210),r(109);var o=r(115),a=r(262),i=r(215),u=r(264),s=r(223),c=r(308);function l(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||h(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=h(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||h(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){if(e){if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=T(e);if(t){var o=T(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return E(this,r)}}function E(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(h,e);var t,r,n,c=v(h);function h(){var e;return m(this,h),(e=c.apply(this,arguments)).isoweeknumCore=function(t){var r=Math.floor(e.interpreter.dateHelper.relativeNumberToAbsoluteNumber(t)),n=e.interpreter.dateHelper.numberToSimpleDate(t),o=e.interpreter.dateHelper.dateToNumber({year:n.year,month:1,day:1}),a=e.interpreter.dateHelper.relativeNumberToAbsoluteNumber(o),i=a+((4-a)%7+7)%7,u=Math.floor((r-1)/7)-Math.floor((i-1)/7)+1;return 0===u?e.isoweeknumCore(t-7)+1:u},e.days360Core=function(t,r,n){var o,i,u=e.interpreter.dateHelper.numberToSimpleDate(t),s=e.interpreter.dateHelper.numberToSimpleDate(r);if(n)o=(0,a.toBasisEU)(u),i=(0,a.toBasisEU)(s);else{var c=p(e.interpreter.dateHelper.toBasisUS(u,s),2);o=c[0],i=c[1]}return 360*(i.year-o.year)+30*(i.month-o.month)+i.day-o.day},e}return t=h,(r=[{key:"date",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("DATE"),(function(e,t,n){var a=Math.trunc(n),u=Math.trunc(t),s=Math.trunc(e);s<r.interpreter.dateHelper.getEpochYearZero()&&(s+=r.interpreter.dateHelper.getEpochYearZero());var c=Math.floor((u-1)/12),l={year:s+=c,month:u-=12*c,day:1};if(r.interpreter.dateHelper.isValidDate(l)){var f=r.interpreter.dateHelper.dateToNumber(l)+(a-1);return void 0===(f=r.interpreter.dateHelper.getWithinBounds(f))?new o.CellError(o.ErrorType.NUM,i.ErrorMessage.DateBounds):f}return new o.CellError(o.ErrorType.VALUE,i.ErrorMessage.InvalidDate)}))}},{key:"time",value:function(e,t){return this.runFunction(e.args,t,this.metadata("TIME"),(function(e,t,r){var n=(0,a.timeToNumber)({hours:Math.trunc(e),minutes:Math.trunc(t),seconds:Math.trunc(r)});return n<0?new o.CellError(o.ErrorType.NUM,i.ErrorMessage.NegativeTime):n%1}))}},{key:"eomonth",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("EOMONTH"),(function(e,t){var n=r.interpreter.dateHelper.numberToSimpleDate(e),u=r.interpreter.dateHelper.dateToNumber(r.interpreter.dateHelper.endOfMonth((0,a.offsetMonth)(n,t)));return void 0===(u=r.interpreter.dateHelper.getWithinBounds(u))?new o.CellError(o.ErrorType.NUM,i.ErrorMessage.DateBounds):u}))}},{key:"day",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("DAY"),(function(e){return r.interpreter.dateHelper.numberToSimpleDate(e).day}))}},{key:"days",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DAYS"),(function(e,t){return Math.trunc(e)-Math.trunc(t)}))}},{key:"month",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("MONTH"),(function(e){return r.interpreter.dateHelper.numberToSimpleDate(e).month}))}},{key:"year",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("YEAR"),(function(e){return r.interpreter.dateHelper.numberToSimpleDate(e).year}))}},{key:"hour",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HOUR"),(function(e){return(0,a.numberToSimpleTime)((0,a.roundToNearestSecond)(e)%1).hours}))}},{key:"minute",value:function(e,t){return this.runFunction(e.args,t,this.metadata("MINUTE"),(function(e){return(0,a.numberToSimpleTime)((0,a.roundToNearestSecond)(e)%1).minutes}))}},{key:"second",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SECOND"),(function(e){return(0,a.numberToSimpleTime)((0,a.roundToNearestSecond)(e)%1).seconds}))}},{key:"text",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("TEXT"),(function(e,t){return(0,u.format)(e,t,r.config,r.interpreter.dateHelper)}))}},{key:"weekday",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("WEEKDAY"),(function(e,t){var n=Math.floor(r.interpreter.dateHelper.relativeNumberToAbsoluteNumber(e));if(3===t)return(n-1)%7;var a=S.get(t);return void 0===a?new o.CellError(o.ErrorType.NUM,i.ErrorMessage.BadMode):(n-a)%7+1}))}},{key:"weeknum",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("WEEKNUM"),(function(e,t){var n=Math.floor(r.interpreter.dateHelper.relativeNumberToAbsoluteNumber(e)),a=r.interpreter.dateHelper.numberToSimpleDate(e),u=r.interpreter.dateHelper.dateToNumber({year:a.year,month:1,day:1}),s=r.interpreter.dateHelper.relativeNumberToAbsoluteNumber(u);if(21===t)return r.isoweeknumCore(e);var c=S.get(t);return void 0===c?new o.CellError(o.ErrorType.NUM,i.ErrorMessage.BadMode):Math.floor((n-c)/7)-Math.floor((s-c)/7)+1}))}},{key:"isoweeknum",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISOWEEKNUM"),this.isoweeknumCore)}},{key:"datevalue",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("DATEVALUE"),(function(e){var t=r.interpreter.dateHelper.parseDateTimeFromConfigFormats(e).dateTime;return void 0===t?new o.CellError(o.ErrorType.VALUE,i.ErrorMessage.IncorrectDateTime):(0,a.instanceOfSimpleDate)(t)?((0,a.instanceOfSimpleTime)(t)?Math.trunc((0,a.timeToNumber)(t)):0)+r.interpreter.dateHelper.dateToNumber(t):0}))}},{key:"timevalue",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("TIMEVALUE"),(function(e){var t=r.interpreter.dateHelper.dateStringToDateNumber(e);return void 0===t?new o.CellError(o.ErrorType.VALUE,i.ErrorMessage.IncorrectDateTime):(0,s.getRawValue)(t)%1}))}},{key:"now",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("NOW"),(function(){var e=new Date;return(0,a.timeToNumber)({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()})+r.interpreter.dateHelper.dateToNumber({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDay()})}))}},{key:"today",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("TODAY"),(function(){var e=new Date;return r.interpreter.dateHelper.dateToNumber({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDay()})}))}},{key:"edate",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("EDATE"),(function(e,t){var n=r.interpreter.dateHelper.numberToSimpleDate(e),u=(0,a.truncateDayInMonth)((0,a.offsetMonth)(n,t)),s=r.interpreter.dateHelper.dateToNumber(u);return void 0===(s=r.interpreter.dateHelper.getWithinBounds(s))?new o.CellError(o.ErrorType.NUM,i.ErrorMessage.DateBounds):s}))}},{key:"datedif",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("DATEDIF"),(function(e,t,n){if(e>t)return new o.CellError(o.ErrorType.NUM,i.ErrorMessage.StartEndDate);if("D"===n)return Math.floor(t)-Math.floor(e);var a=r.interpreter.dateHelper.numberToSimpleDate(e),u=r.interpreter.dateHelper.numberToSimpleDate(t);switch(n){case"M":return 12*(u.year-a.year)+(u.month-a.month)-(u.day<a.day?1:0);case"YM":return(u.month-a.month+12-(u.day<a.day?1:0))%12;case"Y":return u.month>a.month||u.month===a.month&&u.day>=a.day?u.year-a.year:u.year-a.year-1;case"MD":if(u.day>=a.day)return u.day-a.day;var s=1===u.month?12:u.month-1,c=1===u.month?u.year-1:u.year;return r.interpreter.dateHelper.daysInMonth(c,s)+u.day-a.day;case"YD":return u.month>a.month||u.month===a.month&&u.day>=a.day?Math.floor(t)-r.interpreter.dateHelper.dateToNumber({year:u.year,month:a.month,day:a.day}):Math.floor(t)-Math.floor(e)-365*(u.year-a.year-1)-r.interpreter.dateHelper.leapYearsCount(u.year-1)+r.interpreter.dateHelper.leapYearsCount(a.year);default:return new o.CellError(o.ErrorType.NUM,i.ErrorMessage.BadMode)}}))}},{key:"days360",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DAYS360"),this.days360Core)}},{key:"yearfrac",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("YEARFRAC"),(function(e,t,n){if((e=Math.trunc(e))>(t=Math.trunc(t))){var o=[t,e];e=o[0],t=o[1]}switch(n){case 0:return r.days360Core(e,t,!1)/360;case 1:return(t-e)/r.interpreter.dateHelper.yearLengthForBasis(r.interpreter.dateHelper.numberToSimpleDate(e),r.interpreter.dateHelper.numberToSimpleDate(t));case 2:return(t-e)/360;case 3:return(t-e)/365;case 4:return r.days360Core(e,t,!0)/360}throw new Error("Should not be reachable.")}))}},{key:"interval",value:function(e,t){return this.runFunction(e.args,t,this.metadata("INTERVAL"),(function(e){var t=(e=Math.trunc(e))%60,r=(e=Math.trunc(e/60))%60,n=(e=Math.trunc(e/60))%24,o=(e=Math.trunc(e/24))%30,a=(e=Math.trunc(e/30))%12,i=Math.trunc(e/12);return"P"+(i>0?i+"Y":"")+(a>0?a+"M":"")+(o>0?o+"D":"")+"T"+(n>0?n+"H":"")+(r>0?r+"M":"")+(t>0?t+"S":"")}))}},{key:"networkdays",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("NETWORKDAYS"),(function(e,t,n){return r.networkdayscore(e,t,1,n)}))}},{key:"networkdaysintl",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("NETWORKDAYS.INTL"),(function(e,t,n,o){return r.networkdayscore(e,t,n,o)}))}},{key:"workday",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("WORKDAY"),(function(e,t,n){return r.workdaycore(e,t,1,n)}))}},{key:"workdayintl",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("WORKDAY.INTL"),(function(e,t,n,o){return r.workdaycore(e,t,n,o)}))}},{key:"networkdayscore",value:function(e,t,r,n){var a=1;if((e=Math.trunc(e))>(t=Math.trunc(t))){var i=[t,e];e=i[0],t=i[1],a=-1}var u=A(r);if(u instanceof o.CellError)return u;var s=this.simpleRangeToFilteredHolidays(n,u);return s instanceof o.CellError?s:a*this.countWorkdays(e,t,u,s)}},{key:"workdaycore",value:function(e,t,r,n){e=Math.trunc(e),t=Math.trunc(t);var a=A(r);if(a instanceof o.CellError)return a;var i=this.simpleRangeToFilteredHolidays(n,a);if(i instanceof o.CellError)return i;if(t>0){for(var u=1;this.countWorkdays(e+1,e+u,a,i)<t;)u*=2;for(var s=1;s+1<u;){var c=Math.trunc((s+u)/2);this.countWorkdays(e+1,e+c,a,i)<t?s=c:u=c}return e+u}if(t<0){t*=-1;for(var l=1;this.countWorkdays(e-l,e-1,a,i)<t;)l*=2;for(var f=1;f+1<l;){var p=Math.trunc((f+l)/2);this.countWorkdays(e-p,e-1,a,i)<t?f=p:l=p}return e-l}return e}},{key:"countWorkdays",value:function(e,t,r,n){for(var o=Math.floor(this.interpreter.dateHelper.relativeNumberToAbsoluteNumber(t)),a=Math.floor(this.interpreter.dateHelper.relativeNumberToAbsoluteNumber(e)),i=0,u=0;u<7;u++)"0"===r.charAt(u)&&(i+=Math.floor((o+6-u)/7),i-=Math.floor((a-1+6-u)/7));return i-=R(t+1,n)-R(e,n)}},{key:"simpleRangeToFilteredHolidays",value:function(e,t){var r,n,a=this,u=null!==(r=null==e?void 0:e.valuesFromTopLeftCorner())&&void 0!==r?r:[],c=f(u);try{for(c.s();!(n=c.n()).done;){var p=n.value;if(p instanceof o.CellError)return p}}catch(e){c.e(e)}finally{c.f()}var h,d=[],m=f(u);try{for(m.s();!(h=m.n()).done;){var y=h.value;if(y!==s.EmptyValue){if(!(0,s.isExtendedNumber)(y))return new o.CellError(o.ErrorType.VALUE,i.ErrorMessage.WrongType);d.push(Math.trunc((0,s.getRawValue)(y)))}}}catch(e){m.e(e)}finally{m.f()}return l(new Set(d)).sort((function(e,t){return e-t})).filter((function(e){var r=(a.interpreter.dateHelper.relativeNumberToAbsoluteNumber(e)-1)%7;return"0"===t.charAt(r)}))}}])&&y(t.prototype,r),n&&y(t,n),h}(c.FunctionPlugin);function R(e,t){if(0===t.length)return 0;if(e<=t[0])return 0;if(t[t.length-1]<e)return t.length;for(var r=0,n=t.length-1;r+1<n;){var o=Math.floor((n+r)/2);t[o]>=e?n=o:r=o}return n}function A(e){var t;return"number"!=typeof e&&"string"!=typeof e?new o.CellError(o.ErrorType.VALUE,i.ErrorMessage.WrongType):"string"==typeof e?7===e.length&&/^(0|1)*$/.test(e)&&"1111111"!==e?e:new o.CellError(o.ErrorType.NUM,i.ErrorMessage.WeekendString):null!==(t=N.get(e))&&void 0!==t?t:new o.CellError(o.ErrorType.NUM,i.ErrorMessage.BadMode)}t.DateTimePlugin=b,b.implementedFunctions={DATE:{method:"date",parameters:[{argumentType:c.ArgumentTypes.NUMBER},{argumentType:c.ArgumentTypes.NUMBER},{argumentType:c.ArgumentTypes.NUMBER}],returnNumberType:s.NumberType.NUMBER_DATE},TIME:{method:"time",parameters:[{argumentType:c.ArgumentTypes.NUMBER},{argumentType:c.ArgumentTypes.NUMBER},{argumentType:c.ArgumentTypes.NUMBER}],returnNumberType:s.NumberType.NUMBER_TIME},MONTH:{method:"month",parameters:[{argumentType:c.ArgumentTypes.NUMBER,minValue:0}]},YEAR:{method:"year",parameters:[{argumentType:c.ArgumentTypes.NUMBER,minValue:0}]},HOUR:{method:"hour",parameters:[{argumentType:c.ArgumentTypes.NUMBER,minValue:0}]},MINUTE:{method:"minute",parameters:[{argumentType:c.ArgumentTypes.NUMBER,minValue:0}]},SECOND:{method:"second",parameters:[{argumentType:c.ArgumentTypes.NUMBER,minValue:0}]},TEXT:{method:"text",parameters:[{argumentType:c.ArgumentTypes.NUMBER},{argumentType:c.ArgumentTypes.STRING}]},EOMONTH:{method:"eomonth",parameters:[{argumentType:c.ArgumentTypes.NUMBER,minValue:0},{argumentType:c.ArgumentTypes.NUMBER}],returnNumberType:s.NumberType.NUMBER_DATE},DAY:{method:"day",parameters:[{argumentType:c.ArgumentTypes.NUMBER,minValue:0}]},DAYS:{method:"days",parameters:[{argumentType:c.ArgumentTypes.NUMBER,minValue:0},{argumentType:c.ArgumentTypes.NUMBER,minValue:0}]},WEEKDAY:{method:"weekday",parameters:[{argumentType:c.ArgumentTypes.NUMBER,minValue:0},{argumentType:c.ArgumentTypes.NUMBER,defaultValue:1}]},WEEKNUM:{method:"weeknum",parameters:[{argumentType:c.ArgumentTypes.NUMBER,minValue:0},{argumentType:c.ArgumentTypes.NUMBER,defaultValue:1}]},ISOWEEKNUM:{method:"isoweeknum",parameters:[{argumentType:c.ArgumentTypes.NUMBER,minValue:0}]},DATEVALUE:{method:"datevalue",parameters:[{argumentType:c.ArgumentTypes.STRING}],returnNumberType:s.NumberType.NUMBER_DATE},TIMEVALUE:{method:"timevalue",parameters:[{argumentType:c.ArgumentTypes.STRING}],returnNumberType:s.NumberType.NUMBER_TIME},NOW:{method:"now",parameters:[],isVolatile:!0,returnNumberType:s.NumberType.NUMBER_DATETIME},TODAY:{method:"today",parameters:[],isVolatile:!0,returnNumberType:s.NumberType.NUMBER_DATE},EDATE:{method:"edate",parameters:[{argumentType:c.ArgumentTypes.NUMBER,minValue:0},{argumentType:c.ArgumentTypes.NUMBER}],returnNumberType:s.NumberType.NUMBER_DATE},DAYS360:{method:"days360",parameters:[{argumentType:c.ArgumentTypes.NUMBER,minValue:0},{argumentType:c.ArgumentTypes.NUMBER,minValue:0},{argumentType:c.ArgumentTypes.BOOLEAN,defaultValue:!1}]},DATEDIF:{method:"datedif",parameters:[{argumentType:c.ArgumentTypes.NUMBER,minValue:0},{argumentType:c.ArgumentTypes.NUMBER,minValue:0},{argumentType:c.ArgumentTypes.STRING}]},YEARFRAC:{method:"yearfrac",parameters:[{argumentType:c.ArgumentTypes.NUMBER,minValue:0},{argumentType:c.ArgumentTypes.NUMBER,minValue:0},{argumentType:c.ArgumentTypes.INTEGER,defaultValue:0,minValue:0,maxValue:4}]},INTERVAL:{method:"interval",parameters:[{argumentType:c.ArgumentTypes.NUMBER,minValue:0}]},NETWORKDAYS:{method:"networkdays",parameters:[{argumentType:c.ArgumentTypes.NUMBER,minValue:0},{argumentType:c.ArgumentTypes.NUMBER,minValue:0},{argumentType:c.ArgumentTypes.RANGE,optionalArg:!0}]},"NETWORKDAYS.INTL":{method:"networkdaysintl",parameters:[{argumentType:c.ArgumentTypes.NUMBER,minValue:0},{argumentType:c.ArgumentTypes.NUMBER,minValue:0},{argumentType:c.ArgumentTypes.NOERROR,defaultValue:1},{argumentType:c.ArgumentTypes.RANGE,optionalArg:!0}]},WORKDAY:{method:"workday",parameters:[{argumentType:c.ArgumentTypes.NUMBER,minValue:0},{argumentType:c.ArgumentTypes.NUMBER},{argumentType:c.ArgumentTypes.RANGE,optionalArg:!0}]},"WORKDAY.INTL":{method:"workdayintl",parameters:[{argumentType:c.ArgumentTypes.NUMBER,minValue:0},{argumentType:c.ArgumentTypes.NUMBER},{argumentType:c.ArgumentTypes.NOERROR,defaultValue:1},{argumentType:c.ArgumentTypes.RANGE,optionalArg:!0}]}};var S=new Map([[1,0],[2,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6],[17,0]]),N=new Map([[1,"0000011"],[2,"1000001"],[3,"1100000"],[4,"0110000"],[5,"0011000"],[6,"0001100"],[7,"0000110"],[11,"0000001"],[12,"1000000"],[13,"0100000"],[14,"0010000"],[15,"0001000"],[16,"0000100"],[17,"0000010"]])},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.DegreesPlugin=void 0,r(109);var o=r(308);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var o=l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(c,e);var t,r,n,o=s(c);function c(){return a(this,c),o.apply(this,arguments)}return t=c,(r=[{key:"degrees",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DEGREES"),(function(e){return e*(180/Math.PI)}))}}])&&i(t.prototype,r),n&&i(t,n),c}(o.FunctionPlugin);t.DegreesPlugin=f,f.implementedFunctions={DEGREES:{method:"degrees",parameters:[{argumentType:o.ArgumentTypes.NUMBER}]}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.DeltaPlugin=void 0,r(109);var o=r(308);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var o=l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(c,e);var t,r,n,o=s(c);function c(){return a(this,c),o.apply(this,arguments)}return t=c,(r=[{key:"delta",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DELTA"),(function(e,t){return e===t?1:0}))}}])&&i(t.prototype,r),n&&i(t,n),c}(o.FunctionPlugin);t.DeltaPlugin=f,f.implementedFunctions={DELTA:{method:"delta",parameters:[{argumentType:o.ArgumentTypes.NUMBER},{argumentType:o.ArgumentTypes.NUMBER,defaultValue:0}]}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.ExpPlugin=void 0,r(109);var o=r(308);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var o=l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(c,e);var t,r,n,o=s(c);function c(){return a(this,c),o.apply(this,arguments)}return t=c,(r=[{key:"exp",value:function(e,t){return this.runFunction(e.args,t,this.metadata("EXP"),Math.exp)}}])&&i(t.prototype,r),n&&i(t,n),c}(o.FunctionPlugin);t.ExpPlugin=f,f.implementedFunctions={EXP:{method:"exp",parameters:[{argumentType:o.ArgumentTypes.NUMBER}]}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(53),r(63),r(67),r(68),r(77),r(87),r(93),r(94),r(95),r(97),t.__esModule=!0,t.FinancialPlugin=void 0,r(325),r(109);var o=r(115),a=r(215),i=r(223),u=r(308);function s(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m(e);if(t){var o=m(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d(this,r)}}function d(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(c,e);var t,r,n,u=h(c);function c(){return l(this,c),u.apply(this,arguments)}return t=c,(r=[{key:"pmt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("PMT"),g)}},{key:"ipmt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IPMT"),v)}},{key:"ppmt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("PPMT"),T)}},{key:"fv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FV"),E)}},{key:"cumipmt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CUMIPMT"),(function(e,t,r,n,i,u){if(n>i)return new o.CellError(o.ErrorType.NUM,a.ErrorMessage.EndStartPeriod);for(var s=0,c=n;c<=i;c++)s+=v(e,c,t,r,0,u);return s}))}},{key:"cumprinc",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CUMPRINC"),(function(e,t,r,n,i,u){if(n>i)return new o.CellError(o.ErrorType.NUM,a.ErrorMessage.EndStartPeriod);for(var s=0,c=n;c<=i;c++)s+=T(e,c,t,r,0,u);return s}))}},{key:"db",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DB"),(function(e,t,r,n,i){if(12===i&&n>r||n>r+1)return new o.CellError(o.ErrorType.NUM,a.ErrorMessage.PeriodLong);if(t>=e)return 0;var u=Math.round(1e3*(1-Math.pow(t/e,1/r)))/1e3,s=e*u*i/12;if(1===n)return s;for(var c=s,l=0;l<n-2;l++)c+=(e-c)*u;return n===r+1?(e-c)*u*(12-i)/12:(e-c)*u}))}},{key:"ddb",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DDB"),(function(e,t,r,n,a){if(n>r)return new o.CellError(o.ErrorType.NUM);var i,u=a/r;u>=1?(u=1,i=1===n?e:0):i=e*Math.pow(1-u,n-1);var s=e*Math.pow(1-u,n);return Math.max(i-Math.max(t,s),0)}))}},{key:"dollarde",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARDE"),(function(e,t){if(t<1)return new o.CellError(o.ErrorType.DIV_BY_ZERO);for(t=Math.trunc(t);t>10;)t/=10;return Math.trunc(e)+10*(e-Math.trunc(e))/t}))}},{key:"dollarfr",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARFR"),(function(e,t){if(t<1)return new o.CellError(o.ErrorType.DIV_BY_ZERO);for(t=Math.trunc(t);t>10;)t/=10;return Math.trunc(e)+(e-Math.trunc(e))*t/10}))}},{key:"effect",value:function(e,t){return this.runFunction(e.args,t,this.metadata("EFFECT"),(function(e,t){return t=Math.trunc(t),Math.pow(1+e/t,t)-1}))}},{key:"ispmt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISPMT"),(function(e,t,r,n){return 0===r?new o.CellError(o.ErrorType.DIV_BY_ZERO):n*e*(t/r-1)}))}},{key:"nominal",value:function(e,t){return this.runFunction(e.args,t,this.metadata("NOMINAL"),(function(e,t){return t=Math.trunc(t),(Math.pow(e+1,1/t)-1)*t}))}},{key:"nper",value:function(e,t){return this.runFunction(e.args,t,this.metadata("NPER"),(function(e,t,r,n,a){return 0===e?0===t?new o.CellError(o.ErrorType.DIV_BY_ZERO):(-r-n)/t:(a&&(t*=1+e),Math.log((t-n*e)/(r*e+t))/Math.log(1+e))}))}},{key:"rate",value:function(e,t){return this.runFunction(e.args,t,this.metadata("RATE"),(function(e,t,r,n,a,i){if(i<=-1)return new o.CellError(o.ErrorType.VALUE);var u=i;a=a?1:0;for(var s=0;s<20;s++){if(u<=-1)return new o.CellError(o.ErrorType.NUM);var c=void 0;if(Math.abs(u)<1e-10)c=r*(1+e*u)+t*(1+u*a)*e+n;else{var l=Math.pow(1+u,e);c=r*l+t*(1/u+a)*(l-1)+n}if(Math.abs(c)<1e-10)return u;var f=void 0;if(Math.abs(u)<1e-10)f=r*e+t*a*e;else{var p=Math.pow(1+u,e),h=e*Math.pow(1+u,e-1);f=r*h+t*(1/u+a)*h+t*(-1/(u*u))*(p-1)}u-=c/f}return new o.CellError(o.ErrorType.NUM)}))}},{key:"pv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("PV"),(function(e,t,r,n,a){return a=a?1:0,-1===e?0===t?new o.CellError(o.ErrorType.NUM):new o.CellError(o.ErrorType.DIV_BY_ZERO):0===e?-r*t-n:((1-Math.pow(1+e,t))*r*(1+e*a)/e-n)/Math.pow(1+e,t)}))}},{key:"rri",value:function(e,t){return this.runFunction(e.args,t,this.metadata("RRI"),(function(e,t,r){return 0===t||r<0&&t>0||r>0&&t<0?new o.CellError(o.ErrorType.NUM):Math.pow(r/t,1/e)-1}))}},{key:"sln",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SLN"),(function(e,t,r){return 0===r?new o.CellError(o.ErrorType.DIV_BY_ZERO):(e-t)/r}))}},{key:"syd",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SYD"),(function(e,t,r,n){return n>r?new o.CellError(o.ErrorType.NUM):(e-t)*(r-n+1)*2/(r*(r+1))}))}},{key:"tbilleq",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("TBILLEQ"),(function(e,t,n){if((e=Math.round(e))>=(t=Math.round(t)))return new o.CellError(o.ErrorType.NUM);var a=r.interpreter.dateHelper.numberToSimpleDate(e),i=r.interpreter.dateHelper.numberToSimpleDate(t);if(i.year>a.year+1||i.year===a.year+1&&(i.month>a.month||i.month===a.month&&i.day>a.day))return new o.CellError(o.ErrorType.NUM);var u=360-n*(t-e);return 0===u?0:u<0?new o.CellError(o.ErrorType.NUM):365*n/u}))}},{key:"tbillprice",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("TBILLPRICE"),(function(e,t,n){if((e=Math.round(e))>=(t=Math.round(t)))return new o.CellError(o.ErrorType.NUM);var a=r.interpreter.dateHelper.numberToSimpleDate(e),i=r.interpreter.dateHelper.numberToSimpleDate(t);if(i.year>a.year+1||i.year===a.year+1&&(i.month>a.month||i.month===a.month&&i.day>a.day))return new o.CellError(o.ErrorType.NUM);var u=360-n*(t-e);return 0===u?0:u<0?new o.CellError(o.ErrorType.NUM):100*(1-n*(t-e)/360)}))}},{key:"tbillyield",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("TBILLYIELD"),(function(e,t,n){if((e=Math.round(e))>=(t=Math.round(t)))return new o.CellError(o.ErrorType.NUM);var a=r.interpreter.dateHelper.numberToSimpleDate(e),i=r.interpreter.dateHelper.numberToSimpleDate(t);return i.year>a.year+1||i.year===a.year+1&&(i.month>a.month||i.month===a.month&&i.day>a.day)?new o.CellError(o.ErrorType.NUM):360*(100-n)/(n*(t-e))}))}},{key:"fvschedule",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FVSCHEDULE"),(function(e,t){var r,n=t.valuesFromTopLeftCorner(),u=s(n);try{for(u.s();!(r=u.n()).done;){var c=r.value;if(c instanceof o.CellError)return c}}catch(e){u.e(e)}finally{u.f()}var l,f=s(n);try{for(f.s();!(l=f.n()).done;){var p=l.value;if((0,i.isExtendedNumber)(p))e*=1+(0,i.getRawValue)(p);else if(p!==i.EmptyValue)return new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.NumberExpected)}}catch(e){f.e(e)}finally{f.f()}return e}))}},{key:"npv",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("NPV"),(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];var i=r.interpreter.arithmeticHelper.coerceNumbersExactRanges(n);return i instanceof o.CellError?i:b(e,i)}))}},{key:"mirr",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("MIRR"),(function(e,t,n){var a=r.interpreter.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());if(a instanceof o.CellError)return a;var i,u=!1,c=!1,l=[],f=[],p=s(a);try{for(p.s();!(i=p.n()).done;){var h=i.value;h>0?(u=!0,l.push(h),f.push(0)):h<0?(c=!0,f.push(h),l.push(0)):(f.push(0),l.push(0))}}catch(e){p.e(e)}finally{p.f()}if(!u||!c)return new o.CellError(o.ErrorType.DIV_BY_ZERO);var d=a.length,m=b(n,l);if(m instanceof o.CellError)return m;var y=b(t,f);return y instanceof o.CellError?y:Math.pow(-m*Math.pow(1+n,d)/y/(1+t),1/(d-1))-1}))}},{key:"pduration",value:function(e,t){return this.runFunction(e.args,t,this.metadata("PDURATION"),(function(e,t,r){return(Math.log(r)-Math.log(t))/Math.log(1+e)}))}},{key:"xnpv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("XNPV"),(function(e,t,r){var n,i=t.valuesFromTopLeftCorner(),u=s(i);try{for(u.s();!(n=u.n()).done;)if("number"!=typeof n.value)return new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.NumberExpected)}catch(e){u.e(e)}finally{u.f()}var c,l=i,f=r.valuesFromTopLeftCorner(),p=s(f);try{for(p.s();!(c=p.n()).done;)if("number"!=typeof c.value)return new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.NumberExpected)}catch(e){p.e(e)}finally{p.f()}var h=f;if(h.length!==l.length)return new o.CellError(o.ErrorType.NUM,a.ErrorMessage.EqualLength);var d=h.length,m=0;if(h[0]<0)return new o.CellError(o.ErrorType.NUM,a.ErrorMessage.ValueSmall);for(var y=0;y<d;y++){if(h[y]=Math.floor(h[y]),h[y]<h[0])return new o.CellError(o.ErrorType.NUM,a.ErrorMessage.ValueSmall);m+=l[y]/Math.pow(1+e,(h[y]-h[0])/365)}return m}))}}])&&f(t.prototype,r),n&&f(t,n),c}(u.FunctionPlugin);function g(e,t,r,n,o){if(0===e)return(-r-n)/t;var a=Math.pow(1+e,t);return(n*e+r*e*a)*(o?1/(1+e):1)/(1-a)}function v(e,t,r,n,o,a){var i=g(e,r,n,o,a);return 1===t?e*(a?0:-n):e*(a?E(e,t-2,i,n,a)-i:E(e,t-1,i,n,a))}function E(e,t,r,n,o){if(0===e)return-n-r*t;var a=Math.pow(1+e,t);return r*(o?1+e:1)*(1-a)/e-n*a}function T(e,t,r,n,o,a){return g(e,r,n,o,a)-v(e,t,r,n,o,a)}function b(e,t){for(var r=0,n=t.length-1;n>=0;n--){if(r+=t[n],-1===e){if(0===r)continue;return new o.CellError(o.ErrorType.DIV_BY_ZERO)}r/=1+e}return r}t.FinancialPlugin=y,y.implementedFunctions={PMT:{method:"pmt",parameters:[{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER,defaultValue:0},{argumentType:u.ArgumentTypes.NUMBER,defaultValue:0}],returnNumberType:i.NumberType.NUMBER_CURRENCY},IPMT:{method:"ipmt",parameters:[{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER,defaultValue:0},{argumentType:u.ArgumentTypes.NUMBER,defaultValue:0}],returnNumberType:i.NumberType.NUMBER_CURRENCY},PPMT:{method:"ppmt",parameters:[{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER,defaultValue:0},{argumentType:u.ArgumentTypes.NUMBER,defaultValue:0}],returnNumberType:i.NumberType.NUMBER_CURRENCY},FV:{method:"fv",parameters:[{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER,defaultValue:0},{argumentType:u.ArgumentTypes.NUMBER,defaultValue:0}],returnNumberType:i.NumberType.NUMBER_CURRENCY},CUMIPMT:{method:"cumipmt",parameters:[{argumentType:u.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:u.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:u.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:u.ArgumentTypes.INTEGER,minValue:1},{argumentType:u.ArgumentTypes.INTEGER,minValue:1},{argumentType:u.ArgumentTypes.INTEGER,minValue:0,maxValue:1}],returnNumberType:i.NumberType.NUMBER_CURRENCY},CUMPRINC:{method:"cumprinc",parameters:[{argumentType:u.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:u.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:u.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:u.ArgumentTypes.INTEGER,minValue:1},{argumentType:u.ArgumentTypes.INTEGER,minValue:1},{argumentType:u.ArgumentTypes.INTEGER,minValue:0,maxValue:1}],returnNumberType:i.NumberType.NUMBER_CURRENCY},DB:{method:"db",parameters:[{argumentType:u.ArgumentTypes.NUMBER,minValue:0},{argumentType:u.ArgumentTypes.NUMBER,minValue:0},{argumentType:u.ArgumentTypes.INTEGER,minValue:0},{argumentType:u.ArgumentTypes.INTEGER,minValue:0},{argumentType:u.ArgumentTypes.INTEGER,minValue:1,maxValue:12,defaultValue:12}],returnNumberType:i.NumberType.NUMBER_CURRENCY},DDB:{method:"ddb",parameters:[{argumentType:u.ArgumentTypes.NUMBER,minValue:0},{argumentType:u.ArgumentTypes.NUMBER,minValue:0},{argumentType:u.ArgumentTypes.INTEGER,minValue:0},{argumentType:u.ArgumentTypes.NUMBER,minValue:0},{argumentType:u.ArgumentTypes.NUMBER,greaterThan:0,defaultValue:2}],returnNumberType:i.NumberType.NUMBER_CURRENCY},DOLLARDE:{method:"dollarde",parameters:[{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER,minValue:0}]},DOLLARFR:{method:"dollarfr",parameters:[{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER,minValue:0}]},EFFECT:{method:"effect",parameters:[{argumentType:u.ArgumentTypes.NUMBER,minValue:0},{argumentType:u.ArgumentTypes.NUMBER,minValue:1}],returnNumberType:i.NumberType.NUMBER_PERCENT},ISPMT:{method:"ispmt",parameters:[{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER}]},NOMINAL:{method:"nominal",parameters:[{argumentType:u.ArgumentTypes.NUMBER,minValue:0},{argumentType:u.ArgumentTypes.NUMBER,minValue:1}],returnNumberType:i.NumberType.NUMBER_PERCENT},NPER:{method:"nper",parameters:[{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER,defaultValue:0},{argumentType:u.ArgumentTypes.NUMBER,defaultValue:0}]},PV:{method:"pv",parameters:[{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER,defaultValue:0},{argumentType:u.ArgumentTypes.NUMBER,defaultValue:0}],returnNumberType:i.NumberType.NUMBER_CURRENCY},RATE:{method:"rate",parameters:[{argumentType:u.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER,defaultValue:0},{argumentType:u.ArgumentTypes.NUMBER,defaultValue:0},{argumentType:u.ArgumentTypes.NUMBER,defaultValue:.1}],returnNumberType:i.NumberType.NUMBER_PERCENT},RRI:{method:"rri",parameters:[{argumentType:u.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER}],returnNumberType:i.NumberType.NUMBER_PERCENT},SLN:{method:"sln",parameters:[{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER}],returnNumberType:i.NumberType.NUMBER_CURRENCY},SYD:{method:"syd",parameters:[{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:u.ArgumentTypes.NUMBER,greaterThan:0}],returnNumberType:i.NumberType.NUMBER_CURRENCY},TBILLEQ:{method:"tbilleq",parameters:[{argumentType:u.ArgumentTypes.NUMBER,minValue:0},{argumentType:u.ArgumentTypes.NUMBER,minValue:0},{argumentType:u.ArgumentTypes.NUMBER,greaterThan:0}],returnNumberType:i.NumberType.NUMBER_PERCENT},TBILLPRICE:{method:"tbillprice",parameters:[{argumentType:u.ArgumentTypes.NUMBER,minValue:0},{argumentType:u.ArgumentTypes.NUMBER,minValue:0},{argumentType:u.ArgumentTypes.NUMBER,greaterThan:0}],returnNumberType:i.NumberType.NUMBER_CURRENCY},TBILLYIELD:{method:"tbillyield",parameters:[{argumentType:u.ArgumentTypes.NUMBER,minValue:0},{argumentType:u.ArgumentTypes.NUMBER,minValue:0},{argumentType:u.ArgumentTypes.NUMBER,greaterThan:0}],returnNumberType:i.NumberType.NUMBER_PERCENT},FVSCHEDULE:{method:"fvschedule",parameters:[{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.RANGE}],returnNumberType:i.NumberType.NUMBER_CURRENCY},NPV:{method:"npv",parameters:[{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.ANY}],repeatLastArgs:1,returnNumberType:i.NumberType.NUMBER_CURRENCY},MIRR:{method:"mirr",parameters:[{argumentType:u.ArgumentTypes.RANGE},{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER}],returnNumberType:i.NumberType.NUMBER_PERCENT},PDURATION:{method:"pduration",parameters:[{argumentType:u.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:u.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:u.ArgumentTypes.NUMBER,greaterThan:0}]},XNPV:{method:"xnpv",parameters:[{argumentType:u.ArgumentTypes.NUMBER,greaterThan:-1},{argumentType:u.ArgumentTypes.RANGE},{argumentType:u.ArgumentTypes.RANGE}]}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.FormulaTextPlugin=void 0,r(109);var o=r(115),a=r(215),i=r(318),u=r(308);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h(e);if(t){var o=h(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(u,e);var t,r,n,i=f(u);function u(){return s(this,u),i.apply(this,arguments)}return t=u,(r=[{key:"formulatext",value:function(e,t){var r=this;return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("FORMULATEXT"),(function(){return new o.CellError(o.ErrorType.NA,a.ErrorMessage.WrongArgNumber)}),(function(e){var t;return null!==(t=r.serialization.getCellFormula(e))&&void 0!==t?t:new o.CellError(o.ErrorType.NA,a.ErrorMessage.Formula)}))}}])&&c(t.prototype,r),n&&c(t,n),u}(i.FunctionPlugin);t.FormulaTextPlugin=d,d.implementedFunctions={FORMULATEXT:{method:"formulatext",parameters:[{argumentType:u.ArgumentTypes.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,isDependentOnSheetStructureChange:!0}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.InformationPlugin=void 0,r(109);var o=r(115),a=r(118),i=r(215),u=r(141),s=r(223),c=r(308);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m(e);if(t){var o=m(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d(this,r)}}function d(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(m,e);var t,r,n,d=h(m);function m(){return l(this,m),d.apply(this,arguments)}return t=m,(r=[{key:"isbinary",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISBINARY"),(function(e){return/^[01]{1,10}$/.test(e)}))}},{key:"iserr",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISERR"),(function(e){return e instanceof o.CellError&&e.type!==o.ErrorType.NA}))}},{key:"iserror",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISERROR"),(function(e){return e instanceof o.CellError}))}},{key:"isformula",value:function(e,t){var r=this;return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ISFORMULA"),(function(){return new o.CellError(o.ErrorType.NA,i.ErrorMessage.WrongArgNumber)}),(function(e){var t=r.dependencyGraph.addressMapping.getCell(e);return t instanceof a.FormulaCellVertex||t instanceof a.MatrixVertex&&t.isFormula()}))}},{key:"isblank",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISBLANK"),(function(e){return e===s.EmptyValue}))}},{key:"isna",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISNA"),(function(e){return e instanceof o.CellError&&e.type==o.ErrorType.NA}))}},{key:"isnumber",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISNUMBER"),s.isExtendedNumber)}},{key:"islogical",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISLOGICAL"),(function(e){return"boolean"==typeof e}))}},{key:"isref",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISREF"),(function(e){return e instanceof o.CellError&&(e.type==o.ErrorType.REF||e.type==o.ErrorType.CYCLE)}))}},{key:"istext",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISTEXT"),(function(e){return"string"==typeof e}))}},{key:"isnontext",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISNONTEXT"),(function(e){return!("string"==typeof e)}))}},{key:"column",value:function(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("COLUMN"),(function(){return t.col+1}),(function(e){return e.col+1}))}},{key:"columns",value:function(e,t){if(1!==e.args.length)return new o.CellError(o.ErrorType.NA,i.ErrorMessage.WrongArgNumber);if(e.args.some((function(e){return e.type===u.AstNodeType.EMPTY})))return new o.CellError(o.ErrorType.NUM,i.ErrorMessage.EmptyArg);var r=e.args[0];return r.type===u.AstNodeType.CELL_RANGE?r.end.col-r.start.col+1:new o.CellError(o.ErrorType.VALUE,i.ErrorMessage.CellRangeExpected)}},{key:"row",value:function(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ROW"),(function(){return t.row+1}),(function(e){return e.row+1}))}},{key:"rows",value:function(e,t){if(1!==e.args.length)return new o.CellError(o.ErrorType.NA,i.ErrorMessage.WrongArgNumber);if(e.args.some((function(e){return e.type===u.AstNodeType.EMPTY})))return new o.CellError(o.ErrorType.NUM,i.ErrorMessage.EmptyArg);var r=e.args[0];return r.type===u.AstNodeType.CELL_RANGE?r.end.row-r.start.row+1:new o.CellError(o.ErrorType.VALUE,i.ErrorMessage.CellRangeExpected)}},{key:"index",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("INDEX"),(function(e,t,n){var a;if(n<1||t<1)return new o.CellError(o.ErrorType.VALUE,i.ErrorMessage.LessThanOne);if(n>e.width()||t>e.height())return new o.CellError(o.ErrorType.NUM,i.ErrorMessage.ValueLarge);var u=e.range();if(void 0===u)return null!==(a=e.topLeftCornerValue())&&void 0!==a?a:new o.CellError(o.ErrorType.VALUE,i.ErrorMessage.CellRangeExpected);var s=u.getAddress(n-1,t-1);return r.dependencyGraph.getScalarValue(s)}))}},{key:"na",value:function(e,t){return new o.CellError(o.ErrorType.NA)}},{key:"sheet",value:function(e,t){var r=this;return this.runFunctionWithReferenceArgument(e.args,t,{parameters:[{argumentType:c.ArgumentTypes.STRING}]},(function(){return t.sheet+1}),(function(e){return e.sheet+1}),(function(e){var t=r.dependencyGraph.sheetMapping.get(e);return void 0!==t?t+1:new o.CellError(o.ErrorType.NA,i.ErrorMessage.SheetRef)}))}},{key:"sheets",value:function(e,t){var r=this;return this.runFunctionWithReferenceArgument(e.args,t,{parameters:[{argumentType:c.ArgumentTypes.STRING}]},(function(){return r.dependencyGraph.sheetMapping.numberOfSheets()}),(function(){return 1}),(function(){return new o.CellError(o.ErrorType.VALUE,i.ErrorMessage.CellRefExpected)}))}}])&&f(t.prototype,r),n&&f(t,n),m}(c.FunctionPlugin);t.InformationPlugin=y,y.implementedFunctions={COLUMN:{method:"column",parameters:[{argumentType:c.ArgumentTypes.NOERROR,optional:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0},COLUMNS:{method:"columns",isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0},ISBINARY:{method:"isbinary",parameters:[{argumentType:c.ArgumentTypes.STRING}]},ISERR:{method:"iserr",parameters:[{argumentType:c.ArgumentTypes.SCALAR}]},ISFORMULA:{method:"isformula",parameters:[{argumentType:c.ArgumentTypes.NOERROR}],doesNotNeedArgumentsToBeComputed:!0},ISNA:{method:"isna",parameters:[{argumentType:c.ArgumentTypes.SCALAR}]},ISREF:{method:"isref",parameters:[{argumentType:c.ArgumentTypes.SCALAR}]},ISERROR:{method:"iserror",parameters:[{argumentType:c.ArgumentTypes.SCALAR}]},ISBLANK:{method:"isblank",parameters:[{argumentType:c.ArgumentTypes.SCALAR}]},ISNUMBER:{method:"isnumber",parameters:[{argumentType:c.ArgumentTypes.SCALAR}]},ISLOGICAL:{method:"islogical",parameters:[{argumentType:c.ArgumentTypes.SCALAR}]},ISTEXT:{method:"istext",parameters:[{argumentType:c.ArgumentTypes.SCALAR}]},ISNONTEXT:{method:"isnontext",parameters:[{argumentType:c.ArgumentTypes.SCALAR}]},INDEX:{method:"index",parameters:[{argumentType:c.ArgumentTypes.RANGE},{argumentType:c.ArgumentTypes.NUMBER},{argumentType:c.ArgumentTypes.NUMBER,defaultValue:1}]},NA:{method:"na"},ROW:{method:"row",parameters:[{argumentType:c.ArgumentTypes.NOERROR,optional:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0},ROWS:{method:"rows",isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0},SHEET:{method:"sheet",parameters:[{argumentType:c.ArgumentTypes.NOERROR}],doesNotNeedArgumentsToBeComputed:!0},SHEETS:{method:"sheets",parameters:[{argumentType:c.ArgumentTypes.NOERROR}],doesNotNeedArgumentsToBeComputed:!0}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.IsEvenPlugin=void 0,r(109);var o=r(308);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var o=l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(c,e);var t,r,n,o=s(c);function c(){return a(this,c),o.apply(this,arguments)}return t=c,(r=[{key:"iseven",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISEVEN"),(function(e){return e%2==0}))}}])&&i(t.prototype,r),n&&i(t,n),c}(o.FunctionPlugin);t.IsEvenPlugin=f,f.implementedFunctions={ISEVEN:{method:"iseven",parameters:[{argumentType:o.ArgumentTypes.NUMBER}]}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.IsOddPlugin=void 0,r(109);var o=r(308);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var o=l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(c,e);var t,r,n,o=s(c);function c(){return a(this,c),o.apply(this,arguments)}return t=c,(r=[{key:"isodd",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISODD"),(function(e){return e%2==1}))}}])&&i(t.prototype,r),n&&i(t,n),c}(o.FunctionPlugin);t.IsOddPlugin=f,f.implementedFunctions={ISODD:{method:"isodd",parameters:[{argumentType:o.ArgumentTypes.NUMBER}]}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.LogarithmPlugin=void 0,r(292),r(109);var o=r(308);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var o=l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(c,e);var t,r,n,o=s(c);function c(){return a(this,c),o.apply(this,arguments)}return t=c,(r=[{key:"log10",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LOG10"),Math.log10)}},{key:"log",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LOG"),(function(e,t){return Math.log(e)/Math.log(t)}))}},{key:"ln",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LN"),Math.log)}}])&&i(t.prototype,r),n&&i(t,n),c}(o.FunctionPlugin);t.LogarithmPlugin=f,f.implementedFunctions={LOG10:{method:"log10",parameters:[{argumentType:o.ArgumentTypes.NUMBER}]},LOG:{method:"log",parameters:[{argumentType:o.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:o.ArgumentTypes.NUMBER,defaultValue:10,greaterThan:0}]},LN:{method:"ln",parameters:[{argumentType:o.ArgumentTypes.NUMBER}]}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(109),r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.MathConstantsPlugin=t.PI=void 0,r(265);var o=r(308);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var o=l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=parseFloat(Math.PI.toFixed(14));t.PI=f;var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(c,e);var t,r,n,o=s(c);function c(){return a(this,c),o.apply(this,arguments)}return t=c,(r=[{key:"pi",value:function(e,t){return this.runFunction(e.args,t,this.metadata("PI"),(function(){return f}))}},{key:"sqrtpi",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SQRTPI"),(function(e){return Math.sqrt(f*e)}))}}])&&i(t.prototype,r),n&&i(t,n),c}(o.FunctionPlugin);t.MathConstantsPlugin=p,p.implementedFunctions={PI:{method:"pi",parameters:[]},SQRTPI:{method:"sqrtpi",parameters:[{argumentType:o.ArgumentTypes.NUMBER,minValue:0}]}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.MatrixPlugin=void 0,r(109);var o=r(115),a=r(215),i=r(235),u=r(222),s=r(308);function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h(e);if(t){var o=h(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(p,e);var t,r,n,s=f(p);function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=s.call(this,e)).createCpuKernel=function(e,t){return function(){for(var r=[],n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];for(var i=0;i<t.height;++i){r.push([]);for(var u=0;u<t.width;++u)r[i][u]=e.apply({thread:{x:u,y:i}},o)}return r}},t.createGpuJsKernel=function(e,r){return t.interpreter.getGpuInstance().createKernel(e).setPrecision("unsigned").setOutput([r.width,r.height])},void 0===t.config.gpujs?t.createKernel=t.createCpuKernel:t.createKernel=t.createGpuJsKernel,t}return t=p,(r=[{key:"mmult",value:function(e,t){var r=this;return this.runMatrixFunction(e.args,t,this.metadata("MMULT"),(function(e,t){if(!e.hasOnlyNumbers()||!t.hasOnlyNumbers())return new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.NumberRange);var n=(0,i.matrixSizeForMultiplication)(e.size,t.size),s=r.createKernel((function(e,t,r){for(var n=0,o=0;o<r;++o)n+=e[this.thread.y][o]*t[o][this.thread.x];return n}),n)(e.rawNumbers(),t.rawNumbers(),e.width());return u.SimpleRangeValue.onlyNumbersDataWithoutRange(s,n)}))}},{key:"maxpool",value:function(e,t){var r=this;return this.runMatrixFunction(e.args,t,this.metadata("MAXPOOL"),(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;if(!e.hasOnlyNumbers())return new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.NumberRange);var s=(0,i.matrixSizeForPoolFunction)(e.size,t,n),c=r.createKernel((function(e,t,r){for(var n=this.thread.x*r,o=this.thread.y*r,a=e[o][n],i=0;i<t;i++)for(var u=0;u<t;u++)a=Math.max(a,e[o+i][n+u]);return a}),s)(e.rawNumbers(),t,n);return u.SimpleRangeValue.onlyNumbersDataWithoutRange(c,s)}))}},{key:"medianpool",value:function(e,t){var r=this;return this.runMatrixFunction(e.args,t,this.metadata("MEDIANPOOL"),(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;if(!e.hasOnlyNumbers())return new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.NumberRange);var s=(0,i.matrixSizeForPoolFunction)(e.size,t,n),c=r.createKernel((function(e,t,r){for(var n=this.thread.x*r,o=this.thread.y*r,a=e[o][n],i=0;i<t;i++)for(var u=0;u<t;u++)a=Math.max(a,e[o+i][n+u]);for(var s=e[o][n],c=0;c<t;c++)for(var l=0;l<t;l++)s=Math.min(s,e[o+c][n+l]);for(var f=t*t,p=s,h=a,d=42,m=0;m<32;m++){for(var y=(p+h)/2,g=0,v=0;v<t;v++)for(var E=0;E<t;E++)e[o+v][n+E]>y&&g++;if(t%2==0){if(g===f/2){d=y;break}g>f/2?p=y:h=y}else{if(g===(f-1)/2){d=y;break}g>(f-1)/2?p=y:h=y}}return d}),s)(e.rawNumbers(),t,n);return u.SimpleRangeValue.onlyNumbersDataWithoutRange(c,s)}))}},{key:"transpose",value:function(e,t){return this.runMatrixFunction(e.args,t,this.metadata("TRANSPOSE"),(function(e){if(!e.hasOnlyNumbers())return new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.NumberRange);for(var t=e.rawNumbers(),r=e.size,n=[],s=0;s<r.width;++s){n[s]=[];for(var c=0;c<r.height;++c)n[s][c]=t[c][s]}return u.SimpleRangeValue.onlyNumbersDataWithoutRange(n,(0,i.matrixSizeForTranspose)(r))}))}}])&&c(t.prototype,r),n&&c(t,n),p}(s.FunctionPlugin);t.MatrixPlugin=d,d.implementedFunctions={MMULT:{method:"mmult",parameters:[{argumentType:s.ArgumentTypes.RANGE},{argumentType:s.ArgumentTypes.RANGE}]},TRANSPOSE:{method:"transpose",parameters:[{argumentType:s.ArgumentTypes.RANGE}]},MAXPOOL:{method:"maxpool",parameters:[{argumentType:s.ArgumentTypes.RANGE},{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.NUMBER,optionalArg:!0}]},MEDIANPOOL:{method:"medianpool",parameters:[{argumentType:s.ArgumentTypes.RANGE},{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.NUMBER,optionalArg:!0}]}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.MedianPlugin=void 0,r(242),r(325),r(109);var o=r(115),a=r(215),i=r(308);function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var o=p(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(f,e);var t,r,n,i=l(f);function f(){return u(this,f),i.apply(this,arguments)}return t=f,(r=[{key:"median",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("MEDIAN"),(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=r.interpreter.arithmeticHelper.coerceNumbersExactRanges(t);return i instanceof o.CellError?i:0===i.length?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.OneValue):(i.sort((function(e,t){return e-t})),i.length%2==0?(i[i.length/2-1]+i[i.length/2])/2:i[Math.floor(i.length/2)])}))}},{key:"large",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("LARGE"),(function(e,t){var n=r.interpreter.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());return n instanceof o.CellError?n:(n.sort((function(e,t){return e-t})),(t=Math.trunc(t))>n.length?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.ValueLarge):n[n.length-t])}))}},{key:"small",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("SMALL"),(function(e,t){var n=r.interpreter.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());return n instanceof o.CellError?n:(n.sort((function(e,t){return e-t})),(t=Math.trunc(t))>n.length?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.ValueLarge):n[t-1])}))}}])&&s(t.prototype,r),n&&s(t,n),f}(i.FunctionPlugin);t.MedianPlugin=h,h.implementedFunctions={MEDIAN:{method:"median",parameters:[{argumentType:i.ArgumentTypes.ANY}],repeatLastArgs:1},LARGE:{method:"large",parameters:[{argumentType:i.ArgumentTypes.RANGE},{argumentType:i.ArgumentTypes.NUMBER,minValue:1}]},SMALL:{method:"small",parameters:[{argumentType:i.ArgumentTypes.RANGE},{argumentType:i.ArgumentTypes.NUMBER,minValue:1}]}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.ModuloPlugin=void 0,r(109);var o=r(115),a=r(308);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return l(this,r)}}function l(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(l,e);var t,r,n,a=c(l);function l(){return i(this,l),a.apply(this,arguments)}return t=l,(r=[{key:"mod",value:function(e,t){return this.runFunction(e.args,t,this.metadata("MOD"),(function(e,t){return 0===t?new o.CellError(o.ErrorType.DIV_BY_ZERO):e%t}))}}])&&u(t.prototype,r),n&&u(t,n),l}(a.FunctionPlugin);t.ModuloPlugin=p,p.implementedFunctions={MOD:{method:"mod",parameters:[{argumentType:a.ArgumentTypes.NUMBER},{argumentType:a.ArgumentTypes.NUMBER}]}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(109),r(1),r(63),r(67),r(87),r(93),r(94),r(95),r(97),t.__esModule=!0,t.NumericAggregationPlugin=void 0,r(136),r(138),r(149),r(53),r(221),r(121),r(68),r(77);var o,a=(o=r(129))&&o.__esModule?o:{default:o},i=r(135),u=r(115),s=r(215),c=r(141),l=r(271),f=r(223),p=r(222),h=r(308);function d(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=E(e);if(t){var o=E(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return v(this,r)}}function v(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function T(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function R(e,t,r){return t&&b(e.prototype,t),r&&b(e,r),e}function A(e){return(0,f.isExtendedNumber)(e)&&!Number.isFinite((0,f.getRawValue)(e))?0:e}var S=function(){function e(t,r,n){T(this,e),this.sumsq=t,this.sum=r,this.count=n}return R(e,[{key:"compose",value:function(t){return new e(this.sumsq+t.sumsq,this.sum+t.sum,this.count+t.count)}},{key:"averageValue",value:function(){return this.count>0?this.sum/this.count:void 0}},{key:"varSValue",value:function(){return this.count>1?(this.sumsq-this.sum*this.sum/this.count)/(this.count-1):void 0}},{key:"varPValue",value:function(){return this.count>0?(this.sumsq-this.sum*this.sum/this.count)/this.count:void 0}}],[{key:"single",value:function(t){return new e(t*t,t,1)}}]),e}();S.empty=new S(0,0,0);var N=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(r,e);var t=g(r);function r(){var e;return T(this,r),(e=t.apply(this,arguments)).addWithEpsilonRaw=function(t,r){return e.interpreter.arithmeticHelper.addWithEpsilonRaw(t,r)},e}return R(r,[{key:"sum",value:function(e,t){return this.doSum(e.args,t)}},{key:"sumsq",value:function(e,t){return this.reduce(e.args,t,0,"SUMSQ",this.addWithEpsilonRaw,(function(e){return Math.pow((0,f.getRawValue)(e),2)}),O)}},{key:"max",value:function(e,t){return this.doMax(e.args,t)}},{key:"maxa",value:function(e,t){return A(this.reduce(e.args,t,Number.NEGATIVE_INFINITY,"MAXA",(function(e,t){return Math.max(e,t)}),f.getRawValue,C))}},{key:"min",value:function(e,t){return this.doMin(e.args,t)}},{key:"mina",value:function(e,t){return A(this.reduce(e.args,t,Number.POSITIVE_INFINITY,"MINA",(function(e,t){return Math.min(e,t)}),f.getRawValue,C))}},{key:"count",value:function(e,t){return this.doCount(e.args,t)}},{key:"counta",value:function(e,t){return this.doCounta(e.args,t)}},{key:"average",value:function(e,t){return this.doAverage(e.args,t)}},{key:"averagea",value:function(e,t){var r,n=this.reduce(e.args,t,S.empty,"_AGGREGATE_A",(function(e,t){return e.compose(t)}),(function(e){return S.single((0,f.getRawValue)(e))}),C);return n instanceof u.CellError?n:null!==(r=n.averageValue())&&void 0!==r?r:new u.CellError(u.ErrorType.DIV_BY_ZERO)}},{key:"vars",value:function(e,t){return this.doVarS(e.args,t)}},{key:"varp",value:function(e,t){return this.doVarP(e.args,t)}},{key:"vara",value:function(e,t){var r,n=this.reduceAggregateA(e.args,t);return n instanceof u.CellError?n:null!==(r=n.varSValue())&&void 0!==r?r:new u.CellError(u.ErrorType.DIV_BY_ZERO)}},{key:"varpa",value:function(e,t){var r,n=this.reduceAggregateA(e.args,t);return n instanceof u.CellError?n:null!==(r=n.varPValue())&&void 0!==r?r:new u.CellError(u.ErrorType.DIV_BY_ZERO)}},{key:"stdevs",value:function(e,t){return this.doStdevS(e.args,t)}},{key:"stdevp",value:function(e,t){return this.doStdevP(e.args,t)}},{key:"stdeva",value:function(e,t){var r=this.reduceAggregateA(e.args,t);if(r instanceof u.CellError)return r;var n=r.varSValue();return void 0===n?new u.CellError(u.ErrorType.DIV_BY_ZERO):Math.sqrt(n)}},{key:"stdevpa",value:function(e,t){var r=this.reduceAggregateA(e.args,t);if(r instanceof u.CellError)return r;var n=r.varPValue();return void 0===n?new u.CellError(u.ErrorType.DIV_BY_ZERO):Math.sqrt(n)}},{key:"product",value:function(e,t){return this.doProduct(e.args,t)}},{key:"subtotal",value:function(e,t){if(e.args.length<1)return new u.CellError(u.ErrorType.NA,s.ErrorMessage.WrongArgNumber);var r=this.coerceToType(this.evaluateAst(e.args[0],t),{argumentType:h.ArgumentTypes.NUMBER}),n=e.args.slice(1);switch(r){case 1:case 101:return this.doAverage(n,t);case 2:case 102:return this.doCount(n,t);case 3:case 103:return this.doCounta(n,t);case 4:case 104:return this.doMax(n,t);case 5:case 105:return this.doMin(n,t);case 6:case 106:return this.doProduct(n,t);case 7:case 107:return this.doStdevS(n,t);case 8:case 108:return this.doStdevP(n,t);case 9:case 109:return this.doSum(n,t);case 10:case 110:return this.doVarS(n,t);case 11:case 111:return this.doVarP(n,t);default:return new u.CellError(u.ErrorType.VALUE,s.ErrorMessage.BadMode)}}},{key:"reduceAggregate",value:function(e,t){return this.reduce(e,t,S.empty,"_AGGREGATE",(function(e,t){return e.compose(t)}),(function(e){return S.single((0,f.getRawValue)(e))}),O)}},{key:"reduceAggregateA",value:function(e,t){return this.reduce(e,t,S.empty,"_AGGREGATE_A",(function(e,t){return e.compose(t)}),(function(e){return S.single((0,f.getRawValue)(e))}),C)}},{key:"doAverage",value:function(e,t){var r,n=this.reduceAggregate(e,t);return n instanceof u.CellError?n:null!==(r=n.averageValue())&&void 0!==r?r:new u.CellError(u.ErrorType.DIV_BY_ZERO)}},{key:"doVarS",value:function(e,t){var r,n=this.reduceAggregate(e,t);return n instanceof u.CellError?n:null!==(r=n.varSValue())&&void 0!==r?r:new u.CellError(u.ErrorType.DIV_BY_ZERO)}},{key:"doVarP",value:function(e,t){var r,n=this.reduceAggregate(e,t);return n instanceof u.CellError?n:null!==(r=n.varPValue())&&void 0!==r?r:new u.CellError(u.ErrorType.DIV_BY_ZERO)}},{key:"doStdevS",value:function(e,t){var r=this.reduceAggregate(e,t);if(r instanceof u.CellError)return r;var n=r.varSValue();return void 0===n?new u.CellError(u.ErrorType.DIV_BY_ZERO):Math.sqrt(n)}},{key:"doStdevP",value:function(e,t){var r=this.reduceAggregate(e,t);if(r instanceof u.CellError)return r;var n=r.varPValue();return void 0===n?new u.CellError(u.ErrorType.DIV_BY_ZERO):Math.sqrt(n)}},{key:"doCount",value:function(e,t){return this.reduce(e,t,0,"COUNT",(function(e,t){return e+t}),f.getRawValue,(function(e){return(0,f.isExtendedNumber)(e)?1:0}))}},{key:"doCounta",value:function(e,t){return this.reduce(e,t,0,"COUNTA",(function(e,t){return e+t}),f.getRawValue,(function(e){return e===f.EmptyValue?0:1}))}},{key:"doMax",value:function(e,t){return A(this.reduce(e,t,Number.NEGATIVE_INFINITY,"MAX",(function(e,t){return Math.max(e,t)}),f.getRawValue,O))}},{key:"doMin",value:function(e,t){return A(this.reduce(e,t,Number.POSITIVE_INFINITY,"MAX",(function(e,t){return Math.min(e,t)}),f.getRawValue,O))}},{key:"doSum",value:function(e,t){return this.reduce(e,t,0,"SUM",this.addWithEpsilonRaw,f.getRawValue,O)}},{key:"doProduct",value:function(e,t){return this.reduce(e,t,1,"PRODUCT",(function(e,t){return e*t}),f.getRawValue,O)}},{key:"reduce",value:function(e,t,r,n,o,a,i){var l=this;return e.length<1?new u.CellError(u.ErrorType.NA,s.ErrorMessage.WrongArgNumber):e.reduce((function(e,r){if(e instanceof u.CellError)return e;if(r.type===c.AstNodeType.CELL_RANGE||r.type===c.AstNodeType.COLUMN_RANGE||r.type===c.AstNodeType.ROW_RANGE)return l.evaluateRange(r,t,e,n,o,a,i);var s;if((s=l.evaluateAst(r,t))instanceof p.SimpleRangeValue)return Array.from(s.valuesFromTopLeftCorner()).map(i).filter((function(e){return void 0!==e})).map((function(e){return e instanceof u.CellError?e:a(e)})).reduce((function(e,t){return e instanceof u.CellError?e:t instanceof u.CellError?t:o(e,t)}),e);if(r.type===c.AstNodeType.CELL_REFERENCE){if(void 0===(s=i(s)))return e}else if(s=l.coerceScalarToNumberOrError(s),void 0===(s=i(s)))return e;return s instanceof u.CellError?s:o(e,a(s))}),r)}},{key:"evaluateRange",value:function(e,t,r,n,o,c,l){var f;try{f=i.AbsoluteCellRange.fromAst(e,t)}catch(e){if(e.message===i.DIFFERENT_SHEETS_ERROR)return new u.CellError(u.ErrorType.REF,s.ErrorMessage.RangeManySheets);throw e}var p=f.start,h=f.end,d=this.dependencyGraph.getRange(p,h);a.default.ok(d,"Range does not exists in graph");var m=d.getFunctionValue(n);return m||(m=this.getRangeValues(n,f,c,l).reduce((function(e,t){return e instanceof u.CellError?e:t instanceof u.CellError?t:o(e,t)}),r),d.setFunctionValue(n,m)),m}},{key:"getRangeValues",value:function(e,t,r,n){var o,a=[],i=this.dependencyGraph.rangeMapping.findSmallerRange(t),s=i.smallerRangeVertex,c=i.restRange,l=this.dependencyGraph.getRange(t.start,t.end);if(s&&this.dependencyGraph.existsEdge(s,l)){var f=s.getFunctionValue(e);if(f)a.push(f);else{var p,h=d(s.range.addresses(this.dependencyGraph));try{for(h.s();!(p=h.n()).done;){var m=p.value,y=n(this.dependencyGraph.getScalarValue(m));y instanceof u.CellError?a.push(y):void 0!==y&&a.push(r(y))}}catch(e){h.e(e)}finally{h.f()}}o=c}else o=t;var g,v=d(o.addresses(this.dependencyGraph));try{for(v.s();!(g=v.n()).done;){var E=g.value,T=n(this.dependencyGraph.getScalarValue(E));T instanceof u.CellError?a.push(T):void 0!==T&&a.push(r(T))}}catch(e){v.e(e)}finally{v.f()}return a}}]),r}(h.FunctionPlugin);function O(e){return(0,f.isExtendedNumber)(e)||e instanceof u.CellError?e:void 0}function C(e){return"boolean"==typeof e?(0,l.coerceBooleanToNumber)(e):(0,f.isExtendedNumber)(e)||e instanceof u.CellError?e:"string"==typeof e?0:void 0}t.NumericAggregationPlugin=N,N.implementedFunctions={SUM:{method:"sum"},SUMSQ:{method:"sumsq"},MAX:{method:"max"},MIN:{method:"min"},MAXA:{method:"maxa"},MINA:{method:"mina"},COUNT:{method:"count"},COUNTA:{method:"counta"},AVERAGE:{method:"average"},AVERAGEA:{method:"averagea"},PRODUCT:{method:"product"},"VAR.S":{method:"vars"},"VAR.P":{method:"varp"},VARA:{method:"vara"},VARPA:{method:"varpa"},"STDEV.S":{method:"stdevs"},"STDEV.P":{method:"stdevp"},STDEVA:{method:"stdeva"},STDEVPA:{method:"stdevpa"},SUBTOTAL:{method:"subtotal"}},N.aliases={VAR:"VAR.S",VARP:"VAR.P",STDEV:"STDEV.S",STDEVP:"STDEV.P",VARS:"VAR.S",STDEVS:"STDEV.S"}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.PowerPlugin=void 0,r(109);var o=r(308);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var o=l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(c,e);var t,r,n,o=s(c);function c(){return a(this,c),o.apply(this,arguments)}return t=c,(r=[{key:"power",value:function(e,t){return this.runFunction(e.args,t,this.metadata("POWER"),Math.pow)}}])&&i(t.prototype,r),n&&i(t,n),c}(o.FunctionPlugin);t.PowerPlugin=f,f.implementedFunctions={POWER:{method:"power",parameters:[{argumentType:o.ArgumentTypes.NUMBER},{argumentType:o.ArgumentTypes.NUMBER}]}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.RadiansPlugin=void 0,r(109);var o=r(308);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var o=l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(c,e);var t,r,n,o=s(c);function c(){return a(this,c),o.apply(this,arguments)}return t=c,(r=[{key:"radians",value:function(e,t){return this.runFunction(e.args,t,this.metadata("RADIANS"),(function(e){return e*(Math.PI/180)}))}}])&&i(t.prototype,r),n&&i(t,n),c}(o.FunctionPlugin);t.RadiansPlugin=f,f.implementedFunctions={RADIANS:{method:"radians",parameters:[{argumentType:o.ArgumentTypes.NUMBER}]}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(94),r(95),r(77),r(97),t.__esModule=!0,t.RadixConversionPlugin=void 0,r(143),r(146),r(148),r(63),r(109);var o=r(115),a=r(215),i=r(264),u=r(308);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h(e);if(t){var o=h(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(u,e);var t,r,n,i=f(u);function u(){return s(this,u),i.apply(this,arguments)}return t=u,(r=[{key:"dec2bin",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DEC2BIN"),(function(e,t){return y(e,2,t)}))}},{key:"dec2oct",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DEC2OCT"),(function(e,t){return y(e,8,t)}))}},{key:"dec2hex",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DEC2HEX"),(function(e,t){return y(e,16,t)}))}},{key:"bin2dec",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BIN2DEC"),(function(e){var t=m(e,2,10);return void 0===t?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.NotBinary):T(t,2)}))}},{key:"bin2oct",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BIN2OCT"),(function(e,t){var r=m(e,2,10);return void 0===r?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.NotBinary):y(T(r,2),8,t)}))}},{key:"bin2hex",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BIN2HEX"),(function(e,t){var r=m(e,2,10);return void 0===r?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.NotBinary):y(T(r,2),16,t)}))}},{key:"oct2dec",value:function(e,t){return this.runFunction(e.args,t,this.metadata("OCT2DEC"),(function(e){var t=m(e,8,10);return void 0===t?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.NotOctal):T(t,8)}))}},{key:"oct2bin",value:function(e,t){return this.runFunction(e.args,t,this.metadata("OCT2BIN"),(function(e,t){var r=m(e,8,10);return void 0===r?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.NotOctal):y(T(r,8),2,t)}))}},{key:"oct2hex",value:function(e,t){return this.runFunction(e.args,t,this.metadata("OCT2HEX"),(function(e,t){var r=m(e,8,10);return void 0===r?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.NotOctal):y(T(r,8),16,t)}))}},{key:"hex2dec",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HEX2DEC"),(function(e){var t=m(e,16,10);return void 0===t?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.NotHex):T(t,16)}))}},{key:"hex2bin",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HEX2BIN"),(function(e,t){var r=m(e,16,10);return void 0===r?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.NotHex):y(T(r,16),2,t)}))}},{key:"hex2oct",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HEX2OCT"),(function(e,t){var r=m(e,16,10);return void 0===r?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.NotHex):y(T(r,16),8,t)}))}},{key:"base",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BASE"),v)}},{key:"decimal",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DECIMAL"),(function(e,t){var r=m(e,t,255);return void 0===r?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.NotHex):parseInt(r,t)}))}}])&&c(t.prototype,r),n&&c(t,n),u}(u.FunctionPlugin);function m(e,t,r){var n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".substr(0,t),o=new RegExp("^[".concat(n,"]+$"));if(!(e.length>r)&&o.test(e))return e}function y(e,t,r){if(e>function(e){return-g(e)-1}(t))return new o.CellError(o.ErrorType.NUM,a.ErrorMessage.ValueBaseLarge);if(e<g(t))return new o.CellError(o.ErrorType.NUM,a.ErrorMessage.ValueBaseSmall);var n=E(e,t);return void 0===r||e<0?n:n.length>r?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.ValueBaseLong):(0,i.padLeft)(n,r)}function g(e){return-Math.pow(e,10)/2}function v(e,t,r){var n=E(e,t);return void 0!==r&&r>n.length?(0,i.padLeft)(n,r):n}function E(e,t){return(e+(e<0?Math.pow(t,10):0)).toString(t).toUpperCase()}function T(e,t){var r=parseInt(e,t),n=Math.pow(t,10);return r>=n/2?r-n:r}t.RadixConversionPlugin=d,d.implementedFunctions={DEC2BIN:{method:"dec2bin",parameters:[{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2OCT:{method:"dec2oct",parameters:[{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2HEX:{method:"dec2hex",parameters:[{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},BIN2DEC:{method:"bin2dec",parameters:[{argumentType:u.ArgumentTypes.STRING}]},BIN2OCT:{method:"bin2oct",parameters:[{argumentType:u.ArgumentTypes.STRING},{argumentType:u.ArgumentTypes.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},BIN2HEX:{method:"bin2hex",parameters:[{argumentType:u.ArgumentTypes.STRING},{argumentType:u.ArgumentTypes.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},OCT2DEC:{method:"oct2dec",parameters:[{argumentType:u.ArgumentTypes.STRING}]},OCT2BIN:{method:"oct2bin",parameters:[{argumentType:u.ArgumentTypes.STRING},{argumentType:u.ArgumentTypes.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},OCT2HEX:{method:"oct2hex",parameters:[{argumentType:u.ArgumentTypes.STRING},{argumentType:u.ArgumentTypes.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},HEX2DEC:{method:"hex2dec",parameters:[{argumentType:u.ArgumentTypes.STRING}]},HEX2BIN:{method:"hex2bin",parameters:[{argumentType:u.ArgumentTypes.STRING},{argumentType:u.ArgumentTypes.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},HEX2OCT:{method:"hex2oct",parameters:[{argumentType:u.ArgumentTypes.STRING},{argumentType:u.ArgumentTypes.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},DECIMAL:{method:"decimal",parameters:[{argumentType:u.ArgumentTypes.STRING},{argumentType:u.ArgumentTypes.NUMBER,minValue:2,maxValue:36}]},BASE:{method:"base",parameters:[{argumentType:u.ArgumentTypes.NUMBER,minValue:0},{argumentType:u.ArgumentTypes.NUMBER,minValue:2,maxValue:36},{argumentType:u.ArgumentTypes.NUMBER,optionalArg:!0,minValue:0,maxValue:255}]}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.RandomPlugin=void 0,r(109);var o=r(115),a=r(215),i=r(308);function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var o=p(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(f,e);var t,r,n,i=l(f);function f(){return u(this,f),i.apply(this,arguments)}return t=f,(r=[{key:"rand",value:function(e,t){return this.runFunction(e.args,t,this.metadata("RAND"),Math.random)}},{key:"randbetween",value:function(e,t){return this.runFunction(e.args,t,this.metadata("RANDBETWEEN"),(function(e,t){return t<e?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.WrongOrder):((e=Math.ceil(e))===(t=Math.floor(t)+1)&&(t+=1),e+Math.floor(Math.random()*(t-e)))}))}}])&&s(t.prototype,r),n&&s(t,n),f}(i.FunctionPlugin);t.RandomPlugin=h,h.implementedFunctions={RAND:{method:"rand",parameters:[],isVolatile:!0},RANDBETWEEN:{method:"randbetween",parameters:[{argumentType:i.ArgumentTypes.NUMBER},{argumentType:i.ArgumentTypes.NUMBER}],isVolatile:!0}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.findNextOddNumber=h,t.findNextEvenNumber=d,t.RoundingPlugin=void 0,r(109);var o=r(115),a=r(215),i=r(308);function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var o=p(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e){var t=Math.ceil(e);return t%2==1?t:t+1}function d(e){var t=Math.ceil(e);return t%2==0?t:t+1}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(f,e);var t,r,n,i=l(f);function f(){return u(this,f),i.apply(this,arguments)}return t=f,(r=[{key:"roundup",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(function(e,t){var r=Math.pow(10,t);return e<0?-Math.ceil(-e*r)/r:Math.ceil(e*r)/r}))}},{key:"rounddown",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(function(e,t){var r=Math.pow(10,t);return e<0?-Math.floor(-e*r)/r:Math.floor(e*r)/r}))}},{key:"round",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ROUND"),(function(e,t){var r=Math.pow(10,t);return e<0?-Math.round(-e*r)/r:Math.round(e*r)/r}))}},{key:"trunc",value:function(e,t){return this.rounddown(e,t)}},{key:"intFunc",value:function(e,t){return this.runFunction(e.args,t,this.metadata("INT"),(function(e){return e<0?-Math.floor(-e):Math.floor(e)}))}},{key:"even",value:function(e,t){return this.runFunction(e.args,t,this.metadata("EVEN"),(function(e){return e<0?-d(-e):d(e)}))}},{key:"odd",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ODD"),(function(e){return e<0?-h(-e):h(e)}))}},{key:"ceilingmath",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.MATH"),(function(e,t,r){return 0===t||0===e?0:(t=Math.abs(t),1===r&&e<0&&(t=-t),Math.ceil(e/t)*t)}))}},{key:"ceiling",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CEILING"),(function(e,t){return 0===e?0:0===t?new o.CellError(o.ErrorType.DIV_BY_ZERO):e>0&&t<0?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.DistinctSigns):Math.ceil(e/t)*t}))}},{key:"ceilingprecise",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.PRECISE"),(function(e,t){return 0===t||0===e?0:(t=Math.abs(t),Math.ceil(e/t)*t)}))}},{key:"floormath",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.MATH"),(function(e,t,r){return 0===t||0===e?0:(t=Math.abs(t),1===r&&e<0&&(t*=-1),Math.floor(e/t)*t)}))}},{key:"floor",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR"),(function(e,t){return 0===e?0:0===t?new o.CellError(o.ErrorType.DIV_BY_ZERO):e>0&&t<0?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.DistinctSigns):Math.floor(e/t)*t}))}},{key:"floorprecise",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.PRECISE"),(function(e,t){return 0===t||0===e?0:(t=Math.abs(t),Math.floor(e/t)*t)}))}}])&&s(t.prototype,r),n&&s(t,n),f}(i.FunctionPlugin);t.RoundingPlugin=m,m.implementedFunctions={ROUNDUP:{method:"roundup",parameters:[{argumentType:i.ArgumentTypes.NUMBER},{argumentType:i.ArgumentTypes.NUMBER,defaultValue:0}]},ROUNDDOWN:{method:"rounddown",parameters:[{argumentType:i.ArgumentTypes.NUMBER},{argumentType:i.ArgumentTypes.NUMBER,defaultValue:0}]},ROUND:{method:"round",parameters:[{argumentType:i.ArgumentTypes.NUMBER},{argumentType:i.ArgumentTypes.NUMBER,defaultValue:0}]},TRUNC:{method:"trunc",parameters:[{argumentType:i.ArgumentTypes.NUMBER},{argumentType:i.ArgumentTypes.NUMBER,defaultValue:0}]},INT:{method:"intFunc",parameters:[{argumentType:i.ArgumentTypes.NUMBER}]},EVEN:{method:"even",parameters:[{argumentType:i.ArgumentTypes.NUMBER}]},ODD:{method:"odd",parameters:[{argumentType:i.ArgumentTypes.NUMBER}]},"CEILING.MATH":{method:"ceilingmath",parameters:[{argumentType:i.ArgumentTypes.NUMBER},{argumentType:i.ArgumentTypes.NUMBER,defaultValue:1},{argumentType:i.ArgumentTypes.NUMBER,defaultValue:0}]},CEILING:{method:"ceiling",parameters:[{argumentType:i.ArgumentTypes.NUMBER},{argumentType:i.ArgumentTypes.NUMBER}]},"CEILING.PRECISE":{method:"ceilingprecise",parameters:[{argumentType:i.ArgumentTypes.NUMBER},{argumentType:i.ArgumentTypes.NUMBER,defaultValue:1}]},"FLOOR.MATH":{method:"floormath",parameters:[{argumentType:i.ArgumentTypes.NUMBER},{argumentType:i.ArgumentTypes.NUMBER,defaultValue:1},{argumentType:i.ArgumentTypes.NUMBER,defaultValue:0}]},FLOOR:{method:"floor",parameters:[{argumentType:i.ArgumentTypes.NUMBER},{argumentType:i.ArgumentTypes.NUMBER}]},"FLOOR.PRECISE":{method:"floorprecise",parameters:[{argumentType:i.ArgumentTypes.NUMBER},{argumentType:i.ArgumentTypes.NUMBER,defaultValue:1}]}},m.aliases={"ISO.CEILING":"CEILING.PRECISE"}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.SqrtPlugin=void 0,r(109);var o=r(308);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var o=l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(c,e);var t,r,n,o=s(c);function c(){return a(this,c),o.apply(this,arguments)}return t=c,(r=[{key:"sqrt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SQRT"),Math.sqrt)}}])&&i(t.prototype,r),n&&i(t,n),c}(o.FunctionPlugin);t.SqrtPlugin=f,f.implementedFunctions={SQRT:{method:"sqrt",parameters:[{argumentType:o.ArgumentTypes.NUMBER}]}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(87),r(93),r(63),r(94),r(95),r(77),r(97),r(68),r(53),r(67),r(109),r(1),t.__esModule=!0,t.SumifPlugin=void 0,r(121),r(125),r(206);var o=r(115),a=r(215),i=r(352),u=r(223),s=r(308);function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var o=p(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function g(e,t,r){return t&&y(e.prototype,t),r&&y(e,r),e}var v=function(){function e(t,r){m(this,e),this.sum=t,this.count=r}return g(e,[{key:"compose",value:function(t){return new e(this.sum+t.sum,this.count+t.count)}},{key:"averageValue",value:function(){return this.count>0?this.sum/this.count:void 0}}],[{key:"single",value:function(t){return new e(t,1)}}]),e}();function E(e){var t=e.map((function(e){return"".concat(e.conditionRange.range().sheet,",").concat(e.conditionRange.range().start.col,",").concat(e.conditionRange.range().start.row)}));return["SUMIF"].concat(h(t)).join(",")}function T(e){var t=e.map((function(e){return"".concat(e.conditionRange.range().sheet,",").concat(e.conditionRange.range().start.col,",").concat(e.conditionRange.range().start.row)}));return["AVERAGEIF"].concat(h(t)).join(",")}function b(e){var t=e.map((function(e){return"".concat(e.conditionRange.range().sheet,",").concat(e.conditionRange.range().start.col,",").concat(e.conditionRange.range().start.row)}));return["COUNTIFS"].concat(h(t)).join(",")}v.empty=new v(0,0);var R=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(r,e);var t=l(r);function r(){return m(this,r),t.apply(this,arguments)}return g(r,[{key:"sumif",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("SUMIF"),(function(e,t,n){var s=r.interpreter.criterionBuilder.fromCellValue(t,r.interpreter.arithmeticHelper);return void 0===s?new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.BadCriterion):(n=null!=n?n:e,new i.CriterionFunctionCompute(r.interpreter,E,0,(function(e,t){return r.interpreter.arithmeticHelper.nonstrictadd(e,t)}),(function(e){return(0,u.getRawValue)(e)})).compute(n,[new i.Condition(e,s)]))}))}},{key:"sumifs",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("SUMIFS"),(function(e){for(var t=[],n=0;n<(arguments.length<=1?0:arguments.length-1);n+=2){var s=n+1<1||arguments.length<=n+1?void 0:arguments[n+1],c=r.interpreter.criterionBuilder.fromCellValue(n+1+1<1||arguments.length<=n+1+1?void 0:arguments[n+1+1],r.interpreter.arithmeticHelper);if(void 0===c)return new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.BadCriterion);t.push(new i.Condition(s,c))}return new i.CriterionFunctionCompute(r.interpreter,E,0,(function(e,t){return r.interpreter.arithmeticHelper.nonstrictadd(e,t)}),(function(e){return(0,u.getRawValue)(e)})).compute(e,t)}))}},{key:"averageif",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("AVERAGEIF"),(function(e,t,n){var s=r.interpreter.criterionBuilder.fromCellValue(t,r.interpreter.arithmeticHelper);if(void 0===s)return new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.BadCriterion);n=null!=n?n:e;var c=new i.CriterionFunctionCompute(r.interpreter,T,v.empty,(function(e,t){return e.compose(t)}),(function(e){return(0,u.isExtendedNumber)(e)?v.single((0,u.getRawValue)(e)):v.empty})).compute(n,[new i.Condition(e,s)]);return c instanceof o.CellError?c:c.averageValue()||new o.CellError(o.ErrorType.DIV_BY_ZERO)}))}},{key:"countif",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("COUNTIF"),(function(e,t){var n=r.interpreter.criterionBuilder.fromCellValue(t,r.interpreter.arithmeticHelper);return void 0===n?new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.BadCriterion):new i.CriterionFunctionCompute(r.interpreter,(function(){return"COUNTIF"}),0,(function(e,t){return e+t}),(function(){return 1})).compute(e,[new i.Condition(e,n)])}))}},{key:"countifs",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("COUNTIFS"),(function(){for(var e=[],t=0;t<arguments.length;t+=2){var n=t<0||arguments.length<=t?void 0:arguments[t],u=r.interpreter.criterionBuilder.fromCellValue(t+1<0||arguments.length<=t+1?void 0:arguments[t+1],r.interpreter.arithmeticHelper);if(void 0===u)return new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.BadCriterion);e.push(new i.Condition(n,u))}return new i.CriterionFunctionCompute(r.interpreter,b,0,(function(e,t){return e+t}),(function(){return 1})).compute(e[0].conditionRange,e)}))}}]),r}(s.FunctionPlugin);t.SumifPlugin=R,R.implementedFunctions={SUMIF:{method:"sumif",parameters:[{argumentType:s.ArgumentTypes.RANGE},{argumentType:s.ArgumentTypes.NOERROR},{argumentType:s.ArgumentTypes.RANGE,optionalArg:!0}]},COUNTIF:{method:"countif",parameters:[{argumentType:s.ArgumentTypes.RANGE},{argumentType:s.ArgumentTypes.NOERROR}]},AVERAGEIF:{method:"averageif",parameters:[{argumentType:s.ArgumentTypes.RANGE},{argumentType:s.ArgumentTypes.NOERROR},{argumentType:s.ArgumentTypes.RANGE,optionalArg:!0}]},SUMIFS:{method:"sumifs",parameters:[{argumentType:s.ArgumentTypes.RANGE},{argumentType:s.ArgumentTypes.RANGE},{argumentType:s.ArgumentTypes.NOERROR}],repeatLastArgs:2},COUNTIFS:{method:"countifs",parameters:[{argumentType:s.ArgumentTypes.RANGE},{argumentType:s.ArgumentTypes.NOERROR}],repeatLastArgs:2}}},function(e,t,r){"use strict";r(146),r(151),r(53),r(67),t.__esModule=!0,t.Condition=t.CriterionFunctionCompute=void 0,r(120),r(121),r(206),r(126),r(68),r(77),r(94),r(95),r(63),r(97),r(87),r(93),r(210);var n=r(115),o=r(215),a=r(353),i=r(223),u=regeneratorRuntime.mark(y),s=regeneratorRuntime.mark(g);function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||f(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=f(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}function f(e,t){if(e){if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var m=function(){function e(t,r,n,o,a){h(this,e),this.interpreter=t,this.cacheKey=r,this.reduceInitialValue=n,this.composeFunction=o,this.mapFunction=a,this.dependencyGraph=this.interpreter.dependencyGraph}var t,r,a;return t=e,(r=[{key:"compute",value:function(e,t){var r,a=this,i=l(t);try{for(i.s();!(r=i.n()).done;)if(!r.value.conditionRange.sameDimensionsAs(e))return new n.CellError(n.ErrorType.VALUE,o.ErrorMessage.EqualLength)}catch(e){i.e(e)}finally{i.f()}var u=this.tryToGetRangeVertexForRangeValue(e),s=t.map((function(e){return a.tryToGetRangeVertexForRangeValue(e.conditionRange)}));if(u&&s.every((function(e){return void 0!==e}))){var c=t.map((function(e){return e.criterionPackage.raw})).join(","),f=this.findAlreadyComputedValueInCache(u,this.cacheKey(t),c);if(f)return this.interpreter.stats.incrementCriterionFunctionFullCacheUsed(),f;var p=this.buildNewCriterionCache(this.cacheKey(t),t.map((function(e){return e.conditionRange.range()})),e.range());return p.has(c)||p.set(c,[this.evaluateRangeValue(e,t),t.map((function(e){return e.criterionPackage.lambda}))]),u.setCriterionFunctionValues(this.cacheKey(t),p),s.forEach((function(e){void 0!==e&&e.addDependentCacheRange(u)})),p.get(c)[0]}return this.evaluateRangeValue(e,t)}},{key:"tryToGetRangeVertexForRangeValue",value:function(e){var t=e.range();return void 0===t?void 0:this.dependencyGraph.getRange(t.start,t.end)}},{key:"reduceFunction",value:function(e){var t,r=this.reduceInitialValue,n=l(e);try{for(n.s();!(t=n.n()).done;){var o=t.value;r=this.composeFunction(r,o)}}catch(e){n.e(e)}finally{n.f()}return r}},{key:"findAlreadyComputedValueInCache",value:function(e,t,r){return e.getCriterionFunctionValue(t,r)}},{key:"evaluateRangeValue",value:function(e,t){var r=t.map((function(e){return e.criterionPackage.lambda})),n=Array.from(e.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator](),o=g(r,t.map((function(e){return e.conditionRange.iterateValuesFromTopLeftCorner()})),n);return this.reduceFunction(o)}},{key:"buildNewCriterionCache",value:function(e,t,r){var o,a=this,i=this.dependencyGraph.getRange(r.start,r.end),u=function(e,t,r){if(r.end.row>r.start.row){var o=(0,n.simpleCellAddress)(r.end.sheet,r.end.col,r.end.row-1),a=e.getRange(r.start,o);if(void 0!==a)return{smallerRangeVertex:a,restValuesRange:r.withStart((0,n.simpleCellAddress)(r.start.sheet,r.start.col,r.end.row)),restConditionRanges:t.map((function(e){return e.withStart((0,n.simpleCellAddress)(e.start.sheet,e.start.col,e.end.row))}))}}return{smallerRangeVertex:null,restValuesRange:r,restConditionRanges:t}}(this.dependencyGraph,t,r),s=u.smallerRangeVertex,l=u.restConditionRanges,f=u.restValuesRange;o=s&&this.dependencyGraph.existsEdge(s,i)?s.getCriterionFunctionValues(e):new Map;var p=new Map;return o.forEach((function(e,t){var r=c(e,2),n=r[0],o=r[1],i=g(o,l.map((function(e){return y(a.dependencyGraph,e)})),Array.from(y(a.dependencyGraph,f)).map(a.mapFunction)[Symbol.iterator]()),u=a.composeFunction(n,a.reduceFunction(i));a.interpreter.stats.incrementCriterionFunctionPartialCacheUsed(),p.set(t,[u,o])})),p}}])&&d(t.prototype,r),a&&d(t,a),e}();function y(e,t){var r,n,o;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:r=l(t.addresses(e)),a.prev=1,r.s();case 3:if((n=r.n()).done){a.next=9;break}return o=n.value,a.next=7,(0,i.getRawValue)(e.getScalarValue(o));case 7:a.next=3;break;case 9:a.next=14;break;case 11:a.prev=11,a.t0=a.catch(1),r.e(a.t0);case 14:return a.prev=14,r.f(),a.finish(14);case 17:case"end":return a.stop()}}),u,null,[[1,11,14,17]])}function g(e,t,r){var n,o,i,u;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:n=l(r),s.prev=1,n.s();case 3:if((o=n.n()).done){s.next=15;break}if(i=o.value,(u=t.map((function(e){return(0,a.split)(e)}))).every((function(e){return Object.prototype.hasOwnProperty.call(e,"value")}))){s.next=8;break}return s.abrupt("return");case 8:if(!v(u.map((function(e){return e.value})),e).every((function(e){var t=c(e,2),r=t[0];return(0,t[1])(r)}))){s.next=12;break}return s.next=12,i;case 12:t=u.map((function(e){return e.rest}));case 13:s.next=3;break;case 15:s.next=20;break;case 17:s.prev=17,s.t0=s.catch(1),n.e(s.t0);case 20:return s.prev=20,n.f(),s.finish(20);case 23:case"end":return s.stop()}}),s,null,[[1,17,20,23]])}function v(e,t){for(var r=[],n=0;n<Math.min(e.length,t.length);n++)r.push([e[n],t[n]]);return r}t.CriterionFunctionCompute=m,t.Condition=function e(t,r){h(this,e),this.conditionRange=t,this.criterionPackage=r}},function(e,t,r){"use strict";r(146),r(151),t.__esModule=!0,t.empty=o,t.split=function(e){var t=e[Symbol.iterator](),r=t.next(),n=r.done,a=r.value;return n?{rest:o()}:{value:a,rest:t}},t.first=function(e){var t=e[Symbol.iterator]().next(),r=t.done,n=t.value;if(!r)return n},r(94),r(95),r(63),r(77),r(97),r(87),r(93),r(120);var n=regeneratorRuntime.mark(o);
/**
 * @license
 * Copyright (c) 2021 Handsoncode. All rights reserved.
 */function o(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),n)}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.SumprodPlugin=void 0,r(109);var o=r(115),a=r(215),i=r(223),u=r(308);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h(e);if(t){var o=h(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(p,e);var t,r,n,u=f(p);function p(){return s(this,p),u.apply(this,arguments)}return t=p,(r=[{key:"sumproduct",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("SUMPRODUCT"),(function(e,t){if(e.numberOfElements()!==t.numberOfElements())return new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.EqualLength);for(var n,u,s=0,c=e.iterateValuesFromTopLeftCorner(),l=t.iterateValuesFromTopLeftCorner();n=c.next(),u=l.next(),!n.done&&!u.done;){if(n.value instanceof o.CellError)return n.value;if(u.value instanceof o.CellError)return u.value;var f=r.coerceScalarToNumberOrError(n.value),p=r.coerceScalarToNumberOrError(u.value);(0,i.isExtendedNumber)(f)&&(0,i.isExtendedNumber)(p)&&(s+=(0,i.getRawValue)(f)*(0,i.getRawValue)(p))}return s}))}}])&&c(t.prototype,r),n&&c(t,n),p}(u.FunctionPlugin);t.SumprodPlugin=d,d.implementedFunctions={SUMPRODUCT:{method:"sumproduct",parameters:[{argumentType:u.ArgumentTypes.RANGE},{argumentType:u.ArgumentTypes.RANGE}]}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.TextPlugin=void 0,r(125),r(146),r(151),r(156),r(356),r(53),r(143),r(148),r(109);var o=r(115),a=r(215),i=r(308);function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var o=p(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(f,e);var t,r,n,i=l(f);function f(){return u(this,f),i.apply(this,arguments)}return t=f,(r=[{key:"concatenate",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CONCATENATE"),(function(){var e;return(e="").concat.apply(e,arguments)}))}},{key:"split",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SPLIT"),(function(e,t){var r=e.split(" ");return t>=r.length||t<0?new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.IndexBounds):r[t]}))}},{key:"len",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LEN"),(function(e){return e.length}))}},{key:"lower",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LOWER"),(function(e){return e.toLowerCase()}))}},{key:"trim",value:function(e,t){return this.runFunction(e.args,t,this.metadata("TRIM"),(function(e){return e.replace(/^ +| +$/g,"").replace(/ +/g," ")}))}},{key:"proper",value:function(e,t){return this.runFunction(e.args,t,this.metadata("PROPER"),(function(e){return e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()}))}))}},{key:"clean",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CLEAN"),(function(e){return e.replace(/[\u0000-\u001F]/g,"")}))}},{key:"exact",value:function(e,t){return this.runFunction(e.args,t,this.metadata("EXACT"),(function(e,t){return e===t}))}},{key:"rept",value:function(e,t){return this.runFunction(e.args,t,this.metadata("REPT"),(function(e,t){return t<0?new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.NegativeCount):e.repeat(t)}))}},{key:"right",value:function(e,t){return this.runFunction(e.args,t,this.metadata("RIGHT"),(function(e,t){return t<0?new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.NegativeLength):0===t?"":e.slice(-t)}))}},{key:"left",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LEFT"),(function(e,t){return t<0?new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.NegativeLength):e.slice(0,t)}))}},{key:"mid",value:function(e,t){return this.runFunction(e.args,t,this.metadata("MID"),(function(e,t,r){return t<1?new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.LessThanOne):r<0?new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.NegativeLength):e.substring(t-1,t+r-1)}))}},{key:"replace",value:function(e,t){return this.runFunction(e.args,t,this.metadata("REPLACE"),(function(e,t,r,n){return t<1?new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.LessThanOne):r<0?new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.NegativeLength):e.substring(0,t-1)+n+e.substring(t+r-1)}))}},{key:"search",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("SEARCH"),(function(e,t,n){if(n<1||n>t.length)return new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.LengthBounds);var i,u=t.substring(n-1).toLowerCase();return i=r.interpreter.arithmeticHelper.requiresRegex(e)?r.interpreter.arithmeticHelper.searchString(e,u):u.indexOf(e.toLowerCase()),(i+=n)>0?i:new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.PatternNotFound)}))}},{key:"substitute",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SUBSTITUTE"),(function(e,t,r,n){var i,u=new RegExp(t,"g");if(void 0===n)return e.replace(u,r);if(n<1)return new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.LessThanOne);for(var s=0;null!==(i=u.exec(e));)if(n===++s)return e.substring(0,i.index)+r+e.substring(u.lastIndex);return e}))}},{key:"find",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FIND"),(function(e,t,r){if(r<1||r>t.length)return new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.IndexBounds);var n=t.substring(r-1).indexOf(e)+r;return n>0?n:new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.PatternNotFound)}))}},{key:"t",value:function(e,t){return this.runFunction(e.args,t,this.metadata("T"),(function(e){return e instanceof o.CellError||"string"==typeof e?e:""}))}},{key:"upper",value:function(e,t){return this.runFunction(e.args,t,this.metadata("UPPER"),(function(e){return e.toUpperCase()}))}}])&&s(t.prototype,r),n&&s(t,n),f}(i.FunctionPlugin);t.TextPlugin=h,h.implementedFunctions={CONCATENATE:{method:"concatenate",parameters:[{argumentType:i.ArgumentTypes.STRING}],repeatLastArgs:1,expandRanges:!0},EXACT:{method:"exact",parameters:[{argumentType:i.ArgumentTypes.STRING},{argumentType:i.ArgumentTypes.STRING}]},SPLIT:{method:"split",parameters:[{argumentType:i.ArgumentTypes.STRING},{argumentType:i.ArgumentTypes.NUMBER}]},LEN:{method:"len",parameters:[{argumentType:i.ArgumentTypes.STRING}]},LOWER:{method:"lower",parameters:[{argumentType:i.ArgumentTypes.STRING}]},MID:{method:"mid",parameters:[{argumentType:i.ArgumentTypes.STRING},{argumentType:i.ArgumentTypes.NUMBER},{argumentType:i.ArgumentTypes.NUMBER}]},TRIM:{method:"trim",parameters:[{argumentType:i.ArgumentTypes.STRING}]},T:{method:"t",parameters:[{argumentType:i.ArgumentTypes.SCALAR}]},PROPER:{method:"proper",parameters:[{argumentType:i.ArgumentTypes.STRING}]},CLEAN:{method:"clean",parameters:[{argumentType:i.ArgumentTypes.STRING}]},REPT:{method:"rept",parameters:[{argumentType:i.ArgumentTypes.STRING},{argumentType:i.ArgumentTypes.NUMBER}]},RIGHT:{method:"right",parameters:[{argumentType:i.ArgumentTypes.STRING},{argumentType:i.ArgumentTypes.NUMBER,defaultValue:1}]},LEFT:{method:"left",parameters:[{argumentType:i.ArgumentTypes.STRING},{argumentType:i.ArgumentTypes.NUMBER,defaultValue:1}]},REPLACE:{method:"replace",parameters:[{argumentType:i.ArgumentTypes.STRING},{argumentType:i.ArgumentTypes.NUMBER},{argumentType:i.ArgumentTypes.NUMBER},{argumentType:i.ArgumentTypes.STRING}]},SEARCH:{method:"search",parameters:[{argumentType:i.ArgumentTypes.STRING},{argumentType:i.ArgumentTypes.STRING},{argumentType:i.ArgumentTypes.NUMBER,defaultValue:1}]},SUBSTITUTE:{method:"substitute",parameters:[{argumentType:i.ArgumentTypes.STRING},{argumentType:i.ArgumentTypes.STRING},{argumentType:i.ArgumentTypes.STRING},{argumentType:i.ArgumentTypes.NUMBER,optionalArg:!0}]},FIND:{method:"find",parameters:[{argumentType:i.ArgumentTypes.STRING},{argumentType:i.ArgumentTypes.STRING},{argumentType:i.ArgumentTypes.NUMBER,defaultValue:1}]},UPPER:{method:"upper",parameters:[{argumentType:i.ArgumentTypes.STRING}]}}},function(e,t,r){r(2)({target:"String",proto:!0},{repeat:r(267)})},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.TrigonometryPlugin=void 0,r(358),r(360),r(361),r(362),r(364),r(365),r(109);var o=r(115),a=r(215),i=r(308),u=r(340);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h(e);if(t){var o=h(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(p,e);var t,r,n,i=f(p);function p(){return s(this,p),i.apply(this,arguments)}return t=p,(r=[{key:"acos",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ACOS"),Math.acos)}},{key:"asin",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ASIN"),Math.asin)}},{key:"cos",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COS"),Math.cos)}},{key:"sin",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SIN"),Math.sin)}},{key:"tan",value:function(e,t){return this.runFunction(e.args,t,this.metadata("TAN"),Math.tan)}},{key:"atan",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ATAN"),Math.atan)}},{key:"atan2",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ATAN2"),(function(e,t){return 0===e&&0===t?new o.CellError(o.ErrorType.DIV_BY_ZERO):Math.atan2(t,e)}))}},{key:"cot",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COT"),(function(e){return 0===e?new o.CellError(o.ErrorType.DIV_BY_ZERO):1/Math.tan(e)}))}},{key:"acot",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ACOT"),(function(e){return 0===e?u.PI/2:Math.atan(1/e)}))}},{key:"sec",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SEC"),(function(e){return 1/Math.cos(e)}))}},{key:"csc",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CSC"),(function(e){return 0===e?new o.CellError(o.ErrorType.DIV_BY_ZERO):1/Math.sin(e)}))}},{key:"sinh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SINH"),Math.sinh)}},{key:"asinh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ASINH"),Math.asinh)}},{key:"cosh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COSH"),Math.cosh)}},{key:"acosh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ACOSH"),Math.acosh)}},{key:"tanh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("TANH"),Math.tanh)}},{key:"atanh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ATANH"),Math.atanh)}},{key:"coth",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COTH"),(function(e){return 0===e?new o.CellError(o.ErrorType.DIV_BY_ZERO):1/Math.tanh(e)}))}},{key:"acoth",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ACOTH"),(function(e){return 0===e?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.NonZero):Math.atanh(1/e)}))}},{key:"sech",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SECH"),(function(e){return 1/Math.cosh(e)}))}},{key:"csch",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CSCH"),(function(e){return 0===e?new o.CellError(o.ErrorType.DIV_BY_ZERO):1/Math.sinh(e)}))}}])&&c(t.prototype,r),n&&c(t,n),p}(i.FunctionPlugin);t.TrigonometryPlugin=d,d.implementedFunctions={ACOS:{method:"acos",parameters:[{argumentType:i.ArgumentTypes.NUMBER}]},ASIN:{method:"asin",parameters:[{argumentType:i.ArgumentTypes.NUMBER}]},COS:{method:"cos",parameters:[{argumentType:i.ArgumentTypes.NUMBER}]},SIN:{method:"sin",parameters:[{argumentType:i.ArgumentTypes.NUMBER}]},TAN:{method:"tan",parameters:[{argumentType:i.ArgumentTypes.NUMBER}]},ATAN:{method:"atan",parameters:[{argumentType:i.ArgumentTypes.NUMBER}]},ATAN2:{method:"atan2",parameters:[{argumentType:i.ArgumentTypes.NUMBER},{argumentType:i.ArgumentTypes.NUMBER}]},COT:{method:"cot",parameters:[{argumentType:i.ArgumentTypes.NUMBER}]},SEC:{method:"sec",parameters:[{argumentType:i.ArgumentTypes.NUMBER}]},CSC:{method:"csc",parameters:[{argumentType:i.ArgumentTypes.NUMBER}]},SINH:{method:"sinh",parameters:[{argumentType:i.ArgumentTypes.NUMBER}]},COSH:{method:"cosh",parameters:[{argumentType:i.ArgumentTypes.NUMBER}]},TANH:{method:"tanh",parameters:[{argumentType:i.ArgumentTypes.NUMBER}]},COTH:{method:"coth",parameters:[{argumentType:i.ArgumentTypes.NUMBER}]},SECH:{method:"sech",parameters:[{argumentType:i.ArgumentTypes.NUMBER}]},CSCH:{method:"csch",parameters:[{argumentType:i.ArgumentTypes.NUMBER}]},ACOT:{method:"acot",parameters:[{argumentType:i.ArgumentTypes.NUMBER}]},ASINH:{method:"asinh",parameters:[{argumentType:i.ArgumentTypes.NUMBER}]},ACOSH:{method:"acosh",parameters:[{argumentType:i.ArgumentTypes.NUMBER}]},ATANH:{method:"atanh",parameters:[{argumentType:i.ArgumentTypes.NUMBER}]},ACOTH:{method:"acoth",parameters:[{argumentType:i.ArgumentTypes.NUMBER}]}}},function(e,t,r){var n=r(2),o=r(7),a=r(359),i=Math.abs,u=Math.exp,s=Math.E;n({target:"Math",stat:!0,forced:o((function(){return-2e-17!=Math.sinh(-2e-17)}))},{sinh:function(e){return i(e=+e)<1?(a(e)-a(-e))/2:(u(e-1)-u(-e-1))*(s/2)}})},function(e,t){var r=Math.expm1,n=Math.exp;e.exports=!r||r(10)>22025.465794806718||r(10)<22025.465794806718||-2e-17!=r(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:n(e)-1}:r},function(e,t,r){var n=r(2),o=Math.asinh,a=Math.log,i=Math.sqrt;n({target:"Math",stat:!0,forced:!(o&&1/o(0)>0)},{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):a(t+i(t*t+1)):t}})},function(e,t,r){var n=r(2),o=r(359),a=Math.cosh,i=Math.abs,u=Math.E;n({target:"Math",stat:!0,forced:!a||a(710)===1/0},{cosh:function(e){var t=o(i(e)-1)+1;return(t+1/(t*u*u))*(u/2)}})},function(e,t,r){var n=r(2),o=r(363),a=Math.acosh,i=Math.log,u=Math.sqrt,s=Math.LN2;n({target:"Math",stat:!0,forced:!a||710!=Math.floor(a(Number.MAX_VALUE))||a(1/0)!=1/0},{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?i(e)+s:o(e-1+u(e-1)*u(e+1))}})},function(e,t){var r=Math.log;e.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:r(1+e)}},function(e,t,r){var n=r(2),o=r(359),a=Math.exp;n({target:"Math",stat:!0},{tanh:function(e){var t=o(e=+e),r=o(-e);return t==1/0?1:r==1/0?-1:(t-r)/(a(e)+a(-e))}})},function(e,t,r){var n=r(2),o=Math.atanh,a=Math.log;n({target:"Math",stat:!0,forced:!(o&&1/o(-0)<0)},{atanh:function(e){return 0==(e=+e)?e:a((1+e)/(1-e))/2}})},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.LookupPlugin=void 0,r(300),r(109);var o=r(135),a=r(115),i=r(215),u=r(367),s=r(224),c=r(271),l=r(222),f=r(308);function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g(e);if(t){var o=g(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return y(this,r)}}function y(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(y,e);var t,r,n,f=m(y);function y(){var e;return p(this,y),(e=f.apply(this,arguments)).rowSearch=new u.RowSearchStrategy(e.config,e.dependencyGraph),e}return t=y,(r=[{key:"vlookup",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("VLOOKUP"),(function(e,t,n,o){var u=t.range();return void 0===u?new a.CellError(a.ErrorType.VALUE,i.ErrorMessage.WrongType):n<1?new a.CellError(a.ErrorType.VALUE,i.ErrorMessage.LessThanOne):n>u.width()?new a.CellError(a.ErrorType.REF,i.ErrorMessage.IndexLarge):r.doVlookup((0,c.zeroIfEmpty)(e),u,n-1,o)}))}},{key:"hlookup",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("HLOOKUP"),(function(e,t,n,o){var u=t.range();return void 0===u?new a.CellError(a.ErrorType.VALUE,i.ErrorMessage.WrongType):n<1?new a.CellError(a.ErrorType.VALUE,i.ErrorMessage.LessThanOne):n>u.height()?new a.CellError(a.ErrorType.REF,i.ErrorMessage.IndexLarge):r.doHlookup((0,c.zeroIfEmpty)(e),u,n-1,o)}))}},{key:"match",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("MATCH"),(function(e,t,n){var o=t.range();return void 0===o?new a.CellError(a.ErrorType.VALUE,i.ErrorMessage.WrongType):r.doMatch((0,c.zeroIfEmpty)(e),o,n)}))}},{key:"doVlookup",value:function(e,t,r,n){this.dependencyGraph.stats.start(s.StatType.VLOOKUP);var u=o.AbsoluteCellRange.spanFrom(t.start,1,t.height()),c=this.searchInRange(e,u,n,this.columnSearch);if(this.dependencyGraph.stats.end(s.StatType.VLOOKUP),-1===c)return new a.CellError(a.ErrorType.NA,i.ErrorMessage.ValueNotFound);var f=(0,a.simpleCellAddress)(t.sheet,t.start.col+r,c),p=this.dependencyGraph.getCellValue(f);return p instanceof l.SimpleRangeValue?new a.CellError(a.ErrorType.VALUE,i.ErrorMessage.WrongType):p}},{key:"doHlookup",value:function(e,t,r,n){var u=o.AbsoluteCellRange.spanFrom(t.start,t.width(),1),s=this.searchInRange(e,u,n,this.rowSearch);if(-1===s)return new a.CellError(a.ErrorType.NA,i.ErrorMessage.ValueNotFound);var c=(0,a.simpleCellAddress)(t.sheet,s,t.start.row+r),f=this.dependencyGraph.getCellValue(c);return f instanceof l.SimpleRangeValue?new a.CellError(a.ErrorType.VALUE,i.ErrorMessage.WrongType):f}},{key:"doMatch",value:function(e,t,r){if(t.width()>1&&t.height()>1)return new a.CellError(a.ErrorType.NA);if(1===t.width()){var n=this.columnSearch.find(e,t,0!==r);return-1===n?new a.CellError(a.ErrorType.NA,i.ErrorMessage.ValueNotFound):n-t.start.row+1}var o=this.rowSearch.find(e,t,0!==r);return-1===o?new a.CellError(a.ErrorType.NA,i.ErrorMessage.ValueNotFound):o-t.start.col+1}},{key:"searchInRange",value:function(e,t,r,n){return!r&&"string"==typeof e&&this.interpreter.arithmeticHelper.requiresRegex(e)?n.advancedFind(this.interpreter.arithmeticHelper.eqMatcherFunction(e),t):n.find(e,t,r)}}])&&h(t.prototype,r),n&&h(t,n),y}(f.FunctionPlugin);t.LookupPlugin=v,v.implementedFunctions={VLOOKUP:{method:"vlookup",parameters:[{argumentType:f.ArgumentTypes.NOERROR},{argumentType:f.ArgumentTypes.RANGE},{argumentType:f.ArgumentTypes.NUMBER},{argumentType:f.ArgumentTypes.BOOLEAN,defaultValue:!0}]},HLOOKUP:{method:"hlookup",parameters:[{argumentType:f.ArgumentTypes.NOERROR},{argumentType:f.ArgumentTypes.RANGE},{argumentType:f.ArgumentTypes.NUMBER},{argumentType:f.ArgumentTypes.BOOLEAN,defaultValue:!0}]},MATCH:{method:"match",parameters:[{argumentType:f.ArgumentTypes.NOERROR},{argumentType:f.ArgumentTypes.RANGE},{argumentType:f.ArgumentTypes.NUMBER,defaultValue:1}]}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.RowSearchStrategy=void 0,r(121),r(109);var o=r(271),a=r(297),i=r(223);function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return l(this,r)}}function l(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(f,e);var t,r,n,l=c(f);function f(e,t){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(r=l.call(this,t)).config=e,r.dependencyGraph=t,r}return t=f,(r=[{key:"find",value:function(e,t,r){if("string"==typeof e&&(e=(0,o.forceNormalizeString)(e)),t.width()<this.config.binarySearchThreshold||!r){var n=this.dependencyGraph.computeListOfValuesInRange(t).map(i.getRawValue).map((function(e){return"string"==typeof e?(0,o.forceNormalizeString)(e):e})).indexOf(e);return n<0?n:n+t.start.col}return(0,a.rangeLowerBound)(t,e,this.dependencyGraph,"col")}}])&&u(t.prototype,r),n&&u(t,n),f}(r(298).AdvancedFind);t.RowSearchStrategy=p},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.RomanPlugin=void 0,r(325),r(259),r(111),r(53),r(356),r(109);var o=r(115),a=r(215),i=r(223),u=r(308);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h(e);if(t){var o=h(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(p,e);var t,r,n,u=f(p);function p(){return s(this,p),u.apply(this,arguments)}return t=p,(r=[{key:"roman",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("ROMAN"),(function(e,t){return e=Math.trunc(e),!1===t?t=4:!0===t&&(t=0),(t=(0,i.getRawValue)(r.coerceScalarToNumberOrError(t)))instanceof o.CellError?t:(t=Math.trunc(t))<0?new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.ValueSmall):t>4?new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.ValueLarge):function(e,t){var r={val:e%1e3,acc:"M".repeat(Math.floor(e/1e3))};return 4===t&&(y(r,"IM",999,1e3),y(r,"ID",499,500)),t>=3&&(y(r,"VM",995,1e3),y(r,"VD",495,500)),t>=2&&(y(r,"XM",990,1e3),y(r,"XD",490,500)),t>=1&&(y(r,"LM",950,1e3),y(r,"LD",450,500)),y(r,"CM",900,1e3),y(r,"CD",400,500),y(r,"D",500,900),r.acc+="C".repeat(Math.floor(r.val/100)),r.val%=100,t>=2&&(y(r,"IC",99,100),y(r,"IL",49,50)),t>=1&&(y(r,"VC",95,100),y(r,"VL",45,50)),y(r,"XC",90,100),y(r,"XL",40,50),y(r,"L",50,90),r.acc+="X".repeat(Math.floor(r.val/10)),r.val%=10,y(r,"IX",9,10),y(r,"IV",4,5),y(r,"V",5,9),r.acc+="I".repeat(r.val),r.acc}(e,t)}))}},{key:"arabic",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ARABIC"),(function(e){var t=!1;if((e=e.trim().toUpperCase()).startsWith("-")&&(t=!0,""===(e=e.slice(1))))return new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.InvalidRoman);var r={input:e,acc:0};return m(r,{token:"MMM",val:3e3},{token:"MM",val:2e3},{token:"M",val:1e3}),m(r,{token:"IM",val:999},{token:"VM",val:995},{token:"XM",val:990},{token:"LM",val:950},{token:"CM",val:900}),m(r,{token:"D",val:500},{token:"ID",val:499},{token:"VD",val:495},{token:"XD",val:490},{token:"LD",val:450},{token:"CD",val:400}),m(r,{token:"CCC",val:300},{token:"CC",val:200},{token:"C",val:100}),m(r,{token:"IC",val:99},{token:"VC",val:95},{token:"XC",val:90}),m(r,{token:"L",val:50},{token:"IL",val:49},{token:"VL",val:45},{token:"XL",val:40}),m(r,{token:"XXX",val:30},{token:"XX",val:20},{token:"X",val:10}),m(r,{token:"IX",val:9}),m(r,{token:"V",val:5},{token:"IV",val:4}),m(r,{token:"III",val:3},{token:"II",val:2},{token:"I",val:1}),""!==r.input?new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.InvalidRoman):t?-r.acc:r.acc}))}}])&&c(t.prototype,r),n&&c(t,n),p}(u.FunctionPlugin);function m(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(var o=0,a=r;o<a.length;o++){var i=a[o];if(e.input.startsWith(i.token)){e.input=e.input.slice(i.token.length),e.acc+=i.val;break}}}function y(e,t,r,n){e.val>=r&&e.val<n&&(e.val-=r,e.acc+=t)}t.RomanPlugin=d,d.implementedFunctions={ROMAN:{method:"roman",parameters:[{argumentType:u.ArgumentTypes.NUMBER,minValue:1,lessThan:4e3},{argumentType:u.ArgumentTypes.NOERROR,optionalArg:!0,defaultValue:0}]},ARABIC:{method:"arabic",parameters:[{argumentType:u.ArgumentTypes.STRING}]}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.SimpleArithmerticPlugin=void 0,r(125),r(109);var o=r(308);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var o=l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(c,e);var t,r,n,o=s(c);function c(){return a(this,c),o.apply(this,arguments)}return t=c,(r=[{key:"add",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.ADD"),this.interpreter.arithmeticHelper.addWithEpsilon)}},{key:"concat",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.CONCAT"),this.interpreter.arithmeticHelper.concat)}},{key:"divide",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.DIVIDE"),this.interpreter.arithmeticHelper.divide)}},{key:"eq",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.EQ"),this.interpreter.arithmeticHelper.eq)}},{key:"gt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.GT"),this.interpreter.arithmeticHelper.gt)}},{key:"gte",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.GTE"),this.interpreter.arithmeticHelper.geq)}},{key:"lt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.LT"),this.interpreter.arithmeticHelper.lt)}},{key:"lte",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.LTE"),this.interpreter.arithmeticHelper.leq)}},{key:"minus",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.MINUS"),this.interpreter.arithmeticHelper.subtract)}},{key:"multiply",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.MULTIPLY"),this.interpreter.arithmeticHelper.multiply)}},{key:"ne",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.NE"),this.interpreter.arithmeticHelper.neq)}},{key:"pow",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.POW"),this.interpreter.arithmeticHelper.pow)}},{key:"uminus",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.UMINUS"),this.interpreter.arithmeticHelper.unaryMinus)}},{key:"upercent",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.UNARY_PERCENT"),this.interpreter.arithmeticHelper.unaryPercent)}},{key:"uplus",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.UPLUS"),this.interpreter.arithmeticHelper.unaryPlus)}}])&&i(t.prototype,r),n&&i(t,n),c}(o.FunctionPlugin);t.SimpleArithmerticPlugin=f,f.implementedFunctions={"HF.ADD":{method:"add",parameters:[{argumentType:o.ArgumentTypes.NUMBER,passSubtype:!0},{argumentType:o.ArgumentTypes.NUMBER,passSubtype:!0}]},"HF.CONCAT":{method:"concat",parameters:[{argumentType:o.ArgumentTypes.STRING,passSubtype:!0},{argumentType:o.ArgumentTypes.STRING,passSubtype:!0}]},"HF.DIVIDE":{method:"divide",parameters:[{argumentType:o.ArgumentTypes.NUMBER,passSubtype:!0},{argumentType:o.ArgumentTypes.NUMBER,passSubtype:!0}]},"HF.EQ":{method:"eq",parameters:[{argumentType:o.ArgumentTypes.NOERROR,passSubtype:!0},{argumentType:o.ArgumentTypes.NOERROR,passSubtype:!0}]},"HF.GT":{method:"gt",parameters:[{argumentType:o.ArgumentTypes.NOERROR,passSubtype:!0},{argumentType:o.ArgumentTypes.NOERROR,passSubtype:!0}]},"HF.GTE":{method:"gte",parameters:[{argumentType:o.ArgumentTypes.NOERROR,passSubtype:!0},{argumentType:o.ArgumentTypes.NOERROR,passSubtype:!0}]},"HF.LT":{method:"lt",parameters:[{argumentType:o.ArgumentTypes.NOERROR,passSubtype:!0},{argumentType:o.ArgumentTypes.NOERROR,passSubtype:!0}]},"HF.LTE":{method:"lte",parameters:[{argumentType:o.ArgumentTypes.NOERROR,passSubtype:!0},{argumentType:o.ArgumentTypes.NOERROR,passSubtype:!0}]},"HF.MINUS":{method:"minus",parameters:[{argumentType:o.ArgumentTypes.NUMBER,passSubtype:!0},{argumentType:o.ArgumentTypes.NUMBER,passSubtype:!0}]},"HF.MULTIPLY":{method:"multiply",parameters:[{argumentType:o.ArgumentTypes.NUMBER,passSubtype:!0},{argumentType:o.ArgumentTypes.NUMBER,passSubtype:!0}]},"HF.NE":{method:"ne",parameters:[{argumentType:o.ArgumentTypes.NOERROR,passSubtype:!0},{argumentType:o.ArgumentTypes.NOERROR,passSubtype:!0}]},"HF.POW":{method:"pow",parameters:[{argumentType:o.ArgumentTypes.NUMBER,passSubtype:!0},{argumentType:o.ArgumentTypes.NUMBER,passSubtype:!0}]},"HF.UMINUS":{method:"uminus",parameters:[{argumentType:o.ArgumentTypes.NUMBER,passSubtype:!0}]},"HF.UNARY_PERCENT":{method:"upercent",parameters:[{argumentType:o.ArgumentTypes.NUMBER,passSubtype:!0}]},"HF.UPLUS":{method:"uplus",parameters:[{argumentType:o.ArgumentTypes.NUMBER,passSubtype:!0}]}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),t.__esModule=!0,t.StatisticalPlugin=void 0,r(325),r(109);var o=r(115),a=r(215),i=r(371),u=r(372),s=r(308);function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=d(e);if(t){var o=d(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(h,e);var t,r,n,s=p(h);function h(){return c(this,h),s.apply(this,arguments)}return t=h,(r=[{key:"erf",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ERF"),(function(e,t){return void 0===t?(0,u.erf)(e):(0,u.erf)(t)-(0,u.erf)(e)}))}},{key:"erfc",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ERFC"),u.erfc)}},{key:"expondist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("EXPON.DIST"),(function(e,t,r){return r?u.exponential.cdf(e,t):u.exponential.pdf(e,t)}))}},{key:"fisher",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FISHER"),(function(e){return Math.log((1+e)/(1-e))/2}))}},{key:"fisherinv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FISHERINV"),(function(e){return 1-2/(Math.exp(2*e)+1)}))}},{key:"gamma",value:function(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA"),u.gammafn)}},{key:"gammadist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.DIST"),(function(e,t,r,n){return n?u.gamma.cdf(e,t,r):u.gamma.pdf(e,t,r)}))}},{key:"gammaln",value:function(e,t){return this.runFunction(e.args,t,this.metadata("GAMMALN"),u.gammaln)}},{key:"gammainv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.INV"),u.gamma.inv)}},{key:"gauss",value:function(e,t){return this.runFunction(e.args,t,this.metadata("GAUSS"),(function(e){return u.normal.cdf(e,0,1)-.5}))}},{key:"betadist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BETA.DIST"),(function(e,t,r,n,i,s){return e<=i?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.ValueSmall):e>=s?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.ValueLarge):(e=(e-i)/(s-i),n?u.beta.cdf(e,t,r):u.beta.pdf(e,t,r))}))}},{key:"betainv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BETA.INV"),(function(e,t,r,n,i){return n>=i?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.WrongOrder):u.beta.inv(e,t,r)*(i-n)+n}))}},{key:"binomialdist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.DIST"),(function(e,t,r,n){return e>t?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.WrongOrder):(e=Math.trunc(e),t=Math.trunc(t),n?u.binomial.cdf(e,t,r):u.binomial.pdf(e,t,r))}))}},{key:"binomialinv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.INV"),(function(e,t,r){for(var n=-1,o=e=Math.trunc(e);o>n+1;){var a=Math.trunc((n+o)/2);u.binomial.cdf(a,e,t)>=r?o=a:n=a}return o}))}},{key:"besselifn",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BESSELI"),(function(e,t){return(0,i.besseli)(e,Math.trunc(t))}))}},{key:"besseljfn",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BESSELJ"),(function(e,t){return(0,i.besselj)(e,Math.trunc(t))}))}},{key:"besselkfn",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BESSELK"),(function(e,t){return(0,i.besselk)(e,Math.trunc(t))}))}},{key:"besselyfn",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BESSELY"),(function(e,t){return(0,i.bessely)(e,Math.trunc(t))}))}},{key:"chisqdist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST"),(function(e,t,r){return t=Math.trunc(t),r?u.chisquare.cdf(e,t):u.chisquare.pdf(e,t)}))}},{key:"chisqdistrt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST.RT"),(function(e,t){return 1-u.chisquare.cdf(e,Math.trunc(t))}))}},{key:"chisqinv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV"),(function(e,t){return u.chisquare.inv(e,Math.trunc(t))}))}},{key:"chisqinvrt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV.RT"),(function(e,t){return u.chisquare.inv(1-e,Math.trunc(t))}))}},{key:"fdist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST"),(function(e,t,r,n){return t=Math.trunc(t),r=Math.trunc(r),n?u.centralF.cdf(e,t,r):u.centralF.pdf(e,t,r)}))}},{key:"fdistrt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST.RT"),(function(e,t,r){return 1-u.centralF.cdf(e,Math.trunc(t),Math.trunc(r))}))}},{key:"finv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("F.INV"),(function(e,t,r){return u.centralF.inv(e,Math.trunc(t),Math.trunc(r))}))}},{key:"finvrt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("F.INV.RT"),(function(e,t,r){return u.centralF.inv(1-e,Math.trunc(t),Math.trunc(r))}))}},{key:"weibulldist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("WEIBULL.DIST"),(function(e,t,r,n){return n?u.weibull.cdf(e,r,t):u.weibull.pdf(e,r,t)}))}},{key:"poissondist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("POISSON.DIST"),(function(e,t,r){return e=Math.trunc(e),r?u.poisson.cdf(e,t):u.poisson.pdf(e,t)}))}},{key:"hypgeomdist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HYPGEOM.DIST"),(function(e,t,r,n,i){return e>t||e>r||t>n||r>n||e+n<r+t?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.ValueLarge):(e=Math.trunc(e),t=Math.trunc(t),r=Math.trunc(r),n=Math.trunc(n),i?u.hypgeom.cdf(e,n,r,t):u.hypgeom.pdf(e,n,r,t))}))}},{key:"tdist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST"),(function(e,t,r){return t=Math.trunc(t),r?u.studentt.cdf(e,t):u.studentt.pdf(e,t)}))}},{key:"tdist2t",value:function(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.2T"),(function(e,t){return 2*(1-u.studentt.cdf(e,Math.trunc(t)))}))}},{key:"tdistrt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.RT"),(function(e,t){return 1-u.studentt.cdf(e,Math.trunc(t))}))}},{key:"tdistold",value:function(e,t){return this.runFunction(e.args,t,this.metadata("TDIST"),(function(e,t,r){return r*(1-u.studentt.cdf(e,Math.trunc(t)))}))}},{key:"tinv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("T.INV"),(function(e,t){return u.studentt.inv(e,Math.trunc(t))}))}},{key:"tinv2t",value:function(e,t){return this.runFunction(e.args,t,this.metadata("T.INV.2T"),(function(e,t){return u.studentt.inv(1-e/2,Math.trunc(t))}))}},{key:"lognormdist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.DIST"),(function(e,t,r,n){return n?u.lognormal.cdf(e,t,r):u.lognormal.pdf(e,t,r)}))}},{key:"lognorminv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.INV"),(function(e,t,r){return u.lognormal.inv(e,t,r)}))}},{key:"normdist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("NORM.DIST"),(function(e,t,r,n){return n?u.normal.cdf(e,t,r):u.normal.pdf(e,t,r)}))}},{key:"norminv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("NORM.INV"),(function(e,t,r){return u.normal.inv(e,t,r)}))}},{key:"normsdist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.DIST"),(function(e,t){return t?u.normal.cdf(e,0,1):u.normal.pdf(e,0,1)}))}},{key:"normsinv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.INV"),(function(e){return u.normal.inv(e,0,1)}))}},{key:"phi",value:function(e,t){return this.runFunction(e.args,t,this.metadata("PHI"),(function(e){return u.normal.pdf(e,0,1)}))}},{key:"negbinomdist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("NEGBINOM.DIST"),(function(e,t,r,n){return e=Math.trunc(e),t=Math.trunc(t),n?u.negbin.cdf(e,t,r):u.negbin.pdf(e,t,r)}))}},{key:"confidencenorm",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.NORM"),(function(e,t,r){return(0,u.normalci)(1,e,t,Math.trunc(r))[1]-1}))}},{key:"confidencet",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.T"),(function(e,t,r){return 1===(r=Math.trunc(r))?new o.CellError(o.ErrorType.DIV_BY_ZERO):(0,u.tci)(1,e,t,r)[1]-1}))}},{key:"standardize",value:function(e,t){return this.runFunction(e.args,t,this.metadata("STANDARDIZE"),(function(e,t,r){return(e-t)/r}))}}])&&l(t.prototype,r),n&&l(t,n),h}(s.FunctionPlugin);t.StatisticalPlugin=m,m.implementedFunctions={ERF:{method:"erf",parameters:[{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.NUMBER,optionalArg:!0}]},ERFC:{method:"erfc",parameters:[{argumentType:s.ArgumentTypes.NUMBER}]},"EXPON.DIST":{method:"expondist",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:s.ArgumentTypes.BOOLEAN}]},FISHER:{method:"fisher",parameters:[{argumentType:s.ArgumentTypes.NUMBER,greaterThan:-1,lessThan:1}]},FISHERINV:{method:"fisherinv",parameters:[{argumentType:s.ArgumentTypes.NUMBER}]},GAMMA:{method:"gamma",parameters:[{argumentType:s.ArgumentTypes.NUMBER}]},"GAMMA.DIST":{method:"gammadist",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:s.ArgumentTypes.BOOLEAN}]},GAMMALN:{method:"gammaln",parameters:[{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0}]},"GAMMA.INV":{method:"gammainv",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0,lessThan:1},{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0}]},GAUSS:{method:"gauss",parameters:[{argumentType:s.ArgumentTypes.NUMBER}]},"BETA.DIST":{method:"betadist",parameters:[{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:s.ArgumentTypes.BOOLEAN},{argumentType:s.ArgumentTypes.NUMBER,defaultValue:0},{argumentType:s.ArgumentTypes.NUMBER,defaultValue:1}]},"BETA.INV":{method:"betainv",parameters:[{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0,maxValue:1},{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:s.ArgumentTypes.NUMBER,defaultValue:0},{argumentType:s.ArgumentTypes.NUMBER,defaultValue:1}]},"BINOM.DIST":{method:"binomialdist",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.NUMBER,minValue:0,maxValue:1},{argumentType:s.ArgumentTypes.BOOLEAN}]},"BINOM.INV":{method:"binomialinv",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.NUMBER,minValue:0,maxValue:1},{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0,lessThan:1}]},BESSELI:{method:"besselifn",parameters:[{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.NUMBER,minValue:0}]},BESSELJ:{method:"besseljfn",parameters:[{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.NUMBER,minValue:0}]},BESSELK:{method:"besselkfn",parameters:[{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.NUMBER,minValue:0}]},BESSELY:{method:"besselyfn",parameters:[{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.NUMBER,minValue:0}]},"CHISQ.DIST":{method:"chisqdist",parameters:[{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.NUMBER,minValue:1,maxValue:1e10},{argumentType:s.ArgumentTypes.BOOLEAN}]},"CHISQ.DIST.RT":{method:"chisqdistrt",parameters:[{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV":{method:"chisqinv",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0,maxValue:1},{argumentType:s.ArgumentTypes.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV.RT":{method:"chisqinvrt",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0,maxValue:1},{argumentType:s.ArgumentTypes.NUMBER,minValue:1}]},"F.DIST":{method:"fdist",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.NUMBER,minValue:1},{argumentType:s.ArgumentTypes.NUMBER,minValue:1},{argumentType:s.ArgumentTypes.BOOLEAN}]},"F.DIST.RT":{method:"fdistrt",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.NUMBER,minValue:1},{argumentType:s.ArgumentTypes.NUMBER,minValue:1}]},"F.INV":{method:"finv",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0,maxValue:1},{argumentType:s.ArgumentTypes.NUMBER,minValue:1},{argumentType:s.ArgumentTypes.NUMBER,minValue:1}]},"F.INV.RT":{method:"finvrt",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0,maxValue:1},{argumentType:s.ArgumentTypes.NUMBER,minValue:1},{argumentType:s.ArgumentTypes.NUMBER,minValue:1}]},"WEIBULL.DIST":{method:"weibulldist",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:s.ArgumentTypes.BOOLEAN}]},"POISSON.DIST":{method:"poissondist",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.BOOLEAN}]},"HYPGEOM.DIST":{method:"hypgeomdist",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:s.ArgumentTypes.BOOLEAN}]},"T.DIST":{method:"tdist",parameters:[{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.NUMBER,minValue:1},{argumentType:s.ArgumentTypes.BOOLEAN}]},"T.DIST.2T":{method:"tdist2t",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.NUMBER,minValue:1}]},"T.DIST.RT":{method:"tdistrt",parameters:[{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.NUMBER,minValue:1}]},TDIST:{method:"tdistold",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.NUMBER,minValue:1},{argumentType:s.ArgumentTypes.INTEGER,minValue:1,maxValue:2}]},"T.INV":{method:"tinv",parameters:[{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0,lessThan:1},{argumentType:s.ArgumentTypes.NUMBER,minValue:1}]},"T.INV.2T":{method:"tinv2t",parameters:[{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0,maxValue:1},{argumentType:s.ArgumentTypes.NUMBER,minValue:1}]},"LOGNORM.DIST":{method:"lognormdist",parameters:[{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:s.ArgumentTypes.BOOLEAN}]},"LOGNORM.INV":{method:"lognorminv",parameters:[{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0,lessThan:1},{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0}]},"NORM.DIST":{method:"normdist",parameters:[{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:s.ArgumentTypes.BOOLEAN}]},"NORM.INV":{method:"norminv",parameters:[{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0,lessThan:1},{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0}]},"NORM.S.DIST":{method:"normsdist",parameters:[{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.BOOLEAN}]},"NORM.S.INV":{method:"normsinv",parameters:[{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0,lessThan:1}]},PHI:{method:"phi",parameters:[{argumentType:s.ArgumentTypes.NUMBER}]},"NEGBINOM.DIST":{method:"negbinomdist",parameters:[{argumentType:s.ArgumentTypes.NUMBER,minValue:0},{argumentType:s.ArgumentTypes.NUMBER,minValue:1},{argumentType:s.ArgumentTypes.NUMBER,minValue:0,maxValue:1},{argumentType:s.ArgumentTypes.BOOLEAN}]},"CONFIDENCE.NORM":{method:"confidencenorm",parameters:[{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0,lessThan:1},{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:s.ArgumentTypes.NUMBER,minValue:1}]},"CONFIDENCE.T":{method:"confidencet",parameters:[{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0,lessThan:1},{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0},{argumentType:s.ArgumentTypes.NUMBER,minValue:1}]},STANDARDIZE:{method:"standardize",parameters:[{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.NUMBER,greaterThan:0}]}},m.aliases={NEGBINOMDIST:"NEGBINOM.DIST",EXPONDIST:"EXPON.DIST",BETADIST:"BETA.DIST",NORMDIST:"NORM.DIST",NORMINV:"NORM.INV",NORMSDIST:"NORM.S.DIST",NORMSINV:"NORM.S.INV",LOGNORMDIST:"LOGNORM.DIST",LOGINV:"LOGNORM.INV",TINV:"T.INV.2T",HYPGEOMDIST:"HYPGEOM.DIST",POISSON:"POISSON.DIST",WEIBULL:"WEIBULL.DIST",FINV:"F.INV.RT",FDIST:"F.DIST.RT",CHIDIST:"CHISQ.DIST.RT",CHIINV:"CHISQ.INV.RT",GAMMADIST:"GAMMA.DIST","GAMMALN.PRECISE":"GAMMALN",GAMMAINV:"GAMMA.INV",BETAINV:"BETA.INV",BINOMDIST:"BINOM.DIST",CONFIDENCE:"CONFIDENCE.NORM",CRITBINOM:"BINOM.INV",WEIBULLDIST:"WEIBULL.DIST",TINV2T:"T.INV.2T",TDISTRT:"T.DIST.RT",TDIST2T:"T.DIST.2T",FINVRT:"F.INV.RT",FDISTRT:"F.DIST.RT",CHIDISTRT:"CHISQ.DIST.RT",CHIINVRT:"CHISQ.INV.RT",LOGNORMINV:"LOGNORM.INV",POISSONDIST:"POISSON.DIST"}},function(e,t,r){"use strict";t.__esModule=!0,t.besselk=t.besseli=t.bessely=t.besselj=void 0,r(239);
/**
 * @license
 bessel.js (C) 2013-present SheetJS -- http://sheetjs.com
 
                                 Apache License
                           Version 2.0, January 2004
                        http://www.apache.org/licenses/

 TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

 1. Definitions.

 "License" shall mean the terms and conditions for use, reproduction,
 and distribution as defined by Sections 1 through 9 of this document.

 "Licensor" shall mean the copyright owner or entity authorized by
 the copyright owner that is granting the License.

 "Legal Entity" shall mean the union of the acting entity and all
 other entities that control, are controlled by, or are under common
 control with that entity. For the purposes of this definition,
 "control" means (i) the power, direct or indirect, to cause the
 direction or management of such entity, whether by contract or
 otherwise, or (ii) ownership of fifty percent (50%) or more of the
 outstanding shares, or (iii) beneficial ownership of such entity.

 "You" (or "Your") shall mean an individual or Legal Entity
 exercising permissions granted by this License.

 "Source" form shall mean the preferred form for making modifications,
 including but not limited to software source code, documentation
 source, and configuration files.

 "Object" form shall mean any form resulting from mechanical
 transformation or translation of a Source form, including but
 not limited to compiled object code, generated documentation,
 and conversions to other media types.

 "Work" shall mean the work of authorship, whether in Source or
 Object form, made available under the License, as indicated by a
 copyright notice that is included in or attached to the work
 (an example is provided in the Appendix below).

 "Derivative Works" shall mean any work, whether in Source or Object
 form, that is based on (or derived from) the Work and for which the
 editorial revisions, annotations, elaborations, or other modifications
 represent, as a whole, an original work of authorship. For the purposes
 of this License, Derivative Works shall not include works that remain
 separable from, or merely link (or bind by name) to the interfaces of,
 the Work and Derivative Works thereof.

 "Contribution" shall mean any work of authorship, including
 the original version of the Work and any modifications or additions
 to that Work or Derivative Works thereof, that is intentionally
 submitted to Licensor for inclusion in the Work by the copyright owner
 or by an individual or Legal Entity authorized to submit on behalf of
 the copyright owner. For the purposes of this definition, "submitted"
 means any form of electronic, verbal, or written communication sent
 to the Licensor or its representatives, including but not limited to
 communication on electronic mailing lists, source code control systems,
 and issue tracking systems that are managed by, or on behalf of, the
 Licensor for the purpose of discussing and improving the Work, but
 excluding communication that is conspicuously marked or otherwise
 designated in writing by the copyright owner as "Not a Contribution."

 "Contributor" shall mean Licensor and any individual or Legal Entity
 on behalf of whom a Contribution has been received by Licensor and
 subsequently incorporated within the Work.

 2. Grant of Copyright License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 copyright license to reproduce, prepare Derivative Works of,
 publicly display, publicly perform, sublicense, and distribute the
 Work and such Derivative Works in Source or Object form.

 3. Grant of Patent License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 (except as stated in this section) patent license to make, have made,
 use, offer to sell, sell, import, and otherwise transfer the Work,
 where such license applies only to those patent claims licensable
 by such Contributor that are necessarily infringed by their
 Contribution(s) alone or by combination of their Contribution(s)
 with the Work to which such Contribution(s) was submitted. If You
 institute patent litigation against any entity (including a
 cross-claim or counterclaim in a lawsuit) alleging that the Work
 or a Contribution incorporated within the Work constitutes direct
 or contributory patent infringement, then any patent licenses
 granted to You under this License for that Work shall terminate
 as of the date such litigation is filed.

 4. Redistribution. You may reproduce and distribute copies of the
 Work or Derivative Works thereof in any medium, with or without
 modifications, and in Source or Object form, provided that You
 meet the following conditions:

 (a) You must give any other recipients of the Work or
 Derivative Works a copy of this License; and

 (b) You must cause any modified files to carry prominent notices
 stating that You changed the files; and

 (c) You must retain, in the Source form of any Derivative Works
 that You distribute, all copyright, patent, trademark, and
 attribution notices from the Source form of the Work,
 excluding those notices that do not pertain to any part of
 the Derivative Works; and

 (d) If the Work includes a "NOTICE" text file as part of its
 distribution, then any Derivative Works that You distribute must
 include a readable copy of the attribution notices contained
 within such NOTICE file, excluding those notices that do not
 pertain to any part of the Derivative Works, in at least one
 of the following places: within a NOTICE text file distributed
 as part of the Derivative Works; within the Source form or
 documentation, if provided along with the Derivative Works; or,
 within a display generated by the Derivative Works, if and
 wherever such third-party notices normally appear. The contents
 of the NOTICE file are for informational purposes only and
 do not modify the License. You may add Your own attribution
 notices within Derivative Works that You distribute, alongside
 or as an addendum to the NOTICE text from the Work, provided
 that such additional attribution notices cannot be construed
 as modifying the License.

 You may add Your own copyright statement to Your modifications and
 may provide additional or different license terms and conditions
 for use, reproduction, or distribution of Your modifications, or
 for any such Derivative Works as a whole, provided Your use,
 reproduction, and distribution of the Work otherwise complies with
 the conditions stated in this License.

 5. Submission of Contributions. Unless You explicitly state otherwise,
 any Contribution intentionally submitted for inclusion in the Work
 by You to the Licensor shall be under the terms and conditions of
 this License, without any additional terms or conditions.
 Notwithstanding the above, nothing herein shall supersede or modify
 the terms of any separate license agreement you may have executed
 with Licensor regarding such Contributions.

 6. Trademarks. This License does not grant permission to use the trade
 names, trademarks, service marks, or product names of the Licensor,
 except as required for reasonable and customary use in describing the
 origin of the Work and reproducing the content of the NOTICE file.

 7. Disclaimer of Warranty. Unless required by applicable law or
 agreed to in writing, Licensor provides the Work (and each
 Contributor provides its Contributions) on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
 implied, including, without limitation, any warranties or conditions
 of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
 PARTICULAR PURPOSE. You are solely responsible for determining the
 appropriateness of using or redistributing the Work and assume any
 risks associated with Your exercise of permissions under this License.

 8. Limitation of Liability. In no event and under no legal theory,
 whether in tort (including negligence), contract, or otherwise,
 unless required by applicable law (such as deliberate and grossly
 negligent acts) or agreed to in writing, shall any Contributor be
 liable to You for damages, including any direct, indirect, special,
 incidental, or consequential damages of any character arising as a
 result of this License or out of the use or inability to use the
 Work (including but not limited to damages for loss of goodwill,
 work stoppage, computer failure or malfunction, or any and all
 other commercial damages or losses), even if such Contributor
 has been advised of the possibility of such damages.

 9. Accepting Warranty or Additional Liability. While redistributing
 the Work or Derivative Works thereof, You may choose to offer,
 and charge a fee for, acceptance of support, warranty, indemnity,
 or other liability obligations and/or rights consistent with this
 License. However, in accepting such obligations, You may act only
 on Your own behalf and on Your sole responsibility, not on behalf
 of any other Contributor, and only if You agree to indemnify,
 defend, and hold each Contributor harmless for any liability
 incurred by, or claims asserted against, such Contributor by reason
 of your accepting any such warranty or additional liability.

 END OF TERMS AND CONDITIONS

 APPENDIX: How to apply the Apache License to your work.

 To apply the Apache License to your work, attach the following
 boilerplate notice, with the fields enclosed by brackets "{}"
 replaced with your own identifying information. (Don't include
 the brackets!)  The text should be enclosed in the appropriate
 comment syntax for the file format. We also recommend that a
 file or class name and description of purpose be included on the
 same "printed page" as the copyright notice for easier
 identification within third-party archives.

 Copyright (C) 2013-present   SheetJS LLC

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 */
var n=Math;function o(e,t){for(var r=0,n=0;r<e.length;++r)n=t*n+e[r];return n}function a(e,t,r,n,o){if(0===t)return r;if(1===t)return n;for(var a=2/e,i=n,u=1;u<t;++u)i=n*u*a+o*r,r=n,n=i;return i}function i(e,t,r,n,o){return function(r,i){if(n){if(0===r)return 1==n?-1/0:1/0;if(r<0)return NaN}return 0===i?e(r):1===i?t(r):i<0?NaN:a(r,i|=0,e(r),t(r),o)}}var u=function(){var e=.636619772,t=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),r=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),i=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),u=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse();function s(a){var s=0,c=0,l=0,f=a*a;if(a<8)s=(c=o(t,f))/(l=o(r,f));else{var p=a-.785398164;c=o(i,f=64/f),l=o(u,f),s=n.sqrt(e/a)*(n.cos(p)*c-n.sin(p)*l*8/a)}return s}var c=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),l=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),f=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),p=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function h(t){var r=0,a=0,i=0,u=t*t,s=n.abs(t)-2.356194491;return Math.abs(t)<8?r=(a=t*o(c,u))/(i=o(l,u)):(a=o(f,u=64/u),i=o(p,u),r=n.sqrt(e/n.abs(t))*(n.cos(s)*a-n.sin(s)*i*8/n.abs(t)),t<0&&(r=-r)),r}return function e(t,r){if(r=Math.round(r),!isFinite(t))return isNaN(t)?t:0;if(r<0)return(r%2?-1:1)*e(t,-r);if(t<0)return(r%2?-1:1)*e(-t,r);if(0===r)return s(t);if(1===r)return h(t);if(0===t)return 0;var o=0;if(t>r)o=a(t,r,s(t),h(t),-1);else{for(var i=!1,u=0,c=0,l=1,f=0,p=2/t,d=2*n.floor((r+n.floor(n.sqrt(40*r)))/2);d>0;d--)f=d*p*l-u,u=l,l=f,n.abs(l)>1e10&&(l*=1e-10,u*=1e-10,o*=1e-10,c*=1e-10),i&&(c+=l),i=!i,d==r&&(o=u);o/=c=2*c-l}return o}}();t.besselj=u;var s,c,l,f,p,h,d,m,y,g=(s=.636619772,c=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),l=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),f=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),p=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),h=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),d=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),m=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),y=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse(),i((function(e){var t=0,r=0,a=0,i=e*e,h=e-.785398164;return e<8?t=(r=o(c,i))/(a=o(l,i))+s*u(e,0)*n.log(e):(r=o(f,i=64/i),a=o(p,i),t=n.sqrt(s/e)*(n.sin(h)*r+n.cos(h)*a*8/e)),t}),(function(e){var t=0,r=0,a=0,i=e*e,c=e-2.356194491;return e<8?t=(r=e*o(h,i))/(a=o(d,i))+s*(u(e,1)*n.log(e)-1/e):(r=o(m,i=64/i),a=o(y,i),t=n.sqrt(s/e)*(n.sin(c)*r+n.cos(c)*a*8/e)),t}),0,1,-1));t.bessely=g;var v,E,T,b,R=(v=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),E=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),T=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),b=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function e(t,r){if(0===(r=Math.round(r)))return function(e){return e<=3.75?o(v,e*e/14.0625):n.exp(n.abs(e))/n.sqrt(n.abs(e))*o(E,3.75/n.abs(e))}(t);if(1===r)return function(e){return e<3.75?e*o(T,e*e/14.0625):(e<0?-1:1)*n.exp(n.abs(e))/n.sqrt(n.abs(e))*o(b,3.75/n.abs(e))}(t);if(r<0)return NaN;if(0===n.abs(t))return 0;if(t==1/0)return 1/0;var a,i=0,u=2/n.abs(t),s=0,c=1,l=0;for(a=2*n.round((r+n.round(n.sqrt(40*r)))/2);a>0;a--)l=a*u*c+s,s=c,c=l,n.abs(c)>1e10&&(c*=1e-10,s*=1e-10,i*=1e-10),a==r&&(i=s);return i*=e(t,0)/c,t<0&&r%2?-i:i});t.besseli=R;var A=function(){var e=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),t=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),r=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),a=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return i((function(r){return r<=2?-n.log(r/2)*R(r,0)+o(e,r*r/4):n.exp(-r)/n.sqrt(r)*o(t,2/r)}),(function(e){return e<=2?n.log(e/2)*R(e,1)+1/e*o(r,e*e/4):n.exp(-e)/n.sqrt(e)*o(a,2/e)}),0,2,1)}();t.besselk=A},function(e,t,r){"use strict";
/**
 * @license
 Copyright (c) 2013 jStat

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 */
function n(e){var t,r,n,o,a=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],i=a.length-1,u=!1,s=0,c=0;if(0===e)return 0;for(e<0&&(e=-e,u=!0),r=4*(t=2/(2+e))-2;i>0;i--)n=s,s=r*s-c+a[i],c=n;return o=t*Math.exp(-e*e+.5*(a[0]+r*s)-c),u?o-1:1-o}function o(e){return 1-n(e)}function a(e){var t,r,n,a,i=0;if(e>=2)return-100;if(e<=0)return 100;for(a=e<1?e:2-e,t=-.70711*((2.30753+.27061*(n=Math.sqrt(-2*Math.log(a/2))))/(1+n*(.99229+.04481*n))-n);i<2;i++)t+=(r=o(t)-a)/(1.1283791670955126*Math.exp(-t*t)-t*r);return e<1?t:-t}t.__esModule=!0,t.erf=n,t.erfc=o,t.gammafn=u,t.gammaln=c,t.factorialln=R,t.factorial=A,t.mean=_,t.sumsqerr=P,t.variance=L,t.stdev=F,t.normalci=function(){var e,t=[].slice.call(arguments),r=new Array(2);return e=4===t.length?Math.abs(p.inv(t[1]/2,0,1)*t[2]/Math.sqrt(t[3])):Math.abs(p.inv(t[1]/2,0,1)*F(t[2])/Math.sqrt(t[2].length)),r[0]=t[0]-e,r[1]=t[0]+e,r},t.tci=function(){var e,t=[].slice.call(arguments),r=new Array(2);return e=4===t.length?Math.abs(M.inv(t[1]/2,t[3]-1)*t[2]/Math.sqrt(t[3])):Math.abs(M.inv(t[1]/2,t[2].length-1)*F(t[2],!0)/Math.sqrt(t[2].length)),r[0]=t[0]-e,r[1]=t[0]+e,r},t.geomean=function(e){return Math.pow(function(e){for(var t=1,r=e.length;--r>=0;)t*=e[r];return t}(e),1/e.length)},t.covariance=U,t.corrcoeff=function(e,t){return U(e,t)/F(e,1)/F(t,1)},t.negbin=t.lognormal=t.studentt=t.hypgeom=t.poisson=t.weibull=t.centralF=t.chisquare=t.binomial=t.beta=t.normal=t.gamma=t.exponential=void 0,r(53);var i={pdf:function(e,t){return e<0?0:t*Math.exp(-t*e)},cdf:function(e,t){return e<0?0:1-Math.exp(-t*e)}};function u(e){var t,r,n,o,a=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],i=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],u=!1,s=0,c=0,l=0,f=e;if(e>171.6243769536076)return 1/0;if(f<=0){if(!(o=f%1))return 1/0;u=(1&f?-1:1)*Math.PI/Math.sin(Math.PI*o),f=1-f}for(n=f,r=f<1?f++:(f-=s=(0|f)-1)-1,t=0;t<8;++t)l=(l+a[t])*r,c=c*r+i[t];if(o=l/c+1,n<f)o/=n;else if(n>f)for(t=0;t<s;++t)o*=f,f++;return u&&(o=u/o),o}t.exponential=i;var s={pdf:function(e,t,r){return e<0?0:0===e&&1===t?1/r:Math.exp((t-1)*Math.log(e)-e/r-c(t)-t*Math.log(r))},cdf:function(e,t,r){return e<0?0:l(t,e/r)},inv:function(e,t,r){return f(e,t)*r}};function c(e){var t,r,n,o=0,a=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],i=1.000000000190015;for(n=(r=t=e)+5.5,n-=(t+.5)*Math.log(n);o<6;o++)i+=a[o]/++r;return Math.log(2.5066282746310007*i/t)-n}function l(e,t){var r,n=c(e),o=e,a=1/e,i=a,u=t+1-e,s=1/1e-30,l=1/u,f=l,p=1,h=-~(8.5*Math.log(e>=1?e:1/e)+.4*e+17);if(t<0||e<=0)return NaN;if(t<e+1){for(;p<=h;p++)a+=i*=t/++o;return a*Math.exp(-t+e*Math.log(t)-n)}for(;p<=h;p++)f*=(l=1/(l=(r=-p*(p-e))*l+(u+=2)))*(s=u+r/s);return 1-f*Math.exp(-t+e*Math.log(t)-n)}function f(e,t){var r,n,o,a,i,u,s=0,f=t-1,p=c(t);if(e>=1)return Math.max(100,t+100*Math.sqrt(t));if(e<=0)return 0;for(t>1?(i=Math.log(f),u=Math.exp(f*(i-1)-p),a=e<.5?e:1-e,r=(2.30753+.27061*(n=Math.sqrt(-2*Math.log(a))))/(1+n*(.99229+.04481*n))-n,e<.5&&(r=-r),r=Math.max(.001,t*Math.pow(1-1/(9*t)-r/(3*Math.sqrt(t)),3))):r=e<(n=1-t*(.253+.12*t))?Math.pow(e/n,1/t):1-Math.log(1-(e-n)/(1-n));s<12;s++){if(r<=0)return 0;if((r-=n=(o=(l(t,r)-e)/(n=t>1?u*Math.exp(-(r-f)+f*(Math.log(r)-i)):Math.exp(-r+f*Math.log(r)-p)))/(1-.5*Math.min(1,o*((t-1)/r-1))))<=0&&(r=.5*(r+n)),Math.abs(n)<1e-8*r)break}return r}t.gamma=s;var p={pdf:function(e,t,r){return Math.exp(-.5*Math.log(2*Math.PI)-Math.log(r)-Math.pow(e-t,2)/(2*r*r))},cdf:function(e,t,r){return.5*(1+n((e-t)/Math.sqrt(2*r*r)))},inv:function(e,t,r){return-1.4142135623730951*r*a(2*e)+t}};t.normal=p;var h={pdf:function(e,t,r){return e>1||e<0?0:1==t&&1==r?1:t<512&&r<512?Math.pow(e,t-1)*Math.pow(1-e,r-1)/d(t,r):Math.exp((t-1)*Math.log(e)+(r-1)*Math.log(1-e)-m(t,r))},cdf:function(e,t,r){return e>1||e<0?+(e>1):g(e,t,r)},inv:function(e,t,r){return y(e,t,r)}};function d(e,t){if(!(e<=0||t<=0))return e+t>170?Math.exp(m(e,t)):u(e)*u(t)/u(e+t)}function m(e,t){return c(e)+c(t)-c(e+t)}function y(e,t,r){var n,o,a,i,u,s,l,f,p,h,d=t-1,m=r-1,y=0;if(e<=0)return 0;if(e>=1)return 1;for(t>=1&&r>=1?(a=e<.5?e:1-e,s=(2.30753+.27061*(i=Math.sqrt(-2*Math.log(a))))/(1+i*(.99229+.04481*i))-i,e<.5&&(s=-s),l=(s*s-3)/6,f=2/(1/(2*t-1)+1/(2*r-1)),p=s*Math.sqrt(l+f)/f-(1/(2*r-1)-1/(2*t-1))*(l+5/6-2/(3*f)),s=t/(t+r*Math.exp(2*p))):(n=Math.log(t/(t+r)),o=Math.log(r/(t+r)),s=e<(i=Math.exp(t*n)/t)/(p=i+(u=Math.exp(r*o)/r))?Math.pow(t*p*e,1/t):1-Math.pow(r*p*(1-e),1/r)),h=-c(t)-c(r)+c(t+r);y<10;y++){if(0===s||1===s)return s;if((s-=i=(u=(g(s,t,r)-e)/(i=Math.exp(d*Math.log(s)+m*Math.log(1-s)+h)))/(1-.5*Math.min(1,u*(d/s-m/(1-s)))))<=0&&(s=.5*(s+i)),s>=1&&(s=.5*(s+i+1)),Math.abs(i)<1e-8*s&&y>0)break}return s}function g(e,t,r){var n=0===e||1===e?0:Math.exp(c(t+r)-c(t)-c(r)+t*Math.log(e)+r*Math.log(1-e));return!(e<0||e>1)&&(e<(t+1)/(t+r+2)?n*v(e,t,r)/t:1-n*v(1-e,r,t)/r)}function v(e,t,r){var n,o,a,i,u=1,s=t+r,c=t+1,l=t-1,f=1,p=1-s*e/c;for(Math.abs(p)<1e-30&&(p=1e-30),i=p=1/p;u<=100&&(p=1+(o=u*(r-u)*e/((l+(n=2*u))*(t+n)))*p,Math.abs(p)<1e-30&&(p=1e-30),f=1+o/f,Math.abs(f)<1e-30&&(f=1e-30),i*=(p=1/p)*f,p=1+(o=-(t+u)*(s+u)*e/((t+n)*(c+n)))*p,Math.abs(p)<1e-30&&(p=1e-30),f=1+o/f,Math.abs(f)<1e-30&&(f=1e-30),i*=a=(p=1/p)*f,!(Math.abs(a-1)<3e-7));u++);return i}t.beta=h;var E={pdf:function(e,t,r){return 0===r||1===r?t*r===e?1:0:b(t,e)*Math.pow(r,e)*Math.pow(1-r,t-e)},cdf:function(e,t,r){var n;if(e<0)return 0;if(e>=t)return 1;if(r<0||r>1||t<=0)return NaN;var o=r,a=(e=Math.floor(e))+1,i=t-e,u=a+i,s=Math.exp(c(u)-c(i)-c(a)+a*Math.log(o)+i*Math.log(1-o));return n=o<(a+1)/(u+2)?s*T(o,a,i,1e-10):1-s*T(1-o,i,a,1e-10),Math.round(1/1e-10*(1-n))/(1/1e-10)}};function T(e,t,r,n){for(var o,a=0,i=1,u=1,s=1,c=0,l=0;Math.abs((u-l)/u)>n;)l=u,i=s+(o=-(t+c)*(t+r+c)*e/(t+2*c)/(t+2*c+1))*i,u=(a=u+o*a)+(o=(c+=1)*(r-c)*e/(t+2*c-1)/(t+2*c))*u,a/=s=i+o*s,i/=s,u/=s,s=1;return u/t}function b(e,t){return e>170||t>170?Math.exp(function(e,t){return R(e)-R(t)-R(e-t)}(e,t)):A(e)/A(t)/A(e-t)}function R(e){return e<0?NaN:c(e+1)}function A(e){return e<0?NaN:u(e+1)}t.binomial=E;var S={pdf:function(e,t){return e<0?0:0===e&&2===t?.5:Math.exp((t/2-1)*Math.log(e)-e/2-t/2*Math.log(2)-c(t/2))},cdf:function(e,t){return e<0?0:l(t/2,e/2)},inv:function(e,t){return 2*f(e,.5*t)}};t.chisquare=S;var N={pdf:function(e,t,r){return e<0?0:t<=2?0===e&&t<2?1/0:0===e&&2===t?1:1/d(t/2,r/2)*Math.pow(t/r,t/2)*Math.pow(e,t/2-1)*Math.pow(1+t/r*e,-(t+r)/2):t*(r/(r+e*t))/2*E.pdf((t-2)/2,(t+r-2)/2,t*e/(r+e*t))},cdf:function(e,t,r){return e<0?0:g(t*e/(t*e+r),t/2,r/2)},inv:function(e,t,r){return r/(t*(1/y(e,t/2,r/2)-1))}};t.centralF=N;var O={pdf:function(e,t,r){return e<0||t<0||r<0?0:r/t*Math.pow(e/t,r-1)*Math.exp(-Math.pow(e/t,r))},cdf:function(e,t,r){return e<0?0:1-Math.exp(-Math.pow(e/t,r))}};t.weibull=O;var C={pdf:function(e,t){return t<0||e%1!=0||e<0?0:Math.pow(t,e)*Math.exp(-t)/A(e)},cdf:function(e,t){var r=0;if(e<0)return 0;for(var n=0;r<=e;r++)n+=C.pdf(r,t);return n}};t.poisson=C;var w={pdf:function(e,t,r,n){if(e<0||e<r-(t-n))return 0;if(e>n||e>r)return 0;if(2*r>t)return 2*n>t?w.pdf(t-r-n+e,t,t-r,t-n):w.pdf(n-e,t,t-r,n);if(2*n>t)return w.pdf(r-e,t,r,t-n);if(r<n)return w.pdf(e,t,n,r);for(var o=1,a=0,i=0;i<e;i++){for(;o>1&&a<n;)o*=1-r/(t-a),a++;o*=(n-i)*(r-i)/((i+1)*(t-r-n+i+1))}for(;a<n;a++)o*=1-r/(t-a);return Math.min(1,Math.max(0,o))},cdf:function e(t,r,n,o){if(t<0||t<n-(r-o))return 0;if(t>=o||t>=n)return 1;if(2*n>r)return 2*o>r?e(r-n-o+t,r,r-n,r-o):1-w.cdf(o-t-1,r,r-n,o);if(2*o>r)return 1-w.cdf(n-t-1,r,n,r-o);if(n<o)return w.cdf(t,r,o,n);for(var a=1,i=1,u=0,s=0;s<t;s++){for(;a>1&&u<o;){var c=1-n/(r-u);i*=c,a*=c,u++}a+=i*=(o-s)*(n-s)/((s+1)*(r-n-o+s+1))}for(;u<o;u++)a*=1-n/(r-u);return Math.min(1,Math.max(0,a))}};t.hypgeom=w;var M={pdf:function(e,t){return t=t>1e100?1e100:t,1/(Math.sqrt(t)*d(.5,t/2))*Math.pow(1+e*e/t,-(t+1)/2)},cdf:function(e,t){var r=t/2;return g((e+Math.sqrt(e*e+t))/(2*Math.sqrt(e*e+t)),r,r)},inv:function(e,t){var r=y(2*Math.min(e,1-e),.5*t,.5);return r=Math.sqrt(t*(1-r)/r),e>.5?r:-r}};t.studentt=M;var I={pdf:function(e,t,r){return e<=0?0:Math.exp(-Math.log(e)-.5*Math.log(2*Math.PI)-Math.log(r)-Math.pow(Math.log(e)-t,2)/(2*r*r))},cdf:function(e,t,r){return e<0?0:.5+.5*n((Math.log(e)-t)/Math.sqrt(2*r*r))},inv:function(e,t,r){return Math.exp(-1.4142135623730951*r*a(2*e)+t)}};t.lognormal=I;var x={pdf:function(e,t,r){return e===e>>>0&&(e<0?0:b(e+t-1,t-1)*Math.pow(1-r,e)*Math.pow(r,t))},cdf:function(e,t,r){var n=0,o=0;if(e<0)return 0;for(;o<=e;o++)n+=x.pdf(o,t,r);return n}};function k(e){for(var t=0,r=e.length;--r>=0;)t+=e[r];return t}function _(e){return k(e)/e.length}function P(e){for(var t,r=_(e),n=0,o=e.length;--o>=0;)n+=(t=e[o]-r)*t;return n}function L(e,t){return P(e)/(e.length-(t?1:0))}function F(e,t){return Math.sqrt(L(e,t))}function U(e,t){var r,n=_(e),o=_(t),a=e.length,i=new Array(a);for(r=0;r<a;r++)i[r]=(e[r]-n)*(t[r]-o);return k(i)/(a-1)}t.negbin=x},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(53),r(63),r(67),r(68),r(77),r(87),r(93),r(94),r(95),r(97),t.__esModule=!0,t.MathPlugin=void 0,r(325),r(374),r(138),r(239),r(109);var o=r(115),a=r(215),i=r(308);function u(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=d(e);if(t){var o=d(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(s,e);var t,r,n,i=p(s);function s(){return c(this,s),i.apply(this,arguments)}return t=s,(r=[{key:"fact",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FACT"),(function(e){e=Math.trunc(e);for(var t=1,r=1;r<=e;r++)t*=r;return t}))}},{key:"factdouble",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FACTDOUBLE"),(function(e){for(var t=1,r=e=Math.trunc(e);r>=1;r-=2)t*=r;return t}))}},{key:"combin",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COMBIN"),(function(e,t){return t>e?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.WrongOrder):y(e=Math.trunc(e),t=Math.trunc(t))}))}},{key:"combina",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COMBINA"),(function(e,t){return(e=Math.trunc(e))+(t=Math.trunc(t))-1>=1030?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.ValueLarge):0===e&&0===t?1:y(e+t-1,t)}))}},{key:"gcd",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("GCD"),(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=r.interpreter.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(t);if(i instanceof o.CellError)return i;var s,c=0,l=u(i);try{for(l.s();!(s=l.n()).done;){var f=s.value;if(f<0)return new o.CellError(o.ErrorType.NUM,a.ErrorMessage.ValueSmall);c=g(c,Math.trunc(f))}}catch(e){l.e(e)}finally{l.f()}return c>Number.MAX_SAFE_INTEGER?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.ValueLarge):c}))}},{key:"lcm",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("LCM"),(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=r.interpreter.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(t);if(i instanceof o.CellError)return i;var s,c=1,l=u(i);try{for(l.s();!(s=l.n()).done;){var f=s.value;if(f<0)return new o.CellError(o.ErrorType.NUM,a.ErrorMessage.ValueSmall);c=v(c,Math.trunc(f))}}catch(e){l.e(e)}finally{l.f()}return c>Number.MAX_SAFE_INTEGER?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.ValueLarge):c}))}},{key:"mround",value:function(e,t){return this.runFunction(e.args,t,this.metadata("MROUND"),(function(e,t){return 0===t?0:e>0&&t<0||e<0&&t>0?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.DistinctSigns):Math.round(e/t)*t}))}},{key:"multinomial",value:function(e,t){return this.runFunction(e.args,t,this.metadata("MULTINOMIAL"),(function(){for(var e=0,t=1,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];for(var u=0,s=n;u<s.length;u++){var c=s[u];if(c<0)return new o.CellError(o.ErrorType.NUM,a.ErrorMessage.ValueSmall);c=Math.trunc(c);for(var l=1;l<=c;l++)t*=(e+l)/l;e+=c}return Math.round(t)}))}},{key:"quotient",value:function(e,t){return this.runFunction(e.args,t,this.metadata("QUOTIENT"),(function(e,t){return 0===t?new o.CellError(o.ErrorType.DIV_BY_ZERO):Math.trunc(e/t)}))}},{key:"seriessum",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("SERIESSUM"),(function(e,t,n,a){var i=r.interpreter.arithmeticHelper.manyToOnlyNumbersDropNulls(a.valuesFromTopLeftCorner());if(i instanceof o.CellError)return i;var s=0;i.reverse();var c,l=u(i);try{for(l.s();!(c=l.n()).done;){var f=c.value;s*=Math.pow(e,n),s+=f}}catch(e){l.e(e)}finally{l.f()}return s*Math.pow(e,t)}))}},{key:"sign",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SIGN"),(function(e){return e>0?1:e<0?-1:0}))}},{key:"sumx2my2",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2MY2"),(function(e,t){var r=e.valuesFromTopLeftCorner(),n=t.valuesFromTopLeftCorner();if(r.length!==n.length)return new o.CellError(o.ErrorType.NA,a.ErrorMessage.EqualLength);for(var i=r.length,u=0,s=0;s<i;s++){var c=r[s],l=n[s];if(c instanceof o.CellError)return c;if(l instanceof o.CellError)return l;"number"==typeof c&&"number"==typeof l&&(u+=Math.pow(c,2)-Math.pow(l,2))}return u}))}},{key:"sumx2py2",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2PY2"),(function(e,t){var r=e.valuesFromTopLeftCorner(),n=t.valuesFromTopLeftCorner();if(r.length!==n.length)return new o.CellError(o.ErrorType.NA,a.ErrorMessage.EqualLength);for(var i=r.length,u=0,s=0;s<i;s++){var c=r[s],l=n[s];if(c instanceof o.CellError)return c;if(l instanceof o.CellError)return l;"number"==typeof c&&"number"==typeof l&&(u+=Math.pow(c,2)+Math.pow(l,2))}return u}))}},{key:"sumxmy2",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SUMXMY2"),(function(e,t){var r=e.valuesFromTopLeftCorner(),n=t.valuesFromTopLeftCorner();if(r.length!==n.length)return new o.CellError(o.ErrorType.NA,a.ErrorMessage.EqualLength);for(var i=r.length,u=0,s=0;s<i;s++){var c=r[s],l=n[s];if(c instanceof o.CellError)return c;if(l instanceof o.CellError)return l;"number"==typeof c&&"number"==typeof l&&(u+=Math.pow(c-l,2))}return u}))}}])&&l(t.prototype,r),n&&l(t,n),s}(i.FunctionPlugin);function y(e,t){2*t>e&&(t=e-t);for(var r=1,n=1;n<=t;n++)r*=(e-t+n)/n;return Math.round(r)}function g(e,t){if(e<t){var r=[t,e];e=r[0],t=r[1]}for(;t>0;){var n=[t,e%t];e=n[0],t=n[1]}return e}function v(e,t){return 0===e||0===t?0:e*(t/g(e,t))}t.MathPlugin=m,m.implementedFunctions={FACT:{method:"fact",parameters:[{argumentType:i.ArgumentTypes.NUMBER,minValue:0,maxValue:170}]},FACTDOUBLE:{method:"factdouble",parameters:[{argumentType:i.ArgumentTypes.NUMBER,minValue:0,maxValue:288}]},COMBIN:{method:"combin",parameters:[{argumentType:i.ArgumentTypes.NUMBER,minValue:0,lessThan:1030},{argumentType:i.ArgumentTypes.NUMBER,minValue:0}]},COMBINA:{method:"combina",parameters:[{argumentType:i.ArgumentTypes.NUMBER,minValue:0},{argumentType:i.ArgumentTypes.NUMBER,minValue:0}]},GCD:{method:"gcd",parameters:[{argumentType:i.ArgumentTypes.ANY}],repeatLastArgs:1},LCM:{method:"lcm",parameters:[{argumentType:i.ArgumentTypes.ANY}],repeatLastArgs:1},MROUND:{method:"mround",parameters:[{argumentType:i.ArgumentTypes.NUMBER},{argumentType:i.ArgumentTypes.NUMBER}]},MULTINOMIAL:{method:"multinomial",parameters:[{argumentType:i.ArgumentTypes.NUMBER}],repeatLastArgs:1,expandRanges:!0},QUOTIENT:{method:"quotient",parameters:[{argumentType:i.ArgumentTypes.NUMBER},{argumentType:i.ArgumentTypes.NUMBER}]},SERIESSUM:{method:"seriessum",parameters:[{argumentType:i.ArgumentTypes.NUMBER},{argumentType:i.ArgumentTypes.NUMBER},{argumentType:i.ArgumentTypes.NUMBER},{argumentType:i.ArgumentTypes.RANGE}]},SIGN:{method:"sign",parameters:[{argumentType:i.ArgumentTypes.NUMBER}]},SUMX2MY2:{method:"sumx2my2",parameters:[{argumentType:i.ArgumentTypes.RANGE},{argumentType:i.ArgumentTypes.RANGE}]},SUMX2PY2:{method:"sumx2py2",parameters:[{argumentType:i.ArgumentTypes.RANGE},{argumentType:i.ArgumentTypes.RANGE}]},SUMXMY2:{method:"sumxmy2",parameters:[{argumentType:i.ArgumentTypes.RANGE},{argumentType:i.ArgumentTypes.RANGE}]}}},function(e,t,r){r(2)({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(87),r(93),r(63),r(94),r(95),r(77),r(97),r(53),r(67),r(68),t.__esModule=!0,t.ComplexPlugin=void 0,r(361),r(358),r(109);var o=r(115),a=r(215),i=r(271),u=r(308);function s(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=l(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){if(e){if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g(e);if(t){var o=g(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return y(this,r)}}function y(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(l,e);var t,r,n,u=m(l);function l(){return p(this,l),u.apply(this,arguments)}return t=l,(r=[{key:"complex",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COMPLEX"),(function(e,t,r){return"i"!==r&&"j"!==r?new o.CellError(o.ErrorType.VALUE,a.ErrorMessage.ShouldBeIorJ):(0,i.coerceComplexToString)([e,t],r)}))}},{key:"imabs",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMABS"),C)}},{key:"imaginary",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMAGINARY"),(function(e){var t=c(e,2);return t[0],t[1]}))}},{key:"imreal",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMREAL"),(function(e){var t=c(e,2),r=t[0];return t[1],r}))}},{key:"imargument",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMARGUMENT"),(function(e){var t=c(e,2),r=t[0],n=t[1];return 0===r&&0===n?new o.CellError(o.ErrorType.DIV_BY_ZERO):Math.atan2(n,r)}))}},{key:"imconjugate",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMCONJUGATE"),(function(e){var t=c(e,2),r=t[0],n=t[1];return(0,i.coerceComplexToString)([r,-n])}))}},{key:"imcos",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMCOS"),(function(e){return(0,i.coerceComplexToString)(R(e))}))}},{key:"imcosh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMCOSH"),(function(e){return(0,i.coerceComplexToString)(A(e))}))}},{key:"imcot",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMCOT"),(function(e){return(0,i.coerceComplexToString)(b(R(e),S(e)))}))}},{key:"imcsc",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMCSC"),(function(e){return(0,i.coerceComplexToString)(b([1,0],S(e)))}))}},{key:"imcsch",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMCSCH"),(function(e){return(0,i.coerceComplexToString)(b([1,0],N(e)))}))}},{key:"imsec",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMSEC"),(function(e){return(0,i.coerceComplexToString)(b([1,0],R(e)))}))}},{key:"imsech",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMSECH"),(function(e){return(0,i.coerceComplexToString)(b([1,0],A(e)))}))}},{key:"imsin",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMSIN"),(function(e){return(0,i.coerceComplexToString)(S(e))}))}},{key:"imsinh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMSINH"),(function(e){return(0,i.coerceComplexToString)(N(e))}))}},{key:"imtan",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMTAN"),(function(e){return(0,i.coerceComplexToString)(b(S(e),R(e)))}))}},{key:"imdiv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMDIV"),(function(e,t){return(0,i.coerceComplexToString)(b(e,t))}))}},{key:"improduct",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("IMPRODUCT"),(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a=r.interpreter.arithmeticHelper.coerceComplexExactRanges(t);if(a instanceof o.CellError)return a;var u,c=[1,0],l=s(a);try{for(l.s();!(u=l.n()).done;){var f=u.value;c=T(c,f)}}catch(e){l.e(e)}finally{l.f()}return(0,i.coerceComplexToString)(c)}))}},{key:"imsum",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("IMSUM"),(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a=r.interpreter.arithmeticHelper.coerceComplexExactRanges(t);if(a instanceof o.CellError)return a;var u,c=[0,0],l=s(a);try{for(l.s();!(u=l.n()).done;){var f=u.value;c=E(c,f)}}catch(e){l.e(e)}finally{l.f()}return(0,i.coerceComplexToString)(c)}))}},{key:"imsub",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMSUB"),(function(e,t){return(0,i.coerceComplexToString)((r=t,n=c(e,2),o=n[0],a=n[1],u=c(r,2),s=u[0],l=u[1],[o-s,a-l]));var r,n,o,a,u,s,l}))}},{key:"imexp",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMEXP"),(function(e){return(0,i.coerceComplexToString)(O(e))}))}},{key:"imln",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMLN"),(function(e){return(0,i.coerceComplexToString)(w(e))}))}},{key:"imlog10",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG10"),(function(e){var t=c(w(e),2),r=t[0],n=t[1],o=Math.log(10);return(0,i.coerceComplexToString)([r/o,n/o])}))}},{key:"imlog2",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG2"),(function(e){var t=c(w(e),2),r=t[0],n=t[1],o=Math.log(2);return(0,i.coerceComplexToString)([r/o,n/o])}))}},{key:"impower",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMPOWER"),(function(e,t){return(0,i.coerceComplexToString)(M(e,t))}))}},{key:"imsqrt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMSQRT"),(function(e){return(0,i.coerceComplexToString)(M(e,.5))}))}}])&&h(t.prototype,r),n&&h(t,n),l}(u.FunctionPlugin);function E(e,t){var r=c(e,2),n=r[0],o=r[1],a=c(t,2);return[n+a[0],o+a[1]]}function T(e,t){var r=c(e,2),n=r[0],o=r[1],a=c(t,2),i=a[0],u=a[1];return[n*i-o*u,n*u+i*o]}function b(e,t){var r=c(e,2),n=r[0],o=r[1],a=c(t,2),i=a[0],u=a[1],s=Math.pow(i,2)+Math.pow(u,2),l=c(T([n,o],[i,-u]),2);return[l[0]/s,l[1]/s]}function R(e){var t=c(e,2),r=t[0],n=t[1];return[Math.cos(r)*Math.cosh(n),-Math.sin(r)*Math.sinh(n)]}function A(e){var t=c(e,2),r=t[0],n=t[1];return[Math.cosh(r)*Math.cos(n),Math.sinh(r)*Math.sin(n)]}function S(e){var t=c(e,2),r=t[0],n=t[1];return[Math.sin(r)*Math.cosh(n),Math.cos(r)*Math.sinh(n)]}function N(e){var t=c(e,2),r=t[0],n=t[1];return[Math.sinh(r)*Math.cos(n),Math.cosh(r)*Math.sin(n)]}function O(e){var t=c(e,2),r=t[0],n=t[1];return[Math.exp(r)*Math.cos(n),Math.exp(r)*Math.sin(n)]}function C(e){var t=c(e,2),r=t[0],n=t[1];return Math.sqrt(r*r+n*n)}function w(e){var t=c(e,2),r=t[0],n=t[1];return[Math.log(C([r,n])),Math.atan2(n,r)]}function M(e,t){var r=c(w(e),2);return O([t*r[0],t*r[1]])}t.ComplexPlugin=v,v.implementedFunctions={COMPLEX:{method:"complex",parameters:[{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.NUMBER},{argumentType:u.ArgumentTypes.STRING,defaultValue:"i"}]},IMABS:{method:"imabs",parameters:[{argumentType:u.ArgumentTypes.COMPLEX}]},IMAGINARY:{method:"imaginary",parameters:[{argumentType:u.ArgumentTypes.COMPLEX}]},IMREAL:{method:"imreal",parameters:[{argumentType:u.ArgumentTypes.COMPLEX}]},IMARGUMENT:{method:"imargument",parameters:[{argumentType:u.ArgumentTypes.COMPLEX}]},IMCONJUGATE:{method:"imconjugate",parameters:[{argumentType:u.ArgumentTypes.COMPLEX}]},IMCOS:{method:"imcos",parameters:[{argumentType:u.ArgumentTypes.COMPLEX}]},IMCOSH:{method:"imcosh",parameters:[{argumentType:u.ArgumentTypes.COMPLEX}]},IMCOT:{method:"imcot",parameters:[{argumentType:u.ArgumentTypes.COMPLEX}]},IMCSC:{method:"imcsc",parameters:[{argumentType:u.ArgumentTypes.COMPLEX}]},IMCSCH:{method:"imcsch",parameters:[{argumentType:u.ArgumentTypes.COMPLEX}]},IMSEC:{method:"imsec",parameters:[{argumentType:u.ArgumentTypes.COMPLEX}]},IMSECH:{method:"imsech",parameters:[{argumentType:u.ArgumentTypes.COMPLEX}]},IMSIN:{method:"imsin",parameters:[{argumentType:u.ArgumentTypes.COMPLEX}]},IMSINH:{method:"imsinh",parameters:[{argumentType:u.ArgumentTypes.COMPLEX}]},IMTAN:{method:"imtan",parameters:[{argumentType:u.ArgumentTypes.COMPLEX}]},IMDIV:{method:"imdiv",parameters:[{argumentType:u.ArgumentTypes.COMPLEX},{argumentType:u.ArgumentTypes.COMPLEX}]},IMPRODUCT:{method:"improduct",parameters:[{argumentType:u.ArgumentTypes.ANY}],repeatLastArgs:1},IMSUM:{method:"imsum",parameters:[{argumentType:u.ArgumentTypes.ANY}],repeatLastArgs:1},IMSUB:{method:"imsub",parameters:[{argumentType:u.ArgumentTypes.COMPLEX},{argumentType:u.ArgumentTypes.COMPLEX}]},IMEXP:{method:"imexp",parameters:[{argumentType:u.ArgumentTypes.COMPLEX}]},IMLN:{method:"imln",parameters:[{argumentType:u.ArgumentTypes.COMPLEX}]},IMLOG10:{method:"imlog10",parameters:[{argumentType:u.ArgumentTypes.COMPLEX}]},IMLOG2:{method:"imlog2",parameters:[{argumentType:u.ArgumentTypes.COMPLEX}]},IMPOWER:{method:"impower",parameters:[{argumentType:u.ArgumentTypes.COMPLEX},{argumentType:u.ArgumentTypes.NUMBER}]},IMSQRT:{method:"imsqrt",parameters:[{argumentType:u.ArgumentTypes.COMPLEX}]}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(1),r(53),r(63),r(67),r(68),r(77),r(87),r(93),r(94),r(95),r(97),t.__esModule=!0,t.StatisticalAggregationPlugin=void 0,r(149),r(109);var o=r(115),a=r(215),i=r(223),u=r(372),s=r(308);function c(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw a}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y(e);if(t){var o=y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return m(this,r)}}function m(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(s,e);var t,r,n,i=d(s);function s(){return f(this,s),i.apply(this,arguments)}return t=s,(r=[{key:"avedev",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("AVEDEV"),(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a=r.interpreter.arithmeticHelper.coerceNumbersExactRanges(t);if(a instanceof o.CellError)return a;if(0===a.length)return new o.CellError(o.ErrorType.DIV_BY_ZERO);var i=(0,u.mean)(a);return a.reduce((function(e,t){return e+Math.abs(t-i)}),0)/a.length}))}},{key:"devsq",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("DEVSQ"),(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a=r.interpreter.arithmeticHelper.coerceNumbersExactRanges(t);return a instanceof o.CellError?a:0===a.length?0:(0,u.sumsqerr)(a)}))}},{key:"geomean",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("GEOMEAN"),(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=r.interpreter.arithmeticHelper.coerceNumbersExactRanges(t);if(i instanceof o.CellError)return i;if(0===i.length)return new o.CellError(o.ErrorType.NUM,a.ErrorMessage.OneValue);var s,l=c(i);try{for(l.s();!(s=l.n()).done;){var f=s.value;if(f<=0)return new o.CellError(o.ErrorType.NUM,a.ErrorMessage.ValueSmall)}}catch(e){l.e(e)}finally{l.f()}return(0,u.geomean)(i)}))}},{key:"harmean",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("HARMEAN"),(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=r.interpreter.arithmeticHelper.coerceNumbersExactRanges(t);if(i instanceof o.CellError)return i;if(0===i.length)return new o.CellError(o.ErrorType.NUM,a.ErrorMessage.OneValue);var u,s=c(i);try{for(s.s();!(u=s.n()).done;){var l=u.value;if(l<=0)return new o.CellError(o.ErrorType.NUM,a.ErrorMessage.ValueSmall)}}catch(e){s.e(e)}finally{s.f()}return i.length/i.reduce((function(e,t){return e+1/t}),0)}))}},{key:"correl",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CORREL"),(function(e,t){if(e.numberOfElements()!==t.numberOfElements())return new o.CellError(o.ErrorType.NA,a.ErrorMessage.EqualLength);var r=v(e,t);return r instanceof o.CellError?r:r[0].length<=1?new o.CellError(o.ErrorType.DIV_BY_ZERO,a.ErrorMessage.TwoValues):(0,u.corrcoeff)(r[0],r[1])}))}},{key:"rsq",value:function(e,t){return this.runFunction(e.args,t,this.metadata("RSQ"),(function(e,t){if(e.numberOfElements()!==t.numberOfElements())return new o.CellError(o.ErrorType.NA,a.ErrorMessage.EqualLength);var r=v(e,t);return r instanceof o.CellError?r:r[0].length<=1?new o.CellError(o.ErrorType.DIV_BY_ZERO,a.ErrorMessage.TwoValues):Math.pow((0,u.corrcoeff)(r[0],r[1]),2)}))}},{key:"covariancep",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.P"),(function(e,t){if(e.numberOfElements()!==t.numberOfElements())return new o.CellError(o.ErrorType.NA,a.ErrorMessage.EqualLength);var r=v(e,t);if(r instanceof o.CellError)return r;var n=r[0].length;return n<1?new o.CellError(o.ErrorType.DIV_BY_ZERO,a.ErrorMessage.OneValue):1===n?0:(0,u.covariance)(r[0],r[1])*(n-1)/n}))}},{key:"covariances",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.S"),(function(e,t){if(e.numberOfElements()!==t.numberOfElements())return new o.CellError(o.ErrorType.NA,a.ErrorMessage.EqualLength);var r=v(e,t);return r instanceof o.CellError?r:r[0].length<=1?new o.CellError(o.ErrorType.DIV_BY_ZERO,a.ErrorMessage.TwoValues):(0,u.covariance)(r[0],r[1])}))}},{key:"ztest",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("Z.TEST"),(function(e,t,n){var i=r.interpreter.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());if(i instanceof o.CellError)return i;var s=i.length;if(void 0===n){if(s<2)return new o.CellError(o.ErrorType.DIV_BY_ZERO,a.ErrorMessage.TwoValues);n=(0,u.stdev)(i,!0)}return s<1?new o.CellError(o.ErrorType.NA,a.ErrorMessage.OneValue):0===n?new o.CellError(o.ErrorType.DIV_BY_ZERO):1-u.normal.cdf(((0,u.mean)(i)-t)/(n/Math.sqrt(s)),0,1)}))}},{key:"ftest",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("F.TEST"),(function(e,t){var n=r.interpreter.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner()),a=r.interpreter.arithmeticHelper.manyToExactNumbers(t.valuesFromTopLeftCorner());if(n instanceof o.CellError)return n;if(a instanceof o.CellError)return a;if(n.length<=1||a.length<=1)return new o.CellError(o.ErrorType.DIV_BY_ZERO);var i=(0,u.variance)(n,!0),s=(0,u.variance)(a,!0);if(0===i||0===s)return new o.CellError(o.ErrorType.DIV_BY_ZERO);var c=i/s,l=u.centralF.cdf(c,n.length-1,a.length-1);return 2*Math.min(l,1-l)}))}},{key:"steyx",value:function(e,t){return this.runFunction(e.args,t,this.metadata("STEYX"),(function(e,t){if(e.numberOfElements()!==t.numberOfElements())return new o.CellError(o.ErrorType.NA,a.ErrorMessage.EqualLength);var r=v(e,t);if(r instanceof o.CellError)return r;var n=r[0].length;return n<=2?new o.CellError(o.ErrorType.DIV_BY_ZERO,a.ErrorMessage.ThreeValues):Math.sqrt(((0,u.sumsqerr)(r[0])-Math.pow((0,u.covariance)(r[0],r[1])*(n-1),2)/(0,u.sumsqerr)(r[1]))/(n-2))}))}},{key:"slope",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SLOPE"),(function(e,t){if(e.numberOfElements()!==t.numberOfElements())return new o.CellError(o.ErrorType.NA,a.ErrorMessage.EqualLength);var r=v(e,t);if(r instanceof o.CellError)return r;var n=r[0].length;return n<=1?new o.CellError(o.ErrorType.DIV_BY_ZERO,a.ErrorMessage.TwoValues):(0,u.covariance)(r[0],r[1])*(n-1)/(0,u.sumsqerr)(r[1])}))}},{key:"chisqtest",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.TEST"),(function(e,t){var r=e.height(),n=e.width();if(t.height()!==r||t.width()!==n)return new o.CellError(o.ErrorType.NA,a.ErrorMessage.EqualLength);var i=v(e,t);if(i instanceof o.CellError)return i;if(i[0].length<=1)return new o.CellError(o.ErrorType.DIV_BY_ZERO,a.ErrorMessage.TwoValues);for(var s=0,c=0;c<i[0].length;c++){if(0===i[1][c])return new o.CellError(o.ErrorType.DIV_BY_ZERO);s+=Math.pow(i[0][c]-i[1][c],2)/i[1][c]}return s<0?new o.CellError(o.ErrorType.NUM,a.ErrorMessage.NaN):1-u.chisquare.cdf(s,r>1&&n>1?(r-1)*(n-1):r*n-1)}))}},{key:"ttest",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("T.TEST"),(function(e,t,n,i){var s=r.interpreter.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner()),c=r.interpreter.arithmeticHelper.manyToExactNumbers(t.valuesFromTopLeftCorner());if(s instanceof o.CellError)return s;if(c instanceof o.CellError)return c;var l=s.length,f=c.length;if(1===i){if(f!==l)return new o.CellError(o.ErrorType.NA,a.ErrorMessage.EqualLength);if(l<=1)return new o.CellError(o.ErrorType.DIV_BY_ZERO,a.ErrorMessage.TwoValues);for(var p=Array(l),h=0;h<l;h++)p[h]=s[h]-c[h];var d=(0,u.stdev)(p,!0);if(0===d)return new o.CellError(o.ErrorType.DIV_BY_ZERO);var m=Math.abs(Math.sqrt(l)*(0,u.mean)(p)/d);return n*(1-u.studentt.cdf(m,l-1))}if(2===i){if(l<=1||f<=1)return new o.CellError(o.ErrorType.DIV_BY_ZERO,a.ErrorMessage.TwoValues);var y=((0,u.sumsqerr)(s)+(0,u.sumsqerr)(c))/(l+f-2);if(0===y)return new o.CellError(o.ErrorType.DIV_BY_ZERO);var g=Math.abs(((0,u.mean)(s)-(0,u.mean)(c))/Math.sqrt(y*(1/l+1/f)));return n*(1-u.studentt.cdf(g,l+f-2))}if(l<=1||f<=1)return new o.CellError(o.ErrorType.DIV_BY_ZERO,a.ErrorMessage.TwoValues);var v=(0,u.variance)(s,!0),E=(0,u.variance)(c,!0);if(0===v&&0===E)return new o.CellError(o.ErrorType.DIV_BY_ZERO);var T=Math.abs(((0,u.mean)(s)-(0,u.mean)(c))/Math.sqrt(v/l+E/f)),b=Math.pow(v/l+E/f,2)/(Math.pow(v/l,2)/(l-1)+Math.pow(E/f,2)/(f-1));return n*(1-u.studentt.cdf(T,b))}))}},{key:"skew",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("SKEW"),(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=r.interpreter.arithmeticHelper.coerceNumbersExactRanges(t);if(i instanceof o.CellError)return i;var s=i.length;if(s<3)return new o.CellError(o.ErrorType.DIV_BY_ZERO,a.ErrorMessage.ThreeValues);var c=(0,u.mean)(i),l=(0,u.stdev)(i,!0);return 0===l?new o.CellError(o.ErrorType.DIV_BY_ZERO):i.reduce((function(e,t){return e+Math.pow((t-c)/l,3)}),0)*s/(s-1)/(s-2)}))}},{key:"skewp",value:function(e,t){var r=this;return this.runFunction(e.args,t,this.metadata("SKEW.P"),(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=r.interpreter.arithmeticHelper.coerceNumbersExactRanges(t);if(i instanceof o.CellError)return i;var s=i.length;if(s<3)return new o.CellError(o.ErrorType.DIV_BY_ZERO,a.ErrorMessage.ThreeValues);var c=(0,u.mean)(i),l=(0,u.stdev)(i,!1);return 0===l?new o.CellError(o.ErrorType.DIV_BY_ZERO):i.reduce((function(e,t){return e+Math.pow((t-c)/l,3)}),0)/s}))}}])&&p(t.prototype,r),n&&p(t,n),s}(s.FunctionPlugin);function v(e,t){for(var r,n,a=e.iterateValuesFromTopLeftCorner(),u=t.iterateValuesFromTopLeftCorner(),s=[],c=[];r=a.next(),n=u.next(),!r.done&&!n.done;){var l=r.value,f=n.value;if(l instanceof o.CellError)return l;if(f instanceof o.CellError)return f;(0,i.isExtendedNumber)(l)&&(0,i.isExtendedNumber)(f)&&(s.push((0,i.getRawValue)(l)),c.push((0,i.getRawValue)(f)))}return[s,c]}t.StatisticalAggregationPlugin=g,g.implementedFunctions={AVEDEV:{method:"avedev",parameters:[{argumentType:s.ArgumentTypes.ANY}],repeatLastArgs:1},DEVSQ:{method:"devsq",parameters:[{argumentType:s.ArgumentTypes.ANY}],repeatLastArgs:1},GEOMEAN:{method:"geomean",parameters:[{argumentType:s.ArgumentTypes.ANY}],repeatLastArgs:1},HARMEAN:{method:"harmean",parameters:[{argumentType:s.ArgumentTypes.ANY}],repeatLastArgs:1},CORREL:{method:"correl",parameters:[{argumentType:s.ArgumentTypes.RANGE},{argumentType:s.ArgumentTypes.RANGE}]},RSQ:{method:"rsq",parameters:[{argumentType:s.ArgumentTypes.RANGE},{argumentType:s.ArgumentTypes.RANGE}]},"COVARIANCE.P":{method:"covariancep",parameters:[{argumentType:s.ArgumentTypes.RANGE},{argumentType:s.ArgumentTypes.RANGE}]},"COVARIANCE.S":{method:"covariances",parameters:[{argumentType:s.ArgumentTypes.RANGE},{argumentType:s.ArgumentTypes.RANGE}]},"Z.TEST":{method:"ztest",parameters:[{argumentType:s.ArgumentTypes.RANGE},{argumentType:s.ArgumentTypes.NUMBER},{argumentType:s.ArgumentTypes.NUMBER,optionalArg:!0}]},"F.TEST":{method:"ftest",parameters:[{argumentType:s.ArgumentTypes.RANGE},{argumentType:s.ArgumentTypes.RANGE}]},STEYX:{method:"steyx",parameters:[{argumentType:s.ArgumentTypes.RANGE},{argumentType:s.ArgumentTypes.RANGE}]},SLOPE:{method:"slope",parameters:[{argumentType:s.ArgumentTypes.RANGE},{argumentType:s.ArgumentTypes.RANGE}]},"CHISQ.TEST":{method:"chisqtest",parameters:[{argumentType:s.ArgumentTypes.RANGE},{argumentType:s.ArgumentTypes.RANGE}]},"T.TEST":{method:"ttest",parameters:[{argumentType:s.ArgumentTypes.RANGE},{argumentType:s.ArgumentTypes.RANGE},{argumentType:s.ArgumentTypes.INTEGER,minValue:1,maxValue:2},{argumentType:s.ArgumentTypes.INTEGER,minValue:1,maxValue:3}]},SKEW:{method:"skew",parameters:[{argumentType:s.ArgumentTypes.ANY}],repeatLastArgs:1},"SKEW.P":{method:"skewp",parameters:[{argumentType:s.ArgumentTypes.ANY}],repeatLastArgs:1}},g.aliases={COVAR:"COVARIANCE.P",FTEST:"F.TEST",PEARSON:"CORREL",ZTEST:"Z.TEST",CHITEST:"CHISQ.TEST",TTEST:"T.TEST",COVARIANCEP:"COVARIANCE.P",COVARIANCES:"COVARIANCE.S",SKEWP:"SKEW.P"}}]).default},"object"===i(t)&&"object"===i(e)?e.exports=u():(o=[],void 0===(a="function"==typeof(n=u)?n.apply(t,o):n)||(e.exports=a))}).call(this,r(118)(e))},465:function(e,t,r){"use strict";r(346)},471:function(e,t,r){"use strict";r.r(t);var n=r(369),o=r.n(n),a=r(461),i=r.n(a),u=r(462),s=r.n(u),c=o.a.buildEmpty().parser.getSerializedGastProductions(),l={data:function(){return{diagram:s.a.buildSyntaxDiagramsText(c)}},mounted:function(){i.a.initDiagramsBehavior()}},f=(r(464),r(465),r(45)),p=Object(f.a)(l,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("div",{staticClass:"diagram",domProps:{innerHTML:this._s(this.diagram)}})])}),[],!1,null,null,null);t.default=p.exports}}]);